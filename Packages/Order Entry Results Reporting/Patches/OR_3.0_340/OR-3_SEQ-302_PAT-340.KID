Released OR*3*340 SEQ #302
Extracted from mail message
**KIDS**:OR*3.0*340^

**INSTALL NAME**
OR*3.0*340
"BLD",19702,0)
OR*3.0*340^ORDER ENTRY/RESULTS REPORTING^0^3111007^y
"BLD",19702,1,0)
^^7^7^3110118^
"BLD",19702,1,1,0)
This patch is part of the Identification of Principal Mental Health
"BLD",19702,1,2,0)
Provider(IPMHP) project.  It is to be released in conjunction with PCMM
"BLD",19702,1,3,0)
patch SD*5.3*575, with SD*5.3*575 being installed first.  The purpose of
"BLD",19702,1,4,0)
this patch is to implement the API being released in SD*5.3*575 to display
"BLD",19702,1,5,0)
the Principal Mental Health Provider in two locations within CPRS GUI, one
"BLD",19702,1,6,0)
being the patient detail display and the other being the Primary Care
"BLD",19702,1,7,0)
button detailed display.
"BLD",19702,4,0)
^9.64PA^^
"BLD",19702,6)
5^
"BLD",19702,6.3)
6
"BLD",19702,"KRN",0)
^9.67PA^779.2^20
"BLD",19702,"KRN",.4,0)
.4
"BLD",19702,"KRN",.401,0)
.401
"BLD",19702,"KRN",.402,0)
.402
"BLD",19702,"KRN",.403,0)
.403
"BLD",19702,"KRN",.5,0)
.5
"BLD",19702,"KRN",.84,0)
.84
"BLD",19702,"KRN",3.6,0)
3.6
"BLD",19702,"KRN",3.8,0)
3.8
"BLD",19702,"KRN",9.2,0)
9.2
"BLD",19702,"KRN",9.8,0)
9.8
"BLD",19702,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",19702,"KRN",9.8,"NM",1,0)
ORCXPND1^^0^B77575358
"BLD",19702,"KRN",9.8,"NM",2,0)
ORWPT1^^0^B19631349
"BLD",19702,"KRN",9.8,"NM","B","ORCXPND1",1)

"BLD",19702,"KRN",9.8,"NM","B","ORWPT1",2)

"BLD",19702,"KRN",19,0)
19
"BLD",19702,"KRN",19.1,0)
19.1
"BLD",19702,"KRN",101,0)
101
"BLD",19702,"KRN",409.61,0)
409.61
"BLD",19702,"KRN",771,0)
771
"BLD",19702,"KRN",779.2,0)
779.2
"BLD",19702,"KRN",870,0)
870
"BLD",19702,"KRN",8989.51,0)
8989.51
"BLD",19702,"KRN",8989.52,0)
8989.52
"BLD",19702,"KRN",8994,0)
8994
"BLD",19702,"KRN","B",.4,.4)

"BLD",19702,"KRN","B",.401,.401)

"BLD",19702,"KRN","B",.402,.402)

"BLD",19702,"KRN","B",.403,.403)

"BLD",19702,"KRN","B",.5,.5)

"BLD",19702,"KRN","B",.84,.84)

"BLD",19702,"KRN","B",3.6,3.6)

"BLD",19702,"KRN","B",3.8,3.8)

"BLD",19702,"KRN","B",9.2,9.2)

"BLD",19702,"KRN","B",9.8,9.8)

"BLD",19702,"KRN","B",19,19)

"BLD",19702,"KRN","B",19.1,19.1)

"BLD",19702,"KRN","B",101,101)

"BLD",19702,"KRN","B",409.61,409.61)

"BLD",19702,"KRN","B",771,771)

"BLD",19702,"KRN","B",779.2,779.2)

"BLD",19702,"KRN","B",870,870)

"BLD",19702,"KRN","B",8989.51,8989.51)

"BLD",19702,"KRN","B",8989.52,8989.52)

"BLD",19702,"KRN","B",8994,8994)

"BLD",19702,"QUES",0)
^9.62^^
"BLD",19702,"REQB",0)
^9.611^2^2
"BLD",19702,"REQB",1,0)
OR*3.0*280^2
"BLD",19702,"REQB",2,0)
SD*5.3*575^2
"BLD",19702,"REQB","B","OR*3.0*280",1)

"BLD",19702,"REQB","B","SD*5.3*575",2)

"MBREQ")
0
"PKG",22,-1)
1^1
"PKG",22,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",22,20,0)
^9.402P^^
"PKG",22,22,0)
^9.49I^1^1
"PKG",22,22,1,0)
3.0^2971217^2980204^64
"PKG",22,22,1,"PAH",1,0)
340^3111007^123456789093
"PKG",22,22,1,"PAH",1,1,0)
^^7^7^3111007
"PKG",22,22,1,"PAH",1,1,1,0)
This patch is part of the Identification of Principal Mental Health
"PKG",22,22,1,"PAH",1,1,2,0)
Provider(IPMHP) project.  It is to be released in conjunction with PCMM
"PKG",22,22,1,"PAH",1,1,3,0)
patch SD*5.3*575, with SD*5.3*575 being installed first.  The purpose of
"PKG",22,22,1,"PAH",1,1,4,0)
this patch is to implement the API being released in SD*5.3*575 to display
"PKG",22,22,1,"PAH",1,1,5,0)
the Principal Mental Health Provider in two locations within CPRS GUI, one
"PKG",22,22,1,"PAH",1,1,6,0)
being the patient detail display and the other being the Primary Care
"PKG",22,22,1,"PAH",1,1,7,0)
button detailed display.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ORCXPND1")
0^1^B77575358^B72214647
"RTN","ORCXPND1",1,0)
ORCXPND1 ; SLC/MKB - Expanded Display cont ;08/31/09  09:18
"RTN","ORCXPND1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**26,67,75,89,92,94,148,159,188,172,215,243,280,340**;Dec 17, 1997;Build 6
"RTN","ORCXPND1",3,0)
 ;
"RTN","ORCXPND1",4,0)
 ; External References
"RTN","ORCXPND1",5,0)
 ;   DBIA  2387  ^LAB(60
"RTN","ORCXPND1",6,0)
 ;   DBIA  3420  ^DPT(  file #2
"RTN","ORCXPND1",7,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPND1",8,0)
 ;   DBIA 10037  EN^DGRPD
"RTN","ORCXPND1",9,0)
 ;   DBIA   700  DIS^DGRPDB
"RTN","ORCXPND1",10,0)
 ;   DBIA  2926  RT^GMRCGUIA
"RTN","ORCXPND1",11,0)
 ;   DBIA  2925  DT^GMRCSLM2                     ^TMP("GMRCR"
"RTN","ORCXPND1",12,0)
 ;   DBIA  2503  RR^LR7OR1                       ^TMP("LRRR"
"RTN","ORCXPND1",13,0)
 ;   DBIA  2951  EN1^LR7OSBR                     ^TMP("LRC"
"RTN","ORCXPND1",14,0)
 ;   DBIA  2952  EN^LR7OSMZ0
"RTN","ORCXPND1",15,0)
 ;   DBIA  2400  OEL^PSOORRL                     ^TMP("PS"
"RTN","ORCXPND1",16,0)
 ;   DBIA  2877  EN3^RAO7PC3
"RTN","ORCXPND1",17,0)
 ;   DBIA  2877  EN30^RAO7PC3
"RTN","ORCXPND1",18,0)
 ;   DBIA  1252  $$OUTPTPR^SDUTL3
"RTN","ORCXPND1",19,0)
 ;   DBIA  1252  $$OUTPTTM^SDUTL3
"RTN","ORCXPND1",20,0)
 ;   DBIA  2832  RPC^TIUSRV
"RTN","ORCXPND1",21,0)
 ;   DBIA 10061  DEM^VADPT
"RTN","ORCXPND1",22,0)
 ;   DBIA 10061  KVAR^VADPT
"RTN","ORCXPND1",23,0)
 ;   DBIA 10061  OAD^VADPT
"RTN","ORCXPND1",24,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","ORCXPND1",25,0)
 ;   DBIA  4408  DISP^DGIBDSP
"RTN","ORCXPND1",26,0)
 ;   DBIA  5697  START^SCMCMHTC
"RTN","ORCXPND1",27,0)
 ;
"RTN","ORCXPND1",28,0)
COVER ; -- Cover Sheet
"RTN","ORCXPND1",29,0)
 N PKG S PKG=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",30,0)
 D ALLERGY^ORCXPND2:PKG="GMRA",NOTES:PKG="TIU"
"RTN","ORCXPND1",31,0)
 Q
"RTN","ORCXPND1",32,0)
NOTES ; -- Progress Notes
"RTN","ORCXPND1",33,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ K ^TMP("TIUAUDIT",$J)
"RTN","ORCXPND1",34,0)
 D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",35,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",36,0)
 K @ORY
"RTN","ORCXPND1",37,0)
 Q
"RTN","ORCXPND1",38,0)
PROBLEMS ; -- Problem List
"RTN","ORCXPND1",39,0)
 D PL^ORCXPND4
"RTN","ORCXPND1",40,0)
 Q
"RTN","ORCXPND1",41,0)
MEDS ; -- Pharmacy
"RTN","ORCXPND1",42,0)
 ;N NODE,ORIFN
"RTN","ORCXPND1",43,0)
 K ^TMP("PS",$J)
"RTN","ORCXPND1",44,0)
 D OEL^PSOORRL(+ORVP,ID) ;S NODE=$G(^TMP("PS",$J,0)),ORIFN=+$P(NODE,U,11)
"RTN","ORCXPND1",45,0)
 S ID=+$P($G(^TMP("PS",$J,0)),U,11) D ORDERS  ;DBIA 2400
"RTN","ORCXPND1",46,0)
 ;D @($S($P($G(^OR(100,ORIFN,0)),U,11)=$O(^ORD(100.98,"B","IV RX",0)):"IV",1:"DRUG")_"^ORCXPND2")
"RTN","ORCXPND1",47,0)
 K ^TMP("PS",$J)
"RTN","ORCXPND1",48,0)
 Q
"RTN","ORCXPND1",49,0)
LABS ; -- Laboratory [RESULTS ONLY for ID=OE order #]
"RTN","ORCXPND1",50,0)
 N ORIFN,X,SUB,TEST,NAME,SS,IDE,IVDT,TST,CCNT,ORCY,IG,TCNT
"RTN","ORCXPND1",51,0)
 K ^TMP("LRRR",$J)  ;DBIA 2503
"RTN","ORCXPND1",52,0)
 I (ID?2.5E1" "2N1" "1.N1"-"7N1"."1.4N)!(ID?2.5E1" "2N1" "1.N1"-"7N) D AP^ORCXPND3 Q  ;ID=Accession #-Date/time specimen taken
"RTN","ORCXPND1",53,0)
 S ORIFN=+ID,IDE=$G(^OR(100,+ID,4)) Q:'$L(IDE)  ; OE# -> Lab#
"RTN","ORCXPND1",54,0)
 I +IDE  D RR^LR7OR1(+ORVP,IDE) I '$D(^TMP("LRRR",$J,+ORVP)) S $P(IDE,";",1,3)=";;" ;Order possibly purged, reset to lookup on file 63
"RTN","ORCXPND1",55,0)
 I '+IDE,$P(IDE,";",5)  D RR^LR7OR1(+ORVP,,9999999-$P(IDE,";",5),9999999-$P(IDE,";",5),$P(IDE,";",4))
"RTN","ORCXPND1",56,0)
 K ORCY D TEXT^ORQ12(.ORCY,ORIFN,80)
"RTN","ORCXPND1",57,0)
 S IG=0 F  S IG=$O(ORCY(IG)) Q:IG<1  S X=ORCY(IG) D ITEM^ORCXPND(X)
"RTN","ORCXPND1",58,0)
 D BLANK^ORCXPND I '$D(^TMP("LRRR",$J,+ORVP)) S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",59,0)
 M TEST=^TMP("LRRR",$J,+ORVP) S CCNT=0,SS=""
"RTN","ORCXPND1",60,0)
 F  S SS=$O(TEST(SS)) Q:SS=""  S IVDT=0 F  S IVDT=$O(TEST(SS,IVDT)) Q:'IVDT  D
"RTN","ORCXPND1",61,0)
 . I SS="BB" D
"RTN","ORCXPND1",62,0)
 .. I $$GET^XPAR("DIV^SYS^PKG","OR VBECS ON",1,"Q"),$L($T(EN^ORWLR1)),$L($T(CPRS^VBECA3B)) D  Q  ;Transition to VBEC's interface
"RTN","ORCXPND1",63,0)
 ... K ^TMP("ORLRC",$J)
"RTN","ORCXPND1",64,0)
 ... D EN^ORWLR1(DFN)
"RTN","ORCXPND1",65,0)
 ... I '$O(^TMP("ORLRC",$J,0)) S ^TMP("ORLRC",$J,1,0)="",^TMP("ORLRC",$J,2,0)="No Blood Bank report available..."
"RTN","ORCXPND1",66,0)
 ... N I S I=0 F  S I=$O(^TMP("ORLRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",67,0)
 ... K ^TMP("ORLRC",$J)
"RTN","ORCXPND1",68,0)
 .. K ^TMP("LRC",$J) D EN1^LR7OSBR(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q  ;DBIA 2951
"RTN","ORCXPND1",69,0)
 ... N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",70,0)
 ... K ^TMP("LRC",$J)
"RTN","ORCXPND1",71,0)
 . I SS="MI" K ^TMP("LRC",$J) D EN^LR7OSMZ0(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORCXPND1",72,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",73,0)
 .. K ^TMP("LRC",$J)
"RTN","ORCXPND1",74,0)
 . I SS="CH" D  Q
"RTN","ORCXPND1",75,0)
 .. S (TCNT,TST)=0 F  S TST=$O(TEST(SS,IVDT,TST)) Q:TST=""  S CCNT=0,TCNT=TCNT+1 D
"RTN","ORCXPND1",76,0)
 ... I TCNT=1 D
"RTN","ORCXPND1",77,0)
 .... S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="   Collection time:          "_$$FMTE^XLFDT(9999999-IVDT,1)
"RTN","ORCXPND1",78,0)
 .... S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT," ")_$$S(3,CCNT,"Test Name")_$$S(29,CCNT,"Result")_$$S(39,CCNT,"Units")_$$S(55,CCNT,"Range") D:$D(IOUON) SETVIDEO^ORCXPND(LCNT,1,70,IOUON,IOUOFF)
"RTN","ORCXPND1",79,0)
 ... I TST S X=TEST(SS,IVDT,TST),CCNT=0 I +X D
"RTN","ORCXPND1",80,0)
 .... S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$$S(1,CCNT,$P(^LAB(60,+X,0),U))_$$S(26,CCNT,$J($P(X,U,2),7))_$$S(34,CCNT,$S($L($P(X,U,3)):$P(X,U,3),1:""))_$$S(39,CCNT,$P(X,U,4))_$$S(45,CCNT,$J($P(X,U,5),15))
"RTN","ORCXPND1",81,0)
 .... I $L($P(X,U,3)),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOINHI,IOINORM)
"RTN","ORCXPND1",82,0)
 .... I $P(X,U,3)["*",$D(IOBON),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOBON_IOINHI,IOBOFF_IOINORM)
"RTN","ORCXPND1",83,0)
 ... I TST="N" S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=" Comments: " D
"RTN","ORCXPND1",84,0)
 .... N CMT S CMT=0 F  S CMT=$O(TEST(SS,IVDT,"N",CMT)) Q:'CMT  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=" "_TEST(SS,IVDT,"N",CMT)
"RTN","ORCXPND1",85,0)
 K ^TMP("LRRR",$J)
"RTN","ORCXPND1",86,0)
 Q
"RTN","ORCXPND1",87,0)
 ;
"RTN","ORCXPND1",88,0)
DELAY ; -- Delayed Orders
"RTN","ORCXPND1",89,0)
NEW ; -- New Orders
"RTN","ORCXPND1",90,0)
ORDERS ; -- Orders
"RTN","ORCXPND1",91,0)
 I '$G(ORESULTS) D ORDERS^ORCXPND2 Q
"RTN","ORCXPND1",92,0)
 ; -- Results Display (Add more packages as available)
"RTN","ORCXPND1",93,0)
 N PKG,TAB,ORIFN
"RTN","ORCXPND1",94,0)
 S PKG=+$P($G(^OR(100,+ID,0)),"^",14),PKG=$$NMSP^ORCD(PKG)
"RTN","ORCXPND1",95,0)
 S TAB=$S(PKG="LR":"LABS",PKG="GMRC":"CONSULTS",PKG="RA":"XRAYS",1:"")
"RTN","ORCXPND1",96,0)
 I '$L(TAB)!(ID'>0) D  Q  ; no display available
"RTN","ORCXPND1",97,0)
 . N ORY,I D TEXT^ORQ12(.ORY,+ID,80)
"RTN","ORCXPND1",98,0)
 . S I=0 F  S I=$O(ORY(I)) Q:I'>0  D ITEM^ORCXPND(ORY(I))
"RTN","ORCXPND1",99,0)
 . D BLANK^ORCXPND
"RTN","ORCXPND1",100,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="There are no results to report."
"RTN","ORCXPND1",101,0)
 I $O(^OR(100,+ID,2,0)) S ORIFN=+ID,ID=0 F  S ID=$O(^OR(100,ORIFN,2,ID)) Q:ID<1  I $D(^OR(100,ID,0)) D @TAB
"RTN","ORCXPND1",102,0)
 I '$O(^OR(100,+ID,2,0)) D @TAB
"RTN","ORCXPND1",103,0)
 Q
"RTN","ORCXPND1",104,0)
REPORTS ; -- Patient Profiles
"RTN","ORCXPND1",105,0)
 D EN^ORCXPNDR ; Reports
"RTN","ORCXPND1",106,0)
 Q
"RTN","ORCXPND1",107,0)
CONSULTS ; -- Consults
"RTN","ORCXPND1",108,0)
 N I,X,SUB,ORTX ;,VALMAR
"RTN","ORCXPND1",109,0)
 I $G(ORTAB)="CONSULTS" S X=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",110,0)
 E  D TEXT^ORQ12(.ORTX,+ID) S X=ORTX(1),ID=+$G(^OR(100,+ID,4)) ; OE->GMRC order#
"RTN","ORCXPND1",111,0)
 D ITEM^ORCXPND(X),BLANK^ORCXPND
"RTN","ORCXPND1",112,0)
 I ID'>0 S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",113,0)
 I '$G(ORESULTS) D  ;DT action
"RTN","ORCXPND1",114,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Consult No.:           "_ID
"RTN","ORCXPND1",115,0)
 . N GMRCOER S GMRCOER=2 D DT^GMRCSLM2(ID) S SUB="DT"  ;DBIA 2925
"RTN","ORCXPND1",116,0)
 I $G(ORESULTS) D RT^GMRCGUIA(ID,"^TMP(""GMRCR"",$J,""RT"")") S SUB="RT"
"RTN","ORCXPND1",117,0)
 S I=0 F  S I=$O(^TMP("GMRCR",$J,SUB,I)) Q:I'>0  S X=$G(^(I,0)),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X  ;DBIA 2925
"RTN","ORCXPND1",118,0)
 K ^TMP("GMRCR",$J)
"RTN","ORCXPND1",119,0)
 Q
"RTN","ORCXPND1",120,0)
XRAYS ; -- Radiology
"RTN","ORCXPND1",121,0)
 I '$G(ORESULTS) S ID=+ORVP_U_$TR(ID,"-","^") D EN3^RAO7PC3(ID)
"RTN","ORCXPND1",122,0)
 I $G(ORESULTS) S ID=+$G(^OR(100,+ID,4)) D EN30^RAO7PC3(ID)
"RTN","ORCXPND1",123,0)
 N CASE,PROC,PSET S PSET=$D(^TMP($J,"RAE3",+ORVP,"PRINT_SET"))
"RTN","ORCXPND1",124,0)
 S CASE=0 F  S CASE=$O(^TMP($J,"RAE3",+ORVP,CASE)) Q:CASE'>0  D
"RTN","ORCXPND1",125,0)
 . I PSET S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,"")) D ITEM^ORCXPND(PROC) Q
"RTN","ORCXPND1",126,0)
 . S PROC="" F  S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC)) Q:PROC=""  D ITEM^ORCXPND(PROC),BLANK^ORCXPND,XRPT,BLANK^ORCXPND
"RTN","ORCXPND1",127,0)
 I PSET S CASE=$O(^TMP($J,"RAE3",+ORVP,0)),PROC=$O(^(CASE,"")) D BLANK^ORCXPND,XRPT,BLANK^ORCXPND ;printset=list all procs, then one report
"RTN","ORCXPND1",128,0)
 K ^TMP($J,"RAE3",+ORVP),^UTILITY($J,"W")
"RTN","ORCXPND1",129,0)
 S VALM("RM")=81
"RTN","ORCXPND1",130,0)
 Q
"RTN","ORCXPND1",131,0)
 ;
"RTN","ORCXPND1",132,0)
XRPT ; -- Body of Report for CASE, PROC
"RTN","ORCXPND1",133,0)
 N ORD,X,I
"RTN","ORCXPND1",134,0)
 S ORD=$S($L($G(^TMP($J,"RAE3",+ORVP,"ORD"))):^("ORD"),$L($G(^("ORD",CASE))):^(CASE),1:"") I $L(ORD),ORD'=PROC S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Proc Ord: "_ORD
"RTN","ORCXPND1",135,0)
 S I=1 F  S I=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC,I)) Q:I'>0  S X=^(I),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X ;Skip pt ID on line 1
"RTN","ORCXPND1",136,0)
 Q
"RTN","ORCXPND1",137,0)
 ;
"RTN","ORCXPND1",138,0)
SUMMRIES ; -- Discharge Summaries
"RTN","ORCXPND1",139,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ K ^TMP("TIUAUDIT",$J)
"RTN","ORCXPND1",140,0)
 D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",141,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",142,0)
 K @ORY
"RTN","ORCXPND1",143,0)
 Q
"RTN","ORCXPND1",144,0)
PTINQ ; Print Patient Inquiry in List Manager
"RTN","ORCXPND1",145,0)
 N DFN,ORI,X
"RTN","ORCXPND1",146,0)
 S DFN=+ORVP
"RTN","ORCXPND1",147,0)
 D DGINQ(DFN)
"RTN","ORCXPND1",148,0)
 S ORI=4,LCNT=0
"RTN","ORCXPND1",149,0)
 F  S ORI=$O(^TMP("ORDATA",$J,1,ORI)) Q:'ORI  S X=^(ORI) D
"RTN","ORCXPND1",150,0)
 . S LCNT=LCNT+1
"RTN","ORCXPND1",151,0)
 . S ^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",152,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORCXPND1",153,0)
 Q
"RTN","ORCXPND1",154,0)
 ;
"RTN","ORCXPND1",155,0)
DGINQ(DFN) ; Patient Inquiry
"RTN","ORCXPND1",156,0)
 D START^ORWRP(80,"DGINQB^ORCXPND1(DFN)")
"RTN","ORCXPND1",157,0)
 Q
"RTN","ORCXPND1",158,0)
DGINQB(DFN) ; Build Patient Inquiry
"RTN","ORCXPND1",159,0)
 N CONTACT,ORDOC,ORTEAM,ORMHP,ORVP,XQORNOD,ORSSTRT,ORSSTOPT,VAOA,CPRSGUI
"RTN","ORCXPND1",160,0)
 S ORVP=DFN_";DPT(",XQORNOD=1,CPRSGUI=1
"RTN","ORCXPND1",161,0)
 D EN^DGRPD ; MAS Patient Inquiry
"RTN","ORCXPND1",162,0)
 K CPRSGUI
"RTN","ORCXPND1",163,0)
 ;
"RTN","ORCXPND1",164,0)
 S ORDOC=$$OUTPTPR^SDUTL3(DFN)
"RTN","ORCXPND1",165,0)
 S ORTEAM=$$OUTPTTM^SDUTL3(DFN)
"RTN","ORCXPND1",166,0)
 S ORMHP=$$START^SCMCMHTC(DFN) ;Retrieve Mental Health Provider
"RTN","ORCXPND1",167,0)
 I ORDOC!ORTEAM!ORMHP  D
"RTN","ORCXPND1",168,0)
 . W !!,"Primary Care Information:"
"RTN","ORCXPND1",169,0)
 . I ORDOC W !,"Primary Practitioner: ",$P(ORDOC,"^",2)
"RTN","ORCXPND1",170,0)
 . I ORTEAM W !,"Primary Care Team:    ",$P(ORTEAM,"^",2)
"RTN","ORCXPND1",171,0)
 . I ORMHP D
"RTN","ORCXPND1",172,0)
 .. W !!,"MH Treatment Information:"
"RTN","ORCXPND1",173,0)
 .. W !,"MH Treatment Coord:   ",$E($P(ORMHP,"^",2),1,28) D
"RTN","ORCXPND1",174,0)
 ... W ?52,"Position: ",$E($P(ORMHP,"^",3),1,18)
"RTN","ORCXPND1",175,0)
 .. W !,"MH Treatment Team:    ",$E($P(ORMHP,"^",5),1,56)
"RTN","ORCXPND1",176,0)
 W !!,"Health Insurance Information:"
"RTN","ORCXPND1",177,0)
 D DISP^DGIBDSP  ;DBIA #4408
"RTN","ORCXPND1",178,0)
 W !!,"Service Connection/Rated Disabilities:"
"RTN","ORCXPND1",179,0)
 D DIS^DGRPDB
"RTN","ORCXPND1",180,0)
 F CONTACT="N","S" D
"RTN","ORCXPND1",181,0)
 .S VAOA("A")=$S(CONTACT="N":"",1:3)
"RTN","ORCXPND1",182,0)
 .D OAD^VADPT ;   Get NOK Information
"RTN","ORCXPND1",183,0)
 .I VAOA(9)]"" D
"RTN","ORCXPND1",184,0)
 .. W !!,$S(CONTACT="N":"Next of Kin Information:",1:"Secondary Next of Kin Information:")
"RTN","ORCXPND1",185,0)
 .. W !,"Name:  ",VAOA(9)                          ;     NOK Name
"RTN","ORCXPND1",186,0)
 .. I VAOA(10)]"" W " (",VAOA(10),")"              ;     Relationship
"RTN","ORCXPND1",187,0)
 .. I VAOA(1)]"" W !?7,VAOA(1)                     ;     Address Line 1
"RTN","ORCXPND1",188,0)
 .. I VAOA(2)]"" W !?7,VAOA(2)                     ;     Line 2
"RTN","ORCXPND1",189,0)
 .. I VAOA(3)]"" W !?7,VAOA(3)                     ;     Line 3
"RTN","ORCXPND1",190,0)
 .. I VAOA(4)]"" D
"RTN","ORCXPND1",191,0)
 .. . W !?7,VAOA(4)                                ;     City
"RTN","ORCXPND1",192,0)
 .. . I VAOA(5)]"" W ", "_$P(VAOA(5),"^",2)        ;     State
"RTN","ORCXPND1",193,0)
 .. . W "  ",$P(VAOA(11),"^",2)                    ;     Zip+4
"RTN","ORCXPND1",194,0)
 .. I VAOA(8)]"" W !!?7,"Phone number:  ",VAOA(8)  ;     Phone
"RTN","ORCXPND1",195,0)
 .. I CONTACT="N",$P($G(^DPT(DFN,.21)),U,11)]"" W !?7,"Work phone number:  ",$P(^DPT(DFN,.21),U,11)
"RTN","ORCXPND1",196,0)
 .. I CONTACT="S",$P($G(^DPT(DFN,.211)),U,11)]"" W !?7,"Work phone number:  ",$P(^DPT(DFN,.211),U,11)
"RTN","ORCXPND1",197,0)
 D KVAR^VADPT
"RTN","ORCXPND1",198,0)
 Q
"RTN","ORCXPND1",199,0)
TRIM(X) ;   Trim Spaces
"RTN","ORCXPND1",200,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","ORCXPND1",201,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","ORCXPND1",202,0)
 Q X
"RTN","ORCXPND1",203,0)
S(X,Y,Z) ; Pad Over
"RTN","ORCXPND1",204,0)
 ;   X=Column #
"RTN","ORCXPND1",205,0)
 ;   Y=Current Length
"RTN","ORCXPND1",206,0)
 ;   Z=Text
"RTN","ORCXPND1",207,0)
 ;   SP=Text Sent
"RTN","ORCXPND1",208,0)
 ;   CCNT=Line Position After Input Text
"RTN","ORCXPND1",209,0)
 I '$D(Z) Q ""
"RTN","ORCXPND1",210,0)
 N SP S SP=Z I X,Y,X>Y S SP=$E("                                                                             ",1,X-Y)_Z
"RTN","ORCXPND1",211,0)
 S CCNT=$$INC(CCNT,SP)
"RTN","ORCXPND1",212,0)
 Q SP
"RTN","ORCXPND1",213,0)
INC(X,Y) ; Character Position Count
"RTN","ORCXPND1",214,0)
 ;   X=Current Count
"RTN","ORCXPND1",215,0)
 ;   Y=Text
"RTN","ORCXPND1",216,0)
 N INC S INC=X+$L(Y)
"RTN","ORCXPND1",217,0)
 Q INC
"RTN","ORWPT1")
0^2^B19631349^B15675921
"RTN","ORWPT1",1,0)
ORWPT1 ; SLC/KCM - Patient Lookup Functions (cont) ;01/19/10  05:31
"RTN","ORWPT1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,109,280,340**;Dec 17, 1997;Build 6
"RTN","ORWPT1",3,0)
 ;
"RTN","ORWPT1",4,0)
SAVDFLT ; continued from ORWPT, save new default patient list
"RTN","ORWPT1",5,0)
 N DAY,HOLDX S OK=1
"RTN","ORWPT1",6,0)
 I $P(X,U)="P" D
"RTN","ORWPT1",7,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"P")
"RTN","ORWPT1",8,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT PROVIDER",1,"`"_$P(X,U,2))
"RTN","ORWPT1",9,0)
 I $P(X,U)="T" D
"RTN","ORWPT1",10,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"T")
"RTN","ORWPT1",11,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT TEAM",1,"`"_$P(X,U,2))
"RTN","ORWPT1",12,0)
 I $P(X,U)="S" D
"RTN","ORWPT1",13,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"S")
"RTN","ORWPT1",14,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT SPECIALTY",1,"`"_$P(X,U,2))
"RTN","ORWPT1",15,0)
 I $P(X,U)="C" D
"RTN","ORWPT1",16,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"C")
"RTN","ORWPT1",17,0)
 . F DAY="MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY","SUNDAY" D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC "_DAY,1,"`"_$P(X,U,2))
"RTN","ORWPT1",18,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC START DATE",1,$P($P(X,U,3),";"))
"RTN","ORWPT1",19,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC STOP DATE",1,$P($P(X,U,3),";",2))
"RTN","ORWPT1",20,0)
 ; SLC/PKS - 6/25/2001
"RTN","ORWPT1",21,0)
 ; Added section to save clinic defaults for current day only:
"RTN","ORWPT1",22,0)
 I $P(X,U)="CT" D
"RTN","ORWPT1",23,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"C")
"RTN","ORWPT1",24,0)
 . S HOLDX=X
"RTN","ORWPT1",25,0)
 . D NOW^%DTC D DW^%DTC S DAY=X S X=HOLDX
"RTN","ORWPT1",26,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC "_DAY,1,"`"_$P(X,U,2))
"RTN","ORWPT1",27,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC START DATE",1,$P($P(X,U,3),";"))
"RTN","ORWPT1",28,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT CLINIC STOP DATE",1,$P($P(X,U,3),";",2))
"RTN","ORWPT1",29,0)
 I $P(X,U)="W" D
"RTN","ORWPT1",30,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1,"W")
"RTN","ORWPT1",31,0)
 . D EN^XPAR(DUZ_";VA(200,","ORLP DEFAULT WARD",1,"`"_$P(X,U,2))
"RTN","ORWPT1",32,0)
 I $P(X,U)="A" D DEL^XPAR(DUZ_";VA(200,","ORLP DEFAULT LIST SOURCE",1)
"RTN","ORWPT1",33,0)
 Q
"RTN","ORWPT1",34,0)
PRCARE(VAL,PATIENT)        ; return Primary Care info
"RTN","ORWPT1",35,0)
 ; VAL=Primary Care Team^Primary Care Provider^Attending
"RTN","ORWPT1",36,0)
 N PCT,PCP,ATT,ASS
"RTN","ORWPT1",37,0)
 S PCT=$P($$OUTPTTM^SDUTL3(PATIENT,DT),U,2)
"RTN","ORWPT1",38,0)
 S PCP=$P($$OUTPTPR^SDUTL3(PATIENT,DT),U,2)
"RTN","ORWPT1",39,0)
 S ATT=$G(^DPT(PATIENT,.1041)) I ATT S ATT=$P($G(^VA(200,ATT,0)),U)
"RTN","ORWPT1",40,0)
 S ASS=$P($$OUTPTAP^SDUTL3(PATIENT,DT),U,2)
"RTN","ORWPT1",41,0)
 S VAL=PCT_U_PCP_U_ATT_U_ASS
"RTN","ORWPT1",42,0)
 Q
"RTN","ORWPT1",43,0)
PCDETAIL(LST,PATIENT)   ; return Primary Care Detail information
"RTN","ORWPT1",44,0)
 N ILST,X S ILST=0
"RTN","ORWPT1",45,0)
 S X=$$OUTPTTM^SDUTL3(PATIENT,DT)
"RTN","ORWPT1",46,0)
 I +X>0 D
"RTN","ORWPT1",47,0)
 . S ILST=ILST+1,LST(ILST)="        Primary Care Team:  "_$P(X,U,2)
"RTN","ORWPT1",48,0)
 . S ILST=ILST+1,LST(ILST)="                    Phone:  "_$P($G(^SCTM(404.51,+X,0)),U,2)
"RTN","ORWPT1",49,0)
 E  S ILST=ILST+1,LST(ILST)="No Primary Care Team Assigned."
"RTN","ORWPT1",50,0)
 S ILST=ILST+1,LST(ILST)=" "
"RTN","ORWPT1",51,0)
 S X=$$OUTPTPR^SDUTL3(PATIENT,DT)
"RTN","ORWPT1",52,0)
 I +X>0 D
"RTN","ORWPT1",53,0)
 . S ILST=ILST+1,LST(ILST)="    Primary Care Provider:  "_$P(X,U,2)
"RTN","ORWPT1",54,0)
 . S ILST=ILST+1,LST(ILST)="             Analog Pager:  "_$P($G(^VA(200,+X,.13)),U,7)
"RTN","ORWPT1",55,0)
 . S ILST=ILST+1,LST(ILST)="            Digital Pager:  "_$P($G(^VA(200,+X,.13)),U,8)
"RTN","ORWPT1",56,0)
 . S ILST=ILST+1,LST(ILST)="             Office Phone:  "_$P($G(^VA(200,+X,.13)),U,2)
"RTN","ORWPT1",57,0)
 E  S ILST=ILST+1,LST(ILST)="No Primary Care Provider Assigned."
"RTN","ORWPT1",58,0)
 S ILST=ILST+1,LST(ILST)=" "
"RTN","ORWPT1",59,0)
 S X=$$OUTPTAP^SDUTL3(PATIENT,DT)
"RTN","ORWPT1",60,0)
 I +X>0 D
"RTN","ORWPT1",61,0)
 . S ILST=ILST+1,LST(ILST)="       Associate Provider:  "_$P(X,U,2)
"RTN","ORWPT1",62,0)
 . S ILST=ILST+1,LST(ILST)="             Analog Pager:  "_$P($G(^VA(200,+X,.13)),U,7)
"RTN","ORWPT1",63,0)
 . S ILST=ILST+1,LST(ILST)="            Digital Pager:  "_$P($G(^VA(200,+X,.13)),U,8)
"RTN","ORWPT1",64,0)
 . S ILST=ILST+1,LST(ILST)="             Office Phone:  "_$P($G(^VA(200,+X,.13)),U,2)
"RTN","ORWPT1",65,0)
 E  S ILST=ILST+1,LST(ILST)="No Associate Provider Assigned."
"RTN","ORWPT1",66,0)
 S ILST=ILST+1,LST(ILST)=" "
"RTN","ORWPT1",67,0)
 S X=$G(^DPT(PATIENT,.1041))
"RTN","ORWPT1",68,0)
 I +X D
"RTN","ORWPT1",69,0)
 . S ILST=ILST+1,LST(ILST)="      Attending Physician:  "_$P($G(^VA(200,+X,0)),U)
"RTN","ORWPT1",70,0)
 . S ILST=ILST+1,LST(ILST)="             Analog Pager:  "_$P($G(^VA(200,+X,.13)),U,7)
"RTN","ORWPT1",71,0)
 . S ILST=ILST+1,LST(ILST)="            Digital Pager:  "_$P($G(^VA(200,+X,.13)),U,8)
"RTN","ORWPT1",72,0)
 . S ILST=ILST+1,LST(ILST)="             Office Phone:  "_$P($G(^VA(200,+X,.13)),U,2)
"RTN","ORWPT1",73,0)
 S ILST=ILST+1,LST(ILST)=" "
"RTN","ORWPT1",74,0)
 S X=$$START^SCMCMHTC(PATIENT) ;Retrieve Mental Health Provider
"RTN","ORWPT1",75,0)
 I +X>0 D
"RTN","ORWPT1",76,0)
 . S ILST=ILST+1,LST(ILST)="        MH Treatment Team:  "_$P(X,U,5)
"RTN","ORWPT1",77,0)
 . S ILST=ILST+1,LST(ILST)=" MH Treatment Coordinator:  "_$P(X,U,2)
"RTN","ORWPT1",78,0)
 . S ILST=ILST+1,LST(ILST)="             Analog Pager:  "_$P($G(^VA(200,+X,.13)),U,7)
"RTN","ORWPT1",79,0)
 . S ILST=ILST+1,LST(ILST)="            Digital Pager:  "_$P($G(^VA(200,+X,.13)),U,8)
"RTN","ORWPT1",80,0)
 . S ILST=ILST+1,LST(ILST)="             Office Phone:  "_$P($G(^VA(200,+X,.13)),U,2)
"RTN","ORWPT1",81,0)
 ;E  S ILST=ILST+1,LST(ILST)="No MH Treatment Coordinator Assigned."
"RTN","ORWPT1",82,0)
 Q
"VER")
8.0^22.0
"BLD",19702,6)
^302
**END**
**END**
