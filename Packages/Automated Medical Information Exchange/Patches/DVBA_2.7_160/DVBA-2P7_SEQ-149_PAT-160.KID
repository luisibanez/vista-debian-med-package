Released DVBA*2.7*160 SEQ #149
Extracted from mail message
**KIDS**:DVBA*2.7*160^

**INSTALL NAME**
DVBA*2.7*160
"BLD",8609,0)
DVBA*2.7*160^AUTOMATED MED INFO EXCHANGE^0^3110222^y
"BLD",8609,1,0)
^^3^3^3110216^
"BLD",8609,1,1,0)
During the New Form 7131 Request Report [DVBA NEW REQUEST], 7131
"BLD",8609,1,2,0)
Requests containing ADDITIONAL REMARKS (#396.05) with blank lines
"BLD",8609,1,3,0)
do not print in their entirety.
"BLD",8609,4,0)
^9.64PA^^
"BLD",8609,6.3)
1
"BLD",8609,"KRN",0)
^9.67PA^779.2^20
"BLD",8609,"KRN",.4,0)
.4
"BLD",8609,"KRN",.401,0)
.401
"BLD",8609,"KRN",.402,0)
.402
"BLD",8609,"KRN",.403,0)
.403
"BLD",8609,"KRN",.5,0)
.5
"BLD",8609,"KRN",.84,0)
.84
"BLD",8609,"KRN",3.6,0)
3.6
"BLD",8609,"KRN",3.8,0)
3.8
"BLD",8609,"KRN",9.2,0)
9.2
"BLD",8609,"KRN",9.8,0)
9.8
"BLD",8609,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8609,"KRN",9.8,"NM",1,0)
DVBAREQ3^^0^B18754678
"BLD",8609,"KRN",9.8,"NM","B","DVBAREQ3",1)

"BLD",8609,"KRN",19,0)
19
"BLD",8609,"KRN",19.1,0)
19.1
"BLD",8609,"KRN",101,0)
101
"BLD",8609,"KRN",409.61,0)
409.61
"BLD",8609,"KRN",771,0)
771
"BLD",8609,"KRN",779.2,0)
779.2
"BLD",8609,"KRN",870,0)
870
"BLD",8609,"KRN",8989.51,0)
8989.51
"BLD",8609,"KRN",8989.52,0)
8989.52
"BLD",8609,"KRN",8994,0)
8994
"BLD",8609,"KRN","B",.4,.4)

"BLD",8609,"KRN","B",.401,.401)

"BLD",8609,"KRN","B",.402,.402)

"BLD",8609,"KRN","B",.403,.403)

"BLD",8609,"KRN","B",.5,.5)

"BLD",8609,"KRN","B",.84,.84)

"BLD",8609,"KRN","B",3.6,3.6)

"BLD",8609,"KRN","B",3.8,3.8)

"BLD",8609,"KRN","B",9.2,9.2)

"BLD",8609,"KRN","B",9.8,9.8)

"BLD",8609,"KRN","B",19,19)

"BLD",8609,"KRN","B",19.1,19.1)

"BLD",8609,"KRN","B",101,101)

"BLD",8609,"KRN","B",409.61,409.61)

"BLD",8609,"KRN","B",771,771)

"BLD",8609,"KRN","B",779.2,779.2)

"BLD",8609,"KRN","B",870,870)

"BLD",8609,"KRN","B",8989.51,8989.51)

"BLD",8609,"KRN","B",8989.52,8989.52)

"BLD",8609,"KRN","B",8994,8994)

"BLD",8609,"QUES",0)
^9.62^^
"BLD",8609,"REQB",0)
^9.611^1^1
"BLD",8609,"REQB",1,0)
DVBA*2.7*17^1
"BLD",8609,"REQB","B","DVBA*2.7*17",1)

"MBREQ")
0
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,20,0)
^9.402P^^
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
160^3110222
"PKG",223,22,1,"PAH",1,1,0)
^^3^3^3110222
"PKG",223,22,1,"PAH",1,1,1,0)
During the New Form 7131 Request Report [DVBA NEW REQUEST], 7131
"PKG",223,22,1,"PAH",1,1,2,0)
Requests containing ADDITIONAL REMARKS (#396.05) with blank lines
"PKG",223,22,1,"PAH",1,1,3,0)
do not print in their entirety.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DVBAREQ3")
0^1^B18754678^B18695641
"RTN","DVBAREQ3",1,0)
DVBAREQ3 ;ALB/GTS-557/THM-PRINT ROUTINE NEW REQUEST RPT ;21 JUL 89
"RTN","DVBAREQ3",2,0)
 ;;2.7;AMIE;**17,160**;Apr 10, 1995;Build 1
"RTN","DVBAREQ3",3,0)
 ;
"RTN","DVBAREQ3",4,0)
PRINT S:$D(DVBATASK) ^TMP($J,LPDIV,DA)="" ;**Only 1 7131 printed per division
"RTN","DVBAREQ3",5,0)
 S:'$D(DVBATASK) ^TMP($J,DA)="" ;**Only 1 7131 printed.
"RTN","DVBAREQ3",6,0)
 S DFN=$P(^DVB(396,DA,0),U,1),ADMDT=$P(^(0),U,4),RDATE=$P(^(1),U,1),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^(.31)):$P(^(.31),U,3),1:"Unknown"),DOCTYPE=$P(^DVB(396,DA,2),U,10)
"RTN","DVBAREQ3",7,0)
 S ADIV=$S($D(^DVB(396,DA,2)):$P(^(2),U,9),1:"")
"RTN","DVBAREQ3",8,0)
 I DVBSEL="D" Q:'$D(XDIV)  D HEADER
"RTN","DVBAREQ3",9,0)
 I DVBSEL="N" D HEADER2
"RTN","DVBAREQ3",10,0)
 S NODTA=1
"RTN","DVBAREQ3",11,0)
 W !,PNAM,?49,"SSN: ",SSN,!,?44,"CLAIM NO: ",CNUM,!,?38,$S(DOCTYPE="L":" ACTIVITY DATE: ",1:"ADMISSION DATE: "),$$FMTE^XLFDT(ADMDT,"5DZ"),!
"RTN","DVBAREQ3",12,0)
 W ?40,"REQUEST DATE: ",$$FMTE^XLFDT(RDATE,"5DZ"),!!,?3,"Items Requested:",!
"RTN","DVBAREQ3",13,0)
 ;
"RTN","DVBAREQ3",14,0)
ITEMS F Q=5,6,7,8,16,18,20,22,24,27 I $P(^DVB(396,DA,0),U,Q)'="NO" D PRINT1
"RTN","DVBAREQ3",15,0)
 I $P(^DVB(396,DA,0),U,25)'="" S Q=25 D GETDIV S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(20+(23-$L(MC))))_")" W !,?8,MD,GDIV,": ",$P(^DVB(396,DA,0),U,25)
"RTN","DVBAREQ3",16,0)
 S DVBAWO="N"
"RTN","DVBAREQ3",17,0)
 K ^UTILITY($J,"W") W !!,"Remarks: " S DIWL=5,DIWR=65,DIWF="WB5I9"
"RTN","DVBAREQ3",18,0)
 F LPCNT=1:1 Q:'$D(^DVB(396,DA,5,LPCNT,0))  S X=$G(^DVB(396,DA,5,LPCNT,0)) D ^DIWP S DVBAWO="Y"
"RTN","DVBAREQ3",19,0)
 K LPCNT,DIWL,DIWR,DIWF
"RTN","DVBAREQ3",20,0)
 I DVBAWO="Y" D ^DIWW
"RTN","DVBAREQ3",21,0)
 K DVBAWO W !! W:$D(^DVB(396,DA,2)) "Requested by: ",$S($P(^DVB(396,DA,2),U,8)]"":$P(^(2),U,8),1:" (Not specified)")," AT ",$S($P(^(2),U,7)]"":$P(^(2),U,7),1:" (Not specified) "),!
"RTN","DVBAREQ3",22,0)
 I $D(^DVB(396,DA,1)) I $P(^DVB(396,DA,1),U,12)'="" S FNLDT=$P(^(1),U,12) W !!,"This record was FINALIZED on ",$$FMTE^XLFDT(FNLDT,"5DZ")
"RTN","DVBAREQ3",23,0)
 I ADIV="" W !,?5,"**Request is incomplete, contact the Regional Office to complete**"
"RTN","DVBAREQ3",24,0)
 I IOST?1"PK-"!(IOST?1"P-") W !!!!!,"Record Processing Notes: " F LN=1:1:50 W "-" ;print processing notes for admin folder if not going to a screen
"RTN","DVBAREQ3",25,0)
 W !! D TOP
"RTN","DVBAREQ3",26,0)
 Q
"RTN","DVBAREQ3",27,0)
 ;
"RTN","DVBAREQ3",28,0)
HEADER W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
"RTN","DVBAREQ3",29,0)
 W !!!!!,"AMIE 7131 NEW REQUEST REPORT FOR ",$$FMTE^XLFDT(BDT,"5DZ")," TO ",$$FMTE^XLFDT(EDT,"5DZ")_" * LONG VERSION *",!
"RTN","DVBAREQ3",30,0)
 I ADIV="" W ?5,"FOR ",HOSP,", DIVISION NOT GIVEN"
"RTN","DVBAREQ3",31,0)
 I ADIV'="" S DIVHD=$S($D(^DG(40.8,ADIV,0)):$P(^(0),U,1),1:"") W ?5,"FOR ",HOSP W:DIVHD]"" ", DIVISION ",DIVHD,!! I DIVHD="" W ", UNABLE TO DETERMINE DIVISION",!!
"RTN","DVBAREQ3",32,0)
 S DVBAON2=""
"RTN","DVBAREQ3",33,0)
 Q
"RTN","DVBAREQ3",34,0)
 ;
"RTN","DVBAREQ3",35,0)
PRINT1 D GETDIV
"RTN","DVBAREQ3",36,0)
 I QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(23-$L(MD))))_")" W !,?8,MD,GDIV S QQ='QQ Q
"RTN","DVBAREQ3",37,0)
 I 'QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(22-$L(MD))))_")" W ?46,MD,GDIV S QQ='QQ
"RTN","DVBAREQ3",38,0)
 Q
"RTN","DVBAREQ3",39,0)
 ;
"RTN","DVBAREQ3",40,0)
TOP K ANS I IOST?1"C-".E,'$D(NOASK) W !!,*7,"Press RETURN to continue or ""^"" to stop   " R ANS:DTIME S:'$T ANS=U I ANS=U S DA="",MA=9999999
"RTN","DVBAREQ3",41,0)
 Q
"RTN","DVBAREQ3",42,0)
 ;
"RTN","DVBAREQ3",43,0)
HEADER2 ;prints a heading for the name selection
"RTN","DVBAREQ3",44,0)
 I IOST?1"C-".E!($D(DVBAON2)) DO
"RTN","DVBAREQ3",45,0)
 .S VAR(1,0)="0,0,0,0,1^"
"RTN","DVBAREQ3",46,0)
 .D WR^DVBAUTL4("VAR")
"RTN","DVBAREQ3",47,0)
 .K VAR
"RTN","DVBAREQ3",48,0)
 .Q
"RTN","DVBAREQ3",49,0)
 S VAR(1,0)="0,0,0,4:1,0^AMIE 7131 NEW REQUEST REPORT FOR "_PNAM_" **Long Version**"
"RTN","DVBAREQ3",50,0)
 I ADIV="" S VAR(2,0)="0,0,5,0,0^FOR "_HOSP_", DIVISION NOT GIVEN"
"RTN","DVBAREQ3",51,0)
 I ADIV'="" DO
"RTN","DVBAREQ3",52,0)
 .S DIVHD=$S($D(^DG(40.8,ADIV,0)):$P(^(0),U,1),1:"")
"RTN","DVBAREQ3",53,0)
 .S VAR(2,0)="0,0,5,1:2,0^FOR "_HOSP_", DIVISION "_$S(DIVHD]"":DIVHD,1:"UNABLE TO DETERMINE")
"RTN","DVBAREQ3",54,0)
 .Q
"RTN","DVBAREQ3",55,0)
 D WR^DVBAUTL4("VAR")
"RTN","DVBAREQ3",56,0)
 K VAR
"RTN","DVBAREQ3",57,0)
 Q
"RTN","DVBAREQ3",58,0)
 ;
"RTN","DVBAREQ3",59,0)
GETDIV ;** Get the division for 7131 Rpt
"RTN","DVBAREQ3",60,0)
 I $D(^DVB(396,DA,6)) DO
"RTN","DVBAREQ3",61,0)
 .I Q=5 S GDIVPTR=$P(^DVB(396,DA,6),"^",9)
"RTN","DVBAREQ3",62,0)
 .I Q=6 S GDIVPTR=$P(^DVB(396,DA,6),"^",11)
"RTN","DVBAREQ3",63,0)
 .I Q=7 S GDIVPTR=$P(^DVB(396,DA,6),"^",13)
"RTN","DVBAREQ3",64,0)
 .I Q=8 S GDIVPTR=$P(^DVB(396,DA,6),"^",15)
"RTN","DVBAREQ3",65,0)
 .I Q=24 S GDIVPTR=$P(^DVB(396,DA,6),"^",7)
"RTN","DVBAREQ3",66,0)
 .I Q>15&(Q'=24) DO
"RTN","DVBAREQ3",67,0)
 ..S DVBAPCE=Q+1
"RTN","DVBAREQ3",68,0)
 ..S GDIVPTR=$P(^DVB(396,DA,6),"^",DVBAPCE)
"RTN","DVBAREQ3",69,0)
 ..K DVBAPCE
"RTN","DVBAREQ3",70,0)
 S:'$D(GDIVPTR) GDIVPTR=$P(^DVB(396,DA,2),"^",9)
"RTN","DVBAREQ3",71,0)
 I $D(GDIVPTR),(GDIVPTR="") S GDIVPTR=$P(^DVB(396,DA,2),"^",9)
"RTN","DVBAREQ3",72,0)
 S GDIVNAM=$P(^DG(40.8,GDIVPTR,0),"^",1)
"RTN","DVBAREQ3",73,0)
 K GDIVPTR
"RTN","DVBAREQ3",74,0)
 Q
"RTN","DVBAREQ3",75,0)
 ;
"RTN","DVBAREQ3",76,0)
FIELDS ;
"RTN","DVBAREQ3",77,0)
5 ;;NOTICE OF DISCHARGE
"RTN","DVBAREQ3",78,0)
6 ;;HOSPITAL SUMMARY
"RTN","DVBAREQ3",79,0)
7 ;;21-DAY CERTIFICATE
"RTN","DVBAREQ3",80,0)
8 ;;OTHER/EXAM REVIEW RMKS
"RTN","DVBAREQ3",81,0)
16 ;;SPECIAL REPORT
"RTN","DVBAREQ3",82,0)
18 ;;COMPETENCY REPORT
"RTN","DVBAREQ3",83,0)
20 ;;VA FORM 21-2680
"RTN","DVBAREQ3",84,0)
22 ;;ASSET INFORMATION
"RTN","DVBAREQ3",85,0)
24 ;;ADMISSION REPORT
"RTN","DVBAREQ3",86,0)
25 ;;OPT TREATMENT REPORT
"RTN","DVBAREQ3",87,0)
27 ;;BEGINNING DATE/CARE
"RTN","DVBAREQ3",88,0)
 Q
"VER")
8.0^22.0
"BLD",8609,6)
^149
**END**
**END**
