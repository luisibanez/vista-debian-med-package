Released ACKQ*3*18 SEQ #16
Extracted from mail message
**KIDS**:ACKQ*3.0*18^

**INSTALL NAME**
ACKQ*3.0*18
"BLD",8348,0)
ACKQ*3.0*18^QUASAR^0^3091224^y
"BLD",8348,1,0)
^^4^4^3091224^
"BLD",8348,1,1,0)
As a follow up to patch LEX*2.0*64 modifications are necessary to 
"BLD",8348,1,2,0)
all references of the newly deleted fields and use of the 
"BLD",8348,1,3,0)
corresponding API's is required to acquire the necessary 
"BLD",8348,1,4,0)
information.
"BLD",8348,4,0)
^9.64PA^^
"BLD",8348,6.3)
1
"BLD",8348,"ABPKG")
n
"BLD",8348,"KRN",0)
^9.67PA^779.2^20
"BLD",8348,"KRN",.4,0)
.4
"BLD",8348,"KRN",.401,0)
.401
"BLD",8348,"KRN",.402,0)
.402
"BLD",8348,"KRN",.403,0)
.403
"BLD",8348,"KRN",.5,0)
.5
"BLD",8348,"KRN",.84,0)
.84
"BLD",8348,"KRN",3.6,0)
3.6
"BLD",8348,"KRN",3.8,0)
3.8
"BLD",8348,"KRN",9.2,0)
9.2
"BLD",8348,"KRN",9.8,0)
9.8
"BLD",8348,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",8348,"KRN",9.8,"NM",1,0)
ACKQNQ^^0^B27597635
"BLD",8348,"KRN",9.8,"NM",2,0)
ACKQUTL5^^0^B61333053
"BLD",8348,"KRN",9.8,"NM","B","ACKQNQ",1)

"BLD",8348,"KRN",9.8,"NM","B","ACKQUTL5",2)

"BLD",8348,"KRN",19,0)
19
"BLD",8348,"KRN",19.1,0)
19.1
"BLD",8348,"KRN",101,0)
101
"BLD",8348,"KRN",409.61,0)
409.61
"BLD",8348,"KRN",771,0)
771
"BLD",8348,"KRN",779.2,0)
779.2
"BLD",8348,"KRN",870,0)
870
"BLD",8348,"KRN",8989.51,0)
8989.51
"BLD",8348,"KRN",8989.52,0)
8989.52
"BLD",8348,"KRN",8994,0)
8994
"BLD",8348,"KRN","B",.4,.4)

"BLD",8348,"KRN","B",.401,.401)

"BLD",8348,"KRN","B",.402,.402)

"BLD",8348,"KRN","B",.403,.403)

"BLD",8348,"KRN","B",.5,.5)

"BLD",8348,"KRN","B",.84,.84)

"BLD",8348,"KRN","B",3.6,3.6)

"BLD",8348,"KRN","B",3.8,3.8)

"BLD",8348,"KRN","B",9.2,9.2)

"BLD",8348,"KRN","B",9.8,9.8)

"BLD",8348,"KRN","B",19,19)

"BLD",8348,"KRN","B",19.1,19.1)

"BLD",8348,"KRN","B",101,101)

"BLD",8348,"KRN","B",409.61,409.61)

"BLD",8348,"KRN","B",771,771)

"BLD",8348,"KRN","B",779.2,779.2)

"BLD",8348,"KRN","B",870,870)

"BLD",8348,"KRN","B",8989.51,8989.51)

"BLD",8348,"KRN","B",8989.52,8989.52)

"BLD",8348,"KRN","B",8994,8994)

"BLD",8348,"QDEF")
^^^^NO^^^^^^YES
"BLD",8348,"QUES",0)
^9.62^^
"BLD",8348,"REQB",0)
^9.611^1^1
"BLD",8348,"REQB",1,0)
ACKQ*3.0*14^1
"BLD",8348,"REQB","B","ACKQ*3.0*14",1)

"MBREQ")
0
"PKG",262,-1)
1^1
"PKG",262,0)
QUASAR^ACKQ^Audiology & Speech Pathology Visit Tracking System
"PKG",262,20,0)
^9.402P^^
"PKG",262,22,0)
^9.49I^1^1
"PKG",262,22,1,0)
3.0^3000211^3000503^1556
"PKG",262,22,1,"PAH",1,0)
18^3091224
"PKG",262,22,1,"PAH",1,1,0)
^^4^4^3091224
"PKG",262,22,1,"PAH",1,1,1,0)
As a follow up to patch LEX*2.0*64 modifications are necessary to 
"PKG",262,22,1,"PAH",1,1,2,0)
all references of the newly deleted fields and use of the 
"PKG",262,22,1,"PAH",1,1,3,0)
corresponding API's is required to acquire the necessary 
"PKG",262,22,1,"PAH",1,1,4,0)
information.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ACKQNQ")
0^1^B27597635^B27196175
"RTN","ACKQNQ",1,0)
ACKQNQ ;AUG/JLTP,AEM BIR/PTD HCIOFO/BH HCIOFO/AG-Inquire - A&SP Patient ; 12/24/09 2:14pm
"RTN","ACKQNQ",2,0)
 ;;3.0;QUASAR;**8,14,18**;Feb 11, 2000;Build 1
"RTN","ACKQNQ",3,0)
 ;Per VHA Directive 10-93-142, this routine SHOULD NOT be modified.
"RTN","ACKQNQ",4,0)
 ;
"RTN","ACKQNQ",5,0)
OPTN ;  Introduce option.
"RTN","ACKQNQ",6,0)
 S ACKQUIT=0
"RTN","ACKQNQ",7,0)
 W:$E(IOST,1,2)="C-" @IOF,!,"This option displays demographic data, inpatient status, and diagnostic",!,"history for a selected A&SP patient."
"RTN","ACKQNQ",8,0)
 ;
"RTN","ACKQNQ",9,0)
DIC ;  LOOKUP PATIENT
"RTN","ACKQNQ",10,0)
 N DIC
"RTN","ACKQNQ",11,0)
 W ! S DIC=509850.2,DIC(0)="AEMQ" D ^DIC
"RTN","ACKQNQ",12,0)
 I (Y<0)!($D(DUOUT)) S ACKQUIT=1 G EXIT
"RTN","ACKQNQ",13,0)
 S ACKDFN=+Y
"RTN","ACKQNQ",14,0)
 ;
"RTN","ACKQNQ",15,0)
ASK ;  Update patient's diagnostic history?
"RTN","ACKQNQ",16,0)
 S DIR(0)="Y",DIR("A")="Do you want to update this patient's diagnostic history NOW",DIR("B")="NO",DIR("?")="Enter YES to recompile the Problem List; enter NO to continue."
"RTN","ACKQNQ",17,0)
 S DIR("??")="^D UPDATE^ACKQHLP1" W ! D ^DIR K DIR G:$D(DIRUT) EXIT I Y=1 D UPDATE
"RTN","ACKQNQ",18,0)
 ;
"RTN","ACKQNQ",19,0)
DEV W !!,"The right margin for this report is 80.",!,"You can queue it to run at a later time.",!
"RTN","ACKQNQ",20,0)
 K %ZIS,IOP S %ZIS="QM",%ZIS("B")="" D ^%ZIS I POP W !,"NO DEVICE SELECTED OR REPORT PRINTED." G EXIT
"RTN","ACKQNQ",21,0)
 I $D(IO("Q")) K IO("Q") S ZTRTN="EN^ACKQNQ",ZTSAVE("ACKDFN")="",ZTDESC="QUASAR - Inquire - A&SP Patient" D ^%ZTLOAD D HOME^%ZIS K ZTSK G EXIT
"RTN","ACKQNQ",22,0)
 ;
"RTN","ACKQNQ",23,0)
EN U IO N DFN,I,X,Y S DFN=ACKDFN
"RTN","ACKQNQ",24,0)
 D DEM^VADPT,INP^VADPT,ELIG^VADPT
"RTN","ACKQNQ",25,0)
 S ACKIVD=$$NUMDT^ACKQUTL($P(^ACK(509850.2,DFN,0),U,2))
"RTN","ACKQNQ",26,0)
 K ACK S ACK(1)=VADM(1),ACK(2)=$P(VADM(3),U,2),ACK(3)=$P(VADM(2),U,2),ACK(4)=VADM(7),ACK(6)=$P(VAIN(4),U,2)
"RTN","ACKQNQ",27,0)
 S ACKINP=$S($L(ACK(6)):1,1:0),ACK(5)="Patient is "_$S(ACKINP:"",1:"not ")_"currently an inpatient."
"RTN","ACKQNQ",28,0)
 S ACK(7)=VAIN(5),ACK(8)=$P(VAIN(3),U,2),ACK(9)=$P(VAEL(1),U,2)
"RTN","ACKQNQ",29,0)
 ;
"RTN","ACKQNQ",30,0)
 ;
"RTN","ACKQNQ",31,0)
PRINT W:$E(IOST,1,2)="C-" @IOF
"RTN","ACKQNQ",32,0)
 D CNTR^ACKQUTL("Patient Inquiry")
"RTN","ACKQNQ",33,0)
 ;
"RTN","ACKQNQ",34,0)
 W !!
"RTN","ACKQNQ",35,0)
 W "PATIENT: ",ACK(1),?45,"DOB: ",ACK(2),?63,"SSN: ",ACK(3)
"RTN","ACKQNQ",36,0)
 W !,"ELIGIBILITY: ",ACK(9)
"RTN","ACKQNQ",37,0)
 W ?45,"INITIAL VISIT DATE: ",ACKIVD
"RTN","ACKQNQ",38,0)
 W:$L(ACK(4)) !,ACK(4) W !,ACK(5) D:ACKINP INP
"RTN","ACKQNQ",39,0)
 ;
"RTN","ACKQNQ",40,0)
 I $P(VAEL(3),U,1) W !!,"Patient is Service Connected."
"RTN","ACKQNQ",41,0)
 I '$P(VAEL(3),U,1) D
"RTN","ACKQNQ",42,0)
 . S ACKPAT=DFN D STATUS^ACKQUTL4 K VASV
"RTN","ACKQNQ",43,0)
 . D NOT^ACKQUTL7("Patient is not Service Connected.",ACKAO,ACKRAD,ACKENV)
"RTN","ACKQNQ",44,0)
 . K ACKPAT,ACKAO,ACKRAD,ACKENV
"RTN","ACKQNQ",45,0)
 ;
"RTN","ACKQNQ",46,0)
 D RATDIS  G:$G(DIRUT) EXIT
"RTN","ACKQNQ",47,0)
 D ICDSORT,DIAGHIST
"RTN","ACKQNQ",48,0)
 ;
"RTN","ACKQNQ",49,0)
EXIT I $G(ACKVISIT)'="",$G(DIRUT)=1 S ACKDIRUT=1  ;  Quit flag for template
"RTN","ACKQNQ",50,0)
 K %ZIS,ACK,ACKDC,ACKDD,ACKDFN,ACKDN,ACKI,ACKICD,ACKINP,ACKIVD,ACKLINE
"RTN","ACKQNQ",51,0)
 K ACKRD,DIRUT,DTOUT,DUOUT,VA,VADM,VAEL,VAERR,VAIN,X,X1,Y,ZTDESC,ZTIO
"RTN","ACKQNQ",52,0)
 K ZTRTN,ZTSAVE
"RTN","ACKQNQ",53,0)
 I $G(ACKQUIT)=1 D KILL^%ZISS Q
"RTN","ACKQNQ",54,0)
 I $E(IOST,1,2)="C-" W !!,"Press return to continue." R X:DTIME  W @IOF
"RTN","ACKQNQ",55,0)
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ACKQNQ",56,0)
 S ACKQUIT=0 G DIC
"RTN","ACKQNQ",57,0)
 Q
"RTN","ACKQNQ",58,0)
 ;
"RTN","ACKQNQ",59,0)
EN1 ;  CALL THIS ENTRY POINT INSTEAD OF EN
"RTN","ACKQNQ",60,0)
 D HOME^%ZIS G EN
"RTN","ACKQNQ",61,0)
 ;
"RTN","ACKQNQ",62,0)
 ;
"RTN","ACKQNQ",63,0)
INP ;  PRINT INPATIENT INFO
"RTN","ACKQNQ",64,0)
 W !,"WARD: ",ACK(6),?20,"ROOM/BED: ",ACK(7),?40,"TREATING SPEC: ",$E(ACK(8),1,25)
"RTN","ACKQNQ",65,0)
 Q
"RTN","ACKQNQ",66,0)
 ;
"RTN","ACKQNQ",67,0)
 ;
"RTN","ACKQNQ",68,0)
RATDIS ;  Display Patients RATED DISABILITIES
"RTN","ACKQNQ",69,0)
 Q:'$O(^DPT(DFN,.372,0))
"RTN","ACKQNQ",70,0)
 N ACKRD,RC,X,X1
"RTN","ACKQNQ",71,0)
 D ENS^%ZISS
"RTN","ACKQNQ",72,0)
 ;---
"RTN","ACKQNQ",73,0)
 S RC=$$PAGE(5)  Q:RC<0  W:'RC !!
"RTN","ACKQNQ",74,0)
 W IOUON,"Rated Disabilities",IOUOFF,!
"RTN","ACKQNQ",75,0)
 ;---
"RTN","ACKQNQ",76,0)
 S ACKRD=0
"RTN","ACKQNQ",77,0)
 F  S ACKRD=$O(^DPT(DFN,.372,ACKRD))  Q:'ACKRD  D  Q:RC<0
"RTN","ACKQNQ",78,0)
 . S RC=$$PAGE(2)  Q:RC<0
"RTN","ACKQNQ",79,0)
 . W:RC IOUON,"Rated Disabilities (cont'd)",IOUOFF,!
"RTN","ACKQNQ",80,0)
 . S X=^DPT(DFN,.372,ACKRD,0),X1=$P(^DIC(31,+X,0),U)
"RTN","ACKQNQ",81,0)
 . W !,X1_"  ("_$P(X,U,2)_"%)"  I $P(X,U,3) W "  (SC)"
"RTN","ACKQNQ",82,0)
 Q
"RTN","ACKQNQ",83,0)
 ;
"RTN","ACKQNQ",84,0)
DIAGHIST ;
"RTN","ACKQNQ",85,0)
 Q:$D(ACKICD)<10
"RTN","ACKQNQ",86,0)
 N ACKI,RC
"RTN","ACKQNQ",87,0)
 D ENS^%ZISS
"RTN","ACKQNQ",88,0)
 ;---
"RTN","ACKQNQ",89,0)
 S RC=$$PAGE(7)  Q:RC<0  W:'RC !!
"RTN","ACKQNQ",90,0)
 W IOUON,"Patient Diagnostic History",IOUOFF
"RTN","ACKQNQ",91,0)
 W !,$S($P(VADM(5),U)="F":"Ms. ",1:"Mr. "),$P(VADM(1),",")," has been seen for the following:",!
"RTN","ACKQNQ",92,0)
 D DIHEAD
"RTN","ACKQNQ",93,0)
 ;---
"RTN","ACKQNQ",94,0)
 S ACKI=""
"RTN","ACKQNQ",95,0)
 F  S ACKI=$O(ACKICD(ACKI))  Q:ACKI=""  D  Q:RC<0
"RTN","ACKQNQ",96,0)
 . S RC=$$PAGE(2)  Q:RC<0
"RTN","ACKQNQ",97,0)
 . I RC  D  D DIHEAD
"RTN","ACKQNQ",98,0)
 . . W IOUON,"Patient Diagnostic History (cont'd)","  (",ACK(1),")",IOUOFF,!
"RTN","ACKQNQ",99,0)
 . W !,$P(ACKICD(ACKI),U),?15,$P(ACKICD(ACKI),U,3)
"RTN","ACKQNQ",100,0)
 . W ?60,$$NUMDT^ACKQUTL($P(ACKICD(ACKI),U,4))
"RTN","ACKQNQ",101,0)
 Q
"RTN","ACKQNQ",102,0)
 ;
"RTN","ACKQNQ",103,0)
 ;
"RTN","ACKQNQ",104,0)
CLASDIS ;  Display Patient Servive Classifications
"RTN","ACKQNQ",105,0)
 N RC
"RTN","ACKQNQ",106,0)
 I '$D(ACKQSER),'$D(ACKQORG),'$D(ACKQIR),'$D(ACKQECON) Q
"RTN","ACKQNQ",107,0)
 S RC=$$PAGE(5)  Q:RC<0  W:'RC !!
"RTN","ACKQNQ",108,0)
 D ENS^%ZISS
"RTN","ACKQNQ",109,0)
 W IOUON,"Service Classifications",IOUOFF,!
"RTN","ACKQNQ",110,0)
 W:$D(ACKQSER) " SERVICE-CONNECTED " W:$D(ACKQORG) " AGENT-ORANGE " W:$D(ACKQIR) " RADIATION " W:$D(ACKQECON) " ENVIRONMENTAL-CONTAMINANTS"
"RTN","ACKQNQ",111,0)
 W !
"RTN","ACKQNQ",112,0)
 Q
"RTN","ACKQNQ",113,0)
 ;
"RTN","ACKQNQ",114,0)
 ;
"RTN","ACKQNQ",115,0)
DIHEAD W !,"DIAGNOSIS",?60,"DATE ENTERED",!,$$REPEAT^XLFSTR("-",IOM-1)
"RTN","ACKQNQ",116,0)
 Q
"RTN","ACKQNQ",117,0)
 ;
"RTN","ACKQNQ",118,0)
 ;
"RTN","ACKQNQ",119,0)
ICDSORT S ACKI=0 F  S ACKI=$O(^ACK(509850.2,DFN,1,ACKI)) Q:'ACKI  D
"RTN","ACKQNQ",120,0)
 . N ACKARY,ACKDD
"RTN","ACKQNQ",121,0)
 . S ACKDC=^ACK(509850.2,DFN,1,ACKI,0),ACKDD=$P(ACKDC,U,2)
"RTN","ACKQNQ",122,0)
 . D GETS^DIQ(80,+ACKDC_",",".01;2","E","ACKTGT","ACKMSG")
"RTN","ACKQNQ",123,0)
 . S ACKDN=ACKTGT(80,+ACKDC_",",.01,"E")
"RTN","ACKQNQ",124,0)
 . S ACKARY=$P($$ICDDX^ICDCODE(ACKDN,ACKDD),"^",4)
"RTN","ACKQNQ",125,0)
 . S ACKICD(ACKDN)=ACKDN_U_ACKTGT(80,+ACKDC_",",2,"E")_U_ACKARY_U_ACKDD
"RTN","ACKQNQ",126,0)
 K ACKTGT,ACKMSG
"RTN","ACKQNQ",127,0)
 Q
"RTN","ACKQNQ",128,0)
 ;
"RTN","ACKQNQ",129,0)
UPDATE ;  Update patient's diagnostic history in 509850.2.
"RTN","ACKQNQ",130,0)
 ;  ACKDFN is defined upon entry to this module.
"RTN","ACKQNQ",131,0)
 D WAIT^DICD W !
"RTN","ACKQNQ",132,0)
 D PROBLIST^ACKQUTL3(ACKDFN,1)
"RTN","ACKQNQ",133,0)
 Q
"RTN","ACKQNQ",134,0)
 ;
"RTN","ACKQNQ",135,0)
 ;***** CHECKS IS NEW PAGE SHOULD BE STARTED
"RTN","ACKQNQ",136,0)
 ;
"RTN","ACKQNQ",137,0)
 ; [RESERVE]     Number of additional reserved lines (0, by default).
"RTN","ACKQNQ",138,0)
 ;               If the current page does not have so many lines
"RTN","ACKQNQ",139,0)
 ;               available, a new page will be started.
"RTN","ACKQNQ",140,0)
 ;
"RTN","ACKQNQ",141,0)
 ; [FORCE]       Force the prompt
"RTN","ACKQNQ",142,0)
 ;
"RTN","ACKQNQ",143,0)
 ; Return values:
"RTN","ACKQNQ",144,0)
 ;
"RTN","ACKQNQ",145,0)
 ;       -2  Timeout
"RTN","ACKQNQ",146,0)
 ;       -1  User canceled the output ('^' was entered)
"RTN","ACKQNQ",147,0)
 ;        0  Ok
"RTN","ACKQNQ",148,0)
 ;        1  New page
"RTN","ACKQNQ",149,0)
 ;
"RTN","ACKQNQ",150,0)
PAGE(RESERVE,FORCE) ;
"RTN","ACKQNQ",151,0)
 N RC
"RTN","ACKQNQ",152,0)
 I ($Y'<($G(IOSL,24)-$G(RESERVE,1)))!$G(FORCE)  D  S $Y=0
"RTN","ACKQNQ",153,0)
 . I $E(IOST,1,2)'="C-"  W @IOF  Q
"RTN","ACKQNQ",154,0)
 . N DA,DIR,DIROUT,DTOUT,DUOUT,I,X,Y
"RTN","ACKQNQ",155,0)
 . S DIR(0)="E"
"RTN","ACKQNQ",156,0)
 . D ^DIR
"RTN","ACKQNQ",157,0)
 . S RC=$S($D(DUOUT):-1,$D(DTOUT):-2,1:1)
"RTN","ACKQNQ",158,0)
 . W:RC>0 @IOF
"RTN","ACKQNQ",159,0)
 Q +$G(RC)
"RTN","ACKQUTL5")
0^2^B61333053^B60056302
"RTN","ACKQUTL5",1,0)
ACKQUTL5 ;HCIOFO/BH-Quasar utilities routine ; 12/24/09 2:15pm
"RTN","ACKQUTL5",2,0)
 ;;3.0;QUASAR;**1,4,6,8,18**;Feb 11, 2000;Build 1
"RTN","ACKQUTL5",3,0)
 ;Per VHA Directive 10-93-142, this routine SHOULD NOT be modified.
"RTN","ACKQUTL5",4,0)
SETREF(X,ACKVIEN,ACKTYPE) ;
"RTN","ACKQUTL5",5,0)
 ; Maintains APCE xRef When 3 of the 4 entries are present & the 4TH
"RTN","ACKQUTL5",6,0)
 ; has been entered a new entry will be set up. If any of the 4 data 
"RTN","ACKQUTL5",7,0)
 ; items used within the X ref are changed the entry will be deleted & a
"RTN","ACKQUTL5",8,0)
 ; new 1 set up
"RTN","ACKQUTL5",9,0)
 N ACKTME,ACKCLIN,ACKVD,ACKPAT
"RTN","ACKQUTL5",10,0)
 D GETVAL
"RTN","ACKQUTL5",11,0)
 I ACKTME="",ACKTYPE'="T" Q
"RTN","ACKQUTL5",12,0)
 I ACKCLIN="",ACKTYPE'="C" Q
"RTN","ACKQUTL5",13,0)
 I ACKVD="",ACKTYPE'="D" Q
"RTN","ACKQUTL5",14,0)
 I ACKPAT="",ACKTYPE'="P" Q
"RTN","ACKQUTL5",15,0)
 ;
"RTN","ACKQUTL5",16,0)
 S ^ACK(509850.6,"APCE",ACKPAT,ACKCLIN,ACKVD,ACKTME,ACKVIEN)=""
"RTN","ACKQUTL5",17,0)
 Q
"RTN","ACKQUTL5",18,0)
KILLREF(X,ACKVIEN,ACKTYPE) ;
"RTN","ACKQUTL5",19,0)
 ; When any of the 4 var values that make up the APCE xRef are deleted
"RTN","ACKQUTL5",20,0)
 ; or when the visit record is deleted the APCE xRef will be deleted
"RTN","ACKQUTL5",21,0)
 N ACKTME,ACKCLIN,ACKVD,ACKPAT
"RTN","ACKQUTL5",22,0)
 D GETVAL
"RTN","ACKQUTL5",23,0)
 ;
"RTN","ACKQUTL5",24,0)
 I ACKTYPE'="T",ACKTME="" Q   ;  If any of the 4 field values other than
"RTN","ACKQUTL5",25,0)
 I ACKTYPE'="C",ACKCLIN="" Q  ;  the field being edited are null the
"RTN","ACKQUTL5",26,0)
 I ACKTYPE'="D",ACKVD="" Q    ;  xRef will not have been set up
"RTN","ACKQUTL5",27,0)
 I ACKTYPE'="P",ACKPAT="" Q
"RTN","ACKQUTL5",28,0)
 ;
"RTN","ACKQUTL5",29,0)
 I ACKTYPE="D" S ACKVD=X      ;  X=Old field value
"RTN","ACKQUTL5",30,0)
 I ACKTYPE="P" S ACKPAT=X
"RTN","ACKQUTL5",31,0)
 I ACKTYPE="C" S ACKCLIN=X
"RTN","ACKQUTL5",32,0)
 I ACKTYPE="T" S ACKTME=X
"RTN","ACKQUTL5",33,0)
 ;
"RTN","ACKQUTL5",34,0)
 I $D(^ACK(509850.6,"APCE",ACKPAT,ACKCLIN,ACKVD,ACKTME,ACKVIEN)) D
"RTN","ACKQUTL5",35,0)
 . K ^ACK(509850.6,"APCE",ACKPAT,ACKCLIN,ACKVD,ACKTME,ACKVIEN)
"RTN","ACKQUTL5",36,0)
 Q
"RTN","ACKQUTL5",37,0)
 ;
"RTN","ACKQUTL5",38,0)
GETVAL ; Used with SETREF & KILLREF - Gets The Clinic, Visit Date, Visit
"RTN","ACKQUTL5",39,0)
 ; time and Patient from the visit file currently being processed
"RTN","ACKQUTL5",40,0)
 N ACKTGT
"RTN","ACKQUTL5",41,0)
 D GETS^DIQ(509850.6,ACKVIEN_",",".01;1;2.6;55","I","ACKTGT")
"RTN","ACKQUTL5",42,0)
 S ACKVD=$G(ACKTGT(509850.6,ACKVIEN_",",.01,"I"))
"RTN","ACKQUTL5",43,0)
 S ACKPAT=$G(ACKTGT(509850.6,ACKVIEN_",",1,"I"))
"RTN","ACKQUTL5",44,0)
 S ACKCLIN=$G(ACKTGT(509850.6,ACKVIEN_",",2.6,"I"))
"RTN","ACKQUTL5",45,0)
 S ACKTME=$G(ACKTGT(509850.6,ACKVIEN_",",55,"I"))
"RTN","ACKQUTL5",46,0)
 Q
"RTN","ACKQUTL5",47,0)
 ;
"RTN","ACKQUTL5",48,0)
EXCEPT(ACKVIEN,ACKFLD,ACKVAL) ;  Called from xRefs within the LAST SENT TO PCE, LAST
"RTN","ACKQUTL5",49,0)
 ;  EDITED IN QSR and PCE VISIT IEN fields
"RTN","ACKQUTL5",50,0)
 N ACKTGT,ACKPIEN,ACKSENT,ACKEDIT,ACKARR,ACKEXCP
"RTN","ACKQUTL5",51,0)
 I ACKFLD=125 D
"RTN","ACKQUTL5",52,0)
 . S ACKPIEN=ACKVAL
"RTN","ACKQUTL5",53,0)
 . S ACKSENT=$$GET1^DIQ(509850.6,ACKVIEN_",",135,"I")
"RTN","ACKQUTL5",54,0)
 . S ACKEDIT=$$GET1^DIQ(509850.6,ACKVIEN_",",140,"I")
"RTN","ACKQUTL5",55,0)
 I ACKFLD=135 D
"RTN","ACKQUTL5",56,0)
 . S ACKPIEN=$$GET1^DIQ(509850.6,ACKVIEN_",",125,"I")
"RTN","ACKQUTL5",57,0)
 . S ACKSENT=ACKVAL
"RTN","ACKQUTL5",58,0)
 . S ACKEDIT=$$GET1^DIQ(509850.6,ACKVIEN_",",140,"I")
"RTN","ACKQUTL5",59,0)
 I ACKFLD=140 D
"RTN","ACKQUTL5",60,0)
 . S ACKPIEN=$$GET1^DIQ(509850.6,ACKVIEN_",",125,"I")
"RTN","ACKQUTL5",61,0)
 . S ACKSENT=$$GET1^DIQ(509850.6,ACKVIEN_",",135,"I")
"RTN","ACKQUTL5",62,0)
 . S ACKEDIT=ACKVAL
"RTN","ACKQUTL5",63,0)
 ;
"RTN","ACKQUTL5",64,0)
 ; if PCE visit ien known and PCE updated last then no exception
"RTN","ACKQUTL5",65,0)
 I ACKPIEN'="",ACKEDIT'="",ACKSENT'="",ACKEDIT<ACKSENT D  Q
"RTN","ACKQUTL5",66,0)
 . S ACKARR(509850.6,ACKVIEN_",",900)="@"
"RTN","ACKQUTL5",67,0)
 . D FILE^DIE("","ACKARR")
"RTN","ACKQUTL5",68,0)
 ; else this visit is an exception - only update if null or
"RTN","ACKQUTL5",69,0)
 ; earlier than today
"RTN","ACKQUTL5",70,0)
 S ACKEXCP=$$GET1^DIQ(509850.6,ACKVIEN_",",900,"I")
"RTN","ACKQUTL5",71,0)
 D NOW^%DTC
"RTN","ACKQUTL5",72,0)
 I (ACKEXCP="")!(ACKEXCP\1<(%\1)) D
"RTN","ACKQUTL5",73,0)
 . S ACKARR(509850.6,ACKVIEN_",",900)=%
"RTN","ACKQUTL5",74,0)
 . D FILE^DIE("","ACKARR")
"RTN","ACKQUTL5",75,0)
 Q
"RTN","ACKQUTL5",76,0)
SEND(ACKVIEN) ;  Called when entering/editing any of the PCE fields.
"RTN","ACKQUTL5",77,0)
 ; inputs: ACKVIEN - visit ien 
"RTN","ACKQUTL5",78,0)
 ; this s/r is used in the xRef of any data field that, if changed,
"RTN","ACKQUTL5",79,0)
 ; should be sent to PCE to keep PCE up to date. The edit triggers the 
"RTN","ACKQUTL5",80,0)
 ; xRef call to this s/r. It ensures that the LAST EDITED IN QSR date is
"RTN","ACKQUTL5",81,0)
 ; after the LAST SENT TO PCE date so that the visit becomes a PCE 
"RTN","ACKQUTL5",82,0)
 ; EXCEPTION. NB. The LAST EDITED IN QSR date will only be updated if
"RTN","ACKQUTL5",83,0)
 ; a. it is currently earlier than the LAST SENT TO PCE and by updating 
"RTN","ACKQUTL5",84,0)
 ; it the visit becomes a PCE Exception. or b. the current value is 
"RTN","ACKQUTL5",85,0)
 ; earlier than today this saves the system from constantly updating 
"RTN","ACKQUTL5",86,0)
 ; this field and checking the exception status each time a pce field 
"RTN","ACKQUTL5",87,0)
 ; is changed
"RTN","ACKQUTL5",88,0)
 N ACKARR,ACKEDIT,ACKSENT
"RTN","ACKQUTL5",89,0)
 ; get current value of LAST EDITED IN QSR and LAST SENT TO PCE
"RTN","ACKQUTL5",90,0)
 S ACKEDIT=$$GET1^DIQ(509850.6,ACKVIEN_",",140,"I")
"RTN","ACKQUTL5",91,0)
 S ACKSENT=$$GET1^DIQ(509850.6,ACKVIEN_",",135,"I")
"RTN","ACKQUTL5",92,0)
 D NOW^%DTC
"RTN","ACKQUTL5",93,0)
 ; if qsr edit currently earlier than sent to pce update
"RTN","ACKQUTL5",94,0)
 I ACKEDIT<ACKSENT D  Q
"RTN","ACKQUTL5",95,0)
 . S ACKARR(509850.6,ACKVIEN_",",140)=%
"RTN","ACKQUTL5",96,0)
 . D FILE^DIE("","ACKARR")
"RTN","ACKQUTL5",97,0)
 ;
"RTN","ACKQUTL5",98,0)
 ; if last edit is earlier than today update
"RTN","ACKQUTL5",99,0)
 I (ACKEDIT\1)<(%\1) D  Q
"RTN","ACKQUTL5",100,0)
 . S ACKARR(509850.6,ACKVIEN_",",140)=%
"RTN","ACKQUTL5",101,0)
 . D FILE^DIE("","ACKARR")
"RTN","ACKQUTL5",102,0)
 ; nothing to do - QSR date must already be after LAST SENT and for today
"RTN","ACKQUTL5",103,0)
 Q
"RTN","ACKQUTL5",104,0)
MOD ; Creates an array of valid CPT Modfrs.  gets all valid Mods for the 
"RTN","ACKQUTL5",105,0)
 ; Proc then disgards any that are not on the A&SP Proc Mod file or that
"RTN","ACKQUTL5",106,0)
 ; are on file but Inactive
"RTN","ACKQUTL5",107,0)
 K ACKMOD,ACKMODD
"RTN","ACKQUTL5",108,0)
 N CDT,ACKMOD1,ACKM1,ACKK2
"RTN","ACKQUTL5",109,0)
 I $$PATCH^XPDUTL("PX*1.0*73") S ACKMOD1=$$CODM^ICPTCOD(ACKPC,"ACKMODD","",ACKVD)
"RTN","ACKQUTL5",110,0)
 I '$$PATCH^XPDUTL("PX*1.0*73") S ACKMOD1=$$CODM^ICPTCOD(ACKPC,"ACKMODD")
"RTN","ACKQUTL5",111,0)
 S ACKM1=""
"RTN","ACKQUTL5",112,0)
 F  S ACKM1=$O(ACKMODD(ACKM1)) Q:ACKM1=""  D
"RTN","ACKQUTL5",113,0)
 . S ACKK2=$P(ACKMODD(ACKM1),U,2)
"RTN","ACKQUTL5",114,0)
 . I '$D(^ACK(509850.5,ACKK2,0)) K ACKMODD(ACKM1) Q
"RTN","ACKQUTL5",115,0)
 . I $P(^ACK(509850.5,ACKK2,0),U,2)=0 K ACKMODD(ACKM1) Q
"RTN","ACKQUTL5",116,0)
 . K ACKMODD(ACKM1) S ACKMOD(ACKPC,ACKK2)=""
"RTN","ACKQUTL5",117,0)
 S ACKMOD(ACKPC)=""
"RTN","ACKQUTL5",118,0)
 Q
"RTN","ACKQUTL5",119,0)
MODW ; Called from x ref of Modfr field within 509850.6
"RTN","ACKQUTL5",120,0)
 I X'["?" Q
"RTN","ACKQUTL5",121,0)
 N ACKQDDD
"RTN","ACKQUTL5",122,0)
 S ACKQDDD=$G(ACKVD)
"RTN","ACKQUTL5",123,0)
 S DIC("W")="W ""  "",$$MODTXT^ACKQUTL8(Y,"_ACKQDDD_"),?48,$$GET1^DIQ(81.3,Y,.04)"
"RTN","ACKQUTL5",124,0)
 Q
"RTN","ACKQUTL5",125,0)
 ;
"RTN","ACKQUTL5",126,0)
 ;
"RTN","ACKQUTL5",127,0)
MODS ; Screen for Modfrs input within Modifrs field of Modfrs File
"RTN","ACKQUTL5",128,0)
 N ACKQDDD,ACKMOD,ACKMOD1
"RTN","ACKQUTL5",129,0)
 S ACKQDDD=$G(ACKVD)
"RTN","ACKQUTL5",130,0)
 S DIC("S")="D GETS^DIQ(81.3,Y,"".01"",""I"",""ACKARR"",""ACKMSG"") S ACKMOD=$G(ACKARR(81.3,Y_"","","".01"",""I"")),ACKMOD1=$$MOD^ICPTMOD(ACKMOD) I $P($G(ACKMOD1),""^"",5)=""C""!($P($G(ACKMOD1),""^"",5)=""H""),$P($G(ACKMOD1),""^"",7)=1"
"RTN","ACKQUTL5",131,0)
 S DIC("W")="W ""  "",$$MODTXT^ACKQUTL8(Y,"_ACKQDDD_")"
"RTN","ACKQUTL5",132,0)
 Q
"RTN","ACKQUTL5",133,0)
 ;
"RTN","ACKQUTL5",134,0)
 ;
"RTN","ACKQUTL5",135,0)
CHK(Y,ACKVD,ACKCSC) ;  Screen for EC codes
"RTN","ACKQUTL5",136,0)
 N ACKQCD,ACKQQD,ACKQQCPT,ACKPARAM
"RTN","ACKQUTL5",137,0)
 I $E($P(^EC(725,+Y,0),"^",2),1,2)'="SP" Q 0
"RTN","ACKQUTL5",138,0)
 S ACKQQCPT=$$GET1^DIQ(725,+Y_",",4,"I") I ACKQQCPT="" Q 0
"RTN","ACKQUTL5",139,0)
 ;S ACKQCD=$$CONVERT(ACKQQCPT) I ACKQCD="" Q 0
"RTN","ACKQUTL5",140,0)
 S ACKQCD=ACKQQCPT
"RTN","ACKQUTL5",141,0)
 S ACKPARAM=$P($$CPT^ICPTCOD(ACKQCD,ACKVD),"^",7) I 'ACKPARAM Q 0
"RTN","ACKQUTL5",142,0)
 I '$D(^ACK(509850.4,ACKQCD,0)) Q 0
"RTN","ACKQUTL5",143,0)
 I $P(^ACK(509850.4,ACKQCD,0),U,2)'[$E(ACKCSC) Q 0
"RTN","ACKQUTL5",144,0)
 I $P(^ACK(509850.4,ACKQCD,0),U,4)'=1 Q 0
"RTN","ACKQUTL5",145,0)
 S ACKQQD=$P(^EC(725,Y,0),"^",3) I ACKQQD="" Q 1
"RTN","ACKQUTL5",146,0)
 I ACKVD<ACKQQD Q 1
"RTN","ACKQUTL5",147,0)
 Q 0
"RTN","ACKQUTL5",148,0)
EVNTDIS ; Get EC Procs filed and display
"RTN","ACKQUTL5",149,0)
 D ENS^%ZISS
"RTN","ACKQUTL5",150,0)
 N D0,ACKKEY,ACKEVTDS,ACKK3,ACKPROC,ACKPRV,ACKNME,ACKNATNM
"RTN","ACKQUTL5",151,0)
 D LIST^DIC(509850.615,","_ACKVIEN_",",".01;.03;.05","I","*","","","","","","ACKEVTDS")
"RTN","ACKQUTL5",152,0)
 I '$D(ACKEVTDS("DILIST",1)) Q
"RTN","ACKQUTL5",153,0)
 W !!," ",IOUON,"Event Capture Procedures currently entered for this visit",IOUOFF,!
"RTN","ACKQUTL5",154,0)
 S ACKK3=""
"RTN","ACKQUTL5",155,0)
 F  S ACKK3=$O(ACKEVTDS("DILIST",1,ACKK3)) Q:ACKK3=""  D
"RTN","ACKQUTL5",156,0)
 . S ACKPROC=ACKEVTDS("DILIST",1,ACKK3)
"RTN","ACKQUTL5",157,0)
 . S ACKPRV=ACKEVTDS("DILIST","ID",ACKK3,.05)
"RTN","ACKQUTL5",158,0)
 . I ACKPRV'="" S ACKPRV=$$CONVERT^ACKQUTL4(ACKPRV)
"RTN","ACKQUTL5",159,0)
 . S ACKNME=$$GET1^DIQ(725,ACKPROC_",",.01) S ACKNME=$E(ACKNME,1,29)
"RTN","ACKQUTL5",160,0)
 . S ACKNATNM=$$GET1^DIQ(725,ACKPROC_",",1)
"RTN","ACKQUTL5",161,0)
 . W !," Nat.#: ",ACKNATNM,?14,"    Name: ",ACKNME,?55,"Vol.: ",ACKEVTDS("DILIST","ID",ACKK3,.03) I ACKPRV'="" W !,?14,"Provider: ",ACKPRV
"RTN","ACKQUTL5",162,0)
 . W !
"RTN","ACKQUTL5",163,0)
 Q
"RTN","ACKQUTL5",164,0)
SETCPT(DA,ACKQQIEN,X) ;  When EC Code is entered create a CPT entry
"RTN","ACKQUTL5",165,0)
 I '$D(ACKEVENT) Q   ; "" or 1 ACKEVENT must be defined
"RTN","ACKQUTL5",166,0)
 N ACK,ACKARR1,ACKCIEN,ACKQQCPT
"RTN","ACKQUTL5",167,0)
 ; Get CPT associated with EC code
"RTN","ACKQUTL5",168,0)
 S ACKQQCPT=$$GET1^DIQ(725,X_",",4,"I")
"RTN","ACKQUTL5",169,0)
 ;S ACKQQCPT=$$CONVERT(ACKQQCPT)
"RTN","ACKQUTL5",170,0)
 S ACKCIEN="" K ACKARR1
"RTN","ACKQUTL5",171,0)
 ; Create CPT entry and enter DA as CPT's pter to creating EC entry
"RTN","ACKQUTL5",172,0)
 S ACKARR1(509850.61,"+1,"_ACKQQIEN_",",.01)=ACKQQCPT
"RTN","ACKQUTL5",173,0)
 S ACKARR1(509850.61,"+1,"_ACKQQIEN_",",.07)=DA
"RTN","ACKQUTL5",174,0)
 D UPDATE^DIE("","ACKARR1","ACKCIEN","")
"RTN","ACKQUTL5",175,0)
 K ACK
"RTN","ACKQUTL5",176,0)
 ; After CPT entry set up get its IEN & set it to the creating EC 
"RTN","ACKQUTL5",177,0)
 ; entries CPT ptr field
"RTN","ACKQUTL5",178,0)
 S ACK(509850.615,DA_","_ACKQQIEN_",",.07)=ACKCIEN(1)
"RTN","ACKQUTL5",179,0)
 D FILE^DIE("","ACK","")
"RTN","ACKQUTL5",180,0)
 Q
"RTN","ACKQUTL5",181,0)
KILLCPT(DA,ACKQQIEN) ;  Deletes CPT entry if created by an EC entry
"RTN","ACKQUTL5",182,0)
 I '$D(ACKEVENT) Q  ; "" or 1 ACKEVENT must be defined
"RTN","ACKQUTL5",183,0)
 Q:'ACKEVENT  ; Q if Div set up to use CPT's
"RTN","ACKQUTL5",184,0)
 N ACKCIEN,ACK
"RTN","ACKQUTL5",185,0)
 S ACKCIEN=$$GET1^DIQ(509850.615,DA_","_ACKQQIEN_",",.07)
"RTN","ACKQUTL5",186,0)
 I ACKCIEN="" Q
"RTN","ACKQUTL5",187,0)
 S ACK(509850.61,ACKCIEN_","_ACKQQIEN_",",.01)="@" D FILE^DIE("","ACK")
"RTN","ACKQUTL5",188,0)
 Q
"RTN","ACKQUTL5",189,0)
ECVOLPRV(DA,ACKQQIEN,X,ACKQQVP,ACKQQDS) ; Update CPT rec. when EC data entered 
"RTN","ACKQUTL5",190,0)
 ;If CPT entry linked with the EC entry - 
"RTN","ACKQUTL5",191,0)
 ;   If ACKQQDS='S'
"RTN","ACKQUTL5",192,0)
 ;     If ACKQQVP='V' set EC vol to CPT vol
"RTN","ACKQUTL5",193,0)
 ;     If ACKQQVP='P' set EC Prvdr to CPT Prvdr
"RTN","ACKQUTL5",194,0)
 ;   If ACKQQDS='D'
"RTN","ACKQUTL5",195,0)
 ;     If ACKQQVP='V' delete CPT vol
"RTN","ACKQUTL5",196,0)
 ;     If ACKQQVP='P' delete CPT Prvdr
"RTN","ACKQUTL5",197,0)
 ;
"RTN","ACKQUTL5",198,0)
 I '$D(ACKEVENT) Q   ; "" or 1 ACKEVENT must be defined
"RTN","ACKQUTL5",199,0)
 Q:'ACKEVENT
"RTN","ACKQUTL5",200,0)
 N ACKFIELD,ACKVAL,ACK,ACKCIEN
"RTN","ACKQUTL5",201,0)
 S ACKCIEN=$$GET1^DIQ(509850.615,DA_","_ACKQQIEN_",",.07)
"RTN","ACKQUTL5",202,0)
 I ACKCIEN="" Q
"RTN","ACKQUTL5",203,0)
 S ACKFIELD=".03" I ACKQQVP="P" S ACKFIELD=".05"
"RTN","ACKQUTL5",204,0)
 S ACKVAL=X I ACKQQDS="D" S ACKVAL="@"
"RTN","ACKQUTL5",205,0)
 S ACK(509850.61,ACKCIEN_","_ACKQQIEN_",",ACKFIELD)=ACKVAL
"RTN","ACKQUTL5",206,0)
 D FILE^DIE("","ACK","")
"RTN","ACKQUTL5",207,0)
 Q
"RTN","ACKQUTL5",208,0)
CPVOLPRV(DA,ACKQQIEN,X,ACKQQVP,ACKQQDS) ; Update EC rec. when CPT data entered 
"RTN","ACKQUTL5",209,0)
 ;If EC entry linked with the CPT entry - 
"RTN","ACKQUTL5",210,0)
 ;   If ACKQQDS='S'
"RTN","ACKQUTL5",211,0)
 ;     If ACKQQVP='V' set CPT vol to EC vol
"RTN","ACKQUTL5",212,0)
 ;     If ACKQQVP='P' set CPT Prvdr to EC Prvdr
"RTN","ACKQUTL5",213,0)
 ;   If ACKQQDS='D'
"RTN","ACKQUTL5",214,0)
 ;     If ACKQQVP='V' delete EC vol
"RTN","ACKQUTL5",215,0)
 ;     If ACKQQVP='P' delete EC Prvdr
"RTN","ACKQUTL5",216,0)
 ;
"RTN","ACKQUTL5",217,0)
 I '$D(ACKEVENT) Q   ; "" or 1 ACKEVENT must be defined
"RTN","ACKQUTL5",218,0)
 Q:ACKEVENT
"RTN","ACKQUTL5",219,0)
 N ACKFIELD,ACKVAL,ACK,ACKEIEN
"RTN","ACKQUTL5",220,0)
 S ACKEIEN=$$GET1^DIQ(509850.61,DA_","_ACKQQIEN_",",.07)
"RTN","ACKQUTL5",221,0)
 I ACKEIEN="" Q
"RTN","ACKQUTL5",222,0)
 S ACKFIELD=".03" I ACKQQVP="P" S ACKFIELD=".05"
"RTN","ACKQUTL5",223,0)
 S ACKVAL=X I ACKQQDS="D" S ACKVAL="@"
"RTN","ACKQUTL5",224,0)
 S ACK(509850.615,ACKEIEN_","_ACKQQIEN_",",ACKFIELD)=ACKVAL
"RTN","ACKQUTL5",225,0)
 D FILE^DIE("","ACK","")
"RTN","ACKQUTL5",226,0)
 Q
"RTN","ACKQUTL5",227,0)
KILLEC(DA,ACKQQIEN) ;  Delets EC entry if CPT entry has EC pter
"RTN","ACKQUTL5",228,0)
 I '$D(ACKEVENT) Q   ; "" or 1 ACKEVENT must be defined
"RTN","ACKQUTL5",229,0)
 Q:ACKEVENT   ; Q if Div set up to use EC's
"RTN","ACKQUTL5",230,0)
 N ACKECIEN,ACK
"RTN","ACKQUTL5",231,0)
 S ACKECIEN=$$GET1^DIQ(509850.61,DA_","_ACKQQIEN_",",.07)
"RTN","ACKQUTL5",232,0)
 I ACKECIEN="" Q
"RTN","ACKQUTL5",233,0)
 S ACK(509850.615,ACKECIEN_","_ACKQQIEN_",",.01)="@" D FILE^DIE("","ACK")
"RTN","ACKQUTL5",234,0)
 Q
"RTN","ACKQUTL5",235,0)
EVENT(ACKDIV,ACKVD) ; params set up for Divn to use EC Codes ?
"RTN","ACKQUTL5",236,0)
 N ACKY,X,Y,ACKM
"RTN","ACKQUTL5",237,0)
 S ACKY=$E(ACKVD,2,3),ACKM=$E(ACKVD,4,5)
"RTN","ACKQUTL5",238,0)
 I ACKM>9 S ACKY=ACKY+1 I $L(ACKY)=1 S ACKY="0"_ACKY
"RTN","ACKQUTL5",239,0)
 I '$D(^ACK(509850.8,1,2,ACKDIV,2,"B",ACKY)) Q 0
"RTN","ACKQUTL5",240,0)
 S ACKKEY=0
"RTN","ACKQUTL5",241,0)
 S ACKKEY=$O(^ACK(509850.8,1,2,ACKDIV,2,"B",ACKY,ACKKEY))
"RTN","ACKQUTL5",242,0)
 S ACKEC=$P(^ACK(509850.8,1,2,ACKDIV,2,ACKKEY,0),"^",2)
"RTN","ACKQUTL5",243,0)
 I ACKEC="" S ACKEC="0"
"RTN","ACKQUTL5",244,0)
 Q ACKEC
"RTN","ACKQUTL5",245,0)
 ;
"VER")
8.0^22.0
"BLD",8348,6)
^16
**END**
**END**
