KIDS Distribution saved on May 09, 2013@13:24:44
High Risk Mental Health phase 2
**KIDS**:HIGH RISK MH 2.0^TIU*1.0*265^DG*5.3*849^SD*5.3*588^GMTS*2.7*104^OR*3.0*348^PXRM*2.0*24^

**INSTALL NAME**
HIGH RISK MH 2.0
"BLD",8211,0)
HIGH RISK MH 2.0^^1^3130509^y
"BLD",8211,1,0)
^^5^5^3120419^^^^
"BLD",8211,1,1,0)
Mental health high risk combined build, part 2. The following builds
"BLD",8211,1,2,0)
will be installed: TIU*1.0*265, DG*5.3*849, SD*5.3*588,
"BLD",8211,1,3,0)
GMTS*2.7*104, OR*3.0*348 and PXRM*2.0*24. See the national patch
"BLD",8211,1,4,0)
module for detailed descriptions of each of the builds.
"BLD",8211,1,5,0)

"BLD",8211,6.3)
58
"BLD",8211,10,0)
^9.63^6^6
"BLD",8211,10,1,0)
TIU*1.0*265^1
"BLD",8211,10,2,0)
DG*5.3*849^1
"BLD",8211,10,3,0)
SD*5.3*588^1
"BLD",8211,10,4,0)
GMTS*2.7*104^1
"BLD",8211,10,5,0)
OR*3.0*348^1
"BLD",8211,10,6,0)
PXRM*2.0*24^1
"BLD",8211,10,"B","DG*5.3*849",2)

"BLD",8211,10,"B","GMTS*2.7*104",4)

"BLD",8211,10,"B","OR*3.0*348",5)

"BLD",8211,10,"B","PXRM*2.0*24",6)

"BLD",8211,10,"B","SD*5.3*588",3)

"BLD",8211,10,"B","TIU*1.0*265",1)

"BLD",8211,"INI")
MPBPRE^PXRMP24I
"BLD",8211,"INIT")
POST^GMTSY104
"BLD",8211,"KRN",0)
^9.67PA^779.2^20
"BLD",8211,"KRN",.4,0)
.4
"BLD",8211,"KRN",.401,0)
.401
"BLD",8211,"KRN",.402,0)
.402
"BLD",8211,"KRN",.403,0)
.403
"BLD",8211,"KRN",.5,0)
.5
"BLD",8211,"KRN",.84,0)
.84
"BLD",8211,"KRN",3.6,0)
3.6
"BLD",8211,"KRN",3.8,0)
3.8
"BLD",8211,"KRN",9.2,0)
9.2
"BLD",8211,"KRN",9.8,0)
9.8
"BLD",8211,"KRN",19,0)
19
"BLD",8211,"KRN",19.1,0)
19.1
"BLD",8211,"KRN",101,0)
101
"BLD",8211,"KRN",409.61,0)
409.61
"BLD",8211,"KRN",771,0)
771
"BLD",8211,"KRN",779.2,0)
779.2
"BLD",8211,"KRN",870,0)
870
"BLD",8211,"KRN",8989.51,0)
8989.51
"BLD",8211,"KRN",8989.52,0)
8989.52
"BLD",8211,"KRN",8994,0)
8994
"BLD",8211,"KRN","B",.4,.4)

"BLD",8211,"KRN","B",.401,.401)

"BLD",8211,"KRN","B",.402,.402)

"BLD",8211,"KRN","B",.403,.403)

"BLD",8211,"KRN","B",.5,.5)

"BLD",8211,"KRN","B",.84,.84)

"BLD",8211,"KRN","B",3.6,3.6)

"BLD",8211,"KRN","B",3.8,3.8)

"BLD",8211,"KRN","B",9.2,9.2)

"BLD",8211,"KRN","B",9.8,9.8)

"BLD",8211,"KRN","B",19,19)

"BLD",8211,"KRN","B",19.1,19.1)

"BLD",8211,"KRN","B",101,101)

"BLD",8211,"KRN","B",409.61,409.61)

"BLD",8211,"KRN","B",771,771)

"BLD",8211,"KRN","B",779.2,779.2)

"BLD",8211,"KRN","B",870,870)

"BLD",8211,"KRN","B",8989.51,8989.51)

"BLD",8211,"KRN","B",8989.52,8989.52)

"BLD",8211,"KRN","B",8994,8994)

"INI")
MPBPRE^PXRMP24I
"INIT")
POST^GMTSY104
"MBREQ")
0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMTSY104")
0^^B9611824
"RTN","GMTSY104",1,0)
GMTSY104 ;BP/WAT - POST-INSTALL PATCH 104 ;04/19/12  15:25
"RTN","GMTSY104",2,0)
 ;;2.7;Health Summary;**104**;Oct 20, 1995;Build 58
"RTN","GMTSY104",3,0)
 ;
"RTN","GMTSY104",4,0)
 ;WP^DIE ;2053
"RTN","GMTSY104",5,0)
 ;FIND1^DIC ;2051
"RTN","GMTSY104",6,0)
 ;B/MES^XPDUTL 10141
"RTN","GMTSY104",7,0)
 ;
"RTN","GMTSY104",8,0)
 ; GMTS health check
"RTN","GMTSY104",9,0)
 N GMTSNAME,I,COUNT,GMTSABRT S GMTSNAME="",COUNT=1,GMTSABRT=""
"RTN","GMTSY104",10,0)
 D BMES^XPDUTL("CHECKING RECENT ADDITIONS TO HEALTH SUMMARY COMPONENT FILE")
"RTN","GMTSY104",11,0)
 F I=252:1:256  Q:I>256!(GMTSABRT=2)  D
"RTN","GMTSY104",12,0)
 .S GMTSNAME=$P(^GMT(142.1,I,0),"^")
"RTN","GMTSY104",13,0)
 .I GMTSNAME=$P($T(TEXT+COUNT),";;",2) D BMES^XPDUTL(GMTSNAME_": OK") S COUNT=COUNT+1 Q
"RTN","GMTSY104",14,0)
 .D BMES^XPDUTL("The following Health Summary Component was not found in file 142.1:")
"RTN","GMTSY104",15,0)
 .D MES^XPDUTL($P($T(TEXT+COUNT),";;",2))
"RTN","GMTSY104",16,0)
 .D BMES^XPDUTL("Install will not proceed until this issue is resolved.")
"RTN","GMTSY104",17,0)
 .D MES^XPDUTL("Transport global will remain on the system.")
"RTN","GMTSY104",18,0)
 .D MES^XPDUTL("Use KIDS option XPD RESTART INSTALL when the issue is resovled.") S GMTSABRT=2
"RTN","GMTSY104",19,0)
 I +$G(GMTSABRT)=2 S XPDQUIT=2 ;abort and leave global on system
"RTN","GMTSY104",20,0)
 Q
"RTN","GMTSY104",21,0)
 ;
"RTN","GMTSY104",22,0)
TEXT ;HS Names to Check
"RTN","GMTSY104",23,0)
 ;;Medication Worksheet (Tool #2)
"RTN","GMTSY104",24,0)
 ;;MAS CONTACTS
"RTN","GMTSY104",25,0)
 ;;MAS MH CLINIC VISITS FUTURE
"RTN","GMTSY104",26,0)
 ;;MH HIGH RISK PRF HX
"RTN","GMTSY104",27,0)
 ;;MH TREATMENT COORDINATOR
"RTN","GMTSY104",28,0)
 Q
"RTN","GMTSY104",29,0)
 ;
"RTN","GMTSY104",30,0)
POST ;post-install
"RTN","GMTSY104",31,0)
 ;update MHRF component description
"RTN","GMTSY104",32,0)
 ;WP^DIE(FILE,IENS,FIELD,FLAGS,wp_root,msg_root)
"RTN","GMTSY104",33,0)
 N GMTSIEN,MSG
"RTN","GMTSY104",34,0)
 K ^TMP($J,"WP")
"RTN","GMTSY104",35,0)
 D BMES^XPDUTL("Updating description for Health Summary Component MH HIGH RISK FOR SUICIDE")
"RTN","GMTSY104",36,0)
 S ^TMP($J,"WP",1,0)="This component displays the assignment status and history for the "
"RTN","GMTSY104",37,0)
 S ^TMP($J,"WP",2,0)="Category I (National) HIGH RISK FOR SUICIDE Patient Record Flag."
"RTN","GMTSY104",38,0)
 S ^TMP($J,"WP",3,0)="Any assignment history found for the Category II (Local) High Risk for "
"RTN","GMTSY104",39,0)
 S ^TMP($J,"WP",4,0)="Suicide flag will also be displayed."
"RTN","GMTSY104",40,0)
 S GMTSIEN=$$FIND1^DIC(142.1,"","X","MH HIGH RISK PRF HX","B",,"MSG")
"RTN","GMTSY104",41,0)
 I +$G(GMTSIEN)'>0 K ^TMP($J,"WP") D BMES^XPDUTL("  Error during lookup of MH HIGH RISK PRF HX component.  ") D  Q
"RTN","GMTSY104",42,0)
 .I $D(MSG)>0 D AWRITE("MSG")
"RTN","GMTSY104",43,0)
 K MSG
"RTN","GMTSY104",44,0)
 D WP^DIE(142.1,GMTSIEN_",",3.5,"K","^TMP($J,""WP"")","MSG")
"RTN","GMTSY104",45,0)
 I $D(MSG)>0 D AWRITE("MSG")
"RTN","GMTSY104",46,0)
 D:$D(MSG)'>0 BMES^XPDUTL("  Update Successful  ")
"RTN","GMTSY104",47,0)
 Q
"RTN","GMTSY104",48,0)
 ;
"RTN","GMTSY104",49,0)
AWRITE(REF) ;Write all the descendants of the array reference.
"RTN","GMTSY104",50,0)
 ;REF is the starting array reference, for example A or ^TMP("SOME NAME",$J).
"RTN","GMTSY104",51,0)
 N DONE,IND,LEN,LN,PROOT,ROOT,START,TEMP,GMTSTEXT
"RTN","GMTSY104",52,0)
 I REF="" Q
"RTN","GMTSY104",53,0)
 S LN=0
"RTN","GMTSY104",54,0)
 S PROOT=$P(REF,")",1)
"RTN","GMTSY104",55,0)
 ;Build the root so we can tell when we are done.
"RTN","GMTSY104",56,0)
 S TEMP=$NA(@REF)
"RTN","GMTSY104",57,0)
 S ROOT=$P(TEMP,")",1)
"RTN","GMTSY104",58,0)
 S REF=$Q(@REF)
"RTN","GMTSY104",59,0)
 I REF'[ROOT Q
"RTN","GMTSY104",60,0)
 S DONE=0
"RTN","GMTSY104",61,0)
 F  Q:(REF="")!(DONE)  D
"RTN","GMTSY104",62,0)
 . S START=$F(REF,ROOT)
"RTN","GMTSY104",63,0)
 . S LEN=$L(REF)
"RTN","GMTSY104",64,0)
 . S IND=$E(REF,START,LEN)
"RTN","GMTSY104",65,0)
 . S LN=LN+1,GMTSTEXT(LN)=PROOT_IND_"="_@REF
"RTN","GMTSY104",66,0)
 . S REF=$Q(@REF)
"RTN","GMTSY104",67,0)
 . I REF'[ROOT S DONE=1
"RTN","GMTSY104",68,0)
 D MES^XPDUTL(.GMTSTEXT)
"RTN","GMTSY104",69,0)
 Q
"RTN","GMTSY104",70,0)
 ;
"RTN","PXRMP24I")
0^^B14301202
"RTN","PXRMP24I",1,0)
PXRMP24I ;SLC/PKR - Inits for PXRM*2.0*24. ;10/12/2012
"RTN","PXRMP24I",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 58
"RTN","PXRMP24I",3,0)
 Q
"RTN","PXRMP24I",4,0)
 ;==========================================
"RTN","PXRMP24I",5,0)
CFINC(Y) ;List of computed findings to include in the build.
"RTN","PXRMP24I",6,0)
 N CFLIST,CFNAME,INC
"RTN","PXRMP24I",7,0)
 S CFLIST("VA-ADMISSIONS FOR A DATE RANGE")=""
"RTN","PXRMP24I",8,0)
 S CFLIST("VA-APPOINTMENTS FOR A PATIENT")=""
"RTN","PXRMP24I",9,0)
 S CFLIST("VA-ASU USER CLASS")=""
"RTN","PXRMP24I",10,0)
 S CFLIST("VA-EMPLOYEE")=""
"RTN","PXRMP24I",11,0)
 S CFLIST("VA-PATIENT RECORD FLAG LIST")=""
"RTN","PXRMP24I",12,0)
 S CFLIST("VA-PATIENTS WITH APPOINTMENTS")=""
"RTN","PXRMP24I",13,0)
 S CFLIST("VA-PCMM MHTC")=""
"RTN","PXRMP24I",14,0)
 ;S CFLIST("")=""
"RTN","PXRMP24I",15,0)
 S CFNAME=$P($G(^PXRMD(811.4,Y,0)),U)
"RTN","PXRMP24I",16,0)
 S INC=$S($D(CFLIST(CFNAME)):1,1:0)
"RTN","PXRMP24I",17,0)
 I INC D RMEHIST^PXRMUTIL(811.4,Y)
"RTN","PXRMP24I",18,0)
 Q INC
"RTN","PXRMP24I",19,0)
 ;
"RTN","PXRMP24I",20,0)
 ;==========================================
"RTN","PXRMP24I",21,0)
MPBPRE ;Pre-init for mult-package build.
"RTN","PXRMP24I",22,0)
 S XPDNOQUE=1
"RTN","PXRMP24I",23,0)
 Q
"RTN","PXRMP24I",24,0)
 ;
"RTN","PXRMP24I",25,0)
 ;==========================================
"RTN","PXRMP24I",26,0)
PRE ;Pre-init
"RTN","PXRMP24I",27,0)
 ;Disable options and protocols
"RTN","PXRMP24I",28,0)
 D OPTION^PXRMUTIL("DISABLE")
"RTN","PXRMP24I",29,0)
 D PROTOCOL^PXRMUTIL("DISABLE")
"RTN","PXRMP24I",30,0)
 D DELEXE^PXRMEXSI("EXARRAY","PXRMP24E")
"RTN","PXRMP24I",31,0)
 D REEXCH^PXRMP24I
"RTN","PXRMP24I",32,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH APPTS FOR MHTC ASSIGNMENT","VA-MH KEPT APPTS FOR MHTC ASSIGNMENT")
"RTN","PXRMP24I",33,0)
 Q
"RTN","PXRMP24I",34,0)
 ;
"RTN","PXRMP24I",35,0)
 ;==========================================
"RTN","PXRMP24I",36,0)
POST ;Post-init
"RTN","PXRMP24I",37,0)
 ;Enable options and protocols
"RTN","PXRMP24I",38,0)
 D OPTION^PXRMUTIL("ENABLE")
"RTN","PXRMP24I",39,0)
 D PROTOCOL^PXRMUTIL("ENABLE")
"RTN","PXRMP24I",40,0)
 D SETPVER^PXRMUTIL("2.0P24")
"RTN","PXRMP24I",41,0)
 ;Install Exchange File entries.
"RTN","PXRMP24I",42,0)
 D SMEXINS^PXRMEXSI("EXARRAY","PXRMP24E")
"RTN","PXRMP24I",43,0)
 D RHTF^PXRMP24I
"RTN","PXRMP24I",44,0)
 D SENDIM^PXRMP24I
"RTN","PXRMP24I",45,0)
 Q
"RTN","PXRMP24I",46,0)
 ;
"RTN","PXRMP24I",47,0)
 ;==========================================
"RTN","PXRMP24I",48,0)
REEXCH ;Rename reminder definition VA-MHTC CANDIDATE and remove the old
"RTN","PXRMP24I",49,0)
 ;Exchange entry
"RTN","PXRMP24I",50,0)
 N IEN,LIST,LUVALUE,PXRMINST
"RTN","PXRMP24I",51,0)
 S PXRMINST=1
"RTN","PXRMP24I",52,0)
 D RENAME^PXRMUTIL(811.9,"VA-MHTC CANDIDATE","VA-MHTC NEEDS ASSIGNMENT")
"RTN","PXRMP24I",53,0)
 S LUVALUE(1)="VA-MHTC CANDIDATE"
"RTN","PXRMP24I",54,0)
 S LUVALUE(2)="05/23/2012@09:42:32"
"RTN","PXRMP24I",55,0)
 S IEN=$$FIND1^DIC(811.8,"","KU",.LUVALUE)
"RTN","PXRMP24I",56,0)
 S LIST(IEN)=""
"RTN","PXRMP24I",57,0)
 D DELETE^PXRMEXU1(.LIST)
"RTN","PXRMP24I",58,0)
 Q
"RTN","PXRMP24I",59,0)
 ;
"RTN","PXRMP24I",60,0)
 ;==========================================
"RTN","PXRMP24I",61,0)
RHTF ;Rename and inactivate health factors and terms that are no longer used.
"RTN","PXRMP24I",62,0)
 N IEN,NAME
"RTN","PXRMP24I",63,0)
 D BMES^XPDUTL("Renaming/inactivating health factors and terms that are no longer used.")
"RTN","PXRMP24I",64,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW INITIATE WELLNESS CHECK","ZZMH NOSHOW INITIATE WELLNESS CHECK")
"RTN","PXRMP24I",65,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW SUPPORT CONTACT","ZZMH NOSHOW SUPPORT CONTACT")
"RTN","PXRMP24I",66,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW UNABLE TO REACH PT","ZZMH NOSHOW UNABLE TO REACH PT")
"RTN","PXRMP24I",67,0)
 F NAME="ZZMH NOSHOW INITIATE WELLNESS CHECK","ZZMH NOSHOW SUPPORT CONTACT","ZZMH NOSHOW UNABLE TO REACH PT" D
"RTN","PXRMP24I",68,0)
 . S IEN=+$$FIND1^DIC(9999999.64,"","BX",NAME)
"RTN","PXRMP24I",69,0)
 . I IEN>0 S $P(^AUTTHF(IEN,0),U,11)=1
"RTN","PXRMP24I",70,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW INITIATE WELLNESS CHECK","ZZVA-MH NOSHOW INITIATE WELLNESS CHECK")
"RTN","PXRMP24I",71,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW SUPPORT CONTACT","ZZVA-MH NOSHOW SUPPORT CONTACT")
"RTN","PXRMP24I",72,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW UNABLE TO REACH PT","ZZVA-MH NOSHOW UNABLE TO REACH PT")
"RTN","PXRMP24I",73,0)
 Q
"RTN","PXRMP24I",74,0)
 ;
"RTN","PXRMP24I",75,0)
 ;==========================================
"RTN","PXRMP24I",76,0)
SENDIM ;Send install message.
"RTN","PXRMP24I",77,0)
 N FROM,NODE,PARAM,SYSTEM,SUBJECT,TO,VALUE
"RTN","PXRMP24I",78,0)
 S NODE="PXRM*2.0*24"
"RTN","PXRMP24I",79,0)
 K ^TMP(NODE,$J)
"RTN","PXRMP24I",80,0)
 ;DBIA #1131 for ^XMB("NETNAME")
"RTN","PXRMP24I",81,0)
 S FROM="PXRM*2.0*24 Install@"_^XMB("NETNAME")
"RTN","PXRMP24I",82,0)
 ;DBIA #2541
"RTN","PXRMP24I",83,0)
 S SYSTEM=$$KSP^XUPARAM("WHERE")
"RTN","PXRMP24I",84,0)
 I $$PROD^XUPROD(1) S TO("G.CLINICAL REMINDERS SUPPORT@D.DOMAIN.EXT")=""
"RTN","PXRMP24I",85,0)
 E  D
"RTN","PXRMP24I",86,0)
 . N MGIEN,MGROUP
"RTN","PXRMP24I",87,0)
 . S MGIEN=$G(^PXRM(800,1,"MGFE"))
"RTN","PXRMP24I",88,0)
 . S MGROUP=$S(MGIEN'="":"G."_$$GET1^DIQ(3.8,MGIEN,.01),1:DUZ)
"RTN","PXRMP24I",89,0)
 . S TO(MGROUP)=""
"RTN","PXRMP24I",90,0)
 S SUBJECT="Install of PXRM*2.0*24"
"RTN","PXRMP24I",91,0)
 S ^TMP(NODE,$J,1,0)="PXRM*2.0*24 has been installed."
"RTN","PXRMP24I",92,0)
 S ^TMP(NODE,$J,2,0)="System is "_SYSTEM
"RTN","PXRMP24I",93,0)
 D SEND^PXRMMSG(NODE,SUBJECT,.TO,FROM)
"RTN","PXRMP24I",94,0)
 Q
"RTN","PXRMP24I",95,0)
 ;
"VER")
8.0^22.0
**INSTALL NAME**
TIU*1.0*265
"BLD",8190,0)
TIU*1.0*265^TEXT INTEGRATION UTILITIES^0^3130509^y
"BLD",8190,1,0)
^^2^2^3121129^
"BLD",8190,1,1,0)
The description of this build can be found in the National Patch Module
"BLD",8190,1,2,0)
under patch TIU*1*265.
"BLD",8190,4,0)
^9.64PA^^0
"BLD",8190,6)
6^
"BLD",8190,6.3)
25
"BLD",8190,"INID")
^n
"BLD",8190,"INIT")
TIUPS265
"BLD",8190,"KRN",0)
^9.67PA^779.2^20
"BLD",8190,"KRN",.4,0)
.4
"BLD",8190,"KRN",.401,0)
.401
"BLD",8190,"KRN",.402,0)
.402
"BLD",8190,"KRN",.403,0)
.403
"BLD",8190,"KRN",.5,0)
.5
"BLD",8190,"KRN",.84,0)
.84
"BLD",8190,"KRN",3.6,0)
3.6
"BLD",8190,"KRN",3.8,0)
3.8
"BLD",8190,"KRN",9.2,0)
9.2
"BLD",8190,"KRN",9.8,0)
9.8
"BLD",8190,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8190,"KRN",9.8,"NM",1,0)
TIULO1^^0^B21084404
"BLD",8190,"KRN",9.8,"NM","B","TIULO1",1)

"BLD",8190,"KRN",19,0)
19
"BLD",8190,"KRN",19,"NM",0)
^9.68A^^
"BLD",8190,"KRN",19.1,0)
19.1
"BLD",8190,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",8190,"KRN",101,0)
101
"BLD",8190,"KRN",409.61,0)
409.61
"BLD",8190,"KRN",771,0)
771
"BLD",8190,"KRN",779.2,0)
779.2
"BLD",8190,"KRN",870,0)
870
"BLD",8190,"KRN",8989.51,0)
8989.51
"BLD",8190,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",8190,"KRN",8989.51,"NM",1,0)
TIU TEMPLATE REMINDER DIALOGS^^0
"BLD",8190,"KRN",8989.51,"NM","B","TIU TEMPLATE REMINDER DIALOGS",1)

"BLD",8190,"KRN",8989.52,0)
8989.52
"BLD",8190,"KRN",8994,0)
8994
"BLD",8190,"KRN","B",.4,.4)

"BLD",8190,"KRN","B",.401,.401)

"BLD",8190,"KRN","B",.402,.402)

"BLD",8190,"KRN","B",.403,.403)

"BLD",8190,"KRN","B",.5,.5)

"BLD",8190,"KRN","B",.84,.84)

"BLD",8190,"KRN","B",3.6,3.6)

"BLD",8190,"KRN","B",3.8,3.8)

"BLD",8190,"KRN","B",9.2,9.2)

"BLD",8190,"KRN","B",9.8,9.8)

"BLD",8190,"KRN","B",19,19)

"BLD",8190,"KRN","B",19.1,19.1)

"BLD",8190,"KRN","B",101,101)

"BLD",8190,"KRN","B",409.61,409.61)

"BLD",8190,"KRN","B",771,771)

"BLD",8190,"KRN","B",779.2,779.2)

"BLD",8190,"KRN","B",870,870)

"BLD",8190,"KRN","B",8989.51,8989.51)

"BLD",8190,"KRN","B",8989.52,8989.52)

"BLD",8190,"KRN","B",8994,8994)

"BLD",8190,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8190,"QUES",0)
^9.62^^
"BLD",8190,"REQB",0)
^9.611^^0
"INIT")
TIUPS265
"KRN",8989.51,4716,-1)
0^1
"KRN",8989.51,4716,0)
TIU TEMPLATE REMINDER DIALOGS^Reminder Dialogs allowed as Templates^1^Display Sequence^Clinical Reminder Dialog
"KRN",8989.51,4716,1)
P^801.41^Enter Reminder Dialogs that can be used as a Template
"KRN",8989.51,4716,3)
I $$CANUREMD^TIUCHECK(Y)=1
"KRN",8989.51,4716,6)
N^^Enter Sequence Number of Reminder Dialog
"KRN",8989.51,4716,20,0)
^8989.512^4^4^3010619^^
"KRN",8989.51,4716,20,1,0)
Contains Reminder Dialogs that are allowed to be used as TIU Templates.
"KRN",8989.51,4716,20,2,0)
This parameter is different than most others in that each level is
"KRN",8989.51,4716,20,3,0)
cumulative, so all Reminder Dialogs at the System, Division, Service
"KRN",8989.51,4716,20,4,0)
and User levels can be used in Templates.
"KRN",8989.51,4716,30,0)
^8989.513I^4^4
"KRN",8989.51,4716,30,1,0)
1^200
"KRN",8989.51,4716,30,2,0)
3^49
"KRN",8989.51,4716,30,3,0)
4^4
"KRN",8989.51,4716,30,4,0)
5^4.2
"MBREQ")
1
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",193,-1)
1^1
"PKG",193,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",193,20,0)
^9.402P^^
"PKG",193,22,0)
^9.49I^1^1
"PKG",193,22,1,0)
1.0^3010321^3010321^11
"PKG",193,22,1,"PAH",1,0)
265^3130509^1342
"PKG",193,22,1,"PAH",1,1,0)
^^2^2^3130509
"PKG",193,22,1,"PAH",1,1,1,0)
The description of this build can be found in the National Patch Module
"PKG",193,22,1,"PAH",1,1,2,0)
under patch TIU*1*265.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","TIULO1")
0^1^B21084404
"RTN","TIULO1",1,0)
TIULO1 ; SLC/JER - More embedded Objects ;05/31/12  14:33
"RTN","TIULO1",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**47,260,265**;Jun 20, 1997;Build 25
"RTN","TIULO1",3,0)
 ;
"RTN","TIULO1",4,0)
 ;^XLFSTR 10104, ^XLFDT 10103, ^PXRMD(810.9 5599, ^SC("AST" 4482, ^SDAPI^SDAMA301 4433, ^VADPT 10061
"RTN","TIULO1",5,0)
 ;^LAB(60,"B" 3853, LR7OR2 3856
"RTN","TIULO1",6,0)
 ;
"RTN","TIULO1",7,0)
VISDATE(TIU) ; Visit date/time
"RTN","TIULO1",8,0)
 N TIUX,TIUY
"RTN","TIULO1",9,0)
 S TIUX=$S(+$G(TIU("VISIT")):$P($G(TIU("VISIT")),U,2),$L($G(TIU("VSTR"))):$P($G(TIU("VSTR")),";",2),1:"")
"RTN","TIULO1",10,0)
 I TIUX']"" S TIUY="VISIT DATE UNKNOWN" G VISDTX
"RTN","TIULO1",11,0)
 S TIUY=$$DATE^TIULS(TIUX,"MM/DD/YY HR:MIN")
"RTN","TIULO1",12,0)
VISDTX Q $G(TIUY)
"RTN","TIULO1",13,0)
LABS(DFN,TIUTEST,TIUEDT,TIULDT) ; Get Lab Results
"RTN","TIULO1",14,0)
 N TIUY,TIUTST,TIUX S TIUTST=+$O(^LAB(60,"B",TIUTEST,0))
"RTN","TIULO1",15,0)
 I '+$G(TIUTST) G LABX
"RTN","TIULO1",16,0)
 D TEST^LR7OR2(.TIUY,DFN,"",$G(TIUEDT),$G(TIULDT),"",TIUTST)
"RTN","TIULO1",17,0)
 S TIUX=$S($D(TIUY)#2:$G(@TIUY@(1)),1:"____")
"RTN","TIULO1",18,0)
 I $L(TIUX,U)>1 D
"RTN","TIULO1",19,0)
 . S TIUTST=$P(TIUX,U,4)_" "_$P(TIUX,U,6)_" "_$P(TIUX,U,5)_"    ("
"RTN","TIULO1",20,0)
 . S TIUTST=TIUTST_$$DATE^TIULS($P(TIUX,U),"MM/DD/CCYY HR:MIN")_")"
"RTN","TIULO1",21,0)
 E  S TIUTST=TIUX
"RTN","TIULO1",22,0)
 I $D(TIUY)#2 K @TIUY
"RTN","TIULO1",23,0)
LABX Q $G(TIUTST)
"RTN","TIULO1",24,0)
 ;
"RTN","TIULO1",25,0)
HPHONE(DFN) ;Current Home Telephone Number
"RTN","TIULO1",26,0)
 N VAPA
"RTN","TIULO1",27,0)
 D ADD^VADPT
"RTN","TIULO1",28,0)
HPHX Q $G(VAPA(8))
"RTN","TIULO1",29,0)
 ;
"RTN","TIULO1",30,0)
SADD(DFN) ;Single Line Street Address
"RTN","TIULO1",31,0)
 N VAPA,J
"RTN","TIULO1",32,0)
 D ADD^VADPT
"RTN","TIULO1",33,0)
 S:$D(VAPA(1)) J=VAPA(1) S:$D(VAPA(2)) J=J_"  "_VAPA(2) S:$D(VAPA(3)) J=J_"  "_VAPA(3)
"RTN","TIULO1",34,0)
SADX Q J
"RTN","TIULO1",35,0)
 ;
"RTN","TIULO1",36,0)
CISTZI(DFN) ;City, State, Zip
"RTN","TIULO1",37,0)
 N VAPA,J
"RTN","TIULO1",38,0)
 D ADD^VADPT
"RTN","TIULO1",39,0)
 S:$D(VAPA(4)) J=VAPA(4) S:$D(VAPA(5)) J=J_", "_$P(VAPA(5),U,2) S:$D(VAPA(6)) J=J_", "_VAPA(6)
"RTN","TIULO1",40,0)
CSTX Q J
"RTN","TIULO1",41,0)
 ;
"RTN","TIULO1",42,0)
MSTAPPT(DFN,TARGET) ;Missed MH appointments for past 10 days;; WAT-TIU*1.0*260
"RTN","TIULO1",43,0)
 K ^TMP($J,"TIU CLIN LIST"),@TARGET
"RTN","TIULO1",44,0)
 N CLINCNT S CLINCNT=1
"RTN","TIULO1",45,0)
 N RMLL,RMLLSTP,RMCLINIC,RMCLNCNT
"RTN","TIULO1",46,0)
 N TIUARR,SDCOUNT,SDDFN,SDDATE,SDAPPT,SDDATIME,SDCLINIC,APSTATUS,CLINAME
"RTN","TIULO1",47,0)
 N LINE,IDX1,ERROR,ENDT,DASH73
"RTN","TIULO1",48,0)
 S $P(DASH73,"=",73)="="
"RTN","TIULO1",49,0)
 S LINE=0,ERROR=0
"RTN","TIULO1",50,0)
 S @TARGET@(LINE,0)="",LINE=LINE+1
"RTN","TIULO1",51,0)
 S @TARGET@(LINE,0)="MH Appointments Missed Last 10 Days",LINE=LINE+1
"RTN","TIULO1",52,0)
 S @TARGET@(LINE,0)="",LINE=LINE+1
"RTN","TIULO1",53,0)
 S RMLL=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",""))
"RTN","TIULO1",54,0)
 S RMCLNCNT=0,IDX1=0,RMCLINIC=""
"RTN","TIULO1",55,0)
 I $G(RMLL)="" S SDCOUNT=0 D ERROR Q "~@"_$NA(@TARGET)  ;error and quit if RMLL not found
"RTN","TIULO1",56,0)
 F  S IDX1=$O(^PXRMD(810.9,RMLL,40.7,IDX1)) Q:IDX1'>0!(ERROR=1)  D
"RTN","TIULO1",57,0)
 .S RMLLSTP=^PXRMD(810.9,RMLL,40.7,IDX1,0)
"RTN","TIULO1",58,0)
 .S RMLLSTP=$P($G(RMLLSTP),"^") ;->this is the stop code, now get clinics for this stop code
"RTN","TIULO1",59,0)
 .Q:$D(^SC("AST",RMLLSTP))=0
"RTN","TIULO1",60,0)
 .F  S RMCLINIC=$O(^SC("AST",RMLLSTP,RMCLINIC)) Q:RMCLINIC=""!(ERROR=1)  D
"RTN","TIULO1",61,0)
 ..S ^TMP($J,"TIU CLIN LIST",RMCLINIC)=RMCLINIC
"RTN","TIULO1",62,0)
 ;NOW HAVE LIST OF CLINICS TO SEARCH FOR APPOINTMENTS
"RTN","TIULO1",63,0)
 ;CALL SDAPI ONCE FOR ALL CLINICS IN THE LIST
"RTN","TIULO1",64,0)
 S ENDT=$$FMADD^XLFDT(DT,-10)
"RTN","TIULO1",65,0)
 S TIUARR(1)=ENDT_";"_DT
"RTN","TIULO1",66,0)
 S TIUARR(2)="^TMP($J,""TIU CLIN LIST""" ;an array of clinic IENs
"RTN","TIULO1",67,0)
 S TIUARR(3)="NS;NSR" ;appt status NO SHOW & NO SHOW RESCHEDULED
"RTN","TIULO1",68,0)
 S TIUARR(4)=DFN
"RTN","TIULO1",69,0)
 S TIUARR("FLDS")="1;2;4;3"
"RTN","TIULO1",70,0)
 S TIUARR("SORT")="P"
"RTN","TIULO1",71,0)
 S SDCOUNT=$$SDAPI^SDAMA301(.TIUARR)
"RTN","TIULO1",72,0)
 I SDCOUNT=0 S @TARGET@(LINE,0)="No Missed Appointments Found",LINE=LINE+1
"RTN","TIULO1",73,0)
 I SDCOUNT<0 D ERROR Q "~@"_$NA(@TARGET)
"RTN","TIULO1",74,0)
 I SDCOUNT>0 D
"RTN","TIULO1",75,0)
 . S @TARGET@(LINE,0)="DATE/TIME"_$J("CLINIC",19)_$J("STATUS",32),LINE=LINE+1
"RTN","TIULO1",76,0)
 . S @TARGET@(LINE,0)=DASH73,LINE=LINE+1
"RTN","TIULO1",77,0)
 . S SDDFN=0 F  S SDDFN=$O(^TMP($J,"SDAMA301",SDDFN)) Q:SDDFN=""  D
"RTN","TIULO1",78,0)
 .. ;get appointment date/time
"RTN","TIULO1",79,0)
 .. S SDDATE=0 F  S SDDATE=$O(^TMP($J,"SDAMA301",SDDFN,SDDATE)) Q:SDDATE=""  D
"RTN","TIULO1",80,0)
 ... S SDAPPT=$G(^TMP($J,"SDAMA301",SDDFN,SDDATE)) ;appointment data
"RTN","TIULO1",81,0)
 ... S SDDATIME=$P($G(SDAPPT),"^",1) ;appointment date/time
"RTN","TIULO1",82,0)
 ... S APSTATUS=$P($G(SDAPPT),"^",3),APSTATUS=$P(APSTATUS,";",2)
"RTN","TIULO1",83,0)
 ... S CLINAME=$P($G(SDAPPT),"^",2),CLINAME=$P(CLINAME,";",2) ;CLINIC NAME
"RTN","TIULO1",84,0)
 ... I $L(CLINAME)<30 S CLINAME=CLINAME_($$REPEAT^XLFSTR(" ",(30-$L(CLINAME))))
"RTN","TIULO1",85,0)
 ... S SDDATIME=$$FMTE^XLFDT(SDDATIME,"5ZP")
"RTN","TIULO1",86,0)
 ... I $L(SDDATIME)<20 S SDDATIME=SDDATIME_($$REPEAT^XLFSTR(" ",(22-$L(SDDATIME)))) ;WAT/265
"RTN","TIULO1",87,0)
 ... I APSTATUS["&" S APSTATUS=$E(APSTATUS,1,17)_"."
"RTN","TIULO1",88,0)
 ... I $L(APSTATUS)<18 S APSTATUS=APSTATUS_($$REPEAT^XLFSTR(" ",(18-$L(APSTATUS))))
"RTN","TIULO1",89,0)
 ... S @TARGET@(LINE,0)=SDDATIME_CLINAME_$J(APSTATUS,20),LINE=LINE+1
"RTN","TIULO1",90,0)
 I SDCOUNT'=0 K ^TMP($J,"SDAMA301")
"RTN","TIULO1",91,0)
 Q "~@"_$NA(@TARGET)
"RTN","TIULO1",92,0)
 ;
"RTN","TIULO1",93,0)
ERROR ;errors returned from SDAPI
"RTN","TIULO1",94,0)
 N IDXERR S IDXERR=""
"RTN","TIULO1",95,0)
 I $G(RMLL)="" S @TARGET@(LINE,0)="Reminder location list not found. Unable to retrun appointment data",LINE=LINE+1 Q
"RTN","TIULO1",96,0)
 F  S IDXERR=$O(^TMP($J,"SDAMA301",IDXERR)) Q:IDXERR'>0  D
"RTN","TIULO1",97,0)
 .S @TARGET@(LINE,0)=^TMP($J,"SDAMA301",IDXERR),LINE=LINE+1
"RTN","TIULO1",98,0)
 Q
"RTN","TIUPS265")
0^^B9608303
"RTN","TIUPS265",1,0)
TIUPS265 ; ISD/HGW - Post-Install for 265 ;03/13/12  15:46
"RTN","TIUPS265",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**265**;Jun 20, 1997;Build 25
"RTN","TIUPS265",3,0)
 ;  Post Installation Routine for patch TIU*1.0*265
"RTN","TIUPS265",4,0)
 ;  Installs Title and maps it to Enterprise Standard Title and Document Class
"RTN","TIUPS265",5,0)
 ;
"RTN","TIUPS265",6,0)
 ;  EXTERNAL REFERENCES
"RTN","TIUPS265",7,0)
 ;    BMES^XPDUTL 10141
"RTN","TIUPS265",8,0)
 ;    $$FIND1^DIC
"RTN","TIUPS265",9,0)
 ;    NOW^%DTC
"RTN","TIUPS265",10,0)
 ;    UPDATE^DIE 2053
"RTN","TIUPS265",11,0)
 ;
"RTN","TIUPS265",12,0)
MAIN ; Control subroutine
"RTN","TIUPS265",13,0)
 N TIUFPRIV,TIU265X,TIUDNM,TIUSNM,TIUNATL,TIUDC
"RTN","TIUPS265",14,0)
 S TIUFPRIV=1
"RTN","TIUPS265",15,0)
 S TIUDNM="PATIENT RECORD FLAG CATEGORY I - HIGH RISK FOR SUICIDE" ; Name
"RTN","TIUPS265",16,0)
 S TIUSNM="PRF Cat I - Suicide" ; Short Name
"RTN","TIUPS265",17,0)
 S TIUNATL="MENTAL HEALTH PATIENT RECORD FLAG" ; Enterprise Standard Title
"RTN","TIUPS265",18,0)
 S TIUDC="PATIENT RECORD FLAG CAT I" ; Document Class
"RTN","TIUPS265",19,0)
 S TIU265X=$$CREATE(TIUDNM,TIUNATL) ; TIU265X is "Success message" or "Error text"
"RTN","TIUPS265",20,0)
 D BMES^XPDUTL(TIU265X)
"RTN","TIUPS265",21,0)
 S TIU265X=$$INSTALL(TIUDNM,TIUDC,TIUSNM) ; TIU265X is "Success message" or "Error text"
"RTN","TIUPS265",22,0)
 D BMES^XPDUTL(TIU265X)
"RTN","TIUPS265",23,0)
 Q
"RTN","TIUPS265",24,0)
CREATE(TIUDNM,TIUNATL) ; Create new DDEF entry
"RTN","TIUPS265",25,0)
 N %,TIUERR,TIUFDA,TIUIEN,TIUMSG
"RTN","TIUPS265",26,0)
 S TIUERR="   Title Created: "_TIUDNM
"RTN","TIUPS265",27,0)
 S TIUFDA(8925.1,"?+1,",.01)=TIUDNM ; NAME
"RTN","TIUPS265",28,0)
 S TIUFDA(8925.1,"?+1,",.03)=TIUDNM ; PRINT NAME
"RTN","TIUPS265",29,0)
 S TIUFDA(8925.1,"?+1,",.04)="DOC" ; TYPE: TITLE
"RTN","TIUPS265",30,0)
 S TIUFDA(8925.1,"?+1,",.06)=$$FIND1^DIC(8930,"","X","CLINICAL COORDINATOR","B") ; OWNER
"RTN","TIUPS265",31,0)
 S TIUFDA(8925.1,"?+1,",.07)=11 ; STATUS: ACTIVE
"RTN","TIUPS265",32,0)
 S TIUFDA(8925.1,"?+1,",.13)=1 ; NATIONAL STANDARD: YES
"RTN","TIUPS265",33,0)
 S TIUFDA(8925.1,"?+1,",3.02)=1 ; OK TO DISTRIBUTE: YES
"RTN","TIUPS265",34,0)
 S TIUFDA(8925.1,"?+1,",99)=$H ; TIMESTAMP
"RTN","TIUPS265",35,0)
 S TIUFDA(8925.1,"?+1,",1501)=$$FIND1^DIC(8926.1,"","X",TIUNATL,"B") ; VHA ENTERPRISE STANDARD TITLE
"RTN","TIUPS265",36,0)
 D NOW^%DTC S TIUFDA(8925.1,"?+1,",1502)=% ; MAP ATTEMPTED
"RTN","TIUPS265",37,0)
 S TIUFDA(8925.1,"?+1,",1503)=DUZ ; MAP ATTEMPTED BY
"RTN","TIUPS265",38,0)
 D UPDATE^DIE("","TIUFDA","TIUIEN","TIUMSG")
"RTN","TIUPS265",39,0)
 I $D(TIUMSG) D  Q TIUERR
"RTN","TIUPS265",40,0)
 . S TIUERR="   **ERROR** "_$G(TIUMSG("DIERR",1))_" Unable to create Title "_TIUDNM
"RTN","TIUPS265",41,0)
 Q TIUERR
"RTN","TIUPS265",42,0)
INSTALL(TIUDNM,TIUDC,TIUSNM) ; Install document definition
"RTN","TIUPS265",43,0)
 N TIUERR,TIUFPRIV,TIUTIEN,TIUDIEN,TIUFDA,TIUIEN,TIUMSG
"RTN","TIUPS265",44,0)
 S TIUERR="   Title attached to Document Class "_TIUDC
"RTN","TIUPS265",45,0)
 S TIUFPRIV=1
"RTN","TIUPS265",46,0)
 ; Find the IEN of the Title
"RTN","TIUPS265",47,0)
 S TIUTIEN=$$FIND1^DIC(8925.1,"","X",TIUDNM,"B")
"RTN","TIUPS265",48,0)
 I 'TIUTIEN D  Q TIUERR
"RTN","TIUPS265",49,0)
 . S TIUERR="   **ERROR** Unable to locate Title "_TIUDNM
"RTN","TIUPS265",50,0)
 ; Find the IEN of the Document Class
"RTN","TIUPS265",51,0)
 S TIUDIEN=$$FIND1^DIC(8925.1,"","X",TIUDC,"B")
"RTN","TIUPS265",52,0)
 I 'TIUDIEN D  Q TIUERR
"RTN","TIUPS265",53,0)
 . S TIUERR="   **ERROR** Unable to locate Document Class "_TIUDC
"RTN","TIUPS265",54,0)
 ; Attach the Title to Document Class
"RTN","TIUPS265",55,0)
 S TIUFDA(8925.14,"?+2,"_TIUDIEN_",",.01)=TIUTIEN ; ITEM
"RTN","TIUPS265",56,0)
 S TIUFDA(8925.14,"?+2,"_TIUDIEN_",",2)="" ; MNEMONIC
"RTN","TIUPS265",57,0)
 S TIUFDA(8925.14,"?+2,"_TIUDIEN_",",3)="" ; SEQUENCE
"RTN","TIUPS265",58,0)
 S TIUFDA(8925.14,"?+2,"_TIUDIEN_",",4)=TIUSNM ; MENU TEXT
"RTN","TIUPS265",59,0)
 D UPDATE^DIE("","TIUFDA","TIUIEN","TIUMSG")
"RTN","TIUPS265",60,0)
 I $D(TIUMSG) D  Q TIUERR
"RTN","TIUPS265",61,0)
 . S TIUERR="   **ERROR** Unable to update Document Class "_TIUDC
"RTN","TIUPS265",62,0)
 Q TIUERR
"VER")
8.0^22.0
**INSTALL NAME**
DG*5.3*849
"BLD",8191,0)
DG*5.3*849^REGISTRATION^0^3130509^y
"BLD",8191,1,0)
^9.61A^1^1^3120109^^^
"BLD",8191,1,1,0)
DGPF NEW CAT1 FLAG AND CONVERSION
"BLD",8191,4,0)
^9.64PA^^0
"BLD",8191,6.3)
28
"BLD",8191,"INI")

"BLD",8191,"INID")
^n^
"BLD",8191,"INIT")
DG53849P
"BLD",8191,"KRN",0)
^9.67PA^779.2^20
"BLD",8191,"KRN",.4,0)
.4
"BLD",8191,"KRN",.401,0)
.401
"BLD",8191,"KRN",.402,0)
.402
"BLD",8191,"KRN",.403,0)
.403
"BLD",8191,"KRN",.5,0)
.5
"BLD",8191,"KRN",.84,0)
.84
"BLD",8191,"KRN",3.6,0)
3.6
"BLD",8191,"KRN",3.8,0)
3.8
"BLD",8191,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",8191,"KRN",3.8,"NM",1,0)
DGPF CLINICAL HR FLAG REVIEW^^0
"BLD",8191,"KRN",3.8,"NM","B","DGPF CLINICAL HR FLAG REVIEW",1)

"BLD",8191,"KRN",9.2,0)
9.2
"BLD",8191,"KRN",9.8,0)
9.8
"BLD",8191,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",8191,"KRN",9.8,"NM",1,0)
DGPFCNV^^0^B95099109
"BLD",8191,"KRN",9.8,"NM",2,0)
DGPFCNR^^0^B62901548
"BLD",8191,"KRN",9.8,"NM",3,0)
DG53849P^^0^B7093789
"BLD",8191,"KRN",9.8,"NM","B","DG53849P",3)

"BLD",8191,"KRN",9.8,"NM","B","DGPFCNR",2)

"BLD",8191,"KRN",9.8,"NM","B","DGPFCNV",1)

"BLD",8191,"KRN",19,0)
19
"BLD",8191,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",8191,"KRN",19,"NM",1,0)
DGPF LOCAL TO NATIONAL CONVERT^^0
"BLD",8191,"KRN",19,"NM","B","DGPF LOCAL TO NATIONAL CONVERT",1)

"BLD",8191,"KRN",19.1,0)
19.1
"BLD",8191,"KRN",101,0)
101
"BLD",8191,"KRN",409.61,0)
409.61
"BLD",8191,"KRN",771,0)
771
"BLD",8191,"KRN",779.2,0)
779.2
"BLD",8191,"KRN",870,0)
870
"BLD",8191,"KRN",8989.51,0)
8989.51
"BLD",8191,"KRN",8989.52,0)
8989.52
"BLD",8191,"KRN",8994,0)
8994
"BLD",8191,"KRN","B",.4,.4)

"BLD",8191,"KRN","B",.401,.401)

"BLD",8191,"KRN","B",.402,.402)

"BLD",8191,"KRN","B",.403,.403)

"BLD",8191,"KRN","B",.5,.5)

"BLD",8191,"KRN","B",.84,.84)

"BLD",8191,"KRN","B",3.6,3.6)

"BLD",8191,"KRN","B",3.8,3.8)

"BLD",8191,"KRN","B",9.2,9.2)

"BLD",8191,"KRN","B",9.8,9.8)

"BLD",8191,"KRN","B",19,19)

"BLD",8191,"KRN","B",19.1,19.1)

"BLD",8191,"KRN","B",101,101)

"BLD",8191,"KRN","B",409.61,409.61)

"BLD",8191,"KRN","B",771,771)

"BLD",8191,"KRN","B",779.2,779.2)

"BLD",8191,"KRN","B",870,870)

"BLD",8191,"KRN","B",8989.51,8989.51)

"BLD",8191,"KRN","B",8989.52,8989.52)

"BLD",8191,"KRN","B",8994,8994)

"BLD",8191,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8191,"QUES",0)
^9.62^^
"BLD",8191,"REQB",0)
^9.611^^
"INIT")
DG53849P
"KRN",3.8,281,-1)
0^1
"KRN",3.8,281,0)
DGPF CLINICAL HR FLAG REVIEW^PU^n^^^^
"KRN",3.8,281,2,0)
^3.801^1^1^3120824^^^^
"KRN",3.8,281,2,1,0)
Mail group to receive notifications associated with the national High Risk for Suicide Patient Record Flag
"KRN",3.8,281,3)

"KRN",19,10847,-1)
0^1
"KRN",19,10847,0)
DGPF LOCAL TO NATIONAL CONVERT^Convert Local HRMH PRF to National^^A^^^^^^^^REGISTRATION^^1
"KRN",19,10847,1,0)
^19.06^4^4^3120109^^
"KRN",19,10847,1,1,0)
This option will initiate the conversion of the local category 2 
"KRN",19,10847,1,2,0)
suicide Prevention Patient Record Flag to a National  category 1
"KRN",19,10847,1,3,0)
flag.  This option will allow the selection of a report only mode
"KRN",19,10847,1,4,0)
or allow the running of the actual conversion of local to national.
"KRN",19,10847,20)
D EN^DGPFCNV
"KRN",19,10847,"U")
CONVERT LOCAL HRMH PRF TO NATI
"MBREQ")
1
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",6,-1)
1^1
"PKG",6,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",6,20,0)
^9.402P^^
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
5.3^2930813^2931021
"PKG",6,22,1,"PAH",1,0)
849^3130509^1342
"PKG",6,22,1,"PAH",1,1,0)
^^1^1^3130509
"PKG",6,22,1,"PAH",1,1,1,0)
DGPF NEW CAT1 FLAG AND CONVERSION
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","DG53849P")
0^3^B7093789
"RTN","DG53849P",1,0)
DG53849P ;ALB/SCK - PRF CONVERSION PRE-PATCH SETUP ; 11/14/2011
"RTN","DG53849P",2,0)
 ;;5.3;Registration;**849**;Aug 13, 1993;Build 28
"RTN","DG53849P",3,0)
 ;
"RTN","DG53849P",4,0)
 ; This routine will create the new national High Risk for Suicide Patient Record
"RTN","DG53849P",5,0)
 ; flag in the PRF NATIONAL FLAG file (#26.15).  This routine will require that
"RTN","DG53849P",6,0)
 ; the associated TIU PN TITLE be already installed in the TIU DOCUMENT DEFINITION
"RTN","DG53849P",7,0)
 ; file (#8925.1).  Once the flag is installed, this routine should be deleted.
"RTN","DG53849P",8,0)
 ;  
"RTN","DG53849P",9,0)
EN ; Main entry point
"RTN","DG53849P",10,0)
 N DGPRF,DGMSG,DGFDA,DGFDAIEN,DGWP,DGTIU,DGMSG,DGERR,DGRESULT,DGLINE
"RTN","DG53849P",11,0)
 ;
"RTN","DG53849P",12,0)
 S DGPRF="HIGH RISK FOR SUICIDE"
"RTN","DG53849P",13,0)
 S DGTIU="PATIENT RECORD FLAG CATEGORY I - HIGH RISK FOR SUICIDE"
"RTN","DG53849P",14,0)
 ;
"RTN","DG53849P",15,0)
 K DGERR,DGMSG
"RTN","DG53849P",16,0)
 D CHK^DIE(26.15,.07,"E",DGTIU,.DGRESULT,"DGERR")
"RTN","DG53849P",17,0)
 I $D(DGERR)>0 D  Q
"RTN","DG53849P",18,0)
 . D MSG^DIALOG("EA",.DGMSG,"","","DGERR")
"RTN","DG53849P",19,0)
 . S DGLINE=$O(DGMSG(999999),-1)
"RTN","DG53849P",20,0)
 . S DGMSG(DGLINE+1)="Please check that patch TIU*1.0*265 has been installed"
"RTN","DG53849P",21,0)
 . S DGMSG(DGLINE+2)="Exiting install of the new national PRF flag"
"RTN","DG53849P",22,0)
 . D MES^XPDUTL(.DGMSG)
"RTN","DG53849P",23,0)
 ;
"RTN","DG53849P",24,0)
 I $D(^DGPF(26.15,"B",DGPRF))>0 D  Q
"RTN","DG53849P",25,0)
 . S DGMSG(1)="The 'HIGH RISK FOR SUICIDE' PRF is already entered in the PRF NATIONAL"
"RTN","DG53849P",26,0)
 . S DGMSG(2)="FLAG file, no further processing of the new national PRF field entry."
"RTN","DG53849P",27,0)
 . D MES^XPDUTL(.DGMSG)
"RTN","DG53849P",28,0)
 ; Create main entry in file #26.15
"RTN","DG53849P",29,0)
 D BMES^XPDUTL("Installing new national PRF entry")
"RTN","DG53849P",30,0)
 S DGFDA(1,26.15,"+1,",.01)=DGPRF
"RTN","DG53849P",31,0)
 S DGFDA(1,26.15,"+1,",.02)="ACTIVE"
"RTN","DG53849P",32,0)
 S DGFDA(1,26.15,"+1,",.03)="CLINICAL"
"RTN","DG53849P",33,0)
 S DGFDA(1,26.15,"+1,",.04)="90"
"RTN","DG53849P",34,0)
 S DGFDA(1,26.15,"+1,",.05)="30"
"RTN","DG53849P",35,0)
 S DGFDA(1,26.15,"+1,",.06)="DGPF CLINICAL HR FLAG REVIEW"
"RTN","DG53849P",36,0)
 S DGFDA(1,26.15,"+1,",.07)=DGTIU
"RTN","DG53849P",37,0)
 K DGERR,DGMSG
"RTN","DG53849P",38,0)
 D UPDATE^DIE("E","DGFDA(1)","DGFDAIEN","DGERR")
"RTN","DG53849P",39,0)
 I $D(DGERR)>0 D  Q
"RTN","DG53849P",40,0)
 . D MSG^DIALOG("EA",.DGMSG,"","","DGERR")
"RTN","DG53849P",41,0)
 . D MES^XPDUTL(.DGMSG)
"RTN","DG53849P",42,0)
 ; Create description (word-processing) field
"RTN","DG53849P",43,0)
 K DGERR,DGMSG
"RTN","DG53849P",44,0)
 S DGWP(1,1)="The purpose of this National Patient Record Flag is to alert VHA"
"RTN","DG53849P",45,0)
 S DGWP(1,2)="Mental Health Staff of patients who have a high risk for suicide"
"RTN","DG53849P",46,0)
 S DGWP(1,3)="that may pose a threat to themselves.  This is a nationally"
"RTN","DG53849P",47,0)
 S DGWP(1,4)="distributed flag."
"RTN","DG53849P",48,0)
 D WP^DIE(26.15,DGFDAIEN(1)_",",1,"A","DGWP(1)","DGERR")
"RTN","DG53849P",49,0)
 I $D(DGERR) D  Q
"RTN","DG53849P",50,0)
 . D MSG^DIALOG("EA",.DGMSG,"","","DGERR")
"RTN","DG53849P",51,0)
 . D MES^XPDUTL(.DGMSG)
"RTN","DG53849P",52,0)
 ;
"RTN","DG53849P",53,0)
 D BMES^XPDUTL("Installation of new national PRF entry complete")
"RTN","DG53849P",54,0)
 Q
"RTN","DGPFCNR")
0^2^B62901548
"RTN","DGPFCNR",1,0)
DGPFCNR ;ALB/SCK - PRF CAT II TO CAT I REPORTING;27 JAN 2012
"RTN","DGPFCNR",2,0)
 ;;5.3;Registration;**849**;Aug 13, 1993;Build 28
"RTN","DGPFCNR",3,0)
 ;
"RTN","DGPFCNR",4,0)
 ; No direct entry
"RTN","DGPFCNR",5,0)
 Q
"RTN","DGPFCNR",6,0)
 ;
"RTN","DGPFCNR",7,0)
EN(DGRSLT,DGXTMP) ; Main entry point
"RTN","DGPFCNR",8,0)
 N DGLINE,DGSPACE,DGDBL
"RTN","DGPFCNR",9,0)
 ;
"RTN","DGPFCNR",10,0)
 D SETUP
"RTN","DGPFCNR",11,0)
 D BLDSUM(.DGRSLT,DGXTMP)
"RTN","DGPFCNR",12,0)
 D BLDPROC(DGXTMP)
"RTN","DGPFCNR",13,0)
 W !!?3,">> Results have been sent to the 'DGPF CLINICAL HR FLAG' mail group"
"RTN","DGPFCNR",14,0)
 ;
"RTN","DGPFCNR",15,0)
 Q
"RTN","DGPFCNR",16,0)
 ;
"RTN","DGPFCNR",17,0)
SETUP ; Setup formatting variables for reports
"RTN","DGPFCNR",18,0)
 ;
"RTN","DGPFCNR",19,0)
 I $G(DGXTMP)']"" S DGXTMP="^TMP(""DGPFL2N"",$J)"
"RTN","DGPFCNR",20,0)
 S $P(DGLINE,"-",78)=""
"RTN","DGPFCNR",21,0)
 S $P(DGSPACE," ",78)=""
"RTN","DGPFCNR",22,0)
 S $P(DGDBL,"=",78)=""
"RTN","DGPFCNR",23,0)
 Q
"RTN","DGPFCNR",24,0)
 ;
"RTN","DGPFCNR",25,0)
BLDPROC(DGXTMP) ; Build report of processed cat II to Cat I entries
"RTN","DGPFCNR",26,0)
 N DGMSG,DGFOUND,DGCNT,DGNAME,DFN,DGPFASG,DGPFASGH,DGTEXT,DGPRE,DGSUBJ
"RTN","DGPFCNR",27,0)
 ;
"RTN","DGPFCNR",28,0)
 K DGMSG
"RTN","DGPFCNR",29,0)
 S DGMSG(10)=$S($G(DGRUN)="R":"Pre-scan results ",1:"Processing results ")_"from Local to National flag processing job"
"RTN","DGPFCNR",30,0)
 S DGMSG(12)="Run date: "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","DGPFCNR",31,0)
 S DGMSG(14)="Started by: "_$$GET1^DIQ(200,DUZ,.01)
"RTN","DGPFCNR",32,0)
 S DGMSG(17)=""
"RTN","DGPFCNR",33,0)
 ;
"RTN","DGPFCNR",34,0)
 K DGFOUND
"RTN","DGPFCNR",35,0)
 S DGMSG(19)="List of patients that "_$S($G(DGRUN)="R":"will have a",1:"had a")_" Cat 1 flag created"
"RTN","DGPFCNR",36,0)
 S DGMSG(21)="Name"_$E(DGSPACE,1,32)_"Owning Site"
"RTN","DGPFCNR",37,0)
 S DGMSG(25)=DGLINE
"RTN","DGPFCNR",38,0)
 ;S DGMSG(27)=""
"RTN","DGPFCNR",39,0)
 ;
"RTN","DGPFCNR",40,0)
 S DGNAME="",DGCNT=30
"RTN","DGPFCNR",41,0)
 F  S DGNAME=$O(@DGXTMP@("COMPLETE",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",42,0)
 . S DFN=$P($G(@DGXTMP@("COMPLETE",DGNAME)),U,1)
"RTN","DGPFCNR",43,0)
 . S DGPFASG=$P($G(@DGXTMP@("COMPLETE",DGNAME)),U,2)
"RTN","DGPFCNR",44,0)
 . S DGPFASGH=$P($G(@DGXTMP@("COMPLETE",DGNAME)),U,3)
"RTN","DGPFCNR",45,0)
 . S DGTEXT=DGNAME_" ("_$$LAST4(DFN)_")"
"RTN","DGPFCNR",46,0)
 . S DGTAB=36-$L(DGTEXT)
"RTN","DGPFCNR",47,0)
 . S DGMSG(DGCNT)=DGTEXT_$E(DGSPACE,1,DGTAB)_$$GET1^DIQ(26.13,DGPFASG,.04)
"RTN","DGPFCNR",48,0)
 . ;_"  "_DGPFASG_"^"_DGPFASGH
"RTN","DGPFCNR",49,0)
 . S DGCNT=DGCNT+1,DGFOUND=1
"RTN","DGPFCNR",50,0)
 ;
"RTN","DGPFCNR",51,0)
 I '$G(DGFOUND) D
"RTN","DGPFCNR",52,0)
 . S DGNAME="",DGCNT=30
"RTN","DGPFCNR",53,0)
 . F  S DGNAME=$O(@DGXTMP@("PREPROC",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",54,0)
 .. N DGPFX
"RTN","DGPFCNR",55,0)
 .. S DFN=$P($G(@DGXTMP@("PREPROC",DGNAME)),U,1)
"RTN","DGPFCNR",56,0)
 .. S DGPFX=$P($G(@DGXTMP@("PREPROC",DGNAME)),U,2)
"RTN","DGPFCNR",57,0)
 .. S DGTEXT=DGNAME_" ("_$$LAST4(DFN)_")"
"RTN","DGPFCNR",58,0)
 .. S DGTAB=36-$L(DGTEXT)
"RTN","DGPFCNR",59,0)
 .. S DGMSG(DGCNT)=DGTEXT_$E(DGSPACE,1,DGTAB)_$$GET1^DIQ(26.13,DGPFX,.04)
"RTN","DGPFCNR",60,0)
 .. S DGCNT=DGCNT+1,DGFOUND=1,DGPRE=1
"RTN","DGPFCNR",61,0)
 ;
"RTN","DGPFCNR",62,0)
 I '$G(DGFOUND) D
"RTN","DGPFCNR",63,0)
 . S DGMSG(DGCNT)="No Cat II records to process were found",DGMSG(DGCNT+1)="",DGCNT=DGCNT+5
"RTN","DGPFCNR",64,0)
 ;
"RTN","DGPFCNR",65,0)
 S DGSUBJ=$S($G(DGRUN)="R":"Pre-report ",$G(DGRUN)="P":"Processed ",1:"")_"National Flag Create "
"RTN","DGPFCNR",66,0)
 D SENDMSG(.DGMSG,DGSUBJ)
"RTN","DGPFCNR",67,0)
 Q
"RTN","DGPFCNR",68,0)
 ;
"RTN","DGPFCNR",69,0)
BLDSUM(DGRSLT,DGXTMP) ; Build summary report of cat II to cat I processing
"RTN","DGPFCNR",70,0)
 N DGMSG,DGNAME,VA,DFN,DFN1,DGIEN,DGTAB,DGTEXT,DGSUBJ
"RTN","DGPFCNR",71,0)
 ;
"RTN","DGPFCNR",72,0)
TOP ;
"RTN","DGPFCNR",73,0)
 S DGMSG(10)=$S($G(DGRUN)="R":"Pre-scan summary ",1:"Processing summary ")_"from Local to National flag processing job"
"RTN","DGPFCNR",74,0)
 S DGMSG(12)="Run date: "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","DGPFCNR",75,0)
 S DGMSG(14)="Started by: "_$$GET1^DIQ(200,DUZ,.01)
"RTN","DGPFCNR",76,0)
 S DGMSG(16)=DGLINE
"RTN","DGPFCNR",77,0)
 S DGMSG(16.5)=""
"RTN","DGPFCNR",78,0)
 S DGMSG(18)="Summary of PRF Processing:"
"RTN","DGPFCNR",79,0)
 S DGMSG(22)="  Total active Cat II flag assignments: "_+$G(DGRSLT("TOTAL"))
"RTN","DGPFCNR",80,0)
 S DGMSG(24)="  Cat I flags created:                  "_+$G(DGRSLT("NEW"))
"RTN","DGPFCNR",81,0)
 S DGMSG(26)="  Potential errors Found:               "_+$G(DGRSLT("ERR"))
"RTN","DGPFCNR",82,0)
 S DGMSG(28)="  Cat II flags requiring manual action: "_+$G(DGRSLT("MANUAL"))
"RTN","DGPFCNR",83,0)
 S DGMSG(30)="  Found active Cat I and Cat II flags:  "_+$G(DGRSLT("DONE"))
"RTN","DGPFCNR",84,0)
 S DGMSG(32)=" "
"RTN","DGPFCNR",85,0)
 S DGMSG(34)=DGDBL
"RTN","DGPFCNR",86,0)
 S DGMSG(38)=" "
"RTN","DGPFCNR",87,0)
 S DGMSG(40)="Processing Results: "
"RTN","DGPFCNR",88,0)
 S DGMSG(41)=" "
"RTN","DGPFCNR",89,0)
PRT1 ;
"RTN","DGPFCNR",90,0)
 S DGNAME="",DGCNT=100
"RTN","DGPFCNR",91,0)
 S DGMSG(DGCNT)="Invalid DFN's or Patient File errors"
"RTN","DGPFCNR",92,0)
 S DGMSG(DGCNT+1)=DGLINE
"RTN","DGPFCNR",93,0)
 S DGMSG(DGCNT+2)=""
"RTN","DGPFCNR",94,0)
 S DGCNT=DGCNT+5
"RTN","DGPFCNR",95,0)
 ;
"RTN","DGPFCNR",96,0)
 S DFN=0
"RTN","DGPFCNR",97,0)
 F  S DFN=$O(@DGXTMP@("DFN ERROR",DFN)) Q:'DFN  D
"RTN","DGPFCNR",98,0)
 . S DGMSG(DGCNT)=@DGXTMP@("DFN ERROR",DFN)
"RTN","DGPFCNR",99,0)
 . S DGCNT=DGCNT+1,DGFOUND=1
"RTN","DGPFCNR",100,0)
 I '$G(DGFOUND) S DGMSG(DGCNT)="No DFN errors were found",DGMSG(DGCNT+1)="",DGCNT=DGCNT+5
"RTN","DGPFCNR",101,0)
 ;
"RTN","DGPFCNR",102,0)
PRT2 ;
"RTN","DGPFCNR",103,0)
 S DGMSG(DGCNT+3)="Patients with Local ICN (National ICN Required)"
"RTN","DGPFCNR",104,0)
 S DGMSG(DGCNT+4)="Name"_$E(DGSPACE,1,32)_"Local ICN"
"RTN","DGPFCNR",105,0)
 S DGMSG(DGCNT+5)=DGLINE
"RTN","DGPFCNR",106,0)
 S DGMSG(DGCNT+6)=""
"RTN","DGPFCNR",107,0)
 ;
"RTN","DGPFCNR",108,0)
 S DGNAME="",DGCNT=DGCNT+6
"RTN","DGPFCNR",109,0)
 F  S DGNAME=$O(@DGXTMP@("MPI ERROR",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",110,0)
 . S DFN1=$P($G(@DGXTMP@("MPI ERROR",DGNAME)),U,2)
"RTN","DGPFCNR",111,0)
 . S DGNAME=DGNAME_" ("_$$LAST4(DFN1)_")"
"RTN","DGPFCNR",112,0)
 . S DGTAB=36-$L(DGNAME)
"RTN","DGPFCNR",113,0)
 . S DGMSG(DGCNT)=DGNAME_$E(DGSPACE,1,DGTAB)_$$GETICN^MPIF001(DFN1)
"RTN","DGPFCNR",114,0)
 . S DGCNT=DGCNT+1
"RTN","DGPFCNR",115,0)
PRT3 ;
"RTN","DGPFCNR",116,0)
 K DGFOUND
"RTN","DGPFCNR",117,0)
 S DGMSG(DGCNT+1)=""
"RTN","DGPFCNR",118,0)
 S DGMSG(DGCNT+3)="National Flag assigned and Local still active"
"RTN","DGPFCNR",119,0)
 S DGMSG(DGCNT+4)="Name"_$E(DGSPACE,1,30)_"CMOR"_$E(DGSPACE,1,20)_"Owning Site"
"RTN","DGPFCNR",120,0)
 S DGMSG(DGCNT+5)=DGLINE
"RTN","DGPFCNR",121,0)
 S DGMSG(DGCNT+6)=""
"RTN","DGPFCNR",122,0)
 ;
"RTN","DGPFCNR",123,0)
 S DGNAME="",DGCNT=DGCNT+6
"RTN","DGPFCNR",124,0)
 F  S DGNAME=$O(@DGXTMP@("FLGASGN",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",125,0)
 . S DFN1=$P($G(@DGXTMP@("FLGASGN",DGNAME)),U,2)
"RTN","DGPFCNR",126,0)
 . S DGCMOR=$$HL7CMOR^MPIF001(DFN1,"^")
"RTN","DGPFCNR",127,0)
 . S DGTEXT=DGNAME_" ("_$$LAST4(DFN1)_")"
"RTN","DGPFCNR",128,0)
 . S DGTAB=34-$L(DGTEXT)
"RTN","DGPFCNR",129,0)
 . S DGMSG(DGCNT)=DGTEXT_$E(DGSPACE,1,DGTAB)_$P(DGCMOR,U,2)
"RTN","DGPFCNR",130,0)
 . S DGTAB=58-$L(DGMSG(DGCNT))
"RTN","DGPFCNR",131,0)
 . S DGIEN=$P(@DGXTMP@("FLGASGN",DGNAME),U,3)
"RTN","DGPFCNR",132,0)
 . S DGMSG(DGCNT)=DGMSG(DGCNT)_$E(DGSPACE,1,DGTAB)_$$GET1^DIQ(26.13,DGIEN,.04)
"RTN","DGPFCNR",133,0)
 . ;S DGMSG(DGCNT+1)="   >"_$P(@DGXTMP@("FLGASGN",DGNAME),U)
"RTN","DGPFCNR",134,0)
 . S DGCNT=DGCNT+2,DGFOUND=1
"RTN","DGPFCNR",135,0)
 I '$G(DGFOUND) S DGMSG(DGCNT)="No Multiple PRF assignments were found",DGMSG(DGCNT+1)="",DGCNT=DGCNT+5
"RTN","DGPFCNR",136,0)
PRT4 ;
"RTN","DGPFCNR",137,0)
 K DGFOUND
"RTN","DGPFCNR",138,0)
 S DGMSG(DGCNT+1)=""
"RTN","DGPFCNR",139,0)
 S DGMSG(DGCNT+3)="Patients flagged for manual processing"
"RTN","DGPFCNR",140,0)
 S DGMSG(DGCNT+4)="Name"_$E(DGSPACE,1,32)_"CMOR"_$E(DGSPACE,1,12)_"Description"
"RTN","DGPFCNR",141,0)
 S DGMSG(DGCNT+5)=DGLINE
"RTN","DGPFCNR",142,0)
 S DGMSG(DGCNT+6)=""
"RTN","DGPFCNR",143,0)
 ;
"RTN","DGPFCNR",144,0)
 S DGNAME="",DGCNT=DGCNT+6
"RTN","DGPFCNR",145,0)
 F  S DGNAME=$O(@DGXTMP@("MANUAL",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",146,0)
 . S DFN1=$P($G(@DGXTMP@("MANUAL",DGNAME)),U,2)
"RTN","DGPFCNR",147,0)
 . S DGTEXT=DGNAME_" ("_$$LAST4(DFN1)_")"
"RTN","DGPFCNR",148,0)
 . S DGTAB=36-$L(DGTEXT)
"RTN","DGPFCNR",149,0)
 . S DGMSG(DGCNT)=DGTEXT_$E(DGSPACE,1,DGTAB)_$E($P($$HL7CMOR^MPIF001(DFN1,"^"),U,2),1,16)
"RTN","DGPFCNR",150,0)
 . S DGMSG(DGCNT)=DGMSG(DGCNT)_"  "_$P(@DGXTMP@("MANUAL",DGNAME),U,1)
"RTN","DGPFCNR",151,0)
 . S DGCNT=DGCNT+1,DGFOUND=1
"RTN","DGPFCNR",152,0)
 I '$G(DGFOUND) S DGMSG(DGCNT)="No records needing manual intervention found",DGMSG(DGCNT+1)="",DGCNT=DGCNT+5
"RTN","DGPFCNR",153,0)
PRT5 ;
"RTN","DGPFCNR",154,0)
 K DGFOUND
"RTN","DGPFCNR",155,0)
 S DGMSG(DGCNT+1)=""
"RTN","DGPFCNR",156,0)
 S DGMSG(DGCNT+3)="Other Errors which may have prevented conversion"
"RTN","DGPFCNR",157,0)
 S DGMSG(DGCNT+4)="Name"_$E(DGSPACE,1,32)_"Description"
"RTN","DGPFCNR",158,0)
 S DGMSG(DGCNT+5)=DGLINE
"RTN","DGPFCNR",159,0)
 S DGMSG(DGCNT+6)=""
"RTN","DGPFCNR",160,0)
 ;
"RTN","DGPFCNR",161,0)
 S DGNAME="",DGCNT=DGCNT+6
"RTN","DGPFCNR",162,0)
 F  S DGNAME=$O(@DGXTMP@("ERROR",DGNAME)) Q:DGNAME']""  D
"RTN","DGPFCNR",163,0)
 . S DFN1=$P($G(@DGXTMP@("ERROR",DGNAME)),U,2)
"RTN","DGPFCNR",164,0)
 . S DGTEXT=DGNAME_" ("_$$LAST4(DFN1)_")"
"RTN","DGPFCNR",165,0)
 . S DGTAB=36-$L(DGTEXT)
"RTN","DGPFCNR",166,0)
 . S DGMSG(DGCNT)=DGTEXT_$E(DGSPACE,1,DGTAB)_$P(@DGXTMP@("ERROR",DGNAME),U,1)
"RTN","DGPFCNR",167,0)
 . S DGCNT=DGCNT+1,DGFOUND=1
"RTN","DGPFCNR",168,0)
 I '$G(DGFOUND) S DGMSG(DGCNT)="No other errors found",DGMSG(DGCNT+1)="",DGCNT=DGCNT+5
"RTN","DGPFCNR",169,0)
FIN ;
"RTN","DGPFCNR",170,0)
 S DGSUBJ=$S($G(DGRUN)="R":"Pre-report ",$G(DGRUN)="P":"Processed ",1:"")_"National Flag Create "
"RTN","DGPFCNR",171,0)
 D SENDMSG(.DGMSG,DGSUBJ)
"RTN","DGPFCNR",172,0)
 Q
"RTN","DGPFCNR",173,0)
 ;
"RTN","DGPFCNR",174,0)
LAST4(DFN) ; Get the SSN last four
"RTN","DGPFCNR",175,0)
 N VA
"RTN","DGPFCNR",176,0)
 ;
"RTN","DGPFCNR",177,0)
 D PID^VADPT6
"RTN","DGPFCNR",178,0)
 Q VA("BID")
"RTN","DGPFCNR",179,0)
 ;
"RTN","DGPFCNR",180,0)
SENDMSG(DGBODY,DGSUBJ) ;  Send report to mail group
"RTN","DGPFCNR",181,0)
 N XMTO,XMSUBJ,XMBODY,XMDUZ,XMINSTR
"RTN","DGPFCNR",182,0)
 ;
"RTN","DGPFCNR",183,0)
 S XMSUBJ=$S($G(DGSUBJ)]"":DGSUBJ,1:"National Flag Create ")
"RTN","DGPFCNR",184,0)
 S XMTO("G.DGPF CLINICAL HR FLAG REVIEW")=""
"RTN","DGPFCNR",185,0)
 S XMSUBJ=XMSUBJ_$$FMTE^XLFDT($$NOW^XLFDT(),"2M")
"RTN","DGPFCNR",186,0)
 S XMBODY="DGBODY"
"RTN","DGPFCNR",187,0)
 S XMDUZ=DUZ
"RTN","DGPFCNR",188,0)
 S XMINSTR("FLAGS")="P"
"RTN","DGPFCNR",189,0)
 S XMINSTR("FROM")="HRMH PRF GENERATE JOB"
"RTN","DGPFCNR",190,0)
 D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR)
"RTN","DGPFCNR",191,0)
 Q
"RTN","DGPFCNR",192,0)
 ;
"RTN","DGPFCNR",193,0)
SNDERR(DGERR,DGPFIEN,DGASGN) ;  Send error message notification
"RTN","DGPFCNR",194,0)
 N XMTO,XMSUBJ,XMBODY,XMDUZ,DGMSG
"RTN","DGPFCNR",195,0)
 ;
"RTN","DGPFCNR",196,0)
 S DGMSG(10)="The following error/issue occurred during"
"RTN","DGPFCNR",197,0)
 S DGMSG(12)="the Local to National PRF processing:"
"RTN","DGPFCNR",198,0)
 S DGMSG(14)=""
"RTN","DGPFCNR",199,0)
 S DGMSG(16)="   "_$P(DGERR,U,2)
"RTN","DGPFCNR",200,0)
 S DGMSG(18)=""
"RTN","DGPFCNR",201,0)
 S DGMSG(20)="  Patient: "_$P(DGASGN("DFN"),U,2)
"RTN","DGPFCNR",202,0)
 S DGMSG(22)="  PRF Assignment Entry: "_DGPFIEN
"RTN","DGPFCNR",203,0)
 ;
"RTN","DGPFCNR",204,0)
 S XMTO("G.DGPF CLINICAL HR FLAG REVIEW")=""
"RTN","DGPFCNR",205,0)
 S XMSUBJ="PRF L2N Processing Issue"_$$FMTE^XLFDT($$NOW^XLFDT(),"2M")
"RTN","DGPFCNR",206,0)
 S XMBODY="DGMSG"
"RTN","DGPFCNR",207,0)
 S XMDUZ=DUZ
"RTN","DGPFCNR",208,0)
 D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,.XMTO)
"RTN","DGPFCNR",209,0)
 Q
"RTN","DGPFCNV")
0^1^B95099109
"RTN","DGPFCNV",1,0)
DGPFCNV ;ALB/SCK - PRF CAT II TO CAT I PROCESSING - MAIN;27 JAN 2012
"RTN","DGPFCNV",2,0)
 ;;5.3;Registration;**849**;Aug 13, 1993;Build 28
"RTN","DGPFCNV",3,0)
 ;
"RTN","DGPFCNV",4,0)
 Q  ; No direct entry
"RTN","DGPFCNV",5,0)
 ;
"RTN","DGPFCNV",6,0)
 ; Variables in use
"RTN","DGPFCNV",7,0)
 ;   DGRUN         Processing Run type, R-Report Only, P-Full Processing
"RTN","DGPFCNV",8,0)
 ;   DGPARM        Local Cat II PRF name stored in DGPF SUICIDE FLAG parameter field
"RTN","DGPFCNV",9,0)
 ;   DGPRF         Patient Record flag value
"RTN","DGPFCNV",10,0)
 ;   DGXTMP        TMP global for information storage on processing run
"RTN","DGPFCNV",11,0)
 ;
"RTN","DGPFCNV",12,0)
EN ;
"RTN","DGPFCNV",13,0)
 N DGRUN,DGERR,DGPARM,DGPRV,DGNFLAG
"RTN","DGPFCNV",14,0)
 ;
"RTN","DGPFCNV",15,0)
 ;
"RTN","DGPFCNV",16,0)
 S DGNFLAG="HIGH RISK FOR SUICIDE"
"RTN","DGPFCNV",17,0)
 I '$$NATFLG(DGNFLAG) D  Q  ; Check for national flag
"RTN","DGPFCNV",18,0)
 . D ERRMSG("National PRF flag for Suicide Prevention not found")
"RTN","DGPFCNV",19,0)
 I '$$LOCFLG(.DGPARM) D  Q  ; check for local flag
"RTN","DGPFCNV",20,0)
 . D ERRMSG("Local PRF for Suicide Prevention not found in Parameter File")
"RTN","DGPFCNV",21,0)
 S DGRUN=$$RUNTYP() ; Determine run type, report or process
"RTN","DGPFCNV",22,0)
 Q:"Q"[DGRUN
"RTN","DGPFCNV",23,0)
 D PROCESS(DGRUN,DGPARM,.DGERR)
"RTN","DGPFCNV",24,0)
 Q
"RTN","DGPFCNV",25,0)
 ;
"RTN","DGPFCNV",26,0)
PROCESS(DGRUN,DGPARM,DGERR) ;
"RTN","DGPFCNV",27,0)
 N DGXTMP,DGPRF,DGRSLT
"RTN","DGPFCNV",28,0)
 ;
"RTN","DGPFCNV",29,0)
 S DGXTMP="^TMP(""DGPFL2N"",$J)"
"RTN","DGPFCNV",30,0)
 K @DGXTMP
"RTN","DGPFCNV",31,0)
 S DGPRF=$$GETVAR(DGPARM,"L")
"RTN","DGPFCNV",32,0)
 I +DGPRF<1 D  Q
"RTN","DGPFCNV",33,0)
 . S DGERR="Local Patient Record Flag '"_DGPARM_"' was "_$P(DGPRF,";",2)
"RTN","DGPFCNV",34,0)
 D WAIT^DICD
"RTN","DGPFCNV",35,0)
 D SEARCH(DGPRF,DGRUN,DGXTMP,.DGRSLT)
"RTN","DGPFCNV",36,0)
 D EN^DGPFCNR(.DGRSLT,DGXTMP)
"RTN","DGPFCNV",37,0)
 Q
"RTN","DGPFCNV",38,0)
 ;
"RTN","DGPFCNV",39,0)
SEARCH(DGPRF,DGRUN,DGXTMP,DGRSLT) ; Begin search for Cat II flags to convert
"RTN","DGPFCNV",40,0)
 N DGIEN,DFN,DGPAT,DGX,DGPRFN,DGCNVT,DGINACT,DGPIEN1
"RTN","DGPFCNV",41,0)
 ;
"RTN","DGPFCNV",42,0)
 F DGX="TOTAL","NEW","ERR","MANUAL","DONE" S DGRSLT(DGX)=0
"RTN","DGPFCNV",43,0)
 ;
"RTN","DGPFCNV",44,0)
 S DFN=0
"RTN","DGPFCNV",45,0)
 F  S DFN=$O(^DGPF(26.13,"AFLAG",DGPRF,DFN)) Q:'DFN  D
"RTN","DGPFCNV",46,0)
 . S DGI=$O(^DGPF(26.13,"AFLAG",DGPRF,DFN,0))
"RTN","DGPFCNV",47,0)
 . Q:'$$GET1^DIQ(26.13,DGI,.03,"I")
"RTN","DGPFCNV",48,0)
 . S DGRSLT("TOTAL")=DGRSLT("TOTAL")+1
"RTN","DGPFCNV",49,0)
 . I '$$GETPAT^DGPFUT2(DFN,.DGPAT) D  Q
"RTN","DGPFCNV",50,0)
 .. S DGRSLT("ERR")=DGRSLT("ERR")+1
"RTN","DGPFCNV",51,0)
 .. S @DGXTMP@("DFN ERROR",DFN)="Unable to retrieve patient information for "_DFN
"RTN","DGPFCNV",52,0)
 . ;
"RTN","DGPFCNV",53,0)
 . I '$$MPIOK^DGPFUT(DFN) D  Q
"RTN","DGPFCNV",54,0)
 .. S DGRSLT("ERR")=DGRSLT("ERR")+1
"RTN","DGPFCNV",55,0)
 .. S @DGXTMP@("MPI ERROR",DGPAT("NAME"))="This patient has a local ICN assigned^"_DFN
"RTN","DGPFCNV",56,0)
 . ;
"RTN","DGPFCNV",57,0)
 . S DGPFIEN=$O(^DGPF(26.13,"AFLAG",DGPRF,DFN,0))
"RTN","DGPFCNV",58,0)
 . S DGPRFN=$$GETFLAG^DGPFAPIU(DGNFLAG,"N")
"RTN","DGPFCNV",59,0)
 . S DGPIEN1=$O(^DGPF(26.13,"AFLAG",DGPRFN,DFN,0))
"RTN","DGPFCNV",60,0)
 . I DGPIEN1>0 D  Q
"RTN","DGPFCNV",61,0)
 .. I $$GETASGN^DGPFAA(DGPFIEN,.DGPFA)
"RTN","DGPFCNV",62,0)
 .. I +DGPFA("STATUS") D
"RTN","DGPFCNV",63,0)
 ... S DGRSLT("DONE")=DGRSLT("DONE")+1
"RTN","DGPFCNV",64,0)
 ... S @DGXTMP@("FLGASGN",DGPAT("NAME"))="Patient had active National and Local PRF's assigned^"_DFN_"^"_DGPFIEN
"RTN","DGPFCNV",65,0)
 ... I "P"[DGRUN S DGINACT=$$INACT(DGPFIEN) I '$G(DGINACT) D
"RTN","DGPFCNV",66,0)
 .... S DGRSLT("ERR")=DGRSLT("ERR")+1
"RTN","DGPFCNV",67,0)
 .... S @DGXTMP@("ERROR",DGPAT("NAME"))=$P(DGINACT,U,2)
"RTN","DGPFCNV",68,0)
 . ; 
"RTN","DGPFCNV",69,0)
 . K DGERR
"RTN","DGPFCNV",70,0)
 . S DGOWNER=0
"RTN","DGPFCNV",71,0)
 . ;I '$$OWNER(DFN,$G(DGPFIEN),.DGOWNER,.DGERR) D  Q
"RTN","DGPFCNV",72,0)
 . ;. S DGRSLT("MANUAL")=DGRSLT("MANUAL")+1
"RTN","DGPFCNV",73,0)
 . ;. S @DGXTMP@("MANUAL",DGPAT("NAME"))=DGERR_"^"_DFN
"RTN","DGPFCNV",74,0)
 . ;
"RTN","DGPFCNV",75,0)
 . I "P"[DGRUN D
"RTN","DGPFCNV",76,0)
 .. S DGCNVT=$$CONVERT(DGPFIEN,DGOWNER,DGPRFN)
"RTN","DGPFCNV",77,0)
 .. I +DGCNVT D
"RTN","DGPFCNV",78,0)
 ... S DGRSLT("NEW")=DGRSLT("NEW")+1
"RTN","DGPFCNV",79,0)
 ... S @DGXTMP@("COMPLETE",DGPAT("NAME"))=DFN_"^"_$P(DGCNVT,U,2,3)_"^"_$P(DGCNVT,U,2)
"RTN","DGPFCNV",80,0)
 .. E  D
"RTN","DGPFCNV",81,0)
 ... S DGRSLT("ERR")=DGRSLT("ERR")+1
"RTN","DGPFCNV",82,0)
 ... S @DGXTMP@("ERROR",DGPAT("NAME"))=$P(DGCNVT,U,2)_"^"_DFN_"^"_DGPFIEN
"RTN","DGPFCNV",83,0)
 . E  D
"RTN","DGPFCNV",84,0)
 .. S DGRSLT("NEW")=DGRSLT("NEW")+1
"RTN","DGPFCNV",85,0)
 .. S @DGXTMP@("PREPROC",DGPAT("NAME"))=DFN_"^"_DGPFIEN
"RTN","DGPFCNV",86,0)
 Q
"RTN","DGPFCNV",87,0)
 ;
"RTN","DGPFCNV",88,0)
CONVERT(DGPFIEN,DGOWNER,DGPRFN) ;
"RTN","DGPFCNV",89,0)
 N DGRSLT,DGASGN,DGNEW,DGNEWH,DGASGNH,DGPFHIEN,DGRESULT,DGHLRSLT,DGUPDT,DGRDDT
"RTN","DGPFCNV",90,0)
 ;
"RTN","DGPFCNV",91,0)
 I '$$GETASGN^DGPFAA(DGPFIEN,.DGASGN) D  G CNVTQ
"RTN","DGPFCNV",92,0)
 . S DGRSLT="0^Unable to to Retrieve PRF Assignment"
"RTN","DGPFCNV",93,0)
 S DGNEW("DFN")=DGASGN("DFN")
"RTN","DGPFCNV",94,0)
 S DGNEW("FLAG")=DGPRFN_"^"_DGNFLAG
"RTN","DGPFCNV",95,0)
 S DGNEW("STATUS")="1^ACTIVE"
"RTN","DGPFCNV",96,0)
 S DGNEW("OWNER")=DGASGN("OWNER") ;DGOWNER
"RTN","DGPFCNV",97,0)
 S DGNEW("ORIGSITE")=$P($$SITE^VASITE,U,1,2)
"RTN","DGPFCNV",98,0)
 ;S DGNEW("REVIEWDT")=$$FMADD^XLFDT($P(DGASGN("REVIEWDT"),U),90)
"RTN","DGPFCNV",99,0)
 D BLDWP(.DGASGN,.DGNEW,"ASGNTXT","NARR")
"RTN","DGPFCNV",100,0)
 ;
"RTN","DGPFCNV",101,0)
 S DGPFHIEN=$$GETLAST^DGPFAAH(DGPFIEN)
"RTN","DGPFCNV",102,0)
 I $$GETHIST^DGPFAAH(DGPFHIEN,.DGASGNH) D
"RTN","DGPFCNV",103,0)
 . S DGNEWH("ACTION")="1^NEW ASSIGNMENT"
"RTN","DGPFCNV",104,0)
 . S DGNEWH("APPRVBY")=DGASGNH("APPRVBY")
"RTN","DGPFCNV",105,0)
 . S DGNEWH("ASSIGN")=DGASGNH("ASSIGN")
"RTN","DGPFCNV",106,0)
 . S DGNEWH("ASSIGNDT")=$$NOW^XLFDT_"^"_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","DGPFCNV",107,0)
 . S DGNEWH("ENTERBY")=DUZ_"^"_$$GET1^DIQ(200,DUZ,.01)
"RTN","DGPFCNV",108,0)
 . S DGNEWH("TIULINK")="^"
"RTN","DGPFCNV",109,0)
 . D BLDWP("",.DGNEWH,"HSTNEW","COMMENT")
"RTN","DGPFCNV",110,0)
 ;
"RTN","DGPFCNV",111,0)
 ; Set Review Date
"RTN","DGPFCNV",112,0)
 I $$FMDIFF^XLFDT(+$G(DGASGN("REVIEWDT")),+$G(DGASGNH("ASSIGNDT")),1)>90 D
"RTN","DGPFCNV",113,0)
 . S DGNEW("REVIEWDT")=$$FMADD^XLFDT($P(DGASGNH("ASSIGNDT"),".",1),90)
"RTN","DGPFCNV",114,0)
 . S DGNEW("REVIEWDT")=DGNEW("REVIEWDT")_"^"_$$FMTE^XLFDT(+DGNEW("REVIEWDT"))
"RTN","DGPFCNV",115,0)
 . S DGX=$O(DGNEW("NARR",99999),-1),DGX=DGX+1
"RTN","DGPFCNV",116,0)
 . S DGNEW("NARR",DGX,0)="Original Review Date from Local PRF: "_$P($G(DGASGN("REVIEWDT")),U,2)
"RTN","DGPFCNV",117,0)
 E  D
"RTN","DGPFCNV",118,0)
 . S DGNEW("REVIEWDT")=DGASGN("REVIEWDT")
"RTN","DGPFCNV",119,0)
 ;
"RTN","DGPFCNV",120,0)
 S DGRESULT=$$STOALL^DGPFAA(.DGNEW,.DGNEWH,.DGERR)
"RTN","DGPFCNV",121,0)
 I +$G(DGRESULT) D
"RTN","DGPFCNV",122,0)
 . S DGRSLT=1_"^"_DGRESULT
"RTN","DGPFCNV",123,0)
 . S:$$PROD^XUPROD() DGHLRSLT=$$SNDORU^DGPFHLS(+$G(DGRESULT))
"RTN","DGPFCNV",124,0)
 . S DGUPDT=$$INACT(DGPFIEN)
"RTN","DGPFCNV",125,0)
 . I '+$G(DGUPDT) D  Q
"RTN","DGPFCNV",126,0)
 .. D SNDERR^DGPFCNR(DGUPDT,DGPFIEN,.DGASGN)
"RTN","DGPFCNV",127,0)
 E  D
"RTN","DGPFCNV",128,0)
 . S DGRSLT="0^An error occurred when trying to file assignment/history"
"RTN","DGPFCNV",129,0)
CNVTQ ;
"RTN","DGPFCNV",130,0)
 Q $G(DGRSLT)
"RTN","DGPFCNV",131,0)
 ;
"RTN","DGPFCNV",132,0)
INACT(DGPFIEN) ;  Inactivate cat II flag
"RTN","DGPFCNV",133,0)
 N DGPFA,DGPFAH,DGRSLT,DGRESULT
"RTN","DGPFCNV",134,0)
 ;
"RTN","DGPFCNV",135,0)
 I '$$LOCK^DGPFAA3(DGPFIEN) D  G INACTQ
"RTN","DGPFCNV",136,0)
 . S DGRSLT="0^Unable to lock local PRF assignment for edit^"
"RTN","DGPFCNV",137,0)
 I '$$GETASGN^DGPFAA(DGPFIEN,.DGPFA) D  G INACTQ
"RTN","DGPFCNV",138,0)
 . S DGRSLT="0^Unable to retrieve local PRF assignment for edit^"
"RTN","DGPFCNV",139,0)
 ;
"RTN","DGPFCNV",140,0)
 S DGPFA("STATUS")=0
"RTN","DGPFCNV",141,0)
 S DGPFA("REVIEWDT")=""
"RTN","DGPFCNV",142,0)
 S DGPFAH("ACTION")=3
"RTN","DGPFCNV",143,0)
 S DGPFAH("ASSIGNDT")=$$NOW^XLFDT()
"RTN","DGPFCNV",144,0)
 S DGPFAH("ENTERBY")=DUZ
"RTN","DGPFCNV",145,0)
 S DGPFAH("APPRVBY")=DUZ
"RTN","DGPFCNV",146,0)
 D BLDWP("",.DGPFAH,"HSTOLD","COMMENT")
"RTN","DGPFCNV",147,0)
 ;
"RTN","DGPFCNV",148,0)
 S DGRESULT=$$STOALL^DGPFAA(.DGPFA,.DGPFAH,.DGERR)
"RTN","DGPFCNV",149,0)
 I '+$G(DGRESULT) S DGRSLT="0^Error: "_$S($G(DGERR)]"":DGERR,1:"Unable to file updated assignment")
"RTN","DGPFCNV",150,0)
 E  S DGRSLT=1
"RTN","DGPFCNV",151,0)
INACTQ ;
"RTN","DGPFCNV",152,0)
 Q DGRSLT
"RTN","DGPFCNV",153,0)
 ;
"RTN","DGPFCNV",154,0)
OWNER(DFN,DGPFIEN,DGOWNER,DGERR) ; Determine owning site using previous owning site, current site and CMOR
"RTN","DGPFCNV",155,0)
 N DGRSLT,DGIEN,DGX,DGCMOR,DGSITE,DGTFL
"RTN","DGPFCNV",156,0)
 ;
"RTN","DGPFCNV",157,0)
 S DGOWNER=$$GET1^DIQ(26.13,DGPFIEN,.04,"I")
"RTN","DGPFCNV",158,0)
 D BLDTFL^DGPFUT2(DFN,.DGTFL)
"RTN","DGPFCNV",159,0)
 S DGCMOR=+$$HL7CMOR^MPIF001(DFN,"^")
"RTN","DGPFCNV",160,0)
 ;
"RTN","DGPFCNV",161,0)
 I DGCMOR>0 D  ; CMOR Found
"RTN","DGPFCNV",162,0)
 . I $D(DGTFL)<10 S DGOWNER=DGCMOR,DGRSLT=1 Q  ; No TF List found
"RTN","DGPFCNV",163,0)
 . I $D(DGTFL(+DGCMOR)) S DGOWNER=+DGCMOR,DGRSLT=1 Q  ; CMOR found on TF List
"RTN","DGPFCNV",164,0)
 . S DGERR="CMOR is not one of the known TF's",DGRSLT=0
"RTN","DGPFCNV",165,0)
 . ;
"RTN","DGPFCNV",166,0)
 E  D  ; No CMOR found
"RTN","DGPFCNV",167,0)
 . I $D(DGTFL)<10 S DGRSLT=1 Q  ; No TF List found
"RTN","DGPFCNV",168,0)
 . S DGSITE=+$$SITE^VASITE
"RTN","DGPFCNV",169,0)
 . I $D(DGTFL(DGSITE)) S DGOWNER=DGSITE,DGRSLT=1 Q  ; Current site found on TF List
"RTN","DGPFCNV",170,0)
 . S DGERR="No CMOR found, site does not match known TF",DGRSLT=0
"RTN","DGPFCNV",171,0)
 Q DGRSLT
"RTN","DGPFCNV",172,0)
 ;
"RTN","DGPFCNV",173,0)
NATFLG(DGNFLAG) ; Check for New national flag
"RTN","DGPFCNV",174,0)
 N DGRSLT
"RTN","DGPFCNV",175,0)
 ;
"RTN","DGPFCNV",176,0)
 S DGRSLT=0
"RTN","DGPFCNV",177,0)
 I $D(^DGPF(26.15,"B",DGNFLAG)) S DGRSLT=1
"RTN","DGPFCNV",178,0)
 Q DGRSLT
"RTN","DGPFCNV",179,0)
 ;
"RTN","DGPFCNV",180,0)
LOCFLG(DGPARM) ;  Retrieve current cat II flag from parameters
"RTN","DGPFCNV",181,0)
 N DGRSLT
"RTN","DGPFCNV",182,0)
 ; 
"RTN","DGPFCNV",183,0)
 S DGPARM=$$GET^XPAR("ALL","DGPF SUICIDE FLAG")
"RTN","DGPFCNV",184,0)
 S DGRSLT=0
"RTN","DGPFCNV",185,0)
 I DGPARM]"" S DGRSLT=1
"RTN","DGPFCNV",186,0)
 Q DGRSLT
"RTN","DGPFCNV",187,0)
 ;
"RTN","DGPFCNV",188,0)
RUNTYP() ;
"RTN","DGPFCNV",189,0)
 N DGRSLT,DIR,X,Y,DIRUT,DGDISPLAY,DGX
"RTN","DGPFCNV",190,0)
 ;
"RTN","DGPFCNV",191,0)
 S DGDISPLAY(1)="This option can be run in a report only mode which will provide a report "
"RTN","DGPFCNV",192,0)
 S DGDISPLAY(2)="of what actions the local-to-national processing will perform.  Enter 'R' "
"RTN","DGPFCNV",193,0)
 S DGDISPLAY(3)="to run the Report Only mode, or 'P' to begin the local-to-national PRF "
"RTN","DGPFCNV",194,0)
 S DGDISPLAY(4)="processing."
"RTN","DGPFCNV",195,0)
 W !
"RTN","DGPFCNV",196,0)
 F DGX=1:1:4 W !,DGDISPLAY(DGX)
"RTN","DGPFCNV",197,0)
 ;
"RTN","DGPFCNV",198,0)
 S DIR(0)="SO^R:Report Only;P:Process Local-to-National"
"RTN","DGPFCNV",199,0)
 S DIR("A")="Select which mode to run"
"RTN","DGPFCNV",200,0)
 S DIR("B")="R"
"RTN","DGPFCNV",201,0)
 M DIR("?")=DGDISPLAY
"RTN","DGPFCNV",202,0)
 S DIR("?")="Please select either 'R' to run the pre-report or 'P' to commence processing"
"RTN","DGPFCNV",203,0)
 S DIR("?",5)=""
"RTN","DGPFCNV",204,0)
 D ^DIR K DIR S:$D(DIRUT) Y="Q"
"RTN","DGPFCNV",205,0)
 S DGRSLT=Y
"RTN","DGPFCNV",206,0)
 Q DGRSLT
"RTN","DGPFCNV",207,0)
 ;
"RTN","DGPFCNV",208,0)
ERRMSG(DGERR) ;
"RTN","DGPFCNV",209,0)
 W !!,?3,DGERR,!!
"RTN","DGPFCNV",210,0)
 Q
"RTN","DGPFCNV",211,0)
 ;
"RTN","DGPFCNV",212,0)
GETVAR(DGPARMDF,DGCAT) ;
"RTN","DGPFCNV",213,0)
 Q $$GETFLAG^DGPFAPIU(DGPARMDF,DGCAT)
"RTN","DGPFCNV",214,0)
 ;
"RTN","DGPFCNV",215,0)
BLDWP(DGASGN,DGNEW,DGPFTAG,DGSUB) ;  Build word processing fields for assignment and assignment history entries
"RTN","DGPFCNV",216,0)
 N DGI,DGI1,DGTEXT2,DGLAST,DGUSER
"RTN","DGPFCNV",217,0)
 ;
"RTN","DGPFCNV",218,0)
 F DGI=1:1 Q:$P($T(@DGPFTAG+DGI),";;",2)="QUIT"!(DGI>10)  D
"RTN","DGPFCNV",219,0)
 . S DGNEW(DGSUB,DGI,0)=$P($T(@DGPFTAG+DGI),";;",2)
"RTN","DGPFCNV",220,0)
 ;
"RTN","DGPFCNV",221,0)
 S DGI=0 ; Insert new comment into top of WP field
"RTN","DGPFCNV",222,0)
 F  S DGI=$O(DGNEW(DGSUB,DGI)) Q:'DGI  D
"RTN","DGPFCNV",223,0)
 . S DGLAST=DGI
"RTN","DGPFCNV",224,0)
 . I DGNEW(DGSUB,DGI,0)["<DT>" K DGTEXT2 D
"RTN","DGPFCNV",225,0)
 .. S DGTEXT2=$P(DGNEW(DGSUB,DGI,0),"<DT>")_$$FMTE^XLFDT($$NOW^XLFDT)_$P(DGNEW(DGSUB,DGI,0),"<DT>",2)
"RTN","DGPFCNV",226,0)
 .. S DGNEW(DGSUB,DGI,0)=DGTEXT2
"RTN","DGPFCNV",227,0)
 . I DGNEW(DGSUB,DGI,0)["<USER>" K DGTEXT2 D
"RTN","DGPFCNV",228,0)
 .. S DGUSER=$S($G(DUZ)>0:$$GET1^DIQ(200,DUZ,.01),1:"POSTMASTER")
"RTN","DGPFCNV",229,0)
 .. S DGTEXT2=$P(DGNEW(DGSUB,DGI,0),"<USER>")_DGUSER_$P(DGNEW(DGSUB,DGI,0),"<USER>",2)
"RTN","DGPFCNV",230,0)
 .. S DGNEW(DGSUB,DGI,0)=DGTEXT2
"RTN","DGPFCNV",231,0)
 . I DGNEW(DGSUB,DGI,0)["<FLAG>" K DGTEXT2 D
"RTN","DGPFCNV",232,0)
 .. S DGTEXT2=$P(DGNEW(DGSUB,DGI,0),"<FLAG>")_$G(DGPARM)_$P(DGNEW(DGSUB,DGI,0),"<FLAG>",2)
"RTN","DGPFCNV",233,0)
 .. S DGNEW(DGSUB,DGI,0)=DGTEXT2
"RTN","DGPFCNV",234,0)
 ;
"RTN","DGPFCNV",235,0)
 ;  Add old narrative text after new inserted comment.
"RTN","DGPFCNV",236,0)
 Q:$D(DGASGN)<10
"RTN","DGPFCNV",237,0)
 S DGI1=0,DGLAST=+$G(DGLAST)+1
"RTN","DGPFCNV",238,0)
 F  S DGI1=$O(DGASGN(DGSUB,DGI1)) Q:'DGI1  D
"RTN","DGPFCNV",239,0)
 . S DGNEW(DGSUB,DGLAST,0)=DGASGN(DGSUB,DGI1,0)
"RTN","DGPFCNV",240,0)
 . S DGLAST=DGLAST+1
"RTN","DGPFCNV",241,0)
 Q
"RTN","DGPFCNV",242,0)
 ;
"RTN","DGPFCNV",243,0)
ASGNTXT ; Narrative text for PRF assignment created by auto-conversion
"RTN","DGPFCNV",244,0)
 ;;This national PRF entry was auto-created on <DT>, by the
"RTN","DGPFCNV",245,0)
 ;;'Convert Local HRMH PRF to National' option, run by <USER>.
"RTN","DGPFCNV",246,0)
 ;;The fields are based on the local PRF <FLAG> which was 
"RTN","DGPFCNV",247,0)
 ;;inactivated by the auto conversion.
"RTN","DGPFCNV",248,0)
 ;;QUIT
"RTN","DGPFCNV",249,0)
 Q
"RTN","DGPFCNV",250,0)
 ;
"RTN","DGPFCNV",251,0)
HSTOLD ; Inactivated cat2 assignment history status text
"RTN","DGPFCNV",252,0)
 ;;This local PRF entry was inactivated by the 'Convert Local HRMH 
"RTN","DGPFCNV",253,0)
 ;;PRF to National' option run on <DT> by <USER>.  A new
"RTN","DGPFCNV",254,0)
 ;;national HIGH RISK FOR SUICIDE PRF was created using the 
"RTN","DGPFCNV",255,0)
 ;;information in this local PRF entry
"RTN","DGPFCNV",256,0)
 ;;QUIT
"RTN","DGPFCNV",257,0)
 Q
"RTN","DGPFCNV",258,0)
 ;
"RTN","DGPFCNV",259,0)
ALTHTXT ; Inactivated cat2 assignment history text for cat1 conversion at another 
"RTN","DGPFCNV",260,0)
 ;;Since a national HIGH RISK FOR SUICIDE PRF entry has been activated 
"RTN","DGPFCNV",261,0)
 ;;by another site in VistA, this local PRF entry was inactivated by  
"RTN","DGPFCNV",262,0)
 ;;the 'Convert Local HRMH PRF to National' option, run on <DT> 
"RTN","DGPFCNV",263,0)
 ;;by <USER>.
"RTN","DGPFCNV",264,0)
 ;;QUIT
"RTN","DGPFCNV",265,0)
 Q
"RTN","DGPFCNV",266,0)
 ;
"RTN","DGPFCNV",267,0)
HSTNEW ;
"RTN","DGPFCNV",268,0)
 ;;New assignment for national PRF entry auto-created on <DT>,
"RTN","DGPFCNV",269,0)
 ;;by the 'Convert Local HRMH PRF to National' option.
"RTN","DGPFCNV",270,0)
 ;;QUIT
"RTN","DGPFCNV",271,0)
 Q
"VER")
8.0^22.0
**INSTALL NAME**
SD*5.3*588
"BLD",8192,0)
SD*5.3*588^SCHEDULING^0^3130509^y
"BLD",8192,1,0)
^^4^4^3121129^^^^
"BLD",8192,1,1,0)
This patch has code changes for increment 3 for the no show reports.  It
"BLD",8192,1,2,0)
also has new increment 3 functionality to look at the PRF flag as a CAT 1
"BLD",8192,1,3,0)
National flag and also has two new reports,  the ad hoc proactive report
"BLD",8192,1,4,0)
and the nightly job proactive report.
"BLD",8192,4,0)
^9.64PA^^
"BLD",8192,6.3)
53
"BLD",8192,"ABPKG")
n
"BLD",8192,"INI")

"BLD",8192,"INID")
^n
"BLD",8192,"INIT")
SD53588P
"BLD",8192,"KRN",0)
^9.67PA^779.2^20
"BLD",8192,"KRN",.4,0)
.4
"BLD",8192,"KRN",.401,0)
.401
"BLD",8192,"KRN",.402,0)
.402
"BLD",8192,"KRN",.403,0)
.403
"BLD",8192,"KRN",.5,0)
.5
"BLD",8192,"KRN",.84,0)
.84
"BLD",8192,"KRN",3.6,0)
3.6
"BLD",8192,"KRN",3.8,0)
3.8
"BLD",8192,"KRN",9.2,0)
9.2
"BLD",8192,"KRN",9.8,0)
9.8
"BLD",8192,"KRN",9.8,"NM",0)
^9.68A^10^10
"BLD",8192,"KRN",9.8,"NM",1,0)
SDMHAP^^0^B89393379
"BLD",8192,"KRN",9.8,"NM",2,0)
SDMHAP1^^0^B16336515
"BLD",8192,"KRN",9.8,"NM",3,0)
SDMHPRO^^0^B15994772
"BLD",8192,"KRN",9.8,"NM",4,0)
SDMHPRO1^^0^B19699190
"BLD",8192,"KRN",9.8,"NM",5,0)
SDAMQ^^0^B9860749
"BLD",8192,"KRN",9.8,"NM",6,0)
SDMHAD^^0^B116008938
"BLD",8192,"KRN",9.8,"NM",7,0)
SDMHAD1^^0^B108729141
"BLD",8192,"KRN",9.8,"NM",8,0)
SDMHNS^^0^B22141437
"BLD",8192,"KRN",9.8,"NM",9,0)
SDMHNS1^^0^B101585316
"BLD",8192,"KRN",9.8,"NM",10,0)
SD53588P^^0^B6953359
"BLD",8192,"KRN",9.8,"NM","B","SD53588P",10)

"BLD",8192,"KRN",9.8,"NM","B","SDAMQ",5)

"BLD",8192,"KRN",9.8,"NM","B","SDMHAD",6)

"BLD",8192,"KRN",9.8,"NM","B","SDMHAD1",7)

"BLD",8192,"KRN",9.8,"NM","B","SDMHAP",1)

"BLD",8192,"KRN",9.8,"NM","B","SDMHAP1",2)

"BLD",8192,"KRN",9.8,"NM","B","SDMHNS",8)

"BLD",8192,"KRN",9.8,"NM","B","SDMHNS1",9)

"BLD",8192,"KRN",9.8,"NM","B","SDMHPRO",3)

"BLD",8192,"KRN",9.8,"NM","B","SDMHPRO1",4)

"BLD",8192,"KRN",19,0)
19
"BLD",8192,"KRN",19,"NM",0)
^9.68A^3^3
"BLD",8192,"KRN",19,"NM",1,0)
SD MH PROACTIVE AD HOC REPORT^^0
"BLD",8192,"KRN",19,"NM",2,0)
SD MH PROACTIVE BGJ REPORT^^0
"BLD",8192,"KRN",19,"NM",3,0)
SD MH NO SHOW NIGHTLY BGJ^^0
"BLD",8192,"KRN",19,"NM","B","SD MH NO SHOW NIGHTLY BGJ",3)

"BLD",8192,"KRN",19,"NM","B","SD MH PROACTIVE AD HOC REPORT",1)

"BLD",8192,"KRN",19,"NM","B","SD MH PROACTIVE BGJ REPORT",2)

"BLD",8192,"KRN",19.1,0)
19.1
"BLD",8192,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",8192,"KRN",101,0)
101
"BLD",8192,"KRN",101,"NM",0)
^9.68A^^
"BLD",8192,"KRN",409.61,0)
409.61
"BLD",8192,"KRN",771,0)
771
"BLD",8192,"KRN",779.2,0)
779.2
"BLD",8192,"KRN",870,0)
870
"BLD",8192,"KRN",8989.51,0)
8989.51
"BLD",8192,"KRN",8989.51,"NM",0)
^9.68A^2^2
"BLD",8192,"KRN",8989.51,"NM",1,0)
SDMH NO SHOW DAYS^^0
"BLD",8192,"KRN",8989.51,"NM",2,0)
SDMH PROACTIVE DAYS^^0
"BLD",8192,"KRN",8989.51,"NM","B","SDMH NO SHOW DAYS",1)

"BLD",8192,"KRN",8989.51,"NM","B","SDMH PROACTIVE DAYS",2)

"BLD",8192,"KRN",8989.52,0)
8989.52
"BLD",8192,"KRN",8994,0)
8994
"BLD",8192,"KRN","B",.4,.4)

"BLD",8192,"KRN","B",.401,.401)

"BLD",8192,"KRN","B",.402,.402)

"BLD",8192,"KRN","B",.403,.403)

"BLD",8192,"KRN","B",.5,.5)

"BLD",8192,"KRN","B",.84,.84)

"BLD",8192,"KRN","B",3.6,3.6)

"BLD",8192,"KRN","B",3.8,3.8)

"BLD",8192,"KRN","B",9.2,9.2)

"BLD",8192,"KRN","B",9.8,9.8)

"BLD",8192,"KRN","B",19,19)

"BLD",8192,"KRN","B",19.1,19.1)

"BLD",8192,"KRN","B",101,101)

"BLD",8192,"KRN","B",409.61,409.61)

"BLD",8192,"KRN","B",771,771)

"BLD",8192,"KRN","B",779.2,779.2)

"BLD",8192,"KRN","B",870,870)

"BLD",8192,"KRN","B",8989.51,8989.51)

"BLD",8192,"KRN","B",8989.52,8989.52)

"BLD",8192,"KRN","B",8994,8994)

"BLD",8192,"QUES",0)
^9.62^^
"BLD",8192,"REQB",0)
^9.611^1^1
"BLD",8192,"REQB",1,0)
SD*5.3*578^1
"BLD",8192,"REQB","B","SD*5.3*578",1)

"INIT")
SD53588P
"KRN",19,10769,-1)
0^3
"KRN",19,10769,0)
SD MH NO SHOW NIGHTLY BGJ^High Risk MH No-Show Nightly Report^^R^^^^^^^^SCHEDULING
"KRN",19,10769,1,0)
^19.06^21^21^3121115^^^^
"KRN",19,10769,1,1,0)
This option should be used if you need to re-create the
"KRN",19,10769,1,2,0)
same report that is created by the scheduled SDAM BACKGROUND job
"KRN",19,10769,1,3,0)
after midnight each night.  The option lists the no-show and
"KRN",19,10769,1,4,0)
no action taken appointments for Mental Health Clinics for the previous day
"KRN",19,10769,1,5,0)
 
"KRN",19,10769,1,6,0)
**This report should not be scheduled to run nightly
"KRN",19,10769,1,7,0)
as it is kicked off by the Scheduling nightly background Job
"KRN",19,10769,1,8,0)
(SDAM BACKGROUND JOB) that should already be
"KRN",19,10769,1,9,0)
scheduled to run nightly on your system. 
"KRN",19,10769,1,10,0)
 
"KRN",19,10769,1,11,0)
This report is sent in a mail message to the members
"KRN",19,10769,1,12,0)
of the SD MH NO SHOW NOTIFICATION mail group. 
"KRN",19,10769,1,13,0)
 
"KRN",19,10769,1,14,0)
Future appointments will list on this report.  The number
"KRN",19,10769,1,15,0)
of days worth of future appointments that will list is defaulted
"KRN",19,10769,1,16,0)
to 30 days in the future.  A new parameter
"KRN",19,10769,1,17,0)
SD MH NO SHOW DAYS has been added to store
"KRN",19,10769,1,18,0)
the number of days to list future appointments for.
"KRN",19,10769,1,19,0)
This parameter can be edited by the user by using the option 
"KRN",19,10769,1,20,0)
[ XPAR EDIT PARAMETER] Edit Parameter Values
"KRN",19,10769,1,21,0)
changing the System value.
"KRN",19,10769,21,0)
^^1^1^3121115^
"KRN",19,10769,21,1,0)
 
"KRN",19,10769,25)
EN^SDMHNS
"KRN",19,10769,"U")
HIGH RISK MH NO-SHOW NIGHTLY R
"KRN",19,10848,-1)
0^2
"KRN",19,10848,0)
SD MH PROACTIVE BGJ REPORT^High Risk MH Proactive Nightly Report^^R^^^^^^^^SCHEDULING
"KRN",19,10848,1,0)
^19.06^23^23^3121115^^^^
"KRN",19,10848,1,1,0)
This option should be used if you need to re-create
"KRN",19,10848,1,2,0)
the same report that is created by the scheduled
"KRN",19,10848,1,3,0)
SDAM BACKGROUND job after midnight each night. 
"KRN",19,10848,1,4,0)
The option lists the scheduled appointments for
"KRN",19,10848,1,5,0)
Mental Health Clinics for today.
"KRN",19,10848,1,6,0)
 
"KRN",19,10848,1,7,0)
**This report should not be scheduled to run
"KRN",19,10848,1,8,0)
nightly as it is kicked off by the
"KRN",19,10848,1,9,0)
Scheduling nightly background Job (SDAM BACKGROUND JOB)
"KRN",19,10848,1,10,0)
that should already be scheduled to run nightly on your system. 
"KRN",19,10848,1,11,0)
 
"KRN",19,10848,1,12,0)
This report is sent in a mail message to the members
"KRN",19,10848,1,13,0)
of the SD MH NO SHOW NOTIFICATION mail group.
"KRN",19,10848,1,14,0)
 
"KRN",19,10848,1,15,0)
Future appointments will list on this report.
"KRN",19,10848,1,16,0)
The number of days worth of future appointments
"KRN",19,10848,1,17,0)
that will list is defaulted to 30 days in the future.
"KRN",19,10848,1,18,0)
Parameter SD MH PROACTIVE  DAYS has been added
"KRN",19,10848,1,19,0)
to store the number of days to list future
"KRN",19,10848,1,20,0)
appointments for.  This parameter can be edited
"KRN",19,10848,1,21,0)
by the user by using the option 
"KRN",19,10848,1,22,0)
[ XPAR EDIT PARAMETER] Edit Parameter Values,
"KRN",19,10848,1,23,0)
changing the System value.
"KRN",19,10848,25)
EN^SDMHPRO
"KRN",19,10848,"U")
HIGH RISK MH PROACTIVE NIGHTLY
"KRN",19,10849,-1)
0^1
"KRN",19,10849,0)
SD MH PROACTIVE AD HOC REPORT^High Risk MH Proactive Adhoc Report^^R^^^^^^^^SCHEDULING^^
"KRN",19,10849,1,0)
^^2^2^3110927^
"KRN",19,10849,1,1,0)
This report will list the appoinments for a date range for patients with a
"KRN",19,10849,1,2,0)
high risk for mental health patient record flag.
"KRN",19,10849,20)

"KRN",19,10849,25)
EN^SDMHAP
"KRN",19,10849,"U")
HIGH RISK MH PROACTIVE ADHOC R
"KRN",8989.5,13726,0)
16;DIC(9.4,^SDMH PROACTIVE DAYS^1
"KRN",8989.5,13726,1)
30
"KRN",8989.5,13727,0)
16;DIC(9.4,^SDMH NO SHOW DAYS^1
"KRN",8989.5,13727,1)
30
"KRN",8989.51,684,-1)
0^2
"KRN",8989.51,684,0)
SDMH PROACTIVE DAYS^Proactive Report Future Days Displayed^0^^DAYS TO DISPLAY FUTURE APPOINTMENTS^0
"KRN",8989.51,684,1)
N^1:30^Enter a number of days from 1 to 30.
"KRN",8989.51,684,6)

"KRN",8989.51,684,20,0)
^8989.512^2^2^3121115^^^^
"KRN",8989.51,684,20,1,0)
Enter the number of days from 1 to 30 to list future appointments for on 
"KRN",8989.51,684,20,2,0)
the nightly Proactive Report.
"KRN",8989.51,684,30,0)
^8989.513I^2^2
"KRN",8989.51,684,30,1,0)
1^4.2
"KRN",8989.51,684,30,2,0)
2^9.4
"KRN",8989.51,685,-1)
0^1
"KRN",8989.51,685,0)
SDMH NO SHOW DAYS^No Show Report Future Days Displayed^0^^DAYS TO DISPLAY FUTURE APPOINTMENTS^0
"KRN",8989.51,685,1)
N^1:30^Enter a number of days from 1 to 30
"KRN",8989.51,685,6)
N^
"KRN",8989.51,685,20,0)
^8989.512^2^2^3121031^^^^
"KRN",8989.51,685,20,1,0)
Enter the number of days from 1 to 30 to list future appointments for on 
"KRN",8989.51,685,20,2,0)
the nightly No Show Report.
"KRN",8989.51,685,30,0)
^8989.513I^2^2
"KRN",8989.51,685,30,1,0)
1^4.2
"KRN",8989.51,685,30,2,0)
2^9.4
"MBREQ")
1
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813^2931025
"PKG",16,22,1,"PAH",1,0)
588^3130509^1342
"PKG",16,22,1,"PAH",1,1,0)
^^4^4^3130509
"PKG",16,22,1,"PAH",1,1,1,0)
This patch has code changes for increment 3 for the no show reports.  It
"PKG",16,22,1,"PAH",1,1,2,0)
also has new increment 3 functionality to look at the PRF flag as a CAT 1
"PKG",16,22,1,"PAH",1,1,3,0)
National flag and also has two new reports,  the ad hoc proactive report
"PKG",16,22,1,"PAH",1,1,4,0)
and the nightly job proactive report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","SD53588P")
0^10^B6953359
"RTN","SD53588P",1,0)
SD53588P ;ALB/MAF - DG*5.3*588 POST INIT ; 
"RTN","SD53588P",2,0)
 ;;5.3;Scheduling;**588**;Aug 13,1993;Build 53
"RTN","SD53588P",3,0)
 ;
"RTN","SD53588P",4,0)
POST ;Adding new parameters for number of days no show and proactive report
"RTN","SD53588P",5,0)
 N SDPAR,SDERR,SDPARNM
"RTN","SD53588P",6,0)
 ;
"RTN","SD53588P",7,0)
 S SDPAR=30
"RTN","SD53588P",8,0)
 D BMES^XPDUTL("Updating Parameters File...")
"RTN","SD53588P",9,0)
 ;
"RTN","SD53588P",10,0)
 S SDPARNM="SDMH PROACTIVE DAYS"
"RTN","SD53588P",11,0)
 D ADD^XPAR("PKG.SCHEDULING",SDPARNM,1,SDPAR,.SDERR)
"RTN","SD53588P",12,0)
 D ADDERR
"RTN","SD53588P",13,0)
 ;
"RTN","SD53588P",14,0)
 N SDERR
"RTN","SD53588P",15,0)
 S SDPARNM="SDMH NO SHOW DAYS"
"RTN","SD53588P",16,0)
 D ADD^XPAR("PKG.SCHEDULING",SDPARNM,1,SDPAR,.SDERR)
"RTN","SD53588P",17,0)
 D ADDERR
"RTN","SD53588P",18,0)
 Q
"RTN","SD53588P",19,0)
 ;
"RTN","SD53588P",20,0)
ADDERR ;error message written during install
"RTN","SD53588P",21,0)
 I +$G(SDERR)>0 D  Q
"RTN","SD53588P",22,0)
 .D BMES^XPDUTL(SDPARNM)
"RTN","SD53588P",23,0)
 .D BMES^XPDUTL("    "_SDERR)
"RTN","SD53588P",24,0)
 I '+$G(SDERR)>0 D
"RTN","SD53588P",25,0)
 .D BMES^XPDUTL(SDPARNM_" updated successfully....")
"RTN","SD53588P",26,0)
 Q
"RTN","SD53588P",27,0)
 ;
"RTN","SD53588P",28,0)
DEL ;Delete the paramater...for patch testing only... will delete out parameters
"RTN","SD53588P",29,0)
 N SDERR
"RTN","SD53588P",30,0)
 ;
"RTN","SD53588P",31,0)
 D BMES^XPDUTL("Deleteing Parameters File...")
"RTN","SD53588P",32,0)
 ;
"RTN","SD53588P",33,0)
 D DEL^XPAR("PKG.SCHEDULING","SDMH PROACTIVE DAYS",,.SDERR)
"RTN","SD53588P",34,0)
 I +$G(SDERR)>0 D 
"RTN","SD53588P",35,0)
 . D BMES^XPDUTL(SDERR)
"RTN","SD53588P",36,0)
 N SDERR
"RTN","SD53588P",37,0)
 D DEL^XPAR("PKG.SCHEDULING","SDMH NO SHOW DAYS",,.SDERR)
"RTN","SD53588P",38,0)
 I +$G(SDERR)>0 D  Q
"RTN","SD53588P",39,0)
 . D BMES^XPDUTL(SDERR)
"RTN","SD53588P",40,0)
 Q
"RTN","SD53588P",41,0)
 ;
"RTN","SD53588P",42,0)
UPDPRO ; Programmer access point to manually change Parameter entry for proactive report
"RTN","SD53588P",43,0)
 N SDPAR,SDRPT,SDERR,DIR,DIRUT,X,Y
"RTN","SD53588P",44,0)
 S SDRPT="PROACTIVE REPORT"
"RTN","SD53588P",45,0)
 D ASK Q:$D(DIRUT)
"RTN","SD53588P",46,0)
 D CHG^XPAR("PKG.SCHEDULING","SDMH PROACTIVE DAYS",,SDPAR,.SDERR)
"RTN","SD53588P",47,0)
 D ERR
"RTN","SD53588P",48,0)
 Q
"RTN","SD53588P",49,0)
UPDNSH ; Programmer access point to manually change Parameter entry for no show report
"RTN","SD53588P",50,0)
 N SDPAR,SDRPT,SDERR,DIR,DIRUT,X,Y
"RTN","SD53588P",51,0)
 S SDRPT="NO SHOW REPORT"
"RTN","SD53588P",52,0)
 D ASK Q:$D(DIRUT)
"RTN","SD53588P",53,0)
 D CHG^XPAR("PKG.SCHEDULING","SDMH NO SHOW DAYS",,SDPAR,.SDERR)
"RTN","SD53588P",54,0)
 D ERR
"RTN","SD53588P",55,0)
 Q
"RTN","SD53588P",56,0)
ASK ;ASK NUMBER OF DAYS
"RTN","SD53588P",57,0)
 S DIR(0)="FAO^^"
"RTN","SD53588P",58,0)
 S DIR("A")="Number of days: "
"RTN","SD53588P",59,0)
 S DIR("A",1)="Enter the number of days of future appointments that will"
"RTN","SD53588P",60,0)
 S DIR("A",2)="list on the "_SDRPT_" for a patient."
"RTN","SD53588P",61,0)
 S DIR("A",3)=" "
"RTN","SD53588P",62,0)
 S DIR("?")="Enter a number between 1 and 30"
"RTN","SD53588P",63,0)
 D ^DIR K DIR
"RTN","SD53588P",64,0)
 Q:$D(DIRUT)
"RTN","SD53588P",65,0)
 S SDPAR=$G(Y)
"RTN","SD53588P",66,0)
 Q
"RTN","SD53588P",67,0)
 ;
"RTN","SD53588P",68,0)
 D CHG^XPAR("PKG.SCHEDULING","SDMH PROACTIVE DAYS",,SDPAR,.SDERR)
"RTN","SD53588P",69,0)
ERR I '+$G(SDERR) D
"RTN","SD53588P",70,0)
 . W !?3,"Parameter Defintion has been updated!"
"RTN","SD53588P",71,0)
 ;
"RTN","SD53588P",72,0)
 I +$G(SDERR)>0 D
"RTN","SD53588P",73,0)
 . W !?3,"An Error occurred:"
"RTN","SD53588P",74,0)
 . W !?3,$P($G(SDERR),U,2)
"RTN","SD53588P",75,0)
 I +$G(SDERR)>0 G @($S(SDRPT="NO SHOW REPORT":"UPDNSH",1:"UPDPRO"))
"RTN","SD53588P",76,0)
 Q
"RTN","SDAMQ")
0^5^B9860749
"RTN","SDAMQ",1,0)
SDAMQ ;ALB/MJK - AM Background Job ; 12/1/91
"RTN","SDAMQ",2,0)
 ;;5.3;Scheduling;**44,132,153,578,588**;Aug 13,1993;Build 53
"RTN","SDAMQ",3,0)
 ;
"RTN","SDAMQ",4,0)
EN ; -- manual entry point
"RTN","SDAMQ",5,0)
 I '$$SWITCH D MES G ENQ
"RTN","SDAMQ",6,0)
 N SDBEG,SDEND,SDAMETH,Y
"RTN","SDAMQ",7,0)
 S (SDBEG,SDEND)="",SDAMETH=2 G ENQ:'$$RANGE(.SDBEG,.SDEND,.SDAMETH)
"RTN","SDAMQ",8,0)
 ;D START G ENQ ; line for testing
"RTN","SDAMQ",9,0)
 N ZTDESC,ZTIO,ZTRTN,ZTSAVE
"RTN","SDAMQ",10,0)
 S ZTIO="",ZTRTN="START^SDAMQ",ZTDESC="ReCalc Appointment Status"
"RTN","SDAMQ",11,0)
 F X="SDBEG","SDEND","SDAMETH" S ZTSAVE(X)=""
"RTN","SDAMQ",12,0)
 K ZTSK D ^%ZTLOAD W:$D(ZTSK) "  (Task: #",ZTSK,")"
"RTN","SDAMQ",13,0)
ENQ Q
"RTN","SDAMQ",14,0)
 ;
"RTN","SDAMQ",15,0)
START ;
"RTN","SDAMQ",16,0)
 G STARTQ:'$$SWITCH
"RTN","SDAMQ",17,0)
 N SDSTART,SDFIN
"RTN","SDAMQ",18,0)
 ;N SDMHNOSH ; set for no show report
"RTN","SDAMQ",19,0)
 K ^TMP("SDSTATS",$J)
"RTN","SDAMQ",20,0)
 S SDSTART=$$NOW^SDAMU D ADD^SDAMQ1
"RTN","SDAMQ",21,0)
 D EN^SDAMQ3(SDBEG,SDEND)  ; appointments
"RTN","SDAMQ",22,0)
 D EN^SDAMQ4(SDBEG,SDEND)  ; add/edits
"RTN","SDAMQ",23,0)
 D EN^SDAMQ5(SDBEG,SDEND)  ; dispositions
"RTN","SDAMQ",24,0)
 S SDFIN=$$NOW^SDAMU D UPD^SDAMQ1(SDBEG,SDEND,SDFIN,.05)
"RTN","SDAMQ",25,0)
 D BULL^SDAMQ1
"RTN","SDAMQ",26,0)
STARTQ K SDBEG,SDEND,SDAMETH,^TMP("SDSTATS",$J) Q
"RTN","SDAMQ",27,0)
 ;
"RTN","SDAMQ",28,0)
AUTO ; -- nightly job entry point
"RTN","SDAMQ",29,0)
 G:'$$SWITCH AUTOQ
"RTN","SDAMQ",30,0)
 ; -- do yesterday's first
"RTN","SDAMQ",31,0)
 S X1=DT,X2=-1 D C^%DTC
"RTN","SDAMQ",32,0)
 S (SDOPCDT,SDBEG)=X,SDEND=X+.24,SDAMETH=1 D START
"RTN","SDAMQ",33,0)
 D EN^SDMHNS
"RTN","SDAMQ",34,0)
 D EN^SDMHPRO
"RTN","SDAMQ",35,0)
 ; -- check previous 30 days starting with the day before yesterday
"RTN","SDAMQ",36,0)
 F SDBACK=2:1:31 S X1=DT,X2=-SDBACK D C^%DTC Q:X<$$SWITCH^SDAMU  I '$P($G(^SDD(409.65,+$O(^SDD(409.65,"B",X,0)),0)),U,5) S SDBEG=X,SDEND=X+.24,SDAMETH=1 D START
"RTN","SDAMQ",37,0)
AUTOQ K SDOPCDT,SDBEG,SDEND,SDAMETH,SDBACK,X,X1,X2 Q
"RTN","SDAMQ",38,0)
 ;
"RTN","SDAMQ",39,0)
SWITCH() ;
"RTN","SDAMQ",40,0)
 Q $$SWITCH^SDAMU<DT
"RTN","SDAMQ",41,0)
 ;
"RTN","SDAMQ",42,0)
MES ;
"RTN","SDAMQ",43,0)
 W !!,*7,"The date when all appointemnts must be checked-in to obtain"
"RTN","SDAMQ",44,0)
 W !,"OPC credit is ",$$FDATE^VALM1($$SWITCH^SDAMU),"."
"RTN","SDAMQ",45,0)
 W !!,"It is too soon to run this option."
"RTN","SDAMQ",46,0)
 Q
"RTN","SDAMQ",47,0)
 ;
"RTN","SDAMQ",48,0)
RANGE(SDBEG,SDEND,SDAMETH) ; -- select range
"RTN","SDAMQ",49,0)
 N SDWITCH,SDT,X1,X2,X
"RTN","SDAMQ",50,0)
 S (SDBEG,SDEND)=0,SDT=DT
"RTN","SDAMQ",51,0)
 I $G(SDAMETH)>0 S X1=DT,X2=-1 D C^%DTC S SDT=X
"RTN","SDAMQ",52,0)
 S DIR("B")=$$FDATE^VALM1(SDT),SDWITCH=$$SWITCH^SDAMU
"RTN","SDAMQ",53,0)
 S DIR(0)="DA"_U_SDWITCH_":"_SDT_":EX",DIR("A")="Select Beginning Date: "
"RTN","SDAMQ",54,0)
 S DIR("?",1)="Enter a date between "_$$FDATE^VALM1(SDWITCH)_" to "_$$FDATE^VALM1(SDT)_".",DIR("?")=" "
"RTN","SDAMQ",55,0)
 W ! D ^DIR K DIR G RANGEQ:Y'>0 S SDBEG=Y
"RTN","SDAMQ",56,0)
 S DIR("B")=$$FDATE^VALM1(SDT)
"RTN","SDAMQ",57,0)
 S DIR(0)="DA"_U_SDBEG_":"_SDT_":EX",DIR("A")="Select    Ending Date: "
"RTN","SDAMQ",58,0)
 S DIR("?",1)="Enter a date between "_$$FDATE^VALM1(SDBEG)_" to "_$$FDATE^VALM1(SDT)_".",DIR("?")=" "
"RTN","SDAMQ",59,0)
 D ^DIR K DIR G RANGEQ:Y'>0 S SDEND=Y_".24"
"RTN","SDAMQ",60,0)
RANGEQ Q SDEND
"RTN","SDAMQ",61,0)
 ;
"RTN","SDAMQ",62,0)
DIV(SDIV,SDNAME,SDLEN) ; -- get division ifn and name
"RTN","SDAMQ",63,0)
 ;  input:   SDIV := candidate division ifn
"RTN","SDAMQ",64,0)
 ;          SDLEN := length of name to pass back [optional]
"RTN","SDAMQ",65,0)
 ; output: SDNAME := name of division
"RTN","SDAMQ",66,0)
 ; return:        := division ifn
"RTN","SDAMQ",67,0)
 ;
"RTN","SDAMQ",68,0)
 N X
"RTN","SDAMQ",69,0)
 I '$D(SDLEN) N SDLEN S SDLEN=35
"RTN","SDAMQ",70,0)
 S X=$S('$P($G(^DG(43,1,"GL")),U,2):+$O(^DG(40.8,0)),$D(^DG(40.8,+SDIV,0)):+SDIV,1:+$O(^DG(40.8,0)))
"RTN","SDAMQ",71,0)
 S SDNAME=$E($S($D(^DG(40.8,X,0)):$P(^(0),U),1:"UNKNOWN"),1,SDLEN)
"RTN","SDAMQ",72,0)
 Q X
"RTN","SDAMQ",73,0)
 ;
"RTN","SDAMQ",74,0)
CO(SDOE) ; -- has co process completed
"RTN","SDAMQ",75,0)
 Q $P($G(^SCE(+SDOE,0)),U,7)>0
"RTN","SDMHAD")
0^6^B116008938
"RTN","SDMHAD",1,0)
SDMHAD ;MAF/ALB - MENTAL HEALTH AD HOC NO SHOW REPORT;JULY 14, 2010
"RTN","SDMHAD",2,0)
 ;;5.3;Scheduling;**578,588**;Aug 13,1993;Build 53
"RTN","SDMHAD",3,0)
 ;
"RTN","SDMHAD",4,0)
EN ;entry point for the manual generation of the No Show Report
"RTN","SDMHAD",5,0)
 N SDBEG,SDEND,VAUTD,Y,SDUP,SDXFLG,SDTL,SDALL,SDDAT,Y,X,SDDAT,VADAT,ZTRTN,ZTSAVE,VADATE,%ZIS,SDALL,%
"RTN","SDMHAD",6,0)
 I '$$RANGE G QUIT
"RTN","SDMHAD",7,0)
 I '$$DIV G QUIT
"RTN","SDMHAD",8,0)
SORT R !,"Sort report by (M)ental Health Clinic Quick List,(C)linic or (S)top Code: M//",X:DTIME G:X["^"!('$T) QUIT S X=$S(X="":"M",1:$E(X,1))
"RTN","SDMHAD",9,0)
 I "CMScms"'[X W @IOF D  G SORT
"RTN","SDMHAD",10,0)
 .W "Enter: 'M' to run the report using the face-to-face Mental Health clinics",!,?7,"defined in the 'VA-MH NO SHOW APPT CLINICS LL' Reminder Location List",!,?7,"- with no additional prompts to refine the list of Mental Health clinics."
"RTN","SDMHAD",11,0)
 . W !,"Enter: 'C' to run the report by clinics which will then prompt",!,?7,"to refine the list of clinics to use."
"RTN","SDMHAD",12,0)
 . W !,"Enter: 'S' to run the report by stop codes which will then prompt",!,?7,"to refine the list of stop codes to use.",!
"RTN","SDMHAD",13,0)
 .Q
"RTN","SDMHAD",14,0)
 S SDTL=$S($G(X)="C":"CLIN",$G(X)="c":"CLIN",$G(X)="S":"STOP",$G(X)="s":"STOP",1:"MEN")
"RTN","SDMHAD",15,0)
 I SDTL="MEN" S Y=0 S SDALL="M" D LIST Q:Y=1
"RTN","SDMHAD",16,0)
 D @(SDTL) G:Y=-1 QUIT
"RTN","SDMHAD",17,0)
FUTNUM N SDFUTNUM
"RTN","SDMHAD",18,0)
 R !,"Select Number of days to List Future Appointments: 30//",X:DTIME G:X["^"!('$T) QUIT S X=$S(X="":"30",1:X) S SDFUTNUM=X
"RTN","SDMHAD",19,0)
 I X'?.N!(X=0)!(X>90) W !!,?10,"Enter a number of days from 1 to 90. Future scheduled appointments",!,?10,"for the patients will list that number of days in the future",!,?10,"on the No Show report.",! G FUTNUM
"RTN","SDMHAD",20,0)
 W !!,*7,"This output requires 80 column output",!
"RTN","SDMHAD",21,0)
 D NOW^%DTC S Y=$E(%,1,12) S SDDAT=$$FMTE^XLFDT(Y,"5")
"RTN","SDMHAD",22,0)
 S IOM=80 S %ZIS="QM",%ZIS("A")="Select Device: ",%ZIS("B")="" D ^%ZIS G:POP QUIT I $D(IO("Q")) S ZTRTN="START^SDMHAD",ZTSAVE("SD*")="",ZTSAVE("VA*")="" D ^%ZTLOAD K IO("Q"),ZTSK Q
"RTN","SDMHAD",23,0)
 ;
"RTN","SDMHAD",24,0)
START ;
"RTN","SDMHAD",25,0)
 ;I '$G(IOST) N IOST S IOST="C"
"RTN","SDMHAD",26,0)
 I $E(IOST)="C" D WAIT^DICD I $D(SDXFLG) D
"RTN","SDMHAD",27,0)
 .W !!,?10,"This report option generates a mail message containing the"
"RTN","SDMHAD",28,0)
 .W !,?10,"High Risk Mental Health No Show Nightly Report which is sent"
"RTN","SDMHAD",29,0)
 .W !,?10,"only to individuals in the SD MH NO SHOW NOTIFICATION mailgroup.",!
"RTN","SDMHAD",30,0)
 N SDDIV,SDPAG,SDCL,SDSC,SDRLL,SDPAG,NAMSPC,NAMSPC1,SDSTOP,VAUTRR,SDLINE,Y,TOTAL,SDPAT
"RTN","SDMHAD",31,0)
 N X S X="DGPFAPIH" X ^%ZOSF("TEST") S X="" I '$T D  Q
"RTN","SDMHAD",32,0)
 .I '$D(SDXFLG) W !!,"Patch DG*5.3*836 needs to be installed - ICR 4903.",!,"Routines required to run report. Aborting!",! Q
"RTN","SDMHAD",33,0)
 .N SDX S SDX=""
"RTN","SDMHAD",34,0)
 .S SDX=$$SETSTR^SDMHNS1("Patch DG*5.3*836 needs to be installed - ICR 4903.",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHAD",35,0)
 .S SDX="" S SDX=$$SETSTR^SDMHNS1("Routines required to run report. Report Aborted!",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHAD",36,0)
 .S SDX=""
"RTN","SDMHAD",37,0)
 S Y=0 D LIST Q:Y=1
"RTN","SDMHAD",38,0)
 S NAMSPC=$$NAMSPC
"RTN","SDMHAD",39,0)
 S NAMSPC1=$$NAMSPC1
"RTN","SDMHAD",40,0)
 K ^TMP(NAMSPC),^TMP(NAMSPC1)
"RTN","SDMHAD",41,0)
 S (SDPAG,SDCL,SDSC,SDRLL)=0
"RTN","SDMHAD",42,0)
 I $D(SDXFLG),SDXFLG=1 S VAUTCL=1
"RTN","SDMHAD",43,0)
 I $D(SDXFLG) D PXRMD
"RTN","SDMHAD",44,0)
 I $D(SDALL) I SDALL="M" D PXRMD
"RTN","SDMHAD",45,0)
 I VAUTD=1 D
"RTN","SDMHAD",46,0)
 .S SDDIV=0 F SDDIV=0:0 S SDDIV=$O(^DG(40.8,SDDIV)) Q:'SDDIV  I $D(^DG(40.8,SDDIV,0)) S VAUTD(SDDIV)=$P(^DG(40.8,SDDIV,0),"^",1)
"RTN","SDMHAD",47,0)
 I SDTL'="MEN" F SDCL=0:0 S SDCL=$O(^SC(SDCL)) Q:'SDCL  I $D(^SC(SDCL,0)),$P($G(^SC(SDCL,0)),"^",3)="C" D
"RTN","SDMHAD",48,0)
 .S SDSC=$P($G(^SC(SDCL,0)),"^",7),SDDIV=$S('$P($G(^SC(SDCL,0)),"^",15):"NOT SPECIFIED",1:$P($G(^SC(SDCL,0)),"^",15)) I SDSC D CHK  ;S ^TMP("SDCLST",$J,SDCL,SDSC)=$P(^SC(SDCL,0),"^",1)
"RTN","SDMHAD",49,0)
 I SDTL="MEN" S SDRLL=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",0)) D
"RTN","SDMHAD",50,0)
 .F SDDIV=0:0 S SDDIV=$O(VAUTRR(SDDIV)) Q:'SDDIV  F SDSC=0:0 S SDSC=$O(VAUTRR(SDDIV,SDSC)) Q:'SDSC  F SDCL=0:0 S SDCL=$O(VAUTRR(SDDIV,SDSC,SDCL)) Q:'SDCL  I SDCL D CHK
"RTN","SDMHAD",51,0)
 S SDLINE=$S($D(^TMP(NAMSPC,$J)):"PROCESS",1:"END")
"RTN","SDMHAD",52,0)
 D @SDLINE
"RTN","SDMHAD",53,0)
 G QUIT
"RTN","SDMHAD",54,0)
 ;
"RTN","SDMHAD",55,0)
 ;
"RTN","SDMHAD",56,0)
PROCESS ;find patients in date range that had a no show appt for a MH clinic.
"RTN","SDMHAD",57,0)
 N SDIV,SDC,SDR,SDS,SDHFL,SDUP,SDMHFLG,SDMHNFLG,SDACT
"RTN","SDMHAD",58,0)
 S (SDIV,SDC,SDR,SDS,SDUP)=0
"RTN","SDMHAD",59,0)
 S SDMHFLG=$$GET^XPAR("PKG.REGISTRATION","DGPF SUICIDE FLAG",1,"E")
"RTN","SDMHAD",60,0)
 S SDMHFLG("L")=$$GETFLAG^DGPFAPIU(SDMHFLG,"L")
"RTN","SDMHAD",61,0)
 S SDMHNFLG="HIGH RISK FOR SUICIDE" ; for increment 3
"RTN","SDMHAD",62,0)
 S SDMHFLG("N")=$$GETFLAG^DGPFAPIU(SDMHNFLG,"N") ; for increment 3
"RTN","SDMHAD",63,0)
 F SDIV=0:0 S SDIV=$O(^TMP(NAMSPC,$J,SDIV)) Q:SDIV=""!(SDUP)  F SDC=SDC:0 S SDC=$O(^TMP(NAMSPC,$J,SDIV,SDC)) Q:SDC=""!(SDUP)  F SDS=SDS:0 S SDS=$O(^TMP(NAMSPC,$J,SDIV,SDC,SDS)) Q:SDS=""!(SDUP)  D
"RTN","SDMHAD",64,0)
 .I SDTL="MEN" S SDR=$P($G(^TMP(NAMSPC,$J,SDIV,SDC,SDS)),"^",4)
"RTN","SDMHAD",65,0)
 .N SDDT,SDNUM,SDNUM1,DFN,SDSTAT,ACT,SDRR
"RTN","SDMHAD",66,0)
 .S (SDDT,SDNUM,SDNUM1,DFN,SDSTAT)=0
"RTN","SDMHAD",67,0)
 .F SDDT=SDBEG:0 S SDDT=$O(^SC(SDC,"S",SDDT)) Q:'SDDT!(SDDT>SDEND)!(SDUP)  F SDNUM=0:0 S SDNUM=$O(^SC(SDC,"S",SDDT,SDNUM)) Q:'SDNUM!(SDUP)  F SDNUM1=0:0 S SDNUM1=$O(^SC(SDC,"S",SDDT,SDNUM,SDNUM1)) Q:'SDNUM1!(SDUP)  D
"RTN","SDMHAD",68,0)
 ..Q:'$D(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,0))
"RTN","SDMHAD",69,0)
 ..S DFN=$P($G(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,0)),"^",1) Q:'DFN  Q:$D(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,"C"))
"RTN","SDMHAD",70,0)
 ..;I $D(^DPT(DFN,0)),$D(^DPT(DFN,"S",SDDT))S SDSTAT=$P($G(^DPT(DFN,"S",SDDT,0)),"^",2),SDDTNT=$P(SDDT,".",1) I $$GETINF^DGPFAPIH(DFN,SDMHFLG("L"),SDDTNT,SDDTNT,"ACT")!($$GETINF^DGPFAPIH(DFN,SDMHFLG("N"),SDDTNT,SDDTNT,"ACT")) D  Q:SDUP
"RTN","SDMHAD",71,0)
 .. I $D(^DPT(DFN,0)),$D(^DPT(DFN,"S",SDDT)) S SDSTAT=$P($G(^DPT(DFN,"S",SDDT,0)),"^",2) D ACT I SDACT D  Q:SDUP
"RTN","SDMHAD",72,0)
 ...N PATNM,SDCLNM,SDDIVNM,SDSCNM,SDZERO
"RTN","SDMHAD",73,0)
 ... S SDSTAT=$S(SDSTAT="N":"NS",SDSTAT="NT":"NAT",SDSTAT="NA":"NSA",SDSTAT="":"NAT",1:SDSTAT)
"RTN","SDMHAD",74,0)
 ...I SDSTAT'["N" Q
"RTN","SDMHAD",75,0)
 ...S SDDIVNM=$S($P(^DG(40.8,SDIV,0),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DG(40.8,SDIV,0),"^",1))
"RTN","SDMHAD",76,0)
 ...S SDCLNM=$S($P($G(^SC(SDC,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^SC(SDC,0),"^",1))
"RTN","SDMHAD",77,0)
 ...S SDSCNM=$S($P($G(^DIC(40.7,SDS,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DIC(40.7,SDS,0),"^",1))
"RTN","SDMHAD",78,0)
 ...S PATNM=$S($P($G(^DPT(DFN,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DPT(DFN,0),"^",1))
"RTN","SDMHAD",79,0)
 ...I SDTL="CLIN" S ^TMP(NAMSPC1,$J,SDDIVNM,SDCLNM,PATNM,SDS,SDDT)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS ;D TOTAL(SDDIVNM,SDCLNM)
"RTN","SDMHAD",80,0)
 ...I SDTL="STOP" S ^TMP(NAMSPC1,$J,SDDIVNM,SDSCNM,PATNM,SDCLNM,SDDT)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS
"RTN","SDMHAD",81,0)
 ...I SDTL="MEN" S SDRR=$P(^PXRMD(810.9,SDR,0),"^",1) S ^TMP(NAMSPC1,$J,SDDIVNM,SDRR,SDCLNM,PATNM,SDDT)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS
"RTN","SDMHAD",82,0)
 ...D TOTAL(SDDIVNM,SDCLNM)
"RTN","SDMHAD",83,0)
BGJ I $D(SDXFLG) D  Q
"RTN","SDMHAD",84,0)
 .I '$D(^TMP(NAMSPC1,$J)) D HEAD^SDMHNS
"RTN","SDMHAD",85,0)
 .D ^SDMHNS1 Q
"RTN","SDMHAD",86,0)
 I '$D(^TMP(NAMSPC1,$J)) G END
"RTN","SDMHAD",87,0)
 D ^SDMHAD1
"RTN","SDMHAD",88,0)
 Q
"RTN","SDMHAD",89,0)
CHK ;Check to see if Division/Clinic/Stop have been selected & if  Clinic and Stop code are a valid mental health pair.
"RTN","SDMHAD",90,0)
 N SDFLG,SDCLNM,SDDIVNM,SDSCNM
"RTN","SDMHAD",91,0)
 S SDFLG=0
"RTN","SDMHAD",92,0)
 I $D(VAUTD) D  Q:SDFLG
"RTN","SDMHAD",93,0)
 . I SDDIV="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAD",94,0)
 . I 'VAUTD,'$D(VAUTD(SDDIV)) S SDFLG=1 Q
"RTN","SDMHAD",95,0)
 I $D(VAUTCL) D  Q:SDFLG
"RTN","SDMHAD",96,0)
 . I SDCL="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAD",97,0)
 . I 'VAUTCL,'$D(VAUTCL(SDCL)) S SDFLG=1 Q
"RTN","SDMHAD",98,0)
 I $D(VAUTSC) D  Q:SDFLG
"RTN","SDMHAD",99,0)
 . I SDSC="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAD",100,0)
 . I 'VAUTSC,'$D(VAUTSC(SDSC)) S SDFLG=1 Q
"RTN","SDMHAD",101,0)
 Q:'$D(^DG(40.8,SDDIV,0))
"RTN","SDMHAD",102,0)
 S SDDIVNM=$S($P($G(^DG(40.8,SDDIV,0)),"^",1)="":"NOT SPECIFIED",1:$P(^DG(40.8,SDDIV,0),"^",1))
"RTN","SDMHAD",103,0)
 Q:'$D(^SC(SDCL,0))
"RTN","SDMHAD",104,0)
 S SDCLNM=$S($P($G(^SC(SDCL,0)),"^",1)="":"NOT SPECIFIED",1:$P(^SC(SDCL,0),"^",1))
"RTN","SDMHAD",105,0)
 Q:'$D(^DIC(40.7,SDSC,0))
"RTN","SDMHAD",106,0)
 S SDSCNM=$S($P($G(^DIC(40.7,SDSC,0)),"^",1)="":"NOT SPECIFIED",1:$P(^DIC(40.7,SDSC,0),"^",1))
"RTN","SDMHAD",107,0)
 S ^TMP(NAMSPC,$J,SDDIV,SDCL,SDSC)=SDDIVNM_"^"_SDCLNM_"^"_SDSCNM_"^"_$S(SDRLL="NOT SPECIFIED":"NOT SPECIFIED",1:SDRLL)
"RTN","SDMHAD",108,0)
 Q
"RTN","SDMHAD",109,0)
ACT ;Make sure patient has active flag
"RTN","SDMHAD",110,0)
 N SDDTNT
"RTN","SDMHAD",111,0)
 S SDDTNT=$P(SDDT,".",1)
"RTN","SDMHAD",112,0)
 I $$GETINF^DGPFAPIH(DFN,SDMHFLG("L"),SDDTNT,SDDTNT,"ACT") S SDACT=1 Q
"RTN","SDMHAD",113,0)
 I $$GETINF^DGPFAPIH(DFN,SDMHFLG("N"),SDDTNT,SDDTNT,"ACT") S SDACT=1 Q  ;For increment 3
"RTN","SDMHAD",114,0)
 S SDACT=0
"RTN","SDMHAD",115,0)
 Q
"RTN","SDMHAD",116,0)
 ;
"RTN","SDMHAD",117,0)
HEAD ;Heading for the report
"RTN","SDMHAD",118,0)
 W @IOF
"RTN","SDMHAD",119,0)
 W "HIGH RISK MENTAL HEALTH NO SHOW ADHOC REPORT BY",?70,"PAGE " S SDPAG=SDPAG+1 W SDPAG,!
"RTN","SDMHAD",120,0)
 W $S(SDTL="MEN":"MH CLINICS",SDTL="STOP":"STOP CODES",1:"CLINICS")_" for Appointments "_$$FMTE^XLFDT(SDBEG,"2")_"-"_$$FMTE^XLFDT($P(SDEND,".",1),"2"),?56,"Run: "_SDDAT
"RTN","SDMHAD",121,0)
 I $D(SDTOTPG) W !!,"Totals Page"
"RTN","SDMHAD",122,0)
 I '$D(SDTOTPG) W !!,"*STATUS: NS = No Show      NA = No Show Auto Rebook     NAT = No Action Taken"
"RTN","SDMHAD",123,0)
 I '$D(SDTOTPG) W !!,"#",?4,"PATIENT",?25,"PT ID",?31,"APPT D/T",?49,"CLINIC/STATUS/PROVIDER"
"RTN","SDMHAD",124,0)
 W !,$$LINE(""),!
"RTN","SDMHAD",125,0)
HEAD1 I $D(^TMP(NAMSPC1,$J)),'$D(SDTOTPG) D
"RTN","SDMHAD",126,0)
 . N SDHEAD2
"RTN","SDMHAD",127,0)
 .I SDTL'="STOP" S SDHEAD2="DIVISION/CLINIC/STOP: "_$E(SDXDIV,1,24)_"/"_$E(SDXCLIN,1,26)_"/"_$E(SDXSTOP,1,4)
"RTN","SDMHAD",128,0)
 .I SDTL="STOP" S SDHEAD2="DIVISION/STOP/CLINIC: "_$E(SDXDIV,1,24)_"/"_$E(SDXSTOPN,1,4)_"/"_$E(SDXCLIN,1,26)
"RTN","SDMHAD",129,0)
 .W SDHEAD2,!
"RTN","SDMHAD",130,0)
 Q
"RTN","SDMHAD",131,0)
 ;
"RTN","SDMHAD",132,0)
 ;
"RTN","SDMHAD",133,0)
RANGE() ;Select Start and End date for report
"RTN","SDMHAD",134,0)
 W !!,$$LINE(" High Risk Mental Health NO SHOW Adhoc Report")
"RTN","SDMHAD",135,0)
 Q $$RANGE^SDAMQ(.SDBEG,.SDEND)
"RTN","SDMHAD",136,0)
 ;
"RTN","SDMHAD",137,0)
DIV() ;Division selection for multidivisional facility
"RTN","SDMHAD",138,0)
 D ASK2^SDDIV I Y<0 K VAUTD
"RTN","SDMHAD",139,0)
 Q $D(VAUTD)>0
"RTN","SDMHAD",140,0)
 ;
"RTN","SDMHAD",141,0)
LIST N X I '$D(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL")) D  Q
"RTN","SDMHAD",142,0)
 .I '$D(SDXFLG) W !!!,"Reminder location List file is not current.",!,"Missing reminder location list 'VA-MH NO SHOW APPT CLINICS LL' in file 810.9.",!,"Report Aborting!",! S Y=1 Q
"RTN","SDMHAD",143,0)
 .N SDX S SDX="",X=""
"RTN","SDMHAD",144,0)
 .S SDX=$$SETSTR^SDMHNS1("Reminder location List file is not current.",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHAD",145,0)
 .S SDX="",X="" S SDX=$$SETSTR^SDMHNS1("Missing reminder location list 'VA-MH NO SHOW APPT CLINICS LL' in file 810.9.",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHAD",146,0)
 .S SDX="",X="" S SDX=$$SETSTR^SDMHNS1("Report Aborted!",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHAD",147,0)
 .S SDX=""
"RTN","SDMHAD",148,0)
 .S Y=1
"RTN","SDMHAD",149,0)
LINE(STR) ; Print display prompts
"RTN","SDMHAD",150,0)
 N X
"RTN","SDMHAD",151,0)
 I '$G(IOM) S IOM=79
"RTN","SDMHAD",152,0)
 S:STR]"" STR=" "_STR_" "
"RTN","SDMHAD",153,0)
 S $P(X,"*",(IOM/2)-($L(STR)/2))=""
"RTN","SDMHAD",154,0)
 Q X_STR_X
"RTN","SDMHAD",155,0)
 ;
"RTN","SDMHAD",156,0)
LINE1(STR) ; Print display prompts
"RTN","SDMHAD",157,0)
 N X
"RTN","SDMHAD",158,0)
 I '$G(IOM) S IOM=79
"RTN","SDMHAD",159,0)
 S:STR]"" STR=" "_STR_" "
"RTN","SDMHAD",160,0)
 S $P(X," ",(IOM/2)-($L(STR)/2))=""
"RTN","SDMHAD",161,0)
 Q X_STR_X
"RTN","SDMHAD",162,0)
 ;
"RTN","SDMHAD",163,0)
 ;
"RTN","SDMHAD",164,0)
TOTAL(DIV,CLST) ;INITIALIZE total(DIV,CLIN/STOP)
"RTN","SDMHAD",165,0)
 I '$D(TOTAL(DIV,CLST)) D
"RTN","SDMHAD",166,0)
 .N SDCNTT S SDCNTT=0
"RTN","SDMHAD",167,0)
 .S TOTAL(DIV,CLST)="0^0^0^0^0"
"RTN","SDMHAD",168,0)
 I $D(TOTAL(DIV,CLST)) D
"RTN","SDMHAD",169,0)
 .S $P(TOTAL(DIV,CLST),"^",1)=$P($G(TOTAL(DIV,CLST)),"^",1)+1
"RTN","SDMHAD",170,0)
 .N X S X=$S(SDSTAT="NS":2,SDSTAT="NSA":3,1:4) S $P(TOTAL(DIV,CLST),"^",X)=$P(TOTAL(DIV,CLST),"^",X)+1
"RTN","SDMHAD",171,0)
 .I '$D(SDPAT(DIV,CLST,DFN)) S SDPAT(DIV,CLST,DFN)="",$P(TOTAL(DIV,CLST),"^",5)=$P(TOTAL(DIV,CLST),"^",5)+1
"RTN","SDMHAD",172,0)
 Q
"RTN","SDMHAD",173,0)
 ;
"RTN","SDMHAD",174,0)
 ;
"RTN","SDMHAD",175,0)
CLIN ;select clinics
"RTN","SDMHAD",176,0)
 W !!,"Clinic Selection:",!,?20,"A All clinics",!,?20,"M Mental Health clinics only",!
"RTN","SDMHAD",177,0)
CL1 R !,"Select: (A)ll clinics  A//",X:DTIME S:X["^"!('$T) Y=-1 Q:Y=-1  S X=$S(X="":"A",1:$E(X)) I "AMam"'[X W !,?6,"Enter : 'A' for All clinics",!,?14,"'M' for Mental Health clinics only" G CL1
"RTN","SDMHAD",178,0)
 S SDALL=X
"RTN","SDMHAD",179,0)
 N DIC,K,VAUTVB,VAUTSTR,VAUTNI
"RTN","SDMHAD",180,0)
 S VAUTVB="VAUTCL",DIC="^SC("
"RTN","SDMHAD",181,0)
 I SDALL="M" S DIC("S")="N X,K S X=$O(^PXRMD(810.9,""B"",""VA-MH NO SHOW APPT CLINICS LL"",0)) I $D(^SC(+Y,0)) S K=$P(^SC(+Y,0),""^"",7) I $D(^PXRMD(810.9,X,40.7,""B"",+K))"
"RTN","SDMHAD",182,0)
 S VAUTSTR="Clinic",VAUTNI=2 D FIRST^VAUTOMA S:Y=-1 SDFL=1 Q:$D(SDFL)
"RTN","SDMHAD",183,0)
 Q
"RTN","SDMHAD",184,0)
 ;
"RTN","SDMHAD",185,0)
STOP N SDFL,DIC,K,VAUTVB,VAUTSTR,VAUTNI
"RTN","SDMHAD",186,0)
 W !!,"Stop Code Selection:",!,?20,"A  All Stop Codes",!,?20,"M  Mental Health Stop Codes only",!
"RTN","SDMHAD",187,0)
ST1 R !,"Select: (A)ll Stop Codes  A//",X:DTIME S:X["^"!('$T) Y=-1 Q:Y=-1  S X=$S(X="":"A",1:$E(X)) I "AMam"'[X W !,?6,"Enter:  'A' for All Stop Codes",!,?14,"'M' for Mental Health Stop Codes only" G ST1
"RTN","SDMHAD",188,0)
 S SDALL=X
"RTN","SDMHAD",189,0)
 S VAUTVB="VAUTSC",DIC="^DIC(40.7,"
"RTN","SDMHAD",190,0)
 I SDALL="M" S DIC("S")="N X S X=$O(^PXRMD(810.9,""B"",""VA-MH NO SHOW APPT CLINICS LL"",0)) I $D(^PXRMD(810.9,X,40.7,""B"",+Y))"
"RTN","SDMHAD",191,0)
 S VAUTSTR="Stop codes",VAUTNI=2 D FIRST^VAUTOMA
"RTN","SDMHAD",192,0)
 Q
"RTN","SDMHAD",193,0)
STOP1 N SDFL,DIC,K,VAUTVB,VAUTSTR,VAUTNI
"RTN","SDMHAD",194,0)
 S VAUTVB="VAUTSC",DIC="^DIC(40.7,",DIC("S")="S SDFL=0 D MEN1^SDMHAD I SDFL",VAUTSTR="Stop codes",VAUTNI=2 D FIRST^VAUTOMA
"RTN","SDMHAD",195,0)
 Q
"RTN","SDMHAD",196,0)
 ;
"RTN","SDMHAD",197,0)
MEN S VAUTR=0
"RTN","SDMHAD",198,0)
MEN1 N X S X=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",0)) S VAUTR(X)=$P($G(^PXRMD(810.9,X,0)),"^",1)
"RTN","SDMHAD",199,0)
 I SDTL="STOP" D
"RTN","SDMHAD",200,0)
 . I $D(^PXRMD(810.9,X,40.7,"B",+Y)) S SDFL=1
"RTN","SDMHAD",201,0)
 . Q
"RTN","SDMHAD",202,0)
 Q
"RTN","SDMHAD",203,0)
 ;
"RTN","SDMHAD",204,0)
PID(DFN) ; Return PID
"RTN","SDMHAD",205,0)
 ; INPUT  - DFN
"RTN","SDMHAD",206,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHAD",207,0)
 N VA
"RTN","SDMHAD",208,0)
 D PID^VADPT6
"RTN","SDMHAD",209,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHAD",210,0)
 ;
"RTN","SDMHAD",211,0)
NAMSPC() ; API returns the name space for this patch
"RTN","SDMHAD",212,0)
 Q "SDNSHOW"
"RTN","SDMHAD",213,0)
NAMSPC1() ; API returns the name space for this patch
"RTN","SDMHAD",214,0)
 Q "SDNS"
"RTN","SDMHAD",215,0)
PXRMD ;Set up Reminder Location List valid Stop Codes for No Show Report
"RTN","SDMHAD",216,0)
 N SDX,SDY,SDI,SDSFL,SDCFL
"RTN","SDMHAD",217,0)
 S SDY=0
"RTN","SDMHAD",218,0)
 S SDX=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",0)) Q:SDX']""  F  S SDY=$O(^PXRMD(810.9,SDX,40.7,"B",SDY)) Q:SDY']""  D
"RTN","SDMHAD",219,0)
 .S SDSTOP(+SDY)=""
"RTN","SDMHAD",220,0)
 .I SDTL="MEN" N SDI S SDI=0 F  S SDI=$O(^SC("AST",+SDY,SDI)) Q:SDI']""  S VAUTRR(+$P($G(^SC(+SDI,0)),"^",15),+SDY,+SDI)=""
"RTN","SDMHAD",221,0)
 .I $D(VAUTSC),$G(VAUTSC)=1 S VAUTSC(+SDY)=$P($G(^DIC(40.7,+SDY,0)),"^",1) S SDSFL=1
"RTN","SDMHAD",222,0)
 .I $D(VAUTCL),$G(VAUTCL)=1 N SDI S SDI=0 F  S SDI=$O(^SC("AST",+SDY,SDI)) Q:SDI']""  D 
"RTN","SDMHAD",223,0)
 ..S VAUTCL(+SDI)=$P($G(^SC(+SDI,0)),"^",1) S SDCFL=1
"RTN","SDMHAD",224,0)
 I $D(SDSFL) S VAUTSC=0
"RTN","SDMHAD",225,0)
 I $D(SDCFL) S VAUTCL=0
"RTN","SDMHAD",226,0)
 Q
"RTN","SDMHAD",227,0)
END ;NO RECORDS
"RTN","SDMHAD",228,0)
 D HEAD
"RTN","SDMHAD",229,0)
 W !!,$$LINE1(">>>>>>  NO RECORDS FOUND <<<<<<")
"RTN","SDMHAD",230,0)
QUIT K %DT,DIR,SDTBEG,SDTEND,SDDIV,VAUTD,VAUTCL,VAUTR,VAUTSC,VADAT,VADATE,POP,X,Y
"RTN","SDMHAD",231,0)
 K ^TMP("SDNSHOW",$J),^TMP("SDNS",$J)
"RTN","SDMHAD",232,0)
 D CLOSE^DGUTQ Q
"RTN","SDMHAD1")
0^7^B108729141
"RTN","SDMHAD1",1,0)
SDMHAD1 ;MAF/ALB - MENTAL HEALTH AD HOC NO SHOW REPORT(cont.);JULY 14, 2010
"RTN","SDMHAD1",2,0)
 ;;5.3;Scheduling;**578,588**;Aug 13,1993;Build 53
"RTN","SDMHAD1",3,0)
 ;
"RTN","SDMHAD1",4,0)
SET ; Set up the data for the patient
"RTN","SDMHAD1",5,0)
 ;       piece 1 = dfn
"RTN","SDMHAD1",6,0)
 ;       piece 2 = Appointment Date and time
"RTN","SDMHAD1",7,0)
 ;       piece 3 = status N(Noshow) or NA (Noshow with auto rebook)
"RTN","SDMHAD1",8,0)
 ;       piece 4 = PID last 4 of SSN
"RTN","SDMHAD1",9,0)
 ;       piece 5 = clinic ien   ^SC(
"RTN","SDMHAD1",10,0)
 ;       piece 6 = stop code ien ^DIC(40.7
"RTN","SDMHAD1",11,0)
 ;   
"RTN","SDMHAD1",12,0)
 ;
"RTN","SDMHAD1",13,0)
EN ;PRINT OF THE ^TMP 
"RTN","SDMHAD1",14,0)
 N SDXDIV,SDXCLIN,SDXDFN,SDXSTOP,SDXREM,SDXNM,SDCOUNT,SDATE,SDTOTPG
"RTN","SDMHAD1",15,0)
 S (SDXDFN,SDXREM,SDCOUNT)=0
"RTN","SDMHAD1",16,0)
 S SDXDIV=""
"RTN","SDMHAD1",17,0)
 F  S SDXDIV=$O(^TMP(NAMSPC1,$J,SDXDIV)) Q:SDXDIV']""!(SDUP)  D
"RTN","SDMHAD1",18,0)
 .I SDTL="CLIN" D
"RTN","SDMHAD1",19,0)
 ..S SDXCLIN=""
"RTN","SDMHAD1",20,0)
 ..F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN)) Q:SDXCLIN']""!($G(SDUP))  D
"RTN","SDMHAD1",21,0)
 ...S SDXNM=""
"RTN","SDMHAD1",22,0)
 ...F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM)) Q:SDXNM']""!($G(SDUP))  D
"RTN","SDMHAD1",23,0)
 ....S SDXSTOP=0
"RTN","SDMHAD1",24,0)
 ....F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP)) Q:'SDXSTOP!($G(SDUP))  D
"RTN","SDMHAD1",25,0)
 .....S SDATE=0
"RTN","SDMHAD1",26,0)
 .....F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP,SDATE)) Q:'SDATE!($G(SDUP))  D
"RTN","SDMHAD1",27,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP,SDATE)) D PRT
"RTN","SDMHAD1",28,0)
 .I SDTL="STOP" N SDXSTOPN D
"RTN","SDMHAD1",29,0)
 ..S SDXSTOP=0
"RTN","SDMHAD1",30,0)
 ..F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP)) Q:SDXSTOP']""!($G(SDUP))  D
"RTN","SDMHAD1",31,0)
 ...S SDXNM=""
"RTN","SDMHAD1",32,0)
 ...F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM)) Q:SDXNM']""!($G(SDUP))  D
"RTN","SDMHAD1",33,0)
 ....S SDXCLIN=""
"RTN","SDMHAD1",34,0)
 ....F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN)) Q:SDXCLIN']""!($G(SDUP))  D
"RTN","SDMHAD1",35,0)
 .....S SDATE=0
"RTN","SDMHAD1",36,0)
 .....F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN,SDATE)) Q:'SDATE!($G(SDUP))  D
"RTN","SDMHAD1",37,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN,SDATE)) S SDXSTOPN=$P(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN,SDATE),"^",6) D PRT
"RTN","SDMHAD1",38,0)
 .I SDTL="MEN" D
"RTN","SDMHAD1",39,0)
 ..S SDXREM=""
"RTN","SDMHAD1",40,0)
 ..F  S SDXREM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM)) Q:SDXREM']""!($G(SDUP))  D
"RTN","SDMHAD1",41,0)
 ...S SDXCLIN=""
"RTN","SDMHAD1",42,0)
 ...F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXCLIN)) Q:SDXCLIN']""!($G(SDUP))  D
"RTN","SDMHAD1",43,0)
 ....S SDXNM=""
"RTN","SDMHAD1",44,0)
 ....F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXCLIN,SDXNM)) Q:SDXNM']""!($G(SDUP))  D
"RTN","SDMHAD1",45,0)
 .....S SDATE=0
"RTN","SDMHAD1",46,0)
 .....F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXCLIN,SDXNM,SDATE)) Q:'SDATE!($G(SDUP))  D
"RTN","SDMHAD1",47,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXCLIN,SDXNM,SDATE)) S SDXSTOP=$P(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXCLIN,SDXNM,SDATE),"^",6) D PRT
"RTN","SDMHAD1",48,0)
 Q:SDUP
"RTN","SDMHAD1",49,0)
 I $D(^TMP(NAMSPC1,$J)) S SDTOTPG=1 D HEAD^SDMHAD D TOTAL1^SDMHNS
"RTN","SDMHAD1",50,0)
 Q
"RTN","SDMHAD1",51,0)
 ;
"RTN","SDMHAD1",52,0)
 ;
"RTN","SDMHAD1",53,0)
PRT ;Print  report
"RTN","SDMHAD1",54,0)
 ;
"RTN","SDMHAD1",55,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD^SDMHAD S SDXFLG(SDXDIV)=1 S:SDTL'="STOP" SDXFLG(SDXDIV,SDXCLIN)=1 S:SDTL="STOP" SDXFLG(SDXDIV,SDXSTOP,SDXSTOPN)=1
"RTN","SDMHAD1",56,0)
 I SDTL="CLIN" I $D(SDXFLG(SDXDIV)),'$D(SDXFLG(SDXDIV,SDXCLIN)) W !! D HEAD1^SDMHAD S SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHAD1",57,0)
 I SDTL="STOP" I $D(SDXFLG(SDXDIV)),'$D(SDXFLG(SDXDIV,SDXSTOP,SDXSTOPN)) W !! D HEAD1^SDMHAD S SDXFLG(SDXDIV,SDXSTOP,SDXSTOPN)=1
"RTN","SDMHAD1",58,0)
 D COUNT^SDMHNS
"RTN","SDMHAD1",59,0)
 N SDXNODE,SDXID,SDXDT,SDXSTAT,SDXSORT1,SDXSORT2,SDXCLIEN,SDDSS,SDXRLL,SDXZERO,SDPROV
"RTN","SDMHAD1",60,0)
 S SDPROV=0
"RTN","SDMHAD1",61,0)
 S SDXSORT1=$S(SDTL="MEN":SDXREM,SDTL="STOP":SDXSTOP,1:SDXCLIN)
"RTN","SDMHAD1",62,0)
 S SDXSORT2=$S(SDTL="CLIN":SDXSTOP,1:SDXCLIN)
"RTN","SDMHAD1",63,0)
 I SDTL="MEN" S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXSORT1,SDXSORT2,SDXNM,SDATE))
"RTN","SDMHAD1",64,0)
 I SDTL'="MEN" S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXSORT1,SDXNM,SDXSORT2,SDATE))
"RTN","SDMHAD1",65,0)
 S SDXDFN=$P(SDXNODE,"^",1) Q:SDXDFN']""
"RTN","SDMHAD1",66,0)
 S SDXID=$E($P(SDXNODE,"^",4),1,5)
"RTN","SDMHAD1",67,0)
 S SDXDT=$P(SDXNODE,"^",2)
"RTN","SDMHAD1",68,0)
 S SDXSTAT=$P(SDXNODE,"^",3)
"RTN","SDMHAD1",69,0)
 S SDXCLIEN=$P(SDXNODE,"^",5)
"RTN","SDMHAD1",70,0)
 S SDDSS=$P($G(^DIC(40.7,+$P(SDXNODE,"^",6),0)),"^",2)
"RTN","SDMHAD1",71,0)
 S SDXDT=$$FMTE^XLFDT(SDXDT,"5") W !!,SDCOUNT,?4,$E($P(^DPT(SDXDFN,0),"^",1),1,20),?25,SDXID,?31,SDXDT,?49,$E(SDXCLIN,1,30)
"RTN","SDMHAD1",72,0)
 W !?47,$E("*"_SDXSTAT,1,5) D PROV W ?53,$E(SDPROV,1,26) D RET Q:SDUP  I SDCOUNT=$P($G(TOTAL(SDXDIV,SDXCLIN)),"^",1) S SDCOUNT=0
"RTN","SDMHAD1",73,0)
 D RET Q:SDUP  ;D PROV Q:SDUP
"RTN","SDMHAD1",74,0)
 D PATINFO Q:SDUP
"RTN","SDMHAD1",75,0)
 D RET Q:SDUP  D NOK Q:SDUP
"RTN","SDMHAD1",76,0)
 D RET Q:SDUP  D EC Q:SDUP
"RTN","SDMHAD1",77,0)
 ;D RET Q:SDUP  D PROV Q:SDUP
"RTN","SDMHAD1",78,0)
 D RET Q:SDUP  D MHTC Q:SDUP
"RTN","SDMHAD1",79,0)
 D RET Q:SDUP  D FUT Q:SDUP
"RTN","SDMHAD1",80,0)
 D RET Q:SDUP  D RESULTS Q:SDUP
"RTN","SDMHAD1",81,0)
 Q
"RTN","SDMHAD1",82,0)
 ;
"RTN","SDMHAD1",83,0)
 ;
"RTN","SDMHAD1",84,0)
PATINFO ;Patients home, cell and office phones
"RTN","SDMHAD1",85,0)
 N SDPHON,VAROOT,VAOA,SDEC6,SDEC5,DFN
"RTN","SDMHAD1",86,0)
 S DFN=SDXDFN,VAROOT="SDEC6" D ADD^VADPT
"RTN","SDMHAD1",87,0)
 I $D(SDEC6) D
"RTN","SDMHAD1",88,0)
 .S SDPHON("HOME")=SDEC6(8)
"RTN","SDMHAD1",89,0)
 S DFN=SDXDFN,VAOA("A")=5,VAROOT="SDEC5" D OAD^VADPT
"RTN","SDMHAD1",90,0)
 I $D(SDEC5) D
"RTN","SDMHAD1",91,0)
 .S SDPHON("WORK")=SDEC5(8)
"RTN","SDMHAD1",92,0)
 D GETS^DIQ(2,SDXDFN_",",".134","E","SDPHON")
"RTN","SDMHAD1",93,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHAD1",94,0)
 .S SDPHON("CELL")=$G(SDPHON(2,SDXDFN_",",".134","E"))
"RTN","SDMHAD1",95,0)
 I $D(SDPHON("HOME")),SDPHON("HOME")]"" W !,?5,"Home: ",$$HLPHONE^HLFNC(SDPHON("HOME"),,) D RET Q:SDUP
"RTN","SDMHAD1",96,0)
 I $D(SDPHON("WORK")),SDPHON("WORK")]"" W !,?5,"Work: ",$$HLPHONE^HLFNC(SDPHON("WORK"),,) D RET Q:SDUP
"RTN","SDMHAD1",97,0)
 I $D(SDPHON("CELL")),SDPHON("CELL")]"" W !,?5,"Cell: ",$$HLPHONE^HLFNC(SDPHON("CELL"),,) D RET Q:SDUP
"RTN","SDMHAD1",98,0)
 Q
"RTN","SDMHAD1",99,0)
 ;
"RTN","SDMHAD1",100,0)
 ;
"RTN","SDMHAD1",101,0)
NOK ; Next of Kin information
"RTN","SDMHAD1",102,0)
 N SDNOK,SDNOK2,SDNOKNM,SDNOKNM2,SDNOKR,SDNOKR2,SDNOKPH,SDNOKPH2,SDNOKPO,SDNOKPO2,SDNOKFL,VAOA,VAROOT,SDEC3,SDEC4,SDPHON,DFN
"RTN","SDMHAD1",103,0)
 S DFN=SDXDFN,VAROOT="SDEC3" D OAD^VADPT
"RTN","SDMHAD1",104,0)
 S DFN=SDXDFN,VAOA("A")=3,VAROOT="SDEC4" D OAD^VADPT
"RTN","SDMHAD1",105,0)
 D GETS^DIQ(2,SDXDFN_",",".21011;.211011","E","SDPHON")
"RTN","SDMHAD1",106,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHAD1",107,0)
 .S SDPHON("K-WORK")=$G(SDPHON(2,SDXDFN_",",".21011","E"))
"RTN","SDMHAD1",108,0)
 .S SDPHON("K2-WORK")=$G(SDPHON(2,SDXDFN_",",".211011","E"))
"RTN","SDMHAD1",109,0)
 I $D(SDEC3) D
"RTN","SDMHAD1",110,0)
 .S SDNOKNM=SDEC3(9),SDNOKR=SDEC3(10),SDNOKPH=SDEC3(8),SDNOKPO=SDPHON("K-WORK")
"RTN","SDMHAD1",111,0)
 I $D(SDEC4) D
"RTN","SDMHAD1",112,0)
 .S SDNOKNM2=SDEC4(9),SDNOKR2=SDEC4(10),SDNOKPH2=SDEC3(8),SDNOKPO2=SDPHON("K2-WORK")
"RTN","SDMHAD1",113,0)
 I SDNOKNM]""!(SDNOKNM2]"") D NOKFL D RET Q:SDUP
"RTN","SDMHAD1",114,0)
 I SDNOKNM]"" W ?7,"NOK: "_SDNOKNM D RET Q:SDUP
"RTN","SDMHAD1",115,0)
 I SDNOKNM2]"" W ?45,"NOK2: "_SDNOKNM2
"RTN","SDMHAD1",116,0)
 I SDNOKR]""!(SDNOKR2]"") D  D RET Q:SDUP
"RTN","SDMHAD1",117,0)
 .I '$D(SDNOKFL) D NOKFL Q
"RTN","SDMHAD1",118,0)
 .W !
"RTN","SDMHAD1",119,0)
 I SDNOKR]"" W ?7,"Relation: "_SDNOKR D RET Q:SDUP
"RTN","SDMHAD1",120,0)
 I SDNOKR2]"" W ?45,"Relation: "_SDNOKR2
"RTN","SDMHAD1",121,0)
 I SDNOKPH]""!(SDNOKPH2]"") D  D RET Q:SDUP
"RTN","SDMHAD1",122,0)
 .I '$D(SDNOKFL) D NOKFL Q
"RTN","SDMHAD1",123,0)
 .W !
"RTN","SDMHAD1",124,0)
 D RET Q:SDUP
"RTN","SDMHAD1",125,0)
 I SDNOKPH]"" W ?7,"Phone: "_$$HLPHONE^HLFNC(SDNOKPH,,)
"RTN","SDMHAD1",126,0)
 I SDNOKPH2]"" W ?45,"Phone: "_$$HLPHONE^HLFNC(SDNOKPH2,,)
"RTN","SDMHAD1",127,0)
 I SDNOKPO]""!(SDNOKPO2]"") D  D RET Q:SDUP
"RTN","SDMHAD1",128,0)
 .I '$D(SDNOKFL) D NOKFL Q
"RTN","SDMHAD1",129,0)
 .W !
"RTN","SDMHAD1",130,0)
 I SDNOKPO]"" W ?7,"Work Phone: "_$$HLPHONE^HLFNC(SDNOKPO,,)
"RTN","SDMHAD1",131,0)
 I SDNOKPO2]"" W ?45,"Work Phone: "_$$HLPHONE^HLFNC(SDNOKPO2,,)
"RTN","SDMHAD1",132,0)
 W ! D RET Q:SDUP
"RTN","SDMHAD1",133,0)
 Q
"RTN","SDMHAD1",134,0)
 ;
"RTN","SDMHAD1",135,0)
 ;
"RTN","SDMHAD1",136,0)
NOKFL W !!,"     Next of Kin:",! S SDNOKFL=1
"RTN","SDMHAD1",137,0)
 Q
"RTN","SDMHAD1",138,0)
 ;
"RTN","SDMHAD1",139,0)
 ;
"RTN","SDMHAD1",140,0)
EC ;display emergency contact information
"RTN","SDMHAD1",141,0)
 N SDEC1,SDEC2,SDPHON,VAROOT,VAOA
"RTN","SDMHAD1",142,0)
 Q:'$G(SDXDFN)
"RTN","SDMHAD1",143,0)
 N DFN
"RTN","SDMHAD1",144,0)
 S DFN=SDXDFN
"RTN","SDMHAD1",145,0)
 S VAOA("A")=1,VAROOT="SDEC1"  D OAD^VADPT ; Get Primary EC
"RTN","SDMHAD1",146,0)
 S VAOA("A")=4,VAROOT="SDEC2"  D OAD^VADPT ; Get Secondary EC
"RTN","SDMHAD1",147,0)
 D GETS^DIQ(2,SDXDFN_",",".33011;.331011","E","SDPHON")
"RTN","SDMHAD1",148,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHAD1",149,0)
 .S SDPHON("E-WORK")=$G(SDPHON(2,SDXDFN_",",".33011","E"))
"RTN","SDMHAD1",150,0)
 .S SDPHON("E2-WORK")=$G(SDPHON(2,SDXDFN_",",".331011","E"))
"RTN","SDMHAD1",151,0)
 I SDEC1(9)]"" D
"RTN","SDMHAD1",152,0)
 . D RET Q:SDUP  I $D(SDEC1)!($D(SDEC2)) W !,?5,"Emergency Contact:" D RET Q:SDUP
"RTN","SDMHAD1",153,0)
 . ;Contacts name and realtionship
"RTN","SDMHAD1",154,0)
 . I SDEC1(9)]"" W !?7,"E-Cont.: ",SDEC1(9)
"RTN","SDMHAD1",155,0)
 . I SDEC2(9)]"" I SDEC2(9)]"" W ?45,"E2-Cont.: ",SDEC2(9)
"RTN","SDMHAD1",156,0)
 . D RET Q:SDUP  I SDEC1(10)]"" W !,?7,"Relation: ",SDEC1(10)
"RTN","SDMHAD1",157,0)
 . I SDEC2(10)]"" W ?45,"Relation: ",SDEC2(10)
"RTN","SDMHAD1",158,0)
 . ;ECs address lines 1, 2 and 3
"RTN","SDMHAD1",159,0)
 . D RET Q:SDUP  I SDEC1(1)]"" W !,?9,SDEC1(1)
"RTN","SDMHAD1",160,0)
 . I SDEC1(1)']"",SDEC2(1)]"" D RET Q:SDUP  W !
"RTN","SDMHAD1",161,0)
 . I SDEC2(1)]"" W ?47,SDEC2(1)
"RTN","SDMHAD1",162,0)
 . D RET Q:SDUP  I SDEC1(2)]"" W !,?9,SDEC1(2)
"RTN","SDMHAD1",163,0)
 . I SDEC1(2)']"",SDEC2(2)]"" D RET Q:SDUP  W !
"RTN","SDMHAD1",164,0)
 . I SDEC2(2)]"" W ?47,SDEC2(2)
"RTN","SDMHAD1",165,0)
 . D RET Q:SDUP  I SDEC1(3)]"" W !,?9,SDEC1(3)
"RTN","SDMHAD1",166,0)
 . I SDEC1(3)']"",SDEC2(3)]"" D RET Q:SDUP  W !
"RTN","SDMHAD1",167,0)
 . I SDEC2(3)]"" W ?47,SDEC2(3)
"RTN","SDMHAD1",168,0)
 . ;Emergency Contact 1 City, State an Zip+4
"RTN","SDMHAD1",169,0)
 . I SDEC1(4)]"" D
"RTN","SDMHAD1",170,0)
 . . D RET Q:SDUP  W !,?9,SDEC1(4)
"RTN","SDMHAD1",171,0)
 . . I SDEC1(5)]"" W ", "_$$GET1^DIQ(5,+SDEC1(5),1)
"RTN","SDMHAD1",172,0)
 . . W "  ",$P(SDEC1(11),"^",2)
"RTN","SDMHAD1",173,0)
 . ;Emergency Contact 2 City State and Zip+4
"RTN","SDMHAD1",174,0)
 . I SDEC2(4)]"" D
"RTN","SDMHAD1",175,0)
 . . D RET Q:SDUP  I SDEC1(4)']"" W !
"RTN","SDMHAD1",176,0)
 . . W ?47,SDEC2(4)
"RTN","SDMHAD1",177,0)
 . . I SDEC2(5)]"" W ", "_$$GET1^DIQ(5,+SDEC2(5),1)
"RTN","SDMHAD1",178,0)
 . . W "  ",$P(SDEC2(11),"^",2)
"RTN","SDMHAD1",179,0)
 . ;Home and work phones
"RTN","SDMHAD1",180,0)
 . D RET Q:SDUP  I SDEC1(8)]"" W !,?7,"Phone: "_$$HLPHONE^HLFNC(SDEC1(8),,)
"RTN","SDMHAD1",181,0)
 . I SDEC2(8)]"" W ?45,"Phone: "_$$HLPHONE^HLFNC(SDEC2(8),,)
"RTN","SDMHAD1",182,0)
 . D RET Q:SDUP  I SDPHON("E-WORK")]"" W !?7,"Work Phone: "_$$HLPHONE^HLFNC(SDPHON("E-WORK"),,)     ;,$S($P(^DPT(DFN,.33),U,11)]"":$P(^DPT(DFN,.33),U,11),1:"UNSPECIFIED")
"RTN","SDMHAD1",183,0)
 . I SDPHON("E2-WORK")]"" W ?45,"Work Phone: "_$$HLPHONE^HLFNC(SDPHON("E2-WORK"),,)    ;,$S($P(^DPT(DFN,.331),U,11)]"":$P(^DPT(DFN,.331),U,11),1:"UNSPECIFIED")
"RTN","SDMHAD1",184,0)
 D KVAR^VADPT
"RTN","SDMHAD1",185,0)
 Q
"RTN","SDMHAD1",186,0)
 ;
"RTN","SDMHAD1",187,0)
 ;
"RTN","SDMHAD1",188,0)
PROV ;Clinic Default Provider
"RTN","SDMHAD1",189,0)
 N SDPNUM,SDPNODE
"RTN","SDMHAD1",190,0)
 S SDPNUM=0
"RTN","SDMHAD1",191,0)
 F SDPNUM=0:0 S SDPNUM=$O(^SC(SDXCLIEN,"PR",SDPNUM)) Q:'(+SDPNUM)  I $D(^SC(SDXCLIEN,"PR",SDPNUM,0)) S SDPNODE=^SC(SDXCLIEN,"PR",SDPNUM,0) I $P(SDPNODE,"^",1)&($P(SDPNODE,"^",2)) D  Q:SDUP
"RTN","SDMHAD1",192,0)
 . S SDPROV=$E($P(^VA(200,$P(SDPNODE,"^",1),0),"^",1),1,25) ;D RET
"RTN","SDMHAD1",193,0)
 ;.W !,?5,"Provider:  "_$P(^VA(200,$P(SDPNODE,"^",1),0),"^",1) D RET
"RTN","SDMHAD1",194,0)
 Q
"RTN","SDMHAD1",195,0)
 ;
"RTN","SDMHAD1",196,0)
 ;
"RTN","SDMHAD1",197,0)
MHTC ;Mental Health Treatment Coordinator
"RTN","SDMHAD1",198,0)
 ;Q:'$T(START^SCMCMHTC)
"RTN","SDMHAD1",199,0)
 W !
"RTN","SDMHAD1",200,0)
 N SDMHTC,MHTC,SDMHTEAM
"RTN","SDMHAD1",201,0)
 S SDMHTC=$$START^SCMCMHTC(SDXDFN) S SDMHTEAM=$P($G(SDMHTC),"^",5),SDMHTC=$P($G(SDMHTC),"^",2)
"RTN","SDMHAD1",202,0)
 I SDMHTC]"" W !,?5,"MHTC:  "_SDMHTC_" ("_SDMHTEAM_$S(SDMHTEAM["TEAM":"",1:" TEAM")_")" D RET
"RTN","SDMHAD1",203,0)
 Q
"RTN","SDMHAD1",204,0)
 ;
"RTN","SDMHAD1",205,0)
 ;
"RTN","SDMHAD1",206,0)
FUT ; FUTURE SCHEDULED APPTS.
"RTN","SDMHAD1",207,0)
 W !,?5,"Future Scheduled Appointments:  "
"RTN","SDMHAD1",208,0)
 N SDARRAY,SDCOUNT,SDX,X1,X2,X
"RTN","SDMHAD1",209,0)
 S X1=DT,X2=$S($D(SDFUTNUM):SDFUTNUM,1:30) D C^%DTC S SDX=X
"RTN","SDMHAD1",210,0)
 S SDARRAY(1)=DT_";"_SDX
"RTN","SDMHAD1",211,0)
 S SDARRAY("SORT")="P"
"RTN","SDMHAD1",212,0)
 S SDARRAY(3)="NT;R"
"RTN","SDMHAD1",213,0)
 S SDARRAY(4)=SDXDFN
"RTN","SDMHAD1",214,0)
 S SDARRAY("FLDS")="1;2;3;4;10;13"
"RTN","SDMHAD1",215,0)
 S SDCOUNT=$$SDAPI^SDAMA301(.SDARRAY)
"RTN","SDMHAD1",216,0)
 I SDCOUNT>0 D  Q:SDUP
"RTN","SDMHAD1",217,0)
 .;Get info on future scheduled appointments and display it
"RTN","SDMHAD1",218,0)
 . N SDFA,SDFNODE,SDFUTDT  ;,SDFUTCNT
"RTN","SDMHAD1",219,0)
 . ;S SDFUTCNT=0  ;List up to 6 future appts. for a patient.
"RTN","SDMHAD1",220,0)
 . S SDFA=0 F  S SDFA=$O(^TMP($J,"SDAMA301",SDXDFN,SDFA)) Q:SDFA=""!(SDUP)  D  Q:SDUP
"RTN","SDMHAD1",221,0)
 .. S SDFUTDT=$$FMTE^XLFDT(SDFA,"5") S SDFNODE=^TMP($J,"SDAMA301",SDXDFN,SDFA) W !,?7,SDFUTDT,?26,$E($P($P(SDFNODE,"^",2),";",2),1,30)  ;S SDFUTCNT=SDFUTCNT+1
"RTN","SDMHAD1",222,0)
 ..D RET Q:SDUP
"RTN","SDMHAD1",223,0)
 .Q
"RTN","SDMHAD1",224,0)
 I SDCOUNT'>0 D  Q:SDUP
"RTN","SDMHAD1",225,0)
 .W "NO APPOINTMENTS SCHEDULED WITHIN "_SDFUTNUM_$S(SDFUTNUM=1:" DAY",1:" DAYS")
"RTN","SDMHAD1",226,0)
 K ^TMP($J,"SDAMA301")
"RTN","SDMHAD1",227,0)
 Q
"RTN","SDMHAD1",228,0)
 ;
"RTN","SDMHAD1",229,0)
 ;
"RTN","SDMHAD1",230,0)
RESULTS ;Reminder information
"RTN","SDMHAD1",231,0)
 W !,?5,"Results: "
"RTN","SDMHAD1",232,0)
 K ^TMP("PXRHM",$J),^TMP("PXRM",$J)
"RTN","SDMHAD1",233,0)
 N SDCR
"RTN","SDMHAD1",234,0)
 ;S SDCR=$O(^PXD(811.9,"B","VA-MH HIGH RISK NO-SHOW FOLLOW-UP",0))
"RTN","SDMHAD1",235,0)
 S SDCR=$O(^PXD(811.9,"B","VA-MH HIGH RISK NO-SHOW ADHOC RPT",0))
"RTN","SDMHAD1",236,0)
 ;    N DEFARR,FIEVAL
"RTN","SDMHAD1",237,0)
 ;    Load the definition into DEFARR.
"RTN","SDMHAD1",238,0)
 ;    D DEF^PXRMLDR(SDCR,.DEFARR)
"RTN","SDMHAD1",239,0)
 ;    D EVAL^PXRM(SDXDFN,.DEFARR,5,0,.FIEVAL,$P(SDXNODE,"^",2))
"RTN","SDMHAD1",240,0)
 D MAINDF^PXRM(SDXDFN,SDCR,5,$P(SDXNODE,"^",2))
"RTN","SDMHAD1",241,0)
 N SDTXT,SDTXTR,SDRNODE
"RTN","SDMHAD1",242,0)
 S (SDTXT,SDTXTR)=0
"RTN","SDMHAD1",243,0)
 F SDTXT=0:0 S SDTXT=$O(^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT)) Q:'SDTXT!(SDTXTR)  S SDRNODE=$G(^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT)) I SDRNODE["Resolution:"!(SDRNODE["Information:") D
"RTN","SDMHAD1",244,0)
 .;N SDTNODE
"RTN","SDMHAD1",245,0)
 .W !,?5,^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT) D RET Q:SDUP  D
"RTN","SDMHAD1",246,0)
 ..F SDTXT=SDTXT:0 S SDTXT=$O(^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT)) Q:'SDTXT  I $D(^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT)) D
"RTN","SDMHAD1",247,0)
 ...W !,?5,^TMP("PXRHM",$J,SDCR,"High Risk MH No-Show Adhoc Rpt","TXT",SDTXT)
"RTN","SDMHAD1",248,0)
 ...D RET Q:SDUP  Q
"RTN","SDMHAD1",249,0)
 ..S SDTXTR=1
"RTN","SDMHAD1",250,0)
 ..;K ^TMP("PXRHM",$J),^TMP("PXRM",$J) Q
"RTN","SDMHAD1",251,0)
 D RET Q:SDUP
"RTN","SDMHAD1",252,0)
 K ^TMP("PXRHM",$J),^TMP("PXRM",$J)
"RTN","SDMHAD1",253,0)
 Q
"RTN","SDMHAD1",254,0)
 ;
"RTN","SDMHAD1",255,0)
 ;
"RTN","SDMHAD1",256,0)
PID(DFN) ; Return PID
"RTN","SDMHAD1",257,0)
 ; INPUT  - DFN
"RTN","SDMHAD1",258,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHAD1",259,0)
 N VA
"RTN","SDMHAD1",260,0)
 D PID^VADPT6
"RTN","SDMHAD1",261,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHAD1",262,0)
 ;
"RTN","SDMHAD1",263,0)
 ;
"RTN","SDMHAD1",264,0)
RET ;
"RTN","SDMHAD1",265,0)
 I $E(IOST,1,2)="C-",($Y+6)>IOSL D  Q:SDUP
"RTN","SDMHAD1",266,0)
 . S DIR(0)="E"
"RTN","SDMHAD1",267,0)
 . D ^DIR K DIR
"RTN","SDMHAD1",268,0)
 . I 'Y S SDUP=1 Q
"RTN","SDMHAD1",269,0)
 . K SDXFLG(SDXDIV)
"RTN","SDMHAD1",270,0)
 . D HEAD^SDMHAD S SDXFLG(SDXDIV)=1,SDXFLG(SDXDIV,SDXCLIN)=1,SDXFLG(SDXDIV,SDXSTOP)=1
"RTN","SDMHAP")
0^1^B89393379
"RTN","SDMHAP",1,0)
SDMHAP ;MAF/ALB - MENTAL HEALTH AD HOC PROACTIVE HIGH RISK REPORT;JULY 14, 2010
"RTN","SDMHAP",2,0)
 ;;5.3;Scheduling;**588**;Aug 13,1993;Build 53
"RTN","SDMHAP",3,0)
 ;
"RTN","SDMHAP",4,0)
EN ;entry point for the manual generation of the Proactive Report
"RTN","SDMHAP",5,0)
 N SDBEG,SDEND,VAUTD,Y,SDUP,SDXFLG,SDTL,SDALL,SDDAT,Y,X,SDDAT,VADAT,ZTRTN,ZTSAVE,VADATE,%ZIS,%
"RTN","SDMHAP",6,0)
 I '$$RANGE G QUIT
"RTN","SDMHAP",7,0)
 I '$$DIV G QUIT
"RTN","SDMHAP",8,0)
SORT ;sort is by clinic
"RTN","SDMHAP",9,0)
 S SDTL="CLIN"
"RTN","SDMHAP",10,0)
 D @(SDTL) G:Y=-1 QUIT
"RTN","SDMHAP",11,0)
 W !!,*7,"This output requires 80 column output",!
"RTN","SDMHAP",12,0)
 D NOW^%DTC S Y=$E(%,1,12) S SDDAT=$$FMTE^XLFDT(Y,"5")
"RTN","SDMHAP",13,0)
 S IOM=80 S %ZIS="QM",%ZIS("A")="Select Device: ",%ZIS("B")="" D ^%ZIS G:POP QUIT I $D(IO("Q")) S ZTRTN="START^SDMHAP",ZTSAVE("SD*")="",ZTSAVE("VA*")="" D ^%ZTLOAD K IO("Q"),ZTSK Q
"RTN","SDMHAP",14,0)
 ;
"RTN","SDMHAP",15,0)
START ;
"RTN","SDMHAP",16,0)
 I $E(IOST)="C" D WAIT^DICD I $D(SDXFLG) D
"RTN","SDMHAP",17,0)
 .W !!,?10,"This report option generates a mail message containing the"
"RTN","SDMHAP",18,0)
 .W !,?10,"High Risk Mental Health Proactive Nightly Report which is sent only"
"RTN","SDMHAP",19,0)
 .W !,?10,"to individuals in the SD MH NO SHOW NOTIFICATION mailgroup.",!
"RTN","SDMHAP",20,0)
 N SDDIV,SDPAG,SDCL,SDSC,SDRLL,SDPAG,NAMSPC,NAMSPC1,SDSTOP,VAUTRR,SDLINE,Y,TOTAL,SDPAT
"RTN","SDMHAP",21,0)
 N X S X="DGPFAPIH" X ^%ZOSF("TEST") S X="" I '$T D  Q
"RTN","SDMHAP",22,0)
 .I '$D(SDXFLG) W !!,"Patch DG*5.3*836 needs to be installed - ICR 4903.",!,"Routines required to run report. Aborting!",! Q
"RTN","SDMHAP",23,0)
 .N SDX S SDX=""
"RTN","SDMHAP",24,0)
 .S SDX=$$SETSTR^SDMHPRO1("Patch DG*5.3*836 needs to be installed - ICR 4903.",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHAP",25,0)
 .S SDX="" S SDX=$$SETSTR^SDMHPRO1("Routines required to run report. Report Aborted!",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHAP",26,0)
 .S SDX=""
"RTN","SDMHAP",27,0)
 S Y=0 D LIST Q:Y=1
"RTN","SDMHAP",28,0)
 S NAMSPC=$$NAMSPC
"RTN","SDMHAP",29,0)
 S NAMSPC1=$$NAMSPC1
"RTN","SDMHAP",30,0)
 K ^TMP(NAMSPC),^TMP(NAMSPC1)
"RTN","SDMHAP",31,0)
 S (SDPAG,SDCL,SDSC,SDRLL)=0
"RTN","SDMHAP",32,0)
 I $D(SDXFLG),SDXFLG=1 S VAUTCL=1
"RTN","SDMHAP",33,0)
 ;I $D(SDXFLG) D PXRMD
"RTN","SDMHAP",34,0)
 I $D(SDALL) I SDALL="M" D PXRMD
"RTN","SDMHAP",35,0)
 I VAUTD=1 D
"RTN","SDMHAP",36,0)
 .S SDDIV=0 F SDDIV=0:0 S SDDIV=$O(^DG(40.8,SDDIV)) Q:'SDDIV  I $D(^DG(40.8,SDDIV,0)) S VAUTD(SDDIV)=$P(^DG(40.8,SDDIV,0),"^",1)
"RTN","SDMHAP",37,0)
 I SDTL'="MEN" F SDCL=0:0 S SDCL=$O(^SC(SDCL)) Q:'SDCL  I $D(^SC(SDCL,0)),$P($G(^SC(SDCL,0)),"^",3)="C" D
"RTN","SDMHAP",38,0)
 .S SDSC=$P($G(^SC(SDCL,0)),"^",7),SDDIV=$S('$P($G(^SC(SDCL,0)),"^",15):"NOT SPECIFIED",1:$P($G(^SC(SDCL,0)),"^",15)) I SDSC D CHK  ;S ^TMP("SDCLST",$J,SDCL,SDSC)=$P(^SC(SDCL,0),"^",1)
"RTN","SDMHAP",39,0)
 I SDTL="MEN" S SDRLL=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",0)) D
"RTN","SDMHAP",40,0)
 .F SDDIV=0:0 S SDDIV=$O(VAUTRR(SDDIV)) Q:'SDDIV  F SDSC=0:0 S SDSC=$O(VAUTRR(SDDIV,SDSC)) Q:'SDSC  F SDCL=0:0 S SDCL=$O(VAUTRR(SDDIV,SDSC,SDCL)) Q:'SDCL  I SDCL D CHK
"RTN","SDMHAP",41,0)
 S SDLINE=$S($D(^TMP(NAMSPC,$J)):"PROCESS",1:"END")
"RTN","SDMHAP",42,0)
 D @SDLINE
"RTN","SDMHAP",43,0)
 G QUIT
"RTN","SDMHAP",44,0)
 ;
"RTN","SDMHAP",45,0)
 ;
"RTN","SDMHAP",46,0)
PROCESS ;find patients in date range that have scheduled appt for a clinic in the date range.
"RTN","SDMHAP",47,0)
 N SDIV,SDC,SDR,SDS,SDHFL,SDUP,SDMHFLG,SDMHNFLG,SDACT
"RTN","SDMHAP",48,0)
 S (SDIV,SDC,SDR,SDS,SDUP)=0
"RTN","SDMHAP",49,0)
 S SDMHFLG=$$GET^XPAR("PKG.REGISTRATION","DGPF SUICIDE FLAG",1,"E")
"RTN","SDMHAP",50,0)
 S SDMHFLG("L")=$$GETFLAG^DGPFAPIU(SDMHFLG,"L")
"RTN","SDMHAP",51,0)
 S SDMHNFLG="HIGH RISK FOR SUICIDE"
"RTN","SDMHAP",52,0)
 S SDMHFLG("N")=$$GETFLAG^DGPFAPIU(SDMHNFLG,"N")
"RTN","SDMHAP",53,0)
 F SDIV=0:0 S SDIV=$O(^TMP(NAMSPC,$J,SDIV)) Q:SDIV=""!(SDUP)  F SDC=SDC:0 S SDC=$O(^TMP(NAMSPC,$J,SDIV,SDC)) Q:SDC=""!(SDUP)  F SDS=SDS:0 S SDS=$O(^TMP(NAMSPC,$J,SDIV,SDC,SDS)) Q:SDS=""!(SDUP)  D
"RTN","SDMHAP",54,0)
 .I SDTL="MEN" S SDR=$P($G(^TMP(NAMSPC,$J,SDIV,SDC,SDS)),"^",4)
"RTN","SDMHAP",55,0)
 .N SDDT,SDNUM,SDNUM1,DFN,SDSTAT,ACT,SDRR
"RTN","SDMHAP",56,0)
 .S (SDDT,SDNUM,SDNUM1,DFN,SDSTAT)=0
"RTN","SDMHAP",57,0)
 .F SDDT=SDBEG:0 S SDDT=$O(^SC(SDC,"S",SDDT)) Q:'SDDT!(SDDT>SDEND)!(SDUP)  F SDNUM=0:0 S SDNUM=$O(^SC(SDC,"S",SDDT,SDNUM)) Q:'SDNUM!(SDUP)  F SDNUM1=0:0 S SDNUM1=$O(^SC(SDC,"S",SDDT,SDNUM,SDNUM1)) Q:'SDNUM1!(SDUP)  D
"RTN","SDMHAP",58,0)
 ..Q:'$D(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,0))
"RTN","SDMHAP",59,0)
 ..S DFN=$P($G(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,0)),"^",1) Q:'DFN  Q:$D(^SC(SDC,"S",SDDT,SDNUM,SDNUM1,"C"))
"RTN","SDMHAP",60,0)
 ..;I $D(^DPT(DFN,0)),$D(^DPT(DFN,"S",SDDT)) S SDSTAT=$P($G(^DPT(DFN,"S",SDDT,0)),"^",2) I $$GETINF^DGPFAPIH(DFN,SDMHFLG("L"),SDDT,SDDT,"ACT")!($$GETINF^DGPFAPIH(DFN,SDMHFLG("N"),SDDT,SDDT,"ACT")) D  Q:SDUP
"RTN","SDMHAP",61,0)
 ..I $D(^DPT(DFN,0)),$D(^DPT(DFN,"S",SDDT)) S SDSTAT=$P($G(^DPT(DFN,"S",SDDT,0)),"^",2) Q:SDSTAT="N"!(SDSTAT="NA")  D ACT I SDACT D  Q:SDUP
"RTN","SDMHAP",62,0)
 ...N PATNM,SDCLNM,SDDIVNM,SDSCNM,SDZERO
"RTN","SDMHAP",63,0)
 ...S SDDIVNM=$S($P(^DG(40.8,SDIV,0),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DG(40.8,SDIV,0),"^",1))
"RTN","SDMHAP",64,0)
 ...S SDCLNM=$S($P($G(^SC(SDC,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^SC(SDC,0),"^",1))
"RTN","SDMHAP",65,0)
 ...S SDSCNM=$S($P($G(^DIC(40.7,SDS,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DIC(40.7,SDS,0),"^",1))
"RTN","SDMHAP",66,0)
 ...S PATNM=$S($P($G(^DPT(DFN,0)),"^",1)="NOT SPECIFIED":"NOT SPECIFIED",1:$P(^DPT(DFN,0),"^",1))
"RTN","SDMHAP",67,0)
 ...I SDTL="CLIN" S ^TMP(NAMSPC1,$J,SDDIVNM,PATNM,SDDT,SDCLNM,SDS)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS ;D TOTAL(SDDIVNM,SDCLNM)
"RTN","SDMHAP",68,0)
 ...I SDTL="STOP" S ^TMP(NAMSPC1,$J,SDDIVNM,SDSCNM,PATNM,SDCLNM,SDDT)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS
"RTN","SDMHAP",69,0)
 ...I SDTL="MEN" S SDRR=$P(^PXRMD(810.9,SDR,0),"^",1) S ^TMP(NAMSPC1,$J,SDDIVNM,SDRR,SDCLNM,PATNM,SDDT)=DFN_"^"_SDDT_"^"_SDSTAT_"^"_$E(PATNM,1)_$$PID(DFN)_"^"_SDC_"^"_SDS
"RTN","SDMHAP",70,0)
 ...D TOTAL(SDDIVNM)
"RTN","SDMHAP",71,0)
BGJ I $D(SDXFLG) D  Q
"RTN","SDMHAP",72,0)
 .I '$D(^TMP(NAMSPC1,$J)) D HEAD^SDMHPRO
"RTN","SDMHAP",73,0)
 .D ^SDMHPRO1 Q
"RTN","SDMHAP",74,0)
 I '$D(^TMP(NAMSPC1,$J)) G END
"RTN","SDMHAP",75,0)
 D ^SDMHAP1
"RTN","SDMHAP",76,0)
 Q
"RTN","SDMHAP",77,0)
CHK ;Check to see if Division/Clinic/Stop have been selected & if  Clinic and Stop code are a valid mental health pair.
"RTN","SDMHAP",78,0)
 N SDFLG,SDCLNM,SDDIVNM,SDSCNM
"RTN","SDMHAP",79,0)
 S SDFLG=0
"RTN","SDMHAP",80,0)
 I $D(VAUTD) D  Q:SDFLG
"RTN","SDMHAP",81,0)
 . I SDDIV="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAP",82,0)
 . I 'VAUTD,'$D(VAUTD(SDDIV)) S SDFLG=1 Q
"RTN","SDMHAP",83,0)
 I $D(VAUTCL) D  Q:SDFLG
"RTN","SDMHAP",84,0)
 . I SDCL="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAP",85,0)
 . I 'VAUTCL,'$D(VAUTCL(SDCL)) S SDFLG=1 Q
"RTN","SDMHAP",86,0)
 I $D(VAUTSC) D  Q:SDFLG
"RTN","SDMHAP",87,0)
 . I SDSC="NOT SPECIFIED" S SDFLG=1 Q
"RTN","SDMHAP",88,0)
 . I 'VAUTSC,'$D(VAUTSC(SDSC)) S SDFLG=1 Q
"RTN","SDMHAP",89,0)
 Q:'$D(^DG(40.8,SDDIV,0))
"RTN","SDMHAP",90,0)
 S SDDIVNM=$S($P($G(^DG(40.8,SDDIV,0)),"^",1)="":"NOT SPECIFIED",1:$P(^DG(40.8,SDDIV,0),"^",1))
"RTN","SDMHAP",91,0)
 Q:'$D(^SC(SDCL,0))
"RTN","SDMHAP",92,0)
 S SDCLNM=$S($P($G(^SC(SDCL,0)),"^",1)="":"NOT SPECIFIED",1:$P(^SC(SDCL,0),"^",1))
"RTN","SDMHAP",93,0)
 Q:'$D(^DIC(40.7,SDSC,0))
"RTN","SDMHAP",94,0)
 S SDSCNM=$S($P($G(^DIC(40.7,SDSC,0)),"^",1)="":"NOT SPECIFIED",1:$P(^DIC(40.7,SDSC,0),"^",1))
"RTN","SDMHAP",95,0)
 S ^TMP(NAMSPC,$J,SDDIV,SDCL,SDSC)=SDDIVNM_"^"_SDCLNM_"^"_SDSCNM_"^"_$S(SDRLL="NOT SPECIFIED":"NOT SPECIFIED",1:SDRLL)
"RTN","SDMHAP",96,0)
 Q
"RTN","SDMHAP",97,0)
 ;
"RTN","SDMHAP",98,0)
ACT ;Make sure patient has active patient record flag
"RTN","SDMHAP",99,0)
 N SDDTNT
"RTN","SDMHAP",100,0)
 S SDDTNT=$P(SDDT,".",1)
"RTN","SDMHAP",101,0)
 I $$GETINF^DGPFAPIH(DFN,SDMHFLG("L"),SDDTNT,SDDTNT,"ACT") S SDACT=1 Q
"RTN","SDMHAP",102,0)
 I $$GETINF^DGPFAPIH(DFN,SDMHFLG("N"),SDDTNT,SDDTNT,"ACT") S SDACT=1 Q  ;For increment 3
"RTN","SDMHAP",103,0)
 S SDACT=0
"RTN","SDMHAP",104,0)
 Q
"RTN","SDMHAP",105,0)
HEAD ;Heading for the report
"RTN","SDMHAP",106,0)
 W @IOF
"RTN","SDMHAP",107,0)
 W "HIGH RISK MENTAL HEALTH PROACTIVE ADHOC REPORT BY",?70,"PAGE " S SDPAG=SDPAG+1 W SDPAG,!
"RTN","SDMHAP",108,0)
 W $S(SDTL="MEN":"MENTAL HEALTH",SDTL="STOP":"STOP CODE",1:"CLINIC")_" for Appointments "_$$FMTE^XLFDT(SDBEG,"2")_"-"_$$FMTE^XLFDT($P(SDEND,".",1),"2"),?56,"Run: "_SDDAT
"RTN","SDMHAP",109,0)
 I $D(SDTOTPG) W !!,"Totals Page"
"RTN","SDMHAP",110,0)
 I '$D(SDTOTPG) W !!,"#",?4,"PATIENT",?25,"PT ID",?32,"APPT D/T",?49,"CLINIC"
"RTN","SDMHAP",111,0)
 W !,$$LINE(""),!
"RTN","SDMHAP",112,0)
HEAD1 I $D(^TMP(NAMSPC1,$J)),'$D(SDTOTPG) D
"RTN","SDMHAP",113,0)
 . N SDHEAD2
"RTN","SDMHAP",114,0)
 .I SDTL'="STOP" S SDHEAD2="DIVISION: "_$E(SDXDIV,1,30)
"RTN","SDMHAP",115,0)
 .W SDHEAD2,!
"RTN","SDMHAP",116,0)
 Q
"RTN","SDMHAP",117,0)
 ;
"RTN","SDMHAP",118,0)
 ;
"RTN","SDMHAP",119,0)
RANGE() ;Select Start and End date for report
"RTN","SDMHAP",120,0)
 W !!,$$LINE(" High Risk Mental Health Proactive Adhoc Report")
"RTN","SDMHAP",121,0)
 Q $$RANGE1(.SDBEG,.SDEND)
"RTN","SDMHAP",122,0)
 ;
"RTN","SDMHAP",123,0)
DIV() ;Division selection for multidivisional facility
"RTN","SDMHAP",124,0)
 D ASK2^SDDIV I Y<0 K VAUTD
"RTN","SDMHAP",125,0)
 Q $D(VAUTD)>0
"RTN","SDMHAP",126,0)
 ;
"RTN","SDMHAP",127,0)
LIST N X I '$D(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL")) D  Q
"RTN","SDMHAP",128,0)
 .I '$D(SDXFLG) W !!!,"Reminder location List file is not current.",!,"Missing reminder location list 'VA-MH NO SHOW APPT CLINICS LL' in file 810.9.",!,"Report Aborting!",! S Y=1 Q
"RTN","SDMHAP",129,0)
 .N SDX S SDX="",X=""
"RTN","SDMHAP",130,0)
 .S SDX=$$SETSTR^SDMHPRO1("Reminder location List file is not current.",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHAP",131,0)
 .S SDX="",X="" S SDX=$$SETSTR^SDMHPRO1("Missing reminder location list 'VA-MH NO SHOW APPT CLINICS LL' in file 810.9.",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHAP",132,0)
 .S SDX="",X="" S SDX=$$SETSTR^SDMHPRO1("Report Aborted!",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHAP",133,0)
 .S SDX=""
"RTN","SDMHAP",134,0)
 .S Y=1
"RTN","SDMHAP",135,0)
LINE(STR) ; Print display prompts
"RTN","SDMHAP",136,0)
 N X
"RTN","SDMHAP",137,0)
 S:STR]"" STR=" "_STR_" "
"RTN","SDMHAP",138,0)
 S $P(X,"*",(IOM/2)-($L(STR)/2))=""
"RTN","SDMHAP",139,0)
 Q X_STR_X
"RTN","SDMHAP",140,0)
 ;
"RTN","SDMHAP",141,0)
LINE1(STR) ; Print display prompts
"RTN","SDMHAP",142,0)
 N X
"RTN","SDMHAP",143,0)
 S:STR]"" STR=" "_STR_" "
"RTN","SDMHAP",144,0)
 S $P(X," ",(IOM/2)-($L(STR)/2))=""
"RTN","SDMHAP",145,0)
 Q X_STR_X
"RTN","SDMHAP",146,0)
 ;
"RTN","SDMHAP",147,0)
 ;
"RTN","SDMHAP",148,0)
TOTAL(DIV) ;INITIALIZE total(DIV,CLIN/STOP)
"RTN","SDMHAP",149,0)
 I '$D(TOTAL(DIV)) D
"RTN","SDMHAP",150,0)
 .N SDCNTT S SDCNTT=0
"RTN","SDMHAP",151,0)
 .S TOTAL(DIV)="0^0^0^0^0"
"RTN","SDMHAP",152,0)
 I $D(TOTAL(DIV)) D
"RTN","SDMHAP",153,0)
 .S $P(TOTAL(DIV),"^",1)=$P($G(TOTAL(DIV)),"^",1)+1
"RTN","SDMHAP",154,0)
 .N X S X=$S(SDSTAT="NS":2,SDSTAT="NSA":3,1:4) S $P(TOTAL(DIV),"^",X)=$P(TOTAL(DIV),"^",X)+1
"RTN","SDMHAP",155,0)
 .I '$D(SDPAT(DIV,DFN)) S SDPAT(DIV,DFN)="",$P(TOTAL(DIV),"^",5)=$P(TOTAL(DIV),"^",5)+1
"RTN","SDMHAP",156,0)
 Q
"RTN","SDMHAP",157,0)
 ;
"RTN","SDMHAP",158,0)
 ;
"RTN","SDMHAP",159,0)
CLIN ;select clinics
"RTN","SDMHAP",160,0)
 W !!,"Sort the report by:",!,?20,"A  All clinics",!,?20,"M  Mental Health clinics only",!
"RTN","SDMHAP",161,0)
 R !,"Sort by: (A)ll clinics  A//",X:DTIME S:X["^"!('$T) Y=-1 Q:Y=-1  S X=$S(X="":"A",1:$E(X)) I "AMam"'[X W !,"Enter a 'A' for All clinics or 'M' for Mental Health clinics only" G CLIN
"RTN","SDMHAP",162,0)
 S SDALL=X
"RTN","SDMHAP",163,0)
 N DIC,K,VAUTVB,VAUTSTR,VAUTNI
"RTN","SDMHAP",164,0)
 S VAUTVB="VAUTCL",DIC="^SC("
"RTN","SDMHAP",165,0)
 I SDALL="M" S DIC("S")="N X,K S X=$O(^PXRMD(810.9,""B"",""VA-MH NO SHOW APPT CLINICS LL"",0)) I $D(^SC(+Y,0)) S K=$P(^SC(+Y,0),""^"",7) I $D(^PXRMD(810.9,X,40.7,""B"",+K))"
"RTN","SDMHAP",166,0)
 S VAUTSTR="Clinic",VAUTNI=2 D FIRST^VAUTOMA S:Y=-1 SDFL=1 Q:$D(SDFL)
"RTN","SDMHAP",167,0)
 Q
"RTN","SDMHAP",168,0)
 ;
"RTN","SDMHAP",169,0)
PID(DFN) ; Return PID
"RTN","SDMHAP",170,0)
 ; INPUT  - DFN
"RTN","SDMHAP",171,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHAP",172,0)
 N VA
"RTN","SDMHAP",173,0)
 D PID^VADPT6
"RTN","SDMHAP",174,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHAP",175,0)
 ;
"RTN","SDMHAP",176,0)
RANGE1(SDBEG,SDEND,SDAMETH) ; -- select range
"RTN","SDMHAP",177,0)
 N SDWITCH,SDT,X1,X2,X
"RTN","SDMHAP",178,0)
 S (SDBEG,SDEND)=0,SDT=DT
"RTN","SDMHAP",179,0)
 I $G(SDAMETH)>0 S X1=DT,X2=-1 D C^%DTC S SDT=X
"RTN","SDMHAP",180,0)
 S DIR("B")=$$FDATE^VALM1(SDT),SDWITCH=$$SWITCH^SDAMU
"RTN","SDMHAP",181,0)
 S DIR("?",1)="Dates in the past (after "_$$FDATE^VALM1(SDWITCH)_" ) and into the  future can be entered",DIR("?")=" "
"RTN","SDMHAP",182,0)
 S DIR(0)="DA",DIR("A")="Select Beginning Date: "
"RTN","SDMHAP",183,0)
 W ! D ^DIR K DIR G RANGEQ:Y'>0 S SDBEG=Y
"RTN","SDMHAP",184,0)
 S DIR("B")=$$FDATE^VALM1(SDT)
"RTN","SDMHAP",185,0)
 S DIR(0)="DA",DIR("A")="Select    Ending Date: "
"RTN","SDMHAP",186,0)
 S DIR("?",1)="Dates between "_$$FDATE^VALM1(SDBEG)_"and into the future can be entered. ",DIR("?")=" "
"RTN","SDMHAP",187,0)
 D ^DIR K DIR G RANGEQ:Y'>0 S SDEND=Y_".24"
"RTN","SDMHAP",188,0)
RANGEQ Q SDEND
"RTN","SDMHAP",189,0)
 ;
"RTN","SDMHAP",190,0)
NAMSPC() ; API returns the name space for this patch
"RTN","SDMHAP",191,0)
 Q "SDPRO"
"RTN","SDMHAP",192,0)
NAMSPC1() ; API returns the name space for this patch
"RTN","SDMHAP",193,0)
 Q "SDPRO1"
"RTN","SDMHAP",194,0)
PXRMD ;Set up Reminder Location List valid Stop Codes for Proactive Report
"RTN","SDMHAP",195,0)
 N SDX,SDY,SDI,SDSFL,SDCFL
"RTN","SDMHAP",196,0)
 S SDY=0
"RTN","SDMHAP",197,0)
 S SDX=$O(^PXRMD(810.9,"B","VA-MH NO SHOW APPT CLINICS LL",0)) Q:SDX']""  F  S SDY=$O(^PXRMD(810.9,SDX,40.7,"B",SDY)) Q:SDY']""  D
"RTN","SDMHAP",198,0)
 .S SDSTOP(+SDY)=""
"RTN","SDMHAP",199,0)
 .I SDTL="MEN" N SDI S SDI=0 F  S SDI=$O(^SC("AST",+SDY,SDI)) Q:SDI']""  S VAUTRR(+$P($G(^SC(+SDI,0)),"^",15),+SDY,+SDI)=""
"RTN","SDMHAP",200,0)
 .I $D(VAUTSC),$G(VAUTSC)=1 S VAUTSC(+SDY)=$P($G(^DIC(40.7,+SDY,0)),"^",1) S SDSFL=1
"RTN","SDMHAP",201,0)
 .I $D(VAUTCL),$G(VAUTCL)=1 N SDI S SDI=0 F  S SDI=$O(^SC("AST",+SDY,SDI)) Q:SDI']""  D 
"RTN","SDMHAP",202,0)
 ..S VAUTCL(+SDI)=$P($G(^SC(+SDI,0)),"^",1) S SDCFL=1
"RTN","SDMHAP",203,0)
 I $D(SDSFL) S VAUTSC=0
"RTN","SDMHAP",204,0)
 I $D(SDCFL) S VAUTCL=0
"RTN","SDMHAP",205,0)
 Q
"RTN","SDMHAP",206,0)
END ;NO RECORDS
"RTN","SDMHAP",207,0)
 D HEAD
"RTN","SDMHAP",208,0)
 W !!,$$LINE1(">>>>>>  NO RECORDS FOUND <<<<<<")
"RTN","SDMHAP",209,0)
QUIT K %DT,DIR,SDTBEG,SDTEND,SDDIV,SDFL,SDTOTPG,SDXDIV,SDMHNFLG,VAUTD,VAUTCL,VAUTR,VAUTSC,VADAT,VADATE,POP,X,Y
"RTN","SDMHAP",210,0)
 K ^TMP("SDPRO",$J),^TMP("SDPRO1",$J)
"RTN","SDMHAP",211,0)
 D CLOSE^DGUTQ Q
"RTN","SDMHAP1")
0^2^B16336515
"RTN","SDMHAP1",1,0)
SDMHAP1 ;MAF/ALB - MENTAL HEALTH AD HOC PROACTIVE HIGH RISK REPORT (CONT.;JULY 14, 2010
"RTN","SDMHAP1",2,0)
 ;;5.3;Scheduling;**588**;Aug 13,1993;Build 53
"RTN","SDMHAP1",3,0)
 ;
"RTN","SDMHAP1",4,0)
SET ; Set up the data for the patient
"RTN","SDMHAP1",5,0)
 ;       piece 1 = dfn
"RTN","SDMHAP1",6,0)
 ;       piece 2 = Appointment Date and time
"RTN","SDMHAP1",7,0)
 ;       piece 3 = status N(Noshow) or NA (Noshow with auto rebook)
"RTN","SDMHAP1",8,0)
 ;       piece 4 = PID last 4 of SSN
"RTN","SDMHAP1",9,0)
 ;       piece 5 = clinic ien   ^SC(
"RTN","SDMHAP1",10,0)
 ;       piece 6 = stop code ien ^DIC(40.7
"RTN","SDMHAP1",11,0)
 ;   
"RTN","SDMHAP1",12,0)
 ;
"RTN","SDMHAP1",13,0)
EN ;PRINT OF THE ^TMP 
"RTN","SDMHAP1",14,0)
 N SDXDIV,SDXCLIN,SDXDFN,SDXSTOP,SDXREM,SDXNM,SDCOUNT,SDATE,SDTOTPG,Y
"RTN","SDMHAP1",15,0)
 S (SDXDFN,SDXREM,SDCOUNT)=0
"RTN","SDMHAP1",16,0)
 N SDPAT
"RTN","SDMHAP1",17,0)
 S SDXDIV=""
"RTN","SDMHAP1",18,0)
 F  S SDXDIV=$O(^TMP(NAMSPC1,$J,SDXDIV)) Q:SDXDIV']""!(SDUP)  D
"RTN","SDMHAP1",19,0)
 .I SDTL="CLIN" D
"RTN","SDMHAP1",20,0)
 ..S SDCOUNT=0
"RTN","SDMHAP1",21,0)
 ..S SDXNM=""
"RTN","SDMHAP1",22,0)
 ..F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM)) Q:SDXNM']""!($G(SDUP))  D
"RTN","SDMHAP1",23,0)
 ...S SDATE=0
"RTN","SDMHAP1",24,0)
 ...F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE)) Q:'SDATE!($G(SDUP))  D
"RTN","SDMHAP1",25,0)
 ....S SDXCLIN=""
"RTN","SDMHAP1",26,0)
 ....F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN)) Q:SDXCLIN']""!($G(SDUP))  D
"RTN","SDMHAP1",27,0)
 .....S SDXSTOP=0
"RTN","SDMHAP1",28,0)
 .....F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN,SDXSTOP)) Q:'SDXSTOP!($G(SDUP))  D
"RTN","SDMHAP1",29,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN,SDXSTOP)) D PRT
"RTN","SDMHAP1",30,0)
 Q:SDUP
"RTN","SDMHAP1",31,0)
 I $D(^TMP(NAMSPC1,$J)) S SDTOTPG=1 D HEAD^SDMHAP D TOTAL1^SDMHPRO
"RTN","SDMHAP1",32,0)
 Q
"RTN","SDMHAP1",33,0)
 ;
"RTN","SDMHAP1",34,0)
 ;
"RTN","SDMHAP1",35,0)
PRT ;Print  report
"RTN","SDMHAP1",36,0)
 ;
"RTN","SDMHAP1",37,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD^SDMHAP S SDXFLG(SDXDIV)=1 S:SDTL'="STOP" SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHAP1",38,0)
 ;I SDTL="STOP" I $D(SDXFLG(SDXDIV)),'$D(SDXFLG(SDXDIV,SDXSTOP,SDXSTOPN)) W !! D HEAD1^SDMHAP S SDXFLG(SDXDIV,SDXSTOP,SDXSTOPN)=1
"RTN","SDMHAP1",39,0)
 N SDXNODE,SDXID,SDXDT,SDXSTAT,SDXSORT1,SDXSORT2,SDXCLIEN,SDDSS,SDXRLL,SDXZERO
"RTN","SDMHAP1",40,0)
 S SDXSORT1=$S(SDTL="MEN":SDXREM,SDTL="STOP":SDXSTOP,1:SDXCLIN)
"RTN","SDMHAP1",41,0)
 S SDXSORT2=$S(SDTL="CLIN":SDXSTOP,1:SDXCLIN)
"RTN","SDMHAP1",42,0)
 I SDTL="MEN" S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXSORT1,SDXSORT2,SDXNM,SDATE))
"RTN","SDMHAP1",43,0)
 I SDTL'="MEN" S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXSORT1,SDXSORT2))
"RTN","SDMHAP1",44,0)
 S SDXDFN=$P(SDXNODE,"^",1) Q:SDXDFN']""
"RTN","SDMHAP1",45,0)
 S SDXID=$E($P(SDXNODE,"^",4),1,5)
"RTN","SDMHAP1",46,0)
 S SDXDT=$P(SDXNODE,"^",2)
"RTN","SDMHAP1",47,0)
 S SDXSTAT=$P(SDXNODE,"^",3)
"RTN","SDMHAP1",48,0)
 S SDXCLIEN=$P(SDXNODE,"^",5)
"RTN","SDMHAP1",49,0)
 S SDDSS=$P($G(^DIC(40.7,+$P(SDXNODE,"^",6),0)),"^",2)
"RTN","SDMHAP1",50,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD^SDMHAP S SDXFLG(SDXDIV)=1
"RTN","SDMHAP1",51,0)
 S SDXDT=$$FMTE^XLFDT(SDXDT,"5")
"RTN","SDMHAP1",52,0)
 I '$D(SDPAT(SDXDIV,SDXDFN)) D COUNT^SDMHPRO W !,SDCOUNT,?4,$E($P(^DPT(SDXDFN,0),"^",1),1,20),?25,SDXID,?32,SDXDT,?49,$E(SDXCLIN,1,30),! D RET Q:SDUP  I SDCOUNT=$P($G(TOTAL(SDXDIV)),"^",5) S SDCOUNT=0
"RTN","SDMHAP1",53,0)
 I $D(SDPAT(SDXDIV,SDXDFN)) W ?32,SDXDT,?49,$E(SDXCLIN,1,30),! D RET Q:SDUP  I SDCOUNT=$P($G(TOTAL(SDXDIV)),"^",5) S SDCOUNT=0
"RTN","SDMHAP1",54,0)
 S SDPAT(SDXDIV,SDXDFN)=""
"RTN","SDMHAP1",55,0)
 Q
"RTN","SDMHAP1",56,0)
 ;
"RTN","SDMHAP1",57,0)
 ;
"RTN","SDMHAP1",58,0)
FUT ; FUTURE SCHEDULED APPTS.
"RTN","SDMHAP1",59,0)
 ;W !,?5,"Future Scheduled Appointments:  "
"RTN","SDMHAP1",60,0)
 N SDARRAY,SDCOUNT,SDX,X1,X2,X
"RTN","SDMHAP1",61,0)
 S X1=DT,X2=30 D C^%DTC S SDX=X
"RTN","SDMHAP1",62,0)
 S SDARRAY(1)=DT_";"_SDX
"RTN","SDMHAP1",63,0)
 S SDARRAY("SORT")="P"
"RTN","SDMHAP1",64,0)
 S SDARRAY(3)="NT;R"
"RTN","SDMHAP1",65,0)
 S SDARRAY(4)=SDXDFN
"RTN","SDMHAP1",66,0)
 S SDARRAY("FLDS")="1;2;3;4;10;13"
"RTN","SDMHAP1",67,0)
 S SDCOUNT=$$SDAPI^SDAMA301(.SDARRAY)
"RTN","SDMHAP1",68,0)
 I SDCOUNT>0 D  Q:SDUP
"RTN","SDMHAP1",69,0)
 .;Get info on future scheduled appointments and display it
"RTN","SDMHAP1",70,0)
 . N SDFA,SDFNODE,SDFUTDT
"RTN","SDMHAP1",71,0)
 . S SDFA=0 F  S SDFA=$O(^TMP($J,"SDAMA301",SDXDFN,SDFA)) Q:SDFA=""!(SDUP)!($P($G(SDFA),".",1)<$P(SDBEG,".",1))!($P($G(SDFA),".",1)>$P(SDEND,".",1))  D  Q:SDUP
"RTN","SDMHAP1",72,0)
 .. S SDFUTDT=$$FMTE^XLFDT(SDFA,"5P") S SDFNODE=^TMP($J,"SDAMA301",SDXDFN,SDFA) W !,?7,SDFUTDT,?33,$E($P($P(SDFNODE,"^",2),";",2),1,20)
"RTN","SDMHAP1",73,0)
 ..D RET Q:SDUP
"RTN","SDMHAP1",74,0)
 .Q
"RTN","SDMHAP1",75,0)
 I SDCOUNT'>0 D  Q:SDUP
"RTN","SDMHAP1",76,0)
 .W "NO APPOINTMENTS SCHEDULED WITHIN 30 DAYS"
"RTN","SDMHAP1",77,0)
 K ^TMP($J,"SDAMA301")
"RTN","SDMHAP1",78,0)
 Q
"RTN","SDMHAP1",79,0)
PID(DFN) ; Return PID
"RTN","SDMHAP1",80,0)
 ; INPUT  - DFN
"RTN","SDMHAP1",81,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHAP1",82,0)
 N VA
"RTN","SDMHAP1",83,0)
 D PID^VADPT6
"RTN","SDMHAP1",84,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHAP1",85,0)
 ;
"RTN","SDMHAP1",86,0)
 ;
"RTN","SDMHAP1",87,0)
RET ;
"RTN","SDMHAP1",88,0)
 I $E(IOST,1,2)="C-",($Y+6)>IOSL D  Q:SDUP
"RTN","SDMHAP1",89,0)
 . S DIR(0)="E"
"RTN","SDMHAP1",90,0)
 . D ^DIR K DIR
"RTN","SDMHAP1",91,0)
 . I 'Y S SDUP=1 Q
"RTN","SDMHAP1",92,0)
 . K SDXFLG(SDXDIV)
"RTN","SDMHAP1",93,0)
 . D HEAD^SDMHAP S SDXFLG(SDXDIV)=1    ;,SDXFLG(SDXDIV,SDXCLIN)=1,SDXFLG(SDXDIV,SDXSTOP)=1
"RTN","SDMHNS")
0^8^B22141437
"RTN","SDMHNS",1,0)
SDMHNS ;MAF/ALB - MENTAL HEALTH NO SHOW REPORT (BGJ);SEPTEMBER 9, 2010
"RTN","SDMHNS",2,0)
 ;;5.3;Scheduling;**578,588**;Aug 13,1993;Build 53
"RTN","SDMHNS",3,0)
 ;
"RTN","SDMHNS",4,0)
EN ;entry point for the automatic generation of the No Show Report from BGJ
"RTN","SDMHNS",5,0)
 N SDBEG,SDEND,VAUTD,Y,SDUP,SDXFLG,SDDAT,X1,X2,SDTL,X,VAUTCL,SDPAG,SDX,TOTAL,IOM,SDNSDT,%
"RTN","SDMHNS",6,0)
 K ^TMP("SDNS1",$J)
"RTN","SDMHNS",7,0)
 S SDXFLG=1 ; This flag is set to 1 when it is from the background Job
"RTN","SDMHNS",8,0)
 D NOW^%DTC S Y=$E(%,1,12) S SDDAT=$$FMTE^XLFDT(Y,"5") S X1=Y,X2=-1 D C^%DTC S SDBEG=$P(X,".",1)_".0000",SDEND=$P(X,".",1)_".2359"
"RTN","SDMHNS",9,0)
 S SDNSDT=$$FMTE^XLFDT(X,"2")
"RTN","SDMHNS",10,0)
 S VAUTD=1   ;All the divisions in the facility
"RTN","SDMHNS",11,0)
 S SDTL="CLIN"   ; sort by clinc for the BGJ
"RTN","SDMHNS",12,0)
 S IOM=80
"RTN","SDMHNS",13,0)
 N SDLN
"RTN","SDMHNS",14,0)
 S X="",SDLN=0
"RTN","SDMHNS",15,0)
 D START^SDMHAD
"RTN","SDMHNS",16,0)
 N XMSUB,XMY,XMTEXT,XMDUZ,SDGRP
"RTN","SDMHNS",17,0)
 S SDGRP=$O(^XMB(3.8,"B","SD MH NO SHOW NOTIFICATION",""))
"RTN","SDMHNS",18,0)
 Q:'SDGRP
"RTN","SDMHNS",19,0)
 D XMY^SDUTL2(SDGRP,0,0)
"RTN","SDMHNS",20,0)
 S XMSUB="HRMH NO SHOW NIGHTLY REPORT"_" MESSAGE # "
"RTN","SDMHNS",21,0)
 S XMTEXT="^TMP(""SDNS1"",$J,"
"RTN","SDMHNS",22,0)
 S XMDUZ="POSTMASTER"
"RTN","SDMHNS",23,0)
 D ^XMD
"RTN","SDMHNS",24,0)
 K ^TMP("SDNS1",$J)
"RTN","SDMHNS",25,0)
 Q
"RTN","SDMHNS",26,0)
SET(X) ; SET UP THE STRING
"RTN","SDMHNS",27,0)
 S SDLN=SDLN+1,^TMP("SDNS1",$J,SDLN,0)=X
"RTN","SDMHNS",28,0)
 Q
"RTN","SDMHNS",29,0)
HEAD ;Heading for the report
"RTN","SDMHNS",30,0)
 ;
"RTN","SDMHNS",31,0)
 N SDX
"RTN","SDMHNS",32,0)
 S SDX="",X=""
"RTN","SDMHNS",33,0)
 S SDPAG=SDPAG+1,SDX=$$SETSTR^SDMHNS1("HIGH RISK MENTAL HEALTH NO SHOW NIGHTLY REPORT",X,1,46)_$$SETSTR^SDMHNS1(" PAGE ",X,20,6)_$$SETSTR^SDMHNS1(SDPAG,X,4,4) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",34,0)
 S SDX=$$SETSTR^SDMHNS1("By "_$S(SDTL="MEN":"MH CLINIC LIST",SDTL="STOP":"STOPCODE",1:"CLINIC")_" for Appointments on "_$P(SDNSDT,"@",1),X,1,50)_$$SETSTR^SDMHNS1("Run: "_SDDAT,X,9,30) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",35,0)
 S SDX=$$SETSTR^SDMHNS1("*STATUS: NS = No Show      NSA = No Show Auto Rebook     NAT = No Action Taken",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",36,0)
 S SDX=$$SETSTR^SDMHNS1("#",X,1,2)_$$SETSTR^SDMHNS1("PATIENT",X,4,7)_$$SETSTR^SDMHNS1("PT ID",X,15,5)_$$SETSTR^SDMHNS1("APPT D/T",X,2,17)_$$SETSTR^SDMHNS1("CLINIC/STATUS/PROVIDER",X,1,22) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",37,0)
 S SDX=$$SETSTR^SDMHNS1($$LINE^SDMHAD(""),X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",38,0)
HEAD1 I $D(^TMP(NAMSPC1,$J)),$D(SDXDIV) S SDX=$$SETSTR^SDMHNS1("DIVISION/CLINIC/STOP: "_$E(SDXDIV,1,24)_"/"_$E(SDXCLIN,1,26)_"/"_$E(SDXSTOP,1,6),X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",39,0)
 I '$D(^TMP(NAMSPC1,$J)),'$D(SDXDIV) S SDX=$$SETSTR^SDMHNS1($$LINE1^SDMHAD(">>>>>>>>>>>>> NO RECORDS <<<<<<<<<<<<<"),X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",40,0)
 Q
"RTN","SDMHNS",41,0)
 ;S SDX=$$SETSTR^SDMHNS1("#",X,1,1)_$$SETSTR^SDMHNS1("PATIENT",X,5,7)_$$SETSTR^SDMHNS1("PT ID",X,14,5)_$$SETSTR^SDMHNS1("APPT D/T",X,6,20)_$$SETSTR^SDMHNS1("CLINIC",X,2,15)_$$SETSTR^SDMHNS1("STATUS",X,2,6) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",42,0)
 ;
"RTN","SDMHNS",43,0)
TOTAL ;Prints totals for the clinics by division - FOR BGJ
"RTN","SDMHNS",44,0)
 Q:'$D(TOTAL)
"RTN","SDMHNS",45,0)
 N SDVISN,SDCLNIC,SDFLAG,SDX,X
"RTN","SDMHNS",46,0)
 S (SDVISN,SDCLNIC)=0
"RTN","SDMHNS",47,0)
 S X="",SDX=""
"RTN","SDMHNS",48,0)
 S SDX=$$SETSTR^SDMHNS1("Division/Clinic Appointment Totals",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",49,0)
 S X="",SDX=""
"RTN","SDMHNS",50,0)
 S SDX=$$SETSTR^SDMHNS1("Division/CLinic",X,1,26)_$$SETSTR^SDMHNS1("Unique",X,47,6) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",51,0)
 S X="",SDX="" S SDX=$$SETSTR^SDMHNS1("NS   NSA   NAT  Patients",X,56,24) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",52,0)
 F  S SDVISN=$O(TOTAL(SDVISN)) Q:SDVISN']""  F  S SDCLNIC=$O(TOTAL(SDVISN,SDCLNIC)) Q:SDCLNIC']""  D
"RTN","SDMHNS",53,0)
 . N SDX,X
"RTN","SDMHNS",54,0)
 .I $D(TOTAL(SDVISN,SDCLNIC)) D
"RTN","SDMHNS",55,0)
 ..S SDX="",X=""
"RTN","SDMHNS",56,0)
 ..N SDTOTS
"RTN","SDMHNS",57,0)
 ..S SDTOTS=$J($P(TOTAL(SDVISN,SDCLNIC),"^",2),3)_"   "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",3),3)_"   "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",4),3)_"    "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",5),3)
"RTN","SDMHNS",58,0)
 ..S SDX=$$SETSTR^SDMHNS1($E(SDVISN,1,24)_"/"_$E(SDCLNIC,1,26),X,1,54)_$$SETSTR^SDMHNS1(SDTOTS,X,1,24) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",59,0)
 S X="",SDX="" S SDX=$$SETSTR^SDMHNS1(" ",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",60,0)
 S X="",SDX=""
"RTN","SDMHNS",61,0)
 ;S SDX=$$SETSTR^SDMHNS1("*STATUS: NS = No Show      NSA = No Show Auto Rebook     NAT = No Action Taken",X,1,80) D SET1^SDMHNS1(SDX)
"RTN","SDMHNS",62,0)
 Q
"RTN","SDMHNS",63,0)
TOTAL1 ;TOTALS FOR AD HOC
"RTN","SDMHNS",64,0)
 Q:'$D(TOTAL)
"RTN","SDMHNS",65,0)
 N SDVISN,SDCLNIC,SDFLAG,SDX,X
"RTN","SDMHNS",66,0)
 S (SDVISN,SDCLNIC)=0
"RTN","SDMHNS",67,0)
 W ?25,"Division/Clinic Appointment Totals",!
"RTN","SDMHNS",68,0)
 W "Division/CLinic",?73,"Unique",!
"RTN","SDMHNS",69,0)
 W ?56,"NS   NSA   NAT  Patients",!
"RTN","SDMHNS",70,0)
 F  S SDVISN=$O(TOTAL(SDVISN)) Q:SDVISN']""  F  S SDCLNIC=$O(TOTAL(SDVISN,SDCLNIC)) Q:SDCLNIC']""  D
"RTN","SDMHNS",71,0)
 .I $D(TOTAL(SDVISN,SDCLNIC)) D
"RTN","SDMHNS",72,0)
 ..N SDTOTS
"RTN","SDMHNS",73,0)
 ..S SDTOTS=$J($P(TOTAL(SDVISN,SDCLNIC),"^",2),3)_"   "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",3),3)_"   "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",4),3)_"    "_$J($P(TOTAL(SDVISN,SDCLNIC),"^",5),3)
"RTN","SDMHNS",74,0)
 ..W $E(SDVISN,1,24)_"/"_$E(SDCLNIC,1,26),?55,SDTOTS,! D RET^SDMHAD1 Q:SDUP
"RTN","SDMHNS",75,0)
 W ! D RET^SDMHAD1 Q:SDUP
"RTN","SDMHNS",76,0)
 ;W "*STATUS: NS = No Show      NSA = No Show Auto Rebook     NAT = No Action Taken",! D RET^SDMHAD1 Q:SDUP
"RTN","SDMHNS",77,0)
 Q
"RTN","SDMHNS",78,0)
COUNT ; COUNTER
"RTN","SDMHNS",79,0)
 S SDCOUNT=SDCOUNT+1
"RTN","SDMHNS1")
0^9^B101585316
"RTN","SDMHNS1",1,0)
SDMHNS1 ;MAF/ALB - MENTAL HEALTH NO SHOW REPORT (BGJ CONT.);SEPTEMBER 9, 2010
"RTN","SDMHNS1",2,0)
 ;;5.3;Scheduling;**578,588**;Aug13,1993;Build 53
"RTN","SDMHNS1",3,0)
DATA ; Set up the data for the patient
"RTN","SDMHNS1",4,0)
 ;       piece 1 = dfn
"RTN","SDMHNS1",5,0)
 ;       piece 2 = Appointment Date and time
"RTN","SDMHNS1",6,0)
 ;       piece 3 = status N(Noshow) or NA (Noshow with auto rebook)
"RTN","SDMHNS1",7,0)
 ;       piece 4 = PID last 4 of SSN
"RTN","SDMHNS1",8,0)
 ;       piece 5 = clinic ien   ^SC(
"RTN","SDMHNS1",9,0)
 ;       piece 6 = stop code ien ^DIC(40.7
"RTN","SDMHNS1",10,0)
 ;   
"RTN","SDMHNS1",11,0)
 ;
"RTN","SDMHNS1",12,0)
EN ;PRINT OF THE ^TMP 
"RTN","SDMHNS1",13,0)
 N SDXDIV,SDXCLIN,SDXDFN,SDXSTOP,SDXREM,SDXNM,SDCOUNT,SDATE
"RTN","SDMHNS1",14,0)
 S (SDXDFN,SDXREM,SDCOUNT)=0
"RTN","SDMHNS1",15,0)
 I $D(^TMP(NAMSPC1,$J)) D TOTAL^SDMHNS
"RTN","SDMHNS1",16,0)
 S SDXDIV=""
"RTN","SDMHNS1",17,0)
 F  S SDXDIV=$O(^TMP(NAMSPC1,$J,SDXDIV)) Q:SDXDIV']""!(SDUP)  D
"RTN","SDMHNS1",18,0)
 .I SDTL="CLIN" D 
"RTN","SDMHNS1",19,0)
 ..S SDXCLIN=""
"RTN","SDMHNS1",20,0)
 ..F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN)) Q:SDXCLIN']""!(SDUP)  D
"RTN","SDMHNS1",21,0)
 ...S SDXNM=""
"RTN","SDMHNS1",22,0)
 ...F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM)) Q:SDXNM']""!(SDUP)  I SDXNM]"" D
"RTN","SDMHNS1",23,0)
 ....S SDXSTOP=0
"RTN","SDMHNS1",24,0)
 ....F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP)) Q:'SDXSTOP!(SDUP)  D
"RTN","SDMHNS1",25,0)
 .....S SDATE=0
"RTN","SDMHNS1",26,0)
 .....F  S SDATE=$O(^TMP("SDNS",$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP,SDATE)) Q:'SDATE!(SDUP)  D
"RTN","SDMHNS1",27,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXCLIN,SDXNM,SDXSTOP,SDATE)) D PRT
"RTN","SDMHNS1",28,0)
 .I SDTL="STOP" D
"RTN","SDMHNS1",29,0)
 ..S SDXSTOP=0
"RTN","SDMHNS1",30,0)
 ..F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP)) Q:SDXSTOP']""!(SDUP)  D
"RTN","SDMHNS1",31,0)
 ...S SDXNM=""
"RTN","SDMHNS1",32,0)
 ...F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM)) Q:SDXNM']""!(SDUP)  I SDXNM]""  D
"RTN","SDMHNS1",33,0)
 ....S SDXCLIN=""
"RTN","SDMHNS1",34,0)
 ....F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN)) Q:SDXCLIN']""!(SDUP)  D
"RTN","SDMHNS1",35,0)
 .....S SDATE=0
"RTN","SDMHNS1",36,0)
 .....F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN,SDATE)) Q:SDATE=""!(SDUP)  D
"RTN","SDMHNS1",37,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXSTOP,SDXNM,SDXCLIN,SDATE)) D PRT
"RTN","SDMHNS1",38,0)
 .I SDTL="MEN" D
"RTN","SDMHNS1",39,0)
 ..S SDXREM=""
"RTN","SDMHNS1",40,0)
 ..F  S SDXREM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM)) Q:SDXREM']""!(SDUP)  D
"RTN","SDMHNS1",41,0)
 ...S SDXNM=""
"RTN","SDMHNS1",42,0)
 ...F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXNM)) Q:SDXNM']""!(SDUP)  I SDXNM]""  D
"RTN","SDMHNS1",43,0)
 ....S SDXCLIN=""
"RTN","SDMHNS1",44,0)
 ....F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXNM,SDXCLIN)) Q:SDXCLIN']""!(SDUP)  D
"RTN","SDMHNS1",45,0)
 .....S SDATE=0
"RTN","SDMHNS1",46,0)
 .....F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXNM,SDXCLIN,SDATE)) Q:SDATE=""!(SDUP)  D
"RTN","SDMHNS1",47,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXNM,SDXCLIN,SDATE)) S SDXSTOP=$P(^TMP(NAMSPC1,$J,SDXDIV,SDXREM,SDXNM,SDXCLIN,SDATE),"^",6) D PRT
"RTN","SDMHNS1",48,0)
 Q
"RTN","SDMHNS1",49,0)
 ;
"RTN","SDMHNS1",50,0)
 ;
"RTN","SDMHNS1",51,0)
PRT ;Print  report
"RTN","SDMHNS1",52,0)
 N SDX
"RTN","SDMHNS1",53,0)
 D COUNT^SDMHNS
"RTN","SDMHNS1",54,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD^SDMHNS  S SDXFLG(SDXDIV)=1,SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHNS1",55,0)
 I $D(SDXFLG(SDXDIV)),'$D(SDXFLG(SDXDIV,SDXCLIN)) S SDX=$$SETSTR("",X,1,80) D SET1(SDX) D HEAD1^SDMHNS S SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHNS1",56,0)
 N SDXNODE,SDXID,SDXDT,SDXSTAT,SDXSORT1,SDXSORT2,SDXCLIEN,SDX,SDDSS
"RTN","SDMHNS1",57,0)
 S SDXSORT1=$S(SDTL="MEN":SDXREM,SDTL="STOP":SDXSTOP,1:SDXCLIN)
"RTN","SDMHNS1",58,0)
 S SDXSORT2=$S(SDTL="CLIN":SDXSTOP,1:SDXCLIN)
"RTN","SDMHNS1",59,0)
 S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXSORT1,SDXNM,SDXSORT2,SDATE))
"RTN","SDMHNS1",60,0)
 S SDXDFN=$P(SDXNODE,"^",1) Q:SDXDFN']""
"RTN","SDMHNS1",61,0)
 S SDXID=$P(SDXNODE,"^",4)
"RTN","SDMHNS1",62,0)
 S SDXDT=$P(SDXNODE,"^",2)
"RTN","SDMHNS1",63,0)
 S SDXSTAT=$P(SDXNODE,"^",3)
"RTN","SDMHNS1",64,0)
 S SDXCLIEN=$P(SDXNODE,"^",5)
"RTN","SDMHNS1",65,0)
 S SDDSS=$P($G(^DIC(40.7,+$P(SDXNODE,"^",6),0)),"^",2)
"RTN","SDMHNS1",66,0)
 I '$D(SDXFLG(SDXDIV,SDXCLIN)) D HEAD1^SDMHNS  S SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHNS1",67,0)
 S SDXDT=$$FMTE^XLFDT(SDXDT,"5")
"RTN","SDMHNS1",68,0)
 D SET
"RTN","SDMHNS1",69,0)
 ;S SDX=$$SETSTR(SDCOUNT,X,1,2)_$$SETSTR($P(^DPT(SDXDFN,0),"^",1),X,4,20)_$$SETSTR(SDXID,X,2,4)_$$SETSTR(SDXDT,X,6,20)_$$SETSTR(SDXCLIN,X,2,15)_$$SETSTR("*"_SDXSTAT,X,2,4) D SET1(SDX) I SDCOUNT=$P($G(TOTAL(SDXDIV,SDXCLIN)),"^",1) S SDCOUNT=0
"RTN","SDMHNS1",70,0)
 N SDPROV S SDPROV=""
"RTN","SDMHNS1",71,0)
 S SDX=$$SETSTR(SDCOUNT,X,1,3)_$$SETSTR($P(^DPT(SDXDFN,0),"^",1),X,3,20)_$$SETSTR(SDXID,X,2,5)_$$SETSTR(SDXDT,X,2,16)_$$SETSTR(SDXCLIN,X,2,30) D SET1(SDX) D PROV D
"RTN","SDMHNS1",72,0)
 .S SDX=$$SETSTR("*"_SDXSTAT,X,49,5)_$$SETSTR(SDPROV,X,1,26) D SET1(SDX) I SDCOUNT=$P($G(TOTAL(SDXDIV,SDXCLIN)),"^",1) S SDCOUNT=0
"RTN","SDMHNS1",73,0)
 ;D PATINFO
"RTN","SDMHNS1",74,0)
 ;D NOK
"RTN","SDMHNS1",75,0)
 ;D EC
"RTN","SDMHNS1",76,0)
 ;D PROV
"RTN","SDMHNS1",77,0)
 ;D MHTC
"RTN","SDMHNS1",78,0)
 D FUT
"RTN","SDMHNS1",79,0)
 ;D RESULTS
"RTN","SDMHNS1",80,0)
 Q
"RTN","SDMHNS1",81,0)
 ;
"RTN","SDMHNS1",82,0)
 ;
"RTN","SDMHNS1",83,0)
SETSTR(W,X,Y,Z) ;SET UP THE STRING
"RTN","SDMHNS1",84,0)
 ;W= String 
"RTN","SDMHNS1",85,0)
 ;X= Variable to set it into
"RTN","SDMHNS1",86,0)
 ;Y= column to set it into
"RTN","SDMHNS1",87,0)
 ;Z= length of the strubg
"RTN","SDMHNS1",88,0)
 S X=$$SETSTR^SDUL1(W,X,Y,Z)
"RTN","SDMHNS1",89,0)
 Q X
"RTN","SDMHNS1",90,0)
SET1(X) ;Sets the XMTEXT global
"RTN","SDMHNS1",91,0)
 S SDLN=SDLN+1,^TMP("SDNS1",$J,SDLN,0)=X Q
"RTN","SDMHNS1",92,0)
SET ;
"RTN","SDMHNS1",93,0)
 S X="" S SDLN=SDLN+1,^TMP("SDNS1",$J,SDLN,0)=X
"RTN","SDMHNS1",94,0)
 Q
"RTN","SDMHNS1",95,0)
 ;
"RTN","SDMHNS1",96,0)
PATINFO ;Patients home, cell and office phones
"RTN","SDMHNS1",97,0)
 N SDPHON,SDX,VAROOT,SDEC6,SDEC5
"RTN","SDMHNS1",98,0)
 S DFN=SDXDFN,VAROOT="SDEC6" D ADD^VADPT
"RTN","SDMHNS1",99,0)
 I $D(SDEC6) D
"RTN","SDMHNS1",100,0)
 . S SDPHON("HOME")=SDEC6(8)
"RTN","SDMHNS1",101,0)
 S DFN=SDXDFN,VAOA("A")=5,VAROOT="SDEC5" D OAD^VADPT
"RTN","SDMHNS1",102,0)
 I $D(SDEC5) D
"RTN","SDMHNS1",103,0)
 . S SDPHON("WORK")=SDEC5(8)
"RTN","SDMHNS1",104,0)
 D GETS^DIQ(2,SDXDFN_",",".134","E","SDPHON")
"RTN","SDMHNS1",105,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHNS1",106,0)
 .S SDPHON("CELL")=$G(SDPHON(2,SDXDFN_",",".134","E"))
"RTN","SDMHNS1",107,0)
 I $D(SDPHON("HOME")),SDPHON("HOME")]"" S SDX=$$SETSTR("Home:  ",X,4,7)_$$HLPHONE^HLFNC(SDPHON("HOME"),,) D SET1(SDX)
"RTN","SDMHNS1",108,0)
 I $D(SDPHON("WORK")),SDPHON("WORK")]"" S SDX=$$SETSTR("Work:  ",X,4,7)_$$HLPHONE^HLFNC(SDPHON("WORK"),,) D SET1(SDX)
"RTN","SDMHNS1",109,0)
 I $D(SDPHON("CELL")),SDPHON("CELL")]"" S SDX=$$SETSTR("Cell:  ",X,4,7)_$$HLPHONE^HLFNC(SDPHON("CELL"),,) D SET1(SDX)
"RTN","SDMHNS1",110,0)
 Q
"RTN","SDMHNS1",111,0)
 ;
"RTN","SDMHNS1",112,0)
 ;
"RTN","SDMHNS1",113,0)
NOK ; Next of Kin information
"RTN","SDMHNS1",114,0)
 N SDNOK,SDNOK2,SDNOKNM,SDNOKNM2,SDNOKR,SDNOKR2,SDNOKPH,SDNOKPH2,SDNOKPO,SDNOKPO2,SDNOKFL,SDX,SDSET,VAOA,VAROOT,SDEC3,SDEC4,X,SDPHON
"RTN","SDMHNS1",115,0)
 S DFN=SDXDFN,VAROOT="SDEC3" D OAD^VADPT
"RTN","SDMHNS1",116,0)
 S DFN=SDXDFN,VAOA("A")=3,VAROOT="SDEC4" D OAD^VADPT
"RTN","SDMHNS1",117,0)
 D GETS^DIQ(2,SDXDFN_",",".21011;.211011","E","SDPHON")
"RTN","SDMHNS1",118,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHNS1",119,0)
 .S SDPHON("K-WORK")=$G(SDPHON(2,SDXDFN_",",".21011","E"))
"RTN","SDMHNS1",120,0)
 .S SDPHON("K2-WORK")=$G(SDPHON(2,SDXDFN_",",".211011","E"))
"RTN","SDMHNS1",121,0)
 S SDNOKFL=0
"RTN","SDMHNS1",122,0)
 I $D(SDEC3) D
"RTN","SDMHNS1",123,0)
 .S SDNOKNM=SDEC3(9),SDNOKR=SDEC3(10),SDNOKPH=SDEC3(8),SDNOKPO=SDPHON("K-WORK")
"RTN","SDMHNS1",124,0)
 I $D(SDEC4) D
"RTN","SDMHNS1",125,0)
 .S SDNOKNM2=SDEC4(9),SDNOKR2=SDEC4(10),SDNOKPH2=SDEC3(8),SDNOKPO2=SDPHON("K2-WORK")
"RTN","SDMHNS1",126,0)
 S X="",SDX="",SDSET=0
"RTN","SDMHNS1",127,0)
 I $D(SDNOKNM),SDNOKNM]"" D:'SDNOKFL NOKFL S SDX=$$SETSTR("NOK: "_SDNOKNM,X,6,20) S SDSET=1
"RTN","SDMHNS1",128,0)
 I $D(SDNOKNM2),SDNOKNM2]"" D:'SDNOKFL NOKFL S SDX=SDX_$$SETSTR("NOK2: "_SDNOKNM2,X,20,20) S SDSET=1
"RTN","SDMHNS1",129,0)
 I SDSET D SET1(SDX)
"RTN","SDMHNS1",130,0)
 S X="",SDX="",SDSET=0
"RTN","SDMHNS1",131,0)
 I $D(SDNOKR),SDNOKR]"" D:'SDNOKFL NOKFL S SDX=$$SETSTR("Relation: "_SDNOKR,X,6,20) S SDSET=1
"RTN","SDMHNS1",132,0)
 I $D(SDNOKR2),SDNOKR2]""  D:'SDNOKFL NOKFL S SDX=SDX_$$SETSTR("Relation: "_SDNOKR2,X,20,20) S SDSET=1
"RTN","SDMHNS1",133,0)
 I SDSET D SET1(SDX)
"RTN","SDMHNS1",134,0)
 S X="",SDX="",SDSET=0
"RTN","SDMHNS1",135,0)
 I $D(SDNOKPH),SDNOKPH]"" D:'SDNOKFL NOKFL S SDX=$$SETSTR("     Phone: ",X,6,12)_$$SETSTR($$HLPHONE^HLFNC(SDNOKPH,,),X,1,15) S SDSET=1
"RTN","SDMHNS1",136,0)
 I $D(SDNOKPH2),SDNOKPH2]"" D:'SDNOKFL NOKFL S SDX=SDX_$$SETSTR("     Phone: ",X,13,12)_$$SETSTR($$HLPHONE^HLFNC(SDNOKPH2,,),X,1,15) S SDSET=1
"RTN","SDMHNS1",137,0)
 I SDSET D SET1(SDX)
"RTN","SDMHNS1",138,0)
 S X="",SDX="",SDSET=0
"RTN","SDMHNS1",139,0)
 I $D(SDNOKPO),SDNOKPO]"" D:'SDNOKFL NOKFL S SDX=$$SETSTR("Office Phone: ",X,6,14)_$$SETSTR($$HLPHONE^HLFNC(SDNOKPO,,),X,1,13) S SDSET=1
"RTN","SDMHNS1",140,0)
 I $D(SDNOKPO2),SDNOKPO2]"" D:'SDNOKFL NOKFL S SDX=SDX_$$SETSTR("Office Phone: ",X,13,14)_$$SETSTR($$HLPHONE^HLFNC(SDNOKPO2,,),X,1,15) S SDSET=1
"RTN","SDMHNS1",141,0)
 I SDSET D SET1(SDX)
"RTN","SDMHNS1",142,0)
 Q
"RTN","SDMHNS1",143,0)
 ;
"RTN","SDMHNS1",144,0)
 ;
"RTN","SDMHNS1",145,0)
NOKFL S SDX=$$SETSTR("   Next of Kin: ",X,1,16) D SET1(SDX) S SDNOKFL=1,SDX=""
"RTN","SDMHNS1",146,0)
 Q
"RTN","SDMHNS1",147,0)
 ;
"RTN","SDMHNS1",148,0)
 ;
"RTN","SDMHNS1",149,0)
EC ;display emergency contact information
"RTN","SDMHNS1",150,0)
 N SDEC1,SDEC2,SDX,DFN,X,SDPHON,VAROOT,VAOA
"RTN","SDMHNS1",151,0)
 Q:'$G(SDXDFN)
"RTN","SDMHNS1",152,0)
 S DFN=SDXDFN
"RTN","SDMHNS1",153,0)
 S VAOA("A")=1,VAROOT="SDEC1"  D OAD^VADPT ; Get Primary EC
"RTN","SDMHNS1",154,0)
 S VAOA("A")=4,VAROOT="SDEC2"  D OAD^VADPT ; Get Secondary EC
"RTN","SDMHNS1",155,0)
 D GETS^DIQ(2,SDXDFN_",",".33011;.331011","E","SDPHON")
"RTN","SDMHNS1",156,0)
 I $D(SDPHON(2,SDXDFN_",")) D
"RTN","SDMHNS1",157,0)
 .S SDPHON("E-WORK")=$G(SDPHON(2,SDXDFN_",",".33011","E"))
"RTN","SDMHNS1",158,0)
 .S SDPHON("E2-WORK")=$G(SDPHON(2,SDXDFN_",",".331011","E"))
"RTN","SDMHNS1",159,0)
 I SDEC1(9)]"" D
"RTN","SDMHNS1",160,0)
 .S X=""
"RTN","SDMHNS1",161,0)
 . I $D(SDEC1)!($D(SDEC2)) S SDX=$$SETSTR("   Emergency Contact: ",X,1,50) D SET1(SDX)
"RTN","SDMHNS1",162,0)
 . ;Contacts name and realtionship
"RTN","SDMHNS1",163,0)
 . S SDX=""
"RTN","SDMHNS1",164,0)
 . I SDEC1(9)]"" S SDX=$$SETSTR("E-Cont.: ",X,6,10)_$E(SDEC1(9),1,20)
"RTN","SDMHNS1",165,0)
 . I SDEC2(9)]"" S SDX=SDX_$$SETSTR("E2-Cont.: ",X,20,10)_$E(SDEC2(9),1,20)
"RTN","SDMHNS1",166,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",167,0)
 . S SDX=""
"RTN","SDMHNS1",168,0)
 . I SDEC1(10)]"" S SDX=$$SETSTR("Relation: ",X,6,10)_SDEC1(10)
"RTN","SDMHNS1",169,0)
 . I SDEC2(10)]"" S SDX=SDX_$$SETSTR("Relation: ",X,25,10)_SDEC2(10)
"RTN","SDMHNS1",170,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",171,0)
 . ;ECs address lines 1, 2 and 3
"RTN","SDMHNS1",172,0)
 . S SDX=""
"RTN","SDMHNS1",173,0)
 . I SDEC1(1)]"" S SDX=$$SETSTR(SDEC1(1),X,15,20)
"RTN","SDMHNS1",174,0)
 . I SDEC2(1)]"" S SDX=SDX_$$SETSTR(SDEC2(1),X,20,20)
"RTN","SDMHNS1",175,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",176,0)
 . S SDX=""
"RTN","SDMHNS1",177,0)
 . I SDEC1(2)]"" S SDX=$$SETSTR(SDEC1(2),X,15,20)
"RTN","SDMHNS1",178,0)
 . I SDEC2(2)]"" S SDX=SDX_$$SETSTR(SDEC2(2),X,20,20)
"RTN","SDMHNS1",179,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",180,0)
 . S SDX=""
"RTN","SDMHNS1",181,0)
 . I SDEC1(3)]"" S SDX=$$SETSTR(SDEC1(3),X,15,20)
"RTN","SDMHNS1",182,0)
 . I SDEC2(3)]"" S SDX=SDX_$$SETSTR(SDEC2(3),X,20,20)
"RTN","SDMHNS1",183,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",184,0)
 . S SDX=""
"RTN","SDMHNS1",185,0)
 . ;Emergency Contact 1 City, State an Zip+4
"RTN","SDMHNS1",186,0)
 . I SDEC1(4)]"" D
"RTN","SDMHNS1",187,0)
 . . S SDX=""
"RTN","SDMHNS1",188,0)
 . . N SDZ
"RTN","SDMHNS1",189,0)
 . . S SDZ=$L(SDEC1(4))
"RTN","SDMHNS1",190,0)
 . . S SDX=$$SETSTR(SDEC1(4),X,15,SDZ)
"RTN","SDMHNS1",191,0)
 . . I SDEC1(5)]"" S SDX=SDX_", "_$$GET1^DIQ(5,+SDEC1(5),1)
"RTN","SDMHNS1",192,0)
 . . S SDX=SDX_"  "_$P(SDEC1(11),"^",2)
"RTN","SDMHNS1",193,0)
 . ;Emergency Contact 2 City State and Zip+4
"RTN","SDMHNS1",194,0)
 . I SDEC2(4)]"" D
"RTN","SDMHNS1",195,0)
 . . S SDZ=$L(SDEC2(4))
"RTN","SDMHNS1",196,0)
 . . S SDX=SDX_$$SETSTR(SDEC2(4),X,23,SDZ)
"RTN","SDMHNS1",197,0)
 . . I SDEC2(5)]"" S SDX=SDX_", "_$$GET1^DIQ(5,+SDEC2(5),1)
"RTN","SDMHNS1",198,0)
 . . S SDX=SDX_"  "_$P(SDEC2(11),"^",2)
"RTN","SDMHNS1",199,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",200,0)
 . ;Home and work phones
"RTN","SDMHNS1",201,0)
 . S SDX=""
"RTN","SDMHNS1",202,0)
 . I SDEC1(8)]"" S SDX=$$SETSTR("Phone: ",X,6,8)_$$HLPHONE^HLFNC(SDEC1(8),,)
"RTN","SDMHNS1",203,0)
 . I SDEC2(8)]"" S SDX=SDX_$$SETSTR("Phone: ",X,20,8)_$$HLPHONE^HLFNC(SDEC2(8),,)
"RTN","SDMHNS1",204,0)
 . I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",205,0)
 . S SDX=""
"RTN","SDMHNS1",206,0)
 . I SDPHON("E-WORK")]"" S SDX=$$SETSTR("Work Phone: ",X,6,11)_$$HLPHONE^HLFNC(SDPHON("E-WORK"),,)
"RTN","SDMHNS1",207,0)
 . I SDPHON("E2-WORK")]"" S SDX=SDX_$$SETSTR("Work Phone: ",X,17,12)_$$HLPHONE^HLFNC(SDPHON("E2-WORK"),,)
"RTN","SDMHNS1",208,0)
 .I SDX]"" D SET1(SDX)
"RTN","SDMHNS1",209,0)
 D KVAR^VADPT
"RTN","SDMHNS1",210,0)
 Q
"RTN","SDMHNS1",211,0)
 ;
"RTN","SDMHNS1",212,0)
 ;
"RTN","SDMHNS1",213,0)
PROV ;Clinic Default Provider
"RTN","SDMHNS1",214,0)
 N SDPNUM,SDPNODE,SDX
"RTN","SDMHNS1",215,0)
 S SDPNUM=0
"RTN","SDMHNS1",216,0)
 F SDPNUM=0:0 S SDPNUM=$O(^SC(SDXCLIEN,"PR",SDPNUM)) Q:'(+SDPNUM)  I $D(^SC(SDXCLIEN,"PR",SDPNUM,0)) S SDPNODE=^SC(SDXCLIEN,"PR",SDPNUM,0) I $P(SDPNODE,"^",1)&($P(SDPNODE,"^",2)) D  Q:SDUP
"RTN","SDMHNS1",217,0)
 .S SDPROV=$P(^VA(200,$P(SDPNODE,"^",1),0),"^",1)
"RTN","SDMHNS1",218,0)
 Q
"RTN","SDMHNS1",219,0)
 ;
"RTN","SDMHNS1",220,0)
 ;
"RTN","SDMHNS1",221,0)
MHTC ;Mental Health Treatment Coordinator
"RTN","SDMHNS1",222,0)
 S SDX=""
"RTN","SDMHNS1",223,0)
 S SDX=$$SETSTR("MHTC:  ",X,4,11)
"RTN","SDMHNS1",224,0)
 D SET1(SDX)
"RTN","SDMHNS1",225,0)
 Q
"RTN","SDMHNS1",226,0)
 ;
"RTN","SDMHNS1",227,0)
 ;
"RTN","SDMHNS1",228,0)
FUT ; FUTURE SCHEDULED APPTS.
"RTN","SDMHNS1",229,0)
 N SDARRAY,SDCOUNT,SDX,X1,X2,X,SDNOSDAY
"RTN","SDMHNS1",230,0)
 ;S SDNOSDAY=$$GET^XPAR("PKG.SCHEDULING","SDMH NO SHOW DAYS",1,"E")
"RTN","SDMHNS1",231,0)
 S SDNOSDAY=$$GET^XPAR("SYS^PKG.SCHEDULING","SDMH NO SHOW DAYS",1,"Q")
"RTN","SDMHNS1",232,0)
 S SDNOSDAY=$S(SDNOSDAY]"":SDNOSDAY,1:30)
"RTN","SDMHNS1",233,0)
 ;Find Scheduled apointments witin 30 days using scheduling API
"RTN","SDMHNS1",234,0)
 S X1=DT,X2=SDNOSDAY D C^%DTC S SDX=X
"RTN","SDMHNS1",235,0)
 S SDARRAY(1)=DT_";"_SDX
"RTN","SDMHNS1",236,0)
 S SDARRAY("SORT")="P"
"RTN","SDMHNS1",237,0)
 S SDARRAY(3)="NT;R"
"RTN","SDMHNS1",238,0)
 S SDARRAY(4)=SDXDFN
"RTN","SDMHNS1",239,0)
 S SDARRAY("FLDS")="1;2;3;4;10;13"
"RTN","SDMHNS1",240,0)
 S SDCOUNT=$$SDAPI^SDAMA301(.SDARRAY)
"RTN","SDMHNS1",241,0)
 I SDCOUNT>0 D  Q:SDUP
"RTN","SDMHNS1",242,0)
 .;Get info on future scheduled appointments and display it
"RTN","SDMHNS1",243,0)
 . S SDX="",X=""
"RTN","SDMHNS1",244,0)
 . S SDX=$$SETSTR("         Future Scheduled Appointments:  ",X,1,40) D SET1(SDX)
"RTN","SDMHNS1",245,0)
 . N SDFA,SDFNODE,SDFUTDT  ;,SDFUTCNT
"RTN","SDMHNS1",246,0)
 . ;S SDFUTCNT=0  ;List up to 6 future appts for one patient
"RTN","SDMHNS1",247,0)
 . S SDFA=0 F  S SDFA=$O(^TMP($J,"SDAMA301",SDXDFN,SDFA)) Q:SDFA=""  D
"RTN","SDMHNS1",248,0)
 ..S (SDX,X)=""
"RTN","SDMHNS1",249,0)
 ..S SDFUTDT=$$FMTE^XLFDT(SDFA,"5") S SDFNODE=^TMP($J,"SDAMA301",SDXDFN,SDFA)
"RTN","SDMHNS1",250,0)
 ..S SDX=$$SETSTR(SDFUTDT,X,12,18)_$$SETSTR($P($P(SDFNODE,"^",2),";",2),X,2,30)
"RTN","SDMHNS1",251,0)
 ..D SET1(SDX)
"RTN","SDMHNS1",252,0)
 .Q
"RTN","SDMHNS1",253,0)
 I SDCOUNT'>0 D
"RTN","SDMHNS1",254,0)
 .S (SDX,X)=""
"RTN","SDMHNS1",255,0)
 .S SDX="     Future Scheduled Appointments: NO APPOINTMENTS SCHEDULED WITHIN "_SDNOSDAY_$S(SDNOSDAY=1:" DAY",1:" DAYS")
"RTN","SDMHNS1",256,0)
 .S SDX=$$SETSTR(SDX,X,1,80) D SET1(SDX)
"RTN","SDMHNS1",257,0)
 ;.S SDX=$$SETSTR("     Future Scheduled Appointments: NO APPOINTMENTS SCHEDULED WITHIN 30 DAYS",X,1,80) D SET1(SDX)
"RTN","SDMHNS1",258,0)
 K ^TMP($J,"SDAMA301")
"RTN","SDMHNS1",259,0)
 Q
"RTN","SDMHNS1",260,0)
 ;
"RTN","SDMHNS1",261,0)
 ;
"RTN","SDMHNS1",262,0)
RESULTS ;Reminder information
"RTN","SDMHNS1",263,0)
 N SDX
"RTN","SDMHNS1",264,0)
 S (SDX,X)=""
"RTN","SDMHNS1",265,0)
 S SDX=$$SETSTR("Results: ",X,4,9) D SET1(SDX)
"RTN","SDMHNS1",266,0)
 Q
"RTN","SDMHNS1",267,0)
 ;
"RTN","SDMHNS1",268,0)
 ;
"RTN","SDMHNS1",269,0)
PID(DFN) ; Return PID
"RTN","SDMHNS1",270,0)
 ; INPUT  - DFN
"RTN","SDMHNS1",271,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHNS1",272,0)
 N VA
"RTN","SDMHNS1",273,0)
 D PID^VADPT6
"RTN","SDMHNS1",274,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHNS1",275,0)
 ;
"RTN","SDMHPRO")
0^3^B15994772
"RTN","SDMHPRO",1,0)
SDMHPRO ;MAF/ALB - MENTAL HEALTH PROACTIVE HIGH RISK REPORT (BGJ);AUGUST 30, 2011
"RTN","SDMHPRO",2,0)
 ;;5.3;Scheduling;**588**;Aug 13,1993;Build 53
"RTN","SDMHPRO",3,0)
 ;
"RTN","SDMHPRO",4,0)
EN ;entry point for the automatic generation of the Proactive Report from BGJ
"RTN","SDMHPRO",5,0)
 N SDBEG,SDEND,VAUTD,Y,SDUP,SDXFLG,SDDAT,X1,X2,SDTL,X,VAUTCL,SDPAG,SDX,TOTAL,IOM,SDNSDT,%,SDALL
"RTN","SDMHPRO",6,0)
 K ^TMP("SDMHP",$J)
"RTN","SDMHPRO",7,0)
 S SDXFLG=1 ; This flag is set to 1 when it is from the background Job
"RTN","SDMHPRO",8,0)
 D NOW^%DTC S Y=$E(%,1,12) S SDDAT=$$FMTE^XLFDT(Y,"5"),SDBEG=$P(Y,".",1)_".0000",SDEND=$P(Y,".",1)_".2359"
"RTN","SDMHPRO",9,0)
 S SDNSDT=$$FMTE^XLFDT(Y,"2")
"RTN","SDMHPRO",10,0)
 S VAUTD=1   ;All the divisions in the facility
"RTN","SDMHPRO",11,0)
 S SDTL="CLIN",SDALL="M"   ; sort by clinc and only mental health clinics for the BGJ
"RTN","SDMHPRO",12,0)
 S IOM=80
"RTN","SDMHPRO",13,0)
 N SDLN
"RTN","SDMHPRO",14,0)
 S X="",SDLN=0
"RTN","SDMHPRO",15,0)
 D START^SDMHAP
"RTN","SDMHPRO",16,0)
B N XMSUB,XMY,XMTEXT,XMDUZ,SDGRP
"RTN","SDMHPRO",17,0)
 S SDGRP=$O(^XMB(3.8,"B","SD MH NO SHOW NOTIFICATION",""))
"RTN","SDMHPRO",18,0)
 Q:'SDGRP
"RTN","SDMHPRO",19,0)
 D XMY^SDUTL2(SDGRP,0,0)
"RTN","SDMHPRO",20,0)
 S XMSUB="HRMH PROACTIVE NIGHTLY REPORT"_" MESSAGE # "
"RTN","SDMHPRO",21,0)
 S XMTEXT="^TMP(""SDMHP"",$J,"
"RTN","SDMHPRO",22,0)
 S XMDUZ="POSTMASTER"
"RTN","SDMHPRO",23,0)
 D ^XMD
"RTN","SDMHPRO",24,0)
 K ^TMP("SDMHP",$J)
"RTN","SDMHPRO",25,0)
 Q
"RTN","SDMHPRO",26,0)
SET(X) ; SET UP THE STRING
"RTN","SDMHPRO",27,0)
 S SDLN=SDLN+1,^TMP("SDMHP",$J,SDLN,0)=X
"RTN","SDMHPRO",28,0)
 Q
"RTN","SDMHPRO",29,0)
HEAD ;Heading for the report
"RTN","SDMHPRO",30,0)
 ;
"RTN","SDMHPRO",31,0)
 N SDX
"RTN","SDMHPRO",32,0)
 S SDX="",X=""
"RTN","SDMHPRO",33,0)
 S SDPAG=SDPAG+1,SDX=$$SETSTR^SDMHPRO1("HIGH RISK MENTAL HEALTH PROACTIVE NIGHTLY REPORT",X,1,48)_$$SETSTR^SDMHPRO1(" PAGE ",X,20,6)_$$SETSTR^SDMHPRO1(SDPAG,X,4,4) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",34,0)
 S SDX=$$SETSTR^SDMHPRO1("By "_$S(SDTL="MEN":"MENTAL HEALTH QUICK LIST",SDTL="STOP":"STOPCODE",1:"Patient")_" for Appointments on "_$P(SDNSDT,"@",1),X,1,50)_$$SETSTR^SDMHPRO1("Run: "_SDDAT,X,9,30) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",35,0)
 S SDX=$$SETSTR^SDMHPRO1("#",X,1,1)_$$SETSTR^SDMHPRO1("PATIENT",X,4,8)_$$SETSTR^SDMHPRO1("PT ID",X,14,5)_$$SETSTR^SDMHPRO1("APPT D/T",X,2,16)_$$SETSTR^SDMHPRO1("CLINIC",X,2,15) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",36,0)
 S SDX=$$SETSTR^SDMHPRO1($$LINE^SDMHAP(""),X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",37,0)
HEAD1 I $D(^TMP(NAMSPC1,$J)),$D(SDXDIV) S SDX=$$SETSTR^SDMHPRO1("DIVISION: "_$E(SDXDIV,1,24),X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",38,0)
 I '$D(^TMP(NAMSPC1,$J)),'$D(SDXDIV) S SDX=$$SETSTR^SDMHPRO1($$LINE1^SDMHAP(">>>>>>>>>>>>> NO RECORDS <<<<<<<<<<<<<"),X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",39,0)
 Q
"RTN","SDMHPRO",40,0)
 ;
"RTN","SDMHPRO",41,0)
TOTAL ;Prints totals for the clinics by division - FOR BGJ
"RTN","SDMHPRO",42,0)
 Q:'$D(TOTAL)
"RTN","SDMHPRO",43,0)
 N SDVISN,SDCLNIC,SDFLAG,SDX,X
"RTN","SDMHPRO",44,0)
 S (SDVISN)=0
"RTN","SDMHPRO",45,0)
 S X="",SDX=""
"RTN","SDMHPRO",46,0)
 S SDX=$$SETSTR^SDMHPRO1("Division Totals",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",47,0)
 S X="",SDX=""
"RTN","SDMHPRO",48,0)
 S SDX=$$SETSTR^SDMHPRO1("Division",X,1,26)_$$SETSTR^SDMHPRO1("Unique",X,29,6) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",49,0)
 S X="",SDX="" S SDX=$$SETSTR^SDMHPRO1("Patients",X,54,24) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",50,0)
 F  S SDVISN=$O(TOTAL(SDVISN)) Q:SDVISN']""  D
"RTN","SDMHPRO",51,0)
 . N SDX,X
"RTN","SDMHPRO",52,0)
 .I $D(TOTAL(SDVISN)) D
"RTN","SDMHPRO",53,0)
 ..S SDX="",X=""
"RTN","SDMHPRO",54,0)
 ..N SDTOTS
"RTN","SDMHPRO",55,0)
 ..S SDTOTS=$J($P(TOTAL(SDVISN),"^",5),3)
"RTN","SDMHPRO",56,0)
 ..S SDX=$$SETSTR^SDMHPRO1($E(SDVISN,1,24),X,1,54)_$$SETSTR^SDMHPRO1(SDTOTS,X,1,24) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",57,0)
 S X="",SDX="" S SDX=$$SETSTR^SDMHPRO1(" ",X,1,80) D SET1^SDMHPRO1(SDX)
"RTN","SDMHPRO",58,0)
 S X="",SDX=""
"RTN","SDMHPRO",59,0)
 Q
"RTN","SDMHPRO",60,0)
TOTAL1 ;TOTALS FOR AD HOC
"RTN","SDMHPRO",61,0)
 Q:'$D(TOTAL)
"RTN","SDMHPRO",62,0)
 N SDVISN,SDCLNIC,SDFLAG,SDX,X
"RTN","SDMHPRO",63,0)
 S (SDVISN,SDCLNIC)=0
"RTN","SDMHPRO",64,0)
 W ?25,"Division/Clinic Appointment Totals",!!
"RTN","SDMHPRO",65,0)
 W "Division/CLinic",?50,"Unique",!
"RTN","SDMHPRO",66,0)
 W ?49,"Patients",!!
"RTN","SDMHPRO",67,0)
 F  S SDVISN=$O(TOTAL(SDVISN)) Q:SDVISN']""  D
"RTN","SDMHPRO",68,0)
 .I $D(TOTAL(SDVISN)) D
"RTN","SDMHPRO",69,0)
 ..N SDTOTS
"RTN","SDMHPRO",70,0)
 ..S SDTOTS=$J($P(TOTAL(SDVISN),"^",5),3)
"RTN","SDMHPRO",71,0)
 ..W $E(SDVISN,1,30),?50,SDTOTS,! D RET^SDMHAP1 Q:SDUP
"RTN","SDMHPRO",72,0)
 W ! D RET^SDMHAP1 Q:SDUP
"RTN","SDMHPRO",73,0)
 Q
"RTN","SDMHPRO",74,0)
COUNT ; COUNTER
"RTN","SDMHPRO",75,0)
 S SDCOUNT=SDCOUNT+1
"RTN","SDMHPRO1")
0^4^B19699190
"RTN","SDMHPRO1",1,0)
SDMHPRO1 ;MAF/ALB - MENTAL HEALTH PROACTIVE HIGH RISK REPORT (BGJ CONT.);AUGUST 31, 2010
"RTN","SDMHPRO1",2,0)
 ;;5.3;Scheduling;**588**;Aug 13,1993;Build 53
"RTN","SDMHPRO1",3,0)
DATA ; Set up the data for the patient
"RTN","SDMHPRO1",4,0)
 ;       piece 1 = dfn
"RTN","SDMHPRO1",5,0)
 ;       piece 2 = Appointment Date and time
"RTN","SDMHPRO1",6,0)
 ;       piece 3 = status N(Noshow) or NA (Noshow with auto rebook)
"RTN","SDMHPRO1",7,0)
 ;       piece 4 = PID last 4 of SSN
"RTN","SDMHPRO1",8,0)
 ;       piece 5 = clinic ien   ^SC(
"RTN","SDMHPRO1",9,0)
 ;       piece 6 = stop code ien ^DIC(40.7
"RTN","SDMHPRO1",10,0)
 ;   
"RTN","SDMHPRO1",11,0)
 ;
"RTN","SDMHPRO1",12,0)
EN ;PRINT OF THE ^TMP 
"RTN","SDMHPRO1",13,0)
 N SDXDIV,SDXCLIN,SDXDFN,SDXSTOP,SDXREM,SDXNM,SDCOUNT,SDATE
"RTN","SDMHPRO1",14,0)
 S (SDXDFN,SDXREM,SDCOUNT)=0
"RTN","SDMHPRO1",15,0)
 K SDPAT
"RTN","SDMHPRO1",16,0)
 I $D(^TMP(NAMSPC1,$J)) D TOTAL^SDMHPRO
"RTN","SDMHPRO1",17,0)
 S SDXDIV=""
"RTN","SDMHPRO1",18,0)
 F  S SDXDIV=$O(^TMP(NAMSPC1,$J,SDXDIV)) Q:SDXDIV']""!(SDUP)  D
"RTN","SDMHPRO1",19,0)
 .S SDCOUNT=0
"RTN","SDMHPRO1",20,0)
 .I SDTL="CLIN" D  N SDX S SDX=$$SETSTR(" ",X,1,79) D SET1(SDX)
"RTN","SDMHPRO1",21,0)
 ..S SDXNM=""
"RTN","SDMHPRO1",22,0)
 ..F  S SDXNM=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM)) Q:SDXNM']""!(SDUP)  D
"RTN","SDMHPRO1",23,0)
 ...S SDATE=0
"RTN","SDMHPRO1",24,0)
 ...F  S SDATE=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE)) Q:'SDATE!(SDUP)  D
"RTN","SDMHPRO1",25,0)
 ....S SDXCLIN=""
"RTN","SDMHPRO1",26,0)
 ....F  S SDXCLIN=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN)) Q:SDXCLIN']""!(SDUP)   D
"RTN","SDMHPRO1",27,0)
 .....S SDXSTOP=0
"RTN","SDMHPRO1",28,0)
 .....F  S SDXSTOP=$O(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN,SDXSTOP)) Q:'SDXSTOP!(SDUP)  D
"RTN","SDMHPRO1",29,0)
 ......I $D(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN,SDXSTOP)) Q:$D(SDPAT(SDXDIV,$O(^DPT("B",SDXNM,0))))  D PRT
"RTN","SDMHPRO1",30,0)
 .N SDX S SDX=$$SETSTR(" ",X,1,81) D SET1(SDX)
"RTN","SDMHPRO1",31,0)
 Q
"RTN","SDMHPRO1",32,0)
 ;
"RTN","SDMHPRO1",33,0)
 ;
"RTN","SDMHPRO1",34,0)
PRT ;Print  report
"RTN","SDMHPRO1",35,0)
 N SDX,SDXX
"RTN","SDMHPRO1",36,0)
 D COUNT^SDMHPRO
"RTN","SDMHPRO1",37,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD^SDMHPRO  S SDXFLG(SDXDIV)=1,SDXFLG(SDXDIV,SDXCLIN)=1
"RTN","SDMHPRO1",38,0)
 I $D(SDXFLG(SDXDIV)),'$D(SDXFLG(SDXDIV)) S SDX=$$SETSTR("",X,1,80) D SET1(SDX) D HEAD1^SDMHPRO S SDXFLG(SDXDIV)=1
"RTN","SDMHPRO1",39,0)
 N SDXNODE,SDXID,SDXDT,SDXSTAT,SDXSORT1,SDXSORT2,SDXCLIEN,SDX,SDDSS
"RTN","SDMHPRO1",40,0)
 S SDXSORT1=$S(SDTL="MEN":SDXREM,SDTL="STOP":SDXSTOP,1:SDXCLIN)
"RTN","SDMHPRO1",41,0)
 S SDXSORT2=$S(SDTL="CLIN":SDXSTOP,1:SDXCLIN)
"RTN","SDMHPRO1",42,0)
 S SDXNODE=$G(^TMP(NAMSPC1,$J,SDXDIV,SDXNM,SDATE,SDXCLIN,SDXSTOP))
"RTN","SDMHPRO1",43,0)
 S SDXDFN=$P(SDXNODE,"^",1) Q:SDXDFN']""
"RTN","SDMHPRO1",44,0)
 S SDXID=$E($P(SDXNODE,"^",4),1,5)
"RTN","SDMHPRO1",45,0)
 S SDXDT=$P(SDXNODE,"^",2)
"RTN","SDMHPRO1",46,0)
 S SDXSTAT=$P(SDXNODE,"^",3)
"RTN","SDMHPRO1",47,0)
 S SDXCLIEN=$P(SDXNODE,"^",5)
"RTN","SDMHPRO1",48,0)
 S SDDSS=$P($G(^DIC(40.7,+$P(SDXNODE,"^",6),0)),"^",2)
"RTN","SDMHPRO1",49,0)
 S SDPAT(SDXDIV,SDXDFN)=""
"RTN","SDMHPRO1",50,0)
 I '$D(SDXFLG(SDXDIV)) D HEAD1^SDMHPRO  S SDXFLG(SDXDIV)=1
"RTN","SDMHPRO1",51,0)
 S SDXDT=$$FMTE^XLFDT(SDXDT,"5")
"RTN","SDMHPRO1",52,0)
 D SET
"RTN","SDMHPRO1",53,0)
 S SDXX=$$SETSTR(SDCOUNT,X,1,2)_$$SETSTR($P(^DPT(SDXDFN,0),"^",1),X,3,20)_$$SETSTR(SDXID,X,2,5) I SDCOUNT=$P($G(TOTAL(SDXDIV)),"^",1) S SDCOUNT=0
"RTN","SDMHPRO1",54,0)
 D FUT
"RTN","SDMHPRO1",55,0)
 Q
"RTN","SDMHPRO1",56,0)
 ;
"RTN","SDMHPRO1",57,0)
 ;
"RTN","SDMHPRO1",58,0)
SETSTR(W,X,Y,Z) ;SET UP THE STRING
"RTN","SDMHPRO1",59,0)
 ;W= String 
"RTN","SDMHPRO1",60,0)
 ;X= Variable to set it into
"RTN","SDMHPRO1",61,0)
 ;Y= column to set it into
"RTN","SDMHPRO1",62,0)
 ;Z= length of the strubg
"RTN","SDMHPRO1",63,0)
 S X=$$SETSTR^SDUL1(W,X,Y,Z)
"RTN","SDMHPRO1",64,0)
 Q X
"RTN","SDMHPRO1",65,0)
SET1(X) ;Sets the XMTEXT global
"RTN","SDMHPRO1",66,0)
 S SDLN=SDLN+1,^TMP("SDMHP",$J,SDLN,0)=X Q
"RTN","SDMHPRO1",67,0)
SET ;
"RTN","SDMHPRO1",68,0)
 S X="" S SDLN=SDLN+1,^TMP("SDPRO1",$J,SDLN,0)=X
"RTN","SDMHPRO1",69,0)
 Q
"RTN","SDMHPRO1",70,0)
 ;
"RTN","SDMHPRO1",71,0)
 ;
"RTN","SDMHPRO1",72,0)
FUT ; FUTURE SCHEDULED APPTS.
"RTN","SDMHPRO1",73,0)
 N SDARRAY,SDCOUNT,SDX,X1,X2,X,SDPRODAY
"RTN","SDMHPRO1",74,0)
 S SDPRODAY=$$GET^XPAR("SYS^PKG.SCHEDULING","SDMH PROACTIVE DAYS",1,"Q")
"RTN","SDMHPRO1",75,0)
 S SDPRODAY=$S(SDPRODAY]"":SDPRODAY,1:30)
"RTN","SDMHPRO1",76,0)
 ;Find Scheduled apointments for SDPRODAY  days using scheduling API
"RTN","SDMHPRO1",77,0)
 S X1=DT,X2=SDPRODAY D C^%DTC S SDX=X
"RTN","SDMHPRO1",78,0)
 S SDARRAY(1)=DT_";"_SDX
"RTN","SDMHPRO1",79,0)
 S SDARRAY("SORT")="P"
"RTN","SDMHPRO1",80,0)
 S SDARRAY(3)="NT;R"
"RTN","SDMHPRO1",81,0)
 S SDARRAY(4)=SDXDFN
"RTN","SDMHPRO1",82,0)
 S SDARRAY("FLDS")="1;2;3;4;10;13"
"RTN","SDMHPRO1",83,0)
 S SDCOUNT=$$SDAPI^SDAMA301(.SDARRAY)
"RTN","SDMHPRO1",84,0)
 I SDCOUNT>0 D  Q:SDUP
"RTN","SDMHPRO1",85,0)
 .;Get info on future scheduled appointments and display it
"RTN","SDMHPRO1",86,0)
 . S SDX="",X=""
"RTN","SDMHPRO1",87,0)
 . N SDFA,SDFNODE,SDFUTDT
"RTN","SDMHPRO1",88,0)
 . S SDFA=0 F  S SDFA=$O(^TMP($J,"SDAMA301",SDXDFN,SDFA)) Q:SDFA=""  D  ;!($P($G(SDFA),".",1))'=$P(SDBEG,".",1)  D
"RTN","SDMHPRO1",89,0)
 ..S (SDX,X)=""
"RTN","SDMHPRO1",90,0)
 ..S SDFUTDT=$$FMTE^XLFDT(SDFA,"5") S SDFNODE=^TMP($J,"SDAMA301",SDXDFN,SDFA)
"RTN","SDMHPRO1",91,0)
 ..N SDCLCD S SDCLCD=$P($P($G(SDFNODE),"^",2),";",1) I SDCLCD]"" S SDCLCD=$P($G(^SC(SDCLCD,0)),"^",15) Q:SDXDIV'=$P($G(^DG(40.8,SDCLCD,0)),"^",1) 
"RTN","SDMHPRO1",92,0)
 ..I '$D(SDXX) S SDX=$$SETSTR(SDFUTDT,X,32,16)_$$SETSTR($P($P(SDFNODE,"^",2),";",2),X,2,30)
"RTN","SDMHPRO1",93,0)
 ..I $D(SDXX) S SDX=SDXX_$$SETSTR(SDFUTDT,X,2,16)_$$SETSTR($P($P(SDFNODE,"^",2),";",2),X,2,30) K SDXX
"RTN","SDMHPRO1",94,0)
 ..D SET1(SDX)
"RTN","SDMHPRO1",95,0)
 .N SDX S SDX=$$SETSTR(" ",X,1,81) D SET1(SDX)
"RTN","SDMHPRO1",96,0)
 .Q
"RTN","SDMHPRO1",97,0)
 I SDCOUNT'>0 D
"RTN","SDMHPRO1",98,0)
 .S (SDX,X)=""
"RTN","SDMHPRO1",99,0)
 .S SDX="     Future Scheduled Appointments: NO APPOINTMENTS SCHEDULED WITHIN "_SDPRODAY_$S(SDPRODAY=1:" DAY",1:" DAYS")
"RTN","SDMHPRO1",100,0)
 .S SDX=$$SETSTR(SDX,X,1,80) D SET1(SDX)
"RTN","SDMHPRO1",101,0)
 ;.S SDX=$$SETSTR("     Future Scheduled Appointments: NO APPOINTMENTS SCHEDULED WITHIN 30 DAYS",X,1,80) D SET1(SDX)
"RTN","SDMHPRO1",102,0)
 K ^TMP($J,"SDAMA301")
"RTN","SDMHPRO1",103,0)
 Q
"RTN","SDMHPRO1",104,0)
 ;
"RTN","SDMHPRO1",105,0)
 ;
"RTN","SDMHPRO1",106,0)
PID(DFN) ; Return PID
"RTN","SDMHPRO1",107,0)
 ; INPUT  - DFN
"RTN","SDMHPRO1",108,0)
 ; OUTPUT - PID or 'UNKNOWN'
"RTN","SDMHPRO1",109,0)
 N VA
"RTN","SDMHPRO1",110,0)
 D PID^VADPT6
"RTN","SDMHPRO1",111,0)
 Q $S(VA("BID")]"":VA("BID"),1:"UNKNOWN")
"RTN","SDMHPRO1",112,0)
 ;
"VER")
8.0^22.0
**INSTALL NAME**
GMTS*2.7*104
"BLD",8213,0)
GMTS*2.7*104^HEALTH SUMMARY^0^3130509^y
"BLD",8213,1,0)
^^3^3^3120411^^
"BLD",8213,1,1,0)
High Risk MH Phase II
"BLD",8213,1,2,0)
Updates the MH HIGH RISK PRF HX Health Summary Component to display Cat 1 
"BLD",8213,1,3,0)
and 2 PRF for suicide risk.  Component description is also updated.
"BLD",8213,4,0)
^9.64PA^^0
"BLD",8213,6.3)
38
"BLD",8213,"ABPKG")
n
"BLD",8213,"INI")

"BLD",8213,"INID")
n^n^n
"BLD",8213,"INIT")
POST^GMTSY104
"BLD",8213,"KRN",0)
^9.67PA^779.2^20
"BLD",8213,"KRN",.4,0)
.4
"BLD",8213,"KRN",.401,0)
.401
"BLD",8213,"KRN",.402,0)
.402
"BLD",8213,"KRN",.403,0)
.403
"BLD",8213,"KRN",.5,0)
.5
"BLD",8213,"KRN",.84,0)
.84
"BLD",8213,"KRN",3.6,0)
3.6
"BLD",8213,"KRN",3.8,0)
3.8
"BLD",8213,"KRN",9.2,0)
9.2
"BLD",8213,"KRN",9.8,0)
9.8
"BLD",8213,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",8213,"KRN",9.8,"NM",1,0)
GMTSMHRF^^0^B7698174
"BLD",8213,"KRN",9.8,"NM",2,0)
GMTSY104^^0^B9611824
"BLD",8213,"KRN",9.8,"NM",3,0)
GMTSMHTC^^0^B7727408
"BLD",8213,"KRN",9.8,"NM","B","GMTSMHRF",1)

"BLD",8213,"KRN",9.8,"NM","B","GMTSMHTC",3)

"BLD",8213,"KRN",9.8,"NM","B","GMTSY104",2)

"BLD",8213,"KRN",19,0)
19
"BLD",8213,"KRN",19.1,0)
19.1
"BLD",8213,"KRN",101,0)
101
"BLD",8213,"KRN",409.61,0)
409.61
"BLD",8213,"KRN",771,0)
771
"BLD",8213,"KRN",779.2,0)
779.2
"BLD",8213,"KRN",870,0)
870
"BLD",8213,"KRN",8989.51,0)
8989.51
"BLD",8213,"KRN",8989.52,0)
8989.52
"BLD",8213,"KRN",8994,0)
8994
"BLD",8213,"KRN","B",.4,.4)

"BLD",8213,"KRN","B",.401,.401)

"BLD",8213,"KRN","B",.402,.402)

"BLD",8213,"KRN","B",.403,.403)

"BLD",8213,"KRN","B",.5,.5)

"BLD",8213,"KRN","B",.84,.84)

"BLD",8213,"KRN","B",3.6,3.6)

"BLD",8213,"KRN","B",3.8,3.8)

"BLD",8213,"KRN","B",9.2,9.2)

"BLD",8213,"KRN","B",9.8,9.8)

"BLD",8213,"KRN","B",19,19)

"BLD",8213,"KRN","B",19.1,19.1)

"BLD",8213,"KRN","B",101,101)

"BLD",8213,"KRN","B",409.61,409.61)

"BLD",8213,"KRN","B",771,771)

"BLD",8213,"KRN","B",779.2,779.2)

"BLD",8213,"KRN","B",870,870)

"BLD",8213,"KRN","B",8989.51,8989.51)

"BLD",8213,"KRN","B",8989.52,8989.52)

"BLD",8213,"KRN","B",8994,8994)

"BLD",8213,"PRE")
GMTSY104
"BLD",8213,"QUES",0)
^9.62^^
"BLD",8213,"REQB",0)
^9.611^2^2
"BLD",8213,"REQB",1,0)
GMTS*2.7*99^2
"BLD",8213,"REQB",2,0)
SD*5.3*575^2
"BLD",8213,"REQB","B","GMTS*2.7*99",1)

"BLD",8213,"REQB","B","SD*5.3*575",2)

"INIT")
POST^GMTSY104
"MBREQ")
1
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools^^^3010208
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
104^3130509
"PKG",126,22,1,"PAH",1,1,0)
^^3^3^3130509
"PKG",126,22,1,"PAH",1,1,1,0)
High Risk MH Phase II
"PKG",126,22,1,"PAH",1,1,2,0)
Updates the MH HIGH RISK PRF HX Health Summary Component to display Cat 1 
"PKG",126,22,1,"PAH",1,1,3,0)
and 2 PRF for suicide risk.  Component description is also updated.
"PRE")
GMTSY104
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","GMTSMHRF")
0^1^B7698174
"RTN","GMTSMHRF",1,0)
GMTSMHRF ;BP/WAT - DRIVER FOR PRF ASSIGNMENT HX ;09/05/12  13:47
"RTN","GMTSMHRF",2,0)
 ;;2.7;Health Summary;**99,104**;Oct 20, 1995;Build 38
"RTN","GMTSMHRF",3,0)
 ;
"RTN","GMTSMHRF",4,0)
 ;EXTERNAL CALLS
"RTN","GMTSMHRF",5,0)
 ;$$GETINF^DGPFAPIH  4903
"RTN","GMTSMHRF",6,0)
 ;$$GETFLAG^DGPFAPIU  5491
"RTN","GMTSMHRF",7,0)
 ;$$GETACT^DGPFAPI    3860
"RTN","GMTSMHRF",8,0)
 ;$$GET^XPAR         2263
"RTN","GMTSMHRF",9,0)
 ;
"RTN","GMTSMHRF",10,0)
 Q
"RTN","GMTSMHRF",11,0)
 ;
"RTN","GMTSMHRF",12,0)
EN ;start here
"RTN","GMTSMHRF",13,0)
 ;FLGPTR - IEN;FILE - 1234;DGPF(26.11
"RTN","GMTSMHRF",14,0)
 ;DGSTART - OPTIONAL; GETS ALL HX IF NOT DEFINED
"RTN","GMTSMHRF",15,0)
 ;DGEND - SAME AS START DATE
"RTN","GMTSMHRF",16,0)
 ;GMTSARR - OPTIONAL ROOT FOR RETURN; IF NOT SPEC'D DGPFAPI1 IS DEFAULT
"RTN","GMTSMHRF",17,0)
 ;DGRSLT - RESULT OF CALL, 1 SUCCESS; 0 FAIL
"RTN","GMTSMHRF",18,0)
 ;DGPF SUICIDE FLAG - parameter to call and discover what name a site uses for the PRF suicide flag.
"RTN","GMTSMHRF",19,0)
 N FLGNAME,FLGPTR,RESULT,GMTSARR,ERRMSG,CATEGORY,CAT,GMTSSTAT
"RTN","GMTSMHRF",20,0)
 S FLGNAME="HIGH RISK FOR SUICIDE"
"RTN","GMTSMHRF",21,0)
 S FLGPTR=$$GETFLAG^DGPFAPIU(FLGNAME,"N"),CAT="NATIONAL"
"RTN","GMTSMHRF",22,0)
 I $G(FLGPTR)["-1" S CATEGORY="I",ERRMSG=$P(FLGPTR,";",2) D ERR Q
"RTN","GMTSMHRF",23,0)
 S RESULT=$$GETINF^DGPFAPIH(DFN,FLGPTR,,,"GMTSARR")
"RTN","GMTSMHRF",24,0)
 I $G(RESULT) S GMTSSTAT=$$GETSTAT(FLGNAME,CAT) D PRINT S RESULT=0
"RTN","GMTSMHRF",25,0)
 S FLGNAME=$$GET^XPAR("PKG","DGPF SUICIDE FLAG",1,"E")
"RTN","GMTSMHRF",26,0)
 Q:$G(FLGNAME)=""
"RTN","GMTSMHRF",27,0)
 S FLGPTR=$$GETFLAG^DGPFAPIU(FLGNAME,"L"),CAT="LOCAL"
"RTN","GMTSMHRF",28,0)
 Q:$G(FLGPTR)["-1"  ;not alerting of error b/c CatII flag will eventually be deactivated
"RTN","GMTSMHRF",29,0)
 S RESULT=$$GETINF^DGPFAPIH(DFN,FLGPTR,,,"GMTSARR")
"RTN","GMTSMHRF",30,0)
 I $G(RESULT) S GMTSSTAT=$$GETSTAT(FLGNAME,CAT) D PRINT
"RTN","GMTSMHRF",31,0)
 Q
"RTN","GMTSMHRF",32,0)
 ;
"RTN","GMTSMHRF",33,0)
GETSTAT(NAME,CATEG) ;get status of PRF assignment
"RTN","GMTSMHRF",34,0)
 N GMTSAFLG,GMTSFCNT,INDEX,FLAGSTAT
"RTN","GMTSMHRF",35,0)
 S FLAGSTAT="INACTIVE"
"RTN","GMTSMHRF",36,0)
 S GMTSFCNT=$$GETACT^DGPFAPI(DFN,"GMTSAFLG")>0 I $G(GMTSFCNT)>0 D
"RTN","GMTSMHRF",37,0)
 .S INDEX=""
"RTN","GMTSMHRF",38,0)
 .F  S INDEX=$O(GMTSAFLG(INDEX)) Q:INDEX=""  D
"RTN","GMTSMHRF",39,0)
 ..I GMTSAFLG(INDEX,"FLAG")[$G(NAME)&(GMTSAFLG(INDEX,"CATEGORY")[$G(CATEG)) S FLAGSTAT="ACTIVE"
"RTN","GMTSMHRF",40,0)
 Q FLAGSTAT
"RTN","GMTSMHRF",41,0)
 ;
"RTN","GMTSMHRF",42,0)
PRINT ;SHOW THE FLAG HX
"RTN","GMTSMHRF",43,0)
 N COUNT S COUNT=""
"RTN","GMTSMHRF",44,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSMHRF",45,0)
 W ?2,"CATEGORY "_$P(GMTSARR("CATEGORY"),"^")_" PRF: "_$P(GMTSARR("FLAG"),"^",2)
"RTN","GMTSMHRF",46,0)
 W !,?3,"Current Status: "_$G(GMTSSTAT)
"RTN","GMTSMHRF",47,0)
 W !,?3,"Date Assigned: "_$P(GMTSARR("ASSIGNDT"),"^",2)
"RTN","GMTSMHRF",48,0)
 W !,?3,"Next Review Date: "_$P(GMTSARR("REVIEWDT"),"^",2)
"RTN","GMTSMHRF",49,0)
 W !,?3,"Owner Site: "_$P(GMTSARR("OWNER"),"^",2)
"RTN","GMTSMHRF",50,0)
 W !,?3,"Originating Site: "_$P(GMTSARR("ORIGSITE"),"^",2)
"RTN","GMTSMHRF",51,0)
 W !,?3,"Assignment History:"
"RTN","GMTSMHRF",52,0)
 F  S COUNT=$O(GMTSARR("HIST",COUNT)) Q:COUNT=""  D
"RTN","GMTSMHRF",53,0)
 .W !,?5,"Date: "_$P(GMTSARR("HIST",COUNT,"DATETIME"),"^",2)
"RTN","GMTSMHRF",54,0)
 .W !,?5,"Action: "_$P(GMTSARR("HIST",COUNT,"ACTION"),"^",2)
"RTN","GMTSMHRF",55,0)
 .W !,?5,"Approved By: "_$P(GMTSARR("HIST",COUNT,"APPRVBY"),"^",2),!!
"RTN","GMTSMHRF",56,0)
 Q
"RTN","GMTSMHRF",57,0)
ERR ;can't find flag
"RTN","GMTSMHRF",58,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSMHRF",59,0)
 W !,"Category "_CATEGORY_" PRF, "_FLGNAME_", is "_ERRMSG_".",!
"RTN","GMTSMHRF",60,0)
 Q
"RTN","GMTSMHTC")
0^3^B7727408
"RTN","GMTSMHTC",1,0)
GMTSMHTC ;SLC/WAT - Driver for MH Treatment Coordinator component ;04/11/12  11:56
"RTN","GMTSMHTC",2,0)
 ;;2.7;Health Summary;**99,104**;Oct 20, 1995;Build 38
"RTN","GMTSMHTC",3,0)
 ;
"RTN","GMTSMHTC",4,0)
 Q
"RTN","GMTSMHTC",5,0)
 ;
"RTN","GMTSMHTC",6,0)
 ;;ICRs
"RTN","GMTSMHTC",7,0)
 ;;10060 ^VA(200 FM only reads
"RTN","GMTSMHTC",8,0)
 ;;2056 GETS^DIQ
"RTN","GMTSMHTC",9,0)
 ;;5697 $$START^SCMCMHTC
"RTN","GMTSMHTC",10,0)
 ;;
"RTN","GMTSMHTC",11,0)
EN ; get MHTC
"RTN","GMTSMHTC",12,0)
 N GMTSMHTC,GMTSIEN,GMTSARR,GMTSOUT,GMTSERR,GMTSCNT
"RTN","GMTSMHTC",13,0)
 S GMTSCNT=1
"RTN","GMTSMHTC",14,0)
 S GMTSMHTC=$$START^SCMCMHTC(DFN) ;Retrieve Mental Health Provider
"RTN","GMTSMHTC",15,0)
 ;GMTSMHTC=IEN^MHTC^Team Position^Role^Team
"RTN","GMTSMHTC",16,0)
 I +GMTSMHTC>0 D  Q:$D(GMTSERR)
"RTN","GMTSMHTC",17,0)
 . S GMTSIEN=$P(GMTSMHTC,"^"),GMTSIEN=GMTSIEN_","
"RTN","GMTSMHTC",18,0)
 . D GETS^DIQ(200,GMTSIEN,".137;.138;.132",,"GMTSARR","GMTSERR")
"RTN","GMTSMHTC",19,0)
 . I $D(GMTSERR) D ERROR Q
"RTN","GMTSMHTC",20,0)
 . S GMTSOUT(GMTSCNT)="        MH Treatment Team:  "_$P(GMTSMHTC,U,5),GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",21,0)
 . S GMTSOUT(GMTSCNT)=" MH Treatment Coordinator:  "_$P(GMTSMHTC,U,2),GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",22,0)
 . S GMTSOUT(GMTSCNT)="             Office Phone:  "_GMTSARR(200,GMTSIEN,.132),GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",23,0)
 . S GMTSOUT(GMTSCNT)="             Analog Pager:  "_GMTSARR(200,GMTSIEN,.137),GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",24,0)
 . S GMTSOUT(GMTSCNT)="            Digital Pager:  "_GMTSARR(200,GMTSIEN,.138)
"RTN","GMTSMHTC",25,0)
 I $D(GMTSOUT) D PRINT
"RTN","GMTSMHTC",26,0)
 K:$D(MHTC) MHTC K:$D(TPIEN) TPIEN ;needed to clean up as these are leftover from the call to SCMCMHTC
"RTN","GMTSMHTC",27,0)
 Q
"RTN","GMTSMHTC",28,0)
PRINT ;SHOW MHTC
"RTN","GMTSMHTC",29,0)
 N I
"RTN","GMTSMHTC",30,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSMHTC",31,0)
 F I=1:1:GMTSCNT D
"RTN","GMTSMHTC",32,0)
 .W GMTSOUT(I),!
"RTN","GMTSMHTC",33,0)
 Q
"RTN","GMTSMHTC",34,0)
 ;
"RTN","GMTSMHTC",35,0)
ERROR ;inform user
"RTN","GMTSMHTC",36,0)
 N ERRCNT S ERRCNT=""
"RTN","GMTSMHTC",37,0)
 S GMTSOUT(GMTSCNT)="An error has ocurred while processing your request.",GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",38,0)
 S GMTSOUT(GMTSCNT)="Please try your request again.  If the error continues",GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",39,0)
 S GMTSOUT(GMTSCNT)="please contact IRM for assistance.",GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",40,0)
 S GMTSOUT(GMTSCNT)="The error message is:"
"RTN","GMTSMHTC",41,0)
 I $P(GMTSERR("DIERR"),"^")=1 S GMTSCNT=GMTSCNT+1,GMTSOUT(GMTSCNT)=GMTSERR("DIERR",1)_": "_GMTSERR("DIERR",1,"TEXT",1) D PRINT Q
"RTN","GMTSMHTC",42,0)
 F  S ERRCNT=$O(GMTSERR("DIERR",ERRCNT)) Q:+ERRCNT'>0  D
"RTN","GMTSMHTC",43,0)
 . S GMTSCNT=GMTSCNT+1
"RTN","GMTSMHTC",44,0)
 . S GMTSOUT(GMTSCNT)=GMTSERR("DIERR",ERRCNT)_": "_GMTSERR("DIERR",ERRCNT,"TEXT",ERRCNT)
"RTN","GMTSMHTC",45,0)
 D PRINT
"RTN","GMTSMHTC",46,0)
 Q
"RTN","GMTSMHTC",47,0)
 ;
"RTN","GMTSY104")
0^2^B9611824
"RTN","GMTSY104",1,0)
GMTSY104 ;BP/WAT - POST-INSTALL PATCH 104 ;04/19/12  15:25
"RTN","GMTSY104",2,0)
 ;;2.7;Health Summary;**104**;Oct 20, 1995;Build 38
"RTN","GMTSY104",3,0)
 ;
"RTN","GMTSY104",4,0)
 ;WP^DIE ;2053
"RTN","GMTSY104",5,0)
 ;FIND1^DIC ;2051
"RTN","GMTSY104",6,0)
 ;B/MES^XPDUTL 10141
"RTN","GMTSY104",7,0)
 ;
"RTN","GMTSY104",8,0)
 ; GMTS health check
"RTN","GMTSY104",9,0)
 N GMTSNAME,I,COUNT,GMTSABRT S GMTSNAME="",COUNT=1,GMTSABRT=""
"RTN","GMTSY104",10,0)
 D BMES^XPDUTL("CHECKING RECENT ADDITIONS TO HEALTH SUMMARY COMPONENT FILE")
"RTN","GMTSY104",11,0)
 F I=252:1:256  Q:I>256!(GMTSABRT=2)  D
"RTN","GMTSY104",12,0)
 .S GMTSNAME=$P(^GMT(142.1,I,0),"^")
"RTN","GMTSY104",13,0)
 .I GMTSNAME=$P($T(TEXT+COUNT),";;",2) D BMES^XPDUTL(GMTSNAME_": OK") S COUNT=COUNT+1 Q
"RTN","GMTSY104",14,0)
 .D BMES^XPDUTL("The following Health Summary Component was not found in file 142.1:")
"RTN","GMTSY104",15,0)
 .D MES^XPDUTL($P($T(TEXT+COUNT),";;",2))
"RTN","GMTSY104",16,0)
 .D BMES^XPDUTL("Install will not proceed until this issue is resolved.")
"RTN","GMTSY104",17,0)
 .D MES^XPDUTL("Transport global will remain on the system.")
"RTN","GMTSY104",18,0)
 .D MES^XPDUTL("Use KIDS option XPD RESTART INSTALL when the issue is resovled.") S GMTSABRT=2
"RTN","GMTSY104",19,0)
 I +$G(GMTSABRT)=2 S XPDQUIT=2 ;abort and leave global on system
"RTN","GMTSY104",20,0)
 Q
"RTN","GMTSY104",21,0)
 ;
"RTN","GMTSY104",22,0)
TEXT ;HS Names to Check
"RTN","GMTSY104",23,0)
 ;;Medication Worksheet (Tool #2)
"RTN","GMTSY104",24,0)
 ;;MAS CONTACTS
"RTN","GMTSY104",25,0)
 ;;MAS MH CLINIC VISITS FUTURE
"RTN","GMTSY104",26,0)
 ;;MH HIGH RISK PRF HX
"RTN","GMTSY104",27,0)
 ;;MH TREATMENT COORDINATOR
"RTN","GMTSY104",28,0)
 Q
"RTN","GMTSY104",29,0)
 ;
"RTN","GMTSY104",30,0)
POST ;post-install
"RTN","GMTSY104",31,0)
 ;update MHRF component description
"RTN","GMTSY104",32,0)
 ;WP^DIE(FILE,IENS,FIELD,FLAGS,wp_root,msg_root)
"RTN","GMTSY104",33,0)
 N GMTSIEN,MSG
"RTN","GMTSY104",34,0)
 K ^TMP($J,"WP")
"RTN","GMTSY104",35,0)
 D BMES^XPDUTL("Updating description for Health Summary Component MH HIGH RISK FOR SUICIDE")
"RTN","GMTSY104",36,0)
 S ^TMP($J,"WP",1,0)="This component displays the assignment status and history for the "
"RTN","GMTSY104",37,0)
 S ^TMP($J,"WP",2,0)="Category I (National) HIGH RISK FOR SUICIDE Patient Record Flag."
"RTN","GMTSY104",38,0)
 S ^TMP($J,"WP",3,0)="Any assignment history found for the Category II (Local) High Risk for "
"RTN","GMTSY104",39,0)
 S ^TMP($J,"WP",4,0)="Suicide flag will also be displayed."
"RTN","GMTSY104",40,0)
 S GMTSIEN=$$FIND1^DIC(142.1,"","X","MH HIGH RISK PRF HX","B",,"MSG")
"RTN","GMTSY104",41,0)
 I +$G(GMTSIEN)'>0 K ^TMP($J,"WP") D BMES^XPDUTL("  Error during lookup of MH HIGH RISK PRF HX component.  ") D  Q
"RTN","GMTSY104",42,0)
 .I $D(MSG)>0 D AWRITE("MSG")
"RTN","GMTSY104",43,0)
 K MSG
"RTN","GMTSY104",44,0)
 D WP^DIE(142.1,GMTSIEN_",",3.5,"K","^TMP($J,""WP"")","MSG")
"RTN","GMTSY104",45,0)
 I $D(MSG)>0 D AWRITE("MSG")
"RTN","GMTSY104",46,0)
 D:$D(MSG)'>0 BMES^XPDUTL("  Update Successful  ")
"RTN","GMTSY104",47,0)
 Q
"RTN","GMTSY104",48,0)
 ;
"RTN","GMTSY104",49,0)
AWRITE(REF) ;Write all the descendants of the array reference.
"RTN","GMTSY104",50,0)
 ;REF is the starting array reference, for example A or ^TMP("SOME NAME",$J).
"RTN","GMTSY104",51,0)
 N DONE,IND,LEN,LN,PROOT,ROOT,START,TEMP,GMTSTEXT
"RTN","GMTSY104",52,0)
 I REF="" Q
"RTN","GMTSY104",53,0)
 S LN=0
"RTN","GMTSY104",54,0)
 S PROOT=$P(REF,")",1)
"RTN","GMTSY104",55,0)
 ;Build the root so we can tell when we are done.
"RTN","GMTSY104",56,0)
 S TEMP=$NA(@REF)
"RTN","GMTSY104",57,0)
 S ROOT=$P(TEMP,")",1)
"RTN","GMTSY104",58,0)
 S REF=$Q(@REF)
"RTN","GMTSY104",59,0)
 I REF'[ROOT Q
"RTN","GMTSY104",60,0)
 S DONE=0
"RTN","GMTSY104",61,0)
 F  Q:(REF="")!(DONE)  D
"RTN","GMTSY104",62,0)
 . S START=$F(REF,ROOT)
"RTN","GMTSY104",63,0)
 . S LEN=$L(REF)
"RTN","GMTSY104",64,0)
 . S IND=$E(REF,START,LEN)
"RTN","GMTSY104",65,0)
 . S LN=LN+1,GMTSTEXT(LN)=PROOT_IND_"="_@REF
"RTN","GMTSY104",66,0)
 . S REF=$Q(@REF)
"RTN","GMTSY104",67,0)
 . I REF'[ROOT S DONE=1
"RTN","GMTSY104",68,0)
 D MES^XPDUTL(.GMTSTEXT)
"RTN","GMTSY104",69,0)
 Q
"RTN","GMTSY104",70,0)
 ;
"VER")
8.0^22.0
**INSTALL NAME**
OR*3.0*348
"BLD",8299,0)
OR*3.0*348^ORDER ENTRY/RESULTS REPORTING^0^3130509^y
"BLD",8299,1,0)
^^2^2^3120412^
"BLD",8299,1,1,0)
The description of this patch may be found in the National Patch Module 
"BLD",8299,1,2,0)
under OR*3.0*348.
"BLD",8299,4,0)
^9.64PA^100.9^1
"BLD",8299,4,100.9,0)
100.9
"BLD",8299,4,100.9,222)
y^n^f^^^^n
"BLD",8299,4,"B",100.9,100.9)

"BLD",8299,6)
8^
"BLD",8299,6.3)
14
"BLD",8299,"INID")
n^n^n
"BLD",8299,"INIT")
POST^ORY348
"BLD",8299,"KRN",0)
^9.67PA^779.2^20
"BLD",8299,"KRN",.4,0)
.4
"BLD",8299,"KRN",.401,0)
.401
"BLD",8299,"KRN",.402,0)
.402
"BLD",8299,"KRN",.403,0)
.403
"BLD",8299,"KRN",.5,0)
.5
"BLD",8299,"KRN",.84,0)
.84
"BLD",8299,"KRN",3.6,0)
3.6
"BLD",8299,"KRN",3.8,0)
3.8
"BLD",8299,"KRN",9.2,0)
9.2
"BLD",8299,"KRN",9.8,0)
9.8
"BLD",8299,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",8299,"KRN",9.8,"NM",1,0)
ORB3^^0^B97635419
"BLD",8299,"KRN",9.8,"NM",2,0)
ORB3SPEC^^0^B93913902
"BLD",8299,"KRN",9.8,"NM",3,0)
ORBPRCHK^^0^B32589157
"BLD",8299,"KRN",9.8,"NM",4,0)
ORY348^^0^B13557254
"BLD",8299,"KRN",9.8,"NM",5,0)
ORBINPTR^^0^B1813250
"BLD",8299,"KRN",9.8,"NM","B","ORB3",1)

"BLD",8299,"KRN",9.8,"NM","B","ORB3SPEC",2)

"BLD",8299,"KRN",9.8,"NM","B","ORBINPTR",5)

"BLD",8299,"KRN",9.8,"NM","B","ORBPRCHK",3)

"BLD",8299,"KRN",9.8,"NM","B","ORY348",4)

"BLD",8299,"KRN",19,0)
19
"BLD",8299,"KRN",19.1,0)
19.1
"BLD",8299,"KRN",101,0)
101
"BLD",8299,"KRN",409.61,0)
409.61
"BLD",8299,"KRN",771,0)
771
"BLD",8299,"KRN",779.2,0)
779.2
"BLD",8299,"KRN",870,0)
870
"BLD",8299,"KRN",8989.51,0)
8989.51
"BLD",8299,"KRN",8989.51,"NM",0)
^9.68A^7^7
"BLD",8299,"KRN",8989.51,"NM",1,0)
ORB PROVIDER RECIPIENTS^^0
"BLD",8299,"KRN",8989.51,"NM",2,0)
ORB OI EXPIRING - INPT PR^^0
"BLD",8299,"KRN",8989.51,"NM",3,0)
ORB OI EXPIRING - OUTPT PR^^0
"BLD",8299,"KRN",8989.51,"NM",4,0)
ORB OI ORDERED - INPT PR^^0
"BLD",8299,"KRN",8989.51,"NM",5,0)
ORB OI ORDERED - OUTPT PR^^0
"BLD",8299,"KRN",8989.51,"NM",6,0)
ORB OI RESULTS - INPT PR^^0
"BLD",8299,"KRN",8989.51,"NM",7,0)
ORB OI RESULTS - OUTPT PR^^0
"BLD",8299,"KRN",8989.51,"NM","B","ORB OI EXPIRING - INPT PR",2)

"BLD",8299,"KRN",8989.51,"NM","B","ORB OI EXPIRING - OUTPT PR",3)

"BLD",8299,"KRN",8989.51,"NM","B","ORB OI ORDERED - INPT PR",4)

"BLD",8299,"KRN",8989.51,"NM","B","ORB OI ORDERED - OUTPT PR",5)

"BLD",8299,"KRN",8989.51,"NM","B","ORB OI RESULTS - INPT PR",6)

"BLD",8299,"KRN",8989.51,"NM","B","ORB OI RESULTS - OUTPT PR",7)

"BLD",8299,"KRN",8989.51,"NM","B","ORB PROVIDER RECIPIENTS",1)

"BLD",8299,"KRN",8989.52,0)
8989.52
"BLD",8299,"KRN",8994,0)
8994
"BLD",8299,"KRN","B",.4,.4)

"BLD",8299,"KRN","B",.401,.401)

"BLD",8299,"KRN","B",.402,.402)

"BLD",8299,"KRN","B",.403,.403)

"BLD",8299,"KRN","B",.5,.5)

"BLD",8299,"KRN","B",.84,.84)

"BLD",8299,"KRN","B",3.6,3.6)

"BLD",8299,"KRN","B",3.8,3.8)

"BLD",8299,"KRN","B",9.2,9.2)

"BLD",8299,"KRN","B",9.8,9.8)

"BLD",8299,"KRN","B",19,19)

"BLD",8299,"KRN","B",19.1,19.1)

"BLD",8299,"KRN","B",101,101)

"BLD",8299,"KRN","B",409.61,409.61)

"BLD",8299,"KRN","B",771,771)

"BLD",8299,"KRN","B",779.2,779.2)

"BLD",8299,"KRN","B",870,870)

"BLD",8299,"KRN","B",8989.51,8989.51)

"BLD",8299,"KRN","B",8989.52,8989.52)

"BLD",8299,"KRN","B",8994,8994)

"BLD",8299,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8299,"QUES",0)
^9.62^^
"BLD",8299,"REQB",0)
^9.611^4^4
"BLD",8299,"REQB",1,0)
OR*3.0*243^2
"BLD",8299,"REQB",2,0)
OR*3.0*296^2
"BLD",8299,"REQB",3,0)
OR*3.0*280^2
"BLD",8299,"REQB",4,0)
SD*5.3*575^2
"BLD",8299,"REQB","B","OR*3.0*243",1)

"BLD",8299,"REQB","B","OR*3.0*280",3)

"BLD",8299,"REQB","B","OR*3.0*296",2)

"BLD",8299,"REQB","B","SD*5.3*575",4)

"FIA",100.9)
OE/RR NOTIFICATIONS
"FIA",100.9,0)
^ORD(100.9,
"FIA",100.9,0,0)
100.9
"FIA",100.9,0,1)
y^n^f^^^^n
"FIA",100.9,0,10)

"FIA",100.9,0,11)

"FIA",100.9,0,"RLRO")

"FIA",100.9,0,"VR")
3.0^OR
"FIA",100.9,100.9)
0
"INIT")
POST^ORY348
"KRN",8989.5,87,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^42
"KRN",8989.5,87,1)
OT
"KRN",8989.5,88,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^30
"KRN",8989.5,88,1)
O
"KRN",8989.5,89,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^23
"KRN",8989.5,89,1)
OAP
"KRN",8989.5,90,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^31
"KRN",8989.5,90,1)
O
"KRN",8989.5,91,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^14
"KRN",8989.5,91,1)
OAPT
"KRN",8989.5,92,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^24
"KRN",8989.5,92,1)
OAPT
"KRN",8989.5,94,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^18
"KRN",8989.5,94,1)
APT
"KRN",8989.5,95,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^20
"KRN",8989.5,95,1)
APT
"KRN",8989.5,96,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^35
"KRN",8989.5,96,1)
APT
"KRN",8989.5,97,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^36
"KRN",8989.5,97,1)
APT
"KRN",8989.5,98,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^19
"KRN",8989.5,98,1)
APT
"KRN",8989.5,99,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^6
"KRN",8989.5,99,1)
OAPT
"KRN",8989.5,100,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^5
"KRN",8989.5,100,1)
OAPT
"KRN",8989.5,101,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^28
"KRN",8989.5,101,1)
OAPT
"KRN",8989.5,102,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^37
"KRN",8989.5,102,1)
OAPT
"KRN",8989.5,103,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^12
"KRN",8989.5,103,1)
OAPT
"KRN",8989.5,106,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^43
"KRN",8989.5,106,1)
T
"KRN",8989.5,107,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^44
"KRN",8989.5,107,1)
O
"KRN",8989.5,108,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^45
"KRN",8989.5,108,1)
OAPT
"KRN",8989.5,109,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^50
"KRN",8989.5,109,1)
T
"KRN",8989.5,110,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^47
"KRN",8989.5,110,1)
OAPT
"KRN",8989.5,111,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^48
"KRN",8989.5,111,1)
T
"KRN",8989.5,114,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^53
"KRN",8989.5,114,1)
OAPT
"KRN",8989.5,115,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^25
"KRN",8989.5,115,1)
OAPT
"KRN",8989.5,750,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^21
"KRN",8989.5,750,1)
O
"KRN",8989.5,1003,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^55
"KRN",8989.5,1003,1)

"KRN",8989.5,1391,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^3
"KRN",8989.5,1391,1)
OAPT
"KRN",8989.5,1599,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^46
"KRN",8989.5,1599,1)
O
"KRN",8989.5,1827,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^57
"KRN",8989.5,1827,1)
OAPT
"KRN",8989.5,1828,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^58
"KRN",8989.5,1828,1)
OAPT
"KRN",8989.5,1907,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^26
"KRN",8989.5,1907,1)
O
"KRN",8989.5,2777,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^59
"KRN",8989.5,2777,1)
T
"KRN",8989.5,4145,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^62
"KRN",8989.5,4145,1)
T
"KRN",8989.5,11720,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^72
"KRN",8989.5,11720,1)
OAPT
"KRN",8989.5,12912,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^73
"KRN",8989.5,12912,1)
OAPT
"KRN",8989.5,13583,0)
110;DIC(9.4,^ORB PROVIDER RECIPIENTS^77
"KRN",8989.5,13583,1)
CM
"KRN",8989.51,50,-1)
0^1
"KRN",8989.51,50,0)
ORB PROVIDER RECIPIENTS^Provider Recipients^1^Notification
"KRN",8989.51,50,1)
F^0:9^Any one or combination of 'P', 'A', 'T' 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,50,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,50,6)
P^100.9^Notification sent to the patient's provider recipients.
"KRN",8989.51,50,20,0)
^^26^26^3121206^
"KRN",8989.51,50,20,1,0)
Set of codes indicating default provider recipients of a notification by 
"KRN",8989.51,50,20,2,0)
their title or relationship to the patient.  Notifications can be set up 
"KRN",8989.51,50,20,3,0)
with any or all of the following codes:
"KRN",8989.51,50,20,4,0)
 
"KRN",8989.51,50,20,5,0)
  P (Primary Provider): deliver notification to  the patient's Primary
"KRN",8989.51,50,20,6,0)
Provider.  
"KRN",8989.51,50,20,7,0)
  A (Attending Physician): deliver notification to the patient's Attending
"KRN",8989.51,50,20,8,0)
Physician.
"KRN",8989.51,50,20,9,0)
  T (Patient Care Teams): deliver notification to the patient's OE/RR 
"KRN",8989.51,50,20,10,0)
Teams (personal patient and team lists are evaluated for potential 
"KRN",8989.51,50,20,11,0)
recipients) and to devices on an OE/RR team.
"KRN",8989.51,50,20,12,0)
  O (Ordering Provider): deliver notification to the provider
"KRN",8989.51,50,20,13,0)
who placed the order which trigger the notification.
"KRN",8989.51,50,20,14,0)
  M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,50,20,15,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,50,20,16,0)
  E (Entering User): deliver notification to the user/provider who entered
"KRN",8989.51,50,20,17,0)
the order's most recent activity.
"KRN",8989.51,50,20,18,0)
  R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,50,20,19,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,50,20,20,0)
  S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,50,20,21,0)
Associate Provider.
"KRN",8989.51,50,20,22,0)
  C (PCMM Mental Health Treatment Coordinator): deliver notification to 
"KRN",8989.51,50,20,23,0)
the patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,50,20,24,0)
 
"KRN",8989.51,50,20,25,0)
The providers, physicians and teams must be set up properly and accurately
"KRN",8989.51,50,20,26,0)
for the correct individuals to receive the notification.
"KRN",8989.51,50,30,0)
^8989.513I^3^3
"KRN",8989.51,50,30,1,0)
1^4
"KRN",8989.51,50,30,2,0)
2^4.2
"KRN",8989.51,50,30,3,0)
3^9.4
"KRN",8989.51,361,-1)
0^4
"KRN",8989.51,361,0)
ORB OI ORDERED - INPT PR^Flag Items for INPT ORDER Providr Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,361,1)
F^0:9^Any one or combination of 'P', 'A', 'T' 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,361,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,361,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,361,20,0)
^^25^25^3121206^
"KRN",8989.51,361,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,361,20,2,0)
orderable item is ordered for an inpatient.  The notification is 
"KRN",8989.51,361,20,3,0)
delivered to a user based upon that user's relationship to the inpatient 
"KRN",8989.51,361,20,4,0)
as defined by the following codes.  Orderable Items can be set up with any
"KRN",8989.51,361,20,5,0)
or all of the following codes:
"KRN",8989.51,361,20,6,0)
  
"KRN",8989.51,361,20,7,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,361,20,8,0)
Provider.  
"KRN",8989.51,361,20,9,0)
A (Attending Physician): deliver notification to the patient's 
"KRN",8989.51,361,20,10,0)
Attending Physician.
"KRN",8989.51,361,20,11,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,361,20,12,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,361,20,13,0)
and to devices on an OE/RR team.
"KRN",8989.51,361,20,14,0)
O (Ordering Provider): deliver notification to the provider
"KRN",8989.51,361,20,15,0)
who placed the order which trigger the notification.
"KRN",8989.51,361,20,16,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,361,20,17,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,361,20,18,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,361,20,19,0)
entered the order's most recent activity.
"KRN",8989.51,361,20,20,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,361,20,21,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,361,20,22,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,361,20,23,0)
Associate Provider.
"KRN",8989.51,361,20,24,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the
"KRN",8989.51,361,20,25,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,361,30,0)
^8989.513I^2^2
"KRN",8989.51,361,30,1,0)
1^4
"KRN",8989.51,361,30,2,0)
2^4.2
"KRN",8989.51,362,-1)
0^5
"KRN",8989.51,362,0)
ORB OI ORDERED - OUTPT PR^Flag Items for OUTPT ORDER Providr Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,362,1)
F^0:9^Any one or combination of 'P', 'A', 'T', 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,362,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,362,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,362,20,0)
^^25^25^3121206^
"KRN",8989.51,362,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,362,20,2,0)
orderable item is ordered for an outpatient.  The notification is 
"KRN",8989.51,362,20,3,0)
delivered to a user based upon that user's relationship to the outpatient 
"KRN",8989.51,362,20,4,0)
as defined by the following codes.  Orderable Items can be set up with any
"KRN",8989.51,362,20,5,0)
or all of the following codes:
"KRN",8989.51,362,20,6,0)
   
"KRN",8989.51,362,20,7,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,362,20,8,0)
Provider.  
"KRN",8989.51,362,20,9,0)
A (Attending Physician): deliver notification to the patient's 
"KRN",8989.51,362,20,10,0)
Attending Physician.
"KRN",8989.51,362,20,11,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,362,20,12,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,362,20,13,0)
and to devices on an OE/RR team.
"KRN",8989.51,362,20,14,0)
O (Ordering Provider): deliver notification to the provider
"KRN",8989.51,362,20,15,0)
who placed the order which trigger the notification.
"KRN",8989.51,362,20,16,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,362,20,17,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,362,20,18,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,362,20,19,0)
entered the order's most recent activity.
"KRN",8989.51,362,20,20,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,362,20,21,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,362,20,22,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,362,20,23,0)
Associate Provider.
"KRN",8989.51,362,20,24,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the
"KRN",8989.51,362,20,25,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,362,30,0)
^8989.513I^2^2
"KRN",8989.51,362,30,1,0)
1^4
"KRN",8989.51,362,30,2,0)
2^4.2
"KRN",8989.51,363,-1)
0^6
"KRN",8989.51,363,0)
ORB OI RESULTS - INPT PR^Flag Items for INPT RESULT Provid Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,363,1)
F^0:9^Any one or combination of 'P', 'A', 'T', 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,363,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,363,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,363,8)
I $$LRRAD^ORB3F1(+Y)
"KRN",8989.51,363,20,0)
^^27^27^3121206^
"KRN",8989.51,363,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,363,20,2,0)
orderable item is resulted for an inpatient.  Results only apply to orders
"KRN",8989.51,363,20,3,0)
which can be resulted (lab, imaging, consults.)
"KRN",8989.51,363,20,4,0)
 
"KRN",8989.51,363,20,5,0)
The notification is delivered to a user based upon that user's
"KRN",8989.51,363,20,6,0)
relationship to the inpatient as defined by the following codes.
"KRN",8989.51,363,20,7,0)
Orderable Items can be set up with any or all of the following codes:
"KRN",8989.51,363,20,8,0)
   
"KRN",8989.51,363,20,9,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,363,20,10,0)
Provider.  
"KRN",8989.51,363,20,11,0)
A (Attending Physician): deliver notification to the patient's Attending
"KRN",8989.51,363,20,12,0)
Physician.
"KRN",8989.51,363,20,13,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,363,20,14,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,363,20,15,0)
and to devices on an OE/RR team.
"KRN",8989.51,363,20,16,0)
O (Ordering Provider): deliver notification to the provider who placed the
"KRN",8989.51,363,20,17,0)
order which trigger the notification.
"KRN",8989.51,363,20,18,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,363,20,19,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,363,20,20,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,363,20,21,0)
entered the order's most recent activity.
"KRN",8989.51,363,20,22,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,363,20,23,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,363,20,24,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,363,20,25,0)
Associate Provider.
"KRN",8989.51,363,20,26,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the
"KRN",8989.51,363,20,27,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,363,30,0)
^8989.513I^2^2
"KRN",8989.51,363,30,1,0)
1^4
"KRN",8989.51,363,30,2,0)
2^4.2
"KRN",8989.51,364,-1)
0^7
"KRN",8989.51,364,0)
ORB OI RESULTS - OUTPT PR^Flag Items for OUTPT RESULT Provid Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,364,1)
F^0:9^Any one or combination of 'P', 'A', 'T', 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,364,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,364,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,364,8)
I $$LRRAD^ORB3F1(+Y)
"KRN",8989.51,364,20,0)
^^27^27^3121206^
"KRN",8989.51,364,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,364,20,2,0)
orderable item is resulted for an outpatient.  Results only apply to 
"KRN",8989.51,364,20,3,0)
orders which can be resulted (lab, imaging, consults.)
"KRN",8989.51,364,20,4,0)
  
"KRN",8989.51,364,20,5,0)
The notification is delivered to a user based upon that user's
"KRN",8989.51,364,20,6,0)
relationship to the outpatient as defined by the following codes.
"KRN",8989.51,364,20,7,0)
An Orderable Item can be set up with any or all of the following codes:
"KRN",8989.51,364,20,8,0)
    
"KRN",8989.51,364,20,9,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,364,20,10,0)
Provider.  
"KRN",8989.51,364,20,11,0)
A (Attending Physician): deliver notification to the patient's Attending
"KRN",8989.51,364,20,12,0)
Physician.
"KRN",8989.51,364,20,13,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,364,20,14,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,364,20,15,0)
and to devices on an OE/RR team.
"KRN",8989.51,364,20,16,0)
O (Ordering Provider): deliver notification to the provider who placed 
"KRN",8989.51,364,20,17,0)
the order which trigger the notification.
"KRN",8989.51,364,20,18,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,364,20,19,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,364,20,20,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,364,20,21,0)
entered the order's most recent activity.
"KRN",8989.51,364,20,22,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,364,20,23,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,364,20,24,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,364,20,25,0)
Associate Provider.
"KRN",8989.51,364,20,26,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the 
"KRN",8989.51,364,20,27,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,364,30,0)
^8989.513I^2^2
"KRN",8989.51,364,30,1,0)
1^4
"KRN",8989.51,364,30,2,0)
2^4.2
"KRN",8989.51,365,-1)
0^2
"KRN",8989.51,365,0)
ORB OI EXPIRING - INPT PR^Flag Items for INPT EXPIRING Prov Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,365,1)
F^0:9^Any one or combination of 'P', 'A', 'T', 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,365,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,365,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,365,20,0)
^^25^25^3121206^
"KRN",8989.51,365,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,365,20,2,0)
orderable item is expiring for an inpatient.  The notification is 
"KRN",8989.51,365,20,3,0)
delivered to a user based upon that user's relationship to the inpatient 
"KRN",8989.51,365,20,4,0)
as defined by the following codes.  Orderable Items can be set up with any
"KRN",8989.51,365,20,5,0)
or all of the following codes:
"KRN",8989.51,365,20,6,0)
   
"KRN",8989.51,365,20,7,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,365,20,8,0)
Provider.  
"KRN",8989.51,365,20,9,0)
A (Attending Physician): deliver notification to the patient's 
"KRN",8989.51,365,20,10,0)
Attending Physician.
"KRN",8989.51,365,20,11,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,365,20,12,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,365,20,13,0)
and to devices on an OE/RR team. 
"KRN",8989.51,365,20,14,0)
O (Ordering Provider): deliver notification to the provider
"KRN",8989.51,365,20,15,0)
who placed the order which trigger the notification.
"KRN",8989.51,365,20,16,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,365,20,17,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,365,20,18,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,365,20,19,0)
entered the order's most recent activity.
"KRN",8989.51,365,20,20,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,365,20,21,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,365,20,22,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,365,20,23,0)
Associate Provider.
"KRN",8989.51,365,20,24,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the
"KRN",8989.51,365,20,25,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,365,30,0)
^8989.513I^2^2
"KRN",8989.51,365,30,1,0)
1^4
"KRN",8989.51,365,30,2,0)
2^4.2
"KRN",8989.51,366,-1)
0^3
"KRN",8989.51,366,0)
ORB OI EXPIRING - OUTPT PR^Flag Items for OUTPT EXPIRING Prov Recip^1^Orderable Item^Provider Recipients
"KRN",8989.51,366,1)
F^0:9^Any one or combination of 'P', 'A', 'T', 'O', 'M', 'E', 'R', 'S' and/or 'C'.
"KRN",8989.51,366,2)
K:$L($TR(X,"PATOMERSC","")) X
"KRN",8989.51,366,6)
P^101.43^Enter the orderable item to trigger a notification.
"KRN",8989.51,366,20,0)
^^25^25^3121206^
"KRN",8989.51,366,20,1,0)
This parameter is used to trigger a notification/alert when a specific
"KRN",8989.51,366,20,2,0)
orderable item is expiring for an outpatient.  The notification is 
"KRN",8989.51,366,20,3,0)
delivered to a user based upon that user's relationship to the outpatient
"KRN",8989.51,366,20,4,0)
as defined by the following codes.  Orderable Items can be set up with
"KRN",8989.51,366,20,5,0)
any or all of the following codes:
"KRN",8989.51,366,20,6,0)
    
"KRN",8989.51,366,20,7,0)
P (Primary Provider): deliver notification to the patient's Primary
"KRN",8989.51,366,20,8,0)
Provider.  
"KRN",8989.51,366,20,9,0)
A (Attending Physician): deliver notification to the patient's 
"KRN",8989.51,366,20,10,0)
Attending Physician.
"KRN",8989.51,366,20,11,0)
T (Patient Care Teams): deliver notification to the patient's OE/RR Teams 
"KRN",8989.51,366,20,12,0)
(personal patient and team lists are evaluated for potential recipients) 
"KRN",8989.51,366,20,13,0)
and to devices on an OE/RR team.
"KRN",8989.51,366,20,14,0)
O (Ordering Provider): deliver notification to the provider
"KRN",8989.51,366,20,15,0)
who placed the order which trigger the notification.
"KRN",8989.51,366,20,16,0)
M (PCMM Team): deliver notification to users/providers linked to the
"KRN",8989.51,366,20,17,0)
patient via PCMM Team Position assignments.
"KRN",8989.51,366,20,18,0)
E (Entering User): deliver notification to the user/provider who 
"KRN",8989.51,366,20,19,0)
entered the order's most recent activity.
"KRN",8989.51,366,20,20,0)
R (PCMM Primary Care Practitioner): deliver notification to the
"KRN",8989.51,366,20,21,0)
patient's PCMM Primary Care Practitioner.
"KRN",8989.51,366,20,22,0)
S (PCMM Associate Provider): deliver notification to the patient's PCMM
"KRN",8989.51,366,20,23,0)
Associate Provider.
"KRN",8989.51,366,20,24,0)
C (PCMM Mental Health Treatment Coordinator): deliver notification to the
"KRN",8989.51,366,20,25,0)
patient's PCMM Mental Health Treatment Coordinator.
"KRN",8989.51,366,30,0)
^8989.513I^2^2
"KRN",8989.51,366,30,1,0)
1^4
"KRN",8989.51,366,30,2,0)
2^4.2
"MBREQ")
1
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
348^3130509^123456789116
"PKG",110,22,1,"PAH",1,1,0)
^^2^2^3130509
"PKG",110,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the National Patch Module 
"PKG",110,22,1,"PAH",1,1,2,0)
under OR*3.0*348.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","ORB3")
0^1^B97635419
"RTN","ORB3",1,0)
ORB3 ; slc/CLA,WAT,TC - Main routine for OE/RR 3 notifications ; 2/24/12 8:09am
"RTN","ORB3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**31,74,91,105,139,190,220,253,265,296,348**;Dec 17, 1997;Build 14
"RTN","ORB3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","ORB3",4,0)
 ;
"RTN","ORB3",5,0)
 ;This routine invokes to following ICR(s):
"RTN","ORB3",6,0)
 ;ICR 4156     ;REGISTRATION, COMBAT VETERAN STATUS
"RTN","ORB3",7,0)
 ;ICR 5697     ;SCHEDULING, PCMM MHTC API's
"RTN","ORB3",8,0)
 ;
"RTN","ORB3",9,0)
EN(ORN,ORBDFN,ORNUM,ORBADUZ,ORBPMSG,ORBPDATA) ;
"RTN","ORB3",10,0)
 ;
"RTN","ORB3",11,0)
 N ORBENT
"RTN","ORB3",12,0)
 S ORBENT=$$ENTITY^ORB31(ORNUM)
"RTN","ORB3",13,0)
 ;
"RTN","ORB3",14,0)
 Q:$$GET^XPAR(ORBENT,"ORB SYSTEM ENABLE/DISABLE",1,"I")="D"
"RTN","ORB3",15,0)
 Q:'$L($G(^ORD(100.9,ORN,0)))
"RTN","ORB3",16,0)
 Q:+$$ONOFF^ORB3FN(ORN)=0
"RTN","ORB3",17,0)
 ;
"RTN","ORB3",18,0)
 S ORBPMSG=$E($G(ORBPMSG),1,51)
"RTN","ORB3",19,0)
 ;
"RTN","ORB3",20,0)
 ;if msg from notif file or oc notif (#54), quit if dup w/in past 1 min:
"RTN","ORB3",21,0)
 N ORBDUP,ORBN
"RTN","ORB3",22,0)
 S ORBN=^ORD(100.9,ORN,0)
"RTN","ORB3",23,0)
 I ($P(ORBN,"^",4)="NOT")!(ORN=54) D
"RTN","ORB3",24,0)
 .S ORBDUP=$$DUP^ORB31(ORN,ORBDFN,ORBPMSG,ORNUM)
"RTN","ORB3",25,0)
 Q:+$G(ORBDUP)=1
"RTN","ORB3",26,0)
 ;
"RTN","ORB3",27,0)
 N ORBDESC
"RTN","ORB3",28,0)
 S ORBDESC=" Send Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",29,0)
 ;
"RTN","ORB3",30,0)
 D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$H,ORBDESC,$G(DGPMA))
"RTN","ORB3",31,0)
 Q
"RTN","ORB3",32,0)
ZTSK ;
"RTN","ORB3",33,0)
 D START
"RTN","ORB3",34,0)
 S ZTREQ="@"
"RTN","ORB3",35,0)
 Q
"RTN","ORB3",36,0)
UTL(ORBU,ORN,ORBDFN,ORNUM,ORBADUZ,ORBPMSG,ORBPDATA) ;
"RTN","ORB3",37,0)
 Q:$G(ORBU)'=1
"RTN","ORB3",38,0)
START Q:$G(ORN)=""!($G(ORBDFN)="")
"RTN","ORB3",39,0)
 Q:'$L($G(^ORD(100.9,ORN,0)))
"RTN","ORB3",40,0)
 N ORBNOW,ORBID,ORBLOCK,ORBDESC
"RTN","ORB3",41,0)
 S ORBNOW=$$NOW^XLFDT
"RTN","ORB3",42,0)
 S ORBLOCK=0
"RTN","ORB3",43,0)
 ;
"RTN","ORB3",44,0)
 ;lock to prevent concurrent processing by other resource slots:
"RTN","ORB3",45,0)
 I '$D(ORBU) D
"RTN","ORB3",46,0)
 .S ^XTMP("ORBLOCK",0)=$$FMADD^XLFDT(ORBNOW,1,"","","")_"^"_ORBNOW
"RTN","ORB3",47,0)
 .S ORBID=$P($P($G(ORBPDATA),"|",2),"@")  ;get unique data id
"RTN","ORB3",48,0)
 .I $L(ORBID) D
"RTN","ORB3",49,0)
 ..LOCK +^XTMP("ORBLOCK",ORBDFN,ORN,ORBID):60 E  D  Q
"RTN","ORB3",50,0)
 ...S ORBDESC=" Requeue Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",51,0)
 ...D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$$HADD^XLFDT($H,"","",5,""),ORBDESC,$G(DGPMA)) ;requeue in 5 min.
"RTN","ORB3",52,0)
 ...S ORBLOCK=1
"RTN","ORB3",53,0)
 .;
"RTN","ORB3",54,0)
 .I '$L(ORBID) D
"RTN","ORB3",55,0)
 ..LOCK +^XTMP("ORBLOCK",ORBDFN,ORN):60 E  D  Q
"RTN","ORB3",56,0)
 ...S ORBDESC=" Requeue Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",57,0)
 ...D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$$HADD^XLFDT($H,"","",5,""),ORBDESC,$G(DGPMA)) ;requeue in 5 min.
"RTN","ORB3",58,0)
 ...S ORBLOCK=1
"RTN","ORB3",59,0)
 .;
"RTN","ORB3",60,0)
 I ORBLOCK=1 D QUIT Q
"RTN","ORB3",61,0)
 ;
"RTN","ORB3",62,0)
DOALERT ; Entry point for alert logic outside of TaskMan
"RTN","ORB3",63,0)
 N ORBDUZ,ORBN,ORBXQAID,ORPTNAM,ORBPRIM,ORBATTD,ORBDEV,ORBENT
"RTN","ORB3",64,0)
 N ORBUI,ORBASPEC,ORBSMSG,ORBADT,ORBSDEV,ORBDEL,ORBDI,ORBTDEV,ORY
"RTN","ORB3",65,0)
 S ORBUI=1,ORBADT=0
"RTN","ORB3",66,0)
 S:'$L($G(ORBPMSG)) ORBPMSG=""
"RTN","ORB3",67,0)
 I '$L(ORBPDATA),(+$G(ORNUM)>0) S ORBPDATA=+$G(ORNUM)_"@"
"RTN","ORB3",68,0)
 S ORBN=^ORD(100.9,ORN,0)
"RTN","ORB3",69,0)
 ;
"RTN","ORB3",70,0)
 S ORBENT=$$ENTITY^ORB31(ORNUM)
"RTN","ORB3",71,0)
 ;
"RTN","ORB3",72,0)
 N DFN S DFN=ORBDFN,VA200="" D OERR^VADPT
"RTN","ORB3",73,0)
 I ('$L($G(VA("BID"))))!('$L($G(VADM(1)))) D QUIT Q
"RTN","ORB3",74,0)
 I (ORN=18)!(ORN=20)!(ORN=35) S ORBADT=1 ;A/D/T notif
"RTN","ORB3",75,0)
 ;if not an A/D/T notif, get primary & attending from OERR^VADPT:
"RTN","ORB3",76,0)
 I ORBADT=0 S ORBPRIM=+$P(VAIN(2),U),ORBATTD=+$P(VAIN(11),U)
"RTN","ORB3",77,0)
 I ORBADT=1 D ADT^ORB31(ORN,ORBDFN,.ORBPRIM,.ORBATTD,$G(ORDGPMA)) ;A/D/T notif
"RTN","ORB3",78,0)
 I $D(ORBU) D  ;create debug msg
"RTN","ORB3",79,0)
 .S ORBU(ORBUI)="Processing notification: "_$P(ORBN,U),ORBUI=ORBUI+1
"RTN","ORB3",80,0)
 .S ORBU(ORBUI)="            for patient: "_VADM(1),ORBUI=ORBUI+1
"RTN","ORB3",81,0)
 .I $G(ORNUM)>0 S ORBU(ORBUI)="              for order: "_ORNUM,ORBUI=ORBUI+1
"RTN","ORB3",82,0)
 D REGULAR^ORB3REG(ORN,.XQA,.ORBU,.ORBUI,.ORBDEV,ORBDFN)
"RTN","ORB3",83,0)
 D SPECIAL^ORB3SPEC(ORN,.ORBASPEC,.ORBU,.ORBUI,$G(ORNUM),ORBDFN,$G(ORBPDATA),.ORBSMSG,$G(ORBPMSG),.ORBSDEV,$G(ORBPRIM),$G(ORBATTD))
"RTN","ORB3",84,0)
 I $L($G(ORBSMSG)) S ORBPMSG=$E(ORBSMSG,1,51)
"RTN","ORB3",85,0)
 I $D(ORBASPEC)>1 D SPECDUZS ;special recips
"RTN","ORB3",86,0)
 I $D(ORBADUZ)>1 D PKGDUZS ;pkg-supplied recips
"RTN","ORB3",87,0)
 D TITLE ;provider recips
"RTN","ORB3",88,0)
 S ORBXQAID=$P(ORBN,"^",2)_","_ORBDFN_","_ORN
"RTN","ORB3",89,0)
 ;
"RTN","ORB3",90,0)
 I ($D(XQA)>1)!($D(ORBDEV)>1)!($D(ORBSDEV)>1) D  ;recips found
"RTN","ORB3",91,0)
 .S XQAFLG=$P(ORBN,"^",5)
"RTN","ORB3",92,0)
 .S XQADFN=ORBDFN
"RTN","ORB3",93,0)
 .I XQAFLG="R" S XQAROU=$P(ORBN,"^",6)_"^"_$P(ORBN,"^",7)
"RTN","ORB3",94,0)
 .I $G(ORBPDATA)'="" S XQADATA=ORBPDATA
"RTN","ORB3",95,0)
 .S ORPTNAM=$E(VADM(1)_"         ",1,9)
"RTN","ORB3",96,0)
 .I $G(ORN)=27 N CVMRKR,RSLT S RSLT=$$CVEDT^DGCV(DFN) I $P($G(RSLT),U)&($P($G(RSLT),U,3)) S CVMRKR=" CV "_$$FMTE^XLFDT($P($G(RSLT),U,2),"5DZ") ;WAT
"RTN","ORB3",97,0)
 .S XQAMSG=ORPTNAM_" "_"("_$E(ORPTNAM)_$E(VA("BID"),1,4)_")"_$G(CVMRKR)_": " ;WAT
"RTN","ORB3",98,0)
 .S XQAMSG=XQAMSG_$S(ORBPMSG'="":ORBPMSG,1:$P(ORBN,"^",3))
"RTN","ORB3",99,0)
 .S XQAARCH=$$GET^XPAR(ORBENT,"ORB ARCHIVE PERIOD",ORN,"I")
"RTN","ORB3",100,0)
 .S XQASUPV=$$GET^XPAR(ORBENT,"ORB FORWARD SUPERVISOR",ORN,"I")
"RTN","ORB3",101,0)
 .S XQASURO=$$GET^XPAR(ORBENT,"ORB FORWARD SURROGATES",ORN,"I")
"RTN","ORB3",102,0)
 .S XQAREVUE=$$GET^XPAR(ORBENT,"ORB FORWARD BACKUP REVIEWER",ORN,"I")
"RTN","ORB3",103,0)
 .S XQACNDEL=$$GET^XPAR(ORBENT,"ORB REMOVE",ORN,"I")
"RTN","ORB3",104,0)
 .S XQACNDEL=$S(XQACNDEL=1:1,1:"")
"RTN","ORB3",105,0)
 .I $D(ORBDEV)>1 D REGDEV^ORB31(.ORBDEV)
"RTN","ORB3",106,0)
 .I $D(ORBSDEV)>1 D REGDEV^ORB31(.ORBSDEV)
"RTN","ORB3",107,0)
 .I $D(ORBTDEV)>1 D REGDEV^ORB31(.ORBTDEV)
"RTN","ORB3",108,0)
 .S XQAID=ORBXQAID
"RTN","ORB3",109,0)
 .I $D(XQA) D SETUP^XQALERT  ;if no [new] recips don't send alert
"RTN","ORB3",110,0)
QUIT ;
"RTN","ORB3",111,0)
 K VA,VA200,VADM,VAERR,VAIN,XQA,XQADATA,XQAID,XQAFLG,XQAMSG,XQAROU,XQAARCH,XQASUPV,XQASURO,XQADFN
"RTN","ORB3",112,0)
 K ^XTMP("ORBUSER",$J)
"RTN","ORB3",113,0)
 I '$D(ORBU),$D(ORBLOCK) D
"RTN","ORB3",114,0)
 .I $G(ORBID)]"" LOCK -^XTMP("ORBLOCK",ORBDFN,ORN,ORBID)
"RTN","ORB3",115,0)
 .E  LOCK -^XTMP("ORBLOCK",ORBDFN,ORN)
"RTN","ORB3",116,0)
 Q
"RTN","ORB3",117,0)
PKGDUZS ;get DUZs from pkg-passed ORBADUZ() array
"RTN","ORB3",118,0)
 N ORBPDUZ
"RTN","ORB3",119,0)
 I $D(ORBU) D
"RTN","ORB3",120,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",121,0)
 .I ORN=68 S ORBU(ORBUI)="Recipients with Lab Threshold Exceeded:",ORBUI=ORBUI+1
"RTN","ORB3",122,0)
 .E  S ORBU(ORBUI)="Recipients defined when notif was triggered:",ORBUI=ORBUI+1
"RTN","ORB3",123,0)
 S ORBPDUZ=""
"RTN","ORB3",124,0)
 F  S ORBPDUZ=$O(ORBADUZ(ORBPDUZ)) Q:ORBPDUZ=""  S ORBDUZ=ORBPDUZ D USER
"RTN","ORB3",125,0)
 Q
"RTN","ORB3",126,0)
SPECDUZS ;get DUZs rtn by SPECIAL^ORB3SPEC
"RTN","ORB3",127,0)
 N ORBSDUZ
"RTN","ORB3",128,0)
 I $D(ORBU) D
"RTN","ORB3",129,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",130,0)
 .S ORBU(ORBUI)="Special recipients associated with the notification:",ORBUI=ORBUI+1
"RTN","ORB3",131,0)
 S ORBSDUZ=""
"RTN","ORB3",132,0)
 F  S ORBSDUZ=$O(ORBASPEC(ORBSDUZ)) Q:ORBSDUZ=""  S ORBDUZ=ORBSDUZ D USER
"RTN","ORB3",133,0)
 Q
"RTN","ORB3",134,0)
TITLE ;get provider recips
"RTN","ORB3",135,0)
 N TITLES
"RTN","ORB3",136,0)
 I $D(ORBU) D
"RTN","ORB3",137,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",138,0)
 .S ORBU(ORBUI)="Recipients determined by Provider Recipient parameter:",ORBUI=ORBUI+1
"RTN","ORB3",139,0)
 ;
"RTN","ORB3",140,0)
 S TITLES=$$GET^XPAR(ORBENT,"ORB PROVIDER RECIPIENTS",ORN,"I")
"RTN","ORB3",141,0)
 I TITLES["P" D PRIMARY
"RTN","ORB3",142,0)
 I TITLES["A" D ATTEND
"RTN","ORB3",143,0)
 I TITLES["T" D TEAMS
"RTN","ORB3",144,0)
 I TITLES["O" D ORDERER
"RTN","ORB3",145,0)
 I TITLES["E" D ENTERBY
"RTN","ORB3",146,0)
 I TITLES["R" D PCMMPRIM
"RTN","ORB3",147,0)
 I TITLES["S" D PCMMASSC
"RTN","ORB3",148,0)
 I TITLES["M" D PCMMTEAM
"RTN","ORB3",149,0)
 I TITLES["C" D PCMMMHTC
"RTN","ORB3",150,0)
 Q
"RTN","ORB3",151,0)
PRIMARY ;
"RTN","ORB3",152,0)
 I $D(ORBU),ORBADT=0 S ORBU(ORBUI)=" Inpt primary provider:",ORBUI=ORBUI+1
"RTN","ORB3",153,0)
 I $D(ORBU),ORBADT=1 S ORBU(ORBUI)=" Inpt primary provider: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3",154,0)
 I +$G(ORBPRIM)>0 S ORBDUZ=ORBPRIM D USER
"RTN","ORB3",155,0)
 Q
"RTN","ORB3",156,0)
ATTEND ;
"RTN","ORB3",157,0)
 I $D(ORBU),ORBADT=0 S ORBU(ORBUI)=" Attending physician:",ORBUI=ORBUI+1
"RTN","ORB3",158,0)
 I $D(ORBU),ORBADT=1 S ORBU(ORBUI)=" Attending physician: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3",159,0)
 I +$G(ORBATTD)>0 S ORBDUZ=ORBATTD D USER
"RTN","ORB3",160,0)
 Q
"RTN","ORB3",161,0)
TEAMS ;
"RTN","ORB3",162,0)
 I $D(ORBU) S ORBU(ORBUI)=" Teams/Personal Lists related to patient:",ORBUI=ORBUI+1
"RTN","ORB3",163,0)
 N ORBLST,ORBI,ORBJ,ORBTM,ORBTNAME,ORBTTYPE,ORBTD
"RTN","ORB3",164,0)
 D TMSPT^ORQPTQ1(.ORBLST,ORBDFN)
"RTN","ORB3",165,0)
 Q:+$G(ORBLST(1))<1
"RTN","ORB3",166,0)
 S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORB3",167,0)
 .S ORBTM=$P(ORBLST(ORBI),U),ORBTNAME=$P(ORBLST(ORBI),U,2)
"RTN","ORB3",168,0)
 .S ORBTTYPE=$P(ORBLST(ORBI),U,3)
"RTN","ORB3",169,0)
 .I $D(ORBU) D
"RTN","ORB3",170,0)
 ..S ORBU(ORBUI)="  Patient list "_ORBTNAME_" ["_ORBTTYPE_"]:",ORBUI=ORBUI+1
"RTN","ORB3",171,0)
 .N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBTM)
"RTN","ORB3",172,0)
 .Q:+$G(ORBLST2(1))<1
"RTN","ORB3",173,0)
 .S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORB3",174,0)
 ..S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBTM I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",175,0)
 .;
"RTN","ORB3",176,0)
 .S ORBTD=$P($$TMDEV^ORB31(ORBTM),U,2)  ;Team's device
"RTN","ORB3",177,0)
 .I $L(ORBTD) D
"RTN","ORB3",178,0)
 ..S ORBTDEV(ORBTD)=""
"RTN","ORB3",179,0)
 ..I $D(ORBU) D
"RTN","ORB3",180,0)
 ...S ORBU(ORBUI)="   Team's Device "_ORBTD_" is a recipient",ORBUI=ORBUI+1
"RTN","ORB3",181,0)
 Q
"RTN","ORB3",182,0)
ORDERER ;
"RTN","ORB3",183,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3",184,0)
 I $D(ORBU) S ORBU(ORBUI)=" Ordering provider:",ORBUI=ORBUI+1
"RTN","ORB3",185,0)
 N ORBLST,ORBI,ORBTM,ORBJ,ORBTNAME,ORBPLST,ORBPI,ORBPTM,ORBTTYPE
"RTN","ORB3",186,0)
 S ORBDUZ=$S(ORN=12:+$$UNSIGNOR^ORQOR2(ORNUM),1:$$ORDERER^ORQOR2(ORNUM))
"RTN","ORB3",187,0)
 I +$G(ORBDUZ)>0 D
"RTN","ORB3",188,0)
 .D USER
"RTN","ORB3",189,0)
 .;if notif = Order Req E/S (#12) or Order Req Co-sign (#37) and
"RTN","ORB3",190,0)
 .;user doesn't have ES authority, send to fellow team members w/ES:
"RTN","ORB3",191,0)
 .I ((ORN=12)!(ORN=37)),('$D(^XUSEC("ORES",ORBDUZ))) D
"RTN","ORB3",192,0)
 ..I $D(ORBU) S ORBU(ORBUI)=" Orderer can't elec sign, getting teams orderer belongs to:",ORBUI=ORBUI+1
"RTN","ORB3",193,0)
 ..D TEAMPR^ORQPTQ1(.ORBLST,ORBDUZ)  ;get orderer's tms
"RTN","ORB3",194,0)
 ..Q:+$G(ORBLST(1))<1
"RTN","ORB3",195,0)
 ..D TMSPT^ORQPTQ1(.ORBPLST,ORBDFN)  ;get pt's tms
"RTN","ORB3",196,0)
 ..Q:+$G(ORBPLST(1))<1
"RTN","ORB3",197,0)
 ..S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORB3",198,0)
 ...S ORBPI="" F  S ORBPI=$O(ORBPLST(ORBPI)) Q:ORBPI=""  D
"RTN","ORB3",199,0)
 ....S ORBTM=$P(ORBLST(ORBI),U),ORBPTM=$P(ORBPLST(ORBPI),U)
"RTN","ORB3",200,0)
 ....I ORBTM=ORBPTM D  ;if pt is on provider's team
"RTN","ORB3",201,0)
 .....I +$G(ORBPTM)>0 D
"RTN","ORB3",202,0)
 ......S ORBTNAME=$P(ORBPLST(ORBPI),U,2)
"RTN","ORB3",203,0)
 ......S ORBTTYPE=$P(ORBPLST(ORBPI),U,3)
"RTN","ORB3",204,0)
 ......I $D(ORBU) S ORBU(ORBUI)="  Orderer's pt list "_ORBTNAME_" ["_ORBTTYPE_"] recipients: ",ORBUI=ORBUI+1
"RTN","ORB3",205,0)
 ......N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBPTM)
"RTN","ORB3",206,0)
 ......Q:+$G(ORBLST2(1))<1
"RTN","ORB3",207,0)
 ......S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORB3",208,0)
 .......S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBPTM I +$G(ORBDUZ)>0,($D(^XUSEC("ORES",+ORBDUZ))) D USER
"RTN","ORB3",209,0)
 Q
"RTN","ORB3",210,0)
ENTERBY ;
"RTN","ORB3",211,0)
 I $D(ORBU) S ORBU(ORBUI)=" User entering order's most recent activity:",ORBUI=ORBUI+1
"RTN","ORB3",212,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3",213,0)
 I $D(^OR(100,ORNUM,8,0)) D
"RTN","ORB3",214,0)
 .S ORBDUZ=$P(^OR(100,ORNUM,8,$P(^OR(100,ORNUM,8,0),U,3),0),U,13)
"RTN","ORB3",215,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",216,0)
 Q
"RTN","ORB3",217,0)
PCMMPRIM ;
"RTN","ORB3",218,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Primary Care Practitioner:",ORBUI=ORBUI+1
"RTN","ORB3",219,0)
 S ORBDUZ=+$$OUTPTPR^SDUTL3(ORBDFN,$$NOW^XLFDT,1)  ;DBIA #1252
"RTN","ORB3",220,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",221,0)
 Q
"RTN","ORB3",222,0)
PCMMASSC ;
"RTN","ORB3",223,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Associate Provider:",ORBUI=ORBUI+1
"RTN","ORB3",224,0)
 S ORBDUZ=+$$OUTPTAP^SDUTL3(ORBDFN,$$NOW^XLFDT)  ;DBIA #1252
"RTN","ORB3",225,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",226,0)
 Q
"RTN","ORB3",227,0)
PCMMTEAM ;
"RTN","ORB3",228,0)
 N ORPCMM,ORPCMMDZ
"RTN","ORB3",229,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Team Position Assignments:",ORBUI=ORBUI+1
"RTN","ORB3",230,0)
 S ORPCMM=$$PRPT^SCAPMC(ORBDFN,,,,,,"^TMP(""ORPCMM"",$J)",)  ;DBIA #1916
"RTN","ORB3",231,0)
 S ORPCMMDZ=0
"RTN","ORB3",232,0)
 F  S ORPCMMDZ=$O(^TMP("ORPCMM",$J,"SCPR",ORPCMMDZ)) Q:'ORPCMMDZ  D
"RTN","ORB3",233,0)
 .S ORBDUZ=ORPCMMDZ D USER
"RTN","ORB3",234,0)
 K ^TMP("ORPCMM",$J)
"RTN","ORB3",235,0)
 Q
"RTN","ORB3",236,0)
PCMMMHTC ;
"RTN","ORB3",237,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Mental Health Treatment Coordinator:",ORBUI=ORBUI+1
"RTN","ORB3",238,0)
 S ORBDUZ=+$$START^SCMCMHTC(ORBDFN)  ;DBIA #5697
"RTN","ORB3",239,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",240,0)
 Q
"RTN","ORB3",241,0)
USER ;should USER (ORBDUZ) be a recip
"RTN","ORB3",242,0)
 D USER^ORB3USER(.XQA,ORBDUZ,ORN,.ORBU,.ORBUI,ORBDFN,+$G(ORNUM))
"RTN","ORB3",243,0)
 Q
"RTN","ORB3SPEC")
0^2^B93913902
"RTN","ORB3SPEC",1,0)
ORB3SPEC ; slc/CLA,TC - Support routine for ORB3 ; 2/24/12 8:10am
"RTN","ORB3SPEC",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**139,220,215,280,348**;Dec 17, 1997;Build 14
"RTN","ORB3SPEC",3,0)
SPECIAL(ORN,ORBASPEC,ORBU,ORBUI,ORNUM,ORDFN,ORDATA,ORBSMSG,ORBMSG,ORBSDEV,ORBPRIM,ORBATTD) ;
"RTN","ORB3SPEC",4,0)
 ;process special notifs to get recips (users,teams,devices)
"RTN","ORB3SPEC",5,0)
 ; ORN: notif ien
"RTN","ORB3SPEC",6,0)
 ; ORBASPEC: recip DUZ array
"RTN","ORB3SPEC",7,0)
 ; ORBU: recip debug array
"RTN","ORB3SPEC",8,0)
 ; ORBUI: ORBU cntr
"RTN","ORB3SPEC",9,0)
 ; ORNUM: order no
"RTN","ORB3SPEC",10,0)
 ; ORDFN: pt id
"RTN","ORB3SPEC",11,0)
 ; ORDATA: pkg data
"RTN","ORB3SPEC",12,0)
 ; ORBSMSG: special notif msg rtn by SPECIAL
"RTN","ORB3SPEC",13,0)
 ; ORBMSG: original notif msg
"RTN","ORB3SPEC",14,0)
 ; ORBSDEV: array of recip devices
"RTN","ORB3SPEC",15,0)
 ; ORBPRIM: pt's inpt primary care provider
"RTN","ORB3SPEC",16,0)
 ; ORBATTD: pt's attending physician
"RTN","ORB3SPEC",17,0)
 ;
"RTN","ORB3SPEC",18,0)
 N ORPAR,ORPTLOC
"RTN","ORB3SPEC",19,0)
 S ORPTLOC=$S($L($G(^DPT(ORDFN,.1))):"I",1:"O")  ;DBIA #10035
"RTN","ORB3SPEC",20,0)
 ;
"RTN","ORB3SPEC",21,0)
 I ORPTLOC="I" D  ;inpt flagged OI notifs
"RTN","ORB3SPEC",22,0)
 .I ORN=32 S ORPAR="ORB OI RESULTS - INPT" D OI
"RTN","ORB3SPEC",23,0)
 .I ORN=41 S ORPAR="ORB OI ORDERED - INPT" D OI
"RTN","ORB3SPEC",24,0)
 .I ORN=64 S ORPAR="ORB OI EXPIRING - INPT" D OI
"RTN","ORB3SPEC",25,0)
 ;
"RTN","ORB3SPEC",26,0)
 I ORPTLOC="O" D  ;outpt flagged OI notifs
"RTN","ORB3SPEC",27,0)
 .I ORN=60 S ORPAR="ORB OI RESULTS - OUTPT" D OI
"RTN","ORB3SPEC",28,0)
 .I ORN=61 S ORPAR="ORB OI ORDERED - OUTPT" D OI
"RTN","ORB3SPEC",29,0)
 .I ORN=65 S ORPAR="ORB OI EXPIRING - OUTPT" D OI
"RTN","ORB3SPEC",30,0)
 ;
"RTN","ORB3SPEC",31,0)
 I ORN=3!(ORN=14)!(ORN=44)!(ORN=57) D  ;lab results notifs
"RTN","ORB3SPEC",32,0)
 .D LRALRTS(ORN,ORDFN,ORDATA,.ORBSMSG,ORBMSG)
"RTN","ORB3SPEC",33,0)
 ;
"RTN","ORB3SPEC",34,0)
 I ORN=33 D  ;requested results notif
"RTN","ORB3SPEC",35,0)
 .I $D(ORBU) D
"RTN","ORB3SPEC",36,0)
 ..S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3SPEC",37,0)
 ..S ORBU(ORBUI)="Potential Orderer-flagged Results recipient: ",ORBUI=ORBUI+1
"RTN","ORB3SPEC",38,0)
 .N RECIP
"RTN","ORB3SPEC",39,0)
 .S RECIP=$$RSLTFLG^ORQOR2(ORNUM)
"RTN","ORB3SPEC",40,0)
 .I +$G(RECIP)>0 D
"RTN","ORB3SPEC",41,0)
 ..S ORBASPEC(+$G(RECIP))=""
"RTN","ORB3SPEC",42,0)
 ..I $D(ORBU) N NODE S NODE=$G(^VA(200,+$G(RECIP),0)) I $L(NODE) D
"RTN","ORB3SPEC",43,0)
 ...S ORBU(ORBUI)="   "_$P(NODE,U)_" is a potential recipient.",ORBUI=ORBUI+1
"RTN","ORB3SPEC",44,0)
 Q
"RTN","ORB3SPEC",45,0)
OI ;get potential recips for OI-flagged notifs
"RTN","ORB3SPEC",46,0)
 N OROI,ORLST,ORERR,ORBX,ORBZ,ORBE,ORBDUZ,ORBDEV,ORBUF
"RTN","ORB3SPEC",47,0)
 S OROI=+$G(^OR(100,+$G(ORNUM),.1,1,0))  ;get oi
"RTN","ORB3SPEC",48,0)
 Q:+$G(OROI)<0
"RTN","ORB3SPEC",49,0)
 I $D(ORBU) D
"RTN","ORB3SPEC",50,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3SPEC",51,0)
 .S ORBU(ORBUI)="Special potential recipients from parameter: "_ORPAR,ORBUI=ORBUI+1
"RTN","ORB3SPEC",52,0)
 S ORBE=0,ORBX=0
"RTN","ORB3SPEC",53,0)
 ;
"RTN","ORB3SPEC",54,0)
 ;process special recip users, teams and devices:
"RTN","ORB3SPEC",55,0)
 D ENVAL^XPAR(.ORLST,ORPAR,"`"_OROI,.ORERR)
"RTN","ORB3SPEC",56,0)
 I 'ORERR,$G(ORLST)>0 D
"RTN","ORB3SPEC",57,0)
 .F ORBX=1:1:ORLST S ORBE=$O(ORLST(ORBE)),ORBZ=$P(ORBE,";",2),ORBUF=0 D
"RTN","ORB3SPEC",58,0)
 ..;
"RTN","ORB3SPEC",59,0)
 ..; process USERS:
"RTN","ORB3SPEC",60,0)
 ..I ORBZ="VA(200," S ORBDUZ=$P(ORBE,";") I $L(ORBDUZ) D
"RTN","ORB3SPEC",61,0)
 ...I ORLST(ORBE,OROI)=1 S ORBASPEC(ORBDUZ)="",ORBUF=1
"RTN","ORB3SPEC",62,0)
 ...I ORLST(ORBE,OROI)=0,$$PPLINK^ORQPTQ1(ORBDUZ,ORDFN) S ORBASPEC(ORBDUZ)="",ORBUF=1
"RTN","ORB3SPEC",63,0)
 ...I $D(ORBU),ORBUF=1 N NODE S NODE=$G(^VA(200,ORBDUZ,0)) I $L(NODE) D
"RTN","ORB3SPEC",64,0)
 ....S ORBU(ORBUI)="   "_$P(NODE,U)_" is a potential recipient.",ORBUI=ORBUI+1
"RTN","ORB3SPEC",65,0)
 ..;
"RTN","ORB3SPEC",66,0)
 ..; process DEVICES:
"RTN","ORB3SPEC",67,0)
 ..I ORBZ="%ZIS(1," S ORBDEV=$P(ORBE,";") I $L(ORBDEV),$D(^%ZIS(1,ORBDEV))>0 D
"RTN","ORB3SPEC",68,0)
 ...S ORBDEV=$G(^%ZIS(1,ORBDEV,0)) I $D(ORBDEV) D
"RTN","ORB3SPEC",69,0)
 ....I ORLST(ORBE,OROI)=1 S ORBSDEV($P(ORBDEV,U))="",ORBUF=1
"RTN","ORB3SPEC",70,0)
 ....I ORLST(ORBE,OROI)=0,$$PDLINK^ORQPTQ1(ORBDEV,ORDFN) S ORBSDEV($P(ORBDEV,U))="",ORBUF=1
"RTN","ORB3SPEC",71,0)
 ....I $D(ORBU),ORBUF=1 D
"RTN","ORB3SPEC",72,0)
 .....S ORBU(ORBUI)="   "_$P(ORBDEV,U)_" is a device recipient.",ORBUI=ORBUI+1
"RTN","ORB3SPEC",73,0)
 ..;
"RTN","ORB3SPEC",74,0)
 ..; process TEAMS:
"RTN","ORB3SPEC",75,0)
 ..I ORBZ="OR(100.21," D SPECTEAM(ORBE)
"RTN","ORB3SPEC",76,0)
 D TITLE(OROI,ORPAR)
"RTN","ORB3SPEC",77,0)
 Q
"RTN","ORB3SPEC",78,0)
SPECTEAM(ORBE) ;get special team recips
"RTN","ORB3SPEC",79,0)
 N ORBLST,IJ,ORBTM
"RTN","ORB3SPEC",80,0)
 S ORBTM=$P(ORBE,";")
"RTN","ORB3SPEC",81,0)
 D TEAMPROV^ORQPTQ1(.ORBLST,ORBTM)
"RTN","ORB3SPEC",82,0)
 I $D(ORBU) N TNODE S TNODE=$G(^OR(100.21,ORBTM,0)) I $L(TNODE) D
"RTN","ORB3SPEC",83,0)
 .S ORBU(ORBUI)="   Team potential recipients from team "_$P(TNODE,U)_":",ORBUI=ORBUI+1
"RTN","ORB3SPEC",84,0)
 I +$G(ORBLST(1))>0 S IJ="" F  S IJ=$O(ORBLST(IJ)) Q:IJ=""  D
"RTN","ORB3SPEC",85,0)
 .S ORBDUZ=$P(ORBLST(IJ),U),ORBUF=0 I $L(ORBDUZ) D
"RTN","ORB3SPEC",86,0)
 ..I ORLST(ORBE,OROI)=1 S ORBASPEC(ORBDUZ_U_ORBTM)="",ORBUF=1
"RTN","ORB3SPEC",87,0)
 ..I ORLST(ORBE,OROI)=0,$D(^OR(100.21,ORBTM,10,"B",ORDFN_";DPT(")) S ORBASPEC(ORBDUZ_U_ORBTM)="",ORBUF=1
"RTN","ORB3SPEC",88,0)
 ..I $D(ORBU),ORBUF=1 N NODE S NODE=$G(^VA(200,ORBDUZ,0)) I $L(NODE) D
"RTN","ORB3SPEC",89,0)
 ...S ORBU(ORBUI)="     "_$P(NODE,U),ORBUI=ORBUI+1
"RTN","ORB3SPEC",90,0)
 ;
"RTN","ORB3SPEC",91,0)
 S ORBTD=$P($$TMDEV^ORB31(ORBTM),U,2)  ;tm's device
"RTN","ORB3SPEC",92,0)
 I $L(ORBTD) D
"RTN","ORB3SPEC",93,0)
 .S ORBSDEV(ORBTD)=""
"RTN","ORB3SPEC",94,0)
 .I $D(ORBU) D
"RTN","ORB3SPEC",95,0)
 ..S ORBU(ORBUI)="   Team's Device "_ORBTD_" is a recipient",ORBUI=ORBUI+1
"RTN","ORB3SPEC",96,0)
 Q
"RTN","ORB3SPEC",97,0)
LRALRTS(ORN,ORDFN,ORDATA,ORBSMSG,ORBMSG) ;find & delete matching alerts and gather recips
"RTN","ORB3SPEC",98,0)
 ; ORN: notif ien
"RTN","ORB3SPEC",99,0)
 ; ORDFN: pt id
"RTN","ORB3SPEC",100,0)
 ; ORDATA: pkg data
"RTN","ORB3SPEC",101,0)
 ; ORBSMSG: special notif msg rtn by LRALRTS
"RTN","ORB3SPEC",102,0)
 ; ORBMSG: original notif msg
"RTN","ORB3SPEC",103,0)
 ;
"RTN","ORB3SPEC",104,0)
 Q:+$G(ORN)<1
"RTN","ORB3SPEC",105,0)
 Q:+$G(ORDFN)<1
"RTN","ORB3SPEC",106,0)
 Q:+$G(ORDATA)<1
"RTN","ORB3SPEC",107,0)
 N LRID,ORY,I,J,XQAID,XQ0,XQ1,ORNE,RECIP,ORDATAE,LRIDE,STDATE
"RTN","ORB3SPEC",108,0)
 N ORTST,ORBMSGE,ORBMSGX,TXQAID,XQF,ORBHX,ORX,ORBI,ORTSTE
"RTN","ORB3SPEC",109,0)
 ;
"RTN","ORB3SPEC",110,0)
 S LRID=$P($P(ORDATA,"|",2),"@")  ;get lab unique results id (OE IDE)
"RTN","ORB3SPEC",111,0)
 Q:+$G(LRID)<1
"RTN","ORB3SPEC",112,0)
 ;
"RTN","ORB3SPEC",113,0)
 ;get pt's alerts within 24 hours:
"RTN","ORB3SPEC",114,0)
 S STDATE=$$FMADD^XLFDT($$NOW^XLFDT,"","-24","","")
"RTN","ORB3SPEC",115,0)
 D PATIENT^XQALERT("ORY",ORDFN,STDATE,"") ;get pt's alerts
"RTN","ORB3SPEC",116,0)
 ;
"RTN","ORB3SPEC",117,0)
 ;look for pt's alerts with same notif ien and unique lab results id:
"RTN","ORB3SPEC",118,0)
 F I=1:1:ORY D
"RTN","ORB3SPEC",119,0)
 .S XQAID=$P(ORY(I),U,2)
"RTN","ORB3SPEC",120,0)
 .S ORBMSGX=$P(ORY(I),U)
"RTN","ORB3SPEC",121,0)
 .S ORNE=$P($P(XQAID,";"),",",3)  ;get notif ien
"RTN","ORB3SPEC",122,0)
 .Q:ORNE'=ORN
"RTN","ORB3SPEC",123,0)
 .;
"RTN","ORB3SPEC",124,0)
 .;find matching alert:
"RTN","ORB3SPEC",125,0)
 .D AHISTORY^XQALBUTL(XQAID,"ORBHX")
"RTN","ORB3SPEC",126,0)
 .S ORDATAE=$G(ORBHX(2))
"RTN","ORB3SPEC",127,0)
 .Q:'$L(ORDATAE)
"RTN","ORB3SPEC",128,0)
 .S LRIDE=$P($P(ORDATAE,"|",2),"@")  ;get lab rslts id from existng alert
"RTN","ORB3SPEC",129,0)
 .Q:LRIDE'=LRID
"RTN","ORB3SPEC",130,0)
 .;
"RTN","ORB3SPEC",131,0)
 .S:ORBMSG["[" ORTST=$P($P(ORBMSG,"[",2),"]")
"RTN","ORB3SPEC",132,0)
 .I ORBMSG'["[" D
"RTN","ORB3SPEC",133,0)
 ..S:ORBMSG["labs: " ORTST=$P(ORBMSG,"labs: ",2)
"RTN","ORB3SPEC",134,0)
 ..S:ORBMSG["results: " ORTST=$P(ORBMSG,"results: ",2)
"RTN","ORB3SPEC",135,0)
 .;
"RTN","ORB3SPEC",136,0)
 .S ORBMSGE=$P(ORBMSGX,"): ",2)
"RTN","ORB3SPEC",137,0)
 .S:ORBMSGE["[" ORTSTE=$P($P(ORBMSGE,"[",2),"]")  ;added to fix CQ #17548 (Part A) for CPRS v28.1 (TC).
"RTN","ORB3SPEC",138,0)
 .;added to fix CQ #19497: undefined ORTSTE variable [v28.17] (TC)
"RTN","ORB3SPEC",139,0)
 .I ORBMSGE'["[" D
"RTN","ORB3SPEC",140,0)
 ..S:ORBMSGE["labs: " ORTSTE=$P(ORBMSGE,"labs: ",2)
"RTN","ORB3SPEC",141,0)
 ..S:ORBMSGE["results: " ORTSTE=$P(ORBMSGE,"results: ",2)
"RTN","ORB3SPEC",142,0)
 .E  S ORTSTE=""
"RTN","ORB3SPEC",143,0)
 .;
"RTN","ORB3SPEC",144,0)
 .S ORX=0
"RTN","ORB3SPEC",145,0)
 .;if alert has recips, get recips from existing alert:
"RTN","ORB3SPEC",146,0)
 .S:$L($G(ORBHX(20,0))) ORX=$P(ORBHX(20,0),U,4)
"RTN","ORB3SPEC",147,0)
 .F ORBI=1:1:ORX D
"RTN","ORB3SPEC",148,0)
 ..S RECIP=+ORBHX(20,ORBI,0)
"RTN","ORB3SPEC",149,0)
 ..S ORBASPEC(RECIP)=""  ;add recip to new alert recip list
"RTN","ORB3SPEC",150,0)
 .;
"RTN","ORB3SPEC",151,0)
 .;delete existing alert:
"RTN","ORB3SPEC",152,0)
 .S XQAKILL=0  ;delete for all recips
"RTN","ORB3SPEC",153,0)
 .D DELETE^XQALERT
"RTN","ORB3SPEC",154,0)
 .K XQAKILL,XQAID
"RTN","ORB3SPEC",155,0)
 ;
"RTN","ORB3SPEC",156,0)
 ;if NO prev alert msg for this pt, notif, lab unique id:
"RTN","ORB3SPEC",157,0)
 I '$L($G(ORBMSGE)) S ORBSMSG=ORBMSG
"RTN","ORB3SPEC",158,0)
 ;
"RTN","ORB3SPEC",159,0)
 ;if prev alert msg for this pt, notif, lab unique id:
"RTN","ORB3SPEC",160,0)
 I $L($G(ORBMSGE)) D
"RTN","ORB3SPEC",161,0)
 .;S:ORBMSGE["[" ORBSMSG=$P(ORBMSGE,"]")_", "_ORTST_"]"
"RTN","ORB3SPEC",162,0)
 .S ORBSMSG=$S(ORBMSGE["["&(ORTSTE'=ORTST):$P(ORBMSGE,"]")_", "_ORTST_"]",(ORBMSGE'["[")&(ORTSTE'=ORTST):ORBMSGE_", "_ORTST,1:ORBMSGE) ;added to fix CQ #17548 (Part A) for CPRS v28.1 (TC).
"RTN","ORB3SPEC",163,0)
 .;S:ORBMSGE'["[" ORBSMSG=ORBMSGE_", "_ORTST
"RTN","ORB3SPEC",164,0)
 ;
"RTN","ORB3SPEC",165,0)
 Q
"RTN","ORB3SPEC",166,0)
 ;
"RTN","ORB3SPEC",167,0)
TITLE(OROI,ORPAR) ;get provider recips
"RTN","ORB3SPEC",168,0)
 N ORTIT
"RTN","ORB3SPEC",169,0)
 I $D(ORBU) D
"RTN","ORB3SPEC",170,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3SPEC",171,0)
 .S ORBU(ORBUI)="Special potential recipients from parameter: "_ORPAR_" PR",ORBUI=ORBUI+1
"RTN","ORB3SPEC",172,0)
 ;
"RTN","ORB3SPEC",173,0)
 ;process special recip users, teams and devices for Provider Recipients
"RTN","ORB3SPEC",174,0)
 S ORTIT=$$GET^XPAR("ALL",ORPAR_" PR","`"_OROI,"E")
"RTN","ORB3SPEC",175,0)
 Q:'$L(ORTIT)
"RTN","ORB3SPEC",176,0)
 I ORTIT["P" D PRIMARY
"RTN","ORB3SPEC",177,0)
 I ORTIT["A" D ATTEND
"RTN","ORB3SPEC",178,0)
 I ORTIT["T" D TEAMS
"RTN","ORB3SPEC",179,0)
 I ORTIT["O" D ORDERER
"RTN","ORB3SPEC",180,0)
 I ORTIT["E" D ENTERBY
"RTN","ORB3SPEC",181,0)
 I ORTIT["R" D PCMMPRIM
"RTN","ORB3SPEC",182,0)
 I ORTIT["S" D PCMMASSC
"RTN","ORB3SPEC",183,0)
 I ORTIT["M" D PCMMTEAM
"RTN","ORB3SPEC",184,0)
 I ORTIT["C" D PCMMMHTC
"RTN","ORB3SPEC",185,0)
 Q
"RTN","ORB3SPEC",186,0)
PRIMARY ;
"RTN","ORB3SPEC",187,0)
 I $D(ORBU),+$G(ORBPRIM)>0 S ORBU(ORBUI)=" Flagged OI Inpt primary provider:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",188,0)
 I $D(ORBU),+$G(ORBPRIM)<1 S ORBU(ORBUI)=" Flagged OI Inpt primary provider: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3SPEC",189,0)
 I +$G(ORBPRIM)>0 S ORBASPEC(ORBPRIM)=""
"RTN","ORB3SPEC",190,0)
 Q
"RTN","ORB3SPEC",191,0)
ATTEND ;
"RTN","ORB3SPEC",192,0)
 I $D(ORBU),+$G(ORBATTD)>0 S ORBU(ORBUI)=" Flagged OI Attending physician:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",193,0)
 I $D(ORBU),+$G(ORBATTD)<1 S ORBU(ORBUI)=" Flagged OI Attending physician: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3SPEC",194,0)
 I +$G(ORBATTD)>0 S ORBASPEC(ORBATTD)=""
"RTN","ORB3SPEC",195,0)
 Q
"RTN","ORB3SPEC",196,0)
TEAMS ;
"RTN","ORB3SPEC",197,0)
 N ORBLST,ORBI,ORBJ,ORBTM,ORBTNAME,ORBTTYPE,ORBTD
"RTN","ORB3SPEC",198,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI Teams/Personal Lists related to patient:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",199,0)
 D TMSPT^ORQPTQ1(.ORBLST,ORDFN)
"RTN","ORB3SPEC",200,0)
 Q:+$G(ORBLST(1))<1
"RTN","ORB3SPEC",201,0)
 S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORB3SPEC",202,0)
 .S ORBTM=$P(ORBLST(ORBI),U),ORBTNAME=$P(ORBLST(ORBI),U,2)
"RTN","ORB3SPEC",203,0)
 .S ORBTTYPE=$P(ORBLST(ORBI),U,3)
"RTN","ORB3SPEC",204,0)
 .I $D(ORBU) D
"RTN","ORB3SPEC",205,0)
 ..S ORBU(ORBUI)="  Patient list "_ORBTNAME_" ["_ORBTTYPE_"]:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",206,0)
 .N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBTM)
"RTN","ORB3SPEC",207,0)
 .Q:+$G(ORBLST2(1))<1
"RTN","ORB3SPEC",208,0)
 .S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORB3SPEC",209,0)
 ..S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBTM I +$G(ORBDUZ)>0 S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",210,0)
 .S ORBTD=$P($$TMDEV^ORB31(ORBTM),U,2)  ;tm's device
"RTN","ORB3SPEC",211,0)
 .I $L(ORBTD) D
"RTN","ORB3SPEC",212,0)
 ..S ORBSDEV(ORBTD)=""
"RTN","ORB3SPEC",213,0)
 ..I $D(ORBU) D
"RTN","ORB3SPEC",214,0)
 ...S ORBU(ORBUI)="   Team's Device "_ORBTD_" is a recipient",ORBUI=ORBUI+1
"RTN","ORB3SPEC",215,0)
 Q
"RTN","ORB3SPEC",216,0)
ORDERER ;
"RTN","ORB3SPEC",217,0)
 N ORBDUZ
"RTN","ORB3SPEC",218,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI Ordering provider:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",219,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3SPEC",220,0)
 S ORBDUZ=$$ORDERER^ORQOR2(ORNUM)
"RTN","ORB3SPEC",221,0)
 I +$G(ORBDUZ)>0 D
"RTN","ORB3SPEC",222,0)
 .S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",223,0)
 Q
"RTN","ORB3SPEC",224,0)
ENTERBY ;
"RTN","ORB3SPEC",225,0)
 N ORBDUZ
"RTN","ORB3SPEC",226,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI User entering order's most recent activity:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",227,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3SPEC",228,0)
 I $D(^OR(100,ORNUM,8,0)) D
"RTN","ORB3SPEC",229,0)
 .S ORBDUZ=$P(^OR(100,ORNUM,8,$P(^OR(100,ORNUM,8,0),U,3),0),U,13)
"RTN","ORB3SPEC",230,0)
 I +$G(ORBDUZ)>0 S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",231,0)
 Q
"RTN","ORB3SPEC",232,0)
PCMMPRIM ;
"RTN","ORB3SPEC",233,0)
 N ORBDUZ
"RTN","ORB3SPEC",234,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI PCMM Primary Care Practitioner:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",235,0)
 S ORBDUZ=+$$OUTPTPR^SDUTL3(ORDFN,$$NOW^XLFDT,1)  ;DBIA #1252
"RTN","ORB3SPEC",236,0)
 I +$G(ORBDUZ)>0 S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",237,0)
 Q
"RTN","ORB3SPEC",238,0)
PCMMASSC ;
"RTN","ORB3SPEC",239,0)
 N ORBDUZ
"RTN","ORB3SPEC",240,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI PCMM Associate Provider:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",241,0)
 S ORBDUZ=+$$OUTPTAP^SDUTL3(ORDFN,$$NOW^XLFDT)  ;DBIA #1252
"RTN","ORB3SPEC",242,0)
 I +$G(ORBDUZ)>0 S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",243,0)
 Q
"RTN","ORB3SPEC",244,0)
PCMMTEAM ;
"RTN","ORB3SPEC",245,0)
 N ORPCMM,ORPCMMDZ,ORBDUZ
"RTN","ORB3SPEC",246,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI PCMM Team Position Assignments:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",247,0)
 S ORPCMM=$$PRPT^SCAPMC(ORDFN,,,,,,"^TMP(""ORPCMM"",$J)",)  ;DBIA #1916
"RTN","ORB3SPEC",248,0)
 S ORPCMMDZ=0
"RTN","ORB3SPEC",249,0)
 F  S ORPCMMDZ=$O(^TMP("ORPCMM",$J,"SCPR",ORPCMMDZ)) Q:'ORPCMMDZ  D
"RTN","ORB3SPEC",250,0)
 .S ORBDUZ=ORPCMMDZ S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",251,0)
 K ^TMP("ORPCMM",$J)
"RTN","ORB3SPEC",252,0)
 Q
"RTN","ORB3SPEC",253,0)
PCMMMHTC ;
"RTN","ORB3SPEC",254,0)
 N ORBDUZ
"RTN","ORB3SPEC",255,0)
 I $D(ORBU) S ORBU(ORBUI)=" Flagged OI PCMM Mental Health Treatment Coordinator:",ORBUI=ORBUI+1
"RTN","ORB3SPEC",256,0)
 S ORBDUZ=+$$START^SCMCMHTC(ORBDFN)  ;DBIA #5697
"RTN","ORB3SPEC",257,0)
 I +$G(ORBDUZ)>0 S ORBASPEC(ORBDUZ)=""
"RTN","ORB3SPEC",258,0)
 Q
"RTN","ORBINPTR")
0^5^B1813250
"RTN","ORBINPTR",1,0)
ORBINPTR ;SLC/TC - Input transforms for OE/RR Notifications ;10/30/12  08:02
"RTN","ORBINPTR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**348**;Dec 17, 1997;Build 14
"RTN","ORBINPTR",3,0)
 ;
"RTN","ORBINPTR",4,0)
 ;
"RTN","ORBINPTR",5,0)
VALNUM(X) ; Called by input transform of ^DD(100.9,.001,0), Number field
"RTN","ORBINPTR",6,0)
 N VALID,LSTREC S VALID=1,LSTREC=$P($G(^ORD(100.9,0)),U,3)
"RTN","ORBINPTR",7,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q VALID
"RTN","ORBINPTR",8,0)
 I DUZ(0)'="@" S VALID=0 Q VALID  ; No access to create notifications
"RTN","ORBINPTR",9,0)
 I X<10101 S VALID=0 Q VALID  ;Numbers 1-9999 are reserved for National notifications
"RTN","ORBINPTR",10,0)
 I $L(X)=5 D
"RTN","ORBINPTR",11,0)
 . N LSTNUM,EXPNUM
"RTN","ORBINPTR",12,0)
 . S LSTNUM=$S($L(LSTREC)=5&($E(LSTREC,1,3)=+$$SITE^VASITE):$E(LSTREC,4,5),1:"")
"RTN","ORBINPTR",13,0)
 . S EXPNUM=$S('$L(LSTNUM):(+$$SITE^VASITE)_"01",1:(LSTREC+1))
"RTN","ORBINPTR",14,0)
 . I ($E(X,1,3)'=(+$$SITE^VASITE))&($E(X,4,5)'=(LSTNUM+1)) D
"RTN","ORBINPTR",15,0)
 . . S VALID=0 D EN^DDIOL("Invalid number scheme. Expecting number "_EXPNUM_".")
"RTN","ORBINPTR",16,0)
 Q VALID
"RTN","ORBPRCHK")
0^3^B32589157
"RTN","ORBPRCHK",1,0)
ORBPRCHK ; SLC/JMH,TC - API to return who gets notifications TAKEN FROM ORB3; ; 2/24/12 8:11am
"RTN","ORBPRCHK",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**243,348**;Dec 17, 1997;Build 14
"RTN","ORBPRCHK",3,0)
CHECK(ORPERS,ORNUM,ORN,ORBDFN) ; returns 1 if ORPERS should get the alert
"RTN","ORBPRCHK",4,0)
 N ORRET,ORY
"RTN","ORBPRCHK",5,0)
 D START(.ORRET,ORNUM,ORN,ORBDFN)
"RTN","ORBPRCHK",6,0)
 S ORY=$S($D(ORRET(ORPERS)):1,1:0)
"RTN","ORBPRCHK",7,0)
 Q ORY
"RTN","ORBPRCHK",8,0)
START(ORRET,ORNUM,ORN,ORBDFN) ;
"RTN","ORBPRCHK",9,0)
 Q:$G(ORN)=""!($G(ORBDFN)="")
"RTN","ORBPRCHK",10,0)
 Q:'$L($G(^ORD(100.9,ORN,0)))
"RTN","ORBPRCHK",11,0)
 N ORBNOW,ORBID,ORBLOCK,ORBDESC
"RTN","ORBPRCHK",12,0)
 S ORBNOW=$$NOW^XLFDT
"RTN","ORBPRCHK",13,0)
 N ORBDUZ,ORBN,ORBXQAID,ORPTNAM,ORBPRIM,ORBATTD,ORBDEV,ORBENT
"RTN","ORBPRCHK",14,0)
 N XQA,VAIN,VADM,DIC,ORBPDATA,ORBPMSG,VA,VA200,VAERR,X,Y
"RTN","ORBPRCHK",15,0)
 N ORBUI,ORBASPEC,ORBSMSG,ORBADT,ORBSDEV,ORBDEL,ORBDI,ORBTDEV,ORY
"RTN","ORBPRCHK",16,0)
 S ORBUI=1,ORBADT=0
"RTN","ORBPRCHK",17,0)
 S:'$L($G(ORBPMSG)) ORBPMSG=""
"RTN","ORBPRCHK",18,0)
 S ORBPDATA=+$G(ORNUM)_"@"
"RTN","ORBPRCHK",19,0)
 S ORBN=^ORD(100.9,ORN,0)
"RTN","ORBPRCHK",20,0)
 ;
"RTN","ORBPRCHK",21,0)
 S ORBENT=$$ENTITY^ORB31(ORNUM)
"RTN","ORBPRCHK",22,0)
 D REGULAR^ORB3REG(ORN,.XQA,.ORBU,.ORBUI,.ORBDEV,ORBDFN)
"RTN","ORBPRCHK",23,0)
 D SPECIAL^ORB3SPEC(ORN,.ORBASPEC,.ORBU,.ORBUI,$G(ORNUM),ORBDFN,$G(ORBPDATA),.ORBSMSG,$G(ORBPMSG),.ORBSDEV,$G(ORBPRIM),$G(ORBATTD))
"RTN","ORBPRCHK",24,0)
 I $D(ORBASPEC)>1 D SPECDUZS ;special recips
"RTN","ORBPRCHK",25,0)
 I $D(ORBADUZ)>1 D PKGDUZS ;pkg-supplied recips
"RTN","ORBPRCHK",26,0)
 D TITLE ;provider recips
"RTN","ORBPRCHK",27,0)
 M ORRET=XQA
"RTN","ORBPRCHK",28,0)
 Q
"RTN","ORBPRCHK",29,0)
PKGDUZS ;get DUZs from pkg-passed ORBADUZ() array
"RTN","ORBPRCHK",30,0)
 N ORBPDUZ
"RTN","ORBPRCHK",31,0)
 S ORBPDUZ=""
"RTN","ORBPRCHK",32,0)
 F  S ORBPDUZ=$O(ORBADUZ(ORBPDUZ)) Q:ORBPDUZ=""  S ORBDUZ=ORBPDUZ D USER
"RTN","ORBPRCHK",33,0)
 Q
"RTN","ORBPRCHK",34,0)
SPECDUZS ;get DUZs rtn by SPECIAL^ORB3SPEC
"RTN","ORBPRCHK",35,0)
 N ORBSDUZ
"RTN","ORBPRCHK",36,0)
 S ORBSDUZ=""
"RTN","ORBPRCHK",37,0)
 F  S ORBSDUZ=$O(ORBASPEC(ORBSDUZ)) Q:ORBSDUZ=""  S ORBDUZ=ORBSDUZ D USER
"RTN","ORBPRCHK",38,0)
 Q
"RTN","ORBPRCHK",39,0)
TITLE ;get provider recips
"RTN","ORBPRCHK",40,0)
 N TITLES
"RTN","ORBPRCHK",41,0)
 S TITLES=$$GET^XPAR(ORBENT,"ORB PROVIDER RECIPIENTS",ORN,"I")
"RTN","ORBPRCHK",42,0)
 I TITLES["P" D PRIMARY
"RTN","ORBPRCHK",43,0)
 I TITLES["A" D ATTEND
"RTN","ORBPRCHK",44,0)
 I TITLES["T" D TEAMS
"RTN","ORBPRCHK",45,0)
 I TITLES["O" D ORDERER
"RTN","ORBPRCHK",46,0)
 I TITLES["E" D ENTERBY
"RTN","ORBPRCHK",47,0)
 I TITLES["R" D PCMMPRIM
"RTN","ORBPRCHK",48,0)
 I TITLES["S" D PCMMASSC
"RTN","ORBPRCHK",49,0)
 I TITLES["M" D PCMMTEAM
"RTN","ORBPRCHK",50,0)
 I TITLES["C" D PCMMMHTC
"RTN","ORBPRCHK",51,0)
 Q
"RTN","ORBPRCHK",52,0)
PRIMARY ;
"RTN","ORBPRCHK",53,0)
 I +$G(ORBPRIM)>0 S ORBDUZ=ORBPRIM D USER
"RTN","ORBPRCHK",54,0)
 Q
"RTN","ORBPRCHK",55,0)
ATTEND ;
"RTN","ORBPRCHK",56,0)
 I +$G(ORBATTD)>0 S ORBDUZ=ORBATTD D USER
"RTN","ORBPRCHK",57,0)
 Q
"RTN","ORBPRCHK",58,0)
TEAMS ;
"RTN","ORBPRCHK",59,0)
 N ORBLST,ORBI,ORBJ,ORBTM,ORBTNAME,ORBTTYPE,ORBTD
"RTN","ORBPRCHK",60,0)
 D TMSPT^ORQPTQ1(.ORBLST,ORBDFN)
"RTN","ORBPRCHK",61,0)
 Q:+$G(ORBLST(1))<1
"RTN","ORBPRCHK",62,0)
 S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORBPRCHK",63,0)
 .S ORBTM=$P(ORBLST(ORBI),U),ORBTNAME=$P(ORBLST(ORBI),U,2)
"RTN","ORBPRCHK",64,0)
 .S ORBTTYPE=$P(ORBLST(ORBI),U,3)
"RTN","ORBPRCHK",65,0)
 .I $D(ORBU) D
"RTN","ORBPRCHK",66,0)
 ..S ORBU(ORBUI)="  Patient list "_ORBTNAME_" ["_ORBTTYPE_"]:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",67,0)
 .N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBTM)
"RTN","ORBPRCHK",68,0)
 .Q:+$G(ORBLST2(1))<1
"RTN","ORBPRCHK",69,0)
 .S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORBPRCHK",70,0)
 ..S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBTM I +$G(ORBDUZ)>0 D USER
"RTN","ORBPRCHK",71,0)
 .;
"RTN","ORBPRCHK",72,0)
 .S ORBTD=$P($$TMDEV^ORB31(ORBTM),U,2)  ;Team's device
"RTN","ORBPRCHK",73,0)
 .I $L(ORBTD) D
"RTN","ORBPRCHK",74,0)
 ..S ORBTDEV(ORBTD)=""
"RTN","ORBPRCHK",75,0)
 ..I $D(ORBU) D
"RTN","ORBPRCHK",76,0)
 ...S ORBU(ORBUI)="   Team's Device "_ORBTD_" is a recipient",ORBUI=ORBUI+1
"RTN","ORBPRCHK",77,0)
 Q
"RTN","ORBPRCHK",78,0)
ORDERER ;
"RTN","ORBPRCHK",79,0)
 Q:+$G(ORNUM)<1
"RTN","ORBPRCHK",80,0)
 I $D(ORBU) S ORBU(ORBUI)=" Ordering provider:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",81,0)
 N ORBLST,ORBI,ORBTM,ORBJ,ORBTNAME,ORBPLST,ORBPI,ORBPTM,ORBTTYPE
"RTN","ORBPRCHK",82,0)
 S ORBDUZ=$S(ORN=12:+$$UNSIGNOR^ORQOR2(ORNUM),1:$$ORDERER^ORQOR2(ORNUM))
"RTN","ORBPRCHK",83,0)
 I +$G(ORBDUZ)>0 D
"RTN","ORBPRCHK",84,0)
 .D USER
"RTN","ORBPRCHK",85,0)
 .;if notif = Order Req E/S (#12) or Order Req Co-sign (#37) and
"RTN","ORBPRCHK",86,0)
 .;user doesn't have ES authority, send to fellow team members w/ES:
"RTN","ORBPRCHK",87,0)
 .I ((ORN=12)!(ORN=37)),('$D(^XUSEC("ORES",ORBDUZ))) D
"RTN","ORBPRCHK",88,0)
 ..I $D(ORBU) S ORBU(ORBUI)=" Orderer can't elec sign, getting teams orderer belongs to:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",89,0)
 ..D TEAMPR^ORQPTQ1(.ORBLST,ORBDUZ)  ;get orderer's tms
"RTN","ORBPRCHK",90,0)
 ..Q:+$G(ORBLST(1))<1
"RTN","ORBPRCHK",91,0)
 ..D TMSPT^ORQPTQ1(.ORBPLST,ORBDFN)  ;get pt's tms
"RTN","ORBPRCHK",92,0)
 ..Q:+$G(ORBPLST(1))<1
"RTN","ORBPRCHK",93,0)
 ..S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORBPRCHK",94,0)
 ...S ORBPI="" F  S ORBPI=$O(ORBPLST(ORBPI)) Q:ORBPI=""  D
"RTN","ORBPRCHK",95,0)
 ....S ORBTM=$P(ORBLST(ORBI),U),ORBPTM=$P(ORBPLST(ORBPI),U)
"RTN","ORBPRCHK",96,0)
 ....I ORBTM=ORBPTM D  ;if pt is on provider's team
"RTN","ORBPRCHK",97,0)
 .....I +$G(ORBPTM)>0 D
"RTN","ORBPRCHK",98,0)
 ......S ORBTNAME=$P(ORBPLST(ORBPI),U,2)
"RTN","ORBPRCHK",99,0)
 ......S ORBTTYPE=$P(ORBPLST(ORBPI),U,3)
"RTN","ORBPRCHK",100,0)
 ......I $D(ORBU) S ORBU(ORBUI)="  Orderer's pt list "_ORBTNAME_" ["_ORBTTYPE_"] recipients: ",ORBUI=ORBUI+1
"RTN","ORBPRCHK",101,0)
 ......N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBPTM)
"RTN","ORBPRCHK",102,0)
 ......Q:+$G(ORBLST2(1))<1
"RTN","ORBPRCHK",103,0)
 ......S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORBPRCHK",104,0)
 .......S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBPTM I +$G(ORBDUZ)>0,($D(^XUSEC("ORES",+ORBDUZ))) D USER
"RTN","ORBPRCHK",105,0)
 Q
"RTN","ORBPRCHK",106,0)
ENTERBY ;
"RTN","ORBPRCHK",107,0)
 I $D(ORBU) S ORBU(ORBUI)=" User entering order's most recent activity:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",108,0)
 Q:+$G(ORNUM)<1
"RTN","ORBPRCHK",109,0)
 I $D(^OR(100,ORNUM,8,0)) D
"RTN","ORBPRCHK",110,0)
 .S ORBDUZ=$P(^OR(100,ORNUM,8,$P(^OR(100,ORNUM,8,0),U,3),0),U,13)
"RTN","ORBPRCHK",111,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORBPRCHK",112,0)
 Q
"RTN","ORBPRCHK",113,0)
PCMMPRIM ;
"RTN","ORBPRCHK",114,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Primary Care Practitioner:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",115,0)
 S ORBDUZ=+$$OUTPTPR^SDUTL3(ORBDFN,$$NOW^XLFDT,1)  ;DBIA #1252
"RTN","ORBPRCHK",116,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORBPRCHK",117,0)
 Q
"RTN","ORBPRCHK",118,0)
PCMMASSC ;
"RTN","ORBPRCHK",119,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Associate Provider:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",120,0)
 S ORBDUZ=+$$OUTPTAP^SDUTL3(ORBDFN,$$NOW^XLFDT)  ;DBIA #1252
"RTN","ORBPRCHK",121,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORBPRCHK",122,0)
 Q
"RTN","ORBPRCHK",123,0)
PCMMTEAM ;
"RTN","ORBPRCHK",124,0)
 N ORPCMM,ORPCMMDZ
"RTN","ORBPRCHK",125,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Team Position Assignments:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",126,0)
 S ORPCMM=$$PRPT^SCAPMC(ORBDFN,,,,,,"^TMP(""ORPCMM"",$J)",)  ;DBIA #1916
"RTN","ORBPRCHK",127,0)
 S ORPCMMDZ=0
"RTN","ORBPRCHK",128,0)
 F  S ORPCMMDZ=$O(^TMP("ORPCMM",$J,"SCPR",ORPCMMDZ)) Q:'ORPCMMDZ  D
"RTN","ORBPRCHK",129,0)
 .S ORBDUZ=ORPCMMDZ D USER
"RTN","ORBPRCHK",130,0)
 K ^TMP("ORPCMM",$J)
"RTN","ORBPRCHK",131,0)
 Q
"RTN","ORBPRCHK",132,0)
PCMMMHTC ;
"RTN","ORBPRCHK",133,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Mental Health Treatment Coordinator:",ORBUI=ORBUI+1
"RTN","ORBPRCHK",134,0)
 S ORBDUZ=+$$START^SCMCMHTC(ORBDFN)  ;DBIA #5697
"RTN","ORBPRCHK",135,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORBPRCHK",136,0)
 Q
"RTN","ORBPRCHK",137,0)
USER ;should USER (ORBDUZ) be a recip
"RTN","ORBPRCHK",138,0)
 I $P($$ONOFF^ORB3USER(ORN,+ORBDUZ,ORBDFN,,ORNUM),U)="ON" S XQA(+ORBDUZ)=""
"RTN","ORBPRCHK",139,0)
 Q
"RTN","ORY348")
0^4^B13557254
"RTN","ORY348",1,0)
ORY348 ;SLC/TC - Post-install for patch OR*3*348 ;05/07/12  07:35
"RTN","ORY348",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**348**;Dec 17, 1997;Build 14
"RTN","ORY348",3,0)
 ;
"RTN","ORY348",4,0)
 ;   ICR #2053   UPDATE^DIE
"RTN","ORY348",5,0)
 ;   ICR #2263   EN^XPAR
"RTN","ORY348",6,0)
 ;   ICR #10013  ^DIK
"RTN","ORY348",7,0)
 ;   ICR #10141  MES^XPDUTL
"RTN","ORY348",8,0)
 ;
"RTN","ORY348",9,0)
POST ; Initiate post-init processes
"RTN","ORY348",10,0)
 ;
"RTN","ORY348",11,0)
 D ADDNOT
"RTN","ORY348",12,0)
 D NOTPARAM
"RTN","ORY348",13,0)
 Q
"RTN","ORY348",14,0)
 ;
"RTN","ORY348",15,0)
ADDNOT ; Add Suicide Attempted/Completed Notification to OE/RR Notifications File
"RTN","ORY348",16,0)
 N DA,DIK,ORFDA,ORIEN,ORMSG
"RTN","ORY348",17,0)
 S DIK="^ORD(100.9,",DA=77 D ^DIK
"RTN","ORY348",18,0)
 S ORFDA(1,100.9,"+1,",.01)="SUICIDE ATTEMPTED/COMPLETED"
"RTN","ORY348",19,0)
 S ORFDA(1,100.9,"+1,",.02)="OR"
"RTN","ORY348",20,0)
 S ORFDA(1,100.9,"+1,",.03)="Suicide Attempted/Completed."
"RTN","ORY348",21,0)
 S ORFDA(1,100.9,"+1,",.04)="PKG"
"RTN","ORY348",22,0)
 S ORFDA(1,100.9,"+1,",.05)="R"
"RTN","ORY348",23,0)
 S ORFDA(1,100.9,"+1,",.06)="INFODEL"
"RTN","ORY348",24,0)
 S ORFDA(1,100.9,"+1,",.07)="ORB3FUP2"
"RTN","ORY348",25,0)
 S ORFDA(1,100.9,"+1,",1.5)="PXRM"
"RTN","ORY348",26,0)
 S ORFDA(1,100.9,"+1,",4)="Triggered by Clinical Reminders when a MH SUICIDE ATTEMPTED or MH SUICIDE COMPLETED health factor has been documented in PCE. Recipients include MHTC and Teams. Deletion occurs for individual recipient."
"RTN","ORY348",27,0)
 S ORIEN(1)=77
"RTN","ORY348",28,0)
 D UPDATE^DIE("","ORFDA(1)","ORIEN","ORMSG")
"RTN","ORY348",29,0)
 I $D(ORMSG)>0 D ERRMSG("ORMSG")
"RTN","ORY348",30,0)
 Q
"RTN","ORY348",31,0)
 ;
"RTN","ORY348",32,0)
ERRMSG(REF) ; Output and display any error messages as a result of new record entry
"RTN","ORY348",33,0)
 ;Write all the descendants of the array reference.
"RTN","ORY348",34,0)
 ;REF is the starting array reference, for example A or ^TMP("ORERRMSG",$J).
"RTN","ORY348",35,0)
 ;copied from GMTSPI98 & PXRMUTIL
"RTN","ORY348",36,0)
 N DONE,IND,LEN,LN,PROOT,ROOT,START,TEMP,TEXT
"RTN","ORY348",37,0)
 I REF="" Q
"RTN","ORY348",38,0)
 S LN=0
"RTN","ORY348",39,0)
 S PROOT=$P(REF,")",1)
"RTN","ORY348",40,0)
 ;Build the root so we can tell when we are done.
"RTN","ORY348",41,0)
 S TEMP=$NA(@REF)
"RTN","ORY348",42,0)
 S ROOT=$P(TEMP,")",1)
"RTN","ORY348",43,0)
 S REF=$Q(@REF)
"RTN","ORY348",44,0)
 I REF'[ROOT Q
"RTN","ORY348",45,0)
 S DONE=0
"RTN","ORY348",46,0)
 F  Q:(REF="")!(DONE)  D
"RTN","ORY348",47,0)
 . S START=$F(REF,ROOT)
"RTN","ORY348",48,0)
 . S LEN=$L(REF)
"RTN","ORY348",49,0)
 . S IND=$E(REF,START,LEN)
"RTN","ORY348",50,0)
 . S LN=LN+1,TEXT(LN)=PROOT_IND_"="_@REF
"RTN","ORY348",51,0)
 . S REF=$Q(@REF)
"RTN","ORY348",52,0)
 . I REF'[ROOT S DONE=1
"RTN","ORY348",53,0)
 D MES^XPDUTL(.TEXT)
"RTN","ORY348",54,0)
 Q
"RTN","ORY348",55,0)
 ;
"RTN","ORY348",56,0)
NOTPARAM ; parameter transport routine
"RTN","ORY348",57,0)
 K ^TMP($J,"XPARRSTR")
"RTN","ORY348",58,0)
 N ENT,IDX,ROOT,REF,VAL,I
"RTN","ORY348",59,0)
 S ROOT=$NAME(^TMP($J,"XPARRSTR")),ROOT=$E(ROOT,1,$L(ROOT)-1)_","
"RTN","ORY348",60,0)
 D LOAD
"RTN","ORY348",61,0)
XX2 S IDX=0,ENT="PKG."_"ORDER ENTRY/RESULTS REPORTING"
"RTN","ORY348",62,0)
 F  S IDX=$O(^TMP($J,"XPARRSTR",IDX)) Q:'IDX  D
"RTN","ORY348",63,0)
 . N PAR,INST,ORVAL,ORERR K ORVAL
"RTN","ORY348",64,0)
 . S PAR=$P(^TMP($J,"XPARRSTR",IDX,"KEY"),U),INST=$P(^("KEY"),U,2)
"RTN","ORY348",65,0)
 . M ORVAL=^TMP($J,"XPARRSTR",IDX,"VAL")
"RTN","ORY348",66,0)
 . D EN^XPAR(ENT,PAR,INST,.ORVAL,.ORERR)
"RTN","ORY348",67,0)
 K ^TMP($J,"XPARRSTR")
"RTN","ORY348",68,0)
 Q
"RTN","ORY348",69,0)
LOAD ; load data into ^TMP (expects ROOT to be defined)
"RTN","ORY348",70,0)
 S I=1 F  S REF=$T(DATA+I) Q:REF=""  S VAL=$T(DATA+I+1) D
"RTN","ORY348",71,0)
 . S I=I+2,REF=$P(REF,";",3,999),VAL=$P(VAL,";",3,999)
"RTN","ORY348",72,0)
 . S @(ROOT_REF)=VAL
"RTN","ORY348",73,0)
 Q
"RTN","ORY348",74,0)
DATA ; parameter data
"RTN","ORY348",75,0)
 ;;8000,"KEY")
"RTN","ORY348",76,0)
 ;;ORB ARCHIVE PERIOD^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",77,0)
 ;;8000,"VAL")
"RTN","ORY348",78,0)
 ;;30
"RTN","ORY348",79,0)
 ;;8001,"KEY")
"RTN","ORY348",80,0)
 ;;ORB DELETE MECHANISM^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",81,0)
 ;;8001,"VAL")
"RTN","ORY348",82,0)
 ;;Individual Recipient
"RTN","ORY348",83,0)
 ;;8002,"KEY")
"RTN","ORY348",84,0)
 ;;ORB FORWARD BACKUP REVIEWER^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",85,0)
 ;;8002,"VAL")
"RTN","ORY348",86,0)
 ;;0
"RTN","ORY348",87,0)
 ;;8003,"KEY")
"RTN","ORY348",88,0)
 ;;ORB FORWARD SUPERVISOR^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",89,0)
 ;;8003,"VAL")
"RTN","ORY348",90,0)
 ;;0
"RTN","ORY348",91,0)
 ;;8004,"KEY")
"RTN","ORY348",92,0)
 ;;ORB FORWARD SURROGATES^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",93,0)
 ;;8004,"VAL")
"RTN","ORY348",94,0)
 ;;0
"RTN","ORY348",95,0)
 ;;8005,"KEY")
"RTN","ORY348",96,0)
 ;;ORB PROCESSING FLAG^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",97,0)
 ;;8005,"VAL")
"RTN","ORY348",98,0)
 ;;Disabled
"RTN","ORY348",99,0)
 ;;8006,"KEY")
"RTN","ORY348",100,0)
 ;;ORB PROVIDER RECIPIENTS^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",101,0)
 ;;8006,"VAL")
"RTN","ORY348",102,0)
 ;;CM
"RTN","ORY348",103,0)
 ;;8007,"KEY")
"RTN","ORY348",104,0)
 ;;ORB URGENCY^SUICIDE ATTEMPTED/COMPLETED
"RTN","ORY348",105,0)
 ;;8007,"VAL")
"RTN","ORY348",106,0)
 ;;High
"VER")
8.0^22.0
"^DD",100.9,100.9,0)
FIELD^^5^12
"^DD",100.9,100.9,0,"DDA")
N
"^DD",100.9,100.9,0,"DT")
3121018
"^DD",100.9,100.9,0,"IX","B",100.9,.01)

"^DD",100.9,100.9,0,"IX","C",100.9,.02)

"^DD",100.9,100.9,0,"IX","D",100.9,.03)

"^DD",100.9,100.9,0,"NM","OE/RR NOTIFICATIONS")

"^DD",100.9,100.9,0,"PT",100.21019,.01)

"^DD",100.9,100.9,0,"PT",860.22,3)

"^DD",100.9,100.9,0,"VRPK")
OR
"^DD",100.9,100.9,.001,0)
NUMBER^NJ9,0X^^ ^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N)!('$$VALNUM^ORBINPTR(X)) X
"^DD",100.9,100.9,.001,3)
Enter your station number, followed by 01 to 99. For example, 66001. Numbers 1-9999 are reserved for National notifications only.
"^DD",100.9,100.9,.001,21,0)
^^11^11^3121106^
"^DD",100.9,100.9,.001,21,1,0)
This is the internal entry number assigned to a notification.  Entries
"^DD",100.9,100.9,.001,21,2,0)
1 through 9999 are reserved for National release by the OE/RR 
"^DD",100.9,100.9,.001,21,3,0)
Notifications package.
"^DD",100.9,100.9,.001,21,4,0)
 
"^DD",100.9,100.9,.001,21,5,0)
For local site-defined notifications, the internal entry number must be 
"^DD",100.9,100.9,.001,21,6,0)
specific to your VAMC in the following format:
"^DD",100.9,100.9,.001,21,7,0)
 
"^DD",100.9,100.9,.001,21,8,0)
<your station number><incremental notification number 01-99>
"^DD",100.9,100.9,.001,21,9,0)
 
"^DD",100.9,100.9,.001,21,10,0)
For example, if your site is number 456, your first locally created 
"^DD",100.9,100.9,.001,21,11,0)
notification would be 45601.                         
"^DD",100.9,100.9,.001,23,0)
^.001^3^3^3121106^^^^
"^DD",100.9,100.9,.001,23,1,0)
This field is used by DHCP packages triggering notifications (Lab, MAS, etc)
"^DD",100.9,100.9,.001,23,2,0)
to send the correct message and parameters to OE/RR.  These numbers must not
"^DD",100.9,100.9,.001,23,3,0)
be altered in any fashion.
"^DD",100.9,100.9,.001,"DT")
3121026
"^DD",100.9,100.9,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",100.9,100.9,.01,1,0)
^.1
"^DD",100.9,100.9,.01,1,1,0)
100.9^B
"^DD",100.9,100.9,.01,1,1,1)
S ^ORD(100.9,"B",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.01,1,1,2)
K ^ORD(100.9,"B",$E(X,1,30),DA)
"^DD",100.9,100.9,.01,1,2,0)
^^TRIGGER^100.9^.02
"^DD",100.9,100.9,.01,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^ORD(100.9,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X="OR" X ^DD(100.9,.01,1,2,1.4)
"^DD",100.9,100.9,.01,1,2,1.4)
S DIH=$S($D(^ORD(100.9,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=100.9,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",100.9,100.9,.01,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^ORD(100.9,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X=X X ^DD(100.9,.01,1,2,2.4)
"^DD",100.9,100.9,.01,1,2,2.4)
S DIH=$S($D(^ORD(100.9,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=100.9,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",100.9,100.9,.01,1,2,"%D",0)
^^2^2^2920505^
"^DD",100.9,100.9,.01,1,2,"%D",1,0)
Automatically trigger the setting of the PACKAGE ID field with "OR"
"^DD",100.9,100.9,.01,1,2,"%D",2,0)
to indicate ORder entry when a notification is created.
"^DD",100.9,100.9,.01,1,2,"CREATE VALUE")
"OR"
"^DD",100.9,100.9,.01,1,2,"DELETE VALUE")
OLD NAME
"^DD",100.9,100.9,.01,1,2,"DT")
2920505
"^DD",100.9,100.9,.01,1,2,"FIELD")
PACKAGE ID
"^DD",100.9,100.9,.01,3)
Answer must be 3-30 characters in length. Enter the name of the notification.  The name should match the entry in the MESSAGE TEXT field as closely as possible.
"^DD",100.9,100.9,.01,21,0)
^^4^4^2990416^^^^
"^DD",100.9,100.9,.01,21,1,0)
This is the name of the notification.  It should match the text in the
"^DD",100.9,100.9,.01,21,2,0)
MESSAGE TEXT field as closely as possible (it may be an abbreviated version
"^DD",100.9,100.9,.01,21,3,0)
of the entry in MESSAGE TEXT.)  This field is displayed to users when
"^DD",100.9,100.9,.01,21,4,0)
selecting or reviewing entries in this file (100.9).
"^DD",100.9,100.9,.01,"DT")
2920505
"^DD",100.9,100.9,.02,0)
PACKAGE ID^RFX^^0;2^S X="OR" ;K:X[""""!($A(X)=^ X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",100.9,100.9,.02,1,0)
^.1
"^DD",100.9,100.9,.02,1,1,0)
100.9^C
"^DD",100.9,100.9,.02,1,1,1)
S ^ORD(100.9,"C",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.02,1,1,2)
K ^ORD(100.9,"C",$E(X,1,30),DA)
"^DD",100.9,100.9,.02,1,1,"%D",0)
^^2^2^2920427^^
"^DD",100.9,100.9,.02,1,1,"%D",1,0)
This cross-reference provides a way to group notifications by package or 
"^DD",100.9,100.9,.02,1,1,"%D",2,0)
other category.
"^DD",100.9,100.9,.02,1,1,"DT")
2910429
"^DD",100.9,100.9,.02,3)
Always enter "OR" in this field.  This field is used to create the XQAID field passed to the XQALERT entry points.  It will typically be the Package ID. 
"^DD",100.9,100.9,.02,5,1,0)
100.9^.01^2
"^DD",100.9,100.9,.02,9)
^
"^DD",100.9,100.9,.02,21,0)
^^10^10^2990416^^^^
"^DD",100.9,100.9,.02,21,1,0)
This entry should always be "OR" to indicate the alert (notification) is 
"^DD",100.9,100.9,.02,21,2,0)
processed by OE/RR.  "OR" is stuffed via a trigger x-ref in field .01.
"^DD",100.9,100.9,.02,21,3,0)
This Package ID will have ";DFN;NIEN" concatenated to the end of it, to
"^DD",100.9,100.9,.02,21,4,0)
make the XQAID variable which is used by the XQALERT routine to provide a
"^DD",100.9,100.9,.02,21,5,0)
unique cross-reference.  The order entry notification system will check
"^DD",100.9,100.9,.02,21,6,0)
the New person file to determine if this message is already pending for
"^DD",100.9,100.9,.02,21,7,0)
the user.  If it already exists, the user will not receive a second message.
"^DD",100.9,100.9,.02,21,8,0)
 
"^DD",100.9,100.9,.02,21,9,0)
DFN is the Patient File internal entry number.
"^DD",100.9,100.9,.02,21,10,0)
NIEN is the Notification File internal entry number.
"^DD",100.9,100.9,.02,"DT")
2911008
"^DD",100.9,100.9,.03,0)
MESSAGE TEXT^RF^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>51!($L(X)<3) X
"^DD",100.9,100.9,.03,1,0)
^.1
"^DD",100.9,100.9,.03,1,1,0)
100.9^D
"^DD",100.9,100.9,.03,1,1,1)
S ^ORD(100.9,"D",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.03,1,1,2)
K ^ORD(100.9,"D",$E(X,1,30),DA)
"^DD",100.9,100.9,.03,1,1,"%D",0)
^^1^1^2910429^
"^DD",100.9,100.9,.03,1,1,"%D",1,0)
This cross reference provides a look-up based on the Message Text.
"^DD",100.9,100.9,.03,1,1,"DT")
2910429
"^DD",100.9,100.9,.03,3)
Answer must be 3-51 characters in length.  This entry is used as the actual text of the notification (MESSAGE TYPE = 'NOT') or the default text (MESSAGE TEXT = 'PKG').
"^DD",100.9,100.9,.03,21,0)
^^6^6^2920224^^^^
"^DD",100.9,100.9,.03,21,1,0)
This text will be appended to the Patient last name and last 4 characters of
"^DD",100.9,100.9,.03,21,2,0)
the social security number to create the order notification text.
"^DD",100.9,100.9,.03,21,3,0)
(e.g., SMITH (4356): Unsigned orders. - Where "Unsigned orders." is the 
"^DD",100.9,100.9,.03,21,4,0)
content of MESSAGE TEXT.)  Text entered into this field is the default text
"^DD",100.9,100.9,.03,21,5,0)
for notifications where the text message usually comes from the package
"^DD",100.9,100.9,.03,21,6,0)
(MESSAGE TYPE = PKG).
"^DD",100.9,100.9,.03,"DT")
2911008
"^DD",100.9,100.9,.04,0)
MESSAGE TYPE^RS^PKG:PACKAGE PROVIDES A VARIABLE MESSAGE;NOT:NOTIFICATION FILE PROVIDES MESSAGE;^0;4^Q
"^DD",100.9,100.9,.04,3)
Messages can be provided by the NOTIFICATION file where they are defined with the notification 'NOT' or they can be variable messages supplied by the package 'PKG' when the notification is triggered.
"^DD",100.9,100.9,.04,21,0)
^^1^1^2960503^^^^
"^DD",100.9,100.9,.04,21,1,0)
MESSAGE TYPE field is used as a flag to determine where the message text originates.  If from the NOTIFICATION file, MESSAGE TYPE is 'NOT.'  If the message comes from the package, MESSAGE TYPE is 'PKG.'
"^DD",100.9,100.9,.04,"DT")
2910627
"^DD",100.9,100.9,.05,0)
ACTION FLAG^RS^I:INFORMATION ONLY;R:RUN ROUTINE;^0;5^Q
"^DD",100.9,100.9,.05,3)
Enter 'I' if the user is to take no follow-up action for this notification.  Enter 'R' if the user is to take a follow-up action after viewing this notification (e.g. Sign an unsigned order.)
"^DD",100.9,100.9,.05,21,0)
^^7^7^2920417^^^^
"^DD",100.9,100.9,.05,21,1,0)
This a mandatory flag used to regulate processing in XQALERT processing.
"^DD",100.9,100.9,.05,21,2,0)
The flag is set to I to indicate the notification is for INFORMATION ONLY - 
"^DD",100.9,100.9,.05,21,3,0)
no follow-up action is to be taken.  'I' notifications are deleted as each
"^DD",100.9,100.9,.05,21,4,0)
user reviews them.  'R' notifications have a follow-up action associated
"^DD",100.9,100.9,.05,21,5,0)
with them.  The user will be taken to another routine or option when they
"^DD",100.9,100.9,.05,21,6,0)
select a notification with ACTION FLAG = R and a follow-up routine/option
"^DD",100.9,100.9,.05,21,7,0)
is defined.
"^DD",100.9,100.9,.05,"DT")
2910627
"^DD",100.9,100.9,.06,0)
ENTRY POINT^F^^0;6^K:$L(X)>8!($L(X)<1) X
"^DD",100.9,100.9,.06,3)
Answer must be 1-8 characters in length.  This should be the tag to be concatenated with the ROUTINE NAME (.07) field.  It is the entry point for follow-up action in that routine.
"^DD",100.9,100.9,.06,21,0)
^^2^2^2920224^^^
"^DD",100.9,100.9,.06,21,1,0)
This is an optional field used to create the XQAROU variable to be used by
"^DD",100.9,100.9,.06,21,2,0)
the XQALERT routine.  This field represents the TAG in tag^routine. 
"^DD",100.9,100.9,.06,"DT")
2910429
"^DD",100.9,100.9,.07,0)
ROUTINE NAME^F^^0;7^K:$L(X)>8!($L(X)<2) X
"^DD",100.9,100.9,.07,3)
Answer must be 2-8 characters in length.  This is concatenated with the ENTRY POINT (.06) to create XQAROU.  It is the routine where the follow-up action (if any) for this notification is initiated.
"^DD",100.9,100.9,.07,21,0)
^^2^2^2920224^^^
"^DD",100.9,100.9,.07,21,1,0)
This is an optional variable identifying a routine or tag(field .06)^routine
"^DD",100.9,100.9,.07,21,2,0)
used to create XQAROU for processing by XQALERT.
"^DD",100.9,100.9,.07,"DT")
2910429
"^DD",100.9,100.9,1,0)
NON-MENU TYPE OPTION ACTION^P19'^DIC(19,^1;1^Q
"^DD",100.9,100.9,1,3)
This field is for future enhancements.  It is currently (5/92) unused.
"^DD",100.9,100.9,1,21,0)
^^5^5^2920506^^^^
"^DD",100.9,100.9,1,21,1,0)
This is an optional field used to create the variable XQAOPT for use
"^DD",100.9,100.9,1,21,2,0)
by XQALERT.  It should indicate a non-menu type option on the user's
"^DD",100.9,100.9,1,21,3,0)
primary or secondary menu, not on the Common menu.  The phantom jump 
"^DD",100.9,100.9,1,21,4,0)
is used to navigate to the destination option and will check pathway
"^DD",100.9,100.9,1,21,5,0)
restrictions in doing so.
"^DD",100.9,100.9,1,"DT")
2910429
"^DD",100.9,100.9,1.5,0)
RELATED PACKAGE^F^^1;2^K:$L(X)>30!($L(X)<2) X
"^DD",100.9,100.9,1.5,3)
Answer must be 2-30 characters in length.  Enter the appropriate name of the package where the notification originates (e.g., LAB, MAS, Pharmacy.)
"^DD",100.9,100.9,1.5,21,0)
^^1^1^2920224^^^
"^DD",100.9,100.9,1.5,21,1,0)
This field contains the name of the package where the notification originates or is triggered (e.g., LAB, MAS, Pharmacy.)
"^DD",100.9,100.9,1.5,"DT")
2910627
"^DD",100.9,100.9,4,0)
DESCRIPTION^RF^^4;1^K:$L(X)>250!($L(X)<3) X
"^DD",100.9,100.9,4,3)
Answer must be 3-250 characters in length.  Enter a description of the notification with emphasis on what triggers the notification and what actions delete it.
"^DD",100.9,100.9,4,21,0)
^^2^2^2950711^^^
"^DD",100.9,100.9,4,21,1,0)
This field contains free text describing the notification, how it is trig-
"^DD",100.9,100.9,4,21,2,0)
gered and what action(s) delete it.
"^DD",100.9,100.9,4,"DT")
2950424
"^DD",100.9,100.9,5,0)
FOLLOW-UP TYPE^S^0:REPORT;1:COSIGN_PN;2:EXPIRING_ORDER;3:FLAGGED_ORDER;4:ORDER;5:UNLINKED;6:NEW_CONSULT;7:NEW_ORDER;8:COSIGN_ORDER;9:ES_ORDER;10:UNSIGN_PN;11:UNVERIFIED_MED;^3;2^Q
"^DD",100.9,100.9,5,3)
Enter the follow-up code correspond to the notification's follow-up action.  If unsure, leave blank.
"^DD",100.9,100.9,5,21,0)
^^5^5^2990412^^^^
"^DD",100.9,100.9,5,21,1,0)
This field contains the type of follow-up action to be taken.  It is used 
"^DD",100.9,100.9,5,21,2,0)
by the application managing the follow-up action  (e.g. GUI interface) to
"^DD",100.9,100.9,5,21,3,0)
initiate the proper follow-up action separate from the underlying data 
"^DD",100.9,100.9,5,21,4,0)
base and application layers.  Example follow-up types include: report,
"^DD",100.9,100.9,5,21,5,0)
e/s, flag.
"^DD",100.9,100.9,5,23,0)
^^6^6^2990412^^^^
"^DD",100.9,100.9,5,23,1,0)
This field is basically a flag for the environment (e.g. GUI - Delphi)
"^DD",100.9,100.9,5,23,2,0)
handling notification follow-up to initiate the appropriate action.  For
"^DD",100.9,100.9,5,23,3,0)
example if the type was report, the data returned in the API call would be
"^DD",100.9,100.9,5,23,4,0)
stuffed into a generic text box for display; whereas if the type was
"^DD",100.9,100.9,5,23,5,0)
flag, the follow-up action would be to find and display all flagged orders
"^DD",100.9,100.9,5,23,6,0)
for the patient and allow unflagging.
"^DD",100.9,100.9,5,"DT")
2990412
"^DIC",100.9,100.9,0)
OE/RR NOTIFICATIONS^100.9
"^DIC",100.9,100.9,0,"GL")
^ORD(100.9,
"^DIC",100.9,100.9,"%D",0)
^^5^5^2970731^^^
"^DIC",100.9,100.9,"%D",1,0)
This file contains data used to generate notifications.  Packages
"^DIC",100.9,100.9,"%D",2,0)
determine if a notification should be sent then send the patient ID and
"^DIC",100.9,100.9,"%D",3,0)
notification ID (IEN in this file) to order entry routines.  Based on the
"^DIC",100.9,100.9,"%D",4,0)
notification IEN, data from this file is used to generate the notification
"^DIC",100.9,100.9,"%D",5,0)
and help determine its recipients.
"^DIC",100.9,"B","OE/RR NOTIFICATIONS",100.9)

**INSTALL NAME**
PXRM*2.0*24
"BLD",8222,0)
PXRM*2.0*24^CLINICAL REMINDERS^0^3130509^y
"BLD",8222,1,0)
^^2^2^3120419^^^^
"BLD",8222,1,1,0)
High Risk Mental Health phase 2.
"BLD",8222,1,2,0)

"BLD",8222,4,0)
^9.64PA^811.8^2
"BLD",8222,4,811.4,0)
811.4
"BLD",8222,4,811.4,222)
y^y^f^^y^^y^r^n
"BLD",8222,4,811.4,224)
I $$CFINC^PXRMP24I(Y)
"BLD",8222,4,811.8,0)
811.8
"BLD",8222,4,811.8,222)
n^n^f^^n^^y^o^n
"BLD",8222,4,811.8,224)
I $$EXFINC^PXRMEXSI(Y,"EXARRAY","PXRMP24E")
"BLD",8222,4,"B",811.4,811.4)

"BLD",8222,4,"B",811.8,811.8)

"BLD",8222,6.3)
193
"BLD",8222,"ABPKG")
n
"BLD",8222,"INI")
PRE^PXRMP24I
"BLD",8222,"INIT")
POST^PXRMP24I
"BLD",8222,"KRN",0)
^9.67PA^779.2^20
"BLD",8222,"KRN",.4,0)
.4
"BLD",8222,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",.401,0)
.401
"BLD",8222,"KRN",.402,0)
.402
"BLD",8222,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",.403,0)
.403
"BLD",8222,"KRN",.403,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",.5,0)
.5
"BLD",8222,"KRN",.84,0)
.84
"BLD",8222,"KRN",3.6,0)
3.6
"BLD",8222,"KRN",3.8,0)
3.8
"BLD",8222,"KRN",9.2,0)
9.2
"BLD",8222,"KRN",9.8,0)
9.8
"BLD",8222,"KRN",9.8,"NM",0)
^9.68A^29^29
"BLD",8222,"KRN",9.8,"NM",1,0)
PXRMPCMM^^0^B11797305
"BLD",8222,"KRN",9.8,"NM",2,0)
PXRMVSIT^^0^B10650656
"BLD",8222,"KRN",9.8,"NM",3,0)
PXRMPINF^^0^B8130614
"BLD",8222,"KRN",9.8,"NM",4,0)
PXRMNTFY^^0^B3662059
"BLD",8222,"KRN",9.8,"NM",5,0)
PXRMP24E^^0^B2321909
"BLD",8222,"KRN",9.8,"NM",6,0)
PXRMEXSI^^0^B40410891
"BLD",8222,"KRN",9.8,"NM",7,0)
PXRMEXIU^^0^B66069083
"BLD",8222,"KRN",9.8,"NM",8,0)
PXRMEXID^^0^B65987316
"BLD",8222,"KRN",9.8,"NM",9,0)
PXRMEXLM^^0^B46743705
"BLD",8222,"KRN",9.8,"NM",10,0)
PXRMLPOE^^0^B14864405
"BLD",8222,"KRN",9.8,"NM",11,0)
PXRMRDI^^0^B38535019
"BLD",8222,"KRN",9.8,"NM",12,0)
PXRMCDEF^^0^B2284758
"BLD",8222,"KRN",9.8,"NM",13,0)
PXRMEXFI^^0^B53496841
"BLD",8222,"KRN",9.8,"NM",14,0)
PXRMICHK^^0^B132138736
"BLD",8222,"KRN",9.8,"NM",15,0)
PXRMMSER^^0^B106782052
"BLD",8222,"KRN",9.8,"NM",16,0)
PXRM^^0^B37992293
"BLD",8222,"KRN",9.8,"NM",17,0)
PXRMLOCF^^0^B95753792
"BLD",8222,"KRN",9.8,"NM",18,0)
PXRMDEDT^^0^B86390747
"BLD",8222,"KRN",9.8,"NM",19,0)
PXRMTAX^^0^B65791721
"BLD",8222,"KRN",9.8,"NM",20,0)
PXRMEXPS^^0^B192149462
"BLD",8222,"KRN",9.8,"NM",21,0)
PXRMEXIC^^0^B80167234
"BLD",8222,"KRN",9.8,"NM",22,0)
PXRMDUTL^^0^B9494253
"BLD",8222,"KRN",9.8,"NM",23,0)
PXRMDATE^^0^B69746461
"BLD",8222,"KRN",9.8,"NM",24,0)
PXRMDEV^^0^B78211075
"BLD",8222,"KRN",9.8,"NM",25,0)
PXRMFF^^0^B65126590
"BLD",8222,"KRN",9.8,"NM",26,0)
PXRMUTIL^^0^B113964494
"BLD",8222,"KRN",9.8,"NM",27,0)
PXRMXQUE^^0^B12328074
"BLD",8222,"KRN",9.8,"NM",28,0)
PXRMPDEM^^0^B65842415
"BLD",8222,"KRN",9.8,"NM",29,0)
PXRMSCR^^0^B88295
"BLD",8222,"KRN",9.8,"NM","B","PXRM",16)

"BLD",8222,"KRN",9.8,"NM","B","PXRMCDEF",12)

"BLD",8222,"KRN",9.8,"NM","B","PXRMDATE",23)

"BLD",8222,"KRN",9.8,"NM","B","PXRMDEDT",18)

"BLD",8222,"KRN",9.8,"NM","B","PXRMDEV",24)

"BLD",8222,"KRN",9.8,"NM","B","PXRMDUTL",22)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXFI",13)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXIC",21)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXID",8)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXIU",7)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXLM",9)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXPS",20)

"BLD",8222,"KRN",9.8,"NM","B","PXRMEXSI",6)

"BLD",8222,"KRN",9.8,"NM","B","PXRMFF",25)

"BLD",8222,"KRN",9.8,"NM","B","PXRMICHK",14)

"BLD",8222,"KRN",9.8,"NM","B","PXRMLOCF",17)

"BLD",8222,"KRN",9.8,"NM","B","PXRMLPOE",10)

"BLD",8222,"KRN",9.8,"NM","B","PXRMMSER",15)

"BLD",8222,"KRN",9.8,"NM","B","PXRMNTFY",4)

"BLD",8222,"KRN",9.8,"NM","B","PXRMP24E",5)

"BLD",8222,"KRN",9.8,"NM","B","PXRMPCMM",1)

"BLD",8222,"KRN",9.8,"NM","B","PXRMPDEM",28)

"BLD",8222,"KRN",9.8,"NM","B","PXRMPINF",3)

"BLD",8222,"KRN",9.8,"NM","B","PXRMRDI",11)

"BLD",8222,"KRN",9.8,"NM","B","PXRMSCR",29)

"BLD",8222,"KRN",9.8,"NM","B","PXRMTAX",19)

"BLD",8222,"KRN",9.8,"NM","B","PXRMUTIL",26)

"BLD",8222,"KRN",9.8,"NM","B","PXRMVSIT",2)

"BLD",8222,"KRN",9.8,"NM","B","PXRMXQUE",27)

"BLD",8222,"KRN",19,0)
19
"BLD",8222,"KRN",19,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",19.1,0)
19.1
"BLD",8222,"KRN",101,0)
101
"BLD",8222,"KRN",101,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",409.61,0)
409.61
"BLD",8222,"KRN",409.61,"NM",0)
^9.68A^^0
"BLD",8222,"KRN",771,0)
771
"BLD",8222,"KRN",779.2,0)
779.2
"BLD",8222,"KRN",870,0)
870
"BLD",8222,"KRN",8989.51,0)
8989.51
"BLD",8222,"KRN",8989.52,0)
8989.52
"BLD",8222,"KRN",8994,0)
8994
"BLD",8222,"KRN","B",.4,.4)

"BLD",8222,"KRN","B",.401,.401)

"BLD",8222,"KRN","B",.402,.402)

"BLD",8222,"KRN","B",.403,.403)

"BLD",8222,"KRN","B",.5,.5)

"BLD",8222,"KRN","B",.84,.84)

"BLD",8222,"KRN","B",3.6,3.6)

"BLD",8222,"KRN","B",3.8,3.8)

"BLD",8222,"KRN","B",9.2,9.2)

"BLD",8222,"KRN","B",9.8,9.8)

"BLD",8222,"KRN","B",19,19)

"BLD",8222,"KRN","B",19.1,19.1)

"BLD",8222,"KRN","B",101,101)

"BLD",8222,"KRN","B",409.61,409.61)

"BLD",8222,"KRN","B",771,771)

"BLD",8222,"KRN","B",779.2,779.2)

"BLD",8222,"KRN","B",870,870)

"BLD",8222,"KRN","B",8989.51,8989.51)

"BLD",8222,"KRN","B",8989.52,8989.52)

"BLD",8222,"KRN","B",8994,8994)

"BLD",8222,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8222,"QUES",0)
^9.62^^
"BLD",8222,"REQB",0)
^9.611^3^3
"BLD",8222,"REQB",1,0)
PXRM*2.0*22^2
"BLD",8222,"REQB",2,0)
OR*3.0*348^2
"BLD",8222,"REQB",3,0)
SD*5.3*601^2
"BLD",8222,"REQB","B","OR*3.0*348",2)

"BLD",8222,"REQB","B","PXRM*2.0*22",1)

"BLD",8222,"REQB","B","SD*5.3*601",3)

"DATA",811.4,12,0)
VA-ADMISSIONS FOR A DATE RANGE^PXRMINPL^ADM^VA-Admissions for a Date Range^L^0
"DATA",811.4,12,1,0)
^811.41^29^29^3090519^^^^
"DATA",811.4,12,1,1,0)
This list type computed finding can be used to build a list of
"DATA",811.4,12,1,2,0)
patients who were admitted in the specified date range. A Reminder
"DATA",811.4,12,1,3,0)
Location List can be used to restrict the selection of patients to
"DATA",811.4,12,1,4,0)
only the ward locations included in the location list. To do this
"DATA",811.4,12,1,5,0)
enter the exact .01 name of a Reminder Location List into the 
"DATA",811.4,12,1,6,0)
COMPUTED FINDING PARAMETER field. If a Reminder Location List is not
"DATA",811.4,12,1,7,0)
used then all ward locations will be included.
"DATA",811.4,12,1,8,0)

"DATA",811.4,12,1,9,0)
The CONDITION field may also be used to select entries by any of the
"DATA",811.4,12,1,10,0)
following CSUB subscripts:
"DATA",811.4,12,1,11,0)

"DATA",811.4,12,1,12,0)
V or V("VALUE") = the ward to which the patient was admitted
"DATA",811.4,12,1,13,0)
                  in the format of 9;3EAST (IEN;Ward Name)
"DATA",811.4,12,1,14,0)

"DATA",811.4,12,1,15,0)
V("INSTITUTION") = the name of the INSTITUTION (file #4) entry 
"DATA",811.4,12,1,16,0)
                   with which the ward is associated in the format 
"DATA",811.4,12,1,17,0)
                   5000;ELY;660GC (IEN;Institution Name;Station Number) 
"DATA",811.4,12,1,18,0)

"DATA",811.4,12,1,19,0)
V("TYPE_OF_MVMT") = the type of movement entry from file 405.1
"DATA",811.4,12,1,20,0)
                    (e.g., REGULAR, OPT-NSC, OPT-SC, etc.)
"DATA",811.4,12,1,21,0)

"DATA",811.4,12,1,22,0)

"DATA",811.4,12,1,23,0)

"DATA",811.4,12,1,24,0)

"DATA",811.4,12,1,25,0)

"DATA",811.4,12,1,26,0)

"DATA",811.4,12,1,27,0)

"DATA",811.4,12,1,28,0)

"DATA",811.4,12,1,29,0)

"DATA",811.4,12,100)
N
"DATA",811.4,15,0)
VA-APPOINTMENTS FOR A PATIENT^PXRMRDI^PAPPL^VA-Appointments for a Patient^M^0
"DATA",811.4,15,1,0)
^811.41^119^119^3120425^^^^
"DATA",811.4,15,1,1,0)
This multiple occurrence computed finding returns a list of
"DATA",811.4,15,1,2,0)
appointments for a patient in the specified date range from 
"DATA",811.4,15,1,3,0)
the Scheduling Package. 
"DATA",811.4,15,1,4,0)

"DATA",811.4,15,1,5,0)
The Computed Finding Parameter can be used to specify which 
"DATA",811.4,15,1,6,0)
appointment data fields should be returned from the Scheduling 
"DATA",811.4,15,1,7,0)
package and filter the results returned based on location 
"DATA",811.4,15,1,8,0)
and status. The Computed Finding Parameter entry uses
"DATA",811.4,15,1,9,0)
FLDS: to specify appointment data fields, STATUS: to filter 
"DATA",811.4,15,1,10,0)
specific statuses, and LL: to specify a Reminder Location List 
"DATA",811.4,15,1,11,0)
to filter locations.  
"DATA",811.4,15,1,12,0)

"DATA",811.4,15,1,13,0)
FLDS, STATUS, and LL are all optional and can be defined in any 
"DATA",811.4,15,1,14,0)
order in the computed finding parameter field.
"DATA",811.4,15,1,15,0)
Some examples of how to use FLDS, STATUS and/or LL:
"DATA",811.4,15,1,16,0)
  FLDS:1,2,16^STATUS:R^LL:DIABETIC LOCATIONS
"DATA",811.4,15,1,17,0)
  STATUS:CP,CC^FLDS:25
"DATA",811.4,15,1,18,0)
  LL:DIABETIC LOCATION
"DATA",811.4,15,1,19,0)

"DATA",811.4,15,1,20,0)
FLDS parameter information:
"DATA",811.4,15,1,21,0)
The appointment data fields are specified as follows:  
"DATA",811.4,15,1,22,0)
FLDS:F1,F2,... where F1,F2,... are any of the possible ID values
"DATA",811.4,15,1,23,0)
listed in the Available Appointment Data Fields table below.
"DATA",811.4,15,1,24,0)
The F1,F2,... ID values specify what data associated with the 
"DATA",811.4,15,1,25,0)
appointment will display in the clinical maintenance output. 
"DATA",811.4,15,1,26,0)
If no FLDS is specified, the default display fields will be 1,2
"DATA",811.4,15,1,27,0)
for APPOINTMENT DATE/TIME and CLINIC. 
"DATA",811.4,15,1,28,0)

"DATA",811.4,15,1,29,0)
Additionally, each F1,F2,... specified will be returned as CSUB 
"DATA",811.4,15,1,30,0)
data that can also be used in the computed finding's CONDITION
"DATA",811.4,15,1,31,0)
field. The CONDITION can be used to further screen the filtered
"DATA",811.4,15,1,32,0)
appointments, returned by Scheduling, by setting the USE STATUS/COND
"DATA",811.4,15,1,33,0)
IN SEARCH field to YES. 
"DATA",811.4,15,1,34,0)

"DATA",811.4,15,1,35,0)
For example, if you only want appointments that were checked out, 
"DATA",811.4,15,1,36,0)
use FLDS: 1,2,11 to get the APPOINTMENT DATE/TIME, CLINIC, and 
"DATA",811.4,15,1,37,0)
CHECK-OUT DATE/TIME for display purposes. The FLDS:1,2,11 will
"DATA",811.4,15,1,38,0)
return the CSUB data "APPOINTMENT DATE/TIME", "CLINIC" and 
"DATA",811.4,15,1,39,0)
"CHECK-OUT DATE/TIME".
"DATA",811.4,15,1,40,0)

"DATA",811.4,15,1,41,0)
CSUB values are used in the CONDITION field to do a comparison to
"DATA",811.4,15,1,42,0)
numeric or string values. Using +V causes the CSUB data to be
"DATA",811.4,15,1,43,0)
interpreted as numeric. Strings that cannot be converted to a
"DATA",811.4,15,1,44,0)
number are set to zero. For example, a CONDITION such as I
"DATA",811.4,15,1,45,0)
+V("CHECK-OUT DATE/TIME")>0 would be true if the appointment had a
"DATA",811.4,15,1,46,0)
check-out date/time.
"DATA",811.4,15,1,47,0)

"DATA",811.4,15,1,48,0)
List of Available Appointment Data Fields table with assigned ID
"DATA",811.4,15,1,49,0)
    ID      Field Name
"DATA",811.4,15,1,50,0)
--------------------------------------------------------
"DATA",811.4,15,1,51,0)

"DATA",811.4,15,1,52,0)
     1     APPOINTMENT DATE/TIME
"DATA",811.4,15,1,53,0)
     2     CLINIC
"DATA",811.4,15,1,54,0)
     3     APPOINTMENT STATUS     
"DATA",811.4,15,1,55,0)
     4     PATIENT
"DATA",811.4,15,1,56,0)
     5     LENGTH OF APPOINTMENT
"DATA",811.4,15,1,57,0)
     6     COMMENTS
"DATA",811.4,15,1,58,0)
     7     OVERBOOK
"DATA",811.4,15,1,59,0)
     8     ELIGIBILITY OF VISIT
"DATA",811.4,15,1,60,0)
     9     CHECK-IN DATE/TIME
"DATA",811.4,15,1,61,0)
    10     APPOINTMENT TYPE
"DATA",811.4,15,1,62,0)
    11     CHECK-OUT DATE/TIME
"DATA",811.4,15,1,63,0)
    12     OUTPATIENT ENCOUNTER IEN
"DATA",811.4,15,1,64,0)
    13     PRIMARY STOP CODE
"DATA",811.4,15,1,65,0)
    14     CREDIT STOP CODE
"DATA",811.4,15,1,66,0)
    15     WORKLOAD NON-COUNT
"DATA",811.4,15,1,67,0)
    16     DATE APPOINTMENT MADE
"DATA",811.4,15,1,68,0)
    17     DESIRED DATE OF APPOINTMENT
"DATA",811.4,15,1,69,0)
    18     PURPOSE OF VISIT and SHORT DESCRIPTION
"DATA",811.4,15,1,70,0)
    19     EKG DATE/TIME
"DATA",811.4,15,1,71,0)
    20     X-RAY DATE/TIME
"DATA",811.4,15,1,72,0)
    21     LAB DATE/TIME
"DATA",811.4,15,1,73,0)
    22     STATUS
"DATA",811.4,15,1,74,0)
    23     X-RAY FILMS
"DATA",811.4,15,1,75,0)
    24     AUTO-REBOOKED APPOINTMENT DATE/TIME
"DATA",811.4,15,1,76,0)
    25     NO-SHOW/CANCEL DATE/TIME
"DATA",811.4,15,1,77,0)
    26     RSA APPOINTMENT ID
"DATA",811.4,15,1,78,0)
    28     DATA ENTRY CLERK
"DATA",811.4,15,1,79,0)
    29     NO-SHOW/CANCELED BY
"DATA",811.4,15,1,80,0)
    30     CHECK-IN USER
"DATA",811.4,15,1,81,0)
    31     CHECK-OUT USER
"DATA",811.4,15,1,82,0)
    32     CANCELLATION REASON
"DATA",811.4,15,1,83,0)
    33     CONSULT LINK
"DATA",811.4,15,1,84,0)

"DATA",811.4,15,1,85,0)
STATUS information:
"DATA",811.4,15,1,86,0)
STATUS: is used to set a filter on the appointment status; only
"DATA",811.4,15,1,87,0)
those appointments with a status that matches the STATUS: values
"DATA",811.4,15,1,88,0)
list will be returned. The possible values that the Scheduling
"DATA",811.4,15,1,89,0)
API allows are:
"DATA",811.4,15,1,90,0)

"DATA",811.4,15,1,91,0)
VALUE     Description 
"DATA",811.4,15,1,92,0)
--------------------------------------------------------
"DATA",811.4,15,1,93,0)
    R      SCHEDULED/KEPT
"DATA",811.4,15,1,94,0)
    I      INPATIENT
"DATA",811.4,15,1,95,0)
    NS     NO-SHOW
"DATA",811.4,15,1,96,0)
    NSR    NO-SHOW, RESCHEDULED
"DATA",811.4,15,1,97,0)
    CP     CANCELLED BY PATIENT
"DATA",811.4,15,1,98,0)
    CPR    CANCELLED BY PATIENT, RESCHEDULED
"DATA",811.4,15,1,99,0)
    CC     CANCELLED BY CLINIC
"DATA",811.4,15,1,100,0)
    CCR    CANCELLED BY CLINIC, RESCHEDULED 
"DATA",811.4,15,1,101,0)
    NT     NO ACTION TAKEN
"DATA",811.4,15,1,102,0)

"DATA",811.4,15,1,103,0)
If STATUS is not specified, the default is R,I.
"DATA",811.4,15,1,104,0)

"DATA",811.4,15,1,105,0)
The APPOINTMENT STATUS returned by the API is a summarized list
"DATA",811.4,15,1,106,0)
which does not include detailed statuses such as Future, Checked-In,
"DATA",811.4,15,1,107,0)
or Checked Out. These  statuses are summarized as SCHEDULED/KEPT. 
"DATA",811.4,15,1,108,0)
As a result, a CONDITION may be required to make sure you are
"DATA",811.4,15,1,109,0)
getting the correct results. For example, if you are looking for an
"DATA",811.4,15,1,110,0)
appointment that was kept, you would set STATUS:R combined with a
"DATA",811.4,15,1,111,0)
CONDITION of I (+V("OUTPATIENT ENCOUNTER IEN")>0)!(+V("CHECK-OUT
"DATA",811.4,15,1,112,0)
DATE/TIME")>0) with USE STATUS/COND IN SEARCH set to YES.
"DATA",811.4,15,1,113,0)

"DATA",811.4,15,1,114,0)
LL information:
"DATA",811.4,15,1,115,0)
LL:Reminder Location List specifies a list of locations so that only
"DATA",811.4,15,1,116,0)
appointments for those locations will be returned. If LL is not
"DATA",811.4,15,1,117,0)
specified, then appointments for all locations will be returned.
"DATA",811.4,15,1,118,0)

"DATA",811.4,15,1,119,0)

"DATA",811.4,15,100)
N
"DATA",811.4,15,110,0)
^811.42D^^0
"DATA",811.4,37,0)
VA-PATIENTS WITH APPOINTMENTS^PXRMRDI^APPL^VA-Patients with Appointments^L^0
"DATA",811.4,37,1,0)
^811.41^36^36^3060314^^
"DATA",811.4,37,1,1,0)
This list computed finding returns a list of patients with
"DATA",811.4,37,1,2,0)
appointments in the specified date range. The COMPUTED
"DATA",811.4,37,1,3,0)
FINDING PARAMETER can be used to filter the results. The values that
"DATA",811.4,37,1,4,0)
can be used in the parameter are:
"DATA",811.4,37,1,5,0)
 FLDS:F1,F2,... where F1,F2 are any of the possible integer ID values listed in
"DATA",811.4,37,1,6,0)
 the table for this computed finding in the Computed Finding section of the
"DATA",811.4,37,1,7,0)
 Clinical Reminders Managers Manual. These specify what data associated with the
"DATA",811.4,37,1,8,0)
 appointment is to be returned; this data can be used in a CONDITION statement.
"DATA",811.4,37,1,9,0)
 Field number n will be the nth piece of the value. For example FLDS:1,16 would
"DATA",811.4,37,1,10,0)
 return the Appointment Date/Time in piece 1 and Date Appointment Made in piece
"DATA",811.4,37,1,11,0)
 16. A condition such as I $P(V,U,16)>3060301 would be true if the date the
"DATA",811.4,37,1,12,0)
 appointment was made was after March 1, 2006. If FLDS is not specified then the
"DATA",811.4,37,1,13,0)
 value will be ID=1 (Appointment Date/Time) and ID=2 (Clinic IEN and Name).
"DATA",811.4,37,1,14,0)
 
"DATA",811.4,37,1,15,0)
 STATUS sets a filter on the appointment status; only those
"DATA",811.4,37,1,16,0)
 appointments with status on the list will be returned. The possible
"DATA",811.4,37,1,17,0)
 values for STATUS are R (Scheduled/Kept), I (Inpatient), NS
"DATA",811.4,37,1,18,0)
 (No-show), NSR (No-show, Rescheduled), CP (Cancelled by Patient),
"DATA",811.4,37,1,19,0)
 
"DATA",811.4,37,1,20,0)
 CPR (Cancelled by Patient, Rescheduled), CC (Cancelled by Clinic),
"DATA",811.4,37,1,21,0)
 CCR (Cancelled by Clinic, Rescheduled), NT (No Action Taken).
"DATA",811.4,37,1,22,0)
 If STATUS is not specified the default is R,I.
"DATA",811.4,37,1,23,0)
 
"DATA",811.4,37,1,24,0)
 LL:Reminder Location List specifies a list of locations so that only
"DATA",811.4,37,1,25,0)
 appointments for those locations will be returned. If LL is not
"DATA",811.4,37,1,26,0)
 specified, then appointments for all locations will be returned.
"DATA",811.4,37,1,27,0)
 
"DATA",811.4,37,1,28,0)
FLDS, STATUS, and LL are all optional and can be given in any order.
"DATA",811.4,37,1,29,0)
Some examples:
"DATA",811.4,37,1,30,0)
 
"DATA",811.4,37,1,31,0)
 FLDS:1,2,16^STATUS:R^LL:DIABETIC LOCATIONS
"DATA",811.4,37,1,32,0)
 STATUS:CP,CC^FLDS:25
"DATA",811.4,37,1,33,0)
 LL:DIABETIC LOCATION
"DATA",811.4,37,1,34,0)

"DATA",811.4,37,1,35,0)

"DATA",811.4,37,1,36,0)

"DATA",811.4,37,100)
N
"DATA",811.4,37,110,0)
^811.42D^^0
"DATA",811.4,62,0)
VA-EMPLOYEE^PXRMPDEM^EMPLOYE^VA-Employee^M
"DATA",811.4,62,1,0)
^811.41^23^23^3121012^^^^
"DATA",811.4,62,1,1,0)
This computed finding will be true if the patient was an employee
"DATA",811.4,62,1,2,0)
during the date range specified by the Beginning Date/Time and
"DATA",811.4,62,1,3,0)
Ending Date/Time.
"DATA",811.4,62,1,4,0)

"DATA",811.4,62,1,5,0)
The following algorithm is used to determine if the patient was an
"DATA",811.4,62,1,6,0)
employee:
"DATA",811.4,62,1,7,0)

"DATA",811.4,62,1,8,0)
1. A lookup based on the patient's SSN is made in the New Person
"DATA",811.4,62,1,9,0)
file. If there is no match, the computed finding is false.
"DATA",811.4,62,1,10,0)

"DATA",811.4,62,1,11,0)
2. If there is a match, a check is made to see if the patient's New
"DATA",811.4,62,1,12,0)
Person file entry has a pointer to the PAID file. If there is no
"DATA",811.4,62,1,13,0)
pointer, the computed finding is false.
"DATA",811.4,62,1,14,0)

"DATA",811.4,62,1,15,0)
3. If there is a pointer, then Date Entered is compared with Ending
"DATA",811.4,62,1,16,0)
Date/Time. If it is greater, the computing finding is false.
"DATA",811.4,62,1,17,0)

"DATA",811.4,62,1,18,0)
4. Next, a check is made to see if there is a Termination Date. If
"DATA",811.4,62,1,19,0)
there is a Termination Date and it is prior to the Beginning
"DATA",811.4,62,1,20,0)
Date/Time, the computed finding is false.
"DATA",811.4,62,1,21,0)

"DATA",811.4,62,1,22,0)
5. If steps one through four are passed, the computed finding is true.
"DATA",811.4,62,1,23,0)

"DATA",811.4,62,100)
N
"DATA",811.4,66,0)
VA-ASU USER CLASS^PXRMASU^CLASS^VA-ASU User Class^M^0
"DATA",811.4,66,1,0)
^^41^41^3100330
"DATA",811.4,66,1,1,0)
This multi-occurrence computed finding returns a list of the ASU
"DATA",811.4,66,1,2,0)
User Classes that the user belongs to. The user is the person who is
"DATA",811.4,66,1,3,0)
running the reminder evaluation or processing a reminder dialog.
"DATA",811.4,66,1,4,0)
  
"DATA",811.4,66,1,5,0)
When a user is assigned to an ASU User Class, there can be an
"DATA",811.4,66,1,6,0)
Activation Date and an Expiration Date. For the purpose of this
"DATA",811.4,66,1,7,0)
computed finding, the date of the finding will be the Activation
"DATA",811.4,66,1,8,0)
Date. In those cases when there is no Activation Date, 00/00/0000
"DATA",811.4,66,1,9,0)
will be displayed as the date of the finding. If a Beginning
"DATA",811.4,66,1,10,0)
Date/Time and Ending Date/Time are used with the finding, then the 
"DATA",811.4,66,1,11,0)
period defined by the Activation Date and Expiration Date must
"DATA",811.4,66,1,12,0)
overlap the period defined by the Beginning Date/Time and the Ending
"DATA",811.4,66,1,13,0)
Date/Time in order for the finding to be true. When the Activation
"DATA",811.4,66,1,14,0)
Date is missing, a 0 will be used in its place for determining the
"DATA",811.4,66,1,15,0)
overlap. When the Expiration Date is missing, the evaluation date
"DATA",811.4,66,1,16,0)
will be used in its place for determining the overlap.
"DATA",811.4,66,1,17,0)
  
"DATA",811.4,66,1,18,0)
The Computed Finding Parameter can be used to specify either the
"DATA",811.4,66,1,19,0)
internal entry number or the exact name of an ASU User Class. If
"DATA",811.4,66,1,20,0)
this option is used, then each User Class the user is a member of is
"DATA",811.4,66,1,21,0)
checked to see if it is either the specified User Class or a child
"DATA",811.4,66,1,22,0)
of the specified User Class. Only the User Classes that pass this
"DATA",811.4,66,1,23,0)
test will remain on the list of the user's User Classes. For
"DATA",811.4,66,1,24,0)
example, if the user is a member of the user class ATTENDING 
"DATA",811.4,66,1,25,0)
PHYSICIAN, which is a child of the user class PHYSICIAN, and the
"DATA",811.4,66,1,26,0)
Computed Finding Parameter is set to "PHYSICIAN," then ATTENDING
"DATA",811.4,66,1,27,0)
PHYSICIAN will remain on the list. If the Computed Finding Parameter
"DATA",811.4,66,1,28,0)
was set to CARDIOLOGIST, then ATTENDING PHYSICIAN would be removed
"DATA",811.4,66,1,29,0)
since it is not a child of CARDIOLOGIST.
"DATA",811.4,66,1,30,0)

"DATA",811.4,66,1,31,0)
If you want to specify the user class as PHYSICIAN, in the computed
"DATA",811.4,66,1,32,0)
finding parameter field, type the following:
"DATA",811.4,66,1,33,0)
 COMPUTED FINDING PARAMETER:PHYSICIAN 
"DATA",811.4,66,1,34,0)

"DATA",811.4,66,1,35,0)
This computed finding uses date ranges like drug findings do, so if
"DATA",811.4,66,1,36,0)
the user was an active member of the class anytime during the date
"DATA",811.4,66,1,37,0)
range, the computed finding will be true. If you want to know if the
"DATA",811.4,66,1,38,0)
user is active as of today, then use T for the beginning and ending
"DATA",811.4,66,1,39,0)
date/time.  
"DATA",811.4,66,1,40,0)

"DATA",811.4,66,1,41,0)

"DATA",811.4,66,100)
N
"DATA",811.4,66,110,0)
^811.42D^^0
"DATA",811.4,76,0)
VA-PATIENT RECORD FLAG LIST^PXRMPRF^GETLST^VA-Patient Record Flag List^L^1
"DATA",811.4,76,1,0)
^811.41^9^9^3120912^^^^
"DATA",811.4,76,1,1,0)
This list type computed finding returns a list of all patients who
"DATA",811.4,76,1,2,0)
have a specified record flag active any time in the date range.
"DATA",811.4,76,1,3,0)

"DATA",811.4,76,1,4,0)
The Computed Finding Parameter is used to specify the flag in the
"DATA",811.4,76,1,5,0)
following format: FLAG NAME^FLAG TYPE 
"DATA",811.4,76,1,6,0)
  
"DATA",811.4,76,1,7,0)
Where FLAG NAME is the exact name of the flag and FLAG TYPE is L for
"DATA",811.4,76,1,8,0)
local or N for national. FLAG TYPE is optional and defaults to L.
"DATA",811.4,76,1,9,0)

"DATA",811.4,76,100)
N
"DATA",811.4,82,0)
VA-PCMM MHTC^PXRMPCMM^MHTC^VA-PCMM Mental Health Treatment Coordinator^M
"DATA",811.4,82,1,0)
^811.41^15^15^3120703^^^
"DATA",811.4,82,1,1,0)
This computed finding returns the patient's current Mental Health
"DATA",811.4,82,1,2,0)
Treatment Coordinator (MHTC). The Scheduling API this computed
"DATA",811.4,82,1,3,0)
finding uses does not take a date as a parameter so it only returns
"DATA",811.4,82,1,4,0)
the MHTC as of the actual calendar date. Therefore, this computed
"DATA",811.4,82,1,5,0)
finding cannot be used to determine if the patient had an MHTC
"DATA",811.4,82,1,6,0)
sometime in the past.
"DATA",811.4,82,1,7,0)

"DATA",811.4,82,1,8,0)
The default value of the computed finding is the MHTC. The following
"DATA",811.4,82,1,9,0)
additional CSUBs are returned:
"DATA",811.4,82,1,10,0)

"DATA",811.4,82,1,11,0)
MHTC - Mental Health Treatment Coordinator
"DATA",811.4,82,1,12,0)
ROLE - role
"DATA",811.4,82,1,13,0)
TEAM - team
"DATA",811.4,82,1,14,0)
TEAM POSITION - team position
"DATA",811.4,82,1,15,0)

"DATA",811.4,82,100)
N
"DATA",811.8,75,0)
VA-MH HIGH RISK NO-SHOW ADHOC RPT^TROST,DEBBIE at SALT LAKE CITY OIFO^3121206.152105
"DATA",811.8,75,100,0)
^811.801^1337^1337
"DATA",811.8,75,100,1,0)
<?xml version="1.0" standalone="yes"?>
"DATA",811.8,75,100,2,0)
<REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,75,100,3,0)
<PACKAGE_VERSION>2.0P27</PACKAGE_VERSION>
"DATA",811.8,75,100,4,0)
<INDEX_AT>1174</INDEX_AT>
"DATA",811.8,75,100,5,0)
<SOURCE>
"DATA",811.8,75,100,6,0)
<NAME>VA-MH HIGH RISK NO-SHOW ADHOC RPT</NAME>
"DATA",811.8,75,100,7,0)
<USER>TROST,DEBBIE</USER>
"DATA",811.8,75,100,8,0)
<SITE>SALT LAKE CITY OIFO</SITE>
"DATA",811.8,75,100,9,0)
<DATE_PACKED>12/06/2012@15:21:05</DATE_PACKED>
"DATA",811.8,75,100,10,0)
</SOURCE>
"DATA",811.8,75,100,11,0)
<DESCRIPTION><![CDATA[
"DATA",811.8,75,100,12,0)
This reminder is primarily for reporting needs and checks for No-Show MH 
"DATA",811.8,75,100,13,0)
appointments that occurred between the Beginning Date and Ending Date of 
"DATA",811.8,75,100,14,0)
a reporting period, which is different from the VA-MH HIGH RISK NO-SHOW 
"DATA",811.8,75,100,15,0)
FOLLOW-UP reminder which looks back 10 days from the date the reminder is 
"DATA",811.8,75,100,16,0)
being run.  This reminder is called by the SD MH NO SHOW AD HOC REPORT
"DATA",811.8,75,100,17,0)
(High Risk MH No-Show Adhoc Report). For each no-show appointment found 
"DATA",811.8,75,100,18,0)
in the reporting date range, the appointment date is used to run this
"DATA",811.8,75,100,19,0)
reminder, and the reminder is resolved by any results entered the same day
"DATA",811.8,75,100,20,0)
as the no-show appointment or within 60 days of the no-show appointment.
"DATA",811.8,75,100,21,0)
 
"DATA",811.8,75,100,22,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,75,100,23,0)
have followed up on a No-Show MH appointment for a patient with an
"DATA",811.8,75,100,24,0)
active High Risk for Suicide Patient Record Flag.
"DATA",811.8,75,100,25,0)
 
"DATA",811.8,75,100,26,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,75,100,27,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,75,100,28,0)
longer be necessary.
"DATA",811.8,75,100,29,0)
]]></DESCRIPTION>
"DATA",811.8,75,100,30,0)
<KEYWORDS>
"DATA",811.8,75,100,31,0)
</KEYWORDS>
"DATA",811.8,75,100,32,0)
<M_ROUTINE>
"DATA",811.8,75,100,33,0)
<ROUTINE_NAME>PXRMPRF</ROUTINE_NAME>
"DATA",811.8,75,100,34,0)
<CHECKSUM>580828279</CHECKSUM>
"DATA",811.8,75,100,35,0)
<CODE>
"DATA",811.8,75,100,36,0)
<![CDATA[
"DATA",811.8,75,100,37,0)
PXRMPRF ;SLC/PKR - Computed findings for PRF. ;08/29/2012
"DATA",811.8,75,100,38,0)
 ;;2.0;CLINICAL REMINDERS;**17,18**;Feb 4, 2005
"DATA",811.8,75,100,39,0)
 ;Calls to DGPFAPIU supported by DBIA #4903 and 5491.
"DATA",811.8,75,100,40,0)
 ;==========================================
"DATA",811.8,75,100,41,0)
GETINF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PATIENT RECORD FLAG
"DATA",811.8,75,100,42,0)
 ;INFORMATION computed finding. Return information about a specific
"DATA",811.8,75,100,43,0)
 ;record flag.
"DATA",811.8,75,100,44,0)
 N BDTNT,EDTNTFLAG,FLAGCAT,FLAGNAME,IND,LIST,RESULT,TEMP
"DATA",811.8,75,100,45,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,75,100,46,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,75,100,47,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,75,100,48,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,75,100,49,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,75,100,50,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,75,100,51,0)
 ;DBIA #5491
"DATA",811.8,75,100,52,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,75,100,53,0)
 ;DBIA #4903
"DATA",811.8,75,100,54,0)
 S RESULT=$$GETINF^DGPFAPIH(DFN,FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,75,100,55,0)
 S NFOUND=0
"DATA",811.8,75,100,56,0)
 I RESULT=0 Q
"DATA",811.8,75,100,57,0)
 S IND=0
"DATA",811.8,75,100,58,0)
 F IND=+$O(LIST("HIST",IND)) Q:IND=0  D
"DATA",811.8,75,100,59,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,75,100,60,0)
 . S TEST(NFOUND)=1
"DATA",811.8,75,100,61,0)
 . S DATE(NFOUND)=$P(LIST("HIST",IND,"DATETIME"),U,1)
"DATA",811.8,75,100,62,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"ACTION"))=$P(LIST("HIST",IND,"ACTION"),U,2)
"DATA",811.8,75,100,63,0)
 . S DATA(NFOUND,"APPRVBY")=$P(LIST("HIST",IND,"APPRVBY"),U,2)
"DATA",811.8,75,100,64,0)
 . S DATA(NFOUND,"ASSIGN DT")=$P(LIST("ASSIGNDT"),U,1)
"DATA",811.8,75,100,65,0)
 . S DATA(NFOUND,"CATEGORY")=$P(LIST("CATEGORY"),U,2)
"DATA",811.8,75,100,66,0)
 . S DATA(NFOUND,"FLAGTYPE")=$P(LIST("FLAGTYPE"),U,2)
"DATA",811.8,75,100,67,0)
 . S DATA(NFOUND,"REVIEW DT")=$P(LIST("REVIEWDT"),U,1)
"DATA",811.8,75,100,68,0)
 . S DATA(NFOUND,"TIU TITLE")=$P(LIST("TIUTITLE"),U,2)
"DATA",811.8,75,100,69,0)
 . S TEMP="\\Flag - "_$P(LIST("FLAG"),U,2)_"("_DATA(NFOUND,"CATEGORY")_")."
"DATA",811.8,75,100,70,0)
 . S TEMP=TEMP_"\\Assigned "_$P(LIST("ASSIGNDT"),U,2)_" by "_DATA(NFOUND,"APPRVBY")_". "
"DATA",811.8,75,100,71,0)
 . S TEMP=TEMP_LIST("HIST",IND,"COMMENT",1,0)
"DATA",811.8,75,100,72,0)
 . S TEXT(NFOUND)=TEMP
"DATA",811.8,75,100,73,0)
 Q
"DATA",811.8,75,100,74,0)
 ;
"DATA",811.8,75,100,75,0)
 ;==========================================
"DATA",811.8,75,100,76,0)
GETLST(NGET,BDT,EDT,PLIST,PARAM) ;VA-PATIENT RECORD FLAG LIST computed finding.
"DATA",811.8,75,100,77,0)
 ;Return a list of patients with a specified record flag.
"DATA",811.8,75,100,78,0)
 N BDTNT,DATE,DFN,EDTNT,FLAGCAT,FLAGNAME,IND,LIST,RESULT
"DATA",811.8,75,100,79,0)
 K ^TMP($J,PLIST)
"DATA",811.8,75,100,80,0)
 I PARAM="" Q
"DATA",811.8,75,100,81,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,75,100,82,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,75,100,83,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,75,100,84,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,75,100,85,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,75,100,86,0)
 ;DBIA #5491
"DATA",811.8,75,100,87,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,75,100,88,0)
 ;DBIA #4903
"DATA",811.8,75,100,89,0)
 S RESULT=$$GETLST^DGPFAPIH(FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,75,100,90,0)
 I RESULT=0 Q
"DATA",811.8,75,100,91,0)
 S DFN=0
"DATA",811.8,75,100,92,0)
 F  S DFN=+$O(LIST(DFN)) Q:DFN=0  S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(DFN,0),U,3)_U_U_U
"DATA",811.8,75,100,93,0)
 Q
"DATA",811.8,75,100,94,0)
 ;
"DATA",811.8,75,100,95,0)
 ;==========================================
"DATA",811.8,75,100,96,0)
PRF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Computed finding for
"DATA",811.8,75,100,97,0)
 ;getting a list of the patient's active flags.
"DATA",811.8,75,100,98,0)
 N ASSIGNDT,CAT,DONE,FLAG,FLAGKEEP,FLAGLIST,IND
"DATA",811.8,75,100,99,0)
 N NFLAGS,NOCC,OK,SDIR,SUB,TEMP,TYPE
"DATA",811.8,75,100,100,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,75,100,101,0)
 ;DBIA #3860
"DATA",811.8,75,100,102,0)
 S NFLAGS=$$GETACT^DGPFAPI(DFN,"FLAGLIST")
"DATA",811.8,75,100,103,0)
 ;If no flags are found quit
"DATA",811.8,75,100,104,0)
 I NFLAGS=0 S NFOUND=0 Q
"DATA",811.8,75,100,105,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,75,100,106,0)
 S NOCC=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,75,100,107,0)
 ;Search the parameter list for category, type, and flag.
"DATA",811.8,75,100,108,0)
 S CAT=$F(TEST,"C:")
"DATA",811.8,75,100,109,0)
 I CAT>0 S CAT=$E(TEST,CAT),CAT=$S(CAT="N":"NATIONAL",CAT="L":"LOCAL")
"DATA",811.8,75,100,110,0)
 S TYPE=$F(TEST,"T:")
"DATA",811.8,75,100,111,0)
 I TYPE>0 S TEMP=$E(TEST,TYPE,245),TYPE=$P(TEMP,U,1),TYPE=$S(TYPE="B":"BEHAVIORAL",TYPE="C":"CLINICAL",TYPE="O":"OTHER",TYPE="R":"RESEARCH")
"DATA",811.8,75,100,112,0)
 S FLAG=$F(TEST,"F:")
"DATA",811.8,75,100,113,0)
 I FLAG>0 S TEMP=$E(TEST,FLAG,245),FLAG=$P(TEMP,U,1)
"DATA",811.8,75,100,114,0)
 ;Check all the flags that were returned and keep those that meet
"DATA",811.8,75,100,115,0)
 ;the criteria. Order by assigned date.
"DATA",811.8,75,100,116,0)
 F IND=1:1:NFLAGS D
"DATA",811.8,75,100,117,0)
 . S OK=1
"DATA",811.8,75,100,118,0)
 . I CAT'=0,FLAGLIST(IND,"CATEGORY")'[CAT S OK=0
"DATA",811.8,75,100,119,0)
 . I TYPE'=0,TYPE'=$P(FLAGLIST(IND,"FLAGTYPE"),U,2) S OK=0
"DATA",811.8,75,100,120,0)
 . I FLAG'=0,FLAG'=$P(FLAGLIST(IND,"FLAG"),U,2) S OK=0
"DATA",811.8,75,100,121,0)
 . I OK S FLAGKEEP($P(FLAGLIST(IND,"ASSIGNDT"),U,1),IND)=""
"DATA",811.8,75,100,122,0)
 S ASSIGNDT="",(DONE,NFOUND)=0
"DATA",811.8,75,100,123,0)
 F  S ASSIGNDT=$O(FLAGKEEP(ASSIGNDT),SDIR) Q:(DONE)!(ASSIGNDT="")  D
"DATA",811.8,75,100,124,0)
 . S IND=0
"DATA",811.8,75,100,125,0)
 . F  S IND=$O(FLAGKEEP(ASSIGNDT,IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,75,100,126,0)
 .. S NFOUND=NFOUND+1
"DATA",811.8,75,100,127,0)
 .. I NFOUND=NOCC S DONE=1
"DATA",811.8,75,100,128,0)
 .. S TEST(NFOUND)=1
"DATA",811.8,75,100,129,0)
 .. S DATE(NFOUND)=ASSIGNDT
"DATA",811.8,75,100,130,0)
 .. S SUB=""
"DATA",811.8,75,100,131,0)
 ..;Save the CSUB data.
"DATA",811.8,75,100,132,0)
 .. F  S SUB=$O(FLAGLIST(IND,SUB)) Q:SUB=""  D
"DATA",811.8,75,100,133,0)
 ... I SUB="NARR" Q
"DATA",811.8,75,100,134,0)
 ... S DATA(NFOUND,SUB)=$P($G(FLAGLIST(IND,SUB)),U,2)
"DATA",811.8,75,100,135,0)
 .. S TEXT(NFOUND)=DATA(NFOUND,"FLAG")_"; Category: "_DATA(NFOUND,"CATEGORY")_"; TYPE: "_DATA(NFOUND,"FLAGTYPE")
"DATA",811.8,75,100,136,0)
 Q
"DATA",811.8,75,100,137,0)
 ;
"DATA",811.8,75,100,138,0)
]]>
"DATA",811.8,75,100,139,0)
</CODE>
"DATA",811.8,75,100,140,0)
</M_ROUTINE>
"DATA",811.8,75,100,141,0)
<M_ROUTINE>
"DATA",811.8,75,100,142,0)
<ROUTINE_NAME>PXRMRDI</ROUTINE_NAME>
"DATA",811.8,75,100,143,0)
<CHECKSUM>63045721</CHECKSUM>
"DATA",811.8,75,100,144,0)
<CODE>
"DATA",811.8,75,100,145,0)
<![CDATA[
"DATA",811.8,75,100,146,0)
PXRMRDI ;SLC/PKR - Routines to support RDI list building. ;04/25/2012
"DATA",811.8,75,100,147,0)
 ;;2.0;CLINICAL REMINDERS;**4,17,18,24**;Feb 04, 2005
"DATA",811.8,75,100,148,0)
 ;=========================================================
"DATA",811.8,75,100,149,0)
APPERR(TYPE) ;Handle errors getting appointment data.
"DATA",811.8,75,100,150,0)
 N ECODE,MGIEN,MGROUP,NL,TIME,TO,USER
"DATA",811.8,75,100,151,0)
 S USER=$S($D(ZTQUEUED):DBDUZ,1:DUZ)
"DATA",811.8,75,100,152,0)
 S TIME=$$NOW^XLFDT
"DATA",811.8,75,100,153,0)
 S TIME=$$FMTE^XLFDT(TIME)
"DATA",811.8,75,100,154,0)
 K ^TMP("PXRMXMZ",$J)
"DATA",811.8,75,100,155,0)
 S ^TMP("PXRMXMZ",$J,1,0)="The "_TYPE_" requested by "_$$GET1^DIQ(200,USER,.01)_" on "
"DATA",811.8,75,100,156,0)
 S ^TMP("PXRMXMZ",$J,2,0)=TIME_" requires appointment data which could not be obtained"
"DATA",811.8,75,100,157,0)
 S ^TMP("PXRMXMZ",$J,3,0)="from the Scheduling database due to the following error(s):"
"DATA",811.8,75,100,158,0)
 S ECODE=0,NL=3
"DATA",811.8,75,100,159,0)
 F  S ECODE=$O(^TMP($J,"SDAMA301",ECODE)) Q:ECODE=""  D
"DATA",811.8,75,100,160,0)
 . S NL=NL+1,^TMP("PXRMXMZ",$J,NL,0)=" "_^TMP($J,"SDAMA301",ECODE)
"DATA",811.8,75,100,161,0)
 S TO(DUZ)=""
"DATA",811.8,75,100,162,0)
 S MGIEN=$G(^PXRM(800,1,"MGFE"))
"DATA",811.8,75,100,163,0)
 I MGIEN'="" D
"DATA",811.8,75,100,164,0)
 . S MGROUP="G."_$$GET1^DIQ(3.8,MGIEN,.01)
"DATA",811.8,75,100,165,0)
 . S TO(MGROUP)=""
"DATA",811.8,75,100,166,0)
 D SEND^PXRMMSG("PXRMXMZ","Scheduling database error(s)",.TO,DUZ)
"DATA",811.8,75,100,167,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,75,100,168,0)
 Q
"DATA",811.8,75,100,169,0)
 ;
"DATA",811.8,75,100,170,0)
 ;=========================================================
"DATA",811.8,75,100,171,0)
APPL(NGET,BDT,EDT,PLIST,PARAM) ;List type computed finding that returns
"DATA",811.8,75,100,172,0)
 ;a list of patients with appointments in the date range BDT to EDT.
"DATA",811.8,75,100,173,0)
 N FILTER,FLDS,RESULT
"DATA",811.8,75,100,174,0)
 K ^TMP($J,PLIST),^TMP($J,"SDAMA301")
"DATA",811.8,75,100,175,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,75,100,176,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,75,100,177,0)
 S FILTER("SORT")="P"
"DATA",811.8,75,100,178,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,75,100,179,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,75,100,180,0)
 ;DBIA #4433
"DATA",811.8,75,100,181,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,75,100,182,0)
 I RESULT=-1 D APPERR("Patient List build") Q
"DATA",811.8,75,100,183,0)
 N COUNT,DATE,DFN,DONE,ITEM
"DATA",811.8,75,100,184,0)
 S DFN=""
"DATA",811.8,75,100,185,0)
 F  S DFN=$O(^TMP($J,"SDAMA301",DFN)) Q:DFN=""  D
"DATA",811.8,75,100,186,0)
 . S (COUNT,DONE)=0,DATE=""
"DATA",811.8,75,100,187,0)
 . F  S DATE=$O(^TMP($J,"SDAMA301",DFN,DATE),-1) Q:(DONE)!(DATE="")  D
"DATA",811.8,75,100,188,0)
 .. S COUNT=COUNT+1
"DATA",811.8,75,100,189,0)
 .. S ITEM=$P(^TMP($J,"SDAMA301",DFN,DATE),U,2)
"DATA",811.8,75,100,190,0)
 .. S ^TMP($J,PLIST,DFN,COUNT)=U_DATE_U_44_U_$P(ITEM,";",1)_U_$P(ITEM,";",2)
"DATA",811.8,75,100,191,0)
 .. I COUNT=NGET S DONE=1
"DATA",811.8,75,100,192,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,75,100,193,0)
 Q
"DATA",811.8,75,100,194,0)
 ;
"DATA",811.8,75,100,195,0)
 ;=========================================================
"DATA",811.8,75,100,196,0)
FSTATUS(STATUS) ;Format the STATUS, field #22.
"DATA",811.8,75,100,197,0)
 N TEXT,TMP
"DATA",811.8,75,100,198,0)
 S TMP=$P(STATUS,";",1)
"DATA",811.8,75,100,199,0)
 S TEXT=$S(TMP="":"",1:"Code - "_TMP)
"DATA",811.8,75,100,200,0)
 S TMP=$P(STATUS,";",2)
"DATA",811.8,75,100,201,0)
 I TMP'="" S TEXT=TEXT_"; Description - "_TMP
"DATA",811.8,75,100,202,0)
 S TMP=$P(STATUS,";",3)
"DATA",811.8,75,100,203,0)
 I TMP'="" S TEXT=TEXT_"; Print Status - "_TMP
"DATA",811.8,75,100,204,0)
 S TMP=$P(STATUS,";",4)
"DATA",811.8,75,100,205,0)
 I TMP'="" S TEXT=TEXT_"; Checked In Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,75,100,206,0)
 S TMP=$P(STATUS,";",5)
"DATA",811.8,75,100,207,0)
 I TMP'="" S TEXT=TEXT_"; Checked Out Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,75,100,208,0)
 S TMP=$P(STATUS,";",6)
"DATA",811.8,75,100,209,0)
 I TMP'="" S TEXT=TEXT_"; Admission Movement IFN - "_TMP
"DATA",811.8,75,100,210,0)
 Q TEXT
"DATA",811.8,75,100,211,0)
 ;
"DATA",811.8,75,100,212,0)
 ;=========================================================
"DATA",811.8,75,100,213,0)
PAPPL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Multiple type computed
"DATA",811.8,75,100,214,0)
 ;finding that returns a list appointments for a patient.
"DATA",811.8,75,100,215,0)
 N FIELD,FILTER,FLDS,PARAM,RESULT
"DATA",811.8,75,100,216,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,75,100,217,0)
 S PARAM=TEST K TEST
"DATA",811.8,75,100,218,0)
 S NFOUND=0
"DATA",811.8,75,100,219,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,75,100,220,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,75,100,221,0)
 S FILTER(4)=DFN
"DATA",811.8,75,100,222,0)
 S FILTER("SORT")="P"
"DATA",811.8,75,100,223,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,75,100,224,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,75,100,225,0)
 ;DBIA #4433
"DATA",811.8,75,100,226,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,75,100,227,0)
 I RESULT=-1 D APPERR("Computed finding evaluation") Q
"DATA",811.8,75,100,228,0)
 N ALLNULL,APPDATE,DATALIST,DONE,FLABEL,IND,ITEM,STATUS,TMP
"DATA",811.8,75,100,229,0)
 S FLABEL(1)="APPOINTMENT DATE/TIME"
"DATA",811.8,75,100,230,0)
 S FLABEL(2)="CLINIC"
"DATA",811.8,75,100,231,0)
 S FLABEL(3)="APPOINTMENT STATUS"
"DATA",811.8,75,100,232,0)
 S FLABEL(4)="PATIENT"
"DATA",811.8,75,100,233,0)
 S FLABEL(5)="LENGTH OF APPOINTMENT"
"DATA",811.8,75,100,234,0)
 S FLABEL(6)="COMMENTS"
"DATA",811.8,75,100,235,0)
 S FLABEL(7)="OVERBOOK"
"DATA",811.8,75,100,236,0)
 S FLABEL(8)="ELIGIBILITY OF VISIT"
"DATA",811.8,75,100,237,0)
 S FLABEL(9)="CHECK-IN DATE/TIME"
"DATA",811.8,75,100,238,0)
 S FLABEL(10)="APPOINTMENT TYPE"
"DATA",811.8,75,100,239,0)
 S FLABEL(11)="CHECK-OUT DATE/TIME"
"DATA",811.8,75,100,240,0)
 S FLABEL(12)="OUTPATIENT ENCOUNTER IEN"
"DATA",811.8,75,100,241,0)
 S FLABEL(13)="PRIMARY STOP CODE"
"DATA",811.8,75,100,242,0)
 S FLABEL(14)="CREDIT STOP CODE"
"DATA",811.8,75,100,243,0)
 S FLABEL(15)="WORKLOAD NON-COUNT"
"DATA",811.8,75,100,244,0)
 S FLABEL(16)="DATE APPOINTMENT MADE"
"DATA",811.8,75,100,245,0)
 S FLABEL(17)="DESIRED DATE OF APPOINTMENT"
"DATA",811.8,75,100,246,0)
 S FLABEL(18)="PURPOSE OF VISIT and SHORT DESCRIPTION"
"DATA",811.8,75,100,247,0)
 S FLABEL(19)="EKG DATE/TIME"
"DATA",811.8,75,100,248,0)
 S FLABEL(20)="X-RAY DATE/TIME"
"DATA",811.8,75,100,249,0)
 S FLABEL(21)="LAB DATE/TIME"
"DATA",811.8,75,100,250,0)
 S FLABEL(22)="STATUS"
"DATA",811.8,75,100,251,0)
 S FLABEL(23)="X-RAY FILMS"
"DATA",811.8,75,100,252,0)
 S FLABEL(24)="AUTO-REBOOKED APPOINTMENT DATE/TIME"
"DATA",811.8,75,100,253,0)
 S FLABEL(25)="NO-SHOW/CANCEL DATE/TIME"
"DATA",811.8,75,100,254,0)
 S FLABEL(26)="RSA APPOINTMENT ID"
"DATA",811.8,75,100,255,0)
 S FLABEL(28)="DATA ENTRY CLERK"
"DATA",811.8,75,100,256,0)
 S FLABEL(29)="NO-SHOW/CANCELED BY"
"DATA",811.8,75,100,257,0)
 S FLABEL(30)="CHECK-IN USER"
"DATA",811.8,75,100,258,0)
 S FLABEL(31)="CHECK-OUT USER"
"DATA",811.8,75,100,259,0)
 S FLABEL(32)="CANCELLATION REASON"
"DATA",811.8,75,100,260,0)
 S FLABEL(33)="CONSULT LINK"
"DATA",811.8,75,100,261,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,75,100,262,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,75,100,263,0)
 S APPDATE="",DONE=0
"DATA",811.8,75,100,264,0)
 F  S APPDATE=$O(^TMP($J,"SDAMA301",DFN,APPDATE),SDIR) Q:(DONE)!(APPDATE="")  D
"DATA",811.8,75,100,265,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,75,100,266,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=APPDATE
"DATA",811.8,75,100,267,0)
 .;Fields 1-26
"DATA",811.8,75,100,268,0)
 . S DATALIST=$G(^TMP($J,"SDAMA301",DFN,APPDATE))
"DATA",811.8,75,100,269,0)
 .;Fields 28-33
"DATA",811.8,75,100,270,0)
 . S TMP=$G(^TMP($J,"SDAMA301",DFN,APPDATE,0))
"DATA",811.8,75,100,271,0)
 . S ALLNULL=1
"DATA",811.8,75,100,272,0)
 . I TMP'="" F IND=1:1:$L(TMP,U) I $P(TMP,U,IND)'="" S ALLNULL=0
"DATA",811.8,75,100,273,0)
 . I 'ALLNULL S $P(DATALIST,U,28)=TMP
"DATA",811.8,75,100,274,0)
 . F IND=1:1:$L(DATALIST,U) D
"DATA",811.8,75,100,275,0)
 .. S FIELD=$P(DATALIST,U,IND)
"DATA",811.8,75,100,276,0)
 .. I IND=6 S FIELD=$G(^TMP($J,"SDAMA301",DFN,APPDATE,"C"))
"DATA",811.8,75,100,277,0)
 .. I FIELD="" Q
"DATA",811.8,75,100,278,0)
 .. I IND=22 S STATUS=FIELD
"DATA",811.8,75,100,279,0)
 .. I FLABEL(IND)["DATE" S FIELD=$$EDATE^PXRMDATE(FIELD)
"DATA",811.8,75,100,280,0)
 .. I FIELD[";" S FIELD=$P(FIELD,";",2)
"DATA",811.8,75,100,281,0)
 ..;Save the clinic as the value.
"DATA",811.8,75,100,282,0)
 .. I IND=2 S DATA(NFOUND,"VALUE")=FIELD
"DATA",811.8,75,100,283,0)
 .. I IND=22 S FIELD=$$FSTATUS(STATUS)
"DATA",811.8,75,100,284,0)
 .. S TEXT(NFOUND,IND)=FLABEL(IND)_": "_FIELD
"DATA",811.8,75,100,285,0)
 .. S DATA(NFOUND,FLABEL(IND))=FIELD
"DATA",811.8,75,100,286,0)
 . I NFOUND=NGET S DONE=1
"DATA",811.8,75,100,287,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,75,100,288,0)
 Q
"DATA",811.8,75,100,289,0)
 ;
"DATA",811.8,75,100,290,0)
 ;=========================================================
"DATA",811.8,75,100,291,0)
SFILTER(PARAM,FILTER,FLDS) ;Parse the PARMETER and set the appropriate
"DATA",811.8,75,100,292,0)
 ;fields.
"DATA",811.8,75,100,293,0)
 N IND,LL,P1,P2,STATUS,TEMP
"DATA",811.8,75,100,294,0)
 S (FLDS,LL,STATUS)=""
"DATA",811.8,75,100,295,0)
 F IND=1:1:$L(PARAM,U) D
"DATA",811.8,75,100,296,0)
 . S TEMP=$P(PARAM,U,IND)
"DATA",811.8,75,100,297,0)
 . S P1=$P(TEMP,":",1),P2=$P(TEMP,":",2)
"DATA",811.8,75,100,298,0)
 . I P1="FLDS" S FLDS=$TR(P2,",",";") Q
"DATA",811.8,75,100,299,0)
 . I P1="LL" S LL=P2 Q
"DATA",811.8,75,100,300,0)
 . I P1="STATUS" S STATUS=$TR(P2,",",";") Q
"DATA",811.8,75,100,301,0)
 S FILTER("FLDS")=$S(FLDS="":"1;2",1:FLDS)
"DATA",811.8,75,100,302,0)
 S FILTER(3)=$S(STATUS="":"I;R",1:STATUS)
"DATA",811.8,75,100,303,0)
 I LL="" Q
"DATA",811.8,75,100,304,0)
 S LL=$O(^PXRMD(810.9,"B",LL,""))
"DATA",811.8,75,100,305,0)
 I LL="" S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NO LL")="Location List "_P2_" does not exist."
"DATA",811.8,75,100,306,0)
 D LOCLIST^PXRMLOCF(LL,"HLOCL")
"DATA",811.8,75,100,307,0)
 I $D(^TMP($J,"HLOCL")) S FILTER(2)="^TMP($J,""HLOCL"","
"DATA",811.8,75,100,308,0)
 Q
"DATA",811.8,75,100,309,0)
 ;
"DATA",811.8,75,100,310,0)
 ;=========================================================
"DATA",811.8,75,100,311,0)
TFL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Multiple type computed
"DATA",811.8,75,100,312,0)
 ;finding for a patient's treating facility list.
"DATA",811.8,75,100,313,0)
 N DONE,IND,NOW,SDIR,TDATE,TFL,TFLD
"DATA",811.8,75,100,314,0)
 S NFOUND=0
"DATA",811.8,75,100,315,0)
 ;DBIA #2990
"DATA",811.8,75,100,316,0)
 D TFL^VAFCTFU1(.TFL,DFN)
"DATA",811.8,75,100,317,0)
 I +TFL(1)=-1 Q
"DATA",811.8,75,100,318,0)
 S NOW=$$NOW^PXRMDATE
"DATA",811.8,75,100,319,0)
 S (DONE,IND)=0
"DATA",811.8,75,100,320,0)
 F  S IND=$O(TFL(IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,75,100,321,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,75,100,322,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=NOW
"DATA",811.8,75,100,323,0)
 . S VALUE(NFOUND,"VALUE")=TFL(IND)
"DATA",811.8,75,100,324,0)
 . I NFOUND=NGET S DONE=1 Q
"DATA",811.8,75,100,325,0)
 F IND=1:1:NFOUND S VALUE(IND,"NUM FACILITIES")=NFOUND
"DATA",811.8,75,100,326,0)
 Q
"DATA",811.8,75,100,327,0)
 ;
"DATA",811.8,75,100,328,0)
]]>
"DATA",811.8,75,100,329,0)
</CODE>
"DATA",811.8,75,100,330,0)
</M_ROUTINE>
"DATA",811.8,75,100,331,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,332,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,333,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,334,0)
<POINT_01>MH NOSHOW MANAGEMENT</POINT_01>
"DATA",811.8,75,100,335,0)
<INTERNAL_ENTRY_NUMBER>660160</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,336,0)
<CHECKSUM>3718963363</CHECKSUM>
"DATA",811.8,75,100,337,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,338,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,339,0)
<![CDATA[
"DATA",811.8,75,100,340,0)
9999999.64;+660160,;.01~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,341,0)
9999999.64;+660160,;.1~CATEGORY
"DATA",811.8,75,100,342,0)
]]>
"DATA",811.8,75,100,343,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,344,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,345,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,346,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,347,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,348,0)
<POINT_01>MH SUICIDE COMPLETED</POINT_01>
"DATA",811.8,75,100,349,0)
<INTERNAL_ENTRY_NUMBER>660187</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,350,0)
<CHECKSUM>3955573563</CHECKSUM>
"DATA",811.8,75,100,351,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,352,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,353,0)
<![CDATA[
"DATA",811.8,75,100,354,0)
9999999.64;+660187,;.01~MH SUICIDE COMPLETED
"DATA",811.8,75,100,355,0)
9999999.64;+660187,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,356,0)
9999999.64;+660187,;.08~YES
"DATA",811.8,75,100,357,0)
9999999.64;+660187,;.1~FACTOR
"DATA",811.8,75,100,358,0)
]]>
"DATA",811.8,75,100,359,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,360,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,361,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,362,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,363,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,364,0)
<POINT_01>MH SUICIDE ATTEMPTED</POINT_01>
"DATA",811.8,75,100,365,0)
<INTERNAL_ENTRY_NUMBER>660186</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,366,0)
<CHECKSUM>3876509534</CHECKSUM>
"DATA",811.8,75,100,367,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,368,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,369,0)
<![CDATA[
"DATA",811.8,75,100,370,0)
9999999.64;+660186,;.01~MH SUICIDE ATTEMPTED
"DATA",811.8,75,100,371,0)
9999999.64;+660186,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,372,0)
9999999.64;+660186,;.08~YES
"DATA",811.8,75,100,373,0)
9999999.64;+660186,;.1~FACTOR
"DATA",811.8,75,100,374,0)
]]>
"DATA",811.8,75,100,375,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,376,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,377,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,378,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,379,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,380,0)
<POINT_01>MH NOSHOW OTHER OUTCOME</POINT_01>
"DATA",811.8,75,100,381,0)
<INTERNAL_ENTRY_NUMBER>660169</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,382,0)
<CHECKSUM>1799111522</CHECKSUM>
"DATA",811.8,75,100,383,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,384,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,385,0)
<![CDATA[
"DATA",811.8,75,100,386,0)
9999999.64;+660169,;.01~MH NOSHOW OTHER OUTCOME
"DATA",811.8,75,100,387,0)
9999999.64;+660169,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,388,0)
9999999.64;+660169,;.08~YES
"DATA",811.8,75,100,389,0)
9999999.64;+660169,;.1~FACTOR
"DATA",811.8,75,100,390,0)
]]>
"DATA",811.8,75,100,391,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,392,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,393,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,394,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,395,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,396,0)
<POINT_01>MH NOSHOW OUTREACH LETTER</POINT_01>
"DATA",811.8,75,100,397,0)
<INTERNAL_ENTRY_NUMBER>660168</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,398,0)
<CHECKSUM>1639152510</CHECKSUM>
"DATA",811.8,75,100,399,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,400,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,401,0)
<![CDATA[
"DATA",811.8,75,100,402,0)
9999999.64;+660168,;.01~MH NOSHOW OUTREACH LETTER
"DATA",811.8,75,100,403,0)
9999999.64;+660168,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,404,0)
9999999.64;+660168,;.08~YES
"DATA",811.8,75,100,405,0)
9999999.64;+660168,;.1~FACTOR
"DATA",811.8,75,100,406,0)
]]>
"DATA",811.8,75,100,407,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,408,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,409,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,410,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,411,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,412,0)
<POINT_01>MH NOSHOW PLAN DEVELOPED</POINT_01>
"DATA",811.8,75,100,413,0)
<INTERNAL_ENTRY_NUMBER>660166</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,414,0)
<CHECKSUM>327579390</CHECKSUM>
"DATA",811.8,75,100,415,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,416,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,417,0)
<![CDATA[
"DATA",811.8,75,100,418,0)
9999999.64;+660166,;.01~MH NOSHOW PLAN DEVELOPED
"DATA",811.8,75,100,419,0)
9999999.64;+660166,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,420,0)
9999999.64;+660166,;.08~YES
"DATA",811.8,75,100,421,0)
9999999.64;+660166,;.1~FACTOR
"DATA",811.8,75,100,422,0)
]]>
"DATA",811.8,75,100,423,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,424,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,425,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,426,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,427,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,428,0)
<POINT_01>MH NOSHOW PT CALLED 3X UNSUCCESSFUL</POINT_01>
"DATA",811.8,75,100,429,0)
<INTERNAL_ENTRY_NUMBER>660164</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,430,0)
<CHECKSUM>1653828879</CHECKSUM>
"DATA",811.8,75,100,431,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,432,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,433,0)
<![CDATA[
"DATA",811.8,75,100,434,0)
9999999.64;+660164,;.01~MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,75,100,435,0)
9999999.64;+660164,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,436,0)
9999999.64;+660164,;.08~YES
"DATA",811.8,75,100,437,0)
9999999.64;+660164,;.1~FACTOR
"DATA",811.8,75,100,438,0)
]]>
"DATA",811.8,75,100,439,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,440,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,441,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,442,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,443,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,444,0)
<POINT_01>MH NOSHOW PT EMERGENT CARE</POINT_01>
"DATA",811.8,75,100,445,0)
<INTERNAL_ENTRY_NUMBER>660162</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,446,0)
<CHECKSUM>1113440761</CHECKSUM>
"DATA",811.8,75,100,447,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,448,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,449,0)
<![CDATA[
"DATA",811.8,75,100,450,0)
9999999.64;+660162,;.01~MH NOSHOW PT EMERGENT CARE
"DATA",811.8,75,100,451,0)
9999999.64;+660162,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,452,0)
9999999.64;+660162,;.08~YES
"DATA",811.8,75,100,453,0)
9999999.64;+660162,;.1~FACTOR
"DATA",811.8,75,100,454,0)
]]>
"DATA",811.8,75,100,455,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,456,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,457,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,458,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,75,100,459,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,75,100,460,0)
<POINT_01>MH NOSHOW PT CONTACTED</POINT_01>
"DATA",811.8,75,100,461,0)
<INTERNAL_ENTRY_NUMBER>660161</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,462,0)
<CHECKSUM>4190754155</CHECKSUM>
"DATA",811.8,75,100,463,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,464,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,465,0)
<![CDATA[
"DATA",811.8,75,100,466,0)
9999999.64;+660161,;.01~MH NOSHOW PT CONTACTED
"DATA",811.8,75,100,467,0)
9999999.64;+660161,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,75,100,468,0)
9999999.64;+660161,;.08~YES
"DATA",811.8,75,100,469,0)
9999999.64;+660161,;.1~FACTOR
"DATA",811.8,75,100,470,0)
]]>
"DATA",811.8,75,100,471,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,472,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,473,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,474,0)
<FILE_NAME>REMINDER SPONSOR</FILE_NAME>
"DATA",811.8,75,100,475,0)
<FILE_NUMBER>811.6</FILE_NUMBER>
"DATA",811.8,75,100,476,0)
<POINT_01>Office of Mental Health Services</POINT_01>
"DATA",811.8,75,100,477,0)
<INTERNAL_ENTRY_NUMBER>11</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,478,0)
<CHECKSUM>1503526438</CHECKSUM>
"DATA",811.8,75,100,479,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,480,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,481,0)
<![CDATA[
"DATA",811.8,75,100,482,0)
811.6;+11,;.01~Office of Mental Health Services
"DATA",811.8,75,100,483,0)
811.6;+11,;100~NATIONAL
"DATA",811.8,75,100,484,0)
811.61;+12,+11,;.01~Mental Health and Behavioral Science Strategic Group
"DATA",811.8,75,100,485,0)
811.61;+12,+11,;1~WP-start~4
"DATA",811.8,75,100,486,0)
Amy Street, PhD
"DATA",811.8,75,100,487,0)
Women's Health Sciences Division, National Center for PTSD
"DATA",811.8,75,100,488,0)
VA Boston HCS
"DATA",811.8,75,100,489,0)
(617) 232-9500, ext. 5111
"DATA",811.8,75,100,490,0)
811.63;+13,+11,;.01~12/06/2012@15:22
"DATA",811.8,75,100,491,0)
811.63;+13,+11,;2~WP-start~1
"DATA",811.8,75,100,492,0)
Exchange Stub
"DATA",811.8,75,100,493,0)
]]>
"DATA",811.8,75,100,494,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,495,0)
<IEN_ROOT>
"DATA",811.8,75,100,496,0)
<![CDATA[
"DATA",811.8,75,100,497,0)
12^1
"DATA",811.8,75,100,498,0)
13^1
"DATA",811.8,75,100,499,0)
]]>
"DATA",811.8,75,100,500,0)
</IEN_ROOT>
"DATA",811.8,75,100,501,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,502,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,503,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,75,100,504,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,75,100,505,0)
<POINT_01>VA-APPOINTMENTS FOR A PATIENT</POINT_01>
"DATA",811.8,75,100,506,0)
<INTERNAL_ENTRY_NUMBER>15</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,507,0)
<CHECKSUM>3006509961</CHECKSUM>
"DATA",811.8,75,100,508,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,509,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,510,0)
<![CDATA[
"DATA",811.8,75,100,511,0)
811.4;+15,;.01~VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,75,100,512,0)
811.4;+15,;.02~PXRMRDI
"DATA",811.8,75,100,513,0)
811.4;+15,;.03~PAPPL
"DATA",811.8,75,100,514,0)
811.4;+15,;.04~VA-Appointments for a Patient
"DATA",811.8,75,100,515,0)
811.4;+15,;1~WP-start~119
"DATA",811.8,75,100,516,0)
This multiple occurrence computed finding returns a list of
"DATA",811.8,75,100,517,0)
appointments for a patient in the specified date range from 
"DATA",811.8,75,100,518,0)
the Scheduling Package. 
"DATA",811.8,75,100,519,0)

"DATA",811.8,75,100,520,0)
The Computed Finding Parameter can be used to specify which 
"DATA",811.8,75,100,521,0)
appointment data fields should be returned from the Scheduling 
"DATA",811.8,75,100,522,0)
package and filter the results returned based on location 
"DATA",811.8,75,100,523,0)
and status. The Computed Finding Parameter entry uses
"DATA",811.8,75,100,524,0)
FLDS: to specify appointment data fields, STATUS: to filter 
"DATA",811.8,75,100,525,0)
specific statuses, and LL: to specify a Reminder Location List 
"DATA",811.8,75,100,526,0)
to filter locations.  
"DATA",811.8,75,100,527,0)

"DATA",811.8,75,100,528,0)
FLDS, STATUS, and LL are all optional and can be defined in any 
"DATA",811.8,75,100,529,0)
order in the computed finding parameter field.
"DATA",811.8,75,100,530,0)
Some examples of how to use FLDS, STATUS and/or LL:
"DATA",811.8,75,100,531,0)
  FLDS:1,2,16^STATUS:R^LL:DIABETIC LOCATIONS
"DATA",811.8,75,100,532,0)
  STATUS:CP,CC^FLDS:25
"DATA",811.8,75,100,533,0)
  LL:DIABETIC LOCATION
"DATA",811.8,75,100,534,0)

"DATA",811.8,75,100,535,0)
FLDS parameter information:
"DATA",811.8,75,100,536,0)
The appointment data fields are specified as follows:  
"DATA",811.8,75,100,537,0)
FLDS:F1,F2,... where F1,F2,... are any of the possible ID values
"DATA",811.8,75,100,538,0)
listed in the Available Appointment Data Fields table below.
"DATA",811.8,75,100,539,0)
The F1,F2,... ID values specify what data associated with the 
"DATA",811.8,75,100,540,0)
appointment will display in the clinical maintenance output. 
"DATA",811.8,75,100,541,0)
If no FLDS is specified, the default display fields will be 1,2
"DATA",811.8,75,100,542,0)
for APPOINTMENT DATE/TIME and CLINIC. 
"DATA",811.8,75,100,543,0)

"DATA",811.8,75,100,544,0)
Additionally, each F1,F2,... specified will be returned as CSUB 
"DATA",811.8,75,100,545,0)
data that can also be used in the computed finding's CONDITION
"DATA",811.8,75,100,546,0)
field. The CONDITION can be used to further screen the filtered
"DATA",811.8,75,100,547,0)
appointments, returned by Scheduling, by setting the USE STATUS/COND
"DATA",811.8,75,100,548,0)
IN SEARCH field to YES. 
"DATA",811.8,75,100,549,0)

"DATA",811.8,75,100,550,0)
For example, if you only want appointments that were checked out, 
"DATA",811.8,75,100,551,0)
use FLDS: 1,2,11 to get the APPOINTMENT DATE/TIME, CLINIC, and 
"DATA",811.8,75,100,552,0)
CHECK-OUT DATE/TIME for display purposes. The FLDS:1,2,11 will
"DATA",811.8,75,100,553,0)
return the CSUB data "APPOINTMENT DATE/TIME", "CLINIC" and 
"DATA",811.8,75,100,554,0)
"CHECK-OUT DATE/TIME".
"DATA",811.8,75,100,555,0)

"DATA",811.8,75,100,556,0)
CSUB values are used in the CONDITION field to do a comparison to
"DATA",811.8,75,100,557,0)
numeric or string values. Using +V causes the CSUB data to be
"DATA",811.8,75,100,558,0)
interpreted as numeric. Strings that cannot be converted to a
"DATA",811.8,75,100,559,0)
number are set to zero. For example, a CONDITION such as I
"DATA",811.8,75,100,560,0)
+V("CHECK-OUT DATE/TIME")>0 would be true if the appointment had a
"DATA",811.8,75,100,561,0)
check-out date/time.
"DATA",811.8,75,100,562,0)

"DATA",811.8,75,100,563,0)
List of Available Appointment Data Fields table with assigned ID
"DATA",811.8,75,100,564,0)
    ID      Field Name
"DATA",811.8,75,100,565,0)
--------------------------------------------------------
"DATA",811.8,75,100,566,0)

"DATA",811.8,75,100,567,0)
     1     APPOINTMENT DATE/TIME
"DATA",811.8,75,100,568,0)
     2     CLINIC
"DATA",811.8,75,100,569,0)
     3     APPOINTMENT STATUS     
"DATA",811.8,75,100,570,0)
     4     PATIENT
"DATA",811.8,75,100,571,0)
     5     LENGTH OF APPOINTMENT
"DATA",811.8,75,100,572,0)
     6     COMMENTS
"DATA",811.8,75,100,573,0)
     7     OVERBOOK
"DATA",811.8,75,100,574,0)
     8     ELIGIBILITY OF VISIT
"DATA",811.8,75,100,575,0)
     9     CHECK-IN DATE/TIME
"DATA",811.8,75,100,576,0)
    10     APPOINTMENT TYPE
"DATA",811.8,75,100,577,0)
    11     CHECK-OUT DATE/TIME
"DATA",811.8,75,100,578,0)
    12     OUTPATIENT ENCOUNTER IEN
"DATA",811.8,75,100,579,0)
    13     PRIMARY STOP CODE
"DATA",811.8,75,100,580,0)
    14     CREDIT STOP CODE
"DATA",811.8,75,100,581,0)
    15     WORKLOAD NON-COUNT
"DATA",811.8,75,100,582,0)
    16     DATE APPOINTMENT MADE
"DATA",811.8,75,100,583,0)
    17     DESIRED DATE OF APPOINTMENT
"DATA",811.8,75,100,584,0)
    18     PURPOSE OF VISIT and SHORT DESCRIPTION
"DATA",811.8,75,100,585,0)
    19     EKG DATE/TIME
"DATA",811.8,75,100,586,0)
    20     X-RAY DATE/TIME
"DATA",811.8,75,100,587,0)
    21     LAB DATE/TIME
"DATA",811.8,75,100,588,0)
    22     STATUS
"DATA",811.8,75,100,589,0)
    23     X-RAY FILMS
"DATA",811.8,75,100,590,0)
    24     AUTO-REBOOKED APPOINTMENT DATE/TIME
"DATA",811.8,75,100,591,0)
    25     NO-SHOW/CANCEL DATE/TIME
"DATA",811.8,75,100,592,0)
    26     RSA APPOINTMENT ID
"DATA",811.8,75,100,593,0)
    28     DATA ENTRY CLERK
"DATA",811.8,75,100,594,0)
    29     NO-SHOW/CANCELED BY
"DATA",811.8,75,100,595,0)
    30     CHECK-IN USER
"DATA",811.8,75,100,596,0)
    31     CHECK-OUT USER
"DATA",811.8,75,100,597,0)
    32     CANCELLATION REASON
"DATA",811.8,75,100,598,0)
    33     CONSULT LINK
"DATA",811.8,75,100,599,0)

"DATA",811.8,75,100,600,0)
STATUS information:
"DATA",811.8,75,100,601,0)
STATUS: is used to set a filter on the appointment status; only
"DATA",811.8,75,100,602,0)
those appointments with a status that matches the STATUS: values
"DATA",811.8,75,100,603,0)
list will be returned. The possible values that the Scheduling
"DATA",811.8,75,100,604,0)
API allows are:
"DATA",811.8,75,100,605,0)

"DATA",811.8,75,100,606,0)
VALUE     Description 
"DATA",811.8,75,100,607,0)
--------------------------------------------------------
"DATA",811.8,75,100,608,0)
    R      SCHEDULED/KEPT
"DATA",811.8,75,100,609,0)
    I      INPATIENT
"DATA",811.8,75,100,610,0)
    NS     NO-SHOW
"DATA",811.8,75,100,611,0)
    NSR    NO-SHOW, RESCHEDULED
"DATA",811.8,75,100,612,0)
    CP     CANCELLED BY PATIENT
"DATA",811.8,75,100,613,0)
    CPR    CANCELLED BY PATIENT, RESCHEDULED
"DATA",811.8,75,100,614,0)
    CC     CANCELLED BY CLINIC
"DATA",811.8,75,100,615,0)
    CCR    CANCELLED BY CLINIC, RESCHEDULED 
"DATA",811.8,75,100,616,0)
    NT     NO ACTION TAKEN
"DATA",811.8,75,100,617,0)

"DATA",811.8,75,100,618,0)
If STATUS is not specified, the default is R,I.
"DATA",811.8,75,100,619,0)

"DATA",811.8,75,100,620,0)
The APPOINTMENT STATUS returned by the API is a summarized list
"DATA",811.8,75,100,621,0)
which does not include detailed statuses such as Future, Checked-In,
"DATA",811.8,75,100,622,0)
or Checked Out. These  statuses are summarized as SCHEDULED/KEPT. 
"DATA",811.8,75,100,623,0)
As a result, a CONDITION may be required to make sure you are
"DATA",811.8,75,100,624,0)
getting the correct results. For example, if you are looking for an
"DATA",811.8,75,100,625,0)
appointment that was kept, you would set STATUS:R combined with a
"DATA",811.8,75,100,626,0)
CONDITION of I (+V("OUTPATIENT ENCOUNTER IEN")>0)!(+V("CHECK-OUT
"DATA",811.8,75,100,627,0)
DATE/TIME")>0) with USE STATUS/COND IN SEARCH set to YES.
"DATA",811.8,75,100,628,0)

"DATA",811.8,75,100,629,0)
LL information:
"DATA",811.8,75,100,630,0)
LL:Reminder Location List specifies a list of locations so that only
"DATA",811.8,75,100,631,0)
appointments for those locations will be returned. If LL is not
"DATA",811.8,75,100,632,0)
specified, then appointments for all locations will be returned.
"DATA",811.8,75,100,633,0)

"DATA",811.8,75,100,634,0)

"DATA",811.8,75,100,635,0)
811.4;+15,;5~MULTIPLE
"DATA",811.8,75,100,636,0)
811.4;+15,;6~NO
"DATA",811.8,75,100,637,0)
811.4;+15,;100~NATIONAL
"DATA",811.8,75,100,638,0)
811.42;+16,+15,;.01~12/06/2012@15:22
"DATA",811.8,75,100,639,0)
811.42;+16,+15,;2~WP-start~1
"DATA",811.8,75,100,640,0)
Exchange Stub
"DATA",811.8,75,100,641,0)
]]>
"DATA",811.8,75,100,642,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,643,0)
<IEN_ROOT>
"DATA",811.8,75,100,644,0)
<![CDATA[
"DATA",811.8,75,100,645,0)
16^1
"DATA",811.8,75,100,646,0)
]]>
"DATA",811.8,75,100,647,0)
</IEN_ROOT>
"DATA",811.8,75,100,648,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,649,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,650,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,75,100,651,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,75,100,652,0)
<POINT_01>VA-PATIENT RECORD FLAG INFORMATION</POINT_01>
"DATA",811.8,75,100,653,0)
<INTERNAL_ENTRY_NUMBER>75</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,654,0)
<CHECKSUM>926715250</CHECKSUM>
"DATA",811.8,75,100,655,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,656,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,657,0)
<![CDATA[
"DATA",811.8,75,100,658,0)
811.4;+75,;.01~VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,75,100,659,0)
811.4;+75,;.02~PXRMPRF
"DATA",811.8,75,100,660,0)
811.4;+75,;.03~GETINF
"DATA",811.8,75,100,661,0)
811.4;+75,;.04~VA-Patient Record Flag Information
"DATA",811.8,75,100,662,0)
811.4;+75,;1~WP-start~26
"DATA",811.8,75,100,663,0)
This multiple type computed finding returns information about a
"DATA",811.8,75,100,664,0)
specified patient record flag for a patient. The Computed Finding
"DATA",811.8,75,100,665,0)
Parameter is used to specify the flag in the following format:
"DATA",811.8,75,100,666,0)
FLAG NAME^FLAG TYPE
"DATA",811.8,75,100,667,0)

"DATA",811.8,75,100,668,0)
Where FLAG NAME is the exact name of the flag and FLAG TYPE is L for
"DATA",811.8,75,100,669,0)
local or N for national. FLAG TYPE is optional and defaults to L.
"DATA",811.8,75,100,670,0)

"DATA",811.8,75,100,671,0)
The computed finding will be true if the flag was active at any time in
"DATA",811.8,75,100,672,0)
the date range.
"DATA",811.8,75,100,673,0)

"DATA",811.8,75,100,674,0)
The following "CSUBS" are available:
"DATA",811.8,75,100,675,0)

"DATA",811.8,75,100,676,0)
   "ACTION" The action
"DATA",811.8,75,100,677,0)
  "APPRVBY" Approved by
"DATA",811.8,75,100,678,0)
"ASSIGN DT" Date and time the flag was assigned
"DATA",811.8,75,100,679,0)
 "CATEGORY" The category
"DATA",811.8,75,100,680,0)
     "DATE" Date of the action
"DATA",811.8,75,100,681,0)
 "FLAGTYPE" Flag type
"DATA",811.8,75,100,682,0)
"REVIEW DT" Review date
"DATA",811.8,75,100,683,0)
"TIU TITLE" TIU title associated with the flag
"DATA",811.8,75,100,684,0)

"DATA",811.8,75,100,685,0)

"DATA",811.8,75,100,686,0)

"DATA",811.8,75,100,687,0)

"DATA",811.8,75,100,688,0)

"DATA",811.8,75,100,689,0)
811.4;+75,;5~MULTIPLE
"DATA",811.8,75,100,690,0)
811.4;+75,;6~YES
"DATA",811.8,75,100,691,0)
811.4;+75,;100~NATIONAL
"DATA",811.8,75,100,692,0)
811.42;+76,+75,;.01~12/06/2012@15:22:01
"DATA",811.8,75,100,693,0)
811.42;+76,+75,;2~WP-start~1
"DATA",811.8,75,100,694,0)
Exchange Stub
"DATA",811.8,75,100,695,0)
]]>
"DATA",811.8,75,100,696,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,697,0)
<IEN_ROOT>
"DATA",811.8,75,100,698,0)
<![CDATA[
"DATA",811.8,75,100,699,0)
76^1
"DATA",811.8,75,100,700,0)
]]>
"DATA",811.8,75,100,701,0)
</IEN_ROOT>
"DATA",811.8,75,100,702,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,703,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,704,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,705,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,706,0)
<POINT_01>VA-MH APPT KEPT</POINT_01>
"DATA",811.8,75,100,707,0)
<INTERNAL_ENTRY_NUMBER>835</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,708,0)
<CHECKSUM>2483527531</CHECKSUM>
"DATA",811.8,75,100,709,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,710,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,711,0)
<![CDATA[
"DATA",811.8,75,100,712,0)
811.5;+835,;.01~VA-MH APPT KEPT
"DATA",811.8,75,100,713,0)
811.5;+835,;100~NATIONAL
"DATA",811.8,75,100,714,0)
811.5;+835,;101~Office of Mental Health Services
"DATA",811.8,75,100,715,0)
811.52;+836,+835,;.01~CF.VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,75,100,716,0)
811.52;+836,+835,;14~I +V("OUTPATIENT ENCOUNTER IEN")>0!(+V("CHECK-OUT DATE/TIME")>0)
"DATA",811.8,75,100,717,0)
811.52;+836,+835,;22~I +$G(V("OUTPATIENT ENCOUNTER IEN"))>0!(+$G(V("CHECK-OUT DATE/TIME"))>0)
"DATA",811.8,75,100,718,0)
811.52;+836,+835,;23~"OUTPATIENT ENCOUNTER IEN";"CHECK-OUT DATE/TIME";
"DATA",811.8,75,100,719,0)
811.52;+836,+835,;26~FLDS:1,2,3,11,12^STATUS:R^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,75,100,720,0)
811.53;+837,+835,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,721,0)
811.53;+837,+835,;2~WP-start~1
"DATA",811.8,75,100,722,0)
Exchange Stub
"DATA",811.8,75,100,723,0)
]]>
"DATA",811.8,75,100,724,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,725,0)
<IEN_ROOT>
"DATA",811.8,75,100,726,0)
<![CDATA[
"DATA",811.8,75,100,727,0)
836^1
"DATA",811.8,75,100,728,0)
837^1
"DATA",811.8,75,100,729,0)
]]>
"DATA",811.8,75,100,730,0)
</IEN_ROOT>
"DATA",811.8,75,100,731,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,732,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,733,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,734,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,735,0)
<POINT_01>VA-MH SUICIDE COMPLETED</POINT_01>
"DATA",811.8,75,100,736,0)
<INTERNAL_ENTRY_NUMBER>834</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,737,0)
<CHECKSUM>3179049000</CHECKSUM>
"DATA",811.8,75,100,738,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,739,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,740,0)
<![CDATA[
"DATA",811.8,75,100,741,0)
811.5;+834,;.01~VA-MH SUICIDE COMPLETED
"DATA",811.8,75,100,742,0)
811.5;+834,;100~NATIONAL
"DATA",811.8,75,100,743,0)
811.5;+834,;101~Office of Mental Health Services
"DATA",811.8,75,100,744,0)
811.52;+835,+834,;.01~HF.MH SUICIDE COMPLETED
"DATA",811.8,75,100,745,0)
811.53;+836,+834,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,746,0)
811.53;+836,+834,;2~WP-start~1
"DATA",811.8,75,100,747,0)
Exchange Stub
"DATA",811.8,75,100,748,0)
]]>
"DATA",811.8,75,100,749,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,750,0)
<IEN_ROOT>
"DATA",811.8,75,100,751,0)
<![CDATA[
"DATA",811.8,75,100,752,0)
835^1
"DATA",811.8,75,100,753,0)
836^1
"DATA",811.8,75,100,754,0)
]]>
"DATA",811.8,75,100,755,0)
</IEN_ROOT>
"DATA",811.8,75,100,756,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,757,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,758,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,759,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,760,0)
<POINT_01>VA-MH SUICIDE ATTEMPTED</POINT_01>
"DATA",811.8,75,100,761,0)
<INTERNAL_ENTRY_NUMBER>833</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,762,0)
<CHECKSUM>57051385</CHECKSUM>
"DATA",811.8,75,100,763,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,764,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,765,0)
<![CDATA[
"DATA",811.8,75,100,766,0)
811.5;+833,;.01~VA-MH SUICIDE ATTEMPTED
"DATA",811.8,75,100,767,0)
811.5;+833,;100~NATIONAL
"DATA",811.8,75,100,768,0)
811.5;+833,;101~Office of Mental Health Services
"DATA",811.8,75,100,769,0)
811.52;+834,+833,;.01~HF.MH SUICIDE ATTEMPTED
"DATA",811.8,75,100,770,0)
811.53;+835,+833,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,771,0)
811.53;+835,+833,;2~WP-start~1
"DATA",811.8,75,100,772,0)
Exchange Stub
"DATA",811.8,75,100,773,0)
]]>
"DATA",811.8,75,100,774,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,775,0)
<IEN_ROOT>
"DATA",811.8,75,100,776,0)
<![CDATA[
"DATA",811.8,75,100,777,0)
834^1
"DATA",811.8,75,100,778,0)
835^1
"DATA",811.8,75,100,779,0)
]]>
"DATA",811.8,75,100,780,0)
</IEN_ROOT>
"DATA",811.8,75,100,781,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,782,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,783,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,784,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,785,0)
<POINT_01>VA-MH NOSHOW OTHER OUTCOME</POINT_01>
"DATA",811.8,75,100,786,0)
<INTERNAL_ENTRY_NUMBER>831</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,787,0)
<CHECKSUM>2296976961</CHECKSUM>
"DATA",811.8,75,100,788,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,789,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,790,0)
<![CDATA[
"DATA",811.8,75,100,791,0)
811.5;+831,;.01~VA-MH NOSHOW OTHER OUTCOME
"DATA",811.8,75,100,792,0)
811.5;+831,;100~NATIONAL
"DATA",811.8,75,100,793,0)
811.5;+831,;101~Office of Mental Health Services
"DATA",811.8,75,100,794,0)
811.52;+832,+831,;.01~HF.MH NOSHOW OTHER OUTCOME
"DATA",811.8,75,100,795,0)
811.53;+833,+831,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,796,0)
811.53;+833,+831,;2~WP-start~1
"DATA",811.8,75,100,797,0)
Exchange Stub
"DATA",811.8,75,100,798,0)
]]>
"DATA",811.8,75,100,799,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,800,0)
<IEN_ROOT>
"DATA",811.8,75,100,801,0)
<![CDATA[
"DATA",811.8,75,100,802,0)
832^1
"DATA",811.8,75,100,803,0)
833^1
"DATA",811.8,75,100,804,0)
]]>
"DATA",811.8,75,100,805,0)
</IEN_ROOT>
"DATA",811.8,75,100,806,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,807,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,808,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,809,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,810,0)
<POINT_01>VA-MH NOSHOW OUTREACH LETTER</POINT_01>
"DATA",811.8,75,100,811,0)
<INTERNAL_ENTRY_NUMBER>832</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,812,0)
<CHECKSUM>1877947617</CHECKSUM>
"DATA",811.8,75,100,813,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,814,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,815,0)
<![CDATA[
"DATA",811.8,75,100,816,0)
811.5;+832,;.01~VA-MH NOSHOW OUTREACH LETTER
"DATA",811.8,75,100,817,0)
811.5;+832,;100~NATIONAL
"DATA",811.8,75,100,818,0)
811.5;+832,;101~Office of Mental Health Services
"DATA",811.8,75,100,819,0)
811.52;+833,+832,;.01~HF.MH NOSHOW OUTREACH LETTER
"DATA",811.8,75,100,820,0)
811.53;+834,+832,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,821,0)
811.53;+834,+832,;2~WP-start~1
"DATA",811.8,75,100,822,0)
Exchange Stub
"DATA",811.8,75,100,823,0)
]]>
"DATA",811.8,75,100,824,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,825,0)
<IEN_ROOT>
"DATA",811.8,75,100,826,0)
<![CDATA[
"DATA",811.8,75,100,827,0)
833^1
"DATA",811.8,75,100,828,0)
834^1
"DATA",811.8,75,100,829,0)
]]>
"DATA",811.8,75,100,830,0)
</IEN_ROOT>
"DATA",811.8,75,100,831,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,832,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,833,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,834,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,835,0)
<POINT_01>VA-MH NOSHOW PLAN DEVELOPED</POINT_01>
"DATA",811.8,75,100,836,0)
<INTERNAL_ENTRY_NUMBER>827</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,837,0)
<CHECKSUM>999044966</CHECKSUM>
"DATA",811.8,75,100,838,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,839,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,840,0)
<![CDATA[
"DATA",811.8,75,100,841,0)
811.5;+827,;.01~VA-MH NOSHOW PLAN DEVELOPED
"DATA",811.8,75,100,842,0)
811.5;+827,;100~NATIONAL
"DATA",811.8,75,100,843,0)
811.5;+827,;101~Office of Mental Health Services
"DATA",811.8,75,100,844,0)
811.52;+828,+827,;.01~HF.MH NOSHOW PLAN DEVELOPED
"DATA",811.8,75,100,845,0)
811.53;+829,+827,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,846,0)
811.53;+829,+827,;2~WP-start~1
"DATA",811.8,75,100,847,0)
Exchange Stub
"DATA",811.8,75,100,848,0)
]]>
"DATA",811.8,75,100,849,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,850,0)
<IEN_ROOT>
"DATA",811.8,75,100,851,0)
<![CDATA[
"DATA",811.8,75,100,852,0)
828^1
"DATA",811.8,75,100,853,0)
829^1
"DATA",811.8,75,100,854,0)
]]>
"DATA",811.8,75,100,855,0)
</IEN_ROOT>
"DATA",811.8,75,100,856,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,857,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,858,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,859,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,860,0)
<POINT_01>VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL</POINT_01>
"DATA",811.8,75,100,861,0)
<INTERNAL_ENTRY_NUMBER>821</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,862,0)
<CHECKSUM>4087097966</CHECKSUM>
"DATA",811.8,75,100,863,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,864,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,865,0)
<![CDATA[
"DATA",811.8,75,100,866,0)
811.5;+821,;.01~VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,75,100,867,0)
811.5;+821,;100~NATIONAL
"DATA",811.8,75,100,868,0)
811.5;+821,;101~Office of Mental Health Services
"DATA",811.8,75,100,869,0)
811.52;+822,+821,;.01~HF.MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,75,100,870,0)
811.53;+823,+821,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,871,0)
811.53;+823,+821,;2~WP-start~1
"DATA",811.8,75,100,872,0)
Exchange Stub
"DATA",811.8,75,100,873,0)
]]>
"DATA",811.8,75,100,874,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,875,0)
<IEN_ROOT>
"DATA",811.8,75,100,876,0)
<![CDATA[
"DATA",811.8,75,100,877,0)
822^1
"DATA",811.8,75,100,878,0)
823^1
"DATA",811.8,75,100,879,0)
]]>
"DATA",811.8,75,100,880,0)
</IEN_ROOT>
"DATA",811.8,75,100,881,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,882,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,883,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,884,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,885,0)
<POINT_01>VA-MH NOSHOW PT EMERGENT CARE</POINT_01>
"DATA",811.8,75,100,886,0)
<INTERNAL_ENTRY_NUMBER>818</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,887,0)
<CHECKSUM>2154384829</CHECKSUM>
"DATA",811.8,75,100,888,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,889,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,890,0)
<![CDATA[
"DATA",811.8,75,100,891,0)
811.5;+818,;.01~VA-MH NOSHOW PT EMERGENT CARE
"DATA",811.8,75,100,892,0)
811.5;+818,;100~NATIONAL
"DATA",811.8,75,100,893,0)
811.5;+818,;101~Office of Mental Health Services
"DATA",811.8,75,100,894,0)
811.52;+819,+818,;.01~HF.MH NOSHOW PT EMERGENT CARE
"DATA",811.8,75,100,895,0)
811.53;+820,+818,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,896,0)
811.53;+820,+818,;2~WP-start~1
"DATA",811.8,75,100,897,0)
Exchange Stub
"DATA",811.8,75,100,898,0)
]]>
"DATA",811.8,75,100,899,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,900,0)
<IEN_ROOT>
"DATA",811.8,75,100,901,0)
<![CDATA[
"DATA",811.8,75,100,902,0)
819^1
"DATA",811.8,75,100,903,0)
820^1
"DATA",811.8,75,100,904,0)
]]>
"DATA",811.8,75,100,905,0)
</IEN_ROOT>
"DATA",811.8,75,100,906,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,907,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,908,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,909,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,910,0)
<POINT_01>VA-MH NOSHOW PT CONTACTED</POINT_01>
"DATA",811.8,75,100,911,0)
<INTERNAL_ENTRY_NUMBER>812</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,912,0)
<CHECKSUM>2284408963</CHECKSUM>
"DATA",811.8,75,100,913,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,914,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,915,0)
<![CDATA[
"DATA",811.8,75,100,916,0)
811.5;+812,;.01~VA-MH NOSHOW PT CONTACTED
"DATA",811.8,75,100,917,0)
811.5;+812,;1~WP-start~1
"DATA",811.8,75,100,918,0)
This documents that the Patient was successfully contacted.
"DATA",811.8,75,100,919,0)
811.5;+812,;100~NATIONAL
"DATA",811.8,75,100,920,0)
811.5;+812,;101~Office of Mental Health Services
"DATA",811.8,75,100,921,0)
811.52;+813,+812,;.01~HF.MH NOSHOW PT CONTACTED
"DATA",811.8,75,100,922,0)
811.53;+814,+812,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,923,0)
811.53;+814,+812,;2~WP-start~1
"DATA",811.8,75,100,924,0)
Exchange Stub
"DATA",811.8,75,100,925,0)
]]>
"DATA",811.8,75,100,926,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,927,0)
<IEN_ROOT>
"DATA",811.8,75,100,928,0)
<![CDATA[
"DATA",811.8,75,100,929,0)
813^1
"DATA",811.8,75,100,930,0)
814^1
"DATA",811.8,75,100,931,0)
]]>
"DATA",811.8,75,100,932,0)
</IEN_ROOT>
"DATA",811.8,75,100,933,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,934,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,935,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,936,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,937,0)
<POINT_01>VA-MH HIGH RISK FOR SUICIDE PRF</POINT_01>
"DATA",811.8,75,100,938,0)
<INTERNAL_ENTRY_NUMBER>811</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,939,0)
<CHECKSUM>2093237997</CHECKSUM>
"DATA",811.8,75,100,940,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,941,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,942,0)
<![CDATA[
"DATA",811.8,75,100,943,0)
811.5;+811,;.01~VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,75,100,944,0)
811.5;+811,;1~WP-start~16
"DATA",811.8,75,100,945,0)
This reminder looks for the national category I HIGH RISK FOR SUICIDE
"DATA",811.8,75,100,946,0)
patient record flag and the local category II patient record flag used at
"DATA",811.8,75,100,947,0)
your site.  
"DATA",811.8,75,100,948,0)
 
"DATA",811.8,75,100,949,0)
This term is distributed to look for the local name HIGH RISK FOR SUICIDE 
"DATA",811.8,75,100,950,0)
which is the first mapped finding in the Mapped Findings.  The Computed 
"DATA",811.8,75,100,951,0)
Finding Parameter of HIGH RISK FOR SUICIDE^L means use the local patient 
"DATA",811.8,75,100,952,0)
record flag called HIGH RISK FOR SUICIDE.  If your site uses a different 
"DATA",811.8,75,100,953,0)
category II patient record flag name, then the computed finding parameter 
"DATA",811.8,75,100,954,0)
for the first mapped finding should be changed.  For example, if you're 
"DATA",811.8,75,100,955,0)
site uses SUICIDE RISK as the name of the category II patient record 
"DATA",811.8,75,100,956,0)
flag, then the Computed Finding Parameter should be changed to SUICIDE
"DATA",811.8,75,100,957,0)
RISK^L.
"DATA",811.8,75,100,958,0)
 
"DATA",811.8,75,100,959,0)
Do not change the second mapped finding with the Computed Finding
"DATA",811.8,75,100,960,0)
Parameter of HIGH RISK FOR SUICIDE^N.
"DATA",811.8,75,100,961,0)
811.5;+811,;100~NATIONAL
"DATA",811.8,75,100,962,0)
811.5;+811,;101~Office of Mental Health Services
"DATA",811.8,75,100,963,0)
811.52;+812,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,75,100,964,0)
811.52;+812,+811,;26~HIGH RISK FOR SUICIDE^L
"DATA",811.8,75,100,965,0)
811.52;+813,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,75,100,966,0)
811.52;+813,+811,;26~HIGH RISK FOR SUICIDE^N
"DATA",811.8,75,100,967,0)
811.53;+814,+811,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,968,0)
811.53;+814,+811,;2~WP-start~1
"DATA",811.8,75,100,969,0)
Exchange Stub
"DATA",811.8,75,100,970,0)
]]>
"DATA",811.8,75,100,971,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,972,0)
<IEN_ROOT>
"DATA",811.8,75,100,973,0)
<![CDATA[
"DATA",811.8,75,100,974,0)
812^1
"DATA",811.8,75,100,975,0)
813^2
"DATA",811.8,75,100,976,0)
814^1
"DATA",811.8,75,100,977,0)
]]>
"DATA",811.8,75,100,978,0)
</IEN_ROOT>
"DATA",811.8,75,100,979,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,980,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,981,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,75,100,982,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,75,100,983,0)
<POINT_01>VA-MH NOSHOW MISSED MH CLINIC APPTS</POINT_01>
"DATA",811.8,75,100,984,0)
<INTERNAL_ENTRY_NUMBER>809</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,985,0)
<CHECKSUM>1280315222</CHECKSUM>
"DATA",811.8,75,100,986,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,75,100,987,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,988,0)
<![CDATA[
"DATA",811.8,75,100,989,0)
811.5;+809,;.01~VA-MH NOSHOW MISSED MH CLINIC APPTS
"DATA",811.8,75,100,990,0)
811.5;+809,;1~WP-start~4
"DATA",811.8,75,100,991,0)
The list of DSS IDs (stop codes) used in the Reminder Location List 
"DATA",811.8,75,100,992,0)
finding for this term were provided by the Office of Mental Health
"DATA",811.8,75,100,993,0)
Services and includes stop codes related to Mental Health that involve
"DATA",811.8,75,100,994,0)
face-to-face contact with the patient.
"DATA",811.8,75,100,995,0)
811.5;+809,;100~NATIONAL
"DATA",811.8,75,100,996,0)
811.5;+809,;101~Office of Mental Health Services
"DATA",811.8,75,100,997,0)
811.52;+810,+809,;.01~CF.VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,75,100,998,0)
811.52;+810,+809,;26~FLDS:1,2,3^STATUS:NS,NSR^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,75,100,999,0)
811.53;+811,+809,;.01~12/06/2012@15:22:02
"DATA",811.8,75,100,1000,0)
811.53;+811,+809,;2~WP-start~1
"DATA",811.8,75,100,1001,0)
Exchange Stub
"DATA",811.8,75,100,1002,0)
]]>
"DATA",811.8,75,100,1003,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,1004,0)
<IEN_ROOT>
"DATA",811.8,75,100,1005,0)
<![CDATA[
"DATA",811.8,75,100,1006,0)
810^1
"DATA",811.8,75,100,1007,0)
811^1
"DATA",811.8,75,100,1008,0)
]]>
"DATA",811.8,75,100,1009,0)
</IEN_ROOT>
"DATA",811.8,75,100,1010,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,1011,0)
<FILEMAN_FILE>
"DATA",811.8,75,100,1012,0)
<FILE_NAME>REMINDER DEFINITION</FILE_NAME>
"DATA",811.8,75,100,1013,0)
<FILE_NUMBER>811.9</FILE_NUMBER>
"DATA",811.8,75,100,1014,0)
<POINT_01>VA-MH HIGH RISK NO-SHOW ADHOC RPT</POINT_01>
"DATA",811.8,75,100,1015,0)
<INTERNAL_ENTRY_NUMBER>444</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,75,100,1016,0)
<CHECKSUM>4143714637</CHECKSUM>
"DATA",811.8,75,100,1017,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,75,100,1018,0)
<FILEMAN_FDA>
"DATA",811.8,75,100,1019,0)
<![CDATA[
"DATA",811.8,75,100,1020,0)
811.9;+444,;.01~VA-MH HIGH RISK NO-SHOW ADHOC RPT
"DATA",811.8,75,100,1021,0)
811.9;+444,;1.2~High Risk MH No-Show Adhoc Rpt
"DATA",811.8,75,100,1022,0)
811.9;+444,;1.3~99Y
"DATA",811.8,75,100,1023,0)
811.9;+444,;2~WP-start~17
"DATA",811.8,75,100,1024,0)
This reminder is primarily for reporting needs and checks for No-Show MH 
"DATA",811.8,75,100,1025,0)
appointments that occurred between the Beginning Date and Ending Date of 
"DATA",811.8,75,100,1026,0)
a reporting period, which is different from the VA-MH HIGH RISK NO-SHOW 
"DATA",811.8,75,100,1027,0)
FOLLOW-UP reminder which looks back 10 days from the date the reminder is 
"DATA",811.8,75,100,1028,0)
being run.  This reminder is called by the SD MH NO SHOW AD HOC REPORT
"DATA",811.8,75,100,1029,0)
(High Risk MH No-Show Adhoc Report). For each no-show appointment found 
"DATA",811.8,75,100,1030,0)
in the reporting date range, the appointment date is used to run this
"DATA",811.8,75,100,1031,0)
reminder, and the reminder is resolved by any results entered the same day
"DATA",811.8,75,100,1032,0)
as the no-show appointment or within 60 days of the no-show appointment.
"DATA",811.8,75,100,1033,0)
 
"DATA",811.8,75,100,1034,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,75,100,1035,0)
have followed up on a No-Show MH appointment for a patient with an
"DATA",811.8,75,100,1036,0)
active High Risk for Suicide Patient Record Flag.
"DATA",811.8,75,100,1037,0)
 
"DATA",811.8,75,100,1038,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,75,100,1039,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,75,100,1040,0)
longer be necessary.
"DATA",811.8,75,100,1041,0)
811.9;+444,;31~(SEX)&(AGE)&FI(1)&FI(2)
"DATA",811.8,75,100,1042,0)
811.9;+444,;32~4
"DATA",811.8,75,100,1043,0)
811.9;+444,;33~SEX;AGE;1;2
"DATA",811.8,75,100,1044,0)
811.9;+444,;35~(0)!FI(3)!FI(4)!FI(8)!FI(11)!FI(12)!FI(13)!FI(14)
"DATA",811.8,75,100,1045,0)
811.9;+444,;36~7
"DATA",811.8,75,100,1046,0)
811.9;+444,;37~3;4;8;11;12;13;14
"DATA",811.8,75,100,1047,0)
811.9;+444,;40~0
"DATA",811.8,75,100,1048,0)
811.9;+444,;42~2
"DATA",811.8,75,100,1049,0)
811.9;+444,;43~6;10
"DATA",811.8,75,100,1050,0)
811.9;+444,;60~WP-start~2
"DATA",811.8,75,100,1051,0)
The patient has an active High Risk for Suicide Patient Record Flag and 
"DATA",811.8,75,100,1052,0)
missed a MH appointment.
"DATA",811.8,75,100,1053,0)
811.9;+444,;61~WP-start~1
"DATA",811.8,75,100,1054,0)
This patient has no missed MH appointment pending follow-up.
"DATA",811.8,75,100,1055,0)
811.9;+444,;62~2
"DATA",811.8,75,100,1056,0)
811.9;+444,;63~1
"DATA",811.8,75,100,1057,0)
811.9;+444,;67~0
"DATA",811.8,75,100,1058,0)
811.9;+444,;68~0
"DATA",811.8,75,100,1059,0)
811.9;+444,;72~0
"DATA",811.8,75,100,1060,0)
811.9;+444,;73~0
"DATA",811.8,75,100,1061,0)
811.9;+444,;77~0
"DATA",811.8,75,100,1062,0)
811.9;+444,;78~0
"DATA",811.8,75,100,1063,0)
811.9;+444,;100~NATIONAL
"DATA",811.8,75,100,1064,0)
811.9;+444,;101~Office of Mental Health Services
"DATA",811.8,75,100,1065,0)
811.9;+444,;103~RX
"DATA",811.8,75,100,1066,0)
811.9001;+445,+444,;.01~12/06/2012@15:22:03
"DATA",811.8,75,100,1067,0)
811.9001;+445,+444,;2~WP-start~1
"DATA",811.8,75,100,1068,0)
Exchange Stub
"DATA",811.8,75,100,1069,0)
811.902;+446,+444,;.01~RT.VA-MH NOSHOW MISSED MH CLINIC APPTS
"DATA",811.8,75,100,1070,0)
811.902;+446,+444,;8~AND
"DATA",811.8,75,100,1071,0)
811.902;+446,+444,;9~T
"DATA",811.8,75,100,1072,0)
811.902;+446,+444,;12~T
"DATA",811.8,75,100,1073,0)
811.902;+446,+444,;17~-1
"DATA",811.8,75,100,1074,0)
811.902;+446,+444,;24~0
"DATA",811.8,75,100,1075,0)
811.902;+446,+444,;25~0
"DATA",811.8,75,100,1076,0)
811.902;+446,+444,;26~FLDS:1,2,3^STATUS:NS,NSR^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,75,100,1077,0)
811.902;+447,+444,;.01~RT.VA-MH NOSHOW OUTREACH LETTER
"DATA",811.8,75,100,1078,0)
811.902;+447,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1079,0)
811.902;+447,+444,;12~T+60
"DATA",811.8,75,100,1080,0)
811.902;+447,+444,;17~-1
"DATA",811.8,75,100,1081,0)
811.902;+447,+444,;24~0
"DATA",811.8,75,100,1082,0)
811.902;+447,+444,;25~0
"DATA",811.8,75,100,1083,0)
811.902;+448,+444,;.01~RT.VA-MH NOSHOW OTHER OUTCOME
"DATA",811.8,75,100,1084,0)
811.902;+448,+444,;7~OR
"DATA",811.8,75,100,1085,0)
811.902;+448,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1086,0)
811.902;+448,+444,;12~T+60
"DATA",811.8,75,100,1087,0)
811.902;+448,+444,;17~-1
"DATA",811.8,75,100,1088,0)
811.902;+448,+444,;24~0
"DATA",811.8,75,100,1089,0)
811.902;+448,+444,;25~0
"DATA",811.8,75,100,1090,0)
811.902;+449,+444,;.01~RT.VA-MH SUICIDE ATTEMPTED
"DATA",811.8,75,100,1091,0)
811.902;+449,+444,;7~OR
"DATA",811.8,75,100,1092,0)
811.902;+449,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1093,0)
811.902;+449,+444,;12~T+60
"DATA",811.8,75,100,1094,0)
811.902;+449,+444,;17~-1
"DATA",811.8,75,100,1095,0)
811.902;+449,+444,;24~0
"DATA",811.8,75,100,1096,0)
811.902;+449,+444,;25~0
"DATA",811.8,75,100,1097,0)
811.902;+450,+444,;.01~RT.VA-MH SUICIDE COMPLETED
"DATA",811.8,75,100,1098,0)
811.902;+450,+444,;7~OR
"DATA",811.8,75,100,1099,0)
811.902;+450,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1100,0)
811.902;+450,+444,;12~T+60
"DATA",811.8,75,100,1101,0)
811.902;+450,+444,;17~-1
"DATA",811.8,75,100,1102,0)
811.902;+450,+444,;24~0
"DATA",811.8,75,100,1103,0)
811.902;+450,+444,;25~0
"DATA",811.8,75,100,1104,0)
811.902;+451,+444,;.01~RT.VA-MH APPT KEPT
"DATA",811.8,75,100,1105,0)
811.902;+451,+444,;4~WP-start~2
"DATA",811.8,75,100,1106,0)
Patient kept a MH appointment within 72 hours of the missed MH
"DATA",811.8,75,100,1107,0)
appointment, resolving the reminder.
"DATA",811.8,75,100,1108,0)
811.902;+451,+444,;7~OR
"DATA",811.8,75,100,1109,0)
811.902;+451,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1110,0)
811.902;+451,+444,;12~FIEVAL(1,1,"DATE")+72H
"DATA",811.8,75,100,1111,0)
811.902;+451,+444,;17~4
"DATA",811.8,75,100,1112,0)
811.902;+451,+444,;24~2
"DATA",811.8,75,100,1113,0)
811.902;+451,+444,;25~0
"DATA",811.8,75,100,1114,0)
811.902;+452,+444,;.01~RT.VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,75,100,1115,0)
811.902;+452,+444,;8~AND
"DATA",811.8,75,100,1116,0)
811.902;+452,+444,;9~FIEVAL(1,1,"DATE")
"DATA",811.8,75,100,1117,0)
811.902;+452,+444,;12~FIEVAL(1,1,"DATE")+1D
"DATA",811.8,75,100,1118,0)
811.902;+452,+444,;17~2
"DATA",811.8,75,100,1119,0)
811.902;+452,+444,;24~0
"DATA",811.8,75,100,1120,0)
811.902;+452,+444,;25~0
"DATA",811.8,75,100,1121,0)
811.902;+453,+444,;.01~RT.VA-MH NOSHOW PT CONTACTED
"DATA",811.8,75,100,1122,0)
811.902;+453,+444,;7~OR
"DATA",811.8,75,100,1123,0)
811.902;+453,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1124,0)
811.902;+453,+444,;12~T+60
"DATA",811.8,75,100,1125,0)
811.902;+453,+444,;17~-1
"DATA",811.8,75,100,1126,0)
811.902;+453,+444,;24~0
"DATA",811.8,75,100,1127,0)
811.902;+453,+444,;25~0
"DATA",811.8,75,100,1128,0)
811.902;+454,+444,;.01~RT.VA-MH NOSHOW PT EMERGENT CARE
"DATA",811.8,75,100,1129,0)
811.902;+454,+444,;7~OR
"DATA",811.8,75,100,1130,0)
811.902;+454,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1131,0)
811.902;+454,+444,;12~T+60
"DATA",811.8,75,100,1132,0)
811.902;+454,+444,;17~-1
"DATA",811.8,75,100,1133,0)
811.902;+454,+444,;24~0
"DATA",811.8,75,100,1134,0)
811.902;+454,+444,;25~0
"DATA",811.8,75,100,1135,0)
811.902;+455,+444,;.01~RT.VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,75,100,1136,0)
811.902;+455,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1137,0)
811.902;+455,+444,;12~T+60
"DATA",811.8,75,100,1138,0)
811.902;+455,+444,;17~-1
"DATA",811.8,75,100,1139,0)
811.902;+455,+444,;24~0
"DATA",811.8,75,100,1140,0)
811.902;+455,+444,;25~0
"DATA",811.8,75,100,1141,0)
811.902;+456,+444,;.01~RT.VA-MH NOSHOW PLAN DEVELOPED
"DATA",811.8,75,100,1142,0)
811.902;+456,+444,;7~OR
"DATA",811.8,75,100,1143,0)
811.902;+456,+444,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,75,100,1144,0)
811.902;+456,+444,;12~T+60
"DATA",811.8,75,100,1145,0)
811.902;+456,+444,;17~-1
"DATA",811.8,75,100,1146,0)
811.902;+456,+444,;24~0
"DATA",811.8,75,100,1147,0)
811.902;+456,+444,;25~0
"DATA",811.8,75,100,1148,0)
811.97;+457,+444,;.01~99Y
"DATA",811.8,75,100,1149,0)
811.97;+457,+444,;3~WP-start~2
"DATA",811.8,75,100,1150,0)
Reminder triggered by missed MH appointment and when resolved won't be 
"DATA",811.8,75,100,1151,0)
due again until another missed MH appointment occurs.\\
"DATA",811.8,75,100,1152,0)
811.97;+457,+444,;5~2
"DATA",811.8,75,100,1153,0)
811.97;+457,+444,;6~0
"DATA",811.8,75,100,1154,0)
]]>
"DATA",811.8,75,100,1155,0)
</FILEMAN_FDA>
"DATA",811.8,75,100,1156,0)
<IEN_ROOT>
"DATA",811.8,75,100,1157,0)
<![CDATA[
"DATA",811.8,75,100,1158,0)
445^1
"DATA",811.8,75,100,1159,0)
446^1
"DATA",811.8,75,100,1160,0)
447^10
"DATA",811.8,75,100,1161,0)
448^11
"DATA",811.8,75,100,1162,0)
449^12
"DATA",811.8,75,100,1163,0)
450^13
"DATA",811.8,75,100,1164,0)
451^14
"DATA",811.8,75,100,1165,0)
452^2
"DATA",811.8,75,100,1166,0)
453^3
"DATA",811.8,75,100,1167,0)
454^4
"DATA",811.8,75,100,1168,0)
455^6
"DATA",811.8,75,100,1169,0)
456^8
"DATA",811.8,75,100,1170,0)
457^1
"DATA",811.8,75,100,1171,0)
]]>
"DATA",811.8,75,100,1172,0)
</IEN_ROOT>
"DATA",811.8,75,100,1173,0)
</FILEMAN_FILE>
"DATA",811.8,75,100,1174,0)
<INDEX>
"DATA",811.8,75,100,1175,0)
<NUMBER_OF_COMPONENTS>26</NUMBER_OF_COMPONENTS>
"DATA",811.8,75,100,1176,0)
<COMPONENT>
"DATA",811.8,75,100,1177,0)
<M_ROUTINE_START>32</M_ROUTINE_START>
"DATA",811.8,75,100,1178,0)
<ROUTINE_CODE_END>137</ROUTINE_CODE_END>
"DATA",811.8,75,100,1179,0)
<ROUTINE_CODE_START>37</ROUTINE_CODE_START>
"DATA",811.8,75,100,1180,0)
</COMPONENT>
"DATA",811.8,75,100,1181,0)
<COMPONENT>
"DATA",811.8,75,100,1182,0)
<M_ROUTINE_START>141</M_ROUTINE_START>
"DATA",811.8,75,100,1183,0)
<ROUTINE_CODE_END>327</ROUTINE_CODE_END>
"DATA",811.8,75,100,1184,0)
<ROUTINE_CODE_START>146</ROUTINE_CODE_START>
"DATA",811.8,75,100,1185,0)
</COMPONENT>
"DATA",811.8,75,100,1186,0)
<COMPONENT>
"DATA",811.8,75,100,1187,0)
<FDA_END>341</FDA_END>
"DATA",811.8,75,100,1188,0)
<FDA_START>340</FDA_START>
"DATA",811.8,75,100,1189,0)
<FILE_START>331</FILE_START>
"DATA",811.8,75,100,1190,0)
</COMPONENT>
"DATA",811.8,75,100,1191,0)
<COMPONENT>
"DATA",811.8,75,100,1192,0)
<FDA_END>357</FDA_END>
"DATA",811.8,75,100,1193,0)
<FDA_START>354</FDA_START>
"DATA",811.8,75,100,1194,0)
<FILE_START>345</FILE_START>
"DATA",811.8,75,100,1195,0)
</COMPONENT>
"DATA",811.8,75,100,1196,0)
<COMPONENT>
"DATA",811.8,75,100,1197,0)
<FDA_END>373</FDA_END>
"DATA",811.8,75,100,1198,0)
<FDA_START>370</FDA_START>
"DATA",811.8,75,100,1199,0)
<FILE_START>361</FILE_START>
"DATA",811.8,75,100,1200,0)
</COMPONENT>
"DATA",811.8,75,100,1201,0)
<COMPONENT>
"DATA",811.8,75,100,1202,0)
<FDA_END>389</FDA_END>
"DATA",811.8,75,100,1203,0)
<FDA_START>386</FDA_START>
"DATA",811.8,75,100,1204,0)
<FILE_START>377</FILE_START>
"DATA",811.8,75,100,1205,0)
</COMPONENT>
"DATA",811.8,75,100,1206,0)
<COMPONENT>
"DATA",811.8,75,100,1207,0)
<FDA_END>405</FDA_END>
"DATA",811.8,75,100,1208,0)
<FDA_START>402</FDA_START>
"DATA",811.8,75,100,1209,0)
<FILE_START>393</FILE_START>
"DATA",811.8,75,100,1210,0)
</COMPONENT>
"DATA",811.8,75,100,1211,0)
<COMPONENT>
"DATA",811.8,75,100,1212,0)
<FDA_END>421</FDA_END>
"DATA",811.8,75,100,1213,0)
<FDA_START>418</FDA_START>
"DATA",811.8,75,100,1214,0)
<FILE_START>409</FILE_START>
"DATA",811.8,75,100,1215,0)
</COMPONENT>
"DATA",811.8,75,100,1216,0)
<COMPONENT>
"DATA",811.8,75,100,1217,0)
<FDA_END>437</FDA_END>
"DATA",811.8,75,100,1218,0)
<FDA_START>434</FDA_START>
"DATA",811.8,75,100,1219,0)
<FILE_START>425</FILE_START>
"DATA",811.8,75,100,1220,0)
</COMPONENT>
"DATA",811.8,75,100,1221,0)
<COMPONENT>
"DATA",811.8,75,100,1222,0)
<FDA_END>453</FDA_END>
"DATA",811.8,75,100,1223,0)
<FDA_START>450</FDA_START>
"DATA",811.8,75,100,1224,0)
<FILE_START>441</FILE_START>
"DATA",811.8,75,100,1225,0)
</COMPONENT>
"DATA",811.8,75,100,1226,0)
<COMPONENT>
"DATA",811.8,75,100,1227,0)
<FDA_END>469</FDA_END>
"DATA",811.8,75,100,1228,0)
<FDA_START>466</FDA_START>
"DATA",811.8,75,100,1229,0)
<FILE_START>457</FILE_START>
"DATA",811.8,75,100,1230,0)
</COMPONENT>
"DATA",811.8,75,100,1231,0)
<COMPONENT>
"DATA",811.8,75,100,1232,0)
<FDA_END>492</FDA_END>
"DATA",811.8,75,100,1233,0)
<FDA_START>482</FDA_START>
"DATA",811.8,75,100,1234,0)
<FILE_START>473</FILE_START>
"DATA",811.8,75,100,1235,0)
<IEN_ROOT_END>498</IEN_ROOT_END>
"DATA",811.8,75,100,1236,0)
<IEN_ROOT_START>497</IEN_ROOT_START>
"DATA",811.8,75,100,1237,0)
</COMPONENT>
"DATA",811.8,75,100,1238,0)
<COMPONENT>
"DATA",811.8,75,100,1239,0)
<FDA_END>640</FDA_END>
"DATA",811.8,75,100,1240,0)
<FDA_START>511</FDA_START>
"DATA",811.8,75,100,1241,0)
<FILE_START>502</FILE_START>
"DATA",811.8,75,100,1242,0)
<IEN_ROOT_END>645</IEN_ROOT_END>
"DATA",811.8,75,100,1243,0)
<IEN_ROOT_START>645</IEN_ROOT_START>
"DATA",811.8,75,100,1244,0)
</COMPONENT>
"DATA",811.8,75,100,1245,0)
<COMPONENT>
"DATA",811.8,75,100,1246,0)
<FDA_END>694</FDA_END>
"DATA",811.8,75,100,1247,0)
<FDA_START>658</FDA_START>
"DATA",811.8,75,100,1248,0)
<FILE_START>649</FILE_START>
"DATA",811.8,75,100,1249,0)
<IEN_ROOT_END>699</IEN_ROOT_END>
"DATA",811.8,75,100,1250,0)
<IEN_ROOT_START>699</IEN_ROOT_START>
"DATA",811.8,75,100,1251,0)
</COMPONENT>
"DATA",811.8,75,100,1252,0)
<COMPONENT>
"DATA",811.8,75,100,1253,0)
<FDA_END>722</FDA_END>
"DATA",811.8,75,100,1254,0)
<FDA_START>712</FDA_START>
"DATA",811.8,75,100,1255,0)
<FILE_START>703</FILE_START>
"DATA",811.8,75,100,1256,0)
<IEN_ROOT_END>728</IEN_ROOT_END>
"DATA",811.8,75,100,1257,0)
<IEN_ROOT_START>727</IEN_ROOT_START>
"DATA",811.8,75,100,1258,0)
</COMPONENT>
"DATA",811.8,75,100,1259,0)
<COMPONENT>
"DATA",811.8,75,100,1260,0)
<FDA_END>747</FDA_END>
"DATA",811.8,75,100,1261,0)
<FDA_START>741</FDA_START>
"DATA",811.8,75,100,1262,0)
<FILE_START>732</FILE_START>
"DATA",811.8,75,100,1263,0)
<IEN_ROOT_END>753</IEN_ROOT_END>
"DATA",811.8,75,100,1264,0)
<IEN_ROOT_START>752</IEN_ROOT_START>
"DATA",811.8,75,100,1265,0)
</COMPONENT>
"DATA",811.8,75,100,1266,0)
<COMPONENT>
"DATA",811.8,75,100,1267,0)
<FDA_END>772</FDA_END>
"DATA",811.8,75,100,1268,0)
<FDA_START>766</FDA_START>
"DATA",811.8,75,100,1269,0)
<FILE_START>757</FILE_START>
"DATA",811.8,75,100,1270,0)
<IEN_ROOT_END>778</IEN_ROOT_END>
"DATA",811.8,75,100,1271,0)
<IEN_ROOT_START>777</IEN_ROOT_START>
"DATA",811.8,75,100,1272,0)
</COMPONENT>
"DATA",811.8,75,100,1273,0)
<COMPONENT>
"DATA",811.8,75,100,1274,0)
<FDA_END>797</FDA_END>
"DATA",811.8,75,100,1275,0)
<FDA_START>791</FDA_START>
"DATA",811.8,75,100,1276,0)
<FILE_START>782</FILE_START>
"DATA",811.8,75,100,1277,0)
<IEN_ROOT_END>803</IEN_ROOT_END>
"DATA",811.8,75,100,1278,0)
<IEN_ROOT_START>802</IEN_ROOT_START>
"DATA",811.8,75,100,1279,0)
</COMPONENT>
"DATA",811.8,75,100,1280,0)
<COMPONENT>
"DATA",811.8,75,100,1281,0)
<FDA_END>822</FDA_END>
"DATA",811.8,75,100,1282,0)
<FDA_START>816</FDA_START>
"DATA",811.8,75,100,1283,0)
<FILE_START>807</FILE_START>
"DATA",811.8,75,100,1284,0)
<IEN_ROOT_END>828</IEN_ROOT_END>
"DATA",811.8,75,100,1285,0)
<IEN_ROOT_START>827</IEN_ROOT_START>
"DATA",811.8,75,100,1286,0)
</COMPONENT>
"DATA",811.8,75,100,1287,0)
<COMPONENT>
"DATA",811.8,75,100,1288,0)
<FDA_END>847</FDA_END>
"DATA",811.8,75,100,1289,0)
<FDA_START>841</FDA_START>
"DATA",811.8,75,100,1290,0)
<FILE_START>832</FILE_START>
"DATA",811.8,75,100,1291,0)
<IEN_ROOT_END>853</IEN_ROOT_END>
"DATA",811.8,75,100,1292,0)
<IEN_ROOT_START>852</IEN_ROOT_START>
"DATA",811.8,75,100,1293,0)
</COMPONENT>
"DATA",811.8,75,100,1294,0)
<COMPONENT>
"DATA",811.8,75,100,1295,0)
<FDA_END>872</FDA_END>
"DATA",811.8,75,100,1296,0)
<FDA_START>866</FDA_START>
"DATA",811.8,75,100,1297,0)
<FILE_START>857</FILE_START>
"DATA",811.8,75,100,1298,0)
<IEN_ROOT_END>878</IEN_ROOT_END>
"DATA",811.8,75,100,1299,0)
<IEN_ROOT_START>877</IEN_ROOT_START>
"DATA",811.8,75,100,1300,0)
</COMPONENT>
"DATA",811.8,75,100,1301,0)
<COMPONENT>
"DATA",811.8,75,100,1302,0)
<FDA_END>897</FDA_END>
"DATA",811.8,75,100,1303,0)
<FDA_START>891</FDA_START>
"DATA",811.8,75,100,1304,0)
<FILE_START>882</FILE_START>
"DATA",811.8,75,100,1305,0)
<IEN_ROOT_END>903</IEN_ROOT_END>
"DATA",811.8,75,100,1306,0)
<IEN_ROOT_START>902</IEN_ROOT_START>
"DATA",811.8,75,100,1307,0)
</COMPONENT>
"DATA",811.8,75,100,1308,0)
<COMPONENT>
"DATA",811.8,75,100,1309,0)
<FDA_END>924</FDA_END>
"DATA",811.8,75,100,1310,0)
<FDA_START>916</FDA_START>
"DATA",811.8,75,100,1311,0)
<FILE_START>907</FILE_START>
"DATA",811.8,75,100,1312,0)
<IEN_ROOT_END>930</IEN_ROOT_END>
"DATA",811.8,75,100,1313,0)
<IEN_ROOT_START>929</IEN_ROOT_START>
"DATA",811.8,75,100,1314,0)
</COMPONENT>
"DATA",811.8,75,100,1315,0)
<COMPONENT>
"DATA",811.8,75,100,1316,0)
<FDA_END>969</FDA_END>
"DATA",811.8,75,100,1317,0)
<FDA_START>943</FDA_START>
"DATA",811.8,75,100,1318,0)
<FILE_START>934</FILE_START>
"DATA",811.8,75,100,1319,0)
<IEN_ROOT_END>976</IEN_ROOT_END>
"DATA",811.8,75,100,1320,0)
<IEN_ROOT_START>974</IEN_ROOT_START>
"DATA",811.8,75,100,1321,0)
</COMPONENT>
"DATA",811.8,75,100,1322,0)
<COMPONENT>
"DATA",811.8,75,100,1323,0)
<FDA_END>1001</FDA_END>
"DATA",811.8,75,100,1324,0)
<FDA_START>989</FDA_START>
"DATA",811.8,75,100,1325,0)
<FILE_START>980</FILE_START>
"DATA",811.8,75,100,1326,0)
<IEN_ROOT_END>1007</IEN_ROOT_END>
"DATA",811.8,75,100,1327,0)
<IEN_ROOT_START>1006</IEN_ROOT_START>
"DATA",811.8,75,100,1328,0)
</COMPONENT>
"DATA",811.8,75,100,1329,0)
<COMPONENT>
"DATA",811.8,75,100,1330,0)
<FDA_END>1153</FDA_END>
"DATA",811.8,75,100,1331,0)
<FDA_START>1020</FDA_START>
"DATA",811.8,75,100,1332,0)
<FILE_START>1011</FILE_START>
"DATA",811.8,75,100,1333,0)
<IEN_ROOT_END>1170</IEN_ROOT_END>
"DATA",811.8,75,100,1334,0)
<IEN_ROOT_START>1158</IEN_ROOT_START>
"DATA",811.8,75,100,1335,0)
</COMPONENT>
"DATA",811.8,75,100,1336,0)
</INDEX>
"DATA",811.8,75,100,1337,0)
</REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,75,110,0)
^811.804^26^26
"DATA",811.8,75,110,1,0)
Source:      TROST,DEBBIE at SALT LAKE CITY OIFO
"DATA",811.8,75,110,2,0)
Date Packed: 12/06/2012@15:21:05
"DATA",811.8,75,110,3,0)
Package Version: 2.0P27
"DATA",811.8,75,110,4,0)

"DATA",811.8,75,110,5,0)
Description:
"DATA",811.8,75,110,6,0)
This reminder is primarily for reporting needs and checks for No-Show MH 
"DATA",811.8,75,110,7,0)
appointments that occurred between the Beginning Date and Ending Date of 
"DATA",811.8,75,110,8,0)
a reporting period, which is different from the VA-MH HIGH RISK NO-SHOW 
"DATA",811.8,75,110,9,0)
FOLLOW-UP reminder which looks back 10 days from the date the reminder is 
"DATA",811.8,75,110,10,0)
being run.  This reminder is called by the SD MH NO SHOW AD HOC REPORT
"DATA",811.8,75,110,11,0)
(High Risk MH No-Show Adhoc Report). For each no-show appointment found 
"DATA",811.8,75,110,12,0)
in the reporting date range, the appointment date is used to run this
"DATA",811.8,75,110,13,0)
reminder, and the reminder is resolved by any results entered the same day
"DATA",811.8,75,110,14,0)
as the no-show appointment or within 60 days of the no-show appointment.
"DATA",811.8,75,110,15,0)
 
"DATA",811.8,75,110,16,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,75,110,17,0)
have followed up on a No-Show MH appointment for a patient with an
"DATA",811.8,75,110,18,0)
active High Risk for Suicide Patient Record Flag.
"DATA",811.8,75,110,19,0)
 
"DATA",811.8,75,110,20,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,75,110,21,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,75,110,22,0)
longer be necessary.
"DATA",811.8,75,110,23,0)

"DATA",811.8,75,110,24,0)
Keywords:
"DATA",811.8,75,110,25,0)

"DATA",811.8,75,110,26,0)
Components:
"DATA",811.8,77,0)
VA-MH HIGH RISK NO-SHOW FOLLOW-UP^TROST,DEBBIE at SALT LAKE CITY OIFO^3121206.152302
"DATA",811.8,77,100,0)
^811.801^2589^2589
"DATA",811.8,77,100,1,0)
<?xml version="1.0" standalone="yes"?>
"DATA",811.8,77,100,2,0)
<REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,77,100,3,0)
<PACKAGE_VERSION>2.0P27</PACKAGE_VERSION>
"DATA",811.8,77,100,4,0)
<INDEX_AT>2199</INDEX_AT>
"DATA",811.8,77,100,5,0)
<SOURCE>
"DATA",811.8,77,100,6,0)
<NAME>VA-MH HIGH RISK NO-SHOW FOLLOW-UP</NAME>
"DATA",811.8,77,100,7,0)
<USER>TROST,DEBBIE</USER>
"DATA",811.8,77,100,8,0)
<SITE>SALT LAKE CITY OIFO</SITE>
"DATA",811.8,77,100,9,0)
<DATE_PACKED>12/06/2012@15:23:02</DATE_PACKED>
"DATA",811.8,77,100,10,0)
</SOURCE>
"DATA",811.8,77,100,11,0)
<DESCRIPTION><![CDATA[
"DATA",811.8,77,100,12,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,77,100,13,0)
have followed up on a No-Show MH appointment for a patient with an active
"DATA",811.8,77,100,14,0)
High Risk for Suicide Patient Record Flag. 
"DATA",811.8,77,100,15,0)
 
"DATA",811.8,77,100,16,0)
The reminder requires clinicians to initiate follow-up with the patient to
"DATA",811.8,77,100,17,0)
insure his/her safety and to try to get the patient back into care. The
"DATA",811.8,77,100,18,0)
follow-up results are documented with health factors.  
"DATA",811.8,77,100,19,0)
 
"DATA",811.8,77,100,20,0)
Studies show that individuals that get lost to follow-up have a higher 
"DATA",811.8,77,100,21,0)
rate of actual suicide than those that stay connected with care.
"DATA",811.8,77,100,22,0)
 
"DATA",811.8,77,100,23,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,77,100,24,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,77,100,25,0)
longer be necessary.
"DATA",811.8,77,100,26,0)
Non-exchangeable TIU object(s):
"DATA",811.8,77,100,27,0)
-------------------------------------------------------------------------------
"DATA",811.8,77,100,28,0)
TIU Object: MH MISSED APPOINTMENTS 10D
"DATA",811.8,77,100,29,0)
Object Method: S X=$$MSTAPPT^TIULO1(DFN,"^TMP(""TIU APPT"",$J)")
"DATA",811.8,77,100,30,0)

"DATA",811.8,77,100,31,0)
-------------------------------------------------------------------------------
"DATA",811.8,77,100,32,0)
]]></DESCRIPTION>
"DATA",811.8,77,100,33,0)
<KEYWORDS>
"DATA",811.8,77,100,34,0)
</KEYWORDS>
"DATA",811.8,77,100,35,0)
<M_ROUTINE>
"DATA",811.8,77,100,36,0)
<ROUTINE_NAME>PXRMPRF</ROUTINE_NAME>
"DATA",811.8,77,100,37,0)
<CHECKSUM>580828279</CHECKSUM>
"DATA",811.8,77,100,38,0)
<CODE>
"DATA",811.8,77,100,39,0)
<![CDATA[
"DATA",811.8,77,100,40,0)
PXRMPRF ;SLC/PKR - Computed findings for PRF. ;08/29/2012
"DATA",811.8,77,100,41,0)
 ;;2.0;CLINICAL REMINDERS;**17,18**;Feb 4, 2005
"DATA",811.8,77,100,42,0)
 ;Calls to DGPFAPIU supported by DBIA #4903 and 5491.
"DATA",811.8,77,100,43,0)
 ;==========================================
"DATA",811.8,77,100,44,0)
GETINF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PATIENT RECORD FLAG
"DATA",811.8,77,100,45,0)
 ;INFORMATION computed finding. Return information about a specific
"DATA",811.8,77,100,46,0)
 ;record flag.
"DATA",811.8,77,100,47,0)
 N BDTNT,EDTNTFLAG,FLAGCAT,FLAGNAME,IND,LIST,RESULT,TEMP
"DATA",811.8,77,100,48,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,77,100,49,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,77,100,50,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,77,100,51,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,77,100,52,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,77,100,53,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,77,100,54,0)
 ;DBIA #5491
"DATA",811.8,77,100,55,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,77,100,56,0)
 ;DBIA #4903
"DATA",811.8,77,100,57,0)
 S RESULT=$$GETINF^DGPFAPIH(DFN,FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,77,100,58,0)
 S NFOUND=0
"DATA",811.8,77,100,59,0)
 I RESULT=0 Q
"DATA",811.8,77,100,60,0)
 S IND=0
"DATA",811.8,77,100,61,0)
 F IND=+$O(LIST("HIST",IND)) Q:IND=0  D
"DATA",811.8,77,100,62,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,77,100,63,0)
 . S TEST(NFOUND)=1
"DATA",811.8,77,100,64,0)
 . S DATE(NFOUND)=$P(LIST("HIST",IND,"DATETIME"),U,1)
"DATA",811.8,77,100,65,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"ACTION"))=$P(LIST("HIST",IND,"ACTION"),U,2)
"DATA",811.8,77,100,66,0)
 . S DATA(NFOUND,"APPRVBY")=$P(LIST("HIST",IND,"APPRVBY"),U,2)
"DATA",811.8,77,100,67,0)
 . S DATA(NFOUND,"ASSIGN DT")=$P(LIST("ASSIGNDT"),U,1)
"DATA",811.8,77,100,68,0)
 . S DATA(NFOUND,"CATEGORY")=$P(LIST("CATEGORY"),U,2)
"DATA",811.8,77,100,69,0)
 . S DATA(NFOUND,"FLAGTYPE")=$P(LIST("FLAGTYPE"),U,2)
"DATA",811.8,77,100,70,0)
 . S DATA(NFOUND,"REVIEW DT")=$P(LIST("REVIEWDT"),U,1)
"DATA",811.8,77,100,71,0)
 . S DATA(NFOUND,"TIU TITLE")=$P(LIST("TIUTITLE"),U,2)
"DATA",811.8,77,100,72,0)
 . S TEMP="\\Flag - "_$P(LIST("FLAG"),U,2)_"("_DATA(NFOUND,"CATEGORY")_")."
"DATA",811.8,77,100,73,0)
 . S TEMP=TEMP_"\\Assigned "_$P(LIST("ASSIGNDT"),U,2)_" by "_DATA(NFOUND,"APPRVBY")_". "
"DATA",811.8,77,100,74,0)
 . S TEMP=TEMP_LIST("HIST",IND,"COMMENT",1,0)
"DATA",811.8,77,100,75,0)
 . S TEXT(NFOUND)=TEMP
"DATA",811.8,77,100,76,0)
 Q
"DATA",811.8,77,100,77,0)
 ;
"DATA",811.8,77,100,78,0)
 ;==========================================
"DATA",811.8,77,100,79,0)
GETLST(NGET,BDT,EDT,PLIST,PARAM) ;VA-PATIENT RECORD FLAG LIST computed finding.
"DATA",811.8,77,100,80,0)
 ;Return a list of patients with a specified record flag.
"DATA",811.8,77,100,81,0)
 N BDTNT,DATE,DFN,EDTNT,FLAGCAT,FLAGNAME,IND,LIST,RESULT
"DATA",811.8,77,100,82,0)
 K ^TMP($J,PLIST)
"DATA",811.8,77,100,83,0)
 I PARAM="" Q
"DATA",811.8,77,100,84,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,77,100,85,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,77,100,86,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,77,100,87,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,77,100,88,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,77,100,89,0)
 ;DBIA #5491
"DATA",811.8,77,100,90,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,77,100,91,0)
 ;DBIA #4903
"DATA",811.8,77,100,92,0)
 S RESULT=$$GETLST^DGPFAPIH(FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,77,100,93,0)
 I RESULT=0 Q
"DATA",811.8,77,100,94,0)
 S DFN=0
"DATA",811.8,77,100,95,0)
 F  S DFN=+$O(LIST(DFN)) Q:DFN=0  S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(DFN,0),U,3)_U_U_U
"DATA",811.8,77,100,96,0)
 Q
"DATA",811.8,77,100,97,0)
 ;
"DATA",811.8,77,100,98,0)
 ;==========================================
"DATA",811.8,77,100,99,0)
PRF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Computed finding for
"DATA",811.8,77,100,100,0)
 ;getting a list of the patient's active flags.
"DATA",811.8,77,100,101,0)
 N ASSIGNDT,CAT,DONE,FLAG,FLAGKEEP,FLAGLIST,IND
"DATA",811.8,77,100,102,0)
 N NFLAGS,NOCC,OK,SDIR,SUB,TEMP,TYPE
"DATA",811.8,77,100,103,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,77,100,104,0)
 ;DBIA #3860
"DATA",811.8,77,100,105,0)
 S NFLAGS=$$GETACT^DGPFAPI(DFN,"FLAGLIST")
"DATA",811.8,77,100,106,0)
 ;If no flags are found quit
"DATA",811.8,77,100,107,0)
 I NFLAGS=0 S NFOUND=0 Q
"DATA",811.8,77,100,108,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,77,100,109,0)
 S NOCC=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,77,100,110,0)
 ;Search the parameter list for category, type, and flag.
"DATA",811.8,77,100,111,0)
 S CAT=$F(TEST,"C:")
"DATA",811.8,77,100,112,0)
 I CAT>0 S CAT=$E(TEST,CAT),CAT=$S(CAT="N":"NATIONAL",CAT="L":"LOCAL")
"DATA",811.8,77,100,113,0)
 S TYPE=$F(TEST,"T:")
"DATA",811.8,77,100,114,0)
 I TYPE>0 S TEMP=$E(TEST,TYPE,245),TYPE=$P(TEMP,U,1),TYPE=$S(TYPE="B":"BEHAVIORAL",TYPE="C":"CLINICAL",TYPE="O":"OTHER",TYPE="R":"RESEARCH")
"DATA",811.8,77,100,115,0)
 S FLAG=$F(TEST,"F:")
"DATA",811.8,77,100,116,0)
 I FLAG>0 S TEMP=$E(TEST,FLAG,245),FLAG=$P(TEMP,U,1)
"DATA",811.8,77,100,117,0)
 ;Check all the flags that were returned and keep those that meet
"DATA",811.8,77,100,118,0)
 ;the criteria. Order by assigned date.
"DATA",811.8,77,100,119,0)
 F IND=1:1:NFLAGS D
"DATA",811.8,77,100,120,0)
 . S OK=1
"DATA",811.8,77,100,121,0)
 . I CAT'=0,FLAGLIST(IND,"CATEGORY")'[CAT S OK=0
"DATA",811.8,77,100,122,0)
 . I TYPE'=0,TYPE'=$P(FLAGLIST(IND,"FLAGTYPE"),U,2) S OK=0
"DATA",811.8,77,100,123,0)
 . I FLAG'=0,FLAG'=$P(FLAGLIST(IND,"FLAG"),U,2) S OK=0
"DATA",811.8,77,100,124,0)
 . I OK S FLAGKEEP($P(FLAGLIST(IND,"ASSIGNDT"),U,1),IND)=""
"DATA",811.8,77,100,125,0)
 S ASSIGNDT="",(DONE,NFOUND)=0
"DATA",811.8,77,100,126,0)
 F  S ASSIGNDT=$O(FLAGKEEP(ASSIGNDT),SDIR) Q:(DONE)!(ASSIGNDT="")  D
"DATA",811.8,77,100,127,0)
 . S IND=0
"DATA",811.8,77,100,128,0)
 . F  S IND=$O(FLAGKEEP(ASSIGNDT,IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,77,100,129,0)
 .. S NFOUND=NFOUND+1
"DATA",811.8,77,100,130,0)
 .. I NFOUND=NOCC S DONE=1
"DATA",811.8,77,100,131,0)
 .. S TEST(NFOUND)=1
"DATA",811.8,77,100,132,0)
 .. S DATE(NFOUND)=ASSIGNDT
"DATA",811.8,77,100,133,0)
 .. S SUB=""
"DATA",811.8,77,100,134,0)
 ..;Save the CSUB data.
"DATA",811.8,77,100,135,0)
 .. F  S SUB=$O(FLAGLIST(IND,SUB)) Q:SUB=""  D
"DATA",811.8,77,100,136,0)
 ... I SUB="NARR" Q
"DATA",811.8,77,100,137,0)
 ... S DATA(NFOUND,SUB)=$P($G(FLAGLIST(IND,SUB)),U,2)
"DATA",811.8,77,100,138,0)
 .. S TEXT(NFOUND)=DATA(NFOUND,"FLAG")_"; Category: "_DATA(NFOUND,"CATEGORY")_"; TYPE: "_DATA(NFOUND,"FLAGTYPE")
"DATA",811.8,77,100,139,0)
 Q
"DATA",811.8,77,100,140,0)
 ;
"DATA",811.8,77,100,141,0)
]]>
"DATA",811.8,77,100,142,0)
</CODE>
"DATA",811.8,77,100,143,0)
</M_ROUTINE>
"DATA",811.8,77,100,144,0)
<M_ROUTINE>
"DATA",811.8,77,100,145,0)
<ROUTINE_NAME>PXRMRDI</ROUTINE_NAME>
"DATA",811.8,77,100,146,0)
<CHECKSUM>63045721</CHECKSUM>
"DATA",811.8,77,100,147,0)
<CODE>
"DATA",811.8,77,100,148,0)
<![CDATA[
"DATA",811.8,77,100,149,0)
PXRMRDI ;SLC/PKR - Routines to support RDI list building. ;04/25/2012
"DATA",811.8,77,100,150,0)
 ;;2.0;CLINICAL REMINDERS;**4,17,18,24**;Feb 04, 2005
"DATA",811.8,77,100,151,0)
 ;=========================================================
"DATA",811.8,77,100,152,0)
APPERR(TYPE) ;Handle errors getting appointment data.
"DATA",811.8,77,100,153,0)
 N ECODE,MGIEN,MGROUP,NL,TIME,TO,USER
"DATA",811.8,77,100,154,0)
 S USER=$S($D(ZTQUEUED):DBDUZ,1:DUZ)
"DATA",811.8,77,100,155,0)
 S TIME=$$NOW^XLFDT
"DATA",811.8,77,100,156,0)
 S TIME=$$FMTE^XLFDT(TIME)
"DATA",811.8,77,100,157,0)
 K ^TMP("PXRMXMZ",$J)
"DATA",811.8,77,100,158,0)
 S ^TMP("PXRMXMZ",$J,1,0)="The "_TYPE_" requested by "_$$GET1^DIQ(200,USER,.01)_" on "
"DATA",811.8,77,100,159,0)
 S ^TMP("PXRMXMZ",$J,2,0)=TIME_" requires appointment data which could not be obtained"
"DATA",811.8,77,100,160,0)
 S ^TMP("PXRMXMZ",$J,3,0)="from the Scheduling database due to the following error(s):"
"DATA",811.8,77,100,161,0)
 S ECODE=0,NL=3
"DATA",811.8,77,100,162,0)
 F  S ECODE=$O(^TMP($J,"SDAMA301",ECODE)) Q:ECODE=""  D
"DATA",811.8,77,100,163,0)
 . S NL=NL+1,^TMP("PXRMXMZ",$J,NL,0)=" "_^TMP($J,"SDAMA301",ECODE)
"DATA",811.8,77,100,164,0)
 S TO(DUZ)=""
"DATA",811.8,77,100,165,0)
 S MGIEN=$G(^PXRM(800,1,"MGFE"))
"DATA",811.8,77,100,166,0)
 I MGIEN'="" D
"DATA",811.8,77,100,167,0)
 . S MGROUP="G."_$$GET1^DIQ(3.8,MGIEN,.01)
"DATA",811.8,77,100,168,0)
 . S TO(MGROUP)=""
"DATA",811.8,77,100,169,0)
 D SEND^PXRMMSG("PXRMXMZ","Scheduling database error(s)",.TO,DUZ)
"DATA",811.8,77,100,170,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,77,100,171,0)
 Q
"DATA",811.8,77,100,172,0)
 ;
"DATA",811.8,77,100,173,0)
 ;=========================================================
"DATA",811.8,77,100,174,0)
APPL(NGET,BDT,EDT,PLIST,PARAM) ;List type computed finding that returns
"DATA",811.8,77,100,175,0)
 ;a list of patients with appointments in the date range BDT to EDT.
"DATA",811.8,77,100,176,0)
 N FILTER,FLDS,RESULT
"DATA",811.8,77,100,177,0)
 K ^TMP($J,PLIST),^TMP($J,"SDAMA301")
"DATA",811.8,77,100,178,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,77,100,179,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,77,100,180,0)
 S FILTER("SORT")="P"
"DATA",811.8,77,100,181,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,77,100,182,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,77,100,183,0)
 ;DBIA #4433
"DATA",811.8,77,100,184,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,77,100,185,0)
 I RESULT=-1 D APPERR("Patient List build") Q
"DATA",811.8,77,100,186,0)
 N COUNT,DATE,DFN,DONE,ITEM
"DATA",811.8,77,100,187,0)
 S DFN=""
"DATA",811.8,77,100,188,0)
 F  S DFN=$O(^TMP($J,"SDAMA301",DFN)) Q:DFN=""  D
"DATA",811.8,77,100,189,0)
 . S (COUNT,DONE)=0,DATE=""
"DATA",811.8,77,100,190,0)
 . F  S DATE=$O(^TMP($J,"SDAMA301",DFN,DATE),-1) Q:(DONE)!(DATE="")  D
"DATA",811.8,77,100,191,0)
 .. S COUNT=COUNT+1
"DATA",811.8,77,100,192,0)
 .. S ITEM=$P(^TMP($J,"SDAMA301",DFN,DATE),U,2)
"DATA",811.8,77,100,193,0)
 .. S ^TMP($J,PLIST,DFN,COUNT)=U_DATE_U_44_U_$P(ITEM,";",1)_U_$P(ITEM,";",2)
"DATA",811.8,77,100,194,0)
 .. I COUNT=NGET S DONE=1
"DATA",811.8,77,100,195,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,77,100,196,0)
 Q
"DATA",811.8,77,100,197,0)
 ;
"DATA",811.8,77,100,198,0)
 ;=========================================================
"DATA",811.8,77,100,199,0)
FSTATUS(STATUS) ;Format the STATUS, field #22.
"DATA",811.8,77,100,200,0)
 N TEXT,TMP
"DATA",811.8,77,100,201,0)
 S TMP=$P(STATUS,";",1)
"DATA",811.8,77,100,202,0)
 S TEXT=$S(TMP="":"",1:"Code - "_TMP)
"DATA",811.8,77,100,203,0)
 S TMP=$P(STATUS,";",2)
"DATA",811.8,77,100,204,0)
 I TMP'="" S TEXT=TEXT_"; Description - "_TMP
"DATA",811.8,77,100,205,0)
 S TMP=$P(STATUS,";",3)
"DATA",811.8,77,100,206,0)
 I TMP'="" S TEXT=TEXT_"; Print Status - "_TMP
"DATA",811.8,77,100,207,0)
 S TMP=$P(STATUS,";",4)
"DATA",811.8,77,100,208,0)
 I TMP'="" S TEXT=TEXT_"; Checked In Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,77,100,209,0)
 S TMP=$P(STATUS,";",5)
"DATA",811.8,77,100,210,0)
 I TMP'="" S TEXT=TEXT_"; Checked Out Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,77,100,211,0)
 S TMP=$P(STATUS,";",6)
"DATA",811.8,77,100,212,0)
 I TMP'="" S TEXT=TEXT_"; Admission Movement IFN - "_TMP
"DATA",811.8,77,100,213,0)
 Q TEXT
"DATA",811.8,77,100,214,0)
 ;
"DATA",811.8,77,100,215,0)
 ;=========================================================
"DATA",811.8,77,100,216,0)
PAPPL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Multiple type computed
"DATA",811.8,77,100,217,0)
 ;finding that returns a list appointments for a patient.
"DATA",811.8,77,100,218,0)
 N FIELD,FILTER,FLDS,PARAM,RESULT
"DATA",811.8,77,100,219,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,77,100,220,0)
 S PARAM=TEST K TEST
"DATA",811.8,77,100,221,0)
 S NFOUND=0
"DATA",811.8,77,100,222,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,77,100,223,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,77,100,224,0)
 S FILTER(4)=DFN
"DATA",811.8,77,100,225,0)
 S FILTER("SORT")="P"
"DATA",811.8,77,100,226,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,77,100,227,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,77,100,228,0)
 ;DBIA #4433
"DATA",811.8,77,100,229,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,77,100,230,0)
 I RESULT=-1 D APPERR("Computed finding evaluation") Q
"DATA",811.8,77,100,231,0)
 N ALLNULL,APPDATE,DATALIST,DONE,FLABEL,IND,ITEM,STATUS,TMP
"DATA",811.8,77,100,232,0)
 S FLABEL(1)="APPOINTMENT DATE/TIME"
"DATA",811.8,77,100,233,0)
 S FLABEL(2)="CLINIC"
"DATA",811.8,77,100,234,0)
 S FLABEL(3)="APPOINTMENT STATUS"
"DATA",811.8,77,100,235,0)
 S FLABEL(4)="PATIENT"
"DATA",811.8,77,100,236,0)
 S FLABEL(5)="LENGTH OF APPOINTMENT"
"DATA",811.8,77,100,237,0)
 S FLABEL(6)="COMMENTS"
"DATA",811.8,77,100,238,0)
 S FLABEL(7)="OVERBOOK"
"DATA",811.8,77,100,239,0)
 S FLABEL(8)="ELIGIBILITY OF VISIT"
"DATA",811.8,77,100,240,0)
 S FLABEL(9)="CHECK-IN DATE/TIME"
"DATA",811.8,77,100,241,0)
 S FLABEL(10)="APPOINTMENT TYPE"
"DATA",811.8,77,100,242,0)
 S FLABEL(11)="CHECK-OUT DATE/TIME"
"DATA",811.8,77,100,243,0)
 S FLABEL(12)="OUTPATIENT ENCOUNTER IEN"
"DATA",811.8,77,100,244,0)
 S FLABEL(13)="PRIMARY STOP CODE"
"DATA",811.8,77,100,245,0)
 S FLABEL(14)="CREDIT STOP CODE"
"DATA",811.8,77,100,246,0)
 S FLABEL(15)="WORKLOAD NON-COUNT"
"DATA",811.8,77,100,247,0)
 S FLABEL(16)="DATE APPOINTMENT MADE"
"DATA",811.8,77,100,248,0)
 S FLABEL(17)="DESIRED DATE OF APPOINTMENT"
"DATA",811.8,77,100,249,0)
 S FLABEL(18)="PURPOSE OF VISIT and SHORT DESCRIPTION"
"DATA",811.8,77,100,250,0)
 S FLABEL(19)="EKG DATE/TIME"
"DATA",811.8,77,100,251,0)
 S FLABEL(20)="X-RAY DATE/TIME"
"DATA",811.8,77,100,252,0)
 S FLABEL(21)="LAB DATE/TIME"
"DATA",811.8,77,100,253,0)
 S FLABEL(22)="STATUS"
"DATA",811.8,77,100,254,0)
 S FLABEL(23)="X-RAY FILMS"
"DATA",811.8,77,100,255,0)
 S FLABEL(24)="AUTO-REBOOKED APPOINTMENT DATE/TIME"
"DATA",811.8,77,100,256,0)
 S FLABEL(25)="NO-SHOW/CANCEL DATE/TIME"
"DATA",811.8,77,100,257,0)
 S FLABEL(26)="RSA APPOINTMENT ID"
"DATA",811.8,77,100,258,0)
 S FLABEL(28)="DATA ENTRY CLERK"
"DATA",811.8,77,100,259,0)
 S FLABEL(29)="NO-SHOW/CANCELED BY"
"DATA",811.8,77,100,260,0)
 S FLABEL(30)="CHECK-IN USER"
"DATA",811.8,77,100,261,0)
 S FLABEL(31)="CHECK-OUT USER"
"DATA",811.8,77,100,262,0)
 S FLABEL(32)="CANCELLATION REASON"
"DATA",811.8,77,100,263,0)
 S FLABEL(33)="CONSULT LINK"
"DATA",811.8,77,100,264,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,77,100,265,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,77,100,266,0)
 S APPDATE="",DONE=0
"DATA",811.8,77,100,267,0)
 F  S APPDATE=$O(^TMP($J,"SDAMA301",DFN,APPDATE),SDIR) Q:(DONE)!(APPDATE="")  D
"DATA",811.8,77,100,268,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,77,100,269,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=APPDATE
"DATA",811.8,77,100,270,0)
 .;Fields 1-26
"DATA",811.8,77,100,271,0)
 . S DATALIST=$G(^TMP($J,"SDAMA301",DFN,APPDATE))
"DATA",811.8,77,100,272,0)
 .;Fields 28-33
"DATA",811.8,77,100,273,0)
 . S TMP=$G(^TMP($J,"SDAMA301",DFN,APPDATE,0))
"DATA",811.8,77,100,274,0)
 . S ALLNULL=1
"DATA",811.8,77,100,275,0)
 . I TMP'="" F IND=1:1:$L(TMP,U) I $P(TMP,U,IND)'="" S ALLNULL=0
"DATA",811.8,77,100,276,0)
 . I 'ALLNULL S $P(DATALIST,U,28)=TMP
"DATA",811.8,77,100,277,0)
 . F IND=1:1:$L(DATALIST,U) D
"DATA",811.8,77,100,278,0)
 .. S FIELD=$P(DATALIST,U,IND)
"DATA",811.8,77,100,279,0)
 .. I IND=6 S FIELD=$G(^TMP($J,"SDAMA301",DFN,APPDATE,"C"))
"DATA",811.8,77,100,280,0)
 .. I FIELD="" Q
"DATA",811.8,77,100,281,0)
 .. I IND=22 S STATUS=FIELD
"DATA",811.8,77,100,282,0)
 .. I FLABEL(IND)["DATE" S FIELD=$$EDATE^PXRMDATE(FIELD)
"DATA",811.8,77,100,283,0)
 .. I FIELD[";" S FIELD=$P(FIELD,";",2)
"DATA",811.8,77,100,284,0)
 ..;Save the clinic as the value.
"DATA",811.8,77,100,285,0)
 .. I IND=2 S DATA(NFOUND,"VALUE")=FIELD
"DATA",811.8,77,100,286,0)
 .. I IND=22 S FIELD=$$FSTATUS(STATUS)
"DATA",811.8,77,100,287,0)
 .. S TEXT(NFOUND,IND)=FLABEL(IND)_": "_FIELD
"DATA",811.8,77,100,288,0)
 .. S DATA(NFOUND,FLABEL(IND))=FIELD
"DATA",811.8,77,100,289,0)
 . I NFOUND=NGET S DONE=1
"DATA",811.8,77,100,290,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,77,100,291,0)
 Q
"DATA",811.8,77,100,292,0)
 ;
"DATA",811.8,77,100,293,0)
 ;=========================================================
"DATA",811.8,77,100,294,0)
SFILTER(PARAM,FILTER,FLDS) ;Parse the PARMETER and set the appropriate
"DATA",811.8,77,100,295,0)
 ;fields.
"DATA",811.8,77,100,296,0)
 N IND,LL,P1,P2,STATUS,TEMP
"DATA",811.8,77,100,297,0)
 S (FLDS,LL,STATUS)=""
"DATA",811.8,77,100,298,0)
 F IND=1:1:$L(PARAM,U) D
"DATA",811.8,77,100,299,0)
 . S TEMP=$P(PARAM,U,IND)
"DATA",811.8,77,100,300,0)
 . S P1=$P(TEMP,":",1),P2=$P(TEMP,":",2)
"DATA",811.8,77,100,301,0)
 . I P1="FLDS" S FLDS=$TR(P2,",",";") Q
"DATA",811.8,77,100,302,0)
 . I P1="LL" S LL=P2 Q
"DATA",811.8,77,100,303,0)
 . I P1="STATUS" S STATUS=$TR(P2,",",";") Q
"DATA",811.8,77,100,304,0)
 S FILTER("FLDS")=$S(FLDS="":"1;2",1:FLDS)
"DATA",811.8,77,100,305,0)
 S FILTER(3)=$S(STATUS="":"I;R",1:STATUS)
"DATA",811.8,77,100,306,0)
 I LL="" Q
"DATA",811.8,77,100,307,0)
 S LL=$O(^PXRMD(810.9,"B",LL,""))
"DATA",811.8,77,100,308,0)
 I LL="" S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NO LL")="Location List "_P2_" does not exist."
"DATA",811.8,77,100,309,0)
 D LOCLIST^PXRMLOCF(LL,"HLOCL")
"DATA",811.8,77,100,310,0)
 I $D(^TMP($J,"HLOCL")) S FILTER(2)="^TMP($J,""HLOCL"","
"DATA",811.8,77,100,311,0)
 Q
"DATA",811.8,77,100,312,0)
 ;
"DATA",811.8,77,100,313,0)
 ;=========================================================
"DATA",811.8,77,100,314,0)
TFL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Multiple type computed
"DATA",811.8,77,100,315,0)
 ;finding for a patient's treating facility list.
"DATA",811.8,77,100,316,0)
 N DONE,IND,NOW,SDIR,TDATE,TFL,TFLD
"DATA",811.8,77,100,317,0)
 S NFOUND=0
"DATA",811.8,77,100,318,0)
 ;DBIA #2990
"DATA",811.8,77,100,319,0)
 D TFL^VAFCTFU1(.TFL,DFN)
"DATA",811.8,77,100,320,0)
 I +TFL(1)=-1 Q
"DATA",811.8,77,100,321,0)
 S NOW=$$NOW^PXRMDATE
"DATA",811.8,77,100,322,0)
 S (DONE,IND)=0
"DATA",811.8,77,100,323,0)
 F  S IND=$O(TFL(IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,77,100,324,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,77,100,325,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=NOW
"DATA",811.8,77,100,326,0)
 . S VALUE(NFOUND,"VALUE")=TFL(IND)
"DATA",811.8,77,100,327,0)
 . I NFOUND=NGET S DONE=1 Q
"DATA",811.8,77,100,328,0)
 F IND=1:1:NFOUND S VALUE(IND,"NUM FACILITIES")=NFOUND
"DATA",811.8,77,100,329,0)
 Q
"DATA",811.8,77,100,330,0)
 ;
"DATA",811.8,77,100,331,0)
]]>
"DATA",811.8,77,100,332,0)
</CODE>
"DATA",811.8,77,100,333,0)
</M_ROUTINE>
"DATA",811.8,77,100,334,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,335,0)
<FILE_NAME>MH TESTS AND SURVEYS</FILE_NAME>
"DATA",811.8,77,100,336,0)
<FILE_NUMBER>601.71</FILE_NUMBER>
"DATA",811.8,77,100,337,0)
<POINT_01>SBR</POINT_01>
"DATA",811.8,77,100,338,0)
<INTERNAL_ENTRY_NUMBER>96</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,339,0)
<CHECKSUM>3317326330</CHECKSUM>
"DATA",811.8,77,100,340,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,341,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,342,0)
<![CDATA[
"DATA",811.8,77,100,343,0)
601.71;+96,;.01~SBR
"DATA",811.8,77,100,344,0)
]]>
"DATA",811.8,77,100,345,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,346,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,347,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,348,0)
<FILE_NAME>TIU TEMPLATE FIELD</FILE_NAME>
"DATA",811.8,77,100,349,0)
<FILE_NUMBER>8927.1</FILE_NUMBER>
"DATA",811.8,77,100,350,0)
<POINT_01>WORD PROCESSING FIELD</POINT_01>
"DATA",811.8,77,100,351,0)
<INTERNAL_ENTRY_NUMBER>934</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,352,0)
<CHECKSUM>2664388302</CHECKSUM>
"DATA",811.8,77,100,353,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,354,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,355,0)
<![CDATA[
"DATA",811.8,77,100,356,0)
8927.1;+934,;.01~WORD PROCESSING FIELD
"DATA",811.8,77,100,357,0)
8927.1;+934,;.02~Word Processing
"DATA",811.8,77,100,358,0)
8927.1;+934,;.03~NO
"DATA",811.8,77,100,359,0)
8927.1;+934,;.04~74
"DATA",811.8,77,100,360,0)
8927.1;+934,;.07~0
"DATA",811.8,77,100,361,0)
8927.1;+934,;.08~NO
"DATA",811.8,77,100,362,0)
8927.1;+934,;.09~NO
"DATA",811.8,77,100,363,0)
8927.1;+934,;.1~5
"DATA",811.8,77,100,364,0)
8927.1;+934,;.11~0
"DATA",811.8,77,100,365,0)
8927.1;+934,;.12~0
"DATA",811.8,77,100,366,0)
8927.1;+934,;.13~0
"DATA",811.8,77,100,367,0)
8927.1;+934,;.14~0
"DATA",811.8,77,100,368,0)
8927.1;+934,;.15~0
"DATA",811.8,77,100,369,0)
]]>
"DATA",811.8,77,100,370,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,371,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,372,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,373,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,374,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,375,0)
<POINT_01>MH NOSHOW MANAGEMENT</POINT_01>
"DATA",811.8,77,100,376,0)
<INTERNAL_ENTRY_NUMBER>660160</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,377,0)
<CHECKSUM>3718963363</CHECKSUM>
"DATA",811.8,77,100,378,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,379,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,380,0)
<![CDATA[
"DATA",811.8,77,100,381,0)
9999999.64;+660160,;.01~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,382,0)
9999999.64;+660160,;.1~CATEGORY
"DATA",811.8,77,100,383,0)
]]>
"DATA",811.8,77,100,384,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,385,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,386,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,387,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,388,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,389,0)
<POINT_01>MH SUICIDE COMPLETED</POINT_01>
"DATA",811.8,77,100,390,0)
<INTERNAL_ENTRY_NUMBER>660187</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,391,0)
<CHECKSUM>3955573563</CHECKSUM>
"DATA",811.8,77,100,392,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,393,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,394,0)
<![CDATA[
"DATA",811.8,77,100,395,0)
9999999.64;+660187,;.01~MH SUICIDE COMPLETED
"DATA",811.8,77,100,396,0)
9999999.64;+660187,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,397,0)
9999999.64;+660187,;.08~YES
"DATA",811.8,77,100,398,0)
9999999.64;+660187,;.1~FACTOR
"DATA",811.8,77,100,399,0)
]]>
"DATA",811.8,77,100,400,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,401,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,402,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,403,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,404,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,405,0)
<POINT_01>MH SUICIDE ATTEMPTED</POINT_01>
"DATA",811.8,77,100,406,0)
<INTERNAL_ENTRY_NUMBER>660186</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,407,0)
<CHECKSUM>3876509534</CHECKSUM>
"DATA",811.8,77,100,408,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,409,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,410,0)
<![CDATA[
"DATA",811.8,77,100,411,0)
9999999.64;+660186,;.01~MH SUICIDE ATTEMPTED
"DATA",811.8,77,100,412,0)
9999999.64;+660186,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,413,0)
9999999.64;+660186,;.08~YES
"DATA",811.8,77,100,414,0)
9999999.64;+660186,;.1~FACTOR
"DATA",811.8,77,100,415,0)
]]>
"DATA",811.8,77,100,416,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,417,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,418,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,419,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,420,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,421,0)
<POINT_01>MH NOSHOW OTHER OUTCOME</POINT_01>
"DATA",811.8,77,100,422,0)
<INTERNAL_ENTRY_NUMBER>660169</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,423,0)
<CHECKSUM>1799111522</CHECKSUM>
"DATA",811.8,77,100,424,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,425,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,426,0)
<![CDATA[
"DATA",811.8,77,100,427,0)
9999999.64;+660169,;.01~MH NOSHOW OTHER OUTCOME
"DATA",811.8,77,100,428,0)
9999999.64;+660169,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,429,0)
9999999.64;+660169,;.08~YES
"DATA",811.8,77,100,430,0)
9999999.64;+660169,;.1~FACTOR
"DATA",811.8,77,100,431,0)
]]>
"DATA",811.8,77,100,432,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,433,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,434,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,435,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,436,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,437,0)
<POINT_01>MH NOSHOW PLAN DEVELOPED</POINT_01>
"DATA",811.8,77,100,438,0)
<INTERNAL_ENTRY_NUMBER>660166</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,439,0)
<CHECKSUM>327579390</CHECKSUM>
"DATA",811.8,77,100,440,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,441,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,442,0)
<![CDATA[
"DATA",811.8,77,100,443,0)
9999999.64;+660166,;.01~MH NOSHOW PLAN DEVELOPED
"DATA",811.8,77,100,444,0)
9999999.64;+660166,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,445,0)
9999999.64;+660166,;.08~YES
"DATA",811.8,77,100,446,0)
9999999.64;+660166,;.1~FACTOR
"DATA",811.8,77,100,447,0)
]]>
"DATA",811.8,77,100,448,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,449,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,450,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,451,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,452,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,453,0)
<POINT_01>MH NOSHOW OUTREACH LETTER</POINT_01>
"DATA",811.8,77,100,454,0)
<INTERNAL_ENTRY_NUMBER>660168</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,455,0)
<CHECKSUM>1639152510</CHECKSUM>
"DATA",811.8,77,100,456,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,457,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,458,0)
<![CDATA[
"DATA",811.8,77,100,459,0)
9999999.64;+660168,;.01~MH NOSHOW OUTREACH LETTER
"DATA",811.8,77,100,460,0)
9999999.64;+660168,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,461,0)
9999999.64;+660168,;.08~YES
"DATA",811.8,77,100,462,0)
9999999.64;+660168,;.1~FACTOR
"DATA",811.8,77,100,463,0)
]]>
"DATA",811.8,77,100,464,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,465,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,466,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,467,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,468,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,469,0)
<POINT_01>MH NOSHOW PT CALLED 3X UNSUCCESSFUL</POINT_01>
"DATA",811.8,77,100,470,0)
<INTERNAL_ENTRY_NUMBER>660164</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,471,0)
<CHECKSUM>1653828879</CHECKSUM>
"DATA",811.8,77,100,472,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,473,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,474,0)
<![CDATA[
"DATA",811.8,77,100,475,0)
9999999.64;+660164,;.01~MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,77,100,476,0)
9999999.64;+660164,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,477,0)
9999999.64;+660164,;.08~YES
"DATA",811.8,77,100,478,0)
9999999.64;+660164,;.1~FACTOR
"DATA",811.8,77,100,479,0)
]]>
"DATA",811.8,77,100,480,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,481,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,482,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,483,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,484,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,485,0)
<POINT_01>MH NOSHOW PT EMERGENT CARE</POINT_01>
"DATA",811.8,77,100,486,0)
<INTERNAL_ENTRY_NUMBER>660162</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,487,0)
<CHECKSUM>1113440761</CHECKSUM>
"DATA",811.8,77,100,488,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,489,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,490,0)
<![CDATA[
"DATA",811.8,77,100,491,0)
9999999.64;+660162,;.01~MH NOSHOW PT EMERGENT CARE
"DATA",811.8,77,100,492,0)
9999999.64;+660162,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,493,0)
9999999.64;+660162,;.08~YES
"DATA",811.8,77,100,494,0)
9999999.64;+660162,;.1~FACTOR
"DATA",811.8,77,100,495,0)
]]>
"DATA",811.8,77,100,496,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,497,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,498,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,499,0)
<FILE_NAME>HEALTH FACTORS</FILE_NAME>
"DATA",811.8,77,100,500,0)
<FILE_NUMBER>9999999.64</FILE_NUMBER>
"DATA",811.8,77,100,501,0)
<POINT_01>MH NOSHOW PT CONTACTED</POINT_01>
"DATA",811.8,77,100,502,0)
<INTERNAL_ENTRY_NUMBER>660161</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,503,0)
<CHECKSUM>4190754155</CHECKSUM>
"DATA",811.8,77,100,504,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,505,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,506,0)
<![CDATA[
"DATA",811.8,77,100,507,0)
9999999.64;+660161,;.01~MH NOSHOW PT CONTACTED
"DATA",811.8,77,100,508,0)
9999999.64;+660161,;.03~MH NOSHOW MANAGEMENT
"DATA",811.8,77,100,509,0)
9999999.64;+660161,;.08~YES
"DATA",811.8,77,100,510,0)
9999999.64;+660161,;.1~FACTOR
"DATA",811.8,77,100,511,0)
]]>
"DATA",811.8,77,100,512,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,513,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,514,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,515,0)
<FILE_NAME>REMINDER SPONSOR</FILE_NAME>
"DATA",811.8,77,100,516,0)
<FILE_NUMBER>811.6</FILE_NUMBER>
"DATA",811.8,77,100,517,0)
<POINT_01>Office of Quality &amp; Performance</POINT_01>
"DATA",811.8,77,100,518,0)
<INTERNAL_ENTRY_NUMBER>15</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,519,0)
<CHECKSUM>1008763345</CHECKSUM>
"DATA",811.8,77,100,520,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,521,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,522,0)
<![CDATA[
"DATA",811.8,77,100,523,0)
811.6;+15,;.01~Office of Quality & Performance
"DATA",811.8,77,100,524,0)
811.6;+15,;100~NATIONAL
"DATA",811.8,77,100,525,0)
811.63;+16,+15,;.01~12/06/2012@15:23:18
"DATA",811.8,77,100,526,0)
811.63;+16,+15,;2~WP-start~1
"DATA",811.8,77,100,527,0)
Exchange Stub
"DATA",811.8,77,100,528,0)
]]>
"DATA",811.8,77,100,529,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,530,0)
<IEN_ROOT>
"DATA",811.8,77,100,531,0)
<![CDATA[
"DATA",811.8,77,100,532,0)
16^1
"DATA",811.8,77,100,533,0)
]]>
"DATA",811.8,77,100,534,0)
</IEN_ROOT>
"DATA",811.8,77,100,535,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,536,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,537,0)
<FILE_NAME>REMINDER SPONSOR</FILE_NAME>
"DATA",811.8,77,100,538,0)
<FILE_NUMBER>811.6</FILE_NUMBER>
"DATA",811.8,77,100,539,0)
<POINT_01>Office of Mental Health Services</POINT_01>
"DATA",811.8,77,100,540,0)
<INTERNAL_ENTRY_NUMBER>11</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,541,0)
<CHECKSUM>1503526438</CHECKSUM>
"DATA",811.8,77,100,542,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,543,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,544,0)
<![CDATA[
"DATA",811.8,77,100,545,0)
811.6;+11,;.01~Office of Mental Health Services
"DATA",811.8,77,100,546,0)
811.6;+11,;100~NATIONAL
"DATA",811.8,77,100,547,0)
811.61;+12,+11,;.01~Mental Health and Behavioral Science Strategic Group
"DATA",811.8,77,100,548,0)
811.61;+12,+11,;1~WP-start~4
"DATA",811.8,77,100,549,0)
Amy Street, PhD
"DATA",811.8,77,100,550,0)
Women's Health Sciences Division, National Center for PTSD
"DATA",811.8,77,100,551,0)
VA Boston HCS
"DATA",811.8,77,100,552,0)
(617) 232-9500, ext. 5111
"DATA",811.8,77,100,553,0)
811.63;+13,+11,;.01~12/06/2012@15:23:18
"DATA",811.8,77,100,554,0)
811.63;+13,+11,;2~WP-start~1
"DATA",811.8,77,100,555,0)
Exchange Stub
"DATA",811.8,77,100,556,0)
]]>
"DATA",811.8,77,100,557,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,558,0)
<IEN_ROOT>
"DATA",811.8,77,100,559,0)
<![CDATA[
"DATA",811.8,77,100,560,0)
12^1
"DATA",811.8,77,100,561,0)
13^1
"DATA",811.8,77,100,562,0)
]]>
"DATA",811.8,77,100,563,0)
</IEN_ROOT>
"DATA",811.8,77,100,564,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,565,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,566,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,77,100,567,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,77,100,568,0)
<POINT_01>VA-APPOINTMENTS FOR A PATIENT</POINT_01>
"DATA",811.8,77,100,569,0)
<INTERNAL_ENTRY_NUMBER>15</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,570,0)
<CHECKSUM>3006509961</CHECKSUM>
"DATA",811.8,77,100,571,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,572,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,573,0)
<![CDATA[
"DATA",811.8,77,100,574,0)
811.4;+15,;.01~VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,77,100,575,0)
811.4;+15,;.02~PXRMRDI
"DATA",811.8,77,100,576,0)
811.4;+15,;.03~PAPPL
"DATA",811.8,77,100,577,0)
811.4;+15,;.04~VA-Appointments for a Patient
"DATA",811.8,77,100,578,0)
811.4;+15,;1~WP-start~119
"DATA",811.8,77,100,579,0)
This multiple occurrence computed finding returns a list of
"DATA",811.8,77,100,580,0)
appointments for a patient in the specified date range from 
"DATA",811.8,77,100,581,0)
the Scheduling Package. 
"DATA",811.8,77,100,582,0)

"DATA",811.8,77,100,583,0)
The Computed Finding Parameter can be used to specify which 
"DATA",811.8,77,100,584,0)
appointment data fields should be returned from the Scheduling 
"DATA",811.8,77,100,585,0)
package and filter the results returned based on location 
"DATA",811.8,77,100,586,0)
and status. The Computed Finding Parameter entry uses
"DATA",811.8,77,100,587,0)
FLDS: to specify appointment data fields, STATUS: to filter 
"DATA",811.8,77,100,588,0)
specific statuses, and LL: to specify a Reminder Location List 
"DATA",811.8,77,100,589,0)
to filter locations.  
"DATA",811.8,77,100,590,0)

"DATA",811.8,77,100,591,0)
FLDS, STATUS, and LL are all optional and can be defined in any 
"DATA",811.8,77,100,592,0)
order in the computed finding parameter field.
"DATA",811.8,77,100,593,0)
Some examples of how to use FLDS, STATUS and/or LL:
"DATA",811.8,77,100,594,0)
  FLDS:1,2,16^STATUS:R^LL:DIABETIC LOCATIONS
"DATA",811.8,77,100,595,0)
  STATUS:CP,CC^FLDS:25
"DATA",811.8,77,100,596,0)
  LL:DIABETIC LOCATION
"DATA",811.8,77,100,597,0)

"DATA",811.8,77,100,598,0)
FLDS parameter information:
"DATA",811.8,77,100,599,0)
The appointment data fields are specified as follows:  
"DATA",811.8,77,100,600,0)
FLDS:F1,F2,... where F1,F2,... are any of the possible ID values
"DATA",811.8,77,100,601,0)
listed in the Available Appointment Data Fields table below.
"DATA",811.8,77,100,602,0)
The F1,F2,... ID values specify what data associated with the 
"DATA",811.8,77,100,603,0)
appointment will display in the clinical maintenance output. 
"DATA",811.8,77,100,604,0)
If no FLDS is specified, the default display fields will be 1,2
"DATA",811.8,77,100,605,0)
for APPOINTMENT DATE/TIME and CLINIC. 
"DATA",811.8,77,100,606,0)

"DATA",811.8,77,100,607,0)
Additionally, each F1,F2,... specified will be returned as CSUB 
"DATA",811.8,77,100,608,0)
data that can also be used in the computed finding's CONDITION
"DATA",811.8,77,100,609,0)
field. The CONDITION can be used to further screen the filtered
"DATA",811.8,77,100,610,0)
appointments, returned by Scheduling, by setting the USE STATUS/COND
"DATA",811.8,77,100,611,0)
IN SEARCH field to YES. 
"DATA",811.8,77,100,612,0)

"DATA",811.8,77,100,613,0)
For example, if you only want appointments that were checked out, 
"DATA",811.8,77,100,614,0)
use FLDS: 1,2,11 to get the APPOINTMENT DATE/TIME, CLINIC, and 
"DATA",811.8,77,100,615,0)
CHECK-OUT DATE/TIME for display purposes. The FLDS:1,2,11 will
"DATA",811.8,77,100,616,0)
return the CSUB data "APPOINTMENT DATE/TIME", "CLINIC" and 
"DATA",811.8,77,100,617,0)
"CHECK-OUT DATE/TIME".
"DATA",811.8,77,100,618,0)

"DATA",811.8,77,100,619,0)
CSUB values are used in the CONDITION field to do a comparison to
"DATA",811.8,77,100,620,0)
numeric or string values. Using +V causes the CSUB data to be
"DATA",811.8,77,100,621,0)
interpreted as numeric. Strings that cannot be converted to a
"DATA",811.8,77,100,622,0)
number are set to zero. For example, a CONDITION such as I
"DATA",811.8,77,100,623,0)
+V("CHECK-OUT DATE/TIME")>0 would be true if the appointment had a
"DATA",811.8,77,100,624,0)
check-out date/time.
"DATA",811.8,77,100,625,0)

"DATA",811.8,77,100,626,0)
List of Available Appointment Data Fields table with assigned ID
"DATA",811.8,77,100,627,0)
    ID      Field Name
"DATA",811.8,77,100,628,0)
--------------------------------------------------------
"DATA",811.8,77,100,629,0)

"DATA",811.8,77,100,630,0)
     1     APPOINTMENT DATE/TIME
"DATA",811.8,77,100,631,0)
     2     CLINIC
"DATA",811.8,77,100,632,0)
     3     APPOINTMENT STATUS     
"DATA",811.8,77,100,633,0)
     4     PATIENT
"DATA",811.8,77,100,634,0)
     5     LENGTH OF APPOINTMENT
"DATA",811.8,77,100,635,0)
     6     COMMENTS
"DATA",811.8,77,100,636,0)
     7     OVERBOOK
"DATA",811.8,77,100,637,0)
     8     ELIGIBILITY OF VISIT
"DATA",811.8,77,100,638,0)
     9     CHECK-IN DATE/TIME
"DATA",811.8,77,100,639,0)
    10     APPOINTMENT TYPE
"DATA",811.8,77,100,640,0)
    11     CHECK-OUT DATE/TIME
"DATA",811.8,77,100,641,0)
    12     OUTPATIENT ENCOUNTER IEN
"DATA",811.8,77,100,642,0)
    13     PRIMARY STOP CODE
"DATA",811.8,77,100,643,0)
    14     CREDIT STOP CODE
"DATA",811.8,77,100,644,0)
    15     WORKLOAD NON-COUNT
"DATA",811.8,77,100,645,0)
    16     DATE APPOINTMENT MADE
"DATA",811.8,77,100,646,0)
    17     DESIRED DATE OF APPOINTMENT
"DATA",811.8,77,100,647,0)
    18     PURPOSE OF VISIT and SHORT DESCRIPTION
"DATA",811.8,77,100,648,0)
    19     EKG DATE/TIME
"DATA",811.8,77,100,649,0)
    20     X-RAY DATE/TIME
"DATA",811.8,77,100,650,0)
    21     LAB DATE/TIME
"DATA",811.8,77,100,651,0)
    22     STATUS
"DATA",811.8,77,100,652,0)
    23     X-RAY FILMS
"DATA",811.8,77,100,653,0)
    24     AUTO-REBOOKED APPOINTMENT DATE/TIME
"DATA",811.8,77,100,654,0)
    25     NO-SHOW/CANCEL DATE/TIME
"DATA",811.8,77,100,655,0)
    26     RSA APPOINTMENT ID
"DATA",811.8,77,100,656,0)
    28     DATA ENTRY CLERK
"DATA",811.8,77,100,657,0)
    29     NO-SHOW/CANCELED BY
"DATA",811.8,77,100,658,0)
    30     CHECK-IN USER
"DATA",811.8,77,100,659,0)
    31     CHECK-OUT USER
"DATA",811.8,77,100,660,0)
    32     CANCELLATION REASON
"DATA",811.8,77,100,661,0)
    33     CONSULT LINK
"DATA",811.8,77,100,662,0)

"DATA",811.8,77,100,663,0)
STATUS information:
"DATA",811.8,77,100,664,0)
STATUS: is used to set a filter on the appointment status; only
"DATA",811.8,77,100,665,0)
those appointments with a status that matches the STATUS: values
"DATA",811.8,77,100,666,0)
list will be returned. The possible values that the Scheduling
"DATA",811.8,77,100,667,0)
API allows are:
"DATA",811.8,77,100,668,0)

"DATA",811.8,77,100,669,0)
VALUE     Description 
"DATA",811.8,77,100,670,0)
--------------------------------------------------------
"DATA",811.8,77,100,671,0)
    R      SCHEDULED/KEPT
"DATA",811.8,77,100,672,0)
    I      INPATIENT
"DATA",811.8,77,100,673,0)
    NS     NO-SHOW
"DATA",811.8,77,100,674,0)
    NSR    NO-SHOW, RESCHEDULED
"DATA",811.8,77,100,675,0)
    CP     CANCELLED BY PATIENT
"DATA",811.8,77,100,676,0)
    CPR    CANCELLED BY PATIENT, RESCHEDULED
"DATA",811.8,77,100,677,0)
    CC     CANCELLED BY CLINIC
"DATA",811.8,77,100,678,0)
    CCR    CANCELLED BY CLINIC, RESCHEDULED 
"DATA",811.8,77,100,679,0)
    NT     NO ACTION TAKEN
"DATA",811.8,77,100,680,0)

"DATA",811.8,77,100,681,0)
If STATUS is not specified, the default is R,I.
"DATA",811.8,77,100,682,0)

"DATA",811.8,77,100,683,0)
The APPOINTMENT STATUS returned by the API is a summarized list
"DATA",811.8,77,100,684,0)
which does not include detailed statuses such as Future, Checked-In,
"DATA",811.8,77,100,685,0)
or Checked Out. These  statuses are summarized as SCHEDULED/KEPT. 
"DATA",811.8,77,100,686,0)
As a result, a CONDITION may be required to make sure you are
"DATA",811.8,77,100,687,0)
getting the correct results. For example, if you are looking for an
"DATA",811.8,77,100,688,0)
appointment that was kept, you would set STATUS:R combined with a
"DATA",811.8,77,100,689,0)
CONDITION of I (+V("OUTPATIENT ENCOUNTER IEN")>0)!(+V("CHECK-OUT
"DATA",811.8,77,100,690,0)
DATE/TIME")>0) with USE STATUS/COND IN SEARCH set to YES.
"DATA",811.8,77,100,691,0)

"DATA",811.8,77,100,692,0)
LL information:
"DATA",811.8,77,100,693,0)
LL:Reminder Location List specifies a list of locations so that only
"DATA",811.8,77,100,694,0)
appointments for those locations will be returned. If LL is not
"DATA",811.8,77,100,695,0)
specified, then appointments for all locations will be returned.
"DATA",811.8,77,100,696,0)

"DATA",811.8,77,100,697,0)

"DATA",811.8,77,100,698,0)
811.4;+15,;5~MULTIPLE
"DATA",811.8,77,100,699,0)
811.4;+15,;6~NO
"DATA",811.8,77,100,700,0)
811.4;+15,;100~NATIONAL
"DATA",811.8,77,100,701,0)
811.42;+16,+15,;.01~12/06/2012@15:23:18
"DATA",811.8,77,100,702,0)
811.42;+16,+15,;2~WP-start~1
"DATA",811.8,77,100,703,0)
Exchange Stub
"DATA",811.8,77,100,704,0)
]]>
"DATA",811.8,77,100,705,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,706,0)
<IEN_ROOT>
"DATA",811.8,77,100,707,0)
<![CDATA[
"DATA",811.8,77,100,708,0)
16^1
"DATA",811.8,77,100,709,0)
]]>
"DATA",811.8,77,100,710,0)
</IEN_ROOT>
"DATA",811.8,77,100,711,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,712,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,713,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,77,100,714,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,77,100,715,0)
<POINT_01>VA-PATIENT RECORD FLAG INFORMATION</POINT_01>
"DATA",811.8,77,100,716,0)
<INTERNAL_ENTRY_NUMBER>75</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,717,0)
<CHECKSUM>926715250</CHECKSUM>
"DATA",811.8,77,100,718,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,719,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,720,0)
<![CDATA[
"DATA",811.8,77,100,721,0)
811.4;+75,;.01~VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,77,100,722,0)
811.4;+75,;.02~PXRMPRF
"DATA",811.8,77,100,723,0)
811.4;+75,;.03~GETINF
"DATA",811.8,77,100,724,0)
811.4;+75,;.04~VA-Patient Record Flag Information
"DATA",811.8,77,100,725,0)
811.4;+75,;1~WP-start~26
"DATA",811.8,77,100,726,0)
This multiple type computed finding returns information about a
"DATA",811.8,77,100,727,0)
specified patient record flag for a patient. The Computed Finding
"DATA",811.8,77,100,728,0)
Parameter is used to specify the flag in the following format:
"DATA",811.8,77,100,729,0)
FLAG NAME^FLAG TYPE
"DATA",811.8,77,100,730,0)

"DATA",811.8,77,100,731,0)
Where FLAG NAME is the exact name of the flag and FLAG TYPE is L for
"DATA",811.8,77,100,732,0)
local or N for national. FLAG TYPE is optional and defaults to L.
"DATA",811.8,77,100,733,0)

"DATA",811.8,77,100,734,0)
The computed finding will be true if the flag was active at any time in
"DATA",811.8,77,100,735,0)
the date range.
"DATA",811.8,77,100,736,0)

"DATA",811.8,77,100,737,0)
The following "CSUBS" are available:
"DATA",811.8,77,100,738,0)

"DATA",811.8,77,100,739,0)
   "ACTION" The action
"DATA",811.8,77,100,740,0)
  "APPRVBY" Approved by
"DATA",811.8,77,100,741,0)
"ASSIGN DT" Date and time the flag was assigned
"DATA",811.8,77,100,742,0)
 "CATEGORY" The category
"DATA",811.8,77,100,743,0)
     "DATE" Date of the action
"DATA",811.8,77,100,744,0)
 "FLAGTYPE" Flag type
"DATA",811.8,77,100,745,0)
"REVIEW DT" Review date
"DATA",811.8,77,100,746,0)
"TIU TITLE" TIU title associated with the flag
"DATA",811.8,77,100,747,0)

"DATA",811.8,77,100,748,0)

"DATA",811.8,77,100,749,0)

"DATA",811.8,77,100,750,0)

"DATA",811.8,77,100,751,0)

"DATA",811.8,77,100,752,0)
811.4;+75,;5~MULTIPLE
"DATA",811.8,77,100,753,0)
811.4;+75,;6~YES
"DATA",811.8,77,100,754,0)
811.4;+75,;100~NATIONAL
"DATA",811.8,77,100,755,0)
811.42;+76,+75,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,756,0)
811.42;+76,+75,;2~WP-start~1
"DATA",811.8,77,100,757,0)
Exchange Stub
"DATA",811.8,77,100,758,0)
]]>
"DATA",811.8,77,100,759,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,760,0)
<IEN_ROOT>
"DATA",811.8,77,100,761,0)
<![CDATA[
"DATA",811.8,77,100,762,0)
76^1
"DATA",811.8,77,100,763,0)
]]>
"DATA",811.8,77,100,764,0)
</IEN_ROOT>
"DATA",811.8,77,100,765,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,766,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,767,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,768,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,769,0)
<POINT_01>VA-MH APPT KEPT</POINT_01>
"DATA",811.8,77,100,770,0)
<INTERNAL_ENTRY_NUMBER>835</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,771,0)
<CHECKSUM>2483527531</CHECKSUM>
"DATA",811.8,77,100,772,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,773,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,774,0)
<![CDATA[
"DATA",811.8,77,100,775,0)
811.5;+835,;.01~VA-MH APPT KEPT
"DATA",811.8,77,100,776,0)
811.5;+835,;100~NATIONAL
"DATA",811.8,77,100,777,0)
811.5;+835,;101~Office of Mental Health Services
"DATA",811.8,77,100,778,0)
811.52;+836,+835,;.01~CF.VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,77,100,779,0)
811.52;+836,+835,;14~I +V("OUTPATIENT ENCOUNTER IEN")>0!(+V("CHECK-OUT DATE/TIME")>0)
"DATA",811.8,77,100,780,0)
811.52;+836,+835,;22~I +$G(V("OUTPATIENT ENCOUNTER IEN"))>0!(+$G(V("CHECK-OUT DATE/TIME"))>0)
"DATA",811.8,77,100,781,0)
811.52;+836,+835,;23~"OUTPATIENT ENCOUNTER IEN";"CHECK-OUT DATE/TIME";
"DATA",811.8,77,100,782,0)
811.52;+836,+835,;26~FLDS:1,2,3,11,12^STATUS:R^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,77,100,783,0)
811.53;+837,+835,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,784,0)
811.53;+837,+835,;2~WP-start~1
"DATA",811.8,77,100,785,0)
Exchange Stub
"DATA",811.8,77,100,786,0)
]]>
"DATA",811.8,77,100,787,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,788,0)
<IEN_ROOT>
"DATA",811.8,77,100,789,0)
<![CDATA[
"DATA",811.8,77,100,790,0)
836^1
"DATA",811.8,77,100,791,0)
837^1
"DATA",811.8,77,100,792,0)
]]>
"DATA",811.8,77,100,793,0)
</IEN_ROOT>
"DATA",811.8,77,100,794,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,795,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,796,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,797,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,798,0)
<POINT_01>VA-MH SUICIDE COMPLETED</POINT_01>
"DATA",811.8,77,100,799,0)
<INTERNAL_ENTRY_NUMBER>834</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,800,0)
<CHECKSUM>3179049000</CHECKSUM>
"DATA",811.8,77,100,801,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,802,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,803,0)
<![CDATA[
"DATA",811.8,77,100,804,0)
811.5;+834,;.01~VA-MH SUICIDE COMPLETED
"DATA",811.8,77,100,805,0)
811.5;+834,;100~NATIONAL
"DATA",811.8,77,100,806,0)
811.5;+834,;101~Office of Mental Health Services
"DATA",811.8,77,100,807,0)
811.52;+835,+834,;.01~HF.MH SUICIDE COMPLETED
"DATA",811.8,77,100,808,0)
811.53;+836,+834,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,809,0)
811.53;+836,+834,;2~WP-start~1
"DATA",811.8,77,100,810,0)
Exchange Stub
"DATA",811.8,77,100,811,0)
]]>
"DATA",811.8,77,100,812,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,813,0)
<IEN_ROOT>
"DATA",811.8,77,100,814,0)
<![CDATA[
"DATA",811.8,77,100,815,0)
835^1
"DATA",811.8,77,100,816,0)
836^1
"DATA",811.8,77,100,817,0)
]]>
"DATA",811.8,77,100,818,0)
</IEN_ROOT>
"DATA",811.8,77,100,819,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,820,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,821,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,822,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,823,0)
<POINT_01>VA-MH SUICIDE ATTEMPTED</POINT_01>
"DATA",811.8,77,100,824,0)
<INTERNAL_ENTRY_NUMBER>833</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,825,0)
<CHECKSUM>57051385</CHECKSUM>
"DATA",811.8,77,100,826,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,827,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,828,0)
<![CDATA[
"DATA",811.8,77,100,829,0)
811.5;+833,;.01~VA-MH SUICIDE ATTEMPTED
"DATA",811.8,77,100,830,0)
811.5;+833,;100~NATIONAL
"DATA",811.8,77,100,831,0)
811.5;+833,;101~Office of Mental Health Services
"DATA",811.8,77,100,832,0)
811.52;+834,+833,;.01~HF.MH SUICIDE ATTEMPTED
"DATA",811.8,77,100,833,0)
811.53;+835,+833,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,834,0)
811.53;+835,+833,;2~WP-start~1
"DATA",811.8,77,100,835,0)
Exchange Stub
"DATA",811.8,77,100,836,0)
]]>
"DATA",811.8,77,100,837,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,838,0)
<IEN_ROOT>
"DATA",811.8,77,100,839,0)
<![CDATA[
"DATA",811.8,77,100,840,0)
834^1
"DATA",811.8,77,100,841,0)
835^1
"DATA",811.8,77,100,842,0)
]]>
"DATA",811.8,77,100,843,0)
</IEN_ROOT>
"DATA",811.8,77,100,844,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,845,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,846,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,847,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,848,0)
<POINT_01>VA-MH NOSHOW OTHER OUTCOME</POINT_01>
"DATA",811.8,77,100,849,0)
<INTERNAL_ENTRY_NUMBER>831</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,850,0)
<CHECKSUM>2296976961</CHECKSUM>
"DATA",811.8,77,100,851,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,852,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,853,0)
<![CDATA[
"DATA",811.8,77,100,854,0)
811.5;+831,;.01~VA-MH NOSHOW OTHER OUTCOME
"DATA",811.8,77,100,855,0)
811.5;+831,;100~NATIONAL
"DATA",811.8,77,100,856,0)
811.5;+831,;101~Office of Mental Health Services
"DATA",811.8,77,100,857,0)
811.52;+832,+831,;.01~HF.MH NOSHOW OTHER OUTCOME
"DATA",811.8,77,100,858,0)
811.53;+833,+831,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,859,0)
811.53;+833,+831,;2~WP-start~1
"DATA",811.8,77,100,860,0)
Exchange Stub
"DATA",811.8,77,100,861,0)
]]>
"DATA",811.8,77,100,862,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,863,0)
<IEN_ROOT>
"DATA",811.8,77,100,864,0)
<![CDATA[
"DATA",811.8,77,100,865,0)
832^1
"DATA",811.8,77,100,866,0)
833^1
"DATA",811.8,77,100,867,0)
]]>
"DATA",811.8,77,100,868,0)
</IEN_ROOT>
"DATA",811.8,77,100,869,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,870,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,871,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,872,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,873,0)
<POINT_01>VA-MH NOSHOW OUTREACH LETTER</POINT_01>
"DATA",811.8,77,100,874,0)
<INTERNAL_ENTRY_NUMBER>832</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,875,0)
<CHECKSUM>1877947617</CHECKSUM>
"DATA",811.8,77,100,876,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,877,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,878,0)
<![CDATA[
"DATA",811.8,77,100,879,0)
811.5;+832,;.01~VA-MH NOSHOW OUTREACH LETTER
"DATA",811.8,77,100,880,0)
811.5;+832,;100~NATIONAL
"DATA",811.8,77,100,881,0)
811.5;+832,;101~Office of Mental Health Services
"DATA",811.8,77,100,882,0)
811.52;+833,+832,;.01~HF.MH NOSHOW OUTREACH LETTER
"DATA",811.8,77,100,883,0)
811.53;+834,+832,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,884,0)
811.53;+834,+832,;2~WP-start~1
"DATA",811.8,77,100,885,0)
Exchange Stub
"DATA",811.8,77,100,886,0)
]]>
"DATA",811.8,77,100,887,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,888,0)
<IEN_ROOT>
"DATA",811.8,77,100,889,0)
<![CDATA[
"DATA",811.8,77,100,890,0)
833^1
"DATA",811.8,77,100,891,0)
834^1
"DATA",811.8,77,100,892,0)
]]>
"DATA",811.8,77,100,893,0)
</IEN_ROOT>
"DATA",811.8,77,100,894,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,895,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,896,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,897,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,898,0)
<POINT_01>VA-MH NOSHOW PLAN DEVELOPED</POINT_01>
"DATA",811.8,77,100,899,0)
<INTERNAL_ENTRY_NUMBER>827</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,900,0)
<CHECKSUM>999044966</CHECKSUM>
"DATA",811.8,77,100,901,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,902,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,903,0)
<![CDATA[
"DATA",811.8,77,100,904,0)
811.5;+827,;.01~VA-MH NOSHOW PLAN DEVELOPED
"DATA",811.8,77,100,905,0)
811.5;+827,;100~NATIONAL
"DATA",811.8,77,100,906,0)
811.5;+827,;101~Office of Mental Health Services
"DATA",811.8,77,100,907,0)
811.52;+828,+827,;.01~HF.MH NOSHOW PLAN DEVELOPED
"DATA",811.8,77,100,908,0)
811.53;+829,+827,;.01~12/06/2012@15:23:19
"DATA",811.8,77,100,909,0)
811.53;+829,+827,;2~WP-start~1
"DATA",811.8,77,100,910,0)
Exchange Stub
"DATA",811.8,77,100,911,0)
]]>
"DATA",811.8,77,100,912,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,913,0)
<IEN_ROOT>
"DATA",811.8,77,100,914,0)
<![CDATA[
"DATA",811.8,77,100,915,0)
828^1
"DATA",811.8,77,100,916,0)
829^1
"DATA",811.8,77,100,917,0)
]]>
"DATA",811.8,77,100,918,0)
</IEN_ROOT>
"DATA",811.8,77,100,919,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,920,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,921,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,922,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,923,0)
<POINT_01>VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL</POINT_01>
"DATA",811.8,77,100,924,0)
<INTERNAL_ENTRY_NUMBER>821</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,925,0)
<CHECKSUM>4087097966</CHECKSUM>
"DATA",811.8,77,100,926,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,927,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,928,0)
<![CDATA[
"DATA",811.8,77,100,929,0)
811.5;+821,;.01~VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,77,100,930,0)
811.5;+821,;100~NATIONAL
"DATA",811.8,77,100,931,0)
811.5;+821,;101~Office of Mental Health Services
"DATA",811.8,77,100,932,0)
811.52;+822,+821,;.01~HF.MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,77,100,933,0)
811.53;+823,+821,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,934,0)
811.53;+823,+821,;2~WP-start~1
"DATA",811.8,77,100,935,0)
Exchange Stub
"DATA",811.8,77,100,936,0)
]]>
"DATA",811.8,77,100,937,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,938,0)
<IEN_ROOT>
"DATA",811.8,77,100,939,0)
<![CDATA[
"DATA",811.8,77,100,940,0)
822^1
"DATA",811.8,77,100,941,0)
823^1
"DATA",811.8,77,100,942,0)
]]>
"DATA",811.8,77,100,943,0)
</IEN_ROOT>
"DATA",811.8,77,100,944,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,945,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,946,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,947,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,948,0)
<POINT_01>VA-MH NOSHOW PT EMERGENT CARE</POINT_01>
"DATA",811.8,77,100,949,0)
<INTERNAL_ENTRY_NUMBER>818</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,950,0)
<CHECKSUM>2154384829</CHECKSUM>
"DATA",811.8,77,100,951,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,952,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,953,0)
<![CDATA[
"DATA",811.8,77,100,954,0)
811.5;+818,;.01~VA-MH NOSHOW PT EMERGENT CARE
"DATA",811.8,77,100,955,0)
811.5;+818,;100~NATIONAL
"DATA",811.8,77,100,956,0)
811.5;+818,;101~Office of Mental Health Services
"DATA",811.8,77,100,957,0)
811.52;+819,+818,;.01~HF.MH NOSHOW PT EMERGENT CARE
"DATA",811.8,77,100,958,0)
811.53;+820,+818,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,959,0)
811.53;+820,+818,;2~WP-start~1
"DATA",811.8,77,100,960,0)
Exchange Stub
"DATA",811.8,77,100,961,0)
]]>
"DATA",811.8,77,100,962,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,963,0)
<IEN_ROOT>
"DATA",811.8,77,100,964,0)
<![CDATA[
"DATA",811.8,77,100,965,0)
819^1
"DATA",811.8,77,100,966,0)
820^1
"DATA",811.8,77,100,967,0)
]]>
"DATA",811.8,77,100,968,0)
</IEN_ROOT>
"DATA",811.8,77,100,969,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,970,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,971,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,972,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,973,0)
<POINT_01>VA-MH NOSHOW PT CONTACTED</POINT_01>
"DATA",811.8,77,100,974,0)
<INTERNAL_ENTRY_NUMBER>812</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,975,0)
<CHECKSUM>2284408963</CHECKSUM>
"DATA",811.8,77,100,976,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,977,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,978,0)
<![CDATA[
"DATA",811.8,77,100,979,0)
811.5;+812,;.01~VA-MH NOSHOW PT CONTACTED
"DATA",811.8,77,100,980,0)
811.5;+812,;1~WP-start~1
"DATA",811.8,77,100,981,0)
This documents that the Patient was successfully contacted.
"DATA",811.8,77,100,982,0)
811.5;+812,;100~NATIONAL
"DATA",811.8,77,100,983,0)
811.5;+812,;101~Office of Mental Health Services
"DATA",811.8,77,100,984,0)
811.52;+813,+812,;.01~HF.MH NOSHOW PT CONTACTED
"DATA",811.8,77,100,985,0)
811.53;+814,+812,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,986,0)
811.53;+814,+812,;2~WP-start~1
"DATA",811.8,77,100,987,0)
Exchange Stub
"DATA",811.8,77,100,988,0)
]]>
"DATA",811.8,77,100,989,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,990,0)
<IEN_ROOT>
"DATA",811.8,77,100,991,0)
<![CDATA[
"DATA",811.8,77,100,992,0)
813^1
"DATA",811.8,77,100,993,0)
814^1
"DATA",811.8,77,100,994,0)
]]>
"DATA",811.8,77,100,995,0)
</IEN_ROOT>
"DATA",811.8,77,100,996,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,997,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,998,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,999,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,1000,0)
<POINT_01>VA-MH HIGH RISK FOR SUICIDE PRF</POINT_01>
"DATA",811.8,77,100,1001,0)
<INTERNAL_ENTRY_NUMBER>811</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1002,0)
<CHECKSUM>2093237997</CHECKSUM>
"DATA",811.8,77,100,1003,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1004,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1005,0)
<![CDATA[
"DATA",811.8,77,100,1006,0)
811.5;+811,;.01~VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,77,100,1007,0)
811.5;+811,;1~WP-start~16
"DATA",811.8,77,100,1008,0)
This reminder looks for the national category I HIGH RISK FOR SUICIDE
"DATA",811.8,77,100,1009,0)
patient record flag and the local category II patient record flag used at
"DATA",811.8,77,100,1010,0)
your site.  
"DATA",811.8,77,100,1011,0)
 
"DATA",811.8,77,100,1012,0)
This term is distributed to look for the local name HIGH RISK FOR SUICIDE 
"DATA",811.8,77,100,1013,0)
which is the first mapped finding in the Mapped Findings.  The Computed 
"DATA",811.8,77,100,1014,0)
Finding Parameter of HIGH RISK FOR SUICIDE^L means use the local patient 
"DATA",811.8,77,100,1015,0)
record flag called HIGH RISK FOR SUICIDE.  If your site uses a different 
"DATA",811.8,77,100,1016,0)
category II patient record flag name, then the computed finding parameter 
"DATA",811.8,77,100,1017,0)
for the first mapped finding should be changed.  For example, if you're 
"DATA",811.8,77,100,1018,0)
site uses SUICIDE RISK as the name of the category II patient record 
"DATA",811.8,77,100,1019,0)
flag, then the Computed Finding Parameter should be changed to SUICIDE
"DATA",811.8,77,100,1020,0)
RISK^L.
"DATA",811.8,77,100,1021,0)
 
"DATA",811.8,77,100,1022,0)
Do not change the second mapped finding with the Computed Finding
"DATA",811.8,77,100,1023,0)
Parameter of HIGH RISK FOR SUICIDE^N.
"DATA",811.8,77,100,1024,0)
811.5;+811,;100~NATIONAL
"DATA",811.8,77,100,1025,0)
811.5;+811,;101~Office of Mental Health Services
"DATA",811.8,77,100,1026,0)
811.52;+812,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,77,100,1027,0)
811.52;+812,+811,;26~HIGH RISK FOR SUICIDE^L
"DATA",811.8,77,100,1028,0)
811.52;+813,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,77,100,1029,0)
811.52;+813,+811,;26~HIGH RISK FOR SUICIDE^N
"DATA",811.8,77,100,1030,0)
811.53;+814,+811,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,1031,0)
811.53;+814,+811,;2~WP-start~1
"DATA",811.8,77,100,1032,0)
Exchange Stub
"DATA",811.8,77,100,1033,0)
]]>
"DATA",811.8,77,100,1034,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1035,0)
<IEN_ROOT>
"DATA",811.8,77,100,1036,0)
<![CDATA[
"DATA",811.8,77,100,1037,0)
812^1
"DATA",811.8,77,100,1038,0)
813^2
"DATA",811.8,77,100,1039,0)
814^1
"DATA",811.8,77,100,1040,0)
]]>
"DATA",811.8,77,100,1041,0)
</IEN_ROOT>
"DATA",811.8,77,100,1042,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1043,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1044,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,77,100,1045,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,77,100,1046,0)
<POINT_01>VA-MH NOSHOW MISSED MH CLINIC APPTS</POINT_01>
"DATA",811.8,77,100,1047,0)
<INTERNAL_ENTRY_NUMBER>809</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1048,0)
<CHECKSUM>1280315222</CHECKSUM>
"DATA",811.8,77,100,1049,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1050,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1051,0)
<![CDATA[
"DATA",811.8,77,100,1052,0)
811.5;+809,;.01~VA-MH NOSHOW MISSED MH CLINIC APPTS
"DATA",811.8,77,100,1053,0)
811.5;+809,;1~WP-start~4
"DATA",811.8,77,100,1054,0)
The list of DSS IDs (stop codes) used in the Reminder Location List 
"DATA",811.8,77,100,1055,0)
finding for this term were provided by the Office of Mental Health
"DATA",811.8,77,100,1056,0)
Services and includes stop codes related to Mental Health that involve
"DATA",811.8,77,100,1057,0)
face-to-face contact with the patient.
"DATA",811.8,77,100,1058,0)
811.5;+809,;100~NATIONAL
"DATA",811.8,77,100,1059,0)
811.5;+809,;101~Office of Mental Health Services
"DATA",811.8,77,100,1060,0)
811.52;+810,+809,;.01~CF.VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,77,100,1061,0)
811.52;+810,+809,;26~FLDS:1,2,3^STATUS:NS,NSR^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,77,100,1062,0)
811.53;+811,+809,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,1063,0)
811.53;+811,+809,;2~WP-start~1
"DATA",811.8,77,100,1064,0)
Exchange Stub
"DATA",811.8,77,100,1065,0)
]]>
"DATA",811.8,77,100,1066,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1067,0)
<IEN_ROOT>
"DATA",811.8,77,100,1068,0)
<![CDATA[
"DATA",811.8,77,100,1069,0)
810^1
"DATA",811.8,77,100,1070,0)
811^1
"DATA",811.8,77,100,1071,0)
]]>
"DATA",811.8,77,100,1072,0)
</IEN_ROOT>
"DATA",811.8,77,100,1073,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1074,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1075,0)
<FILE_NAME>REMINDER DEFINITION</FILE_NAME>
"DATA",811.8,77,100,1076,0)
<FILE_NUMBER>811.9</FILE_NUMBER>
"DATA",811.8,77,100,1077,0)
<POINT_01>VA-MH HIGH RISK NO-SHOW FOLLOW-UP</POINT_01>
"DATA",811.8,77,100,1078,0)
<INTERNAL_ENTRY_NUMBER>406</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1079,0)
<CHECKSUM>3675333624</CHECKSUM>
"DATA",811.8,77,100,1080,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,77,100,1081,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1082,0)
<![CDATA[
"DATA",811.8,77,100,1083,0)
811.9;+406,;.01~VA-MH HIGH RISK NO-SHOW FOLLOW-UP
"DATA",811.8,77,100,1084,0)
811.9;+406,;1.2~High Risk MH No-Show Follow-up
"DATA",811.8,77,100,1085,0)
811.9;+406,;1.3~99Y
"DATA",811.8,77,100,1086,0)
811.9;+406,;2~WP-start~14
"DATA",811.8,77,100,1087,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,77,100,1088,0)
have followed up on a No-Show MH appointment for a patient with an active
"DATA",811.8,77,100,1089,0)
High Risk for Suicide Patient Record Flag. 
"DATA",811.8,77,100,1090,0)
 
"DATA",811.8,77,100,1091,0)
The reminder requires clinicians to initiate follow-up with the patient to
"DATA",811.8,77,100,1092,0)
insure his/her safety and to try to get the patient back into care. The
"DATA",811.8,77,100,1093,0)
follow-up results are documented with health factors.  
"DATA",811.8,77,100,1094,0)
 
"DATA",811.8,77,100,1095,0)
Studies show that individuals that get lost to follow-up have a higher 
"DATA",811.8,77,100,1096,0)
rate of actual suicide than those that stay connected with care.
"DATA",811.8,77,100,1097,0)
 
"DATA",811.8,77,100,1098,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,77,100,1099,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,77,100,1100,0)
longer be necessary.
"DATA",811.8,77,100,1101,0)
811.9;+406,;31~(SEX)&(AGE)&FI(1)&FI(2)
"DATA",811.8,77,100,1102,0)
811.9;+406,;32~4
"DATA",811.8,77,100,1103,0)
811.9;+406,;33~SEX;AGE;1;2
"DATA",811.8,77,100,1104,0)
811.9;+406,;35~(0)!FI(3)!FI(4)!FI(8)!FI(11)!FI(12)!FI(13)!FI(14)
"DATA",811.8,77,100,1105,0)
811.9;+406,;36~7
"DATA",811.8,77,100,1106,0)
811.9;+406,;37~3;4;8;11;12;13;14
"DATA",811.8,77,100,1107,0)
811.9;+406,;40~0
"DATA",811.8,77,100,1108,0)
811.9;+406,;42~2
"DATA",811.8,77,100,1109,0)
811.9;+406,;43~6;10
"DATA",811.8,77,100,1110,0)
811.9;+406,;51~VA-MH HIGH RISK NO SHOW FOLLOW-UP
"DATA",811.8,77,100,1111,0)
811.9;+406,;60~WP-start~2
"DATA",811.8,77,100,1112,0)
The patient has an active High Risk for Suicide Patient Record Flag and 
"DATA",811.8,77,100,1113,0)
missed a MH appointment.
"DATA",811.8,77,100,1114,0)
811.9;+406,;61~WP-start~1
"DATA",811.8,77,100,1115,0)
This patient has no missed MH appointment pending follow-up.
"DATA",811.8,77,100,1116,0)
811.9;+406,;62~2
"DATA",811.8,77,100,1117,0)
811.9;+406,;63~1
"DATA",811.8,77,100,1118,0)
811.9;+406,;67~0
"DATA",811.8,77,100,1119,0)
811.9;+406,;68~0
"DATA",811.8,77,100,1120,0)
811.9;+406,;72~0
"DATA",811.8,77,100,1121,0)
811.9;+406,;73~0
"DATA",811.8,77,100,1122,0)
811.9;+406,;77~0
"DATA",811.8,77,100,1123,0)
811.9;+406,;78~0
"DATA",811.8,77,100,1124,0)
811.9;+406,;100~NATIONAL
"DATA",811.8,77,100,1125,0)
811.9;+406,;101~Office of Mental Health Services
"DATA",811.8,77,100,1126,0)
811.9;+406,;103~*
"DATA",811.8,77,100,1127,0)
811.9001;+407,+406,;.01~12/06/2012@15:23:20
"DATA",811.8,77,100,1128,0)
811.9001;+407,+406,;2~WP-start~1
"DATA",811.8,77,100,1129,0)
Exchange Stub
"DATA",811.8,77,100,1130,0)
811.902;+408,+406,;.01~RT.VA-MH NOSHOW MISSED MH CLINIC APPTS
"DATA",811.8,77,100,1131,0)
811.902;+408,+406,;8~AND
"DATA",811.8,77,100,1132,0)
811.902;+408,+406,;9~T-10D
"DATA",811.8,77,100,1133,0)
811.902;+408,+406,;12~T
"DATA",811.8,77,100,1134,0)
811.902;+408,+406,;17~5
"DATA",811.8,77,100,1135,0)
811.902;+408,+406,;24~0
"DATA",811.8,77,100,1136,0)
811.902;+408,+406,;25~0
"DATA",811.8,77,100,1137,0)
811.902;+408,+406,;26~FLDS:1,2,3^STATUS:NS,NSR^LL:VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,77,100,1138,0)
811.902;+409,+406,;.01~RT.VA-MH NOSHOW OUTREACH LETTER
"DATA",811.8,77,100,1139,0)
811.902;+409,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1140,0)
811.902;+409,+406,;17~-1
"DATA",811.8,77,100,1141,0)
811.902;+409,+406,;24~0
"DATA",811.8,77,100,1142,0)
811.902;+409,+406,;25~0
"DATA",811.8,77,100,1143,0)
811.902;+410,+406,;.01~RT.VA-MH NOSHOW OTHER OUTCOME
"DATA",811.8,77,100,1144,0)
811.902;+410,+406,;7~OR
"DATA",811.8,77,100,1145,0)
811.902;+410,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1146,0)
811.902;+410,+406,;17~-1
"DATA",811.8,77,100,1147,0)
811.902;+410,+406,;24~0
"DATA",811.8,77,100,1148,0)
811.902;+410,+406,;25~0
"DATA",811.8,77,100,1149,0)
811.902;+411,+406,;.01~RT.VA-MH SUICIDE ATTEMPTED
"DATA",811.8,77,100,1150,0)
811.902;+411,+406,;7~OR
"DATA",811.8,77,100,1151,0)
811.902;+411,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1152,0)
811.902;+411,+406,;17~-1
"DATA",811.8,77,100,1153,0)
811.902;+411,+406,;24~0
"DATA",811.8,77,100,1154,0)
811.902;+411,+406,;25~0
"DATA",811.8,77,100,1155,0)
811.902;+412,+406,;.01~RT.VA-MH SUICIDE COMPLETED
"DATA",811.8,77,100,1156,0)
811.902;+412,+406,;7~OR
"DATA",811.8,77,100,1157,0)
811.902;+412,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1158,0)
811.902;+412,+406,;17~-1
"DATA",811.8,77,100,1159,0)
811.902;+412,+406,;24~0
"DATA",811.8,77,100,1160,0)
811.902;+412,+406,;25~0
"DATA",811.8,77,100,1161,0)
811.902;+413,+406,;.01~RT.VA-MH APPT KEPT
"DATA",811.8,77,100,1162,0)
811.902;+413,+406,;4~WP-start~2
"DATA",811.8,77,100,1163,0)
Patient kept a MH appointment within 72 hours of the missed MH
"DATA",811.8,77,100,1164,0)
appointment, resolving the reminder.
"DATA",811.8,77,100,1165,0)
811.902;+413,+406,;7~OR
"DATA",811.8,77,100,1166,0)
811.902;+413,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1167,0)
811.902;+413,+406,;12~FIEVAL(1,1,"DATE")+72H
"DATA",811.8,77,100,1168,0)
811.902;+413,+406,;17~-4
"DATA",811.8,77,100,1169,0)
811.902;+413,+406,;24~2
"DATA",811.8,77,100,1170,0)
811.902;+413,+406,;25~0
"DATA",811.8,77,100,1171,0)
811.902;+414,+406,;.01~RT.VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,77,100,1172,0)
811.902;+414,+406,;8~AND
"DATA",811.8,77,100,1173,0)
811.902;+414,+406,;9~FIEVAL(1,1,"DATE")
"DATA",811.8,77,100,1174,0)
811.902;+414,+406,;12~FIEVAL(1,1,"DATE")+1D
"DATA",811.8,77,100,1175,0)
811.902;+414,+406,;17~2
"DATA",811.8,77,100,1176,0)
811.902;+414,+406,;24~0
"DATA",811.8,77,100,1177,0)
811.902;+414,+406,;25~0
"DATA",811.8,77,100,1178,0)
811.902;+415,+406,;.01~RT.VA-MH NOSHOW PT CONTACTED
"DATA",811.8,77,100,1179,0)
811.902;+415,+406,;7~OR
"DATA",811.8,77,100,1180,0)
811.902;+415,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1181,0)
811.902;+415,+406,;17~-3
"DATA",811.8,77,100,1182,0)
811.902;+415,+406,;24~0
"DATA",811.8,77,100,1183,0)
811.902;+415,+406,;25~0
"DATA",811.8,77,100,1184,0)
811.902;+416,+406,;.01~RT.VA-MH NOSHOW PT EMERGENT CARE
"DATA",811.8,77,100,1185,0)
811.902;+416,+406,;7~OR
"DATA",811.8,77,100,1186,0)
811.902;+416,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1187,0)
811.902;+416,+406,;17~-1
"DATA",811.8,77,100,1188,0)
811.902;+416,+406,;24~0
"DATA",811.8,77,100,1189,0)
811.902;+416,+406,;25~0
"DATA",811.8,77,100,1190,0)
811.902;+417,+406,;.01~RT.VA-MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,77,100,1191,0)
811.902;+417,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1192,0)
811.902;+417,+406,;17~-1
"DATA",811.8,77,100,1193,0)
811.902;+417,+406,;24~0
"DATA",811.8,77,100,1194,0)
811.902;+417,+406,;25~0
"DATA",811.8,77,100,1195,0)
811.902;+418,+406,;.01~RT.VA-MH NOSHOW PLAN DEVELOPED
"DATA",811.8,77,100,1196,0)
811.902;+418,+406,;7~OR
"DATA",811.8,77,100,1197,0)
811.902;+418,+406,;9~FIEVAL(1,1,"DATE")-8H
"DATA",811.8,77,100,1198,0)
811.902;+418,+406,;17~-1
"DATA",811.8,77,100,1199,0)
811.902;+418,+406,;24~0
"DATA",811.8,77,100,1200,0)
811.902;+418,+406,;25~0
"DATA",811.8,77,100,1201,0)
811.97;+419,+406,;.01~99Y
"DATA",811.8,77,100,1202,0)
811.97;+419,+406,;3~WP-start~2
"DATA",811.8,77,100,1203,0)
Reminder triggered by missed MH appointment and when resolved won't be 
"DATA",811.8,77,100,1204,0)
due again until another missed MH appointment occurs.\\
"DATA",811.8,77,100,1205,0)
811.97;+419,+406,;5~2
"DATA",811.8,77,100,1206,0)
811.97;+419,+406,;6~0
"DATA",811.8,77,100,1207,0)
]]>
"DATA",811.8,77,100,1208,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1209,0)
<IEN_ROOT>
"DATA",811.8,77,100,1210,0)
<![CDATA[
"DATA",811.8,77,100,1211,0)
407^1
"DATA",811.8,77,100,1212,0)
408^1
"DATA",811.8,77,100,1213,0)
409^10
"DATA",811.8,77,100,1214,0)
410^11
"DATA",811.8,77,100,1215,0)
411^12
"DATA",811.8,77,100,1216,0)
412^13
"DATA",811.8,77,100,1217,0)
413^14
"DATA",811.8,77,100,1218,0)
414^2
"DATA",811.8,77,100,1219,0)
415^3
"DATA",811.8,77,100,1220,0)
416^4
"DATA",811.8,77,100,1221,0)
417^6
"DATA",811.8,77,100,1222,0)
418^8
"DATA",811.8,77,100,1223,0)
419^1
"DATA",811.8,77,100,1224,0)
]]>
"DATA",811.8,77,100,1225,0)
</IEN_ROOT>
"DATA",811.8,77,100,1226,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1227,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1228,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1229,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1230,0)
<POINT_01>VA-TEXT BLANK LINE</POINT_01>
"DATA",811.8,77,100,1231,0)
<INTERNAL_ENTRY_NUMBER>598000149</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1232,0)
<CHECKSUM>3556189925</CHECKSUM>
"DATA",811.8,77,100,1233,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1234,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1235,0)
<![CDATA[
"DATA",811.8,77,100,1236,0)
801.41;+598000149,;.01~VA-TEXT BLANK LINE
"DATA",811.8,77,100,1237,0)
801.41;+598000149,;4~dialog element
"DATA",811.8,77,100,1238,0)
801.41;+598000149,;23~YES
"DATA",811.8,77,100,1239,0)
801.41;+598000149,;25~WP-start~1
"DATA",811.8,77,100,1240,0)
________________________________________________
"DATA",811.8,77,100,1241,0)
801.41;+598000149,;51~SUPPRESS
"DATA",811.8,77,100,1242,0)
801.41;+598000149,;100~NATIONAL
"DATA",811.8,77,100,1243,0)
801.41;+598000149,;101~Office of Quality & Performance
"DATA",811.8,77,100,1244,0)
801.44;+598000150,+598000149,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1245,0)
801.44;+598000150,+598000149,;2~WP-start~1
"DATA",811.8,77,100,1246,0)
Exchange Stub
"DATA",811.8,77,100,1247,0)
]]>
"DATA",811.8,77,100,1248,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1249,0)
<IEN_ROOT>
"DATA",811.8,77,100,1250,0)
<![CDATA[
"DATA",811.8,77,100,1251,0)
598000150^1
"DATA",811.8,77,100,1252,0)
]]>
"DATA",811.8,77,100,1253,0)
</IEN_ROOT>
"DATA",811.8,77,100,1254,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1255,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1256,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1257,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1258,0)
<POINT_01>VA-MH SBR</POINT_01>
"DATA",811.8,77,100,1259,0)
<INTERNAL_ENTRY_NUMBER>2585</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1260,0)
<CHECKSUM>3562288886</CHECKSUM>
"DATA",811.8,77,100,1261,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1262,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1263,0)
<![CDATA[
"DATA",811.8,77,100,1264,0)
801.41;+2585,;.01~VA-MH SBR
"DATA",811.8,77,100,1265,0)
801.41;+2585,;4~dialog element
"DATA",811.8,77,100,1266,0)
801.41;+2585,;15~MH.SBR
"DATA",811.8,77,100,1267,0)
801.41;+2585,;23~NO
"DATA",811.8,77,100,1268,0)
801.41;+2585,;25~WP-start~1
"DATA",811.8,77,100,1269,0)
SBR is optional open and optional complete, or cancel before finish.
"DATA",811.8,77,100,1270,0)
801.41;+2585,;51~SUPPRESS
"DATA",811.8,77,100,1271,0)
801.41;+2585,;54~NO
"DATA",811.8,77,100,1272,0)
801.41;+2585,;100~NATIONAL
"DATA",811.8,77,100,1273,0)
801.41;+2585,;101~Office of Mental Health Services
"DATA",811.8,77,100,1274,0)
801.41;+2585,;113~Optional open and required complete or cancel before finish
"DATA",811.8,77,100,1275,0)
801.44;+2586,+2585,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1276,0)
801.44;+2586,+2585,;2~WP-start~1
"DATA",811.8,77,100,1277,0)
Exchange Stub
"DATA",811.8,77,100,1278,0)
]]>
"DATA",811.8,77,100,1279,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1280,0)
<IEN_ROOT>
"DATA",811.8,77,100,1281,0)
<![CDATA[
"DATA",811.8,77,100,1282,0)
2586^1
"DATA",811.8,77,100,1283,0)
]]>
"DATA",811.8,77,100,1284,0)
</IEN_ROOT>
"DATA",811.8,77,100,1285,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1286,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1287,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1288,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1289,0)
<POINT_01>VA-GP MH SBR</POINT_01>
"DATA",811.8,77,100,1290,0)
<INTERNAL_ENTRY_NUMBER>3862</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1291,0)
<CHECKSUM>1643234892</CHECKSUM>
"DATA",811.8,77,100,1292,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1293,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1294,0)
<![CDATA[
"DATA",811.8,77,100,1295,0)
801.41;+3862,;.01~VA-GP MH SBR
"DATA",811.8,77,100,1296,0)
801.41;+3862,;4~dialog group
"DATA",811.8,77,100,1297,0)
801.41;+3862,;6~YES
"DATA",811.8,77,100,1298,0)
801.41;+3862,;7~2
"DATA",811.8,77,100,1299,0)
801.41;+3862,;8~NO
"DATA",811.8,77,100,1300,0)
801.41;+3862,;9~NONE OR ONE SELECTION
"DATA",811.8,77,100,1301,0)
801.41;+3862,;23~YES
"DATA",811.8,77,100,1302,0)
801.41;+3862,;25~WP-start~1
"DATA",811.8,77,100,1303,0)
Suicide Behavior Report (SBR)
"DATA",811.8,77,100,1304,0)
801.41;+3862,;35~WP-start~1
"DATA",811.8,77,100,1305,0)
Suicide Behavior Report (SBR)
"DATA",811.8,77,100,1306,0)
801.41;+3862,;50~SHOW
"DATA",811.8,77,100,1307,0)
801.41;+3862,;51~SUPPRESS
"DATA",811.8,77,100,1308,0)
801.41;+3862,;52~INDENT
"DATA",811.8,77,100,1309,0)
801.41;+3862,;100~NATIONAL
"DATA",811.8,77,100,1310,0)
801.41;+3862,;101~Office of Mental Health Services
"DATA",811.8,77,100,1311,0)
801.412;+3863,+3862,;.01~5
"DATA",811.8,77,100,1312,0)
801.412;+3863,+3862,;2~VA-MH SBR
"DATA",811.8,77,100,1313,0)
801.44;+3864,+3862,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1314,0)
801.44;+3864,+3862,;2~WP-start~1
"DATA",811.8,77,100,1315,0)
Exchange Stub
"DATA",811.8,77,100,1316,0)
]]>
"DATA",811.8,77,100,1317,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1318,0)
<IEN_ROOT>
"DATA",811.8,77,100,1319,0)
<![CDATA[
"DATA",811.8,77,100,1320,0)
3863^1
"DATA",811.8,77,100,1321,0)
3864^1
"DATA",811.8,77,100,1322,0)
]]>
"DATA",811.8,77,100,1323,0)
</IEN_ROOT>
"DATA",811.8,77,100,1324,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1325,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1326,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1327,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1328,0)
<POINT_01>PXRM COMMENT</POINT_01>
"DATA",811.8,77,100,1329,0)
<INTERNAL_ENTRY_NUMBER>2640</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1330,0)
<CHECKSUM>3865933290</CHECKSUM>
"DATA",811.8,77,100,1331,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1332,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1333,0)
<![CDATA[
"DATA",811.8,77,100,1334,0)
801.41;+2640,;.01~PXRM COMMENT
"DATA",811.8,77,100,1335,0)
801.41;+2640,;4~prompt
"DATA",811.8,77,100,1336,0)
801.41;+2640,;24~Comment:
"DATA",811.8,77,100,1337,0)
801.41;+2640,;46~COM
"DATA",811.8,77,100,1338,0)
801.41;+2640,;100~NATIONAL
"DATA",811.8,77,100,1339,0)
801.44;+2641,+2640,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1340,0)
801.44;+2641,+2640,;2~WP-start~1
"DATA",811.8,77,100,1341,0)
Exchange Stub
"DATA",811.8,77,100,1342,0)
]]>
"DATA",811.8,77,100,1343,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1344,0)
<IEN_ROOT>
"DATA",811.8,77,100,1345,0)
<![CDATA[
"DATA",811.8,77,100,1346,0)
2641^1
"DATA",811.8,77,100,1347,0)
]]>
"DATA",811.8,77,100,1348,0)
</IEN_ROOT>
"DATA",811.8,77,100,1349,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1350,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1351,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1352,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1353,0)
<POINT_01>VA-MH SUICIDE COMPLETED HF</POINT_01>
"DATA",811.8,77,100,1354,0)
<INTERNAL_ENTRY_NUMBER>2532</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1355,0)
<CHECKSUM>3891032655</CHECKSUM>
"DATA",811.8,77,100,1356,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1357,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1358,0)
<![CDATA[
"DATA",811.8,77,100,1359,0)
801.41;+2532,;.01~VA-MH SUICIDE COMPLETED HF
"DATA",811.8,77,100,1360,0)
801.41;+2532,;4~dialog element
"DATA",811.8,77,100,1361,0)
801.41;+2532,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1362,0)
801.41;+2532,;15~HF.MH SUICIDE COMPLETED
"DATA",811.8,77,100,1363,0)
801.41;+2532,;25~WP-start~1
"DATA",811.8,77,100,1364,0)
Patient completed suicide.
"DATA",811.8,77,100,1365,0)
801.41;+2532,;100~NATIONAL
"DATA",811.8,77,100,1366,0)
801.41;+2532,;101~Office of Mental Health Services
"DATA",811.8,77,100,1367,0)
801.412;+2533,+2532,;.01~5
"DATA",811.8,77,100,1368,0)
801.412;+2533,+2532,;2~PXRM COMMENT
"DATA",811.8,77,100,1369,0)
801.412;+2533,+2532,;7~YES
"DATA",811.8,77,100,1370,0)
801.44;+2534,+2532,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1371,0)
801.44;+2534,+2532,;2~WP-start~1
"DATA",811.8,77,100,1372,0)
Exchange Stub
"DATA",811.8,77,100,1373,0)
]]>
"DATA",811.8,77,100,1374,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1375,0)
<IEN_ROOT>
"DATA",811.8,77,100,1376,0)
<![CDATA[
"DATA",811.8,77,100,1377,0)
2533^1
"DATA",811.8,77,100,1378,0)
2534^1
"DATA",811.8,77,100,1379,0)
]]>
"DATA",811.8,77,100,1380,0)
</IEN_ROOT>
"DATA",811.8,77,100,1381,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1382,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1383,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1384,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1385,0)
<POINT_01>VA-MH SUICIDE COMPLETED GP</POINT_01>
"DATA",811.8,77,100,1386,0)
<INTERNAL_ENTRY_NUMBER>2542</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1387,0)
<CHECKSUM>1341173138</CHECKSUM>
"DATA",811.8,77,100,1388,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1389,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1390,0)
<![CDATA[
"DATA",811.8,77,100,1391,0)
801.41;+2542,;.01~VA-MH SUICIDE COMPLETED GP
"DATA",811.8,77,100,1392,0)
801.41;+2542,;4~dialog group
"DATA",811.8,77,100,1393,0)
801.41;+2542,;6~NO
"DATA",811.8,77,100,1394,0)
801.41;+2542,;7~1
"DATA",811.8,77,100,1395,0)
801.41;+2542,;23~NO
"DATA",811.8,77,100,1396,0)
801.41;+2542,;50~SHOW
"DATA",811.8,77,100,1397,0)
801.41;+2542,;51~SUPPRESS
"DATA",811.8,77,100,1398,0)
801.41;+2542,;52~INDENT
"DATA",811.8,77,100,1399,0)
801.41;+2542,;100~NATIONAL
"DATA",811.8,77,100,1400,0)
801.41;+2542,;101~Office of Mental Health Services
"DATA",811.8,77,100,1401,0)
801.412;+2543,+2542,;.01~5
"DATA",811.8,77,100,1402,0)
801.412;+2543,+2542,;2~VA-MH SUICIDE COMPLETED HF
"DATA",811.8,77,100,1403,0)
801.44;+2544,+2542,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1404,0)
801.44;+2544,+2542,;2~WP-start~1
"DATA",811.8,77,100,1405,0)
Exchange Stub
"DATA",811.8,77,100,1406,0)
]]>
"DATA",811.8,77,100,1407,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1408,0)
<IEN_ROOT>
"DATA",811.8,77,100,1409,0)
<![CDATA[
"DATA",811.8,77,100,1410,0)
2543^1
"DATA",811.8,77,100,1411,0)
2544^1
"DATA",811.8,77,100,1412,0)
]]>
"DATA",811.8,77,100,1413,0)
</IEN_ROOT>
"DATA",811.8,77,100,1414,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1415,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1416,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1417,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1418,0)
<POINT_01>VA-MH SUICIDE ATTEMPTED HF</POINT_01>
"DATA",811.8,77,100,1419,0)
<INTERNAL_ENTRY_NUMBER>2531</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1420,0)
<CHECKSUM>1522126848</CHECKSUM>
"DATA",811.8,77,100,1421,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1422,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1423,0)
<![CDATA[
"DATA",811.8,77,100,1424,0)
801.41;+2531,;.01~VA-MH SUICIDE ATTEMPTED HF
"DATA",811.8,77,100,1425,0)
801.41;+2531,;4~dialog element
"DATA",811.8,77,100,1426,0)
801.41;+2531,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1427,0)
801.41;+2531,;15~HF.MH SUICIDE ATTEMPTED
"DATA",811.8,77,100,1428,0)
801.41;+2531,;25~WP-start~1
"DATA",811.8,77,100,1429,0)
Patient attempted suicide.
"DATA",811.8,77,100,1430,0)
801.41;+2531,;100~NATIONAL
"DATA",811.8,77,100,1431,0)
801.41;+2531,;101~Office of Mental Health Services
"DATA",811.8,77,100,1432,0)
801.412;+2532,+2531,;.01~5
"DATA",811.8,77,100,1433,0)
801.412;+2532,+2531,;2~PXRM COMMENT
"DATA",811.8,77,100,1434,0)
801.412;+2532,+2531,;7~YES
"DATA",811.8,77,100,1435,0)
801.44;+2533,+2531,;.01~12/06/2012@15:23:21
"DATA",811.8,77,100,1436,0)
801.44;+2533,+2531,;2~WP-start~1
"DATA",811.8,77,100,1437,0)
Exchange Stub
"DATA",811.8,77,100,1438,0)
]]>
"DATA",811.8,77,100,1439,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1440,0)
<IEN_ROOT>
"DATA",811.8,77,100,1441,0)
<![CDATA[
"DATA",811.8,77,100,1442,0)
2532^1
"DATA",811.8,77,100,1443,0)
2533^1
"DATA",811.8,77,100,1444,0)
]]>
"DATA",811.8,77,100,1445,0)
</IEN_ROOT>
"DATA",811.8,77,100,1446,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1447,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1448,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1449,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1450,0)
<POINT_01>VA-MH NOSHOW SUICIDE ATTEMPT GP</POINT_01>
"DATA",811.8,77,100,1451,0)
<INTERNAL_ENTRY_NUMBER>2541</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1452,0)
<CHECKSUM>3590495410</CHECKSUM>
"DATA",811.8,77,100,1453,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1454,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1455,0)
<![CDATA[
"DATA",811.8,77,100,1456,0)
801.41;+2541,;.01~VA-MH NOSHOW SUICIDE ATTEMPT GP
"DATA",811.8,77,100,1457,0)
801.41;+2541,;4~dialog group
"DATA",811.8,77,100,1458,0)
801.41;+2541,;6~NO
"DATA",811.8,77,100,1459,0)
801.41;+2541,;7~1
"DATA",811.8,77,100,1460,0)
801.41;+2541,;23~YES
"DATA",811.8,77,100,1461,0)
801.41;+2541,;50~SHOW
"DATA",811.8,77,100,1462,0)
801.41;+2541,;51~SUPPRESS
"DATA",811.8,77,100,1463,0)
801.41;+2541,;52~INDENT
"DATA",811.8,77,100,1464,0)
801.41;+2541,;100~NATIONAL
"DATA",811.8,77,100,1465,0)
801.41;+2541,;101~Office of Mental Health Services
"DATA",811.8,77,100,1466,0)
801.412;+2542,+2541,;.01~5
"DATA",811.8,77,100,1467,0)
801.412;+2542,+2541,;2~VA-MH SUICIDE ATTEMPTED HF
"DATA",811.8,77,100,1468,0)
801.44;+2543,+2541,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1469,0)
801.44;+2543,+2541,;2~WP-start~1
"DATA",811.8,77,100,1470,0)
Exchange Stub
"DATA",811.8,77,100,1471,0)
]]>
"DATA",811.8,77,100,1472,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1473,0)
<IEN_ROOT>
"DATA",811.8,77,100,1474,0)
<![CDATA[
"DATA",811.8,77,100,1475,0)
2542^1
"DATA",811.8,77,100,1476,0)
2543^1
"DATA",811.8,77,100,1477,0)
]]>
"DATA",811.8,77,100,1478,0)
</IEN_ROOT>
"DATA",811.8,77,100,1479,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1480,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1481,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1482,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1483,0)
<POINT_01>VA-MH NOSHOW SUICIDE EVENT GP</POINT_01>
"DATA",811.8,77,100,1484,0)
<INTERNAL_ENTRY_NUMBER>2581</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1485,0)
<CHECKSUM>1739195318</CHECKSUM>
"DATA",811.8,77,100,1486,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1487,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1488,0)
<![CDATA[
"DATA",811.8,77,100,1489,0)
801.41;+2581,;.01~VA-MH NOSHOW SUICIDE EVENT GP
"DATA",811.8,77,100,1490,0)
801.41;+2581,;4~dialog group
"DATA",811.8,77,100,1491,0)
801.41;+2581,;6~NO
"DATA",811.8,77,100,1492,0)
801.41;+2581,;9~ONE OR MORE SELECTIONS
"DATA",811.8,77,100,1493,0)
801.41;+2581,;23~YES
"DATA",811.8,77,100,1494,0)
801.41;+2581,;25~WP-start~2
"DATA",811.8,77,100,1495,0)
Suicide attempted or completed. Please document Safety Plan and/or 
"DATA",811.8,77,100,1496,0)
Suicide Behavior Report where appropriate.
"DATA",811.8,77,100,1497,0)
801.41;+2581,;100~NATIONAL
"DATA",811.8,77,100,1498,0)
801.41;+2581,;101~Office of Mental Health Services
"DATA",811.8,77,100,1499,0)
801.412;+2582,+2581,;.01~5
"DATA",811.8,77,100,1500,0)
801.412;+2582,+2581,;2~VA-MH NOSHOW SUICIDE ATTEMPT GP
"DATA",811.8,77,100,1501,0)
801.412;+2583,+2581,;.01~10
"DATA",811.8,77,100,1502,0)
801.412;+2583,+2581,;2~VA-MH SUICIDE COMPLETED GP
"DATA",811.8,77,100,1503,0)
801.412;+2583,+2581,;8~NO
"DATA",811.8,77,100,1504,0)
801.44;+2584,+2581,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1505,0)
801.44;+2584,+2581,;2~WP-start~1
"DATA",811.8,77,100,1506,0)
Exchange Stub
"DATA",811.8,77,100,1507,0)
]]>
"DATA",811.8,77,100,1508,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1509,0)
<IEN_ROOT>
"DATA",811.8,77,100,1510,0)
<![CDATA[
"DATA",811.8,77,100,1511,0)
2582^1
"DATA",811.8,77,100,1512,0)
2583^2
"DATA",811.8,77,100,1513,0)
2584^1
"DATA",811.8,77,100,1514,0)
]]>
"DATA",811.8,77,100,1515,0)
</IEN_ROOT>
"DATA",811.8,77,100,1516,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1517,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1518,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1519,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1520,0)
<POINT_01>VA-MH NOSHOW OTHER OUTCOME WP</POINT_01>
"DATA",811.8,77,100,1521,0)
<INTERNAL_ENTRY_NUMBER>2530</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1522,0)
<CHECKSUM>1218896851</CHECKSUM>
"DATA",811.8,77,100,1523,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1524,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1525,0)
<![CDATA[
"DATA",811.8,77,100,1526,0)
801.41;+2530,;.01~VA-MH NOSHOW OTHER OUTCOME WP
"DATA",811.8,77,100,1527,0)
801.41;+2530,;4~dialog element
"DATA",811.8,77,100,1528,0)
801.41;+2530,;25~WP-start~2
"DATA",811.8,77,100,1529,0)
Comments:
"DATA",811.8,77,100,1530,0)
\\{FLD:WORD PROCESSING FIELD}
"DATA",811.8,77,100,1531,0)
801.41;+2530,;51~SUPPRESS
"DATA",811.8,77,100,1532,0)
801.41;+2530,;100~NATIONAL
"DATA",811.8,77,100,1533,0)
801.41;+2530,;101~Office of Mental Health Services
"DATA",811.8,77,100,1534,0)
801.44;+2531,+2530,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1535,0)
801.44;+2531,+2530,;2~WP-start~1
"DATA",811.8,77,100,1536,0)
Exchange Stub
"DATA",811.8,77,100,1537,0)
]]>
"DATA",811.8,77,100,1538,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1539,0)
<IEN_ROOT>
"DATA",811.8,77,100,1540,0)
<![CDATA[
"DATA",811.8,77,100,1541,0)
2531^1
"DATA",811.8,77,100,1542,0)
]]>
"DATA",811.8,77,100,1543,0)
</IEN_ROOT>
"DATA",811.8,77,100,1544,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1545,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1546,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1547,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1548,0)
<POINT_01>VA-MH OTHER OUTCOMES HF GP</POINT_01>
"DATA",811.8,77,100,1549,0)
<INTERNAL_ENTRY_NUMBER>2545</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1550,0)
<CHECKSUM>2902756297</CHECKSUM>
"DATA",811.8,77,100,1551,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1552,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1553,0)
<![CDATA[
"DATA",811.8,77,100,1554,0)
801.41;+2545,;.01~VA-MH OTHER OUTCOMES HF GP
"DATA",811.8,77,100,1555,0)
801.41;+2545,;4~dialog group
"DATA",811.8,77,100,1556,0)
801.41;+2545,;6~YES
"DATA",811.8,77,100,1557,0)
801.41;+2545,;7~2
"DATA",811.8,77,100,1558,0)
801.41;+2545,;9~NO SELECTION REQUIRED
"DATA",811.8,77,100,1559,0)
801.41;+2545,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1560,0)
801.41;+2545,;15~HF.MH NOSHOW OTHER OUTCOME
"DATA",811.8,77,100,1561,0)
801.41;+2545,;25~WP-start~1
"DATA",811.8,77,100,1562,0)
Other Outcome
"DATA",811.8,77,100,1563,0)
801.41;+2545,;52~INDENT
"DATA",811.8,77,100,1564,0)
801.41;+2545,;100~NATIONAL
"DATA",811.8,77,100,1565,0)
801.41;+2545,;101~Office of Mental Health Services
"DATA",811.8,77,100,1566,0)
801.412;+2546,+2545,;.01~10
"DATA",811.8,77,100,1567,0)
801.412;+2546,+2545,;2~VA-MH NOSHOW OTHER OUTCOME WP
"DATA",811.8,77,100,1568,0)
801.44;+2547,+2545,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1569,0)
801.44;+2547,+2545,;2~WP-start~1
"DATA",811.8,77,100,1570,0)
Exchange Stub
"DATA",811.8,77,100,1571,0)
]]>
"DATA",811.8,77,100,1572,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1573,0)
<IEN_ROOT>
"DATA",811.8,77,100,1574,0)
<![CDATA[
"DATA",811.8,77,100,1575,0)
2546^2
"DATA",811.8,77,100,1576,0)
2547^1
"DATA",811.8,77,100,1577,0)
]]>
"DATA",811.8,77,100,1578,0)
</IEN_ROOT>
"DATA",811.8,77,100,1579,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1580,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1581,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1582,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1583,0)
<POINT_01>VA-MH NOSHOW PLAN DEVELOPED WP</POINT_01>
"DATA",811.8,77,100,1584,0)
<INTERNAL_ENTRY_NUMBER>2582</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1585,0)
<CHECKSUM>653477284</CHECKSUM>
"DATA",811.8,77,100,1586,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1587,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1588,0)
<![CDATA[
"DATA",811.8,77,100,1589,0)
801.41;+2582,;.01~VA-MH NOSHOW PLAN DEVELOPED WP
"DATA",811.8,77,100,1590,0)
801.41;+2582,;4~dialog element
"DATA",811.8,77,100,1591,0)
801.41;+2582,;25~WP-start~2
"DATA",811.8,77,100,1592,0)
Plan:
"DATA",811.8,77,100,1593,0)
\\{FLD:WORD PROCESSING FIELD}
"DATA",811.8,77,100,1594,0)
801.41;+2582,;51~SUPPRESS
"DATA",811.8,77,100,1595,0)
801.41;+2582,;100~NATIONAL
"DATA",811.8,77,100,1596,0)
801.41;+2582,;101~Office of Mental Health Services
"DATA",811.8,77,100,1597,0)
801.44;+2583,+2582,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1598,0)
801.44;+2583,+2582,;2~WP-start~1
"DATA",811.8,77,100,1599,0)
Exchange Stub
"DATA",811.8,77,100,1600,0)
]]>
"DATA",811.8,77,100,1601,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1602,0)
<IEN_ROOT>
"DATA",811.8,77,100,1603,0)
<![CDATA[
"DATA",811.8,77,100,1604,0)
2583^1
"DATA",811.8,77,100,1605,0)
]]>
"DATA",811.8,77,100,1606,0)
</IEN_ROOT>
"DATA",811.8,77,100,1607,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1608,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1609,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1610,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1611,0)
<POINT_01>VA-MH NOSHOW PLAN DEVELOPED WP GP</POINT_01>
"DATA",811.8,77,100,1612,0)
<INTERNAL_ENTRY_NUMBER>2583</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1613,0)
<CHECKSUM>2239771500</CHECKSUM>
"DATA",811.8,77,100,1614,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1615,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1616,0)
<![CDATA[
"DATA",811.8,77,100,1617,0)
801.41;+2583,;.01~VA-MH NOSHOW PLAN DEVELOPED WP GP
"DATA",811.8,77,100,1618,0)
801.41;+2583,;4~dialog group
"DATA",811.8,77,100,1619,0)
801.41;+2583,;6~NO
"DATA",811.8,77,100,1620,0)
801.41;+2583,;9~NO SELECTION REQUIRED
"DATA",811.8,77,100,1621,0)
801.41;+2583,;50~SHOW
"DATA",811.8,77,100,1622,0)
801.41;+2583,;51~SUPPRESS
"DATA",811.8,77,100,1623,0)
801.41;+2583,;100~NATIONAL
"DATA",811.8,77,100,1624,0)
801.41;+2583,;101~Office of Mental Health Services
"DATA",811.8,77,100,1625,0)
801.412;+2584,+2583,;.01~5
"DATA",811.8,77,100,1626,0)
801.412;+2584,+2583,;2~VA-MH NOSHOW PLAN DEVELOPED WP
"DATA",811.8,77,100,1627,0)
801.44;+2585,+2583,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1628,0)
801.44;+2585,+2583,;2~WP-start~1
"DATA",811.8,77,100,1629,0)
Exchange Stub
"DATA",811.8,77,100,1630,0)
]]>
"DATA",811.8,77,100,1631,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1632,0)
<IEN_ROOT>
"DATA",811.8,77,100,1633,0)
<![CDATA[
"DATA",811.8,77,100,1634,0)
2584^1
"DATA",811.8,77,100,1635,0)
2585^1
"DATA",811.8,77,100,1636,0)
]]>
"DATA",811.8,77,100,1637,0)
</IEN_ROOT>
"DATA",811.8,77,100,1638,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1639,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1640,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1641,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1642,0)
<POINT_01>VA-MH NOSHOW PLAN DEVELOPED HF GP</POINT_01>
"DATA",811.8,77,100,1643,0)
<INTERNAL_ENTRY_NUMBER>2527</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1644,0)
<CHECKSUM>1432507014</CHECKSUM>
"DATA",811.8,77,100,1645,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1646,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1647,0)
<![CDATA[
"DATA",811.8,77,100,1648,0)
801.41;+2527,;.01~VA-MH NOSHOW PLAN DEVELOPED HF GP
"DATA",811.8,77,100,1649,0)
801.41;+2527,;4~dialog group
"DATA",811.8,77,100,1650,0)
801.41;+2527,;6~YES
"DATA",811.8,77,100,1651,0)
801.41;+2527,;7~2
"DATA",811.8,77,100,1652,0)
801.41;+2527,;9~NO SELECTION REQUIRED
"DATA",811.8,77,100,1653,0)
801.41;+2527,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1654,0)
801.41;+2527,;15~HF.MH NOSHOW PLAN DEVELOPED
"DATA",811.8,77,100,1655,0)
801.41;+2527,;25~WP-start~1
"DATA",811.8,77,100,1656,0)
Developed the following plan.
"DATA",811.8,77,100,1657,0)
801.41;+2527,;52~INDENT
"DATA",811.8,77,100,1658,0)
801.41;+2527,;100~NATIONAL
"DATA",811.8,77,100,1659,0)
801.41;+2527,;101~Office of Mental Health Services
"DATA",811.8,77,100,1660,0)
801.412;+2528,+2527,;.01~10
"DATA",811.8,77,100,1661,0)
801.412;+2528,+2527,;2~VA-MH NOSHOW PLAN DEVELOPED WP GP
"DATA",811.8,77,100,1662,0)
801.44;+2529,+2527,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1663,0)
801.44;+2529,+2527,;2~WP-start~1
"DATA",811.8,77,100,1664,0)
Exchange Stub
"DATA",811.8,77,100,1665,0)
]]>
"DATA",811.8,77,100,1666,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1667,0)
<IEN_ROOT>
"DATA",811.8,77,100,1668,0)
<![CDATA[
"DATA",811.8,77,100,1669,0)
2528^2
"DATA",811.8,77,100,1670,0)
2529^1
"DATA",811.8,77,100,1671,0)
]]>
"DATA",811.8,77,100,1672,0)
</IEN_ROOT>
"DATA",811.8,77,100,1673,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1674,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1675,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1676,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1677,0)
<POINT_01>VA-MH NOSHOW OUTREACH LETTER SENT HF</POINT_01>
"DATA",811.8,77,100,1678,0)
<INTERNAL_ENTRY_NUMBER>2540</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1679,0)
<CHECKSUM>998945314</CHECKSUM>
"DATA",811.8,77,100,1680,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1681,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1682,0)
<![CDATA[
"DATA",811.8,77,100,1683,0)
801.41;+2540,;.01~VA-MH NOSHOW OUTREACH LETTER SENT HF
"DATA",811.8,77,100,1684,0)
801.41;+2540,;4~dialog element
"DATA",811.8,77,100,1685,0)
801.41;+2540,;15~HF.MH NOSHOW OUTREACH LETTER
"DATA",811.8,77,100,1686,0)
801.41;+2540,;25~WP-start~1
"DATA",811.8,77,100,1687,0)
Outreach letter sent to patient.
"DATA",811.8,77,100,1688,0)
801.41;+2540,;100~NATIONAL
"DATA",811.8,77,100,1689,0)
801.41;+2540,;101~Office of Mental Health Services
"DATA",811.8,77,100,1690,0)
801.44;+2541,+2540,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1691,0)
801.44;+2541,+2540,;2~WP-start~1
"DATA",811.8,77,100,1692,0)
Exchange Stub
"DATA",811.8,77,100,1693,0)
]]>
"DATA",811.8,77,100,1694,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1695,0)
<IEN_ROOT>
"DATA",811.8,77,100,1696,0)
<![CDATA[
"DATA",811.8,77,100,1697,0)
2541^1
"DATA",811.8,77,100,1698,0)
]]>
"DATA",811.8,77,100,1699,0)
</IEN_ROOT>
"DATA",811.8,77,100,1700,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1701,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1702,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1703,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1704,0)
<POINT_01>VA-MH NOSHOW CONTACT INFO INACCURATE TEXT</POINT_01>
"DATA",811.8,77,100,1705,0)
<INTERNAL_ENTRY_NUMBER>2539</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1706,0)
<CHECKSUM>2671603157</CHECKSUM>
"DATA",811.8,77,100,1707,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1708,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1709,0)
<![CDATA[
"DATA",811.8,77,100,1710,0)
801.41;+2539,;.01~VA-MH NOSHOW CONTACT INFO INACCURATE TEXT
"DATA",811.8,77,100,1711,0)
801.41;+2539,;4~dialog element
"DATA",811.8,77,100,1712,0)
801.41;+2539,;25~WP-start~1
"DATA",811.8,77,100,1713,0)
Patient contact information inaccurate.
"DATA",811.8,77,100,1714,0)
801.41;+2539,;100~NATIONAL
"DATA",811.8,77,100,1715,0)
801.41;+2539,;101~Office of Mental Health Services
"DATA",811.8,77,100,1716,0)
801.44;+2540,+2539,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1717,0)
801.44;+2540,+2539,;2~WP-start~1
"DATA",811.8,77,100,1718,0)
Exchange Stub
"DATA",811.8,77,100,1719,0)
]]>
"DATA",811.8,77,100,1720,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1721,0)
<IEN_ROOT>
"DATA",811.8,77,100,1722,0)
<![CDATA[
"DATA",811.8,77,100,1723,0)
2540^1
"DATA",811.8,77,100,1724,0)
]]>
"DATA",811.8,77,100,1725,0)
</IEN_ROOT>
"DATA",811.8,77,100,1726,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1727,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1728,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1729,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1730,0)
<POINT_01>VA-MH NOSHOW LEFT VOICE MAIL TEXT</POINT_01>
"DATA",811.8,77,100,1731,0)
<INTERNAL_ENTRY_NUMBER>2538</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1732,0)
<CHECKSUM>996809925</CHECKSUM>
"DATA",811.8,77,100,1733,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1734,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1735,0)
<![CDATA[
"DATA",811.8,77,100,1736,0)
801.41;+2538,;.01~VA-MH NOSHOW LEFT VOICE MAIL TEXT
"DATA",811.8,77,100,1737,0)
801.41;+2538,;4~dialog element
"DATA",811.8,77,100,1738,0)
801.41;+2538,;25~WP-start~1
"DATA",811.8,77,100,1739,0)
Left message on voice mail for patient.
"DATA",811.8,77,100,1740,0)
801.41;+2538,;100~NATIONAL
"DATA",811.8,77,100,1741,0)
801.41;+2538,;101~Office of Mental Health Services
"DATA",811.8,77,100,1742,0)
801.44;+2539,+2538,;.01~12/06/2012@15:23:22
"DATA",811.8,77,100,1743,0)
801.44;+2539,+2538,;2~WP-start~1
"DATA",811.8,77,100,1744,0)
Exchange Stub
"DATA",811.8,77,100,1745,0)
]]>
"DATA",811.8,77,100,1746,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1747,0)
<IEN_ROOT>
"DATA",811.8,77,100,1748,0)
<![CDATA[
"DATA",811.8,77,100,1749,0)
2539^1
"DATA",811.8,77,100,1750,0)
]]>
"DATA",811.8,77,100,1751,0)
</IEN_ROOT>
"DATA",811.8,77,100,1752,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1753,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1754,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1755,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1756,0)
<POINT_01>VA-MH NOSHOW 3 ATTEMPTS UNSUCCESSFUL GP</POINT_01>
"DATA",811.8,77,100,1757,0)
<INTERNAL_ENTRY_NUMBER>2537</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1758,0)
<CHECKSUM>3858337618</CHECKSUM>
"DATA",811.8,77,100,1759,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1760,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1761,0)
<![CDATA[
"DATA",811.8,77,100,1762,0)
801.41;+2537,;.01~VA-MH NOSHOW 3 ATTEMPTS UNSUCCESSFUL GP
"DATA",811.8,77,100,1763,0)
801.41;+2537,;4~dialog group
"DATA",811.8,77,100,1764,0)
801.41;+2537,;5~Unsuccessful Call Actions
"DATA",811.8,77,100,1765,0)
801.41;+2537,;6~YES
"DATA",811.8,77,100,1766,0)
801.41;+2537,;7~1
"DATA",811.8,77,100,1767,0)
801.41;+2537,;9~ONE OR MORE SELECTIONS
"DATA",811.8,77,100,1768,0)
801.41;+2537,;15~HF.MH NOSHOW PT CALLED 3X UNSUCCESSFUL
"DATA",811.8,77,100,1769,0)
801.41;+2537,;25~WP-start~1
"DATA",811.8,77,100,1770,0)
Three unsuccessful attempts made to contact patient.
"DATA",811.8,77,100,1771,0)
801.41;+2537,;52~INDENT
"DATA",811.8,77,100,1772,0)
801.41;+2537,;100~NATIONAL
"DATA",811.8,77,100,1773,0)
801.41;+2537,;101~Office of Mental Health Services
"DATA",811.8,77,100,1774,0)
801.412;+2538,+2537,;.01~5
"DATA",811.8,77,100,1775,0)
801.412;+2538,+2537,;2~VA-MH NOSHOW LEFT VOICE MAIL TEXT
"DATA",811.8,77,100,1776,0)
801.412;+2539,+2537,;.01~10
"DATA",811.8,77,100,1777,0)
801.412;+2539,+2537,;2~VA-MH NOSHOW CONTACT INFO INACCURATE TEXT
"DATA",811.8,77,100,1778,0)
801.412;+2540,+2537,;.01~15
"DATA",811.8,77,100,1779,0)
801.412;+2540,+2537,;2~VA-MH NOSHOW OUTREACH LETTER SENT HF
"DATA",811.8,77,100,1780,0)
801.412;+2541,+2537,;.01~20
"DATA",811.8,77,100,1781,0)
801.412;+2541,+2537,;2~VA-MH NOSHOW PLAN DEVELOPED HF GP
"DATA",811.8,77,100,1782,0)
801.44;+2542,+2537,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1783,0)
801.44;+2542,+2537,;2~WP-start~1
"DATA",811.8,77,100,1784,0)
Exchange Stub
"DATA",811.8,77,100,1785,0)
]]>
"DATA",811.8,77,100,1786,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1787,0)
<IEN_ROOT>
"DATA",811.8,77,100,1788,0)
<![CDATA[
"DATA",811.8,77,100,1789,0)
2538^1
"DATA",811.8,77,100,1790,0)
2539^2
"DATA",811.8,77,100,1791,0)
2540^3
"DATA",811.8,77,100,1792,0)
2541^4
"DATA",811.8,77,100,1793,0)
2542^1
"DATA",811.8,77,100,1794,0)
]]>
"DATA",811.8,77,100,1795,0)
</IEN_ROOT>
"DATA",811.8,77,100,1796,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1797,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1798,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1799,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1800,0)
<POINT_01>VA-MH NOSHOW PT EMERGENT CARE HF</POINT_01>
"DATA",811.8,77,100,1801,0)
<INTERNAL_ENTRY_NUMBER>2524</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1802,0)
<CHECKSUM>3679508591</CHECKSUM>
"DATA",811.8,77,100,1803,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1804,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1805,0)
<![CDATA[
"DATA",811.8,77,100,1806,0)
801.41;+2524,;.01~VA-MH NOSHOW PT EMERGENT CARE HF
"DATA",811.8,77,100,1807,0)
801.41;+2524,;4~dialog element
"DATA",811.8,77,100,1808,0)
801.41;+2524,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1809,0)
801.41;+2524,;15~HF.MH NOSHOW PT EMERGENT CARE
"DATA",811.8,77,100,1810,0)
801.41;+2524,;25~WP-start~1
"DATA",811.8,77,100,1811,0)
Patient sought urgent or emergent mental health care.
"DATA",811.8,77,100,1812,0)
801.41;+2524,;100~NATIONAL
"DATA",811.8,77,100,1813,0)
801.41;+2524,;101~Office of Mental Health Services
"DATA",811.8,77,100,1814,0)
801.412;+2525,+2524,;.01~5
"DATA",811.8,77,100,1815,0)
801.412;+2525,+2524,;2~PXRM COMMENT
"DATA",811.8,77,100,1816,0)
801.412;+2525,+2524,;7~YES
"DATA",811.8,77,100,1817,0)
801.44;+2526,+2524,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1818,0)
801.44;+2526,+2524,;2~WP-start~1
"DATA",811.8,77,100,1819,0)
Exchange Stub
"DATA",811.8,77,100,1820,0)
]]>
"DATA",811.8,77,100,1821,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1822,0)
<IEN_ROOT>
"DATA",811.8,77,100,1823,0)
<![CDATA[
"DATA",811.8,77,100,1824,0)
2525^1
"DATA",811.8,77,100,1825,0)
2526^1
"DATA",811.8,77,100,1826,0)
]]>
"DATA",811.8,77,100,1827,0)
</IEN_ROOT>
"DATA",811.8,77,100,1828,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1829,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1830,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1831,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1832,0)
<POINT_01>VA-MH NOSHOW PT CONTACTED HF</POINT_01>
"DATA",811.8,77,100,1833,0)
<INTERNAL_ENTRY_NUMBER>2523</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1834,0)
<CHECKSUM>3998141733</CHECKSUM>
"DATA",811.8,77,100,1835,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1836,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1837,0)
<![CDATA[
"DATA",811.8,77,100,1838,0)
801.41;+2523,;.01~VA-MH NOSHOW PT CONTACTED HF
"DATA",811.8,77,100,1839,0)
801.41;+2523,;4~dialog element
"DATA",811.8,77,100,1840,0)
801.41;+2523,;13~DONE AT ENCOUNTER
"DATA",811.8,77,100,1841,0)
801.41;+2523,;15~HF.MH NOSHOW PT CONTACTED
"DATA",811.8,77,100,1842,0)
801.41;+2523,;25~WP-start~1
"DATA",811.8,77,100,1843,0)
Patient contact made and plan put in place for ongoing care.
"DATA",811.8,77,100,1844,0)
801.41;+2523,;100~NATIONAL
"DATA",811.8,77,100,1845,0)
801.41;+2523,;101~Office of Mental Health Services
"DATA",811.8,77,100,1846,0)
801.412;+2524,+2523,;.01~5
"DATA",811.8,77,100,1847,0)
801.412;+2524,+2523,;2~PXRM COMMENT
"DATA",811.8,77,100,1848,0)
801.412;+2524,+2523,;7~YES
"DATA",811.8,77,100,1849,0)
801.44;+2525,+2523,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1850,0)
801.44;+2525,+2523,;2~WP-start~1
"DATA",811.8,77,100,1851,0)
Exchange Stub
"DATA",811.8,77,100,1852,0)
]]>
"DATA",811.8,77,100,1853,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1854,0)
<IEN_ROOT>
"DATA",811.8,77,100,1855,0)
<![CDATA[
"DATA",811.8,77,100,1856,0)
2524^1
"DATA",811.8,77,100,1857,0)
2525^1
"DATA",811.8,77,100,1858,0)
]]>
"DATA",811.8,77,100,1859,0)
</IEN_ROOT>
"DATA",811.8,77,100,1860,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1861,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1862,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1863,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1864,0)
<POINT_01>VA-MH SUPPORTING DATA HSOBJ</POINT_01>
"DATA",811.8,77,100,1865,0)
<INTERNAL_ENTRY_NUMBER>2534</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1866,0)
<CHECKSUM>2265049975</CHECKSUM>
"DATA",811.8,77,100,1867,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1868,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1869,0)
<![CDATA[
"DATA",811.8,77,100,1870,0)
801.41;+2534,;.01~VA-MH SUPPORTING DATA HSOBJ
"DATA",811.8,77,100,1871,0)
801.41;+2534,;4~dialog element
"DATA",811.8,77,100,1872,0)
801.41;+2534,;23~YES
"DATA",811.8,77,100,1873,0)
801.41;+2534,;25~WP-start~3
"DATA",811.8,77,100,1874,0)
The following are patient contacts, future MH appts, patient record flag 
"DATA",811.8,77,100,1875,0)
history, and MHTC information if available.
"DATA",811.8,77,100,1876,0)
\\|VA-MH HIGH RISK PATIENT|
"DATA",811.8,77,100,1877,0)
801.41;+2534,;51~SUPPRESS
"DATA",811.8,77,100,1878,0)
801.41;+2534,;100~NATIONAL
"DATA",811.8,77,100,1879,0)
801.41;+2534,;101~Office of Mental Health Services
"DATA",811.8,77,100,1880,0)
801.44;+2535,+2534,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1881,0)
801.44;+2535,+2534,;2~WP-start~1
"DATA",811.8,77,100,1882,0)
Exchange Stub
"DATA",811.8,77,100,1883,0)
]]>
"DATA",811.8,77,100,1884,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1885,0)
<IEN_ROOT>
"DATA",811.8,77,100,1886,0)
<![CDATA[
"DATA",811.8,77,100,1887,0)
2535^1
"DATA",811.8,77,100,1888,0)
]]>
"DATA",811.8,77,100,1889,0)
</IEN_ROOT>
"DATA",811.8,77,100,1890,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1891,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1892,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1893,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1894,0)
<POINT_01>VA-MH NOSHOW SUPPORTING INFO GP</POINT_01>
"DATA",811.8,77,100,1895,0)
<INTERNAL_ENTRY_NUMBER>2543</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1896,0)
<CHECKSUM>3240552829</CHECKSUM>
"DATA",811.8,77,100,1897,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1898,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1899,0)
<![CDATA[
"DATA",811.8,77,100,1900,0)
801.41;+2543,;.01~VA-MH NOSHOW SUPPORTING INFO GP
"DATA",811.8,77,100,1901,0)
801.41;+2543,;4~dialog group
"DATA",811.8,77,100,1902,0)
801.41;+2543,;5~Supporting information
"DATA",811.8,77,100,1903,0)
801.41;+2543,;6~YES
"DATA",811.8,77,100,1904,0)
801.41;+2543,;7~1
"DATA",811.8,77,100,1905,0)
801.41;+2543,;23~YES
"DATA",811.8,77,100,1906,0)
801.41;+2543,;25~WP-start~2
"DATA",811.8,77,100,1907,0)
Click here to see supporting information.  Refer to the Safety Plan for 
"DATA",811.8,77,100,1908,0)
additional information.
"DATA",811.8,77,100,1909,0)
801.41;+2543,;50~HIDE
"DATA",811.8,77,100,1910,0)
801.41;+2543,;100~NATIONAL
"DATA",811.8,77,100,1911,0)
801.41;+2543,;101~Office of Mental Health Services
"DATA",811.8,77,100,1912,0)
801.412;+2544,+2543,;.01~5
"DATA",811.8,77,100,1913,0)
801.412;+2544,+2543,;2~VA-MH SUPPORTING DATA HSOBJ
"DATA",811.8,77,100,1914,0)
801.412;+2544,+2543,;8~YES
"DATA",811.8,77,100,1915,0)
801.44;+2545,+2543,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1916,0)
801.44;+2545,+2543,;2~WP-start~1
"DATA",811.8,77,100,1917,0)
Exchange Stub
"DATA",811.8,77,100,1918,0)
]]>
"DATA",811.8,77,100,1919,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1920,0)
<IEN_ROOT>
"DATA",811.8,77,100,1921,0)
<![CDATA[
"DATA",811.8,77,100,1922,0)
2544^1
"DATA",811.8,77,100,1923,0)
2545^1
"DATA",811.8,77,100,1924,0)
]]>
"DATA",811.8,77,100,1925,0)
</IEN_ROOT>
"DATA",811.8,77,100,1926,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1927,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1928,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1929,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1930,0)
<POINT_01>VA-MH NOSHOW INFO TEXT</POINT_01>
"DATA",811.8,77,100,1931,0)
<INTERNAL_ENTRY_NUMBER>2522</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1932,0)
<CHECKSUM>3727412606</CHECKSUM>
"DATA",811.8,77,100,1933,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,1934,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1935,0)
<![CDATA[
"DATA",811.8,77,100,1936,0)
801.41;+2522,;.01~VA-MH NOSHOW INFO TEXT
"DATA",811.8,77,100,1937,0)
801.41;+2522,;4~dialog element
"DATA",811.8,77,100,1938,0)
801.41;+2522,;23~YES
"DATA",811.8,77,100,1939,0)
801.41;+2522,;25~WP-start~7
"DATA",811.8,77,100,1940,0)
This patient has an active High Risk for Suicide Patient Record Flag and 
"DATA",811.8,77,100,1941,0)
was a NO SHOW to a MH appointment. If the patient has a completed 
"DATA",811.8,77,100,1942,0)
encounter to a MH appointment on the same day, or within 72 hours of the 
"DATA",811.8,77,100,1943,0)
missed MH appointment, then this clinical reminder is resolved.
"DATA",811.8,77,100,1944,0)
 |MH MISSED APPOINTMENTS 10D|
"DATA",811.8,77,100,1945,0)
 
"DATA",811.8,77,100,1946,0)
Action needed: Please document follow-up outcome using fields below. 
"DATA",811.8,77,100,1947,0)
801.41;+2522,;51~SUPPRESS
"DATA",811.8,77,100,1948,0)
801.41;+2522,;100~NATIONAL
"DATA",811.8,77,100,1949,0)
801.41;+2522,;101~Office of Mental Health Services
"DATA",811.8,77,100,1950,0)
801.44;+2523,+2522,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1951,0)
801.44;+2523,+2522,;2~WP-start~1
"DATA",811.8,77,100,1952,0)
Exchange Stub
"DATA",811.8,77,100,1953,0)
]]>
"DATA",811.8,77,100,1954,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,1955,0)
<IEN_ROOT>
"DATA",811.8,77,100,1956,0)
<![CDATA[
"DATA",811.8,77,100,1957,0)
2523^1
"DATA",811.8,77,100,1958,0)
]]>
"DATA",811.8,77,100,1959,0)
</IEN_ROOT>
"DATA",811.8,77,100,1960,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,1961,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,1962,0)
<FILE_NAME>REMINDER DIALOG</FILE_NAME>
"DATA",811.8,77,100,1963,0)
<FILE_NUMBER>801.41</FILE_NUMBER>
"DATA",811.8,77,100,1964,0)
<POINT_01>VA-MH HIGH RISK NO SHOW FOLLOW-UP</POINT_01>
"DATA",811.8,77,100,1965,0)
<INTERNAL_ENTRY_NUMBER>2533</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,1966,0)
<CHECKSUM>1632586403</CHECKSUM>
"DATA",811.8,77,100,1967,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,77,100,1968,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,1969,0)
<![CDATA[
"DATA",811.8,77,100,1970,0)
801.41;+2533,;.01~VA-MH HIGH RISK NO SHOW FOLLOW-UP
"DATA",811.8,77,100,1971,0)
801.41;+2533,;2~VA-MH HIGH RISK NO-SHOW FOLLOW-UP
"DATA",811.8,77,100,1972,0)
801.41;+2533,;4~reminder dialog
"DATA",811.8,77,100,1973,0)
801.41;+2533,;100~NATIONAL
"DATA",811.8,77,100,1974,0)
801.41;+2533,;101~Office of Mental Health Services
"DATA",811.8,77,100,1975,0)
801.412;+2534,+2533,;.01~5
"DATA",811.8,77,100,1976,0)
801.412;+2534,+2533,;2~VA-MH NOSHOW INFO TEXT
"DATA",811.8,77,100,1977,0)
801.412;+2535,+2533,;.01~20
"DATA",811.8,77,100,1978,0)
801.412;+2535,+2533,;2~VA-TEXT BLANK LINE
"DATA",811.8,77,100,1979,0)
801.412;+2536,+2533,;.01~32
"DATA",811.8,77,100,1980,0)
801.412;+2536,+2533,;2~VA-MH OTHER OUTCOMES HF GP
"DATA",811.8,77,100,1981,0)
801.412;+2537,+2533,;.01~70
"DATA",811.8,77,100,1982,0)
801.412;+2537,+2533,;2~VA-MH NOSHOW SUICIDE EVENT GP
"DATA",811.8,77,100,1983,0)
801.412;+2538,+2533,;.01~75
"DATA",811.8,77,100,1984,0)
801.412;+2538,+2533,;2~VA-GP MH SBR
"DATA",811.8,77,100,1985,0)
801.412;+2539,+2533,;.01~74
"DATA",811.8,77,100,1986,0)
801.412;+2539,+2533,;2~VA-TEXT BLANK LINE
"DATA",811.8,77,100,1987,0)
801.412;+2540,+2533,;.01~10
"DATA",811.8,77,100,1988,0)
801.412;+2540,+2533,;2~VA-MH NOSHOW SUPPORTING INFO GP
"DATA",811.8,77,100,1989,0)
801.412;+2541,+2533,;.01~25
"DATA",811.8,77,100,1990,0)
801.412;+2541,+2533,;2~VA-MH NOSHOW PT CONTACTED HF
"DATA",811.8,77,100,1991,0)
801.412;+2542,+2533,;.01~30
"DATA",811.8,77,100,1992,0)
801.412;+2542,+2533,;2~VA-MH NOSHOW PT EMERGENT CARE HF
"DATA",811.8,77,100,1993,0)
801.412;+2543,+2533,;.01~50
"DATA",811.8,77,100,1994,0)
801.412;+2543,+2533,;2~VA-MH NOSHOW 3 ATTEMPTS UNSUCCESSFUL GP
"DATA",811.8,77,100,1995,0)
801.44;+2544,+2533,;.01~12/06/2012@15:23:23
"DATA",811.8,77,100,1996,0)
801.44;+2544,+2533,;2~WP-start~1
"DATA",811.8,77,100,1997,0)
Exchange Stub
"DATA",811.8,77,100,1998,0)
]]>
"DATA",811.8,77,100,1999,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2000,0)
<IEN_ROOT>
"DATA",811.8,77,100,2001,0)
<![CDATA[
"DATA",811.8,77,100,2002,0)
2534^1
"DATA",811.8,77,100,2003,0)
2535^11
"DATA",811.8,77,100,2004,0)
2536^12
"DATA",811.8,77,100,2005,0)
2537^13
"DATA",811.8,77,100,2006,0)
2538^14
"DATA",811.8,77,100,2007,0)
2539^15
"DATA",811.8,77,100,2008,0)
2540^2
"DATA",811.8,77,100,2009,0)
2541^5
"DATA",811.8,77,100,2010,0)
2542^6
"DATA",811.8,77,100,2011,0)
2543^8
"DATA",811.8,77,100,2012,0)
2544^1
"DATA",811.8,77,100,2013,0)
]]>
"DATA",811.8,77,100,2014,0)
</IEN_ROOT>
"DATA",811.8,77,100,2015,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2016,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2017,0)
<FILE_NAME>HEALTH SUMMARY COMPONENT</FILE_NAME>
"DATA",811.8,77,100,2018,0)
<FILE_NUMBER>142.1</FILE_NUMBER>
"DATA",811.8,77,100,2019,0)
<POINT_01>MH TREATMENT COORDINATOR</POINT_01>
"DATA",811.8,77,100,2020,0)
<INTERNAL_ENTRY_NUMBER>256</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2021,0)
<CHECKSUM>1697149717</CHECKSUM>
"DATA",811.8,77,100,2022,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,2023,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2024,0)
<![CDATA[
"DATA",811.8,77,100,2025,0)
142.1;+256,;.001~256
"DATA",811.8,77,100,2026,0)
142.1;+256,;.01~MH TREATMENT COORDINATOR
"DATA",811.8,77,100,2027,0)
142.1;+256,;1~EN;GMTSMHTC
"DATA",811.8,77,100,2028,0)
142.1;+256,;3~MHTC
"DATA",811.8,77,100,2029,0)
142.1;+256,;3.5~WP-start~2
"DATA",811.8,77,100,2030,0)
This component displays Mental Health Treatment Coordinator (MHTC)
"DATA",811.8,77,100,2031,0)
assigned to this patient.
"DATA",811.8,77,100,2032,0)
142.1;+256,;9~MH Treatment Coor
"DATA",811.8,77,100,2033,0)
]]>
"DATA",811.8,77,100,2034,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2035,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2036,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2037,0)
<FILE_NAME>HEALTH SUMMARY COMPONENT</FILE_NAME>
"DATA",811.8,77,100,2038,0)
<FILE_NUMBER>142.1</FILE_NUMBER>
"DATA",811.8,77,100,2039,0)
<POINT_01>MH HIGH RISK PRF HX</POINT_01>
"DATA",811.8,77,100,2040,0)
<INTERNAL_ENTRY_NUMBER>255</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2041,0)
<CHECKSUM>896421556</CHECKSUM>
"DATA",811.8,77,100,2042,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,2043,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2044,0)
<![CDATA[
"DATA",811.8,77,100,2045,0)
142.1;+255,;.001~255
"DATA",811.8,77,100,2046,0)
142.1;+255,;.01~MH HIGH RISK PRF HX
"DATA",811.8,77,100,2047,0)
142.1;+255,;1~EN;GMTSMHRF
"DATA",811.8,77,100,2048,0)
142.1;+255,;3~MHRF
"DATA",811.8,77,100,2049,0)
142.1;+255,;3.5~WP-start~4
"DATA",811.8,77,100,2050,0)
This component displays the assignment status and history for the 
"DATA",811.8,77,100,2051,0)
Category I (National) HIGH RISK FOR SUICIDE Patient Record Flag.
"DATA",811.8,77,100,2052,0)
Any assignment history found for the Category II (Local) High Risk for 
"DATA",811.8,77,100,2053,0)
Suicide flag will also be displayed.
"DATA",811.8,77,100,2054,0)
142.1;+255,;9~MH Suicide PRF Hx
"DATA",811.8,77,100,2055,0)
]]>
"DATA",811.8,77,100,2056,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2057,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2058,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2059,0)
<FILE_NAME>HEALTH SUMMARY COMPONENT</FILE_NAME>
"DATA",811.8,77,100,2060,0)
<FILE_NUMBER>142.1</FILE_NUMBER>
"DATA",811.8,77,100,2061,0)
<POINT_01>MAS MH CLINIC VISITS FUTURE</POINT_01>
"DATA",811.8,77,100,2062,0)
<INTERNAL_ENTRY_NUMBER>254</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2063,0)
<CHECKSUM>3396733300</CHECKSUM>
"DATA",811.8,77,100,2064,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,2065,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2066,0)
<![CDATA[
"DATA",811.8,77,100,2067,0)
142.1;+254,;.001~254
"DATA",811.8,77,100,2068,0)
142.1;+254,;.01~MAS MH CLINIC VISITS FUTURE
"DATA",811.8,77,100,2069,0)
142.1;+254,;1~EN;GMTSMHAP
"DATA",811.8,77,100,2070,0)
142.1;+254,;3~MHFV
"DATA",811.8,77,100,2071,0)
142.1;+254,;3.5~WP-start~3
"DATA",811.8,77,100,2072,0)
This component displays the next scheduled appointment(s) to any MH
"DATA",811.8,77,100,2073,0)
clinic.  MH Clinics are identified using the VA-MH NO SHOW APPT CLINICS 
"DATA",811.8,77,100,2074,0)
LL Reminder Location List.
"DATA",811.8,77,100,2075,0)
142.1;+254,;9~MH Clinic Fut Visits
"DATA",811.8,77,100,2076,0)
]]>
"DATA",811.8,77,100,2077,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2078,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2079,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2080,0)
<FILE_NAME>HEALTH SUMMARY COMPONENT</FILE_NAME>
"DATA",811.8,77,100,2081,0)
<FILE_NUMBER>142.1</FILE_NUMBER>
"DATA",811.8,77,100,2082,0)
<POINT_01>MAS CONTACTS</POINT_01>
"DATA",811.8,77,100,2083,0)
<INTERNAL_ENTRY_NUMBER>253</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2084,0)
<CHECKSUM>640639689</CHECKSUM>
"DATA",811.8,77,100,2085,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,2086,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2087,0)
<![CDATA[
"DATA",811.8,77,100,2088,0)
142.1;+253,;.001~253
"DATA",811.8,77,100,2089,0)
142.1;+253,;.01~MAS CONTACTS
"DATA",811.8,77,100,2090,0)
142.1;+253,;1~PRINT;GMTSMHCI
"DATA",811.8,77,100,2091,0)
142.1;+253,;3~CON
"DATA",811.8,77,100,2092,0)
142.1;+253,;3.5~WP-start~4
"DATA",811.8,77,100,2093,0)
This component lists (if available) the following patient contact information:
"DATA",811.8,77,100,2094,0)
Patient Phone (Cell, Home, Work)
"DATA",811.8,77,100,2095,0)
Name, Relationship, and Phone Number of the:
"DATA",811.8,77,100,2096,0)
Emergency Contact, Secondary Emergency Contact, and Secondary NOK Contact
"DATA",811.8,77,100,2097,0)
142.1;+253,;9~Patient Contacts
"DATA",811.8,77,100,2098,0)
]]>
"DATA",811.8,77,100,2099,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2100,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2101,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2102,0)
<FILE_NAME>HEALTH SUMMARY TYPE</FILE_NAME>
"DATA",811.8,77,100,2103,0)
<FILE_NUMBER>142</FILE_NUMBER>
"DATA",811.8,77,100,2104,0)
<POINT_01>VA-MH HIGH RISK PATIENT</POINT_01>
"DATA",811.8,77,100,2105,0)
<INTERNAL_ENTRY_NUMBER>448</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2106,0)
<CHECKSUM>470239507</CHECKSUM>
"DATA",811.8,77,100,2107,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,77,100,2108,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2109,0)
<![CDATA[
"DATA",811.8,77,100,2110,0)
142;+448,;.01~VA-MH HIGH RISK PATIENT
"DATA",811.8,77,100,2111,0)
142;+448,;.02~MH HIGH RISK PATIENT
"DATA",811.8,77,100,2112,0)
142;+448,;.05~GMTSMGR
"DATA",811.8,77,100,2113,0)
142;+448,;.09~Nationally Exported, Site Editable
"DATA",811.8,77,100,2114,0)
142;+448,;99~62566,43982
"DATA",811.8,77,100,2115,0)
142.01;+449,+448,;.01~10
"DATA",811.8,77,100,2116,0)
142.01;+449,+448,;1~MAS MH CLINIC VISITS FUTURE
"DATA",811.8,77,100,2117,0)
142.01;+449,+448,;5~MH Clinic Fut Visits
"DATA",811.8,77,100,2118,0)
142.01;+450,+448,;.01~15
"DATA",811.8,77,100,2119,0)
142.01;+450,+448,;1~MH HIGH RISK PRF HX
"DATA",811.8,77,100,2120,0)
142.01;+450,+448,;5~MH Suicide PRF Hx
"DATA",811.8,77,100,2121,0)
142.01;+451,+448,;.01~20
"DATA",811.8,77,100,2122,0)
142.01;+451,+448,;1~MH TREATMENT COORDINATOR
"DATA",811.8,77,100,2123,0)
142.01;+451,+448,;5~MH Treatment Coor
"DATA",811.8,77,100,2124,0)
142.01;+452,+448,;.01~5
"DATA",811.8,77,100,2125,0)
142.01;+452,+448,;1~MAS CONTACTS
"DATA",811.8,77,100,2126,0)
142.01;+452,+448,;5~Patient Contacts
"DATA",811.8,77,100,2127,0)
]]>
"DATA",811.8,77,100,2128,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2129,0)
<IEN_ROOT>
"DATA",811.8,77,100,2130,0)
<![CDATA[
"DATA",811.8,77,100,2131,0)
449^10
"DATA",811.8,77,100,2132,0)
450^15
"DATA",811.8,77,100,2133,0)
451^20
"DATA",811.8,77,100,2134,0)
452^5
"DATA",811.8,77,100,2135,0)
]]>
"DATA",811.8,77,100,2136,0)
</IEN_ROOT>
"DATA",811.8,77,100,2137,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2138,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2139,0)
<FILE_NAME>HEALTH SUMMARY OBJECTS</FILE_NAME>
"DATA",811.8,77,100,2140,0)
<FILE_NUMBER>142.5</FILE_NUMBER>
"DATA",811.8,77,100,2141,0)
<POINT_01>VA-MH HIGH RISK PATIENT (TIU)</POINT_01>
"DATA",811.8,77,100,2142,0)
<INTERNAL_ENTRY_NUMBER>6600099</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2143,0)
<CHECKSUM>1401839939</CHECKSUM>
"DATA",811.8,77,100,2144,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,77,100,2145,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2146,0)
<![CDATA[
"DATA",811.8,77,100,2147,0)
142.5;+6600099,;.01~VA-MH HIGH RISK PATIENT (TIU)
"DATA",811.8,77,100,2148,0)
142.5;+6600099,;.03~VA-MH HIGH RISK PATIENT
"DATA",811.8,77,100,2149,0)
142.5;+6600099,;.05~NO
"DATA",811.8,77,100,2150,0)
142.5;+6600099,;.06~YES
"DATA",811.8,77,100,2151,0)
142.5;+6600099,;.07~NO
"DATA",811.8,77,100,2152,0)
142.5;+6600099,;.08~NO
"DATA",811.8,77,100,2153,0)
142.5;+6600099,;.09~NO
"DATA",811.8,77,100,2154,0)
142.5;+6600099,;.1~NO
"DATA",811.8,77,100,2155,0)
142.5;+6600099,;.11~NO
"DATA",811.8,77,100,2156,0)
142.5;+6600099,;.12~YES
"DATA",811.8,77,100,2157,0)
142.5;+6600099,;.13~NO
"DATA",811.8,77,100,2158,0)
142.5;+6600099,;.14~NO
"DATA",811.8,77,100,2159,0)
142.5;+6600099,;.15~NO
"DATA",811.8,77,100,2160,0)
142.5;+6600099,;.16~NO
"DATA",811.8,77,100,2161,0)
142.5;+6600099,;.18~JUN 06, 2011@09:38:39
"DATA",811.8,77,100,2162,0)
142.5;+6600099,;.19~JUN 08, 2011@10:09:45
"DATA",811.8,77,100,2163,0)
142.5;+6600099,;.2~YES
"DATA",811.8,77,100,2164,0)
]]>
"DATA",811.8,77,100,2165,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2166,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2167,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2168,0)
<FILE_NAME>TIU DOCUMENT DEFINITION</FILE_NAME>
"DATA",811.8,77,100,2169,0)
<FILE_NUMBER>8925.1</FILE_NUMBER>
"DATA",811.8,77,100,2170,0)
<POINT_01>VA-MH HIGH RISK PATIENT</POINT_01>
"DATA",811.8,77,100,2171,0)
<INTERNAL_ENTRY_NUMBER>360</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2172,0)
<CHECKSUM>1815181665</CHECKSUM>
"DATA",811.8,77,100,2173,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,77,100,2174,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2175,0)
<![CDATA[
"DATA",811.8,77,100,2176,0)
8925.1;+360,;.01~VA-MH HIGH RISK PATIENT
"DATA",811.8,77,100,2177,0)
8925.1;+360,;.03~VA-MH HIGH RISK PATIENT
"DATA",811.8,77,100,2178,0)
8925.1;+360,;.04~OBJECT
"DATA",811.8,77,100,2179,0)
8925.1;+360,;.07~ACTIVE
"DATA",811.8,77,100,2180,0)
8925.1;+360,;3.02~YES
"DATA",811.8,77,100,2181,0)
8925.1;+360,;9~S X=$$TIU^GMTSOBJ(DFN,VA-MH HIGH RISK PATIENT (TIU))
"DATA",811.8,77,100,2182,0)
8925.1;+360,;99~
"DATA",811.8,77,100,2183,0)
]]>
"DATA",811.8,77,100,2184,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2185,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2186,0)
<FILEMAN_FILE>
"DATA",811.8,77,100,2187,0)
<FILE_NAME>TIU DOCUMENT DEFINITION</FILE_NAME>
"DATA",811.8,77,100,2188,0)
<FILE_NUMBER>8925.1</FILE_NUMBER>
"DATA",811.8,77,100,2189,0)
<POINT_01>MH MISSED APPOINTMENTS 10D</POINT_01>
"DATA",811.8,77,100,2190,0)
<INTERNAL_ENTRY_NUMBER>101</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,77,100,2191,0)
<CHECKSUM>3024311399</CHECKSUM>
"DATA",811.8,77,100,2192,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,77,100,2193,0)
<FILEMAN_FDA>
"DATA",811.8,77,100,2194,0)
<![CDATA[
"DATA",811.8,77,100,2195,0)
8925.1;+101,;.01~MH MISSED APPOINTMENTS 10D
"DATA",811.8,77,100,2196,0)
]]>
"DATA",811.8,77,100,2197,0)
</FILEMAN_FDA>
"DATA",811.8,77,100,2198,0)
</FILEMAN_FILE>
"DATA",811.8,77,100,2199,0)
<INDEX>
"DATA",811.8,77,100,2200,0)
<NUMBER_OF_COMPONENTS>61</NUMBER_OF_COMPONENTS>
"DATA",811.8,77,100,2201,0)
<COMPONENT>
"DATA",811.8,77,100,2202,0)
<M_ROUTINE_START>35</M_ROUTINE_START>
"DATA",811.8,77,100,2203,0)
<ROUTINE_CODE_END>140</ROUTINE_CODE_END>
"DATA",811.8,77,100,2204,0)
<ROUTINE_CODE_START>40</ROUTINE_CODE_START>
"DATA",811.8,77,100,2205,0)
</COMPONENT>
"DATA",811.8,77,100,2206,0)
<COMPONENT>
"DATA",811.8,77,100,2207,0)
<M_ROUTINE_START>144</M_ROUTINE_START>
"DATA",811.8,77,100,2208,0)
<ROUTINE_CODE_END>330</ROUTINE_CODE_END>
"DATA",811.8,77,100,2209,0)
<ROUTINE_CODE_START>149</ROUTINE_CODE_START>
"DATA",811.8,77,100,2210,0)
</COMPONENT>
"DATA",811.8,77,100,2211,0)
<COMPONENT>
"DATA",811.8,77,100,2212,0)
<FDA_END>343</FDA_END>
"DATA",811.8,77,100,2213,0)
<FDA_START>343</FDA_START>
"DATA",811.8,77,100,2214,0)
<FILE_START>334</FILE_START>
"DATA",811.8,77,100,2215,0)
</COMPONENT>
"DATA",811.8,77,100,2216,0)
<COMPONENT>
"DATA",811.8,77,100,2217,0)
<FDA_END>368</FDA_END>
"DATA",811.8,77,100,2218,0)
<FDA_START>356</FDA_START>
"DATA",811.8,77,100,2219,0)
<FILE_START>347</FILE_START>
"DATA",811.8,77,100,2220,0)
</COMPONENT>
"DATA",811.8,77,100,2221,0)
<COMPONENT>
"DATA",811.8,77,100,2222,0)
<FDA_END>382</FDA_END>
"DATA",811.8,77,100,2223,0)
<FDA_START>381</FDA_START>
"DATA",811.8,77,100,2224,0)
<FILE_START>372</FILE_START>
"DATA",811.8,77,100,2225,0)
</COMPONENT>
"DATA",811.8,77,100,2226,0)
<COMPONENT>
"DATA",811.8,77,100,2227,0)
<FDA_END>398</FDA_END>
"DATA",811.8,77,100,2228,0)
<FDA_START>395</FDA_START>
"DATA",811.8,77,100,2229,0)
<FILE_START>386</FILE_START>
"DATA",811.8,77,100,2230,0)
</COMPONENT>
"DATA",811.8,77,100,2231,0)
<COMPONENT>
"DATA",811.8,77,100,2232,0)
<FDA_END>414</FDA_END>
"DATA",811.8,77,100,2233,0)
<FDA_START>411</FDA_START>
"DATA",811.8,77,100,2234,0)
<FILE_START>402</FILE_START>
"DATA",811.8,77,100,2235,0)
</COMPONENT>
"DATA",811.8,77,100,2236,0)
<COMPONENT>
"DATA",811.8,77,100,2237,0)
<FDA_END>430</FDA_END>
"DATA",811.8,77,100,2238,0)
<FDA_START>427</FDA_START>
"DATA",811.8,77,100,2239,0)
<FILE_START>418</FILE_START>
"DATA",811.8,77,100,2240,0)
</COMPONENT>
"DATA",811.8,77,100,2241,0)
<COMPONENT>
"DATA",811.8,77,100,2242,0)
<FDA_END>446</FDA_END>
"DATA",811.8,77,100,2243,0)
<FDA_START>443</FDA_START>
"DATA",811.8,77,100,2244,0)
<FILE_START>434</FILE_START>
"DATA",811.8,77,100,2245,0)
</COMPONENT>
"DATA",811.8,77,100,2246,0)
<COMPONENT>
"DATA",811.8,77,100,2247,0)
<FDA_END>462</FDA_END>
"DATA",811.8,77,100,2248,0)
<FDA_START>459</FDA_START>
"DATA",811.8,77,100,2249,0)
<FILE_START>450</FILE_START>
"DATA",811.8,77,100,2250,0)
</COMPONENT>
"DATA",811.8,77,100,2251,0)
<COMPONENT>
"DATA",811.8,77,100,2252,0)
<FDA_END>478</FDA_END>
"DATA",811.8,77,100,2253,0)
<FDA_START>475</FDA_START>
"DATA",811.8,77,100,2254,0)
<FILE_START>466</FILE_START>
"DATA",811.8,77,100,2255,0)
</COMPONENT>
"DATA",811.8,77,100,2256,0)
<COMPONENT>
"DATA",811.8,77,100,2257,0)
<FDA_END>494</FDA_END>
"DATA",811.8,77,100,2258,0)
<FDA_START>491</FDA_START>
"DATA",811.8,77,100,2259,0)
<FILE_START>482</FILE_START>
"DATA",811.8,77,100,2260,0)
</COMPONENT>
"DATA",811.8,77,100,2261,0)
<COMPONENT>
"DATA",811.8,77,100,2262,0)
<FDA_END>510</FDA_END>
"DATA",811.8,77,100,2263,0)
<FDA_START>507</FDA_START>
"DATA",811.8,77,100,2264,0)
<FILE_START>498</FILE_START>
"DATA",811.8,77,100,2265,0)
</COMPONENT>
"DATA",811.8,77,100,2266,0)
<COMPONENT>
"DATA",811.8,77,100,2267,0)
<FDA_END>527</FDA_END>
"DATA",811.8,77,100,2268,0)
<FDA_START>523</FDA_START>
"DATA",811.8,77,100,2269,0)
<FILE_START>514</FILE_START>
"DATA",811.8,77,100,2270,0)
<IEN_ROOT_END>532</IEN_ROOT_END>
"DATA",811.8,77,100,2271,0)
<IEN_ROOT_START>532</IEN_ROOT_START>
"DATA",811.8,77,100,2272,0)
</COMPONENT>
"DATA",811.8,77,100,2273,0)
<COMPONENT>
"DATA",811.8,77,100,2274,0)
<FDA_END>555</FDA_END>
"DATA",811.8,77,100,2275,0)
<FDA_START>545</FDA_START>
"DATA",811.8,77,100,2276,0)
<FILE_START>536</FILE_START>
"DATA",811.8,77,100,2277,0)
<IEN_ROOT_END>561</IEN_ROOT_END>
"DATA",811.8,77,100,2278,0)
<IEN_ROOT_START>560</IEN_ROOT_START>
"DATA",811.8,77,100,2279,0)
</COMPONENT>
"DATA",811.8,77,100,2280,0)
<COMPONENT>
"DATA",811.8,77,100,2281,0)
<FDA_END>703</FDA_END>
"DATA",811.8,77,100,2282,0)
<FDA_START>574</FDA_START>
"DATA",811.8,77,100,2283,0)
<FILE_START>565</FILE_START>
"DATA",811.8,77,100,2284,0)
<IEN_ROOT_END>708</IEN_ROOT_END>
"DATA",811.8,77,100,2285,0)
<IEN_ROOT_START>708</IEN_ROOT_START>
"DATA",811.8,77,100,2286,0)
</COMPONENT>
"DATA",811.8,77,100,2287,0)
<COMPONENT>
"DATA",811.8,77,100,2288,0)
<FDA_END>757</FDA_END>
"DATA",811.8,77,100,2289,0)
<FDA_START>721</FDA_START>
"DATA",811.8,77,100,2290,0)
<FILE_START>712</FILE_START>
"DATA",811.8,77,100,2291,0)
<IEN_ROOT_END>762</IEN_ROOT_END>
"DATA",811.8,77,100,2292,0)
<IEN_ROOT_START>762</IEN_ROOT_START>
"DATA",811.8,77,100,2293,0)
</COMPONENT>
"DATA",811.8,77,100,2294,0)
<COMPONENT>
"DATA",811.8,77,100,2295,0)
<FDA_END>785</FDA_END>
"DATA",811.8,77,100,2296,0)
<FDA_START>775</FDA_START>
"DATA",811.8,77,100,2297,0)
<FILE_START>766</FILE_START>
"DATA",811.8,77,100,2298,0)
<IEN_ROOT_END>791</IEN_ROOT_END>
"DATA",811.8,77,100,2299,0)
<IEN_ROOT_START>790</IEN_ROOT_START>
"DATA",811.8,77,100,2300,0)
</COMPONENT>
"DATA",811.8,77,100,2301,0)
<COMPONENT>
"DATA",811.8,77,100,2302,0)
<FDA_END>810</FDA_END>
"DATA",811.8,77,100,2303,0)
<FDA_START>804</FDA_START>
"DATA",811.8,77,100,2304,0)
<FILE_START>795</FILE_START>
"DATA",811.8,77,100,2305,0)
<IEN_ROOT_END>816</IEN_ROOT_END>
"DATA",811.8,77,100,2306,0)
<IEN_ROOT_START>815</IEN_ROOT_START>
"DATA",811.8,77,100,2307,0)
</COMPONENT>
"DATA",811.8,77,100,2308,0)
<COMPONENT>
"DATA",811.8,77,100,2309,0)
<FDA_END>835</FDA_END>
"DATA",811.8,77,100,2310,0)
<FDA_START>829</FDA_START>
"DATA",811.8,77,100,2311,0)
<FILE_START>820</FILE_START>
"DATA",811.8,77,100,2312,0)
<IEN_ROOT_END>841</IEN_ROOT_END>
"DATA",811.8,77,100,2313,0)
<IEN_ROOT_START>840</IEN_ROOT_START>
"DATA",811.8,77,100,2314,0)
</COMPONENT>
"DATA",811.8,77,100,2315,0)
<COMPONENT>
"DATA",811.8,77,100,2316,0)
<FDA_END>860</FDA_END>
"DATA",811.8,77,100,2317,0)
<FDA_START>854</FDA_START>
"DATA",811.8,77,100,2318,0)
<FILE_START>845</FILE_START>
"DATA",811.8,77,100,2319,0)
<IEN_ROOT_END>866</IEN_ROOT_END>
"DATA",811.8,77,100,2320,0)
<IEN_ROOT_START>865</IEN_ROOT_START>
"DATA",811.8,77,100,2321,0)
</COMPONENT>
"DATA",811.8,77,100,2322,0)
<COMPONENT>
"DATA",811.8,77,100,2323,0)
<FDA_END>885</FDA_END>
"DATA",811.8,77,100,2324,0)
<FDA_START>879</FDA_START>
"DATA",811.8,77,100,2325,0)
<FILE_START>870</FILE_START>
"DATA",811.8,77,100,2326,0)
<IEN_ROOT_END>891</IEN_ROOT_END>
"DATA",811.8,77,100,2327,0)
<IEN_ROOT_START>890</IEN_ROOT_START>
"DATA",811.8,77,100,2328,0)
</COMPONENT>
"DATA",811.8,77,100,2329,0)
<COMPONENT>
"DATA",811.8,77,100,2330,0)
<FDA_END>910</FDA_END>
"DATA",811.8,77,100,2331,0)
<FDA_START>904</FDA_START>
"DATA",811.8,77,100,2332,0)
<FILE_START>895</FILE_START>
"DATA",811.8,77,100,2333,0)
<IEN_ROOT_END>916</IEN_ROOT_END>
"DATA",811.8,77,100,2334,0)
<IEN_ROOT_START>915</IEN_ROOT_START>
"DATA",811.8,77,100,2335,0)
</COMPONENT>
"DATA",811.8,77,100,2336,0)
<COMPONENT>
"DATA",811.8,77,100,2337,0)
<FDA_END>935</FDA_END>
"DATA",811.8,77,100,2338,0)
<FDA_START>929</FDA_START>
"DATA",811.8,77,100,2339,0)
<FILE_START>920</FILE_START>
"DATA",811.8,77,100,2340,0)
<IEN_ROOT_END>941</IEN_ROOT_END>
"DATA",811.8,77,100,2341,0)
<IEN_ROOT_START>940</IEN_ROOT_START>
"DATA",811.8,77,100,2342,0)
</COMPONENT>
"DATA",811.8,77,100,2343,0)
<COMPONENT>
"DATA",811.8,77,100,2344,0)
<FDA_END>960</FDA_END>
"DATA",811.8,77,100,2345,0)
<FDA_START>954</FDA_START>
"DATA",811.8,77,100,2346,0)
<FILE_START>945</FILE_START>
"DATA",811.8,77,100,2347,0)
<IEN_ROOT_END>966</IEN_ROOT_END>
"DATA",811.8,77,100,2348,0)
<IEN_ROOT_START>965</IEN_ROOT_START>
"DATA",811.8,77,100,2349,0)
</COMPONENT>
"DATA",811.8,77,100,2350,0)
<COMPONENT>
"DATA",811.8,77,100,2351,0)
<FDA_END>987</FDA_END>
"DATA",811.8,77,100,2352,0)
<FDA_START>979</FDA_START>
"DATA",811.8,77,100,2353,0)
<FILE_START>970</FILE_START>
"DATA",811.8,77,100,2354,0)
<IEN_ROOT_END>993</IEN_ROOT_END>
"DATA",811.8,77,100,2355,0)
<IEN_ROOT_START>992</IEN_ROOT_START>
"DATA",811.8,77,100,2356,0)
</COMPONENT>
"DATA",811.8,77,100,2357,0)
<COMPONENT>
"DATA",811.8,77,100,2358,0)
<FDA_END>1032</FDA_END>
"DATA",811.8,77,100,2359,0)
<FDA_START>1006</FDA_START>
"DATA",811.8,77,100,2360,0)
<FILE_START>997</FILE_START>
"DATA",811.8,77,100,2361,0)
<IEN_ROOT_END>1039</IEN_ROOT_END>
"DATA",811.8,77,100,2362,0)
<IEN_ROOT_START>1037</IEN_ROOT_START>
"DATA",811.8,77,100,2363,0)
</COMPONENT>
"DATA",811.8,77,100,2364,0)
<COMPONENT>
"DATA",811.8,77,100,2365,0)
<FDA_END>1064</FDA_END>
"DATA",811.8,77,100,2366,0)
<FDA_START>1052</FDA_START>
"DATA",811.8,77,100,2367,0)
<FILE_START>1043</FILE_START>
"DATA",811.8,77,100,2368,0)
<IEN_ROOT_END>1070</IEN_ROOT_END>
"DATA",811.8,77,100,2369,0)
<IEN_ROOT_START>1069</IEN_ROOT_START>
"DATA",811.8,77,100,2370,0)
</COMPONENT>
"DATA",811.8,77,100,2371,0)
<COMPONENT>
"DATA",811.8,77,100,2372,0)
<FDA_END>1206</FDA_END>
"DATA",811.8,77,100,2373,0)
<FDA_START>1083</FDA_START>
"DATA",811.8,77,100,2374,0)
<FILE_START>1074</FILE_START>
"DATA",811.8,77,100,2375,0)
<IEN_ROOT_END>1223</IEN_ROOT_END>
"DATA",811.8,77,100,2376,0)
<IEN_ROOT_START>1211</IEN_ROOT_START>
"DATA",811.8,77,100,2377,0)
</COMPONENT>
"DATA",811.8,77,100,2378,0)
<COMPONENT>
"DATA",811.8,77,100,2379,0)
<FDA_END>1246</FDA_END>
"DATA",811.8,77,100,2380,0)
<FDA_START>1236</FDA_START>
"DATA",811.8,77,100,2381,0)
<FILE_START>1227</FILE_START>
"DATA",811.8,77,100,2382,0)
<IEN_ROOT_END>1251</IEN_ROOT_END>
"DATA",811.8,77,100,2383,0)
<IEN_ROOT_START>1251</IEN_ROOT_START>
"DATA",811.8,77,100,2384,0)
</COMPONENT>
"DATA",811.8,77,100,2385,0)
<COMPONENT>
"DATA",811.8,77,100,2386,0)
<FDA_END>1277</FDA_END>
"DATA",811.8,77,100,2387,0)
<FDA_START>1264</FDA_START>
"DATA",811.8,77,100,2388,0)
<FILE_START>1255</FILE_START>
"DATA",811.8,77,100,2389,0)
<IEN_ROOT_END>1282</IEN_ROOT_END>
"DATA",811.8,77,100,2390,0)
<IEN_ROOT_START>1282</IEN_ROOT_START>
"DATA",811.8,77,100,2391,0)
</COMPONENT>
"DATA",811.8,77,100,2392,0)
<COMPONENT>
"DATA",811.8,77,100,2393,0)
<FDA_END>1315</FDA_END>
"DATA",811.8,77,100,2394,0)
<FDA_START>1295</FDA_START>
"DATA",811.8,77,100,2395,0)
<FILE_START>1286</FILE_START>
"DATA",811.8,77,100,2396,0)
<IEN_ROOT_END>1321</IEN_ROOT_END>
"DATA",811.8,77,100,2397,0)
<IEN_ROOT_START>1320</IEN_ROOT_START>
"DATA",811.8,77,100,2398,0)
</COMPONENT>
"DATA",811.8,77,100,2399,0)
<COMPONENT>
"DATA",811.8,77,100,2400,0)
<FDA_END>1341</FDA_END>
"DATA",811.8,77,100,2401,0)
<FDA_START>1334</FDA_START>
"DATA",811.8,77,100,2402,0)
<FILE_START>1325</FILE_START>
"DATA",811.8,77,100,2403,0)
<IEN_ROOT_END>1346</IEN_ROOT_END>
"DATA",811.8,77,100,2404,0)
<IEN_ROOT_START>1346</IEN_ROOT_START>
"DATA",811.8,77,100,2405,0)
</COMPONENT>
"DATA",811.8,77,100,2406,0)
<COMPONENT>
"DATA",811.8,77,100,2407,0)
<FDA_END>1372</FDA_END>
"DATA",811.8,77,100,2408,0)
<FDA_START>1359</FDA_START>
"DATA",811.8,77,100,2409,0)
<FILE_START>1350</FILE_START>
"DATA",811.8,77,100,2410,0)
<IEN_ROOT_END>1378</IEN_ROOT_END>
"DATA",811.8,77,100,2411,0)
<IEN_ROOT_START>1377</IEN_ROOT_START>
"DATA",811.8,77,100,2412,0)
</COMPONENT>
"DATA",811.8,77,100,2413,0)
<COMPONENT>
"DATA",811.8,77,100,2414,0)
<FDA_END>1405</FDA_END>
"DATA",811.8,77,100,2415,0)
<FDA_START>1391</FDA_START>
"DATA",811.8,77,100,2416,0)
<FILE_START>1382</FILE_START>
"DATA",811.8,77,100,2417,0)
<IEN_ROOT_END>1411</IEN_ROOT_END>
"DATA",811.8,77,100,2418,0)
<IEN_ROOT_START>1410</IEN_ROOT_START>
"DATA",811.8,77,100,2419,0)
</COMPONENT>
"DATA",811.8,77,100,2420,0)
<COMPONENT>
"DATA",811.8,77,100,2421,0)
<FDA_END>1437</FDA_END>
"DATA",811.8,77,100,2422,0)
<FDA_START>1424</FDA_START>
"DATA",811.8,77,100,2423,0)
<FILE_START>1415</FILE_START>
"DATA",811.8,77,100,2424,0)
<IEN_ROOT_END>1443</IEN_ROOT_END>
"DATA",811.8,77,100,2425,0)
<IEN_ROOT_START>1442</IEN_ROOT_START>
"DATA",811.8,77,100,2426,0)
</COMPONENT>
"DATA",811.8,77,100,2427,0)
<COMPONENT>
"DATA",811.8,77,100,2428,0)
<FDA_END>1470</FDA_END>
"DATA",811.8,77,100,2429,0)
<FDA_START>1456</FDA_START>
"DATA",811.8,77,100,2430,0)
<FILE_START>1447</FILE_START>
"DATA",811.8,77,100,2431,0)
<IEN_ROOT_END>1476</IEN_ROOT_END>
"DATA",811.8,77,100,2432,0)
<IEN_ROOT_START>1475</IEN_ROOT_START>
"DATA",811.8,77,100,2433,0)
</COMPONENT>
"DATA",811.8,77,100,2434,0)
<COMPONENT>
"DATA",811.8,77,100,2435,0)
<FDA_END>1506</FDA_END>
"DATA",811.8,77,100,2436,0)
<FDA_START>1489</FDA_START>
"DATA",811.8,77,100,2437,0)
<FILE_START>1480</FILE_START>
"DATA",811.8,77,100,2438,0)
<IEN_ROOT_END>1513</IEN_ROOT_END>
"DATA",811.8,77,100,2439,0)
<IEN_ROOT_START>1511</IEN_ROOT_START>
"DATA",811.8,77,100,2440,0)
</COMPONENT>
"DATA",811.8,77,100,2441,0)
<COMPONENT>
"DATA",811.8,77,100,2442,0)
<FDA_END>1536</FDA_END>
"DATA",811.8,77,100,2443,0)
<FDA_START>1526</FDA_START>
"DATA",811.8,77,100,2444,0)
<FILE_START>1517</FILE_START>
"DATA",811.8,77,100,2445,0)
<IEN_ROOT_END>1541</IEN_ROOT_END>
"DATA",811.8,77,100,2446,0)
<IEN_ROOT_START>1541</IEN_ROOT_START>
"DATA",811.8,77,100,2447,0)
</COMPONENT>
"DATA",811.8,77,100,2448,0)
<COMPONENT>
"DATA",811.8,77,100,2449,0)
<FDA_END>1570</FDA_END>
"DATA",811.8,77,100,2450,0)
<FDA_START>1554</FDA_START>
"DATA",811.8,77,100,2451,0)
<FILE_START>1545</FILE_START>
"DATA",811.8,77,100,2452,0)
<IEN_ROOT_END>1576</IEN_ROOT_END>
"DATA",811.8,77,100,2453,0)
<IEN_ROOT_START>1575</IEN_ROOT_START>
"DATA",811.8,77,100,2454,0)
</COMPONENT>
"DATA",811.8,77,100,2455,0)
<COMPONENT>
"DATA",811.8,77,100,2456,0)
<FDA_END>1599</FDA_END>
"DATA",811.8,77,100,2457,0)
<FDA_START>1589</FDA_START>
"DATA",811.8,77,100,2458,0)
<FILE_START>1580</FILE_START>
"DATA",811.8,77,100,2459,0)
<IEN_ROOT_END>1604</IEN_ROOT_END>
"DATA",811.8,77,100,2460,0)
<IEN_ROOT_START>1604</IEN_ROOT_START>
"DATA",811.8,77,100,2461,0)
</COMPONENT>
"DATA",811.8,77,100,2462,0)
<COMPONENT>
"DATA",811.8,77,100,2463,0)
<FDA_END>1629</FDA_END>
"DATA",811.8,77,100,2464,0)
<FDA_START>1617</FDA_START>
"DATA",811.8,77,100,2465,0)
<FILE_START>1608</FILE_START>
"DATA",811.8,77,100,2466,0)
<IEN_ROOT_END>1635</IEN_ROOT_END>
"DATA",811.8,77,100,2467,0)
<IEN_ROOT_START>1634</IEN_ROOT_START>
"DATA",811.8,77,100,2468,0)
</COMPONENT>
"DATA",811.8,77,100,2469,0)
<COMPONENT>
"DATA",811.8,77,100,2470,0)
<FDA_END>1664</FDA_END>
"DATA",811.8,77,100,2471,0)
<FDA_START>1648</FDA_START>
"DATA",811.8,77,100,2472,0)
<FILE_START>1639</FILE_START>
"DATA",811.8,77,100,2473,0)
<IEN_ROOT_END>1670</IEN_ROOT_END>
"DATA",811.8,77,100,2474,0)
<IEN_ROOT_START>1669</IEN_ROOT_START>
"DATA",811.8,77,100,2475,0)
</COMPONENT>
"DATA",811.8,77,100,2476,0)
<COMPONENT>
"DATA",811.8,77,100,2477,0)
<FDA_END>1692</FDA_END>
"DATA",811.8,77,100,2478,0)
<FDA_START>1683</FDA_START>
"DATA",811.8,77,100,2479,0)
<FILE_START>1674</FILE_START>
"DATA",811.8,77,100,2480,0)
<IEN_ROOT_END>1697</IEN_ROOT_END>
"DATA",811.8,77,100,2481,0)
<IEN_ROOT_START>1697</IEN_ROOT_START>
"DATA",811.8,77,100,2482,0)
</COMPONENT>
"DATA",811.8,77,100,2483,0)
<COMPONENT>
"DATA",811.8,77,100,2484,0)
<FDA_END>1718</FDA_END>
"DATA",811.8,77,100,2485,0)
<FDA_START>1710</FDA_START>
"DATA",811.8,77,100,2486,0)
<FILE_START>1701</FILE_START>
"DATA",811.8,77,100,2487,0)
<IEN_ROOT_END>1723</IEN_ROOT_END>
"DATA",811.8,77,100,2488,0)
<IEN_ROOT_START>1723</IEN_ROOT_START>
"DATA",811.8,77,100,2489,0)
</COMPONENT>
"DATA",811.8,77,100,2490,0)
<COMPONENT>
"DATA",811.8,77,100,2491,0)
<FDA_END>1744</FDA_END>
"DATA",811.8,77,100,2492,0)
<FDA_START>1736</FDA_START>
"DATA",811.8,77,100,2493,0)
<FILE_START>1727</FILE_START>
"DATA",811.8,77,100,2494,0)
<IEN_ROOT_END>1749</IEN_ROOT_END>
"DATA",811.8,77,100,2495,0)
<IEN_ROOT_START>1749</IEN_ROOT_START>
"DATA",811.8,77,100,2496,0)
</COMPONENT>
"DATA",811.8,77,100,2497,0)
<COMPONENT>
"DATA",811.8,77,100,2498,0)
<FDA_END>1784</FDA_END>
"DATA",811.8,77,100,2499,0)
<FDA_START>1762</FDA_START>
"DATA",811.8,77,100,2500,0)
<FILE_START>1753</FILE_START>
"DATA",811.8,77,100,2501,0)
<IEN_ROOT_END>1793</IEN_ROOT_END>
"DATA",811.8,77,100,2502,0)
<IEN_ROOT_START>1789</IEN_ROOT_START>
"DATA",811.8,77,100,2503,0)
</COMPONENT>
"DATA",811.8,77,100,2504,0)
<COMPONENT>
"DATA",811.8,77,100,2505,0)
<FDA_END>1819</FDA_END>
"DATA",811.8,77,100,2506,0)
<FDA_START>1806</FDA_START>
"DATA",811.8,77,100,2507,0)
<FILE_START>1797</FILE_START>
"DATA",811.8,77,100,2508,0)
<IEN_ROOT_END>1825</IEN_ROOT_END>
"DATA",811.8,77,100,2509,0)
<IEN_ROOT_START>1824</IEN_ROOT_START>
"DATA",811.8,77,100,2510,0)
</COMPONENT>
"DATA",811.8,77,100,2511,0)
<COMPONENT>
"DATA",811.8,77,100,2512,0)
<FDA_END>1851</FDA_END>
"DATA",811.8,77,100,2513,0)
<FDA_START>1838</FDA_START>
"DATA",811.8,77,100,2514,0)
<FILE_START>1829</FILE_START>
"DATA",811.8,77,100,2515,0)
<IEN_ROOT_END>1857</IEN_ROOT_END>
"DATA",811.8,77,100,2516,0)
<IEN_ROOT_START>1856</IEN_ROOT_START>
"DATA",811.8,77,100,2517,0)
</COMPONENT>
"DATA",811.8,77,100,2518,0)
<COMPONENT>
"DATA",811.8,77,100,2519,0)
<FDA_END>1882</FDA_END>
"DATA",811.8,77,100,2520,0)
<FDA_START>1870</FDA_START>
"DATA",811.8,77,100,2521,0)
<FILE_START>1861</FILE_START>
"DATA",811.8,77,100,2522,0)
<IEN_ROOT_END>1887</IEN_ROOT_END>
"DATA",811.8,77,100,2523,0)
<IEN_ROOT_START>1887</IEN_ROOT_START>
"DATA",811.8,77,100,2524,0)
</COMPONENT>
"DATA",811.8,77,100,2525,0)
<COMPONENT>
"DATA",811.8,77,100,2526,0)
<FDA_END>1917</FDA_END>
"DATA",811.8,77,100,2527,0)
<FDA_START>1900</FDA_START>
"DATA",811.8,77,100,2528,0)
<FILE_START>1891</FILE_START>
"DATA",811.8,77,100,2529,0)
<IEN_ROOT_END>1923</IEN_ROOT_END>
"DATA",811.8,77,100,2530,0)
<IEN_ROOT_START>1922</IEN_ROOT_START>
"DATA",811.8,77,100,2531,0)
</COMPONENT>
"DATA",811.8,77,100,2532,0)
<COMPONENT>
"DATA",811.8,77,100,2533,0)
<FDA_END>1952</FDA_END>
"DATA",811.8,77,100,2534,0)
<FDA_START>1936</FDA_START>
"DATA",811.8,77,100,2535,0)
<FILE_START>1927</FILE_START>
"DATA",811.8,77,100,2536,0)
<IEN_ROOT_END>1957</IEN_ROOT_END>
"DATA",811.8,77,100,2537,0)
<IEN_ROOT_START>1957</IEN_ROOT_START>
"DATA",811.8,77,100,2538,0)
</COMPONENT>
"DATA",811.8,77,100,2539,0)
<COMPONENT>
"DATA",811.8,77,100,2540,0)
<FDA_END>1997</FDA_END>
"DATA",811.8,77,100,2541,0)
<FDA_START>1970</FDA_START>
"DATA",811.8,77,100,2542,0)
<FILE_START>1961</FILE_START>
"DATA",811.8,77,100,2543,0)
<IEN_ROOT_END>2012</IEN_ROOT_END>
"DATA",811.8,77,100,2544,0)
<IEN_ROOT_START>2002</IEN_ROOT_START>
"DATA",811.8,77,100,2545,0)
</COMPONENT>
"DATA",811.8,77,100,2546,0)
<COMPONENT>
"DATA",811.8,77,100,2547,0)
<FDA_END>2032</FDA_END>
"DATA",811.8,77,100,2548,0)
<FDA_START>2025</FDA_START>
"DATA",811.8,77,100,2549,0)
<FILE_START>2016</FILE_START>
"DATA",811.8,77,100,2550,0)
</COMPONENT>
"DATA",811.8,77,100,2551,0)
<COMPONENT>
"DATA",811.8,77,100,2552,0)
<FDA_END>2054</FDA_END>
"DATA",811.8,77,100,2553,0)
<FDA_START>2045</FDA_START>
"DATA",811.8,77,100,2554,0)
<FILE_START>2036</FILE_START>
"DATA",811.8,77,100,2555,0)
</COMPONENT>
"DATA",811.8,77,100,2556,0)
<COMPONENT>
"DATA",811.8,77,100,2557,0)
<FDA_END>2075</FDA_END>
"DATA",811.8,77,100,2558,0)
<FDA_START>2067</FDA_START>
"DATA",811.8,77,100,2559,0)
<FILE_START>2058</FILE_START>
"DATA",811.8,77,100,2560,0)
</COMPONENT>
"DATA",811.8,77,100,2561,0)
<COMPONENT>
"DATA",811.8,77,100,2562,0)
<FDA_END>2097</FDA_END>
"DATA",811.8,77,100,2563,0)
<FDA_START>2088</FDA_START>
"DATA",811.8,77,100,2564,0)
<FILE_START>2079</FILE_START>
"DATA",811.8,77,100,2565,0)
</COMPONENT>
"DATA",811.8,77,100,2566,0)
<COMPONENT>
"DATA",811.8,77,100,2567,0)
<FDA_END>2126</FDA_END>
"DATA",811.8,77,100,2568,0)
<FDA_START>2110</FDA_START>
"DATA",811.8,77,100,2569,0)
<FILE_START>2101</FILE_START>
"DATA",811.8,77,100,2570,0)
<IEN_ROOT_END>2134</IEN_ROOT_END>
"DATA",811.8,77,100,2571,0)
<IEN_ROOT_START>2131</IEN_ROOT_START>
"DATA",811.8,77,100,2572,0)
</COMPONENT>
"DATA",811.8,77,100,2573,0)
<COMPONENT>
"DATA",811.8,77,100,2574,0)
<FDA_END>2163</FDA_END>
"DATA",811.8,77,100,2575,0)
<FDA_START>2147</FDA_START>
"DATA",811.8,77,100,2576,0)
<FILE_START>2138</FILE_START>
"DATA",811.8,77,100,2577,0)
</COMPONENT>
"DATA",811.8,77,100,2578,0)
<COMPONENT>
"DATA",811.8,77,100,2579,0)
<FDA_END>2182</FDA_END>
"DATA",811.8,77,100,2580,0)
<FDA_START>2176</FDA_START>
"DATA",811.8,77,100,2581,0)
<FILE_START>2167</FILE_START>
"DATA",811.8,77,100,2582,0)
</COMPONENT>
"DATA",811.8,77,100,2583,0)
<COMPONENT>
"DATA",811.8,77,100,2584,0)
<FDA_END>2195</FDA_END>
"DATA",811.8,77,100,2585,0)
<FDA_START>2195</FDA_START>
"DATA",811.8,77,100,2586,0)
<FILE_START>2186</FILE_START>
"DATA",811.8,77,100,2587,0)
</COMPONENT>
"DATA",811.8,77,100,2588,0)
</INDEX>
"DATA",811.8,77,100,2589,0)
</REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,77,110,0)
^811.804^29^29
"DATA",811.8,77,110,1,0)
Source:      TROST,DEBBIE at SALT LAKE CITY OIFO
"DATA",811.8,77,110,2,0)
Date Packed: 12/06/2012@15:23:02
"DATA",811.8,77,110,3,0)
Package Version: 2.0P27
"DATA",811.8,77,110,4,0)

"DATA",811.8,77,110,5,0)
Description:
"DATA",811.8,77,110,6,0)
This reminder shall determine whether Mental Health (MH) professionals
"DATA",811.8,77,110,7,0)
have followed up on a No-Show MH appointment for a patient with an active
"DATA",811.8,77,110,8,0)
High Risk for Suicide Patient Record Flag. 
"DATA",811.8,77,110,9,0)
 
"DATA",811.8,77,110,10,0)
The reminder requires clinicians to initiate follow-up with the patient to
"DATA",811.8,77,110,11,0)
insure his/her safety and to try to get the patient back into care. The
"DATA",811.8,77,110,12,0)
follow-up results are documented with health factors.  
"DATA",811.8,77,110,13,0)
 
"DATA",811.8,77,110,14,0)
Studies show that individuals that get lost to follow-up have a higher 
"DATA",811.8,77,110,15,0)
rate of actual suicide than those that stay connected with care.
"DATA",811.8,77,110,16,0)
 
"DATA",811.8,77,110,17,0)
If the patient has a completed encounter to a MH appointment on the same
"DATA",811.8,77,110,18,0)
day, or within 72 hours of the missed MH appointment, follow-up will no
"DATA",811.8,77,110,19,0)
longer be necessary.
"DATA",811.8,77,110,20,0)
Non-exchangeable TIU object(s):
"DATA",811.8,77,110,21,0)
-------------------------------------------------------------------------------
"DATA",811.8,77,110,22,0)
TIU Object: MH MISSED APPOINTMENTS 10D
"DATA",811.8,77,110,23,0)
Object Method: S X=$$MSTAPPT^TIULO1(DFN,"^TMP(""TIU APPT"",$J)")
"DATA",811.8,77,110,24,0)

"DATA",811.8,77,110,25,0)
-------------------------------------------------------------------------------
"DATA",811.8,77,110,26,0)

"DATA",811.8,77,110,27,0)
Keywords:
"DATA",811.8,77,110,28,0)

"DATA",811.8,77,110,29,0)
Components:
"DATA",811.8,180,0)
VA-MH NO SHOW APPT CLINICS LL^TROST,DEBBIE at SALT LAKE CITY OIFO^3111005.124359
"DATA",811.8,180,100,0)
^811.801^197^197
"DATA",811.8,180,100,1,0)
<?xml version="1.0" standalone="yes"?>
"DATA",811.8,180,100,2,0)
<REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,180,100,3,0)
<PACKAGE_VERSION>2.0P20</PACKAGE_VERSION>
"DATA",811.8,180,100,4,0)
<INDEX_AT>187</INDEX_AT>
"DATA",811.8,180,100,5,0)
<SOURCE>
"DATA",811.8,180,100,6,0)
<NAME>VA-MH NO SHOW APPT CLINICS LL</NAME>
"DATA",811.8,180,100,7,0)
<USER>TROST,DEBBIE</USER>
"DATA",811.8,180,100,8,0)
<SITE>SALT LAKE CITY OIFO</SITE>
"DATA",811.8,180,100,9,0)
<DATE_PACKED>10/05/2011@12:43:59</DATE_PACKED>
"DATA",811.8,180,100,10,0)
</SOURCE>
"DATA",811.8,180,100,11,0)
<DESCRIPTION><![CDATA[
"DATA",811.8,180,100,12,0)
The VA-MH NO SHOW APPT CLINICS LL location list includes clinic stop codes
"DATA",811.8,180,100,13,0)
for MH clinics that are scheduled for face-to-face appointments. 
"DATA",811.8,180,100,14,0)
]]></DESCRIPTION>
"DATA",811.8,180,100,15,0)
<KEYWORDS>
"DATA",811.8,180,100,16,0)
</KEYWORDS>
"DATA",811.8,180,100,17,0)
<FILEMAN_FILE>
"DATA",811.8,180,100,18,0)
<FILE_NAME>REMINDER LOCATION LIST</FILE_NAME>
"DATA",811.8,180,100,19,0)
<FILE_NUMBER>810.9</FILE_NUMBER>
"DATA",811.8,180,100,20,0)
<POINT_01>VA-MH NO SHOW APPT CLINICS LL</POINT_01>
"DATA",811.8,180,100,21,0)
<INTERNAL_ENTRY_NUMBER>33</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,180,100,22,0)
<CHECKSUM>1027727089</CHECKSUM>
"DATA",811.8,180,100,23,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,180,100,24,0)
<FILEMAN_FDA>
"DATA",811.8,180,100,25,0)
<![CDATA[
"DATA",811.8,180,100,26,0)
810.9;+33,;.01~VA-MH NO SHOW APPT CLINICS LL
"DATA",811.8,180,100,27,0)
810.9;+33,;1~WP-start~2
"DATA",811.8,180,100,28,0)
The VA-MH NO SHOW APPT CLINICS LL location list includes clinic stop codes
"DATA",811.8,180,100,29,0)
for MH clinics that are scheduled for face-to-face appointments. 
"DATA",811.8,180,100,30,0)
810.9;+33,;100~NATIONAL
"DATA",811.8,180,100,31,0)
810.9;+33,;101~Office of Mental Health Services
"DATA",811.8,180,100,32,0)
810.9001;+34,+33,;.01~MENTAL HEALTH CLINIC - IND
"DATA",811.8,180,100,33,0)
810.9001;+34,+33,;.02~502
"DATA",811.8,180,100,34,0)
810.9001;+35,+33,;.01~PTSD - GROUP
"DATA",811.8,180,100,35,0)
810.9001;+35,+33,;.02~516
"DATA",811.8,180,100,36,0)
810.9001;+36,+33,;.01~SUBST USE DISORDER/PTSD TEAMS
"DATA",811.8,180,100,37,0)
810.9001;+36,+33,;.02~519
"DATA",811.8,180,100,38,0)
810.9001;+37,+33,;.01~ACTIVE DUTY SEXUAL TRAUMA
"DATA",811.8,180,100,39,0)
810.9001;+37,+33,;.02~524
"DATA",811.8,180,100,40,0)
810.9001;+38,+33,;.01~WOMEN'S STRESS DISORDER TEAMS
"DATA",811.8,180,100,41,0)
810.9001;+38,+33,;.02~525
"DATA",811.8,180,100,42,0)
810.9001;+39,+33,;.01~HCHV/HCMI INDIV
"DATA",811.8,180,100,43,0)
810.9001;+39,+33,;.02~529
"DATA",811.8,180,100,44,0)
810.9001;+40,+33,;.01~MH RESIDENTIAL CARE IND
"DATA",811.8,180,100,45,0)
810.9001;+40,+33,;.02~503
"DATA",811.8,180,100,46,0)
810.9001;+41,+33,;.01~PSYCHOSOCIAL REHAB - IND
"DATA",811.8,180,100,47,0)
810.9001;+41,+33,;.02~532
"DATA",811.8,180,100,48,0)
810.9001;+42,+33,;.01~MH INTGRTD CARE IND
"DATA",811.8,180,100,49,0)
810.9001;+42,+33,;.02~534
"DATA",811.8,180,100,50,0)
810.9001;+43,+33,;.01~MH VOCATIONAL ASSISTANCE - IND
"DATA",811.8,180,100,51,0)
810.9001;+43,+33,;.02~535
"DATA",811.8,180,100,52,0)
810.9001;+44,+33,;.01~PSYCHOLOGICAL TESTING
"DATA",811.8,180,100,53,0)
810.9001;+44,+33,;.02~538
"DATA",811.8,180,100,54,0)
810.9001;+45,+33,;.01~MH INTGRTD CARE GRP
"DATA",811.8,180,100,55,0)
810.9001;+45,+33,;.02~539
"DATA",811.8,180,100,56,0)
810.9001;+46,+33,;.01~PTSD CLINICAL TEAM PTS IND
"DATA",811.8,180,100,57,0)
810.9001;+46,+33,;.02~540
"DATA",811.8,180,100,58,0)
810.9001;+47,+33,;.01~DAY TREATMENT-INDIVIDUAL
"DATA",811.8,180,100,59,0)
810.9001;+47,+33,;.02~505
"DATA",811.8,180,100,60,0)
810.9001;+48,+33,;.01~INTNSE SUB USE DSRDER GRP
"DATA",811.8,180,100,61,0)
810.9001;+48,+33,;.02~547
"DATA",811.8,180,100,62,0)
810.9001;+49,+33,;.01~INTNSE SUB USE DSRDER IND
"DATA",811.8,180,100,63,0)
810.9001;+49,+33,;.02~548
"DATA",811.8,180,100,64,0)
810.9001;+50,+33,;.01~MENTAL HEALTH CLINIC-GROUP
"DATA",811.8,180,100,65,0)
810.9001;+50,+33,;.02~550
"DATA",811.8,180,100,66,0)
810.9001;+51,+33,;.01~MHICM - INDIVIDUAL
"DATA",811.8,180,100,67,0)
810.9001;+51,+33,;.02~552
"DATA",811.8,180,100,68,0)
810.9001;+52,+33,;.01~DAY TREATMENT-GROUP
"DATA",811.8,180,100,69,0)
810.9001;+52,+33,;.02~553
"DATA",811.8,180,100,70,0)
810.9001;+53,+33,;.01~DAY HOSPITAL-GROUP
"DATA",811.8,180,100,71,0)
810.9001;+53,+33,;.02~554
"DATA",811.8,180,100,72,0)
810.9001;+54,+33,;.01~PSYCHIATRY - GROUP
"DATA",811.8,180,100,73,0)
810.9001;+54,+33,;.02~557
"DATA",811.8,180,100,74,0)
810.9001;+55,+33,;.01~PSYCHOLOGY-GROUP
"DATA",811.8,180,100,75,0)
810.9001;+55,+33,;.02~558
"DATA",811.8,180,100,76,0)
810.9001;+56,+33,;.01~PSYCHOSOCIAL REHAB - GROUP
"DATA",811.8,180,100,77,0)
810.9001;+56,+33,;.02~559
"DATA",811.8,180,100,78,0)
810.9001;+57,+33,;.01~SUBSTANCE USE DISORDR GRP
"DATA",811.8,180,100,79,0)
810.9001;+57,+33,;.02~560
"DATA",811.8,180,100,80,0)
810.9001;+58,+33,;.01~DAY HOSPITAL-INDIVIDUAL
"DATA",811.8,180,100,81,0)
810.9001;+58,+33,;.02~506
"DATA",811.8,180,100,82,0)
810.9001;+59,+33,;.01~PCT-POST TRAUMATIC STRESS-GRP
"DATA",811.8,180,100,83,0)
810.9001;+59,+33,;.02~561
"DATA",811.8,180,100,84,0)
810.9001;+60,+33,;.01~PTSD - INDIVIDUAL
"DATA",811.8,180,100,85,0)
810.9001;+60,+33,;.02~562
"DATA",811.8,180,100,86,0)
810.9001;+61,+33,;.01~MHICM - GROUP
"DATA",811.8,180,100,87,0)
810.9001;+61,+33,;.02~567
"DATA",811.8,180,100,88,0)
810.9001;+62,+33,;.01~MH CWT/SE FACE TO FACE
"DATA",811.8,180,100,89,0)
810.9001;+62,+33,;.02~568
"DATA",811.8,180,100,90,0)
810.9001;+63,+33,;.01~SERV-MH INDIVIDUAL
"DATA",811.8,180,100,91,0)
810.9001;+63,+33,;.02~571
"DATA",811.8,180,100,92,0)
810.9001;+64,+33,;.01~SERV-MH GROUP
"DATA",811.8,180,100,93,0)
810.9001;+64,+33,;.02~572
"DATA",811.8,180,100,94,0)
810.9001;+65,+33,;.01~MH INCENTIVE THERAPY F TO F
"DATA",811.8,180,100,95,0)
810.9001;+65,+33,;.02~573
"DATA",811.8,180,100,96,0)
810.9001;+66,+33,;.01~MH CWT/TWE FACE TO FACE
"DATA",811.8,180,100,97,0)
810.9001;+66,+33,;.02~574
"DATA",811.8,180,100,98,0)
810.9001;+67,+33,;.01~MH VOCATIONAL ASSISTANCE-GRP
"DATA",811.8,180,100,99,0)
810.9001;+67,+33,;.02~575
"DATA",811.8,180,100,100,0)
810.9001;+68,+33,;.01~PSYCHIATRY - INDIVIDUAL
"DATA",811.8,180,100,101,0)
810.9001;+68,+33,;.02~509
"DATA",811.8,180,100,102,0)
810.9001;+69,+33,;.01~PSYCHOGERIATRIC - INDIVIDUAL
"DATA",811.8,180,100,103,0)
810.9001;+69,+33,;.02~576
"DATA",811.8,180,100,104,0)
810.9001;+70,+33,;.01~PSYCHOGERIATRIC - GROUP
"DATA",811.8,180,100,105,0)
810.9001;+70,+33,;.02~577
"DATA",811.8,180,100,106,0)
810.9001;+71,+33,;.01~PTSD DAY HOSPITAL
"DATA",811.8,180,100,107,0)
810.9001;+71,+33,;.02~580
"DATA",811.8,180,100,108,0)
810.9001;+72,+33,;.01~PRRC INDIVIDUAL
"DATA",811.8,180,100,109,0)
810.9001;+72,+33,;.02~582
"DATA",811.8,180,100,110,0)
810.9001;+73,+33,;.01~PRRC GROUP
"DATA",811.8,180,100,111,0)
810.9001;+73,+33,;.02~583
"DATA",811.8,180,100,112,0)
810.9001;+74,+33,;.01~RRTP AFTERCARE IND
"DATA",811.8,180,100,113,0)
810.9001;+74,+33,;.02~588
"DATA",811.8,180,100,114,0)
810.9001;+75,+33,;.01~PSYCHOLOGY-INDIVIDUAL
"DATA",811.8,180,100,115,0)
810.9001;+75,+33,;.02~510
"DATA",811.8,180,100,116,0)
810.9001;+76,+33,;.01~RRTP AFTERCARE GRP
"DATA",811.8,180,100,117,0)
810.9001;+76,+33,;.02~595
"DATA",811.8,180,100,118,0)
810.9001;+77,+33,;.01~RRTP ADMISSION SCREENING SRVCS
"DATA",811.8,180,100,119,0)
810.9001;+77,+33,;.02~596
"DATA",811.8,180,100,120,0)
810.9001;+78,+33,;.01~RRTP PRE-ADMIT IND
"DATA",811.8,180,100,121,0)
810.9001;+78,+33,;.02~598
"DATA",811.8,180,100,122,0)
810.9001;+79,+33,;.01~RRTP PRE-ADMIT GRP
"DATA",811.8,180,100,123,0)
810.9001;+79,+33,;.02~599
"DATA",811.8,180,100,124,0)
810.9001;+80,+33,;.01~MENTAL HEALTH CONSULTATION
"DATA",811.8,180,100,125,0)
810.9001;+80,+33,;.02~512
"DATA",811.8,180,100,126,0)
810.9001;+81,+33,;.01~SUBSTANCE USE DISORDER IND
"DATA",811.8,180,100,127,0)
810.9001;+81,+33,;.02~513
"DATA",811.8,180,100,128,0)
810.9002;+82,+33,;.01~10/05/2011@12:44:36
"DATA",811.8,180,100,129,0)
810.9002;+82,+33,;2~WP-start~1
"DATA",811.8,180,100,130,0)
Exchange Stub
"DATA",811.8,180,100,131,0)
]]>
"DATA",811.8,180,100,132,0)
</FILEMAN_FDA>
"DATA",811.8,180,100,133,0)
<IEN_ROOT>
"DATA",811.8,180,100,134,0)
<![CDATA[
"DATA",811.8,180,100,135,0)
34^1
"DATA",811.8,180,100,136,0)
35^10
"DATA",811.8,180,100,137,0)
36^11
"DATA",811.8,180,100,138,0)
37^14
"DATA",811.8,180,100,139,0)
38^15
"DATA",811.8,180,100,140,0)
39^18
"DATA",811.8,180,100,141,0)
40^2
"DATA",811.8,180,100,142,0)
41^20
"DATA",811.8,180,100,143,0)
42^21
"DATA",811.8,180,100,144,0)
43^22
"DATA",811.8,180,100,145,0)
44^24
"DATA",811.8,180,100,146,0)
45^25
"DATA",811.8,180,100,147,0)
46^26
"DATA",811.8,180,100,148,0)
47^3
"DATA",811.8,180,100,149,0)
48^30
"DATA",811.8,180,100,150,0)
49^31
"DATA",811.8,180,100,151,0)
50^32
"DATA",811.8,180,100,152,0)
51^33
"DATA",811.8,180,100,153,0)
52^34
"DATA",811.8,180,100,154,0)
53^35
"DATA",811.8,180,100,155,0)
54^36
"DATA",811.8,180,100,156,0)
55^37
"DATA",811.8,180,100,157,0)
56^38
"DATA",811.8,180,100,158,0)
57^39
"DATA",811.8,180,100,159,0)
58^4
"DATA",811.8,180,100,160,0)
59^40
"DATA",811.8,180,100,161,0)
60^41
"DATA",811.8,180,100,162,0)
61^43
"DATA",811.8,180,100,163,0)
62^44
"DATA",811.8,180,100,164,0)
63^45
"DATA",811.8,180,100,165,0)
64^46
"DATA",811.8,180,100,166,0)
65^47
"DATA",811.8,180,100,167,0)
66^48
"DATA",811.8,180,100,168,0)
67^49
"DATA",811.8,180,100,169,0)
68^5
"DATA",811.8,180,100,170,0)
69^50
"DATA",811.8,180,100,171,0)
70^51
"DATA",811.8,180,100,172,0)
71^53
"DATA",811.8,180,100,173,0)
72^54
"DATA",811.8,180,100,174,0)
73^55
"DATA",811.8,180,100,175,0)
74^57
"DATA",811.8,180,100,176,0)
75^6
"DATA",811.8,180,100,177,0)
76^62
"DATA",811.8,180,100,178,0)
77^63
"DATA",811.8,180,100,179,0)
78^65
"DATA",811.8,180,100,180,0)
79^66
"DATA",811.8,180,100,181,0)
80^7
"DATA",811.8,180,100,182,0)
81^8
"DATA",811.8,180,100,183,0)
82^1
"DATA",811.8,180,100,184,0)
]]>
"DATA",811.8,180,100,185,0)
</IEN_ROOT>
"DATA",811.8,180,100,186,0)
</FILEMAN_FILE>
"DATA",811.8,180,100,187,0)
<INDEX>
"DATA",811.8,180,100,188,0)
<NUMBER_OF_COMPONENTS>1</NUMBER_OF_COMPONENTS>
"DATA",811.8,180,100,189,0)
<COMPONENT>
"DATA",811.8,180,100,190,0)
<FDA_END>130</FDA_END>
"DATA",811.8,180,100,191,0)
<FDA_START>26</FDA_START>
"DATA",811.8,180,100,192,0)
<FILE_START>17</FILE_START>
"DATA",811.8,180,100,193,0)
<IEN_ROOT_END>183</IEN_ROOT_END>
"DATA",811.8,180,100,194,0)
<IEN_ROOT_START>135</IEN_ROOT_START>
"DATA",811.8,180,100,195,0)
</COMPONENT>
"DATA",811.8,180,100,196,0)
</INDEX>
"DATA",811.8,180,100,197,0)
</REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,180,110,0)
^811.804^11^11
"DATA",811.8,180,110,1,0)
Source:      TROST,DEBBIE at SALT LAKE CITY OIFO
"DATA",811.8,180,110,2,0)
Date Packed: 10/05/2011@12:43:59
"DATA",811.8,180,110,3,0)
Package Version: 2.0P20
"DATA",811.8,180,110,4,0)

"DATA",811.8,180,110,5,0)
Description:
"DATA",811.8,180,110,6,0)
The VA-MH NO SHOW APPT CLINICS LL location list includes clinic stop codes
"DATA",811.8,180,110,7,0)
for MH clinics that are scheduled for face-to-face appointments. 
"DATA",811.8,180,110,8,0)

"DATA",811.8,180,110,9,0)
Keywords:
"DATA",811.8,180,110,10,0)

"DATA",811.8,180,110,11,0)
Components:
"DATA",811.8,180,119)
1
"DATA",811.8,180,120,0)
^811.802A^1^1
"DATA",811.8,180,120,1,0)
REMINDER LOCATION LIST^810.9^1
"DATA",811.8,180,120,1,1,0)
^811.8021A^1^1
"DATA",811.8,180,120,1,1,1,0)
VA-MH NO SHOW APPT CLINICS LL^26^130^135^183^1^1
"DATA",811.8,180,130,0)
^811.803DA^2^2
"DATA",811.8,180,130,1,0)
3120406.100819^MASSEY,RON^SILENT
"DATA",811.8,180,130,1,1,0)
^811.8031A^1^1
"DATA",811.8,180,130,1,1,1,0)
1^REMINDER LOCATION LIST^VA-MH NO SHOW APPT CLINICS LL^S^
"DATA",811.8,180,130,2,0)
3121116.084735^TROST,DEBBIE^INTERACTIVE
"DATA",811.8,180,130,2,1,0)
^811.8031A^1^1
"DATA",811.8,180,130,2,1,1,0)
1^REMINDER LOCATION LIST^VA-MH NO SHOW APPT CLINICS LL^S^
"DATA",811.8,189,0)
VA-MHTC NEEDS ASSIGNMENT^TROST,DEBBIE at SALT LAKE CITY OIFO^3121206.152354
"DATA",811.8,189,100,0)
^811.801^980^980
"DATA",811.8,189,100,1,0)
<?xml version="1.0" standalone="yes"?>
"DATA",811.8,189,100,2,0)
<REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,189,100,3,0)
<PACKAGE_VERSION>2.0P27</PACKAGE_VERSION>
"DATA",811.8,189,100,4,0)
<INDEX_AT>906</INDEX_AT>
"DATA",811.8,189,100,5,0)
<SOURCE>
"DATA",811.8,189,100,6,0)
<NAME>VA-MHTC NEEDS ASSIGNMENT</NAME>
"DATA",811.8,189,100,7,0)
<USER>TROST,DEBBIE</USER>
"DATA",811.8,189,100,8,0)
<SITE>SALT LAKE CITY OIFO</SITE>
"DATA",811.8,189,100,9,0)
<DATE_PACKED>12/06/2012@15:23:54</DATE_PACKED>
"DATA",811.8,189,100,10,0)
</SOURCE>
"DATA",811.8,189,100,11,0)
<DESCRIPTION><![CDATA[
"DATA",811.8,189,100,12,0)
This reminder shall determine whether a patient has been assigned a 
"DATA",811.8,189,100,13,0)
Mental Health Treatment Coordinator (MHTC) when the patient has kept
"DATA",811.8,189,100,14,0)
3 or more MH appointments in the past year, where the appointment is
"DATA",811.8,189,100,15,0)
checked out and a completed encounter has been documented.
"DATA",811.8,189,100,16,0)
]]></DESCRIPTION>
"DATA",811.8,189,100,17,0)
<KEYWORDS>
"DATA",811.8,189,100,18,0)
</KEYWORDS>
"DATA",811.8,189,100,19,0)
<M_ROUTINE>
"DATA",811.8,189,100,20,0)
<ROUTINE_NAME>PXRMPCMM</ROUTINE_NAME>
"DATA",811.8,189,100,21,0)
<CHECKSUM>641019475</CHECKSUM>
"DATA",811.8,189,100,22,0)
<CODE>
"DATA",811.8,189,100,23,0)
<![CDATA[
"DATA",811.8,189,100,24,0)
PXRMPCMM ;SLC/PKR - Computed findings for PCMM. ;07/01/2012
"DATA",811.8,189,100,25,0)
 ;;2.0;CLINICAL REMINDERS;**18,24**;Feb 04, 2005
"DATA",811.8,189,100,26,0)
 ;References to SCAPMC supported by DBIA #1916.
"DATA",811.8,189,100,27,0)
 ;====================================
"DATA",811.8,189,100,28,0)
INSTPCTM(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM PC TEAM
"DATA",811.8,189,100,29,0)
 ;INSTITUTION computed finding. Return the institution and team for
"DATA",811.8,189,100,30,0)
 ;the patient's primary care team as of the evaluation date. 
"DATA",811.8,189,100,31,0)
 N IND,EFFDATE,RESULT
"DATA",811.8,189,100,32,0)
 S EFFDATE=$$NOW^PXRMDATE
"DATA",811.8,189,100,33,0)
 S RESULT=$$INSTPCTM^SCAPMC(DFN,EFFDATE)
"DATA",811.8,189,100,34,0)
 I RESULT=0 S NFOUND=0 Q
"DATA",811.8,189,100,35,0)
 S NFOUND=1,DATE(1)=EFFDATE,TEST(1)=1
"DATA",811.8,189,100,36,0)
 S (DATA(1,"PCMM TEAM"),DATA(1,"VALUE"))=$P(RESULT,U,2)
"DATA",811.8,189,100,37,0)
 S DATA(1,"INSTITUTION")=$P(RESULT,U,4)
"DATA",811.8,189,100,38,0)
 S TEXT(1)="Primary care team is "_DATA(1,"PCMM TEAM")_", Institution is "_DATA(1,"INSTITUTION")_"."
"DATA",811.8,189,100,39,0)
 Q
"DATA",811.8,189,100,40,0)
 ;
"DATA",811.8,189,100,41,0)
 ;====================================
"DATA",811.8,189,100,42,0)
MHTC(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM MHTC computed
"DATA",811.8,189,100,43,0)
 ;finding. MHTC stands for Mental Health Treatment Coordinator.
"DATA",811.8,189,100,44,0)
 N RESULT
"DATA",811.8,189,100,45,0)
 ;DBIA #5697
"DATA",811.8,189,100,46,0)
 S RESULT=$$START^SCMCMHTC(DFN)
"DATA",811.8,189,100,47,0)
 I RESULT="" S NFOUND=0 Q
"DATA",811.8,189,100,48,0)
 ;S NFOUND=1,DATE(1)=$$NOW^PXRMDATE,TEST(1)=1
"DATA",811.8,189,100,49,0)
 ;The API does not currently take a date.
"DATA",811.8,189,100,50,0)
 S NFOUND=1,DATE(1)=$$NOW^XLFDT,TEST(1)=1
"DATA",811.8,189,100,51,0)
 S (DATA(1,"MHTC"),DATA(1,"VALUE"))=$P(RESULT,U,2)
"DATA",811.8,189,100,52,0)
 S DATA(1,"TEAM POSITION")=$P(RESULT,U,3)
"DATA",811.8,189,100,53,0)
 S DATA(1,"ROLE")=$P(RESULT,U,4)
"DATA",811.8,189,100,54,0)
 S DATA(1,"TEAM")=$P(RESULT,U,5)
"DATA",811.8,189,100,55,0)
 S TEXT(1)="Team Position is "_DATA(1,"TEAM POSITION")_", Role is "_DATA(1,"ROLE")_", Team is "_DATA(1,"TEAM")_"."
"DATA",811.8,189,100,56,0)
 Q
"DATA",811.8,189,100,57,0)
 ;
"DATA",811.8,189,100,58,0)
 ;====================================
"DATA",811.8,189,100,59,0)
PRPT(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM PRACTITIONERS
"DATA",811.8,189,100,60,0)
 ;ASSIGNED TO A PATIENT computed finding. Return a list of
"DATA",811.8,189,100,61,0)
 ;practitioners assigned to a patient.
"DATA",811.8,189,100,62,0)
 N DATES,ERR,INCL,IND,LIST,RESULT
"DATA",811.8,189,100,63,0)
 S INCL=+$P(TEST,U,1)
"DATA",811.8,189,100,64,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"DATA",811.8,189,100,65,0)
 S RESULT=$$PRPT^SCAPMC(DFN,"DATES","","","","","LIST","ERR")
"DATA",811.8,189,100,66,0)
 S NFOUND=+$G(LIST(0))
"DATA",811.8,189,100,67,0)
 I NFOUND=0 Q
"DATA",811.8,189,100,68,0)
 F IND=1:1:NFOUND D
"DATA",811.8,189,100,69,0)
 . S TEST(IND)=1
"DATA",811.8,189,100,70,0)
 . S DATA(IND,"PROVIDER IEN")=$P(LIST(IND),U,1)
"DATA",811.8,189,100,71,0)
 . S DATA(IND,"PROVIDER")=$P(LIST(IND),U,2)
"DATA",811.8,189,100,72,0)
 . S DATA(IND,"POSITION")=$P(LIST(IND),U,4)
"DATA",811.8,189,100,73,0)
 . S (DATA(IND,"ACTIVATION DATE"),DATE(IND))=$P(LIST(IND),U,9)
"DATA",811.8,189,100,74,0)
 . S TEXT(IND)="Provider: "_DATA(IND,"PROVIDER")_"; Position: "_DATA(IND,"POSITION")
"DATA",811.8,189,100,75,0)
 Q
"DATA",811.8,189,100,76,0)
 ;
"DATA",811.8,189,100,77,0)
 ;====================================
"DATA",811.8,189,100,78,0)
PTPR(NGET,BDT,EDT,PLIST,PARAM) ;VA-PCMM PATIENTS ASSIGNED TO A PRACTITIONER.
"DATA",811.8,189,100,79,0)
 ;List type computed finding that returns a list of patients
"DATA",811.8,189,100,80,0)
 ;assigned to a list of practitioners within a time period.
"DATA",811.8,189,100,81,0)
 N DATES,ERR,INCL,IND,JND,LIST,NPAT,NPR,PRAC,PRACLIST,RESULT
"DATA",811.8,189,100,82,0)
 K ^TMP($J,PLIST)
"DATA",811.8,189,100,83,0)
 S PRACLIST=$P(PARAM,U,1)
"DATA",811.8,189,100,84,0)
 S INCL=+$P(PARAM,U,2)
"DATA",811.8,189,100,85,0)
 S NPR=$L(PRACLIST,";")
"DATA",811.8,189,100,86,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"DATA",811.8,189,100,87,0)
 F IND=1:1:NPR D
"DATA",811.8,189,100,88,0)
 . S PRAC=$P(PRACLIST,";",IND)
"DATA",811.8,189,100,89,0)
 . S PRAC=$$FIND1^DIC(200,,"ABX",PRAC,,,"MSG")
"DATA",811.8,189,100,90,0)
 . I PRAC=0 Q
"DATA",811.8,189,100,91,0)
 . K LIST
"DATA",811.8,189,100,92,0)
 . S RESULT=$$PTPR^SCAPMC(PRAC,"DATES","","","LIST","ERR","")
"DATA",811.8,189,100,93,0)
 . S NPAT=+$G(LIST(0)) I NPAT=0 Q
"DATA",811.8,189,100,94,0)
 . F JND=1:1:NPAT D
"DATA",811.8,189,100,95,0)
 .. S DFN=$P(LIST(JND),U,1)
"DATA",811.8,189,100,96,0)
 .. S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(JND),U,4)_U_DFN_U_$P(LIST(JND),U,2)
"DATA",811.8,189,100,97,0)
 .. S ^TMP($J,PLIST,DFN,1,"VALUE")=DFN
"DATA",811.8,189,100,98,0)
 Q
"DATA",811.8,189,100,99,0)
 ;
"DATA",811.8,189,100,100,0)
 ;====================================
"DATA",811.8,189,100,101,0)
PTTM(NGET,BDT,EDT,PLIST,PARAM) ;VA-PCMM PATIENTS ASSIGNED TO A TEAM
"DATA",811.8,189,100,102,0)
 ;List type computed finding that returns a list of patients
"DATA",811.8,189,100,103,0)
 ;assigned to a team for a time period.
"DATA",811.8,189,100,104,0)
 N DATES,ERR,INCL,LIST,MSG,RESULT,TEAM
"DATA",811.8,189,100,105,0)
 S TEAM=$P(PARAM,U,1)
"DATA",811.8,189,100,106,0)
 S TEAM=$$FIND1^DIC(404.51,,"ABX",TEAM,,,"MSG")
"DATA",811.8,189,100,107,0)
 I TEAM=0 Q
"DATA",811.8,189,100,108,0)
 S INCL=+$P(PARAM,U,2)
"DATA",811.8,189,100,109,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"DATA",811.8,189,100,110,0)
 ;Return list in ^TMP.
"DATA",811.8,189,100,111,0)
 S RESULT=$$PTTM^SCAPMC(TEAM,"DATES","LIST","MSG")
"DATA",811.8,189,100,112,0)
 K ^TMP($J,PLIST)
"DATA",811.8,189,100,113,0)
 S IND=0
"DATA",811.8,189,100,114,0)
 F  S IND=+$O(LIST(IND)) Q:IND=0  D
"DATA",811.8,189,100,115,0)
 . S DFN=$P(LIST(IND),U,1)
"DATA",811.8,189,100,116,0)
 . S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(IND),U,4)_U_DFN_U_$P(LIST(IND),U,2)
"DATA",811.8,189,100,117,0)
 . S ^TMP($J,PLIST,DFN,1,"VALUE")=DFN
"DATA",811.8,189,100,118,0)
 Q
"DATA",811.8,189,100,119,0)
 ;
"DATA",811.8,189,100,120,0)
]]>
"DATA",811.8,189,100,121,0)
</CODE>
"DATA",811.8,189,100,122,0)
</M_ROUTINE>
"DATA",811.8,189,100,123,0)
<M_ROUTINE>
"DATA",811.8,189,100,124,0)
<ROUTINE_NAME>PXRMPRF</ROUTINE_NAME>
"DATA",811.8,189,100,125,0)
<CHECKSUM>580828279</CHECKSUM>
"DATA",811.8,189,100,126,0)
<CODE>
"DATA",811.8,189,100,127,0)
<![CDATA[
"DATA",811.8,189,100,128,0)
PXRMPRF ;SLC/PKR - Computed findings for PRF. ;08/29/2012
"DATA",811.8,189,100,129,0)
 ;;2.0;CLINICAL REMINDERS;**17,18**;Feb 4, 2005
"DATA",811.8,189,100,130,0)
 ;Calls to DGPFAPIU supported by DBIA #4903 and 5491.
"DATA",811.8,189,100,131,0)
 ;==========================================
"DATA",811.8,189,100,132,0)
GETINF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PATIENT RECORD FLAG
"DATA",811.8,189,100,133,0)
 ;INFORMATION computed finding. Return information about a specific
"DATA",811.8,189,100,134,0)
 ;record flag.
"DATA",811.8,189,100,135,0)
 N BDTNT,EDTNTFLAG,FLAGCAT,FLAGNAME,IND,LIST,RESULT,TEMP
"DATA",811.8,189,100,136,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,189,100,137,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,189,100,138,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,189,100,139,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,189,100,140,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,189,100,141,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,189,100,142,0)
 ;DBIA #5491
"DATA",811.8,189,100,143,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,189,100,144,0)
 ;DBIA #4903
"DATA",811.8,189,100,145,0)
 S RESULT=$$GETINF^DGPFAPIH(DFN,FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,189,100,146,0)
 S NFOUND=0
"DATA",811.8,189,100,147,0)
 I RESULT=0 Q
"DATA",811.8,189,100,148,0)
 S IND=0
"DATA",811.8,189,100,149,0)
 F IND=+$O(LIST("HIST",IND)) Q:IND=0  D
"DATA",811.8,189,100,150,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,189,100,151,0)
 . S TEST(NFOUND)=1
"DATA",811.8,189,100,152,0)
 . S DATE(NFOUND)=$P(LIST("HIST",IND,"DATETIME"),U,1)
"DATA",811.8,189,100,153,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"ACTION"))=$P(LIST("HIST",IND,"ACTION"),U,2)
"DATA",811.8,189,100,154,0)
 . S DATA(NFOUND,"APPRVBY")=$P(LIST("HIST",IND,"APPRVBY"),U,2)
"DATA",811.8,189,100,155,0)
 . S DATA(NFOUND,"ASSIGN DT")=$P(LIST("ASSIGNDT"),U,1)
"DATA",811.8,189,100,156,0)
 . S DATA(NFOUND,"CATEGORY")=$P(LIST("CATEGORY"),U,2)
"DATA",811.8,189,100,157,0)
 . S DATA(NFOUND,"FLAGTYPE")=$P(LIST("FLAGTYPE"),U,2)
"DATA",811.8,189,100,158,0)
 . S DATA(NFOUND,"REVIEW DT")=$P(LIST("REVIEWDT"),U,1)
"DATA",811.8,189,100,159,0)
 . S DATA(NFOUND,"TIU TITLE")=$P(LIST("TIUTITLE"),U,2)
"DATA",811.8,189,100,160,0)
 . S TEMP="\\Flag - "_$P(LIST("FLAG"),U,2)_"("_DATA(NFOUND,"CATEGORY")_")."
"DATA",811.8,189,100,161,0)
 . S TEMP=TEMP_"\\Assigned "_$P(LIST("ASSIGNDT"),U,2)_" by "_DATA(NFOUND,"APPRVBY")_". "
"DATA",811.8,189,100,162,0)
 . S TEMP=TEMP_LIST("HIST",IND,"COMMENT",1,0)
"DATA",811.8,189,100,163,0)
 . S TEXT(NFOUND)=TEMP
"DATA",811.8,189,100,164,0)
 Q
"DATA",811.8,189,100,165,0)
 ;
"DATA",811.8,189,100,166,0)
 ;==========================================
"DATA",811.8,189,100,167,0)
GETLST(NGET,BDT,EDT,PLIST,PARAM) ;VA-PATIENT RECORD FLAG LIST computed finding.
"DATA",811.8,189,100,168,0)
 ;Return a list of patients with a specified record flag.
"DATA",811.8,189,100,169,0)
 N BDTNT,DATE,DFN,EDTNT,FLAGCAT,FLAGNAME,IND,LIST,RESULT
"DATA",811.8,189,100,170,0)
 K ^TMP($J,PLIST)
"DATA",811.8,189,100,171,0)
 I PARAM="" Q
"DATA",811.8,189,100,172,0)
 S FLAGNAME=$P(TEST,U,1)
"DATA",811.8,189,100,173,0)
 S FLAGCAT=$P(TEST,U,2)
"DATA",811.8,189,100,174,0)
 I FLAGCAT="" S FLAGCAT="L"
"DATA",811.8,189,100,175,0)
 S BDTNT=$P(BDT,".",1)
"DATA",811.8,189,100,176,0)
 S EDTNT=$P(EDT,".",1)
"DATA",811.8,189,100,177,0)
 ;DBIA #5491
"DATA",811.8,189,100,178,0)
 S FLAG=$$GETFLAG^DGPFAPIU(FLAGNAME,FLAGCAT)
"DATA",811.8,189,100,179,0)
 ;DBIA #4903
"DATA",811.8,189,100,180,0)
 S RESULT=$$GETLST^DGPFAPIH(FLAG,BDTNT,EDTNT,"LIST")
"DATA",811.8,189,100,181,0)
 I RESULT=0 Q
"DATA",811.8,189,100,182,0)
 S DFN=0
"DATA",811.8,189,100,183,0)
 F  S DFN=+$O(LIST(DFN)) Q:DFN=0  S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(DFN,0),U,3)_U_U_U
"DATA",811.8,189,100,184,0)
 Q
"DATA",811.8,189,100,185,0)
 ;
"DATA",811.8,189,100,186,0)
 ;==========================================
"DATA",811.8,189,100,187,0)
PRF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Computed finding for
"DATA",811.8,189,100,188,0)
 ;getting a list of the patient's active flags.
"DATA",811.8,189,100,189,0)
 N ASSIGNDT,CAT,DONE,FLAG,FLAGKEEP,FLAGLIST,IND
"DATA",811.8,189,100,190,0)
 N NFLAGS,NOCC,OK,SDIR,SUB,TEMP,TYPE
"DATA",811.8,189,100,191,0)
 I (TEST="")!(NGET=0) S NFOUND=0 Q
"DATA",811.8,189,100,192,0)
 ;DBIA #3860
"DATA",811.8,189,100,193,0)
 S NFLAGS=$$GETACT^DGPFAPI(DFN,"FLAGLIST")
"DATA",811.8,189,100,194,0)
 ;If no flags are found quit
"DATA",811.8,189,100,195,0)
 I NFLAGS=0 S NFOUND=0 Q
"DATA",811.8,189,100,196,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,189,100,197,0)
 S NOCC=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,189,100,198,0)
 ;Search the parameter list for category, type, and flag.
"DATA",811.8,189,100,199,0)
 S CAT=$F(TEST,"C:")
"DATA",811.8,189,100,200,0)
 I CAT>0 S CAT=$E(TEST,CAT),CAT=$S(CAT="N":"NATIONAL",CAT="L":"LOCAL")
"DATA",811.8,189,100,201,0)
 S TYPE=$F(TEST,"T:")
"DATA",811.8,189,100,202,0)
 I TYPE>0 S TEMP=$E(TEST,TYPE,245),TYPE=$P(TEMP,U,1),TYPE=$S(TYPE="B":"BEHAVIORAL",TYPE="C":"CLINICAL",TYPE="O":"OTHER",TYPE="R":"RESEARCH")
"DATA",811.8,189,100,203,0)
 S FLAG=$F(TEST,"F:")
"DATA",811.8,189,100,204,0)
 I FLAG>0 S TEMP=$E(TEST,FLAG,245),FLAG=$P(TEMP,U,1)
"DATA",811.8,189,100,205,0)
 ;Check all the flags that were returned and keep those that meet
"DATA",811.8,189,100,206,0)
 ;the criteria. Order by assigned date.
"DATA",811.8,189,100,207,0)
 F IND=1:1:NFLAGS D
"DATA",811.8,189,100,208,0)
 . S OK=1
"DATA",811.8,189,100,209,0)
 . I CAT'=0,FLAGLIST(IND,"CATEGORY")'[CAT S OK=0
"DATA",811.8,189,100,210,0)
 . I TYPE'=0,TYPE'=$P(FLAGLIST(IND,"FLAGTYPE"),U,2) S OK=0
"DATA",811.8,189,100,211,0)
 . I FLAG'=0,FLAG'=$P(FLAGLIST(IND,"FLAG"),U,2) S OK=0
"DATA",811.8,189,100,212,0)
 . I OK S FLAGKEEP($P(FLAGLIST(IND,"ASSIGNDT"),U,1),IND)=""
"DATA",811.8,189,100,213,0)
 S ASSIGNDT="",(DONE,NFOUND)=0
"DATA",811.8,189,100,214,0)
 F  S ASSIGNDT=$O(FLAGKEEP(ASSIGNDT),SDIR) Q:(DONE)!(ASSIGNDT="")  D
"DATA",811.8,189,100,215,0)
 . S IND=0
"DATA",811.8,189,100,216,0)
 . F  S IND=$O(FLAGKEEP(ASSIGNDT,IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,189,100,217,0)
 .. S NFOUND=NFOUND+1
"DATA",811.8,189,100,218,0)
 .. I NFOUND=NOCC S DONE=1
"DATA",811.8,189,100,219,0)
 .. S TEST(NFOUND)=1
"DATA",811.8,189,100,220,0)
 .. S DATE(NFOUND)=ASSIGNDT
"DATA",811.8,189,100,221,0)
 .. S SUB=""
"DATA",811.8,189,100,222,0)
 ..;Save the CSUB data.
"DATA",811.8,189,100,223,0)
 .. F  S SUB=$O(FLAGLIST(IND,SUB)) Q:SUB=""  D
"DATA",811.8,189,100,224,0)
 ... I SUB="NARR" Q
"DATA",811.8,189,100,225,0)
 ... S DATA(NFOUND,SUB)=$P($G(FLAGLIST(IND,SUB)),U,2)
"DATA",811.8,189,100,226,0)
 .. S TEXT(NFOUND)=DATA(NFOUND,"FLAG")_"; Category: "_DATA(NFOUND,"CATEGORY")_"; TYPE: "_DATA(NFOUND,"FLAGTYPE")
"DATA",811.8,189,100,227,0)
 Q
"DATA",811.8,189,100,228,0)
 ;
"DATA",811.8,189,100,229,0)
]]>
"DATA",811.8,189,100,230,0)
</CODE>
"DATA",811.8,189,100,231,0)
</M_ROUTINE>
"DATA",811.8,189,100,232,0)
<M_ROUTINE>
"DATA",811.8,189,100,233,0)
<ROUTINE_NAME>PXRMRDI</ROUTINE_NAME>
"DATA",811.8,189,100,234,0)
<CHECKSUM>63045721</CHECKSUM>
"DATA",811.8,189,100,235,0)
<CODE>
"DATA",811.8,189,100,236,0)
<![CDATA[
"DATA",811.8,189,100,237,0)
PXRMRDI ;SLC/PKR - Routines to support RDI list building. ;04/25/2012
"DATA",811.8,189,100,238,0)
 ;;2.0;CLINICAL REMINDERS;**4,17,18,24**;Feb 04, 2005
"DATA",811.8,189,100,239,0)
 ;=========================================================
"DATA",811.8,189,100,240,0)
APPERR(TYPE) ;Handle errors getting appointment data.
"DATA",811.8,189,100,241,0)
 N ECODE,MGIEN,MGROUP,NL,TIME,TO,USER
"DATA",811.8,189,100,242,0)
 S USER=$S($D(ZTQUEUED):DBDUZ,1:DUZ)
"DATA",811.8,189,100,243,0)
 S TIME=$$NOW^XLFDT
"DATA",811.8,189,100,244,0)
 S TIME=$$FMTE^XLFDT(TIME)
"DATA",811.8,189,100,245,0)
 K ^TMP("PXRMXMZ",$J)
"DATA",811.8,189,100,246,0)
 S ^TMP("PXRMXMZ",$J,1,0)="The "_TYPE_" requested by "_$$GET1^DIQ(200,USER,.01)_" on "
"DATA",811.8,189,100,247,0)
 S ^TMP("PXRMXMZ",$J,2,0)=TIME_" requires appointment data which could not be obtained"
"DATA",811.8,189,100,248,0)
 S ^TMP("PXRMXMZ",$J,3,0)="from the Scheduling database due to the following error(s):"
"DATA",811.8,189,100,249,0)
 S ECODE=0,NL=3
"DATA",811.8,189,100,250,0)
 F  S ECODE=$O(^TMP($J,"SDAMA301",ECODE)) Q:ECODE=""  D
"DATA",811.8,189,100,251,0)
 . S NL=NL+1,^TMP("PXRMXMZ",$J,NL,0)=" "_^TMP($J,"SDAMA301",ECODE)
"DATA",811.8,189,100,252,0)
 S TO(DUZ)=""
"DATA",811.8,189,100,253,0)
 S MGIEN=$G(^PXRM(800,1,"MGFE"))
"DATA",811.8,189,100,254,0)
 I MGIEN'="" D
"DATA",811.8,189,100,255,0)
 . S MGROUP="G."_$$GET1^DIQ(3.8,MGIEN,.01)
"DATA",811.8,189,100,256,0)
 . S TO(MGROUP)=""
"DATA",811.8,189,100,257,0)
 D SEND^PXRMMSG("PXRMXMZ","Scheduling database error(s)",.TO,DUZ)
"DATA",811.8,189,100,258,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,189,100,259,0)
 Q
"DATA",811.8,189,100,260,0)
 ;
"DATA",811.8,189,100,261,0)
 ;=========================================================
"DATA",811.8,189,100,262,0)
APPL(NGET,BDT,EDT,PLIST,PARAM) ;List type computed finding that returns
"DATA",811.8,189,100,263,0)
 ;a list of patients with appointments in the date range BDT to EDT.
"DATA",811.8,189,100,264,0)
 N FILTER,FLDS,RESULT
"DATA",811.8,189,100,265,0)
 K ^TMP($J,PLIST),^TMP($J,"SDAMA301")
"DATA",811.8,189,100,266,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,189,100,267,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,189,100,268,0)
 S FILTER("SORT")="P"
"DATA",811.8,189,100,269,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,189,100,270,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,189,100,271,0)
 ;DBIA #4433
"DATA",811.8,189,100,272,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,189,100,273,0)
 I RESULT=-1 D APPERR("Patient List build") Q
"DATA",811.8,189,100,274,0)
 N COUNT,DATE,DFN,DONE,ITEM
"DATA",811.8,189,100,275,0)
 S DFN=""
"DATA",811.8,189,100,276,0)
 F  S DFN=$O(^TMP($J,"SDAMA301",DFN)) Q:DFN=""  D
"DATA",811.8,189,100,277,0)
 . S (COUNT,DONE)=0,DATE=""
"DATA",811.8,189,100,278,0)
 . F  S DATE=$O(^TMP($J,"SDAMA301",DFN,DATE),-1) Q:(DONE)!(DATE="")  D
"DATA",811.8,189,100,279,0)
 .. S COUNT=COUNT+1
"DATA",811.8,189,100,280,0)
 .. S ITEM=$P(^TMP($J,"SDAMA301",DFN,DATE),U,2)
"DATA",811.8,189,100,281,0)
 .. S ^TMP($J,PLIST,DFN,COUNT)=U_DATE_U_44_U_$P(ITEM,";",1)_U_$P(ITEM,";",2)
"DATA",811.8,189,100,282,0)
 .. I COUNT=NGET S DONE=1
"DATA",811.8,189,100,283,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,189,100,284,0)
 Q
"DATA",811.8,189,100,285,0)
 ;
"DATA",811.8,189,100,286,0)
 ;=========================================================
"DATA",811.8,189,100,287,0)
FSTATUS(STATUS) ;Format the STATUS, field #22.
"DATA",811.8,189,100,288,0)
 N TEXT,TMP
"DATA",811.8,189,100,289,0)
 S TMP=$P(STATUS,";",1)
"DATA",811.8,189,100,290,0)
 S TEXT=$S(TMP="":"",1:"Code - "_TMP)
"DATA",811.8,189,100,291,0)
 S TMP=$P(STATUS,";",2)
"DATA",811.8,189,100,292,0)
 I TMP'="" S TEXT=TEXT_"; Description - "_TMP
"DATA",811.8,189,100,293,0)
 S TMP=$P(STATUS,";",3)
"DATA",811.8,189,100,294,0)
 I TMP'="" S TEXT=TEXT_"; Print Status - "_TMP
"DATA",811.8,189,100,295,0)
 S TMP=$P(STATUS,";",4)
"DATA",811.8,189,100,296,0)
 I TMP'="" S TEXT=TEXT_"; Checked In Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,189,100,297,0)
 S TMP=$P(STATUS,";",5)
"DATA",811.8,189,100,298,0)
 I TMP'="" S TEXT=TEXT_"; Checked Out Date/Time - "_$$EDATE^PXRMDATE(TMP)
"DATA",811.8,189,100,299,0)
 S TMP=$P(STATUS,";",6)
"DATA",811.8,189,100,300,0)
 I TMP'="" S TEXT=TEXT_"; Admission Movement IFN - "_TMP
"DATA",811.8,189,100,301,0)
 Q TEXT
"DATA",811.8,189,100,302,0)
 ;
"DATA",811.8,189,100,303,0)
 ;=========================================================
"DATA",811.8,189,100,304,0)
PAPPL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Multiple type computed
"DATA",811.8,189,100,305,0)
 ;finding that returns a list appointments for a patient.
"DATA",811.8,189,100,306,0)
 N FIELD,FILTER,FLDS,PARAM,RESULT
"DATA",811.8,189,100,307,0)
 K ^TMP($J,"SDAMA301")
"DATA",811.8,189,100,308,0)
 S PARAM=TEST K TEST
"DATA",811.8,189,100,309,0)
 S NFOUND=0
"DATA",811.8,189,100,310,0)
 I BDT<2000000 S BDT=2000101
"DATA",811.8,189,100,311,0)
 S FILTER(1)=BDT_";"_EDT
"DATA",811.8,189,100,312,0)
 S FILTER(4)=DFN
"DATA",811.8,189,100,313,0)
 S FILTER("SORT")="P"
"DATA",811.8,189,100,314,0)
 ;Set the rest of the filter nodes.
"DATA",811.8,189,100,315,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"DATA",811.8,189,100,316,0)
 ;DBIA #4433
"DATA",811.8,189,100,317,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"DATA",811.8,189,100,318,0)
 I RESULT=-1 D APPERR("Computed finding evaluation") Q
"DATA",811.8,189,100,319,0)
 N ALLNULL,APPDATE,DATALIST,DONE,FLABEL,IND,ITEM,STATUS,TMP
"DATA",811.8,189,100,320,0)
 S FLABEL(1)="APPOINTMENT DATE/TIME"
"DATA",811.8,189,100,321,0)
 S FLABEL(2)="CLINIC"
"DATA",811.8,189,100,322,0)
 S FLABEL(3)="APPOINTMENT STATUS"
"DATA",811.8,189,100,323,0)
 S FLABEL(4)="PATIENT"
"DATA",811.8,189,100,324,0)
 S FLABEL(5)="LENGTH OF APPOINTMENT"
"DATA",811.8,189,100,325,0)
 S FLABEL(6)="COMMENTS"
"DATA",811.8,189,100,326,0)
 S FLABEL(7)="OVERBOOK"
"DATA",811.8,189,100,327,0)
 S FLABEL(8)="ELIGIBILITY OF VISIT"
"DATA",811.8,189,100,328,0)
 S FLABEL(9)="CHECK-IN DATE/TIME"
"DATA",811.8,189,100,329,0)
 S FLABEL(10)="APPOINTMENT TYPE"
"DATA",811.8,189,100,330,0)
 S FLABEL(11)="CHECK-OUT DATE/TIME"
"DATA",811.8,189,100,331,0)
 S FLABEL(12)="OUTPATIENT ENCOUNTER IEN"
"DATA",811.8,189,100,332,0)
 S FLABEL(13)="PRIMARY STOP CODE"
"DATA",811.8,189,100,333,0)
 S FLABEL(14)="CREDIT STOP CODE"
"DATA",811.8,189,100,334,0)
 S FLABEL(15)="WORKLOAD NON-COUNT"
"DATA",811.8,189,100,335,0)
 S FLABEL(16)="DATE APPOINTMENT MADE"
"DATA",811.8,189,100,336,0)
 S FLABEL(17)="DESIRED DATE OF APPOINTMENT"
"DATA",811.8,189,100,337,0)
 S FLABEL(18)="PURPOSE OF VISIT and SHORT DESCRIPTION"
"DATA",811.8,189,100,338,0)
 S FLABEL(19)="EKG DATE/TIME"
"DATA",811.8,189,100,339,0)
 S FLABEL(20)="X-RAY DATE/TIME"
"DATA",811.8,189,100,340,0)
 S FLABEL(21)="LAB DATE/TIME"
"DATA",811.8,189,100,341,0)
 S FLABEL(22)="STATUS"
"DATA",811.8,189,100,342,0)
 S FLABEL(23)="X-RAY FILMS"
"DATA",811.8,189,100,343,0)
 S FLABEL(24)="AUTO-REBOOKED APPOINTMENT DATE/TIME"
"DATA",811.8,189,100,344,0)
 S FLABEL(25)="NO-SHOW/CANCEL DATE/TIME"
"DATA",811.8,189,100,345,0)
 S FLABEL(26)="RSA APPOINTMENT ID"
"DATA",811.8,189,100,346,0)
 S FLABEL(28)="DATA ENTRY CLERK"
"DATA",811.8,189,100,347,0)
 S FLABEL(29)="NO-SHOW/CANCELED BY"
"DATA",811.8,189,100,348,0)
 S FLABEL(30)="CHECK-IN USER"
"DATA",811.8,189,100,349,0)
 S FLABEL(31)="CHECK-OUT USER"
"DATA",811.8,189,100,350,0)
 S FLABEL(32)="CANCELLATION REASON"
"DATA",811.8,189,100,351,0)
 S FLABEL(33)="CONSULT LINK"
"DATA",811.8,189,100,352,0)
 S SDIR=$S(NGET<0:1,1:-1)
"DATA",811.8,189,100,353,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"DATA",811.8,189,100,354,0)
 S APPDATE="",DONE=0
"DATA",811.8,189,100,355,0)
 F  S APPDATE=$O(^TMP($J,"SDAMA301",DFN,APPDATE),SDIR) Q:(DONE)!(APPDATE="")  D
"DATA",811.8,189,100,356,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,189,100,357,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=APPDATE
"DATA",811.8,189,100,358,0)
 .;Fields 1-26
"DATA",811.8,189,100,359,0)
 . S DATALIST=$G(^TMP($J,"SDAMA301",DFN,APPDATE))
"DATA",811.8,189,100,360,0)
 .;Fields 28-33
"DATA",811.8,189,100,361,0)
 . S TMP=$G(^TMP($J,"SDAMA301",DFN,APPDATE,0))
"DATA",811.8,189,100,362,0)
 . S ALLNULL=1
"DATA",811.8,189,100,363,0)
 . I TMP'="" F IND=1:1:$L(TMP,U) I $P(TMP,U,IND)'="" S ALLNULL=0
"DATA",811.8,189,100,364,0)
 . I 'ALLNULL S $P(DATALIST,U,28)=TMP
"DATA",811.8,189,100,365,0)
 . F IND=1:1:$L(DATALIST,U) D
"DATA",811.8,189,100,366,0)
 .. S FIELD=$P(DATALIST,U,IND)
"DATA",811.8,189,100,367,0)
 .. I IND=6 S FIELD=$G(^TMP($J,"SDAMA301",DFN,APPDATE,"C"))
"DATA",811.8,189,100,368,0)
 .. I FIELD="" Q
"DATA",811.8,189,100,369,0)
 .. I IND=22 S STATUS=FIELD
"DATA",811.8,189,100,370,0)
 .. I FLABEL(IND)["DATE" S FIELD=$$EDATE^PXRMDATE(FIELD)
"DATA",811.8,189,100,371,0)
 .. I FIELD[";" S FIELD=$P(FIELD,";",2)
"DATA",811.8,189,100,372,0)
 ..;Save the clinic as the value.
"DATA",811.8,189,100,373,0)
 .. I IND=2 S DATA(NFOUND,"VALUE")=FIELD
"DATA",811.8,189,100,374,0)
 .. I IND=22 S FIELD=$$FSTATUS(STATUS)
"DATA",811.8,189,100,375,0)
 .. S TEXT(NFOUND,IND)=FLABEL(IND)_": "_FIELD
"DATA",811.8,189,100,376,0)
 .. S DATA(NFOUND,FLABEL(IND))=FIELD
"DATA",811.8,189,100,377,0)
 . I NFOUND=NGET S DONE=1
"DATA",811.8,189,100,378,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"DATA",811.8,189,100,379,0)
 Q
"DATA",811.8,189,100,380,0)
 ;
"DATA",811.8,189,100,381,0)
 ;=========================================================
"DATA",811.8,189,100,382,0)
SFILTER(PARAM,FILTER,FLDS) ;Parse the PARMETER and set the appropriate
"DATA",811.8,189,100,383,0)
 ;fields.
"DATA",811.8,189,100,384,0)
 N IND,LL,P1,P2,STATUS,TEMP
"DATA",811.8,189,100,385,0)
 S (FLDS,LL,STATUS)=""
"DATA",811.8,189,100,386,0)
 F IND=1:1:$L(PARAM,U) D
"DATA",811.8,189,100,387,0)
 . S TEMP=$P(PARAM,U,IND)
"DATA",811.8,189,100,388,0)
 . S P1=$P(TEMP,":",1),P2=$P(TEMP,":",2)
"DATA",811.8,189,100,389,0)
 . I P1="FLDS" S FLDS=$TR(P2,",",";") Q
"DATA",811.8,189,100,390,0)
 . I P1="LL" S LL=P2 Q
"DATA",811.8,189,100,391,0)
 . I P1="STATUS" S STATUS=$TR(P2,",",";") Q
"DATA",811.8,189,100,392,0)
 S FILTER("FLDS")=$S(FLDS="":"1;2",1:FLDS)
"DATA",811.8,189,100,393,0)
 S FILTER(3)=$S(STATUS="":"I;R",1:STATUS)
"DATA",811.8,189,100,394,0)
 I LL="" Q
"DATA",811.8,189,100,395,0)
 S LL=$O(^PXRMD(810.9,"B",LL,""))
"DATA",811.8,189,100,396,0)
 I LL="" S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NO LL")="Location List "_P2_" does not exist."
"DATA",811.8,189,100,397,0)
 D LOCLIST^PXRMLOCF(LL,"HLOCL")
"DATA",811.8,189,100,398,0)
 I $D(^TMP($J,"HLOCL")) S FILTER(2)="^TMP($J,""HLOCL"","
"DATA",811.8,189,100,399,0)
 Q
"DATA",811.8,189,100,400,0)
 ;
"DATA",811.8,189,100,401,0)
 ;=========================================================
"DATA",811.8,189,100,402,0)
TFL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Multiple type computed
"DATA",811.8,189,100,403,0)
 ;finding for a patient's treating facility list.
"DATA",811.8,189,100,404,0)
 N DONE,IND,NOW,SDIR,TDATE,TFL,TFLD
"DATA",811.8,189,100,405,0)
 S NFOUND=0
"DATA",811.8,189,100,406,0)
 ;DBIA #2990
"DATA",811.8,189,100,407,0)
 D TFL^VAFCTFU1(.TFL,DFN)
"DATA",811.8,189,100,408,0)
 I +TFL(1)=-1 Q
"DATA",811.8,189,100,409,0)
 S NOW=$$NOW^PXRMDATE
"DATA",811.8,189,100,410,0)
 S (DONE,IND)=0
"DATA",811.8,189,100,411,0)
 F  S IND=$O(TFL(IND)) Q:(DONE)!(IND="")  D
"DATA",811.8,189,100,412,0)
 . S NFOUND=NFOUND+1
"DATA",811.8,189,100,413,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=NOW
"DATA",811.8,189,100,414,0)
 . S VALUE(NFOUND,"VALUE")=TFL(IND)
"DATA",811.8,189,100,415,0)
 . I NFOUND=NGET S DONE=1 Q
"DATA",811.8,189,100,416,0)
 F IND=1:1:NFOUND S VALUE(IND,"NUM FACILITIES")=NFOUND
"DATA",811.8,189,100,417,0)
 Q
"DATA",811.8,189,100,418,0)
 ;
"DATA",811.8,189,100,419,0)
]]>
"DATA",811.8,189,100,420,0)
</CODE>
"DATA",811.8,189,100,421,0)
</M_ROUTINE>
"DATA",811.8,189,100,422,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,423,0)
<FILE_NAME>REMINDER SPONSOR</FILE_NAME>
"DATA",811.8,189,100,424,0)
<FILE_NUMBER>811.6</FILE_NUMBER>
"DATA",811.8,189,100,425,0)
<POINT_01>Office of Mental Health Services</POINT_01>
"DATA",811.8,189,100,426,0)
<INTERNAL_ENTRY_NUMBER>11</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,427,0)
<CHECKSUM>1503526438</CHECKSUM>
"DATA",811.8,189,100,428,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,429,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,430,0)
<![CDATA[
"DATA",811.8,189,100,431,0)
811.6;+11,;.01~Office of Mental Health Services
"DATA",811.8,189,100,432,0)
811.6;+11,;100~NATIONAL
"DATA",811.8,189,100,433,0)
811.61;+12,+11,;.01~Mental Health and Behavioral Science Strategic Group
"DATA",811.8,189,100,434,0)
811.61;+12,+11,;1~WP-start~4
"DATA",811.8,189,100,435,0)
Amy Street, PhD
"DATA",811.8,189,100,436,0)
Women's Health Sciences Division, National Center for PTSD
"DATA",811.8,189,100,437,0)
VA Boston HCS
"DATA",811.8,189,100,438,0)
(617) 232-9500, ext. 5111
"DATA",811.8,189,100,439,0)
811.63;+13,+11,;.01~12/06/2012@15:24:10
"DATA",811.8,189,100,440,0)
811.63;+13,+11,;2~WP-start~1
"DATA",811.8,189,100,441,0)
Exchange Stub
"DATA",811.8,189,100,442,0)
]]>
"DATA",811.8,189,100,443,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,444,0)
<IEN_ROOT>
"DATA",811.8,189,100,445,0)
<![CDATA[
"DATA",811.8,189,100,446,0)
12^1
"DATA",811.8,189,100,447,0)
13^1
"DATA",811.8,189,100,448,0)
]]>
"DATA",811.8,189,100,449,0)
</IEN_ROOT>
"DATA",811.8,189,100,450,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,451,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,452,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,189,100,453,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,189,100,454,0)
<POINT_01>VA-PCMM MHTC</POINT_01>
"DATA",811.8,189,100,455,0)
<INTERNAL_ENTRY_NUMBER>82</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,456,0)
<CHECKSUM>2924844287</CHECKSUM>
"DATA",811.8,189,100,457,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,458,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,459,0)
<![CDATA[
"DATA",811.8,189,100,460,0)
811.4;+82,;.01~VA-PCMM MHTC
"DATA",811.8,189,100,461,0)
811.4;+82,;.02~PXRMPCMM
"DATA",811.8,189,100,462,0)
811.4;+82,;.03~MHTC
"DATA",811.8,189,100,463,0)
811.4;+82,;.04~VA-PCMM Mental Health Treatment Coordinator
"DATA",811.8,189,100,464,0)
811.4;+82,;1~WP-start~15
"DATA",811.8,189,100,465,0)
This computed finding returns the patient's current Mental Health
"DATA",811.8,189,100,466,0)
Treatment Coordinator (MHTC). The Scheduling API this computed
"DATA",811.8,189,100,467,0)
finding uses does not take a date as a parameter so it only returns
"DATA",811.8,189,100,468,0)
the MHTC as of the actual calendar date. Therefore, this computed
"DATA",811.8,189,100,469,0)
finding cannot be used to determine if the patient had an MHTC
"DATA",811.8,189,100,470,0)
sometime in the past.
"DATA",811.8,189,100,471,0)

"DATA",811.8,189,100,472,0)
The default value of the computed finding is the MHTC. The following
"DATA",811.8,189,100,473,0)
additional CSUBs are returned:
"DATA",811.8,189,100,474,0)

"DATA",811.8,189,100,475,0)
MHTC - Mental Health Treatment Coordinator
"DATA",811.8,189,100,476,0)
ROLE - role
"DATA",811.8,189,100,477,0)
TEAM - team
"DATA",811.8,189,100,478,0)
TEAM POSITION - team position
"DATA",811.8,189,100,479,0)

"DATA",811.8,189,100,480,0)
811.4;+82,;5~MULTIPLE
"DATA",811.8,189,100,481,0)
811.4;+82,;100~NATIONAL
"DATA",811.8,189,100,482,0)
811.42;+83,+82,;.01~12/06/2012@15:24:10
"DATA",811.8,189,100,483,0)
811.42;+83,+82,;2~WP-start~1
"DATA",811.8,189,100,484,0)
Exchange Stub
"DATA",811.8,189,100,485,0)
]]>
"DATA",811.8,189,100,486,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,487,0)
<IEN_ROOT>
"DATA",811.8,189,100,488,0)
<![CDATA[
"DATA",811.8,189,100,489,0)
83^1
"DATA",811.8,189,100,490,0)
]]>
"DATA",811.8,189,100,491,0)
</IEN_ROOT>
"DATA",811.8,189,100,492,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,493,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,494,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,189,100,495,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,189,100,496,0)
<POINT_01>VA-PATIENT RECORD FLAG INFORMATION</POINT_01>
"DATA",811.8,189,100,497,0)
<INTERNAL_ENTRY_NUMBER>75</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,498,0)
<CHECKSUM>926715250</CHECKSUM>
"DATA",811.8,189,100,499,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,500,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,501,0)
<![CDATA[
"DATA",811.8,189,100,502,0)
811.4;+75,;.01~VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,189,100,503,0)
811.4;+75,;.02~PXRMPRF
"DATA",811.8,189,100,504,0)
811.4;+75,;.03~GETINF
"DATA",811.8,189,100,505,0)
811.4;+75,;.04~VA-Patient Record Flag Information
"DATA",811.8,189,100,506,0)
811.4;+75,;1~WP-start~26
"DATA",811.8,189,100,507,0)
This multiple type computed finding returns information about a
"DATA",811.8,189,100,508,0)
specified patient record flag for a patient. The Computed Finding
"DATA",811.8,189,100,509,0)
Parameter is used to specify the flag in the following format:
"DATA",811.8,189,100,510,0)
FLAG NAME^FLAG TYPE
"DATA",811.8,189,100,511,0)

"DATA",811.8,189,100,512,0)
Where FLAG NAME is the exact name of the flag and FLAG TYPE is L for
"DATA",811.8,189,100,513,0)
local or N for national. FLAG TYPE is optional and defaults to L.
"DATA",811.8,189,100,514,0)

"DATA",811.8,189,100,515,0)
The computed finding will be true if the flag was active at any time in
"DATA",811.8,189,100,516,0)
the date range.
"DATA",811.8,189,100,517,0)

"DATA",811.8,189,100,518,0)
The following "CSUBS" are available:
"DATA",811.8,189,100,519,0)

"DATA",811.8,189,100,520,0)
   "ACTION" The action
"DATA",811.8,189,100,521,0)
  "APPRVBY" Approved by
"DATA",811.8,189,100,522,0)
"ASSIGN DT" Date and time the flag was assigned
"DATA",811.8,189,100,523,0)
 "CATEGORY" The category
"DATA",811.8,189,100,524,0)
     "DATE" Date of the action
"DATA",811.8,189,100,525,0)
 "FLAGTYPE" Flag type
"DATA",811.8,189,100,526,0)
"REVIEW DT" Review date
"DATA",811.8,189,100,527,0)
"TIU TITLE" TIU title associated with the flag
"DATA",811.8,189,100,528,0)

"DATA",811.8,189,100,529,0)

"DATA",811.8,189,100,530,0)

"DATA",811.8,189,100,531,0)

"DATA",811.8,189,100,532,0)

"DATA",811.8,189,100,533,0)
811.4;+75,;5~MULTIPLE
"DATA",811.8,189,100,534,0)
811.4;+75,;6~YES
"DATA",811.8,189,100,535,0)
811.4;+75,;100~NATIONAL
"DATA",811.8,189,100,536,0)
811.42;+76,+75,;.01~12/06/2012@15:24:10
"DATA",811.8,189,100,537,0)
811.42;+76,+75,;2~WP-start~1
"DATA",811.8,189,100,538,0)
Exchange Stub
"DATA",811.8,189,100,539,0)
]]>
"DATA",811.8,189,100,540,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,541,0)
<IEN_ROOT>
"DATA",811.8,189,100,542,0)
<![CDATA[
"DATA",811.8,189,100,543,0)
76^1
"DATA",811.8,189,100,544,0)
]]>
"DATA",811.8,189,100,545,0)
</IEN_ROOT>
"DATA",811.8,189,100,546,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,547,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,548,0)
<FILE_NAME>REMINDER COMPUTED FINDINGS</FILE_NAME>
"DATA",811.8,189,100,549,0)
<FILE_NUMBER>811.4</FILE_NUMBER>
"DATA",811.8,189,100,550,0)
<POINT_01>VA-APPOINTMENTS FOR A PATIENT</POINT_01>
"DATA",811.8,189,100,551,0)
<INTERNAL_ENTRY_NUMBER>15</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,552,0)
<CHECKSUM>3006509961</CHECKSUM>
"DATA",811.8,189,100,553,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,554,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,555,0)
<![CDATA[
"DATA",811.8,189,100,556,0)
811.4;+15,;.01~VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,189,100,557,0)
811.4;+15,;.02~PXRMRDI
"DATA",811.8,189,100,558,0)
811.4;+15,;.03~PAPPL
"DATA",811.8,189,100,559,0)
811.4;+15,;.04~VA-Appointments for a Patient
"DATA",811.8,189,100,560,0)
811.4;+15,;1~WP-start~119
"DATA",811.8,189,100,561,0)
This multiple occurrence computed finding returns a list of
"DATA",811.8,189,100,562,0)
appointments for a patient in the specified date range from 
"DATA",811.8,189,100,563,0)
the Scheduling Package. 
"DATA",811.8,189,100,564,0)

"DATA",811.8,189,100,565,0)
The Computed Finding Parameter can be used to specify which 
"DATA",811.8,189,100,566,0)
appointment data fields should be returned from the Scheduling 
"DATA",811.8,189,100,567,0)
package and filter the results returned based on location 
"DATA",811.8,189,100,568,0)
and status. The Computed Finding Parameter entry uses
"DATA",811.8,189,100,569,0)
FLDS: to specify appointment data fields, STATUS: to filter 
"DATA",811.8,189,100,570,0)
specific statuses, and LL: to specify a Reminder Location List 
"DATA",811.8,189,100,571,0)
to filter locations.  
"DATA",811.8,189,100,572,0)

"DATA",811.8,189,100,573,0)
FLDS, STATUS, and LL are all optional and can be defined in any 
"DATA",811.8,189,100,574,0)
order in the computed finding parameter field.
"DATA",811.8,189,100,575,0)
Some examples of how to use FLDS, STATUS and/or LL:
"DATA",811.8,189,100,576,0)
  FLDS:1,2,16^STATUS:R^LL:DIABETIC LOCATIONS
"DATA",811.8,189,100,577,0)
  STATUS:CP,CC^FLDS:25
"DATA",811.8,189,100,578,0)
  LL:DIABETIC LOCATION
"DATA",811.8,189,100,579,0)

"DATA",811.8,189,100,580,0)
FLDS parameter information:
"DATA",811.8,189,100,581,0)
The appointment data fields are specified as follows:  
"DATA",811.8,189,100,582,0)
FLDS:F1,F2,... where F1,F2,... are any of the possible ID values
"DATA",811.8,189,100,583,0)
listed in the Available Appointment Data Fields table below.
"DATA",811.8,189,100,584,0)
The F1,F2,... ID values specify what data associated with the 
"DATA",811.8,189,100,585,0)
appointment will display in the clinical maintenance output. 
"DATA",811.8,189,100,586,0)
If no FLDS is specified, the default display fields will be 1,2
"DATA",811.8,189,100,587,0)
for APPOINTMENT DATE/TIME and CLINIC. 
"DATA",811.8,189,100,588,0)

"DATA",811.8,189,100,589,0)
Additionally, each F1,F2,... specified will be returned as CSUB 
"DATA",811.8,189,100,590,0)
data that can also be used in the computed finding's CONDITION
"DATA",811.8,189,100,591,0)
field. The CONDITION can be used to further screen the filtered
"DATA",811.8,189,100,592,0)
appointments, returned by Scheduling, by setting the USE STATUS/COND
"DATA",811.8,189,100,593,0)
IN SEARCH field to YES. 
"DATA",811.8,189,100,594,0)

"DATA",811.8,189,100,595,0)
For example, if you only want appointments that were checked out, 
"DATA",811.8,189,100,596,0)
use FLDS: 1,2,11 to get the APPOINTMENT DATE/TIME, CLINIC, and 
"DATA",811.8,189,100,597,0)
CHECK-OUT DATE/TIME for display purposes. The FLDS:1,2,11 will
"DATA",811.8,189,100,598,0)
return the CSUB data "APPOINTMENT DATE/TIME", "CLINIC" and 
"DATA",811.8,189,100,599,0)
"CHECK-OUT DATE/TIME".
"DATA",811.8,189,100,600,0)

"DATA",811.8,189,100,601,0)
CSUB values are used in the CONDITION field to do a comparison to
"DATA",811.8,189,100,602,0)
numeric or string values. Using +V causes the CSUB data to be
"DATA",811.8,189,100,603,0)
interpreted as numeric. Strings that cannot be converted to a
"DATA",811.8,189,100,604,0)
number are set to zero. For example, a CONDITION such as I
"DATA",811.8,189,100,605,0)
+V("CHECK-OUT DATE/TIME")>0 would be true if the appointment had a
"DATA",811.8,189,100,606,0)
check-out date/time.
"DATA",811.8,189,100,607,0)

"DATA",811.8,189,100,608,0)
List of Available Appointment Data Fields table with assigned ID
"DATA",811.8,189,100,609,0)
    ID      Field Name
"DATA",811.8,189,100,610,0)
--------------------------------------------------------
"DATA",811.8,189,100,611,0)

"DATA",811.8,189,100,612,0)
     1     APPOINTMENT DATE/TIME
"DATA",811.8,189,100,613,0)
     2     CLINIC
"DATA",811.8,189,100,614,0)
     3     APPOINTMENT STATUS     
"DATA",811.8,189,100,615,0)
     4     PATIENT
"DATA",811.8,189,100,616,0)
     5     LENGTH OF APPOINTMENT
"DATA",811.8,189,100,617,0)
     6     COMMENTS
"DATA",811.8,189,100,618,0)
     7     OVERBOOK
"DATA",811.8,189,100,619,0)
     8     ELIGIBILITY OF VISIT
"DATA",811.8,189,100,620,0)
     9     CHECK-IN DATE/TIME
"DATA",811.8,189,100,621,0)
    10     APPOINTMENT TYPE
"DATA",811.8,189,100,622,0)
    11     CHECK-OUT DATE/TIME
"DATA",811.8,189,100,623,0)
    12     OUTPATIENT ENCOUNTER IEN
"DATA",811.8,189,100,624,0)
    13     PRIMARY STOP CODE
"DATA",811.8,189,100,625,0)
    14     CREDIT STOP CODE
"DATA",811.8,189,100,626,0)
    15     WORKLOAD NON-COUNT
"DATA",811.8,189,100,627,0)
    16     DATE APPOINTMENT MADE
"DATA",811.8,189,100,628,0)
    17     DESIRED DATE OF APPOINTMENT
"DATA",811.8,189,100,629,0)
    18     PURPOSE OF VISIT and SHORT DESCRIPTION
"DATA",811.8,189,100,630,0)
    19     EKG DATE/TIME
"DATA",811.8,189,100,631,0)
    20     X-RAY DATE/TIME
"DATA",811.8,189,100,632,0)
    21     LAB DATE/TIME
"DATA",811.8,189,100,633,0)
    22     STATUS
"DATA",811.8,189,100,634,0)
    23     X-RAY FILMS
"DATA",811.8,189,100,635,0)
    24     AUTO-REBOOKED APPOINTMENT DATE/TIME
"DATA",811.8,189,100,636,0)
    25     NO-SHOW/CANCEL DATE/TIME
"DATA",811.8,189,100,637,0)
    26     RSA APPOINTMENT ID
"DATA",811.8,189,100,638,0)
    28     DATA ENTRY CLERK
"DATA",811.8,189,100,639,0)
    29     NO-SHOW/CANCELED BY
"DATA",811.8,189,100,640,0)
    30     CHECK-IN USER
"DATA",811.8,189,100,641,0)
    31     CHECK-OUT USER
"DATA",811.8,189,100,642,0)
    32     CANCELLATION REASON
"DATA",811.8,189,100,643,0)
    33     CONSULT LINK
"DATA",811.8,189,100,644,0)

"DATA",811.8,189,100,645,0)
STATUS information:
"DATA",811.8,189,100,646,0)
STATUS: is used to set a filter on the appointment status; only
"DATA",811.8,189,100,647,0)
those appointments with a status that matches the STATUS: values
"DATA",811.8,189,100,648,0)
list will be returned. The possible values that the Scheduling
"DATA",811.8,189,100,649,0)
API allows are:
"DATA",811.8,189,100,650,0)

"DATA",811.8,189,100,651,0)
VALUE     Description 
"DATA",811.8,189,100,652,0)
--------------------------------------------------------
"DATA",811.8,189,100,653,0)
    R      SCHEDULED/KEPT
"DATA",811.8,189,100,654,0)
    I      INPATIENT
"DATA",811.8,189,100,655,0)
    NS     NO-SHOW
"DATA",811.8,189,100,656,0)
    NSR    NO-SHOW, RESCHEDULED
"DATA",811.8,189,100,657,0)
    CP     CANCELLED BY PATIENT
"DATA",811.8,189,100,658,0)
    CPR    CANCELLED BY PATIENT, RESCHEDULED
"DATA",811.8,189,100,659,0)
    CC     CANCELLED BY CLINIC
"DATA",811.8,189,100,660,0)
    CCR    CANCELLED BY CLINIC, RESCHEDULED 
"DATA",811.8,189,100,661,0)
    NT     NO ACTION TAKEN
"DATA",811.8,189,100,662,0)

"DATA",811.8,189,100,663,0)
If STATUS is not specified, the default is R,I.
"DATA",811.8,189,100,664,0)

"DATA",811.8,189,100,665,0)
The APPOINTMENT STATUS returned by the API is a summarized list
"DATA",811.8,189,100,666,0)
which does not include detailed statuses such as Future, Checked-In,
"DATA",811.8,189,100,667,0)
or Checked Out. These  statuses are summarized as SCHEDULED/KEPT. 
"DATA",811.8,189,100,668,0)
As a result, a CONDITION may be required to make sure you are
"DATA",811.8,189,100,669,0)
getting the correct results. For example, if you are looking for an
"DATA",811.8,189,100,670,0)
appointment that was kept, you would set STATUS:R combined with a
"DATA",811.8,189,100,671,0)
CONDITION of I (+V("OUTPATIENT ENCOUNTER IEN")>0)!(+V("CHECK-OUT
"DATA",811.8,189,100,672,0)
DATE/TIME")>0) with USE STATUS/COND IN SEARCH set to YES.
"DATA",811.8,189,100,673,0)

"DATA",811.8,189,100,674,0)
LL information:
"DATA",811.8,189,100,675,0)
LL:Reminder Location List specifies a list of locations so that only
"DATA",811.8,189,100,676,0)
appointments for those locations will be returned. If LL is not
"DATA",811.8,189,100,677,0)
specified, then appointments for all locations will be returned.
"DATA",811.8,189,100,678,0)

"DATA",811.8,189,100,679,0)

"DATA",811.8,189,100,680,0)
811.4;+15,;5~MULTIPLE
"DATA",811.8,189,100,681,0)
811.4;+15,;6~NO
"DATA",811.8,189,100,682,0)
811.4;+15,;100~NATIONAL
"DATA",811.8,189,100,683,0)
811.42;+16,+15,;.01~12/06/2012@15:24:10
"DATA",811.8,189,100,684,0)
811.42;+16,+15,;2~WP-start~1
"DATA",811.8,189,100,685,0)
Exchange Stub
"DATA",811.8,189,100,686,0)
]]>
"DATA",811.8,189,100,687,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,688,0)
<IEN_ROOT>
"DATA",811.8,189,100,689,0)
<![CDATA[
"DATA",811.8,189,100,690,0)
16^1
"DATA",811.8,189,100,691,0)
]]>
"DATA",811.8,189,100,692,0)
</IEN_ROOT>
"DATA",811.8,189,100,693,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,694,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,695,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,189,100,696,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,189,100,697,0)
<POINT_01>VA-MH PCMM MHTC</POINT_01>
"DATA",811.8,189,100,698,0)
<INTERNAL_ENTRY_NUMBER>880</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,699,0)
<CHECKSUM>2218995983</CHECKSUM>
"DATA",811.8,189,100,700,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,701,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,702,0)
<![CDATA[
"DATA",811.8,189,100,703,0)
811.5;+880,;.01~VA-MH PCMM MHTC
"DATA",811.8,189,100,704,0)
811.5;+880,;100~NATIONAL
"DATA",811.8,189,100,705,0)
811.5;+880,;101~Office of Mental Health Services
"DATA",811.8,189,100,706,0)
811.52;+881,+880,;.01~CF.VA-PCMM MHTC
"DATA",811.8,189,100,707,0)
811.53;+882,+880,;.01~12/06/2012@15:24:11
"DATA",811.8,189,100,708,0)
811.53;+882,+880,;2~WP-start~1
"DATA",811.8,189,100,709,0)
Exchange Stub
"DATA",811.8,189,100,710,0)
]]>
"DATA",811.8,189,100,711,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,712,0)
<IEN_ROOT>
"DATA",811.8,189,100,713,0)
<![CDATA[
"DATA",811.8,189,100,714,0)
881^1
"DATA",811.8,189,100,715,0)
882^1
"DATA",811.8,189,100,716,0)
]]>
"DATA",811.8,189,100,717,0)
</IEN_ROOT>
"DATA",811.8,189,100,718,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,719,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,720,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,189,100,721,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,189,100,722,0)
<POINT_01>VA-MH HIGH RISK FOR SUICIDE PRF</POINT_01>
"DATA",811.8,189,100,723,0)
<INTERNAL_ENTRY_NUMBER>811</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,724,0)
<CHECKSUM>2093237997</CHECKSUM>
"DATA",811.8,189,100,725,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,726,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,727,0)
<![CDATA[
"DATA",811.8,189,100,728,0)
811.5;+811,;.01~VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,189,100,729,0)
811.5;+811,;1~WP-start~16
"DATA",811.8,189,100,730,0)
This reminder looks for the national category I HIGH RISK FOR SUICIDE
"DATA",811.8,189,100,731,0)
patient record flag and the local category II patient record flag used at
"DATA",811.8,189,100,732,0)
your site.  
"DATA",811.8,189,100,733,0)
 
"DATA",811.8,189,100,734,0)
This term is distributed to look for the local name HIGH RISK FOR SUICIDE 
"DATA",811.8,189,100,735,0)
which is the first mapped finding in the Mapped Findings.  The Computed 
"DATA",811.8,189,100,736,0)
Finding Parameter of HIGH RISK FOR SUICIDE^L means use the local patient 
"DATA",811.8,189,100,737,0)
record flag called HIGH RISK FOR SUICIDE.  If your site uses a different 
"DATA",811.8,189,100,738,0)
category II patient record flag name, then the computed finding parameter 
"DATA",811.8,189,100,739,0)
for the first mapped finding should be changed.  For example, if you're 
"DATA",811.8,189,100,740,0)
site uses SUICIDE RISK as the name of the category II patient record 
"DATA",811.8,189,100,741,0)
flag, then the Computed Finding Parameter should be changed to SUICIDE
"DATA",811.8,189,100,742,0)
RISK^L.
"DATA",811.8,189,100,743,0)
 
"DATA",811.8,189,100,744,0)
Do not change the second mapped finding with the Computed Finding
"DATA",811.8,189,100,745,0)
Parameter of HIGH RISK FOR SUICIDE^N.
"DATA",811.8,189,100,746,0)
811.5;+811,;100~NATIONAL
"DATA",811.8,189,100,747,0)
811.5;+811,;101~Office of Mental Health Services
"DATA",811.8,189,100,748,0)
811.52;+812,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,189,100,749,0)
811.52;+812,+811,;26~HIGH RISK FOR SUICIDE^L
"DATA",811.8,189,100,750,0)
811.52;+813,+811,;.01~CF.VA-PATIENT RECORD FLAG INFORMATION
"DATA",811.8,189,100,751,0)
811.52;+813,+811,;26~HIGH RISK FOR SUICIDE^N
"DATA",811.8,189,100,752,0)
811.53;+814,+811,;.01~12/06/2012@15:24:11
"DATA",811.8,189,100,753,0)
811.53;+814,+811,;2~WP-start~1
"DATA",811.8,189,100,754,0)
Exchange Stub
"DATA",811.8,189,100,755,0)
]]>
"DATA",811.8,189,100,756,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,757,0)
<IEN_ROOT>
"DATA",811.8,189,100,758,0)
<![CDATA[
"DATA",811.8,189,100,759,0)
812^1
"DATA",811.8,189,100,760,0)
813^2
"DATA",811.8,189,100,761,0)
814^1
"DATA",811.8,189,100,762,0)
]]>
"DATA",811.8,189,100,763,0)
</IEN_ROOT>
"DATA",811.8,189,100,764,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,765,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,766,0)
<FILE_NAME>REMINDER TERM</FILE_NAME>
"DATA",811.8,189,100,767,0)
<FILE_NUMBER>811.5</FILE_NUMBER>
"DATA",811.8,189,100,768,0)
<POINT_01>VA-MH KEPT APPTS FOR MHTC ASSIGNMENT</POINT_01>
"DATA",811.8,189,100,769,0)
<INTERNAL_ENTRY_NUMBER>882</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,770,0)
<CHECKSUM>3034938347</CHECKSUM>
"DATA",811.8,189,100,771,0)
<SELECTED>NO</SELECTED>
"DATA",811.8,189,100,772,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,773,0)
<![CDATA[
"DATA",811.8,189,100,774,0)
811.5;+882,;.01~VA-MH KEPT APPTS FOR MHTC ASSIGNMENT
"DATA",811.8,189,100,775,0)
811.5;+882,;1~WP-start~4
"DATA",811.8,189,100,776,0)
This reminder term is used to identify MH appointments that were kept by
"DATA",811.8,189,100,777,0)
the patient, where the appointment is checked out and a completed 
"DATA",811.8,189,100,778,0)
encounter has been documented.  The Reminder Location List of clinics used
"DATA",811.8,189,100,779,0)
by this term was specified by the Office of Mental Health Services.
"DATA",811.8,189,100,780,0)
811.5;+882,;100~NATIONAL
"DATA",811.8,189,100,781,0)
811.5;+882,;101~Office of Mental Health Services
"DATA",811.8,189,100,782,0)
811.52;+883,+882,;.01~CF.VA-APPOINTMENTS FOR A PATIENT
"DATA",811.8,189,100,783,0)
811.52;+883,+882,;14~I +V("OUTPATIENT ENCOUNTER IEN")>0!(+V("CHECK-OUT DATE/TIME")>0)
"DATA",811.8,189,100,784,0)
811.52;+883,+882,;22~I +$G(V("OUTPATIENT ENCOUNTER IEN"))>0!(+$G(V("CHECK-OUT DATE/TIME"))>0)
"DATA",811.8,189,100,785,0)
811.52;+883,+882,;23~"OUTPATIENT ENCOUNTER IEN";"CHECK-OUT DATE/TIME";
"DATA",811.8,189,100,786,0)
811.52;+883,+882,;26~FLDS:1,2,3,11,12^STATUS:R^LL:VA-MHTC APPT STOP CODES LL
"DATA",811.8,189,100,787,0)
811.53;+884,+882,;.01~12/06/2012@15:24:11
"DATA",811.8,189,100,788,0)
811.53;+884,+882,;2~WP-start~1
"DATA",811.8,189,100,789,0)
Exchange Stub
"DATA",811.8,189,100,790,0)
]]>
"DATA",811.8,189,100,791,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,792,0)
<IEN_ROOT>
"DATA",811.8,189,100,793,0)
<![CDATA[
"DATA",811.8,189,100,794,0)
883^1
"DATA",811.8,189,100,795,0)
884^1
"DATA",811.8,189,100,796,0)
]]>
"DATA",811.8,189,100,797,0)
</IEN_ROOT>
"DATA",811.8,189,100,798,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,799,0)
<FILEMAN_FILE>
"DATA",811.8,189,100,800,0)
<FILE_NAME>REMINDER DEFINITION</FILE_NAME>
"DATA",811.8,189,100,801,0)
<FILE_NUMBER>811.9</FILE_NUMBER>
"DATA",811.8,189,100,802,0)
<POINT_01>VA-MHTC NEEDS ASSIGNMENT</POINT_01>
"DATA",811.8,189,100,803,0)
<INTERNAL_ENTRY_NUMBER>438</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,189,100,804,0)
<CHECKSUM>4213086173</CHECKSUM>
"DATA",811.8,189,100,805,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,189,100,806,0)
<FILEMAN_FDA>
"DATA",811.8,189,100,807,0)
<![CDATA[
"DATA",811.8,189,100,808,0)
811.9;+438,;.01~VA-MHTC NEEDS ASSIGNMENT
"DATA",811.8,189,100,809,0)
811.9;+438,;1.2~Needs MHTC Assignment
"DATA",811.8,189,100,810,0)
811.9;+438,;2~WP-start~4
"DATA",811.8,189,100,811,0)
This reminder shall determine whether a patient has been assigned a 
"DATA",811.8,189,100,812,0)
Mental Health Treatment Coordinator (MHTC) when the patient has kept
"DATA",811.8,189,100,813,0)
3 or more MH appointments in the past year, where the appointment is
"DATA",811.8,189,100,814,0)
checked out and a completed encounter has been documented.
"DATA",811.8,189,100,815,0)
811.9;+438,;31~(SEX)&(AGE)&FF(1)
"DATA",811.8,189,100,816,0)
811.9;+438,;32~3
"DATA",811.8,189,100,817,0)
811.9;+438,;33~SEX;AGE;FF1
"DATA",811.8,189,100,818,0)
811.9;+438,;35~(1)&FI(3)
"DATA",811.8,189,100,819,0)
811.9;+438,;36~1
"DATA",811.8,189,100,820,0)
811.9;+438,;37~3
"DATA",811.8,189,100,821,0)
811.9;+438,;40~0
"DATA",811.8,189,100,822,0)
811.9;+438,;42~2
"DATA",811.8,189,100,823,0)
811.9;+438,;43~1;2
"DATA",811.8,189,100,824,0)
811.9;+438,;62~0
"DATA",811.8,189,100,825,0)
811.9;+438,;63~0
"DATA",811.8,189,100,826,0)
811.9;+438,;67~0
"DATA",811.8,189,100,827,0)
811.9;+438,;68~0
"DATA",811.8,189,100,828,0)
811.9;+438,;72~0
"DATA",811.8,189,100,829,0)
811.9;+438,;73~0
"DATA",811.8,189,100,830,0)
811.9;+438,;77~0
"DATA",811.8,189,100,831,0)
811.9;+438,;78~0
"DATA",811.8,189,100,832,0)
811.9;+438,;100~NATIONAL
"DATA",811.8,189,100,833,0)
811.9;+438,;101~Office of Mental Health Services
"DATA",811.8,189,100,834,0)
811.9;+438,;103~CRX
"DATA",811.8,189,100,835,0)
811.9001;+439,+438,;.01~12/06/2012@15:24:12
"DATA",811.8,189,100,836,0)
811.9001;+439,+438,;2~WP-start~1
"DATA",811.8,189,100,837,0)
Exchange Stub
"DATA",811.8,189,100,838,0)
811.902;+440,+438,;.01~RT.VA-MH KEPT APPTS FOR MHTC ASSIGNMENT
"DATA",811.8,189,100,839,0)
811.902;+440,+438,;4~WP-start~4
"DATA",811.8,189,100,840,0)
Patient has MH appointments that were kept by the patient within the 
"DATA",811.8,189,100,841,0)
past year, where the appointment is checked out and a completed encounter
"DATA",811.8,189,100,842,0)
has been documented. Most recent appointment/encounters displayed
"DATA",811.8,189,100,843,0)
first, maximum of 3 displayed.\\
"DATA",811.8,189,100,844,0)
811.902;+440,+438,;9~T-1Y
"DATA",811.8,189,100,845,0)
811.902;+440,+438,;12~T
"DATA",811.8,189,100,846,0)
811.902;+440,+438,;14~I +V("OUTPATIENT ENCOUNTER IEN")>0!(+V("CHECK-OUT DATE/TIME")>0)
"DATA",811.8,189,100,847,0)
811.902;+440,+438,;17~3
"DATA",811.8,189,100,848,0)
811.902;+440,+438,;22~I +$G(V("OUTPATIENT ENCOUNTER IEN"))>0!(+$G(V("CHECK-OUT DATE/TIME"))>0)
"DATA",811.8,189,100,849,0)
811.902;+440,+438,;23~"OUTPATIENT ENCOUNTER IEN";"CHECK-OUT DATE/TIME";
"DATA",811.8,189,100,850,0)
811.902;+440,+438,;24~4
"DATA",811.8,189,100,851,0)
811.902;+440,+438,;25~0
"DATA",811.8,189,100,852,0)
811.902;+441,+438,;.01~RT.VA-MH HIGH RISK FOR SUICIDE PRF
"DATA",811.8,189,100,853,0)
811.902;+441,+438,;4~WP-start~1
"DATA",811.8,189,100,854,0)
Patient has an active High Risk for Suicide Patient Record Flag.
"DATA",811.8,189,100,855,0)
811.902;+441,+438,;9~T
"DATA",811.8,189,100,856,0)
811.902;+441,+438,;12~T
"DATA",811.8,189,100,857,0)
811.902;+441,+438,;17~2
"DATA",811.8,189,100,858,0)
811.902;+441,+438,;24~1
"DATA",811.8,189,100,859,0)
811.902;+441,+438,;25~0
"DATA",811.8,189,100,860,0)
811.902;+442,+438,;.01~RT.VA-MH PCMM MHTC
"DATA",811.8,189,100,861,0)
811.902;+442,+438,;4~WP-start~1
"DATA",811.8,189,100,862,0)
Patient has an MHTC currently assigned.
"DATA",811.8,189,100,863,0)
811.902;+442,+438,;7~AND
"DATA",811.8,189,100,864,0)
811.902;+442,+438,;9~T
"DATA",811.8,189,100,865,0)
811.902;+442,+438,;12~T
"DATA",811.8,189,100,866,0)
811.902;+442,+438,;24~1
"DATA",811.8,189,100,867,0)
811.902;+442,+438,;25~0
"DATA",811.8,189,100,868,0)
811.925;+443,+438,;.01~1
"DATA",811.8,189,100,869,0)
811.925;+443,+438,;1~WP-start~3
"DATA",811.8,189,100,870,0)
Patient had 3 or more MH appointments kept within the past year, where the
"DATA",811.8,189,100,871,0)
appointments are checked out and completed encounters have been
"DATA",811.8,189,100,872,0)
documented. 
"DATA",811.8,189,100,873,0)
811.925;+443,+438,;2~WP-start~3
"DATA",811.8,189,100,874,0)
Patient does not have 3 or more MH appointments kept within the past year,
"DATA",811.8,189,100,875,0)
where the appointment is checked out and a completed encounter is 
"DATA",811.8,189,100,876,0)
documented.
"DATA",811.8,189,100,877,0)
811.925;+443,+438,;3~COUNT(1)>2
"DATA",811.8,189,100,878,0)
811.925;+443,+438,;10~FN(1)>2
"DATA",811.8,189,100,879,0)
811.925;+443,+438,;12~AND
"DATA",811.8,189,100,880,0)
811.925;+443,+438,;41~3
"DATA",811.8,189,100,881,0)
811.925;+443,+438,;42~3
"DATA",811.8,189,100,882,0)
811.9255;+444,+443,+438,;.01~1
"DATA",811.8,189,100,883,0)
811.9255;+444,+443,+438,;.02~COUNT
"DATA",811.8,189,100,884,0)
811.9256;+445,+444,+443,+438,;.01~1
"DATA",811.8,189,100,885,0)
811.97;+446,+438,;.01~99Y
"DATA",811.8,189,100,886,0)
811.97;+446,+438,;3~WP-start~2
"DATA",811.8,189,100,887,0)
Reminder triggered when no active MHTC is assigned for a patient that kept
"DATA",811.8,189,100,888,0)
3 or more MH appointments in the past year.\\
"DATA",811.8,189,100,889,0)
811.97;+446,+438,;5~2
"DATA",811.8,189,100,890,0)
811.97;+446,+438,;6~0
"DATA",811.8,189,100,891,0)
]]>
"DATA",811.8,189,100,892,0)
</FILEMAN_FDA>
"DATA",811.8,189,100,893,0)
<IEN_ROOT>
"DATA",811.8,189,100,894,0)
<![CDATA[
"DATA",811.8,189,100,895,0)
439^1
"DATA",811.8,189,100,896,0)
440^1
"DATA",811.8,189,100,897,0)
441^2
"DATA",811.8,189,100,898,0)
442^3
"DATA",811.8,189,100,899,0)
443^1
"DATA",811.8,189,100,900,0)
444^1
"DATA",811.8,189,100,901,0)
445^1
"DATA",811.8,189,100,902,0)
446^1
"DATA",811.8,189,100,903,0)
]]>
"DATA",811.8,189,100,904,0)
</IEN_ROOT>
"DATA",811.8,189,100,905,0)
</FILEMAN_FILE>
"DATA",811.8,189,100,906,0)
<INDEX>
"DATA",811.8,189,100,907,0)
<NUMBER_OF_COMPONENTS>11</NUMBER_OF_COMPONENTS>
"DATA",811.8,189,100,908,0)
<COMPONENT>
"DATA",811.8,189,100,909,0)
<M_ROUTINE_START>19</M_ROUTINE_START>
"DATA",811.8,189,100,910,0)
<ROUTINE_CODE_END>119</ROUTINE_CODE_END>
"DATA",811.8,189,100,911,0)
<ROUTINE_CODE_START>24</ROUTINE_CODE_START>
"DATA",811.8,189,100,912,0)
</COMPONENT>
"DATA",811.8,189,100,913,0)
<COMPONENT>
"DATA",811.8,189,100,914,0)
<M_ROUTINE_START>123</M_ROUTINE_START>
"DATA",811.8,189,100,915,0)
<ROUTINE_CODE_END>228</ROUTINE_CODE_END>
"DATA",811.8,189,100,916,0)
<ROUTINE_CODE_START>128</ROUTINE_CODE_START>
"DATA",811.8,189,100,917,0)
</COMPONENT>
"DATA",811.8,189,100,918,0)
<COMPONENT>
"DATA",811.8,189,100,919,0)
<M_ROUTINE_START>232</M_ROUTINE_START>
"DATA",811.8,189,100,920,0)
<ROUTINE_CODE_END>418</ROUTINE_CODE_END>
"DATA",811.8,189,100,921,0)
<ROUTINE_CODE_START>237</ROUTINE_CODE_START>
"DATA",811.8,189,100,922,0)
</COMPONENT>
"DATA",811.8,189,100,923,0)
<COMPONENT>
"DATA",811.8,189,100,924,0)
<FDA_END>441</FDA_END>
"DATA",811.8,189,100,925,0)
<FDA_START>431</FDA_START>
"DATA",811.8,189,100,926,0)
<FILE_START>422</FILE_START>
"DATA",811.8,189,100,927,0)
<IEN_ROOT_END>447</IEN_ROOT_END>
"DATA",811.8,189,100,928,0)
<IEN_ROOT_START>446</IEN_ROOT_START>
"DATA",811.8,189,100,929,0)
</COMPONENT>
"DATA",811.8,189,100,930,0)
<COMPONENT>
"DATA",811.8,189,100,931,0)
<FDA_END>484</FDA_END>
"DATA",811.8,189,100,932,0)
<FDA_START>460</FDA_START>
"DATA",811.8,189,100,933,0)
<FILE_START>451</FILE_START>
"DATA",811.8,189,100,934,0)
<IEN_ROOT_END>489</IEN_ROOT_END>
"DATA",811.8,189,100,935,0)
<IEN_ROOT_START>489</IEN_ROOT_START>
"DATA",811.8,189,100,936,0)
</COMPONENT>
"DATA",811.8,189,100,937,0)
<COMPONENT>
"DATA",811.8,189,100,938,0)
<FDA_END>538</FDA_END>
"DATA",811.8,189,100,939,0)
<FDA_START>502</FDA_START>
"DATA",811.8,189,100,940,0)
<FILE_START>493</FILE_START>
"DATA",811.8,189,100,941,0)
<IEN_ROOT_END>543</IEN_ROOT_END>
"DATA",811.8,189,100,942,0)
<IEN_ROOT_START>543</IEN_ROOT_START>
"DATA",811.8,189,100,943,0)
</COMPONENT>
"DATA",811.8,189,100,944,0)
<COMPONENT>
"DATA",811.8,189,100,945,0)
<FDA_END>685</FDA_END>
"DATA",811.8,189,100,946,0)
<FDA_START>556</FDA_START>
"DATA",811.8,189,100,947,0)
<FILE_START>547</FILE_START>
"DATA",811.8,189,100,948,0)
<IEN_ROOT_END>690</IEN_ROOT_END>
"DATA",811.8,189,100,949,0)
<IEN_ROOT_START>690</IEN_ROOT_START>
"DATA",811.8,189,100,950,0)
</COMPONENT>
"DATA",811.8,189,100,951,0)
<COMPONENT>
"DATA",811.8,189,100,952,0)
<FDA_END>709</FDA_END>
"DATA",811.8,189,100,953,0)
<FDA_START>703</FDA_START>
"DATA",811.8,189,100,954,0)
<FILE_START>694</FILE_START>
"DATA",811.8,189,100,955,0)
<IEN_ROOT_END>715</IEN_ROOT_END>
"DATA",811.8,189,100,956,0)
<IEN_ROOT_START>714</IEN_ROOT_START>
"DATA",811.8,189,100,957,0)
</COMPONENT>
"DATA",811.8,189,100,958,0)
<COMPONENT>
"DATA",811.8,189,100,959,0)
<FDA_END>754</FDA_END>
"DATA",811.8,189,100,960,0)
<FDA_START>728</FDA_START>
"DATA",811.8,189,100,961,0)
<FILE_START>719</FILE_START>
"DATA",811.8,189,100,962,0)
<IEN_ROOT_END>761</IEN_ROOT_END>
"DATA",811.8,189,100,963,0)
<IEN_ROOT_START>759</IEN_ROOT_START>
"DATA",811.8,189,100,964,0)
</COMPONENT>
"DATA",811.8,189,100,965,0)
<COMPONENT>
"DATA",811.8,189,100,966,0)
<FDA_END>789</FDA_END>
"DATA",811.8,189,100,967,0)
<FDA_START>774</FDA_START>
"DATA",811.8,189,100,968,0)
<FILE_START>765</FILE_START>
"DATA",811.8,189,100,969,0)
<IEN_ROOT_END>795</IEN_ROOT_END>
"DATA",811.8,189,100,970,0)
<IEN_ROOT_START>794</IEN_ROOT_START>
"DATA",811.8,189,100,971,0)
</COMPONENT>
"DATA",811.8,189,100,972,0)
<COMPONENT>
"DATA",811.8,189,100,973,0)
<FDA_END>890</FDA_END>
"DATA",811.8,189,100,974,0)
<FDA_START>808</FDA_START>
"DATA",811.8,189,100,975,0)
<FILE_START>799</FILE_START>
"DATA",811.8,189,100,976,0)
<IEN_ROOT_END>902</IEN_ROOT_END>
"DATA",811.8,189,100,977,0)
<IEN_ROOT_START>895</IEN_ROOT_START>
"DATA",811.8,189,100,978,0)
</COMPONENT>
"DATA",811.8,189,100,979,0)
</INDEX>
"DATA",811.8,189,100,980,0)
</REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,189,110,0)
^811.804^13^13
"DATA",811.8,189,110,1,0)
Source:      TROST,DEBBIE at SALT LAKE CITY OIFO
"DATA",811.8,189,110,2,0)
Date Packed: 12/06/2012@15:23:54
"DATA",811.8,189,110,3,0)
Package Version: 2.0P27
"DATA",811.8,189,110,4,0)

"DATA",811.8,189,110,5,0)
Description:
"DATA",811.8,189,110,6,0)
This reminder shall determine whether a patient has been assigned a 
"DATA",811.8,189,110,7,0)
Mental Health Treatment Coordinator (MHTC) when the patient has kept
"DATA",811.8,189,110,8,0)
3 or more MH appointments in the past year, where the appointment is
"DATA",811.8,189,110,9,0)
checked out and a completed encounter has been documented.
"DATA",811.8,189,110,10,0)

"DATA",811.8,189,110,11,0)
Keywords:
"DATA",811.8,189,110,12,0)

"DATA",811.8,189,110,13,0)
Components:
"DATA",811.8,246,0)
VA-MHTC APPT STOP CODES AND EXCLUSION STOP^TROST,DEBBIE at SALT LAKE CITY OIFO^3130509.112849
"DATA",811.8,246,100,0)
^811.801^294^294
"DATA",811.8,246,100,1,0)
<?xml version="1.0" standalone="yes"?>
"DATA",811.8,246,100,2,0)
<REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,246,100,3,0)
<PACKAGE_VERSION>2.0P30</PACKAGE_VERSION>
"DATA",811.8,246,100,4,0)
<INDEX_AT>277</INDEX_AT>
"DATA",811.8,246,100,5,0)
<SOURCE>
"DATA",811.8,246,100,6,0)
<NAME>VA-MHTC APPT STOP CODES AND EXCLUSION STOP</NAME>
"DATA",811.8,246,100,7,0)
<USER>TROST,DEBBIE</USER>
"DATA",811.8,246,100,8,0)
<SITE>SALT LAKE CITY OIFO</SITE>
"DATA",811.8,246,100,9,0)
<DATE_PACKED>05/09/2013@11:28:49</DATE_PACKED>
"DATA",811.8,246,100,10,0)
</SOURCE>
"DATA",811.8,246,100,11,0)
<DESCRIPTION><![CDATA[
"DATA",811.8,246,100,12,0)
The following Clinical Reminder items were selected for packing:
"DATA",811.8,246,100,13,0)
REMINDER LOCATION LIST
"DATA",811.8,246,100,14,0)
  VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,15,0)
  VA-MHTC APPT STOP CODES LL
"DATA",811.8,246,100,16,0)
]]></DESCRIPTION>
"DATA",811.8,246,100,17,0)
<KEYWORDS>
"DATA",811.8,246,100,18,0)
</KEYWORDS>
"DATA",811.8,246,100,19,0)
<FILEMAN_FILE>
"DATA",811.8,246,100,20,0)
<FILE_NAME>REMINDER LOCATION LIST</FILE_NAME>
"DATA",811.8,246,100,21,0)
<FILE_NUMBER>810.9</FILE_NUMBER>
"DATA",811.8,246,100,22,0)
<POINT_01>VA-MHTC EXCLUSIONS STOPS</POINT_01>
"DATA",811.8,246,100,23,0)
<INTERNAL_ENTRY_NUMBER>35</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,246,100,24,0)
<CHECKSUM>1847922710</CHECKSUM>
"DATA",811.8,246,100,25,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,246,100,26,0)
<FILEMAN_FDA>
"DATA",811.8,246,100,27,0)
<![CDATA[
"DATA",811.8,246,100,28,0)
810.9;+35,;.01~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,29,0)
810.9;+35,;1~WP-start~4
"DATA",811.8,246,100,30,0)
This list of stop codes is used to exclude any 500 series encounter with 
"DATA",811.8,246,100,31,0)
the following Stop Codes as secondary/credit stops: 448,450,707,372,373.  
"DATA",811.8,246,100,32,0)
This exclusion list is used in the VA-MH STOP CODES FOR MHTC DESIGNATION 
"DATA",811.8,246,100,33,0)
Reminder Location List.
"DATA",811.8,246,100,34,0)
810.9;+35,;100~NATIONAL
"DATA",811.8,246,100,35,0)
810.9;+35,;101~Office of Mental Health Services
"DATA",811.8,246,100,36,0)
810.9001;+36,+35,;.01~INTGRTED DIS EVAL (IDES) EXAM
"DATA",811.8,246,100,37,0)
810.9001;+36,+35,;.02~448
"DATA",811.8,246,100,38,0)
810.9001;+37,+35,;.01~COMP & PENS (C&P) EXAMS
"DATA",811.8,246,100,39,0)
810.9001;+37,+35,;.02~450
"DATA",811.8,246,100,40,0)
810.9001;+38,+35,;.01~SMOKING CESSATION
"DATA",811.8,246,100,41,0)
810.9001;+38,+35,;.02~707
"DATA",811.8,246,100,42,0)
810.9001;+39,+35,;.01~MOVE! PGM INDIV
"DATA",811.8,246,100,43,0)
810.9001;+39,+35,;.02~372
"DATA",811.8,246,100,44,0)
810.9001;+40,+35,;.01~MOVE! PGM GROUP
"DATA",811.8,246,100,45,0)
810.9001;+40,+35,;.02~373
"DATA",811.8,246,100,46,0)
810.9002;+41,+35,;.01~05/09/2013@11:29:03
"DATA",811.8,246,100,47,0)
810.9002;+41,+35,;2~WP-start~1
"DATA",811.8,246,100,48,0)
Exchange Stub
"DATA",811.8,246,100,49,0)
]]>
"DATA",811.8,246,100,50,0)
</FILEMAN_FDA>
"DATA",811.8,246,100,51,0)
<IEN_ROOT>
"DATA",811.8,246,100,52,0)
<![CDATA[
"DATA",811.8,246,100,53,0)
36^1
"DATA",811.8,246,100,54,0)
37^2
"DATA",811.8,246,100,55,0)
38^3
"DATA",811.8,246,100,56,0)
39^4
"DATA",811.8,246,100,57,0)
40^5
"DATA",811.8,246,100,58,0)
41^1
"DATA",811.8,246,100,59,0)
]]>
"DATA",811.8,246,100,60,0)
</IEN_ROOT>
"DATA",811.8,246,100,61,0)
</FILEMAN_FILE>
"DATA",811.8,246,100,62,0)
<FILEMAN_FILE>
"DATA",811.8,246,100,63,0)
<FILE_NAME>REMINDER LOCATION LIST</FILE_NAME>
"DATA",811.8,246,100,64,0)
<FILE_NUMBER>810.9</FILE_NUMBER>
"DATA",811.8,246,100,65,0)
<POINT_01>VA-MHTC APPT STOP CODES LL</POINT_01>
"DATA",811.8,246,100,66,0)
<INTERNAL_ENTRY_NUMBER>36</INTERNAL_ENTRY_NUMBER>
"DATA",811.8,246,100,67,0)
<CHECKSUM>4080585971</CHECKSUM>
"DATA",811.8,246,100,68,0)
<SELECTED>YES</SELECTED>
"DATA",811.8,246,100,69,0)
<FILEMAN_FDA>
"DATA",811.8,246,100,70,0)
<![CDATA[
"DATA",811.8,246,100,71,0)
810.9;+36,;.01~VA-MHTC APPT STOP CODES LL
"DATA",811.8,246,100,72,0)
810.9;+36,;1~WP-start~3
"DATA",811.8,246,100,73,0)
This is the Reminder Location List used for encounters to be included and
"DATA",811.8,246,100,74,0)
excluded based on the stop code designations in designating Veterans who
"DATA",811.8,246,100,75,0)
need a Mental Health Treatment Coordinator (MHTC).
"DATA",811.8,246,100,76,0)
810.9;+36,;100~NATIONAL
"DATA",811.8,246,100,77,0)
810.9;+36,;101~Office of Mental Health Services
"DATA",811.8,246,100,78,0)
810.9001;+37,+36,;.01~MENTAL HEALTH CLINIC - IND
"DATA",811.8,246,100,79,0)
810.9001;+37,+36,;.02~502
"DATA",811.8,246,100,80,0)
810.9001;+37,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,81,0)
810.9001;+38,+36,;.01~GRANT & PER DIEM INDIV
"DATA",811.8,246,100,82,0)
810.9001;+38,+36,;.02~511
"DATA",811.8,246,100,83,0)
810.9001;+38,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,84,0)
810.9001;+39,+36,;.01~SUBSTANCE USE DISORDER IND
"DATA",811.8,246,100,85,0)
810.9001;+39,+36,;.02~513
"DATA",811.8,246,100,86,0)
810.9001;+39,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,87,0)
810.9001;+40,+36,;.01~SUB USE DISORDER HOME VST
"DATA",811.8,246,100,88,0)
810.9001;+40,+36,;.02~514
"DATA",811.8,246,100,89,0)
810.9001;+40,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,90,0)
810.9001;+41,+36,;.01~PTSD - GROUP
"DATA",811.8,246,100,91,0)
810.9001;+41,+36,;.02~516
"DATA",811.8,246,100,92,0)
810.9001;+41,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,93,0)
810.9001;+42,+36,;.01~SUBST USE DISORDER/PTSD TEAMS
"DATA",811.8,246,100,94,0)
810.9001;+42,+36,;.02~519
"DATA",811.8,246,100,95,0)
810.9001;+42,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,96,0)
810.9001;+43,+36,;.01~HUD/VASH INDIV
"DATA",811.8,246,100,97,0)
810.9001;+43,+36,;.02~522
"DATA",811.8,246,100,98,0)
810.9001;+43,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,99,0)
810.9001;+44,+36,;.01~OPIOID SUBSTITUTION
"DATA",811.8,246,100,100,0)
810.9001;+44,+36,;.02~523
"DATA",811.8,246,100,101,0)
810.9001;+44,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,102,0)
810.9001;+45,+36,;.01~ACTIVE DUTY SEXUAL TRAUMA
"DATA",811.8,246,100,103,0)
810.9001;+45,+36,;.02~524
"DATA",811.8,246,100,104,0)
810.9001;+45,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,105,0)
810.9001;+46,+36,;.01~WOMEN'S STRESS DISORDER TEAMS
"DATA",811.8,246,100,106,0)
810.9001;+46,+36,;.02~525
"DATA",811.8,246,100,107,0)
810.9001;+46,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,108,0)
810.9001;+47,+36,;.01~HCHV/HCMI INDIV
"DATA",811.8,246,100,109,0)
810.9001;+47,+36,;.02~529
"DATA",811.8,246,100,110,0)
810.9001;+47,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,111,0)
810.9001;+48,+36,;.01~MH RESIDENTIAL CARE IND
"DATA",811.8,246,100,112,0)
810.9001;+48,+36,;.02~503
"DATA",811.8,246,100,113,0)
810.9001;+48,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,114,0)
810.9001;+49,+36,;.01~PSYCHOSOCIAL REHAB - IND
"DATA",811.8,246,100,115,0)
810.9001;+49,+36,;.02~532
"DATA",811.8,246,100,116,0)
810.9001;+49,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,117,0)
810.9001;+50,+36,;.01~MH VOCATIONAL ASSISTANCE - IND
"DATA",811.8,246,100,118,0)
810.9001;+50,+36,;.02~535
"DATA",811.8,246,100,119,0)
810.9001;+50,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,120,0)
810.9001;+51,+36,;.01~PTSD CLINICAL TEAM PTS IND
"DATA",811.8,246,100,121,0)
810.9001;+51,+36,;.02~540
"DATA",811.8,246,100,122,0)
810.9001;+51,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,123,0)
810.9001;+52,+36,;.01~INTNSE SUB USE DSRDER GRP
"DATA",811.8,246,100,124,0)
810.9001;+52,+36,;.02~547
"DATA",811.8,246,100,125,0)
810.9001;+52,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,126,0)
810.9001;+53,+36,;.01~INTNSE SUB USE DSRDER IND
"DATA",811.8,246,100,127,0)
810.9001;+53,+36,;.02~548
"DATA",811.8,246,100,128,0)
810.9001;+53,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,129,0)
810.9001;+54,+36,;.01~MENTAL HEALTH CLINIC-GROUP
"DATA",811.8,246,100,130,0)
810.9001;+54,+36,;.02~550
"DATA",811.8,246,100,131,0)
810.9001;+54,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,132,0)
810.9001;+55,+36,;.01~MHICM - INDIVIDUAL
"DATA",811.8,246,100,133,0)
810.9001;+55,+36,;.02~552
"DATA",811.8,246,100,134,0)
810.9001;+55,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,135,0)
810.9001;+56,+36,;.01~DAY TREATMENT-GROUP
"DATA",811.8,246,100,136,0)
810.9001;+56,+36,;.02~553
"DATA",811.8,246,100,137,0)
810.9001;+56,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,138,0)
810.9001;+57,+36,;.01~DAY HOSPITAL-GROUP
"DATA",811.8,246,100,139,0)
810.9001;+57,+36,;.02~554
"DATA",811.8,246,100,140,0)
810.9001;+57,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,141,0)
810.9001;+58,+36,;.01~PSYCHIATRY - GROUP
"DATA",811.8,246,100,142,0)
810.9001;+58,+36,;.02~557
"DATA",811.8,246,100,143,0)
810.9001;+58,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,144,0)
810.9001;+59,+36,;.01~GRANT & PER DIEM GROUP
"DATA",811.8,246,100,145,0)
810.9001;+59,+36,;.02~504
"DATA",811.8,246,100,146,0)
810.9001;+59,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,147,0)
810.9001;+60,+36,;.01~PSYCHOLOGY-GROUP
"DATA",811.8,246,100,148,0)
810.9001;+60,+36,;.02~558
"DATA",811.8,246,100,149,0)
810.9001;+60,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,150,0)
810.9001;+61,+36,;.01~PSYCHOSOCIAL REHAB - GROUP
"DATA",811.8,246,100,151,0)
810.9001;+61,+36,;.02~559
"DATA",811.8,246,100,152,0)
810.9001;+61,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,153,0)
810.9001;+62,+36,;.01~SUBSTANCE USE DISORDR GRP
"DATA",811.8,246,100,154,0)
810.9001;+62,+36,;.02~560
"DATA",811.8,246,100,155,0)
810.9001;+62,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,156,0)
810.9001;+63,+36,;.01~PCT-POST TRAUMATIC STRESS-GRP
"DATA",811.8,246,100,157,0)
810.9001;+63,+36,;.02~561
"DATA",811.8,246,100,158,0)
810.9001;+63,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,159,0)
810.9001;+64,+36,;.01~PTSD - INDIVIDUAL
"DATA",811.8,246,100,160,0)
810.9001;+64,+36,;.02~562
"DATA",811.8,246,100,161,0)
810.9001;+64,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,162,0)
810.9001;+65,+36,;.01~MHICM - GROUP
"DATA",811.8,246,100,163,0)
810.9001;+65,+36,;.02~567
"DATA",811.8,246,100,164,0)
810.9001;+65,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,165,0)
810.9001;+66,+36,;.01~MH CWT/SE FACE TO FACE
"DATA",811.8,246,100,166,0)
810.9001;+66,+36,;.02~568
"DATA",811.8,246,100,167,0)
810.9001;+66,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,168,0)
810.9001;+67,+36,;.01~SERV-MH INDIVIDUAL
"DATA",811.8,246,100,169,0)
810.9001;+67,+36,;.02~571
"DATA",811.8,246,100,170,0)
810.9001;+67,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,171,0)
810.9001;+68,+36,;.01~SERV-MH GROUP
"DATA",811.8,246,100,172,0)
810.9001;+68,+36,;.02~572
"DATA",811.8,246,100,173,0)
810.9001;+68,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,174,0)
810.9001;+69,+36,;.01~MH INCENTIVE THERAPY F TO F
"DATA",811.8,246,100,175,0)
810.9001;+69,+36,;.02~573
"DATA",811.8,246,100,176,0)
810.9001;+69,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,177,0)
810.9001;+70,+36,;.01~DAY TREATMENT-INDIVIDUAL
"DATA",811.8,246,100,178,0)
810.9001;+70,+36,;.02~505
"DATA",811.8,246,100,179,0)
810.9001;+70,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,180,0)
810.9001;+71,+36,;.01~MH CWT/TWE FACE TO FACE
"DATA",811.8,246,100,181,0)
810.9001;+71,+36,;.02~574
"DATA",811.8,246,100,182,0)
810.9001;+71,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,183,0)
810.9001;+72,+36,;.01~MH VOCATIONAL ASSISTANCE-GRP
"DATA",811.8,246,100,184,0)
810.9001;+72,+36,;.02~575
"DATA",811.8,246,100,185,0)
810.9001;+72,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,186,0)
810.9001;+73,+36,;.01~PSYCHOGERIATRIC - INDIVIDUAL
"DATA",811.8,246,100,187,0)
810.9001;+73,+36,;.02~576
"DATA",811.8,246,100,188,0)
810.9001;+73,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,189,0)
810.9001;+74,+36,;.01~PSYCHOGERIATRIC - GROUP
"DATA",811.8,246,100,190,0)
810.9001;+74,+36,;.02~577
"DATA",811.8,246,100,191,0)
810.9001;+74,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,192,0)
810.9001;+75,+36,;.01~PTSD DAY HOSPITAL
"DATA",811.8,246,100,193,0)
810.9001;+75,+36,;.02~580
"DATA",811.8,246,100,194,0)
810.9001;+75,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,195,0)
810.9001;+76,+36,;.01~PRRC INDIVIDUAL
"DATA",811.8,246,100,196,0)
810.9001;+76,+36,;.02~582
"DATA",811.8,246,100,197,0)
810.9001;+76,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,198,0)
810.9001;+77,+36,;.01~PRRC GROUP
"DATA",811.8,246,100,199,0)
810.9001;+77,+36,;.02~583
"DATA",811.8,246,100,200,0)
810.9001;+77,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,201,0)
810.9001;+78,+36,;.01~RRTP AFTERCARE IND
"DATA",811.8,246,100,202,0)
810.9001;+78,+36,;.02~588
"DATA",811.8,246,100,203,0)
810.9001;+78,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,204,0)
810.9001;+79,+36,;.01~DAY HOSPITAL-INDIVIDUAL
"DATA",811.8,246,100,205,0)
810.9001;+79,+36,;.02~506
"DATA",811.8,246,100,206,0)
810.9001;+79,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,207,0)
810.9001;+80,+36,;.01~HUD/VASH GROUP
"DATA",811.8,246,100,208,0)
810.9001;+80,+36,;.02~507
"DATA",811.8,246,100,209,0)
810.9001;+80,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,210,0)
810.9001;+81,+36,;.01~HCHV/HCMI GROUP
"DATA",811.8,246,100,211,0)
810.9001;+81,+36,;.02~508
"DATA",811.8,246,100,212,0)
810.9001;+81,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,213,0)
810.9001;+82,+36,;.01~PSYCHIATRY - INDIVIDUAL
"DATA",811.8,246,100,214,0)
810.9001;+82,+36,;.02~509
"DATA",811.8,246,100,215,0)
810.9001;+82,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,216,0)
810.9001;+83,+36,;.01~PSYCHOLOGY-INDIVIDUAL
"DATA",811.8,246,100,217,0)
810.9001;+83,+36,;.02~510
"DATA",811.8,246,100,218,0)
810.9001;+83,+36,;2~VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,100,219,0)
810.9002;+84,+36,;.01~05/09/2013@11:29:03
"DATA",811.8,246,100,220,0)
810.9002;+84,+36,;2~WP-start~1
"DATA",811.8,246,100,221,0)
Exchange Stub
"DATA",811.8,246,100,222,0)
]]>
"DATA",811.8,246,100,223,0)
</FILEMAN_FDA>
"DATA",811.8,246,100,224,0)
<IEN_ROOT>
"DATA",811.8,246,100,225,0)
<![CDATA[
"DATA",811.8,246,100,226,0)
37^1
"DATA",811.8,246,100,227,0)
38^10
"DATA",811.8,246,100,228,0)
39^11
"DATA",811.8,246,100,229,0)
40^12
"DATA",811.8,246,100,230,0)
41^13
"DATA",811.8,246,100,231,0)
42^14
"DATA",811.8,246,100,232,0)
43^15
"DATA",811.8,246,100,233,0)
44^16
"DATA",811.8,246,100,234,0)
45^17
"DATA",811.8,246,100,235,0)
46^18
"DATA",811.8,246,100,236,0)
47^19
"DATA",811.8,246,100,237,0)
48^2
"DATA",811.8,246,100,238,0)
49^20
"DATA",811.8,246,100,239,0)
50^21
"DATA",811.8,246,100,240,0)
51^22
"DATA",811.8,246,100,241,0)
52^23
"DATA",811.8,246,100,242,0)
53^24
"DATA",811.8,246,100,243,0)
54^25
"DATA",811.8,246,100,244,0)
55^26
"DATA",811.8,246,100,245,0)
56^27
"DATA",811.8,246,100,246,0)
57^28
"DATA",811.8,246,100,247,0)
58^29
"DATA",811.8,246,100,248,0)
59^3
"DATA",811.8,246,100,249,0)
60^30
"DATA",811.8,246,100,250,0)
61^31
"DATA",811.8,246,100,251,0)
62^32
"DATA",811.8,246,100,252,0)
63^33
"DATA",811.8,246,100,253,0)
64^34
"DATA",811.8,246,100,254,0)
65^35
"DATA",811.8,246,100,255,0)
66^36
"DATA",811.8,246,100,256,0)
67^37
"DATA",811.8,246,100,257,0)
68^38
"DATA",811.8,246,100,258,0)
69^39
"DATA",811.8,246,100,259,0)
70^4
"DATA",811.8,246,100,260,0)
71^40
"DATA",811.8,246,100,261,0)
72^41
"DATA",811.8,246,100,262,0)
73^42
"DATA",811.8,246,100,263,0)
74^43
"DATA",811.8,246,100,264,0)
75^44
"DATA",811.8,246,100,265,0)
76^45
"DATA",811.8,246,100,266,0)
77^46
"DATA",811.8,246,100,267,0)
78^47
"DATA",811.8,246,100,268,0)
79^5
"DATA",811.8,246,100,269,0)
80^6
"DATA",811.8,246,100,270,0)
81^7
"DATA",811.8,246,100,271,0)
82^8
"DATA",811.8,246,100,272,0)
83^9
"DATA",811.8,246,100,273,0)
84^1
"DATA",811.8,246,100,274,0)
]]>
"DATA",811.8,246,100,275,0)
</IEN_ROOT>
"DATA",811.8,246,100,276,0)
</FILEMAN_FILE>
"DATA",811.8,246,100,277,0)
<INDEX>
"DATA",811.8,246,100,278,0)
<NUMBER_OF_COMPONENTS>2</NUMBER_OF_COMPONENTS>
"DATA",811.8,246,100,279,0)
<COMPONENT>
"DATA",811.8,246,100,280,0)
<FDA_END>48</FDA_END>
"DATA",811.8,246,100,281,0)
<FDA_START>28</FDA_START>
"DATA",811.8,246,100,282,0)
<FILE_START>19</FILE_START>
"DATA",811.8,246,100,283,0)
<IEN_ROOT_END>58</IEN_ROOT_END>
"DATA",811.8,246,100,284,0)
<IEN_ROOT_START>53</IEN_ROOT_START>
"DATA",811.8,246,100,285,0)
</COMPONENT>
"DATA",811.8,246,100,286,0)
<COMPONENT>
"DATA",811.8,246,100,287,0)
<FDA_END>221</FDA_END>
"DATA",811.8,246,100,288,0)
<FDA_START>71</FDA_START>
"DATA",811.8,246,100,289,0)
<FILE_START>62</FILE_START>
"DATA",811.8,246,100,290,0)
<IEN_ROOT_END>273</IEN_ROOT_END>
"DATA",811.8,246,100,291,0)
<IEN_ROOT_START>226</IEN_ROOT_START>
"DATA",811.8,246,100,292,0)
</COMPONENT>
"DATA",811.8,246,100,293,0)
</INDEX>
"DATA",811.8,246,100,294,0)
</REMINDER_EXCHANGE_FILE_ENTRY>
"DATA",811.8,246,110,0)
^811.804^13^13
"DATA",811.8,246,110,1,0)
Source:      TROST,DEBBIE at SALT LAKE CITY OIFO
"DATA",811.8,246,110,2,0)
Date Packed: 05/09/2013@11:28:49
"DATA",811.8,246,110,3,0)
Package Version: 2.0P30
"DATA",811.8,246,110,4,0)

"DATA",811.8,246,110,5,0)
Description:
"DATA",811.8,246,110,6,0)
The following Clinical Reminder items were selected for packing:
"DATA",811.8,246,110,7,0)
REMINDER LOCATION LIST
"DATA",811.8,246,110,8,0)
  VA-MHTC EXCLUSIONS STOPS
"DATA",811.8,246,110,9,0)
  VA-MHTC APPT STOP CODES LL
"DATA",811.8,246,110,10,0)

"DATA",811.8,246,110,11,0)
Keywords:
"DATA",811.8,246,110,12,0)

"DATA",811.8,246,110,13,0)
Components:
"DATA",811.8,246,119)
1
"DATA",811.8,246,120,0)
^811.802A^2^2
"DATA",811.8,246,120,1,0)
REMINDER LOCATION LIST^810.9^2
"DATA",811.8,246,120,1,1,0)
^811.8021A^2^2
"DATA",811.8,246,120,1,1,1,0)
VA-MHTC EXCLUSIONS STOPS^28^48^53^58^1^1
"DATA",811.8,246,120,1,1,2,0)
VA-MHTC APPT STOP CODES LL^71^221^226^273^1^1
"FIA",811.4)
REMINDER COMPUTED FINDINGS
"FIA",811.4,0)
^PXRMD(811.4,
"FIA",811.4,0,0)
811.4OI
"FIA",811.4,0,1)
y^y^f^^y^^y^r^n
"FIA",811.4,0,10)

"FIA",811.4,0,11)
I $$CFINC^PXRMP24I(Y)
"FIA",811.4,0,"RLRO")

"FIA",811.4,0,"VR")
2.0^PXRM
"FIA",811.4,811.4)
0
"FIA",811.4,811.41)
0
"FIA",811.4,811.42)
0
"FIA",811.4,811.422)
0
"FIA",811.8)
REMINDER EXCHANGE
"FIA",811.8,0)
^PXD(811.8,
"FIA",811.8,0,0)
811.8s
"FIA",811.8,0,1)
n^n^f^^n^^y^o^n
"FIA",811.8,0,10)

"FIA",811.8,0,11)
I $$EXFINC^PXRMEXSI(Y,"EXARRAY","PXRMP24E")
"FIA",811.8,0,"RLRO")

"FIA",811.8,0,"VR")
2.0^PXRM
"FIA",811.8,811.8)
0
"FIA",811.8,811.801)
0
"FIA",811.8,811.802)
0
"FIA",811.8,811.8021)
0
"FIA",811.8,811.803)
0
"FIA",811.8,811.8031)
0
"FIA",811.8,811.80315)
0
"FIA",811.8,811.804)
0
"INI")
PRE^PXRMP24I
"INIT")
POST^PXRMP24I
"IX",811.4,811.4,"B",0)
811.4^B^New style B cross-reference^R^^F^IR^I^811.4^^^^^LS
"IX",811.4,811.4,"B",1)
S ^PXRMD(811.4,"B",$E(X,1,64),DA)=""
"IX",811.4,811.4,"B",2)
K ^PXRMD(811.4,"B",$E(X,1,64),DA)
"IX",811.4,811.4,"B",2.5)
K ^PXRMD(811.4,"B")
"IX",811.4,811.4,"B",11.1,0)
^.114IA^1^1
"IX",811.4,811.4,"B",11.1,1,0)
1^F^811.4^.01^64^1^F
"IX",811.8,811.8,"B",0)
811.8^B^Uniqueness Index for Key 'A' of File #811.8^R^^R^IR^I^811.8^^^^^LS
"IX",811.8,811.8,"B",1)
S ^PXD(811.8,"B",X(1),X(2),DA)=""
"IX",811.8,811.8,"B",2)
K ^PXD(811.8,"B",X(1),X(2),DA)
"IX",811.8,811.8,"B",2.5)
K ^PXD(811.8,"B")
"IX",811.8,811.8,"B",11.1,0)
^.114IA^2^2
"IX",811.8,811.8,"B",11.1,1,0)
1^F^811.8^.01^^1
"IX",811.8,811.8,"B",11.1,2,0)
2^F^811.8^.03^^2
"IX",811.8,811.8,"D",0)
811.8^D^Cross-reference on date and time^R^^F^IR^I^811.8^^^^^LS
"IX",811.8,811.8,"D",1)
S ^PXD(811.8,"D",X,DA)=""
"IX",811.8,811.8,"D",2)
K ^PXD(811.8,"D",X,DA)
"IX",811.8,811.8,"D",2.5)
K ^PXD(811.8,"D")
"IX",811.8,811.8,"D",11.1,0)
^.114IA^1^1
"IX",811.8,811.8,"D",11.1,1,0)
1^F^811.8^.03^^1^F
"IX",811.8,811.8,"D",11.1,1,3)

"IX",811.8,811.803,"B",0)
811.803^B^New style B cross-reference^R^^F^IR^I^811.803^^^^^LS
"IX",811.8,811.803,"B",1)
S ^PXD(811.8,DA(1),130,"B",X,DA)=""
"IX",811.8,811.803,"B",2)
K ^PXD(811.8,DA(1),130,"B",X,DA)
"IX",811.8,811.803,"B",2.5)
K ^PXD(811.8,DA(1),130,"B")
"IX",811.8,811.803,"B",11.1,0)
^.114IA^1^1
"IX",811.8,811.803,"B",11.1,1,0)
1^F^811.803^.01^^1^F
"KEY",811.4,811.4,"A",0)
811.4^A^P^748
"KEY",811.4,811.4,"A",2,0)
^.312IA^1^1
"KEY",811.4,811.4,"A",2,1,0)
.01^811.4^1
"KEY",811.8,811.8,"A",0)
811.8^A^P^743
"KEY",811.8,811.8,"A",2,0)
^.312IA^2^2
"KEY",811.8,811.8,"A",2,1,0)
.01^811.8^1
"KEY",811.8,811.8,"A",2,2,0)
.03^811.8^2
"KEYPTR",811.4,811.4,"A")
811.4^B
"KEYPTR",811.8,811.8,"A")
811.8^B
"MBREQ")
1
"PGL",811.4,100,2,101)
SPONSOR^P811.6^PXRMD(811.6,^100;2^Q
"PGL",811.42,0,2,1)
EDIT BY^P200'^VA(200,^0;2^Q
"PKG",364,-1)
1^1
"PKG",364,0)
CLINICAL REMINDERS^PXRM^Clinical Reminders^^^3011030
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
2.0^3050204
"PKG",364,22,1,"PAH",1,0)
24^3130509^1342
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3130509
"PKG",364,22,1,"PAH",1,1,1,0)
High Risk Mental Health phase 2.
"PKG",364,22,1,"PAH",1,1,2,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
30
"RTN","PXRM")
0^16^B37992293
"RTN","PXRM",1,0)
PXRM ;SLC/PKR - Clinical Reminders entry points. ;10/02/2012
"RTN","PXRM",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,11,12,16,18,24**;Feb 04, 2005;Build 193
"RTN","PXRM",3,0)
 ;Entry points in this routine are listed in DBIA #2182.
"RTN","PXRM",4,0)
 ;==========================================================
"RTN","PXRM",5,0)
MAIN(DFN,PXRMITEM,OUTTYPE,DISC) ;Main driver for clinical reminders.
"RTN","PXRM",6,0)
 ;INPUT  DFN - Pointer to Patient File (#2)
"RTN","PXRM",7,0)
 ;       PXRMITEM - IEN of reminder to evaluate.
"RTN","PXRM",8,0)
 ;       OUTTYPE - Flag to indicate type of output information.
"RTN","PXRM",9,0)
 ;         0 - Reminders DUE NOW only (CLINICAL REMINDERS DUE
"RTN","PXRM",10,0)
 ;             HS component)
"RTN","PXRM",11,0)
 ;         1 - All Reminders with Next and Last Information
"RTN","PXRM",12,0)
 ;             (CLINICAL REMINDERS SUMMARY HS component)
"RTN","PXRM",13,0)
 ;         5 - Health Maintenance (CLINICAL REMINDERS MAINTENANCE
"RTN","PXRM",14,0)
 ;              HS component)
"RTN","PXRM",15,0)
 ;        10 - MyHealtheVet summary
"RTN","PXRM",16,0)
 ;        11 - MyHealtheVet detailed
"RTN","PXRM",17,0)
 ;        12 - MyHealtheVet combined
"RTN","PXRM",18,0)
 ;        55 - Order check
"RTN","PXRM",19,0)
 ;        DISC - (optional) if this is true then the disclaimer will
"RTN","PXRM",20,0)
 ;             be loaded in ^TMP("PXRM",$J,"DISC").
"RTN","PXRM",21,0)
 ;
"RTN","PXRM",22,0)
 ;OUTPUT  ^TMP("PXRHM",$J,PXRMITEM,PXRMRNAM)=
"RTN","PXRM",23,0)
 ;              STATUS_U_DUE DATE_U_LAST DONE
"RTN","PXRM",24,0)
 ;        where PXRMRNAM is the PRINT NAME or if it is undefined then
"RTN","PXRM",25,0)
 ;        it is the NAME (.01).
"RTN","PXRM",26,0)
 ;        For the Clinical Maintenance component, OUTTYPE=5, there is 
"RTN","PXRM",27,0)
 ;        subsequent output of the form
"RTN","PXRM",28,0)
 ;        ^TMP("PXRHM",$J,PXRMITEM,PXRMRNAM,"TXT",N)=TEXT
"RTN","PXRM",29,0)
 ;        where N is a number and TEXT is a text string.
"RTN","PXRM",30,0)
 ;
"RTN","PXRM",31,0)
 ;        If DISC is true then the disclaimer will be loaded into
"RTN","PXRM",32,0)
 ;        ^TMP("PXRM",$J,"DISC"). The calling application should
"RTN","PXRM",33,0)
 ;        delete this when it is done.
"RTN","PXRM",34,0)
 ;
"RTN","PXRM",35,0)
 ;        The calling application can display the contents of these
"RTN","PXRM",36,0)
 ;        two ^TMP arrays as it chooses. The caller should also make
"RTN","PXRM",37,0)
 ;        sure the ^TMP globals are killed before it exits.
"RTN","PXRM",38,0)
 ;
"RTN","PXRM",39,0)
 N DEFARR,EVALDT,FIEVAL
"RTN","PXRM",40,0)
 ;Load the definition into DEFARR.
"RTN","PXRM",41,0)
 D DEF^PXRMLDR(PXRMITEM,.DEFARR)
"RTN","PXRM",42,0)
 ;
"RTN","PXRM",43,0)
 I $G(NODISC)="" S NODISC=1
"RTN","PXRM",44,0)
 I $D(GMFLAG) S NODISC=0
"RTN","PXRM",45,0)
 S EVALDT=$$NOW^XLFDT
"RTN","PXRM",46,0)
 D EVAL(DFN,.DEFARR,OUTTYPE,NODISC,.FIEVAL,EVALDT)
"RTN","PXRM",47,0)
 Q
"RTN","PXRM",48,0)
 ;
"RTN","PXRM",49,0)
 ;==========================================================
"RTN","PXRM",50,0)
MAINDF(DFN,PXRMITEM,OUTTYPE,EVALDT) ;Alternate entry point that allows
"RTN","PXRM",51,0)
 ;evaluation date/time as input parameter and saves FIEVAL in
"RTN","PXRM",52,0)
 ;^TMP("PXRHM,$J,PXRMITEM,"FIEVAL").
"RTN","PXRM",53,0)
 N DEFARR,FIEVAL
"RTN","PXRM",54,0)
 D DEF^PXRMLDR(PXRMITEM,.DEFARR)
"RTN","PXRM",55,0)
 D EVAL(DFN,.DEFARR,OUTTYPE,0,.FIEVAL,EVALDT)
"RTN","PXRM",56,0)
 M ^TMP("PXRHM",$J,PXRMITEM,"FIEVAL")=FIEVAL
"RTN","PXRM",57,0)
 Q
"RTN","PXRM",58,0)
 ;
"RTN","PXRM",59,0)
 ;==========================================================
"RTN","PXRM",60,0)
EVAL(DFN,DEFARR,OUTTYPE,NODISC,FIEVAL,DATE) ;Reminder evaluation entry
"RTN","PXRM",61,0)
 ;point. This entry point uses the local array DEFARR for the reminder
"RTN","PXRM",62,0)
 ;definition and returns the Finding Evaluation Array, FIEVAL.
"RTN","PXRM",63,0)
 ;PXRM namespaced variables are the reminder evaluation "global"
"RTN","PXRM",64,0)
 ;variables. If date is specified then the reminder will be evaluated
"RTN","PXRM",65,0)
 ;as if the current date is DATE.
"RTN","PXRM",66,0)
 N PXRMAGE,PXRMDATE,PXRMDOB,PXRMDOD,PXRMLAD,PXRMPDEM,PXRMPID
"RTN","PXRM",67,0)
 N PXRMITEM,PXRMRM,PXRMRNAM,PXRMSEX,PXRMXTLK
"RTN","PXRM",68,0)
 ;Make sure the reminder exists.
"RTN","PXRM",69,0)
 I $D(DEFARR("DNE")) D NODEF^PXRMERRH(DEFARR("IEN")) Q
"RTN","PXRM",70,0)
 ;PXRMRM is the right margin for output.
"RTN","PXRM",71,0)
 S PXRMRM=80
"RTN","PXRM",72,0)
 S PXRMDATE=+$G(DATE)
"RTN","PXRM",73,0)
 S PXRMITEM=DEFARR("IEN")
"RTN","PXRM",74,0)
 S PXRMPID="PXRM"_PXRMITEM_$H
"RTN","PXRM",75,0)
 N D00
"RTN","PXRM",76,0)
 S D00=DEFARR(0)
"RTN","PXRM",77,0)
 S PXRMRNAM=$P(D00,U,3)
"RTN","PXRM",78,0)
 ;If the print name is null use the .01.
"RTN","PXRM",79,0)
 I PXRMRNAM="" S PXRMRNAM=$P(D00,U,1)
"RTN","PXRM",80,0)
 ;
"RTN","PXRM",81,0)
 ;Set the error handler to the PXRMERRH routine. Use the new style of
"RTN","PXRM",82,0)
 ;error trapping.
"RTN","PXRM",83,0)
 N $ES,$ET
"RTN","PXRM",84,0)
 S $ET="D ERRHDLR^PXRMERRH"
"RTN","PXRM",85,0)
 ;
"RTN","PXRM",86,0)
 ;Initialize the ^TMP arrays.
"RTN","PXRM",87,0)
 K ^TMP("PXRHM",$J,PXRMITEM),^TMP(PXRMPID,$J,PXRMITEM)
"RTN","PXRM",88,0)
 ;
"RTN","PXRM",89,0)
 N DUE,DUEDATE,FREQ,PCLOGIC,RESDATE,RESLOGIC
"RTN","PXRM",90,0)
 ;Make sure the reminder is active.
"RTN","PXRM",91,0)
 I $P(D00,U,6) D  G OUTPUT
"RTN","PXRM",92,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"N/A","INACTIVE")="The reminder "_PXRMRNAM_" was inactivated "_$$FMTE^XLFDT($P(D00,U,7),"5Z")
"RTN","PXRM",93,0)
 . S PXRMPDEM("DFN")=DFN,PCLOGIC=0,RESLOGIC="",DUE="",DUEDATE=0
"RTN","PXRM",94,0)
 . S RESDATE="",FREQ="0Y"
"RTN","PXRM",95,0)
 ;
"RTN","PXRM",96,0)
 ;Make sure the "E" node exists
"RTN","PXRM",97,0)
 I $D(DEFARR(20))&'$D(DEFARR("E")) D  G EXIT
"RTN","PXRM",98,0)
 . W !,"Reminder definition is corrupted, ENODE is missing cannot continue!"
"RTN","PXRM",99,0)
 . S ^TMP("PXRHM",$J,PXRMITEM,PXRMRNAM)="ERROR"_U_"E NODE MISSING"
"RTN","PXRM",100,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NO ENODE")=""
"RTN","PXRM",101,0)
 ;
"RTN","PXRM",102,0)
 ;Establish the main findings evaluation variables.
"RTN","PXRM",103,0)
 S (DUE,DUEDATE,FREQ,RESDATE)=0
"RTN","PXRM",104,0)
 S (PCLOGIC,RESLOGIC)=""
"RTN","PXRM",105,0)
 ;
"RTN","PXRM",106,0)
 ;Establish the patient demographic information.
"RTN","PXRM",107,0)
 N TODAY
"RTN","PXRM",108,0)
 S TODAY=$G(DATE,DT)
"RTN","PXRM",109,0)
 D DEM^PXRMPINF(DFN,TODAY,.PXRMPDEM)
"RTN","PXRM",110,0)
 I PXRMPDEM("PATIENT")="" D  G EXIT
"RTN","PXRM",111,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","PATIENT","NO PAT")="DFN "_DFN_" IS NOT A VALID PATIENT"
"RTN","PXRM",112,0)
 . S PCLOGIC=0
"RTN","PXRM",113,0)
 ;
"RTN","PXRM",114,0)
 ;Load the local demographic variables for use in condition.
"RTN","PXRM",115,0)
 S PXRMAGE=PXRMPDEM("AGE"),PXRMDOB=PXRMPDEM("DOB"),PXRMDOD=PXRMPDEM("DOD")
"RTN","PXRM",116,0)
 S PXRMLAD=PXRMPDEM("LAD"),PXRMSEX=PXRMPDEM("SEX")
"RTN","PXRM",117,0)
 ;
"RTN","PXRM",118,0)
 ;Check for a date of death.
"RTN","PXRM",119,0)
 I PXRMPDEM("DOD")'="" D
"RTN","PXRM",120,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"N/A","DEAD")=""
"RTN","PXRM",121,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"DEAD")="Patient is deceased."
"RTN","PXRM",122,0)
 ;
"RTN","PXRM",123,0)
 ;If the component is CR and the patient is deceased we are done.
"RTN","PXRM",124,0)
 I OUTTYPE=0,PXRMPDEM("DOD")'="",'$G(PXRMIDOD) G OUTPUT
"RTN","PXRM",125,0)
 ;
"RTN","PXRM",126,0)
 ;Check for a sex specific reminder.
"RTN","PXRM",127,0)
 N SEXOK
"RTN","PXRM",128,0)
 S SEXOK=$$SEX^PXRMLOG(.DEFARR,PXRMPDEM("SEX"))
"RTN","PXRM",129,0)
 S FIEVAL("SEX")=SEXOK
"RTN","PXRM",130,0)
 ;If the patient is the wrong sex then don't do anything else.
"RTN","PXRM",131,0)
 I 'SEXOK D  G OUTPUT
"RTN","PXRM",132,0)
 . S PCLOGIC=0
"RTN","PXRM",133,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"N/A","SEX")=""
"RTN","PXRM",134,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"INFO","SEX")="Patient is the wrong sex!"
"RTN","PXRM",135,0)
 ;
"RTN","PXRM",136,0)
 ;Evaluate the findings.
"RTN","PXRM",137,0)
 S PXRMXTLK=""
"RTN","PXRM",138,0)
 D EVAL^PXRMEVFI(DFN,.DEFARR,.FIEVAL)
"RTN","PXRM",139,0)
 I +PXRMXTLK>0 D  G OUTPUT
"RTN","PXRM",140,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","EXPANDED TAXONOMY","NO LOCK")="NO LOCK for ien "_+PXRMXTLK
"RTN","PXRM",141,0)
 . S PCLOGIC=0
"RTN","PXRM",142,0)
 ;
"RTN","PXRM",143,0)
 ;Check for missing index.
"RTN","PXRM",144,0)
 I $D(^TMP(PXRMPID,$J,PXRMITEM,"WARNING","MISSING INDEX")) D  G OUTPUT
"RTN","PXRM",145,0)
 . S (DUE,DUEDATE)="CNBD",PCLOGIC=1
"RTN","PXRM",146,0)
 ;
"RTN","PXRM",147,0)
 ;Evaluate the Patient Cohort Logic.
"RTN","PXRM",148,0)
 D EVALPCL^PXRMLOG(.DEFARR,.PXRMPDEM,.FREQ,.PCLOGIC,.FIEVAL)
"RTN","PXRM",149,0)
 ;
"RTN","PXRM",150,0)
 ;Evaluate the resolution logic and get the last resolution date.
"RTN","PXRM",151,0)
 D EVALRESL^PXRMLOG(.DEFARR,.RESDATE,.RESLOGIC,.FIEVAL)
"RTN","PXRM",152,0)
 ;
"RTN","PXRM",153,0)
 ;If the reminder is applicable calculate the due date.
"RTN","PXRM",154,0)
 I PCLOGIC D DUE^PXRMDATE(.DEFARR,RESDATE,FREQ,.DUE,.DUEDATE,.FIEVAL)
"RTN","PXRM",155,0)
 ;
"RTN","PXRM",156,0)
OUTPUT ;Prepare the final output.
"RTN","PXRM",157,0)
 D OUTPUT^PXRMOUTD(OUTTYPE,.DEFARR,.PXRMPDEM,PCLOGIC,RESLOGIC,DUE,DUEDATE,RESDATE,FREQ,.FIEVAL)
"RTN","PXRM",158,0)
 ;
"RTN","PXRM",159,0)
EXIT ;Kill the working arrays unless this was a test run.
"RTN","PXRM",160,0)
 K ^TMP($J,"SVC",DFN)
"RTN","PXRM",161,0)
 I $G(PXRMDEBG) D
"RTN","PXRM",162,0)
 . S PXRMID=PXRMPID
"RTN","PXRM",163,0)
 . S FIEVAL("PATIENT AGE")=$G(PXRMPDEM("AGE"))
"RTN","PXRM",164,0)
 . S FIEVAL("DFN")=DFN
"RTN","PXRM",165,0)
 . S FIEVAL("EVAL DATE/TIME")=$$NOW^PXRMDATE
"RTN","PXRM",166,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"REMINDER NAME")=$G(PXRMRNAM)
"RTN","PXRM",167,0)
 E  K ^TMP(PXRMPID,$J)
"RTN","PXRM",168,0)
 ;
"RTN","PXRM",169,0)
 ;I DISC is true load the disclaimer.
"RTN","PXRM",170,0)
 I $G(DISC) D LOAD^PXRMDISC
"RTN","PXRM",171,0)
 Q
"RTN","PXRM",172,0)
 ;
"RTN","PXRM",173,0)
 ;==========================================================
"RTN","PXRM",174,0)
FIDATA(DFN,PXRMITEM,FINDINGS) ;Return the finding evaluation array to the
"RTN","PXRM",175,0)
 ;caller in the array FINDINGS. The caller should use the form
"RTN","PXRM",176,0)
 ;D FIDATA^PXRM(DFN,PXRMITEM,.FINDINGS)
"RTN","PXRM",177,0)
 ;The elements of the FINDINGS array will correspond to the
"RTN","PXRM",178,0)
 ;findings in the reminder definition. For finding N FINDINGS(N)
"RTN","PXRM",179,0)
 ;will be 0 if the finding is false and 1 if it is true. For
"RTN","PXRM",180,0)
 ;true findings there will be additional elements. The exact set
"RTN","PXRM",181,0)
 ;of additional elements will depend of the type of finding.
"RTN","PXRM",182,0)
 ;Some typical examples are:
"RTN","PXRM",183,0)
 ;FINDINGS(N)=1
"RTN","PXRM",184,0)
 ;FINDINGS(N,"DATE")=FileMan date
"RTN","PXRM",185,0)
 ;FINDINGS(N,"FINDING")=variable pointer to the finding
"RTN","PXRM",186,0)
 ;FINDINGS(N,"FILE NUMBER")=file number of data source
"RTN","PXRM",187,0)
 ;FINDINGS(N,"VALUE")=value of the finding, for example the
"RTN","PXRM",188,0)
 ;                    value of a lab test
"RTN","PXRM",189,0)
 ;
"RTN","PXRM",190,0)
 N DEFARR,FI,FIEVAL
"RTN","PXRM",191,0)
 ;Load the definition into DEFARR.
"RTN","PXRM",192,0)
 D DEF^PXRMLDR(PXRMITEM,.DEFARR)
"RTN","PXRM",193,0)
 D EVAL(DFN,.DEFARR,0,1,.FIEVAL)
"RTN","PXRM",194,0)
 K ^TMP("PXRM",$J),^TMP("PXRHM",$J)
"RTN","PXRM",195,0)
 ;Load the FINDINGS array.
"RTN","PXRM",196,0)
 S FI=0
"RTN","PXRM",197,0)
 F  S FI=+$O(FIEVAL(FI)) Q:FI=0  D
"RTN","PXRM",198,0)
 . S FINDINGS(FI)=FIEVAL(FI)
"RTN","PXRM",199,0)
 . I 'FIEVAL(FI) Q
"RTN","PXRM",200,0)
 . S FINDINGS(FI,"DATE")=FIEVAL(FI,"DATE")
"RTN","PXRM",201,0)
 . I FIEVAL(FI,"FINDING")["PSDRUG" S FINDINGS(FI,"DRUG")=1
"RTN","PXRM",202,0)
 . S FINDINGS(FI,"FILE NUMBER")=FIEVAL(FI,"FILE NUMBER")
"RTN","PXRM",203,0)
 . S FINDINGS(FI,"FINDING")=FIEVAL(FI,"FINDING")
"RTN","PXRM",204,0)
 . I $D(FIEVAL(FI,"TERM")) S FINDINGS(FI,"TERM")=FIEVAL(FI,"TERM")
"RTN","PXRM",205,0)
 . I $D(FIEVAL(FI,"VALUE")) S (FINDINGS(FI,"RESULT"),FINDINGS(FI,"VALUE"))=FIEVAL(FI,"VALUE")
"RTN","PXRM",206,0)
 . I $D(FIEVAL(FI,"VISIT")) S FINDINGS(FI,"VIEN")=FIEVAL(FI,"VISIT")
"RTN","PXRM",207,0)
 Q
"RTN","PXRM",208,0)
 ;
"RTN","PXRM",209,0)
 ;==========================================================
"RTN","PXRM",210,0)
INACTIVE(PXRMITEM) ;Return the INACTIVE FLAG, which has a value of 1
"RTN","PXRM",211,0)
 ;if the reminder is inactive.
"RTN","PXRM",212,0)
 I '$D(^PXD(811.9,PXRMITEM)) Q 1
"RTN","PXRM",213,0)
 Q $P(^PXD(811.9,PXRMITEM,0),U,6)
"RTN","PXRM",214,0)
 ;
"RTN","PXRMCDEF")
0^12^B2284758
"RTN","PXRMCDEF",1,0)
PXRMCDEF ;SLC/AGP - Computed findings for Reminder Definition. ;11/20/2012
"RTN","PXRMCDEF",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMCDEF",3,0)
 ;
"RTN","PXRMCDEF",4,0)
 ;======================================================
"RTN","PXRMCDEF",5,0)
RDEF(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for returing a Reminder
"RTN","PXRMCDEF",6,0)
 ;definition evaluation status
"RTN","PXRMCDEF",7,0)
 I TEST="" S TEST=0 Q
"RTN","PXRMCDEF",8,0)
 ;New PXRMFFSS and PXRMTDEB so that reminder test function finding
"RTN","PXRMCDEF",9,0)
 ;and term output is not corrupted.
"RTN","PXRMCDEF",10,0)
 N DEFARR,FIEVAL,NAME,PNAME,RIEN,TEMP,PARAM,PXRMFFSS,PXRMTDEB
"RTN","PXRMCDEF",11,0)
 S NAME=$P(TEST,U)
"RTN","PXRMCDEF",12,0)
 S PARAM=$P(TEST,U,2),PARAM=$P($G(PARAM),"=",2),TEST=0,DATE=$$NOW^PXRMDATE
"RTN","PXRMCDEF",13,0)
 S RIEN=$O(^PXD(811.9,"B",NAME,"")) Q:RIEN'>0
"RTN","PXRMCDEF",14,0)
 I +$P(^PXD(811.9,RIEN,0),U,6)=1 Q
"RTN","PXRMCDEF",15,0)
 K ^TMP("PXRHM",$J,RIEN)
"RTN","PXRMCDEF",16,0)
 S PNAME=$S($P($G(^PXD(811.9,RIEN,0)),U,3)'="":$P(^PXD(811.9,RIEN,0),U,3),1:NAME)
"RTN","PXRMCDEF",17,0)
 ;Load the definition into DEFARR.
"RTN","PXRMCDEF",18,0)
 D DEF^PXRMLDR(RIEN,.DEFARR)
"RTN","PXRMCDEF",19,0)
 D EVAL^PXRM(DFN,.DEFARR,1,0,.FIEVAL,DATE)
"RTN","PXRMCDEF",20,0)
 S TEMP=$G(^TMP("PXRHM",$J,RIEN,PNAME))
"RTN","PXRMCDEF",21,0)
 K ^TMP("PXRHM",$J,RIEN)
"RTN","PXRMCDEF",22,0)
 S TEST=$S(TEMP="":0,TEMP["ERROR":0,TEMP["CNBD":0,1:1)
"RTN","PXRMCDEF",23,0)
 Q:'TEST
"RTN","PXRMCDEF",24,0)
 S VALUE=$P(TEMP,U)
"RTN","PXRMCDEF",25,0)
 S VALUE("STATUS")=VALUE
"RTN","PXRMCDEF",26,0)
 S VALUE("DUEDATE")=$P(TEMP,U,2)
"RTN","PXRMCDEF",27,0)
 S VALUE("LASTDONE")=$P(TEMP,U,3)
"RTN","PXRMCDEF",28,0)
 Q:PARAM=""
"RTN","PXRMCDEF",29,0)
 I PARAM="DUE DATE",+VALUE("DUEDATE")>0 S DATE=VALUE("DUEDATE")
"RTN","PXRMCDEF",30,0)
 I PARAM="LAST DONE",+VALUE("LASTDONE")>0 S DATE=VALUE("LASTDONE")
"RTN","PXRMCDEF",31,0)
 Q
"RTN","PXRMCDEF",32,0)
 ;
"RTN","PXRMDATE")
0^23^B69746461
"RTN","PXRMDATE",1,0)
PXRMDATE ;SLC/PKR - Clinical Reminders date utilities. ;09/12/2012
"RTN","PXRMDATE",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,12,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMDATE",3,0)
 ;
"RTN","PXRMDATE",4,0)
 ;==================================================
"RTN","PXRMDATE",5,0)
CEFD(FDA) ;Called by the Exchange Utility only if the input packed
"RTN","PXRMDATE",6,0)
 ;reminder was packed under v1.5.  Move Effective Date to Beginning Date.
"RTN","PXRMDATE",7,0)
 N IND
"RTN","PXRMDATE",8,0)
 S IND=""
"RTN","PXRMDATE",9,0)
 F  S IND=$O(FDA(811.902,IND)) Q:IND=""  D
"RTN","PXRMDATE",10,0)
 . I '$D(FDA(811.902,IND,12)) Q
"RTN","PXRMDATE",11,0)
 .;If the EFFECTIVE PERIOD exists don't do anything.
"RTN","PXRMDATE",12,0)
 . I $D(FDA(811.902,IND,9)) Q
"RTN","PXRMDATE",13,0)
 . S FDA(811.902,IND,9)=FDA(811.902,IND,12)
"RTN","PXRMDATE",14,0)
 . K FDA(811.902,IND,12)
"RTN","PXRMDATE",15,0)
 Q
"RTN","PXRMDATE",16,0)
 ;
"RTN","PXRMDATE",17,0)
 ;==================================================
"RTN","PXRMDATE",18,0)
COMPARE(X) ;Compare beginning and ending dates, give a warning if
"RTN","PXRMDATE",19,0)
 ;Ending Date comes before Beginning Date. Called by ADATE xref in
"RTN","PXRMDATE",20,0)
 ;definitions and terms.
"RTN","PXRMDATE",21,0)
 ;Do not execute as part of exchange.
"RTN","PXRMDATE",22,0)
 I $G(PXRMEXCH) Q
"RTN","PXRMDATE",23,0)
 N BDT,EDT,TEXT
"RTN","PXRMDATE",24,0)
 ;Dates that are only defined during evaluation, i.e., FIEVAL(2,"DATE")
"RTN","PXRMDATE",25,0)
 ;cannot be checked here.
"RTN","PXRMDATE",26,0)
 S BDT=$S(X(1)'="":$$CTFMD^PXRMDATE(X(1)),1:0)
"RTN","PXRMDATE",27,0)
 I BDT=-1 Q
"RTN","PXRMDATE",28,0)
 S EDT=X(2)
"RTN","PXRMDATE",29,0)
 I EDT="" S EDT="T"
"RTN","PXRMDATE",30,0)
 S EDT=$$CTFMD^PXRMDATE(EDT)
"RTN","PXRMDATE",31,0)
 I EDT=-1 Q
"RTN","PXRMDATE",32,0)
 ;If EDT does not contain a time set it to the end of the day.
"RTN","PXRMDATE",33,0)
 I EDT'["." S EDT=EDT_".235959"
"RTN","PXRMDATE",34,0)
 I EDT<BDT D
"RTN","PXRMDATE",35,0)
 . S BDT=$S(X(1)'="":X(1),1:"")
"RTN","PXRMDATE",36,0)
 . S EDT=$S(X(2)'="":X(2),1:"T@2400")
"RTN","PXRMDATE",37,0)
 . S TEXT="Warning the ending date ("_EDT_") is before the beginning date ("_BDT_")"
"RTN","PXRMDATE",38,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMDATE",39,0)
 Q
"RTN","PXRMDATE",40,0)
 ;
"RTN","PXRMDATE",41,0)
 ;==================================================
"RTN","PXRMDATE",42,0)
COTN(EFP) ;Convert an Effective Period to the new date/time format.
"RTN","PXRMDATE",43,0)
 ;Possible effective periods are ND, NM, or NY where N is an integer.
"RTN","PXRMDATE",44,0)
 S EFP=$$UP^XLFSTR(EFP)
"RTN","PXRMDATE",45,0)
 I (EFP?1N.N1"D")!(EFP?1N.N1"M")!(EFP?1N.N1"Y") D
"RTN","PXRMDATE",46,0)
 . S NUM=+EFP
"RTN","PXRMDATE",47,0)
 . S EFP=$S(NUM=0:"T",1:"T-"_EFP)
"RTN","PXRMDATE",48,0)
 Q EFP
"RTN","PXRMDATE",49,0)
 ;
"RTN","PXRMDATE",50,0)
 ;==================================================
"RTN","PXRMDATE",51,0)
CTD(MULT,NUM) ;Convert months or years to days.
"RTN","PXRMDATE",52,0)
 N DAYS,INTDAYS,FRAC
"RTN","PXRMDATE",53,0)
 S DAYS=MULT*NUM
"RTN","PXRMDATE",54,0)
 ;Round the number of days.
"RTN","PXRMDATE",55,0)
 S INTDAYS=+$P(DAYS,".",1)
"RTN","PXRMDATE",56,0)
 S FRAC=DAYS-INTDAYS
"RTN","PXRMDATE",57,0)
 S DAYS=$S(FRAC<0.5:INTDAYS,1:INTDAYS+1)
"RTN","PXRMDATE",58,0)
 Q DAYS
"RTN","PXRMDATE",59,0)
 ;
"RTN","PXRMDATE",60,0)
 ;==================================================
"RTN","PXRMDATE",61,0)
CTFMD(DATE) ;Convert DATE which may be in any of the FileMan acceptable
"RTN","PXRMDATE",62,0)
 ;forms with additional CR extensions to an internal FileMan date.
"RTN","PXRMDATE",63,0)
 N FMDATE,OFFSET,OP,SYM,SYMV,TDATE,TIME
"RTN","PXRMDATE",64,0)
 ;Already in internal FileMan date format?
"RTN","PXRMDATE",65,0)
 I DATE?7N Q DATE
"RTN","PXRMDATE",66,0)
 I DATE?7N1"."1.6N Q DATE
"RTN","PXRMDATE",67,0)
 S TDATE=$TR(DATE," ",""),TDATE=$$UP^XLFSTR(TDATE)
"RTN","PXRMDATE",68,0)
 ;Check for T or TODAY with a time.
"RTN","PXRMDATE",69,0)
 I $E(TDATE,1)="T" S TIME=$P(TDATE,"@",2),TDATE=$P(TDATE,"@",1)
"RTN","PXRMDATE",70,0)
 ;Check for dates in the form SYMBOL+IU,or SYMBOL-IU, where I is
"RTN","PXRMDATE",71,0)
 ;an integer and U is a unit.
"RTN","PXRMDATE",72,0)
 S OP=$S(TDATE["+":"+",TDATE["-":"-",1:"")
"RTN","PXRMDATE",73,0)
 S SYM=$S(OP'="":$P(TDATE,OP,1),1:TDATE)
"RTN","PXRMDATE",74,0)
 S OFFSET=$S(OP'="":$P(TDATE,OP,2),1:"")
"RTN","PXRMDATE",75,0)
 ;If the symbolic part is not on the list of valid symbols try FileMan.
"RTN","PXRMDATE",76,0)
 I '$$VSYM(SYM) D DT^DILF("ST",DATE,.FMDATE) Q FMDATE
"RTN","PXRMDATE",77,0)
 ;Check for a valid offset.
"RTN","PXRMDATE",78,0)
 I OFFSET'="",'$$VOFFSET(OFFSET) Q -1
"RTN","PXRMDATE",79,0)
 I ((SYM="T")!(SYM="TODAY")),(OFFSET["H") D  Q -1
"RTN","PXRMDATE",80,0)
 . I $G(PXRMINTR)=1 D EN^DDIOL("Cannot use "_SYM_" with "_OFFSET)
"RTN","PXRMDATE",81,0)
 ;If this is being called by the input transform VDT^PXRMINTR we
"RTN","PXRMDATE",82,0)
 ;are done.
"RTN","PXRMDATE",83,0)
 I $G(PXRMINTR)=1 Q 1
"RTN","PXRMDATE",84,0)
 ;If the symbol is not one of the standard FM symbols then it is
"RTN","PXRMDATE",85,0)
 ;one of the Clinical Reminder symbols.
"RTN","PXRMDATE",86,0)
 S SYMV=$S(SYM="T":$$TODAY,SYM="TODAY":$$TODAY,SYM="N":$$NOW,SYM="NOW":$$NOW,SYM="NOON":$$NOON,SYM="MID":$$MID,1:+$G(@SYM))
"RTN","PXRMDATE",87,0)
 I $G(TIME)'="" D
"RTN","PXRMDATE",88,0)
 . S SYMV=SYMV_"@"_TIME
"RTN","PXRMDATE",89,0)
 . D DT^DILF("ST",SYMV,.FMDATE)
"RTN","PXRMDATE",90,0)
 . S SYMV=FMDATE
"RTN","PXRMDATE",91,0)
 ;If the symbol does not equate to an internal FM date return -1
"RTN","PXRMDATE",92,0)
 I '(SYMV?7N0.1"."0.6N) Q -1
"RTN","PXRMDATE",93,0)
 Q $$NEWDATE(SYMV,OP,OFFSET)
"RTN","PXRMDATE",94,0)
 ;
"RTN","PXRMDATE",95,0)
 ;=================================================
"RTN","PXRMDATE",96,0)
DCHECK(DATE) ;Trap for special characters before calling CTFMD^PXRMDATE.
"RTN","PXRMDATE",97,0)
 ;Used in DIR("PRE") for date inputs.
"RTN","PXRMDATE",98,0)
 I $D(DTOUT) Q DATE
"RTN","PXRMDATE",99,0)
 I DATE="" Q DATE
"RTN","PXRMDATE",100,0)
 I DATE["^" Q DATE
"RTN","PXRMDATE",101,0)
 I DATE["?" Q DATE
"RTN","PXRMDATE",102,0)
 Q $$CTFMD^PXRMDATE(DATE)
"RTN","PXRMDATE",103,0)
 ;
"RTN","PXRMDATE",104,0)
 ;==================================================
"RTN","PXRMDATE",105,0)
DDATE(DATE) ;Check for an historical (event) date, format as appropriate,
"RTN","PXRMDATE",106,0)
 ;withou time.
"RTN","PXRMDATE",107,0)
 I DATE=0 Q "00/00/0000"
"RTN","PXRMDATE",108,0)
 Q $$FMTE^XLFDT(DATE,"5DZ")
"RTN","PXRMDATE",109,0)
 ;
"RTN","PXRMDATE",110,0)
 ;==================================================
"RTN","PXRMDATE",111,0)
DUE(DEFARR,RESDATE,FREQ,DUE,DUEDATE,FIEVAL) ;Compute the due date.
"RTN","PXRMDATE",112,0)
 ;This is the date of the resolution finding + the reminder frequency.
"RTN","PXRMDATE",113,0)
 ;Subtract the due in advance time to see if the reminder should be
"RTN","PXRMDATE",114,0)
 ;marked as due soon.
"RTN","PXRMDATE",115,0)
 ;
"RTN","PXRMDATE",116,0)
 N DATE,DIAT,DIATOK,LDATE,PXRMITEM,TDDUE,TODAY
"RTN","PXRMDATE",117,0)
 S PXRMITEM=DEFARR("IEN")
"RTN","PXRMDATE",118,0)
 ;If the final frequency is 0Y then the reminder is not due.
"RTN","PXRMDATE",119,0)
 I FREQ="0Y" S DUE=0,DUEDATE="" Q
"RTN","PXRMDATE",120,0)
 ;
"RTN","PXRMDATE",121,0)
 S DUEDATE=""
"RTN","PXRMDATE",122,0)
 ;Check for custom date due.
"RTN","PXRMDATE",123,0)
 I DEFARR(45)'="" S DUEDATE=$$CDUEDATE^PXRMCDUE(.DEFARR,.FIEVAL)
"RTN","PXRMDATE",124,0)
 I DUEDATE'="",DUEDATE'=-1 G SETDUE
"RTN","PXRMDATE",125,0)
 ;
"RTN","PXRMDATE",126,0)
 ;If there is no resolution logic then frequency is not required.
"RTN","PXRMDATE",127,0)
 I (FREQ="")!(FREQ=-1)&(DEFARR(35)'="") D  Q
"RTN","PXRMDATE",128,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"WARNING","NOFREQ")="No reminder frequency - cannot compute due date!"
"RTN","PXRMDATE",129,0)
 . S (DUE,DUEDATE)="CNBD"
"RTN","PXRMDATE",130,0)
 ;
"RTN","PXRMDATE",131,0)
 S LDATE=$S(RESDATE["X":0,1:+RESDATE)
"RTN","PXRMDATE",132,0)
 I LDATE=0 S (DUE,DUEDATE)="DUE NOW" Q
"RTN","PXRMDATE",133,0)
 S DATE=$$FULLDATE(LDATE),DUEDATE=$$NEWDATE(DATE,"+",FREQ)
"RTN","PXRMDATE",134,0)
 ;
"RTN","PXRMDATE",135,0)
SETDUE ;If the due date is less than or equal to today's date the
"RTN","PXRMDATE",136,0)
 ;reminder is due.
"RTN","PXRMDATE",137,0)
 S TODAY=$$TODAY^PXRMDATE
"RTN","PXRMDATE",138,0)
 I +DUEDATE'>TODAY S DUE="DUE NOW"  Q
"RTN","PXRMDATE",139,0)
 ;
"RTN","PXRMDATE",140,0)
 S DIAT=$P(DEFARR(0),U,4)
"RTN","PXRMDATE",141,0)
 I DIAT="" D
"RTN","PXRMDATE",142,0)
 . S DIATOK=0
"RTN","PXRMDATE",143,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"WARNING","DIAT")="Warning no do in advance time"
"RTN","PXRMDATE",144,0)
 E  S DIATOK=1
"RTN","PXRMDATE",145,0)
 ;
"RTN","PXRMDATE",146,0)
 S TDDUE=$S(DIATOK=1:$$NEWDATE(DUEDATE,"-",DIAT),1:DUEDATE)
"RTN","PXRMDATE",147,0)
 S DUE=$S(TDDUE'>TODAY:"DUE SOON",1:"RESOLVED")
"RTN","PXRMDATE",148,0)
 Q
"RTN","PXRMDATE",149,0)
 ;
"RTN","PXRMDATE",150,0)
 ;==================================================
"RTN","PXRMDATE",151,0)
DURATION(START,STOP) ;Return the number days between the Start Date and
"RTN","PXRMDATE",152,0)
 ;Stop Date.
"RTN","PXRMDATE",153,0)
 I +START=0 Q 0
"RTN","PXRMDATE",154,0)
 N PXRMNOW
"RTN","PXRMDATE",155,0)
 S PXRMNOW=$$NOW^PXRMDATE
"RTN","PXRMDATE",156,0)
 I START>PXRMNOW Q 0
"RTN","PXRMDATE",157,0)
 I (STOP="")!(STOP>PXRMNOW) S STOP=PXRMNOW
"RTN","PXRMDATE",158,0)
 Q $$FMDIFF^XLFDT(STOP,START)
"RTN","PXRMDATE",159,0)
 ;
"RTN","PXRMDATE",160,0)
 ;==================================================
"RTN","PXRMDATE",161,0)
EDATE(DATE) ;Check for an historical (event) date, format as appropriate,
"RTN","PXRMDATE",162,0)
 ;include time.
"RTN","PXRMDATE",163,0)
 I DATE=0 Q "00/00/0000"
"RTN","PXRMDATE",164,0)
 Q $$FMTE^XLFDT(DATE,"5Z")
"RTN","PXRMDATE",165,0)
 ;
"RTN","PXRMDATE",166,0)
 ;==================================================
"RTN","PXRMDATE",167,0)
FMDATE(DFN,TEST,DATE,VALUE,TEXT) ;FileMan date computed finding.
"RTN","PXRMDATE",168,0)
 I TEST="" S TEST=0 Q
"RTN","PXRMDATE",169,0)
 S (DATE,VALUE)=$$CTFMD^PXRMDATE(TEST)
"RTN","PXRMDATE",170,0)
 S TEST=1
"RTN","PXRMDATE",171,0)
 Q
"RTN","PXRMDATE",172,0)
 ;
"RTN","PXRMDATE",173,0)
 ;==================================================
"RTN","PXRMDATE",174,0)
FULLDATE(DATE) ;See if DATE is a full date, i.e., it has a month and
"RTN","PXRMDATE",175,0)
 ;a day along with a year. If the month is missing assume Jan. If the
"RTN","PXRMDATE",176,0)
 ;day is missing assume the first. Issue a warning so the user knows
"RTN","PXRMDATE",177,0)
 ;what happened. DATE should be in Fileman format.
"RTN","PXRMDATE",178,0)
 N DAY,MISSING,MONTH,TDATE,YEAR
"RTN","PXRMDATE",179,0)
 S TDATE=DATE
"RTN","PXRMDATE",180,0)
 S MISSING=0
"RTN","PXRMDATE",181,0)
 S DAY=$E(DATE,6,7)
"RTN","PXRMDATE",182,0)
 S MONTH=$E(DATE,4,5)
"RTN","PXRMDATE",183,0)
 S YEAR=$E(DATE,1,3)
"RTN","PXRMDATE",184,0)
 I +DAY=0 D
"RTN","PXRMDATE",185,0)
 . S DAY=1
"RTN","PXRMDATE",186,0)
 . S MISSING=1
"RTN","PXRMDATE",187,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"INFO","NO DAY")="Encounter date missing the day, using the first for the date due calculation."
"RTN","PXRMDATE",188,0)
 I +MONTH=0 D
"RTN","PXRMDATE",189,0)
 . S MONTH=1
"RTN","PXRMDATE",190,0)
 . S MISSING=1
"RTN","PXRMDATE",191,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"INFO","NO MONTH")="Encounter date missing the month, using January for the date due calculation."
"RTN","PXRMDATE",192,0)
 I MISSING D
"RTN","PXRMDATE",193,0)
 . S TDATE=(YEAR*1E4)+(MONTH*1E2)+DAY
"RTN","PXRMDATE",194,0)
 . I DATE["E" S TDATE=TDATE_"E"
"RTN","PXRMDATE",195,0)
 Q TDATE
"RTN","PXRMDATE",196,0)
 ;
"RTN","PXRMDATE",197,0)
 ;==================================================
"RTN","PXRMDATE",198,0)
FRQINDAY(FREQ) ;Given a frequency in the form ND, NM, or NY where N is a
"RTN","PXRMDATE",199,0)
 ;number and D stands for days, M for months, and Y for years return
"RTN","PXRMDATE",200,0)
 ;the value in days. Used for ranking only.
"RTN","PXRMDATE",201,0)
 I FREQ="" Q 0
"RTN","PXRMDATE",202,0)
 N LEN,NUM,UNIT
"RTN","PXRMDATE",203,0)
 S NUM=+FREQ
"RTN","PXRMDATE",204,0)
 S LEN=$L(FREQ)
"RTN","PXRMDATE",205,0)
 S UNIT=$E(FREQ,LEN)
"RTN","PXRMDATE",206,0)
 ;30.42 is average number of days in a month, 365.24 is average number
"RTN","PXRMDATE",207,0)
 ;of days in a year. Unknown unit return 0.
"RTN","PXRMDATE",208,0)
 S NUM=$S(UNIT="D":NUM,UNIT="M":$$CTD(30.42,NUM),UNIT="Y":$$CTD(365.24,NUM),1:0)
"RTN","PXRMDATE",209,0)
 Q NUM
"RTN","PXRMDATE",210,0)
 ;
"RTN","PXRMDATE",211,0)
 ;==================================================
"RTN","PXRMDATE",212,0)
ISLEAP(YEAR) ;Given a 3 digit FileMan year return 1 if it is a leap year,
"RTN","PXRMDATE",213,0)
 ;0 otherwise.
"RTN","PXRMDATE",214,0)
 S YEAR=YEAR+1700
"RTN","PXRMDATE",215,0)
 Q (YEAR#4=0)&'(YEAR#100=0)!(YEAR#400=0)
"RTN","PXRMDATE",216,0)
 ;
"RTN","PXRMDATE",217,0)
 ;==================================================
"RTN","PXRMDATE",218,0)
MCALC(FMDATE,OP,NUM) ;Add or subtract NUM months to FMDATE.
"RTN","PXRMDATE",219,0)
 N DAY,DIM,MONTH,TIME,YEAR
"RTN","PXRMDATE",220,0)
 S YEAR=$E(FMDATE,1,3),MONTH=$E(FMDATE,4,5),DAY=$E(FMDATE,6,7)
"RTN","PXRMDATE",221,0)
 S TIME=$P(FMDATE,".",2)
"RTN","PXRMDATE",222,0)
 I TIME'="" S TIME="."_TIME
"RTN","PXRMDATE",223,0)
 I OP="+" F  Q:'NUM  S NUM=NUM-1,MONTH=MONTH+1 I MONTH=13 S YEAR=YEAR+1,MONTH=1
"RTN","PXRMDATE",224,0)
 I OP="-" F  Q:'NUM  S NUM=NUM-1,MONTH=MONTH-1 I MONTH=0 S YEAR=YEAR-1,MONTH=12
"RTN","PXRMDATE",225,0)
 S DIM="31^"_($$ISLEAP(YEAR)+28)_"^31^30^31^30^31^31^30^31^30^31"
"RTN","PXRMDATE",226,0)
 I DAY>$P(DIM,"^",MONTH) S DAY=$P(DIM,"^",MONTH)
"RTN","PXRMDATE",227,0)
 Q YEAR_"00"+MONTH_"00"+DAY_TIME
"RTN","PXRMDATE",228,0)
 ;
"RTN","PXRMDATE",229,0)
 ;==================================================
"RTN","PXRMDATE",230,0)
MID() ;If the reminder global PXRMDATE is defined return midnight on that day,
"RTN","PXRMDATE",231,0)
 ;otherwise return the current date at midnight.
"RTN","PXRMDATE",232,0)
 Q $S(+$G(PXRMDATE)>0:$E(PXRMDATE,1,7),1:$$DT^XLFDT)_".24"
"RTN","PXRMDATE",233,0)
 ;
"RTN","PXRMDATE",234,0)
 ;==================================================
"RTN","PXRMDATE",235,0)
NEWDATE(FMDATE,OP,OFFSET) ;Given an internal FileMan date, an operator of 
"RTN","PXRMDATE",236,0)
 ;that is + or - ,and an offset of the form I, ID, IW, IM, IY 
"RTN","PXRMDATE",237,0)
 ;where I is a positive integer and H is hours, D is days, W is weeks,
"RTN","PXRMDATE",238,0)
 ;M is months, and Y is years calculate and return the new FM date.
"RTN","PXRMDATE",239,0)
 N DAYS,HOURS,NUM,UNIT
"RTN","PXRMDATE",240,0)
 I FMDATE=0 Q 0
"RTN","PXRMDATE",241,0)
 S NUM=+OFFSET
"RTN","PXRMDATE",242,0)
 I NUM<0 Q -1
"RTN","PXRMDATE",243,0)
 S UNIT=$E(OFFSET,$L(NUM)+1)
"RTN","PXRMDATE",244,0)
 I UNIT="" S UNIT="D"
"RTN","PXRMDATE",245,0)
 I UNIT="H" S HOURS=OP_NUM Q $$FMADD^XLFDT(FMDATE,0,HOURS,0,0)
"RTN","PXRMDATE",246,0)
 I UNIT="D" S DAYS=OP_NUM Q $$FMADD^XLFDT(FMDATE,DAYS,0,0,0)
"RTN","PXRMDATE",247,0)
 I UNIT="W" S DAYS=OP_(NUM*7) Q $$FMADD^XLFDT(FMDATE,DAYS,0,0,0)
"RTN","PXRMDATE",248,0)
 I UNIT="M" Q $$MCALC(FMDATE,OP,NUM)
"RTN","PXRMDATE",249,0)
 I UNIT="Y" Q $$YCALC(FMDATE,OP,NUM)
"RTN","PXRMDATE",250,0)
 Q -1
"RTN","PXRMDATE",251,0)
 ;
"RTN","PXRMDATE",252,0)
 ;==================================================
"RTN","PXRMDATE",253,0)
NOON() ;If the reminder global PXRMDATE is defined return noon on that day,
"RTN","PXRMDATE",254,0)
 ;otherwise return the current date at noon.
"RTN","PXRMDATE",255,0)
 Q $S(+$G(PXRMDATE)>0:$E(PXRMDATE,1,7),1:$$DT^XLFDT)_".12"
"RTN","PXRMDATE",256,0)
 ;
"RTN","PXRMDATE",257,0)
 ;==================================================
"RTN","PXRMDATE",258,0)
NOW() ;If the reminder global PXRMDATE is defined return it, otherwise
"RTN","PXRMDATE",259,0)
 ;return the current date and time.
"RTN","PXRMDATE",260,0)
 I +$G(PXRMDATE)=0 Q $$NOW^XLFDT
"RTN","PXRMDATE",261,0)
 N NOW,TIME
"RTN","PXRMDATE",262,0)
 S TIME=$P(PXRMDATE,".",2)
"RTN","PXRMDATE",263,0)
 I TIME="" S TIME=$P($$NOW^XLFDT,".",2),NOW=PXRMDATE_"."_TIME
"RTN","PXRMDATE",264,0)
 E  S NOW=PXRMDATE
"RTN","PXRMDATE",265,0)
 Q NOW
"RTN","PXRMDATE",266,0)
 ;
"RTN","PXRMDATE",267,0)
 ;==================================================
"RTN","PXRMDATE",268,0)
TODAY() ;If the reminder global PXRMDATE is defined return it, otherwise
"RTN","PXRMDATE",269,0)
 ;return the current date.
"RTN","PXRMDATE",270,0)
 Q $S(+$G(PXRMDATE)>0:$P(PXRMDATE,".",1),1:$$DT^XLFDT)
"RTN","PXRMDATE",271,0)
 ;
"RTN","PXRMDATE",272,0)
 ;==================================================
"RTN","PXRMDATE",273,0)
VDATE(VIEN) ;Given a visit ien return the visit date.
"RTN","PXRMDATE",274,0)
 N DATE
"RTN","PXRMDATE",275,0)
 S DATE=$S(+VIEN>0:$P($G(^AUPNVSIT(VIEN,0)),U,1),1:0)
"RTN","PXRMDATE",276,0)
 I $L(DATE)=0 S DATE=0
"RTN","PXRMDATE",277,0)
 ;Check for historical encounter.
"RTN","PXRMDATE",278,0)
 I $$ISHIST^PXRMVSIT(VIEN) S DATE=DATE_"E"
"RTN","PXRMDATE",279,0)
 Q DATE
"RTN","PXRMDATE",280,0)
 ;
"RTN","PXRMDATE",281,0)
 ;==================================================
"RTN","PXRMDATE",282,0)
VOFFSET(OFFSET) ;Make sure the offset part of a date is valid. It has to
"RTN","PXRMDATE",283,0)
 ;have the form I or IU where I is an integer and U is one of the
"RTN","PXRMDATE",284,0)
 ;following units: H, D, W, M, Y.
"RTN","PXRMDATE",285,0)
 I OFFSET?1.N0.1"H"0.1"D"0.1"W"0.1"M"0.1"Y" Q 1
"RTN","PXRMDATE",286,0)
 Q 0
"RTN","PXRMDATE",287,0)
 ;
"RTN","PXRMDATE",288,0)
 ;==================================================
"RTN","PXRMDATE",289,0)
VSYM(SYM) ;Make sure the symbolic part of a date is valid.
"RTN","PXRMDATE",290,0)
 ;Already in FileMan internal form.
"RTN","PXRMDATE",291,0)
 I SYM?7N Q 1
"RTN","PXRMDATE",292,0)
 I SYM?7N1"."1.6N Q 1
"RTN","PXRMDATE",293,0)
 ;Check for FileMan symbols.
"RTN","PXRMDATE",294,0)
 I (SYM="T")!(SYM="TODAY") Q 1
"RTN","PXRMDATE",295,0)
 I (SYM="N")!(SYM="NOW") Q 1
"RTN","PXRMDATE",296,0)
 I (SYM="NOON") Q 1
"RTN","PXRMDATE",297,0)
 I (SYM="MID") Q 1
"RTN","PXRMDATE",298,0)
 ;Check for Clinical Reminder symbols.
"RTN","PXRMDATE",299,0)
 I SYM="PXRMLAD" Q 1
"RTN","PXRMDATE",300,0)
 I SYM="PXRMDOB" Q 1
"RTN","PXRMDATE",301,0)
 I SYM="PXRMDOD" Q 1
"RTN","PXRMDATE",302,0)
 I SYM?1"FIEVAL("1.N1","0.1(1.N1",")1"""DATE"")" Q 1
"RTN","PXRMDATE",303,0)
 Q 0
"RTN","PXRMDATE",304,0)
 ;
"RTN","PXRMDATE",305,0)
 ;==================================================
"RTN","PXRMDATE",306,0)
YCALC(FMDATE,OP,NUM) ;Add or subtract NUM years to FMDATE.
"RTN","PXRMDATE",307,0)
 N DAY,MONTH,TIME,YEAR
"RTN","PXRMDATE",308,0)
 S YEAR=$E(FMDATE,1,3),MONTH=$E(FMDATE,4,5),DAY=$E(FMDATE,6,7)
"RTN","PXRMDATE",309,0)
 S TIME=$P(FMDATE,".",2)
"RTN","PXRMDATE",310,0)
 I TIME'="" S TIME="."_TIME
"RTN","PXRMDATE",311,0)
 I OP="+" F  Q:'NUM  S NUM=NUM-1,YEAR=YEAR+1
"RTN","PXRMDATE",312,0)
 I OP="-" F  Q:'NUM  S NUM=NUM-1,YEAR=YEAR-1
"RTN","PXRMDATE",313,0)
 ;Handle leap year.
"RTN","PXRMDATE",314,0)
 I MONTH="02",DAY>27,'$$ISLEAP(YEAR) S DAY=28
"RTN","PXRMDATE",315,0)
 Q YEAR_"00"+MONTH_"00"+DAY_TIME
"RTN","PXRMDATE",316,0)
 ;
"RTN","PXRMDEDT")
0^18^B86390747
"RTN","PXRMDEDT",1,0)
PXRMDEDT ; SLC/PJH - Edit PXRM reminder dialog. ;08/02/2012
"RTN","PXRMDEDT",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,12,17,16,24**;Feb 04, 2005;Build 193
"RTN","PXRMDEDT",3,0)
 ;
"RTN","PXRMDEDT",4,0)
 ;Used by protocol PXRM SELECTION ADD/PXRM GENERAL ADD
"RTN","PXRMDEDT",5,0)
 ;
"RTN","PXRMDEDT",6,0)
 ;Add Dialog
"RTN","PXRMDEDT",7,0)
 ;----------
"RTN","PXRMDEDT",8,0)
ADD N DA,DIC,Y,DTOUT,DUOUT,DTYP,DLAYGO,HED
"RTN","PXRMDEDT",9,0)
 S HED="ADD DIALOG"
"RTN","PXRMDEDT",10,0)
 W IORESET
"RTN","PXRMDEDT",11,0)
 F  D  Q:$D(DTOUT)
"RTN","PXRMDEDT",12,0)
 .S DIC="^PXRMD(801.41,"
"RTN","PXRMDEDT",13,0)
 .;Set the starting place for additions.
"RTN","PXRMDEDT",14,0)
 .D SETSTART^PXRMCOPY(DIC)
"RTN","PXRMDEDT",15,0)
 .S DIC(0)="AELMQ",DLAYGO=801.41
"RTN","PXRMDEDT",16,0)
 .S DIC("A")="Select DIALOG to add: "
"RTN","PXRMDEDT",17,0)
 .S DIC("DR")="4///"_$G(PXRMDTYP)
"RTN","PXRMDEDT",18,0)
 .D ^DIC
"RTN","PXRMDEDT",19,0)
 .I $D(DUOUT) S DTOUT=1
"RTN","PXRMDEDT",20,0)
 .I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","PXRMDEDT",21,0)
 .I Y=-1 K DIC S DTOUT=1 Q
"RTN","PXRMDEDT",22,0)
 .I $P(Y,U,3)'=1 W !,"This dialog name already exists" Q
"RTN","PXRMDEDT",23,0)
 .S DA=$P(Y,U,1)
"RTN","PXRMDEDT",24,0)
 .;Determine dialog type
"RTN","PXRMDEDT",25,0)
 .S DTYP=$P($G(^PXRMD(801.41,DA,0)),U,4)
"RTN","PXRMDEDT",26,0)
 .;Enter dialog type if a new entry
"RTN","PXRMDEDT",27,0)
 .I DTYP="" D  Q:$D(Y)
"RTN","PXRMDEDT",28,0)
 ..N DIE,DR
"RTN","PXRMDEDT",29,0)
 ..S DIE=801.41,DR=4
"RTN","PXRMDEDT",30,0)
 ..D ^DIE
"RTN","PXRMDEDT",31,0)
 .;
"RTN","PXRMDEDT",32,0)
 .;Edit Dialog
"RTN","PXRMDEDT",33,0)
 .D EDIT(DTYP,DA,0)
"RTN","PXRMDEDT",34,0)
 Q
"RTN","PXRMDEDT",35,0)
 ;
"RTN","PXRMDEDT",36,0)
 ;called by protocol PXRM DIALOG EDIT
"RTN","PXRMDEDT",37,0)
 ;-----------------------------------
"RTN","PXRMDEDT",38,0)
EDIT(TYP,DA,OIEN) ;
"RTN","PXRMDEDT",39,0)
 Q:'$$LOCK(DA)
"RTN","PXRMDEDT",40,0)
 W IORESET
"RTN","PXRMDEDT",41,0)
 N CS1,CS2,D1,DIC,DIDEL,DIE,DIK,DR,DTOUT,DUOUT,DINUSE,TYP,ODA,Y
"RTN","PXRMDEDT",42,0)
 ;Save checksum
"RTN","PXRMDEDT",43,0)
 S VALMBCK=""
"RTN","PXRMDEDT",44,0)
 S CS1=$$FILE^PXRMEXCS(801.41,DA)
"RTN","PXRMDEDT",45,0)
 ;
"RTN","PXRMDEDT",46,0)
 ;Check dialog type
"RTN","PXRMDEDT",47,0)
 S TYP=$P($G(^PXRMD(801.41,DA,0)),U,4)
"RTN","PXRMDEDT",48,0)
 S DIE="^PXRMD(801.41,",DIDEL=801.41,DINUSE=0,ODA=DA
"RTN","PXRMDEDT",49,0)
 ;Reminder Dialog
"RTN","PXRMDEDT",50,0)
 I TYP="R" S DR="[PXRM EDIT REMINDER DIALOG]"
"RTN","PXRMDEDT",51,0)
 ;Dialog Element
"RTN","PXRMDEDT",52,0)
 I TYP="E" S DR="[PXRM EDIT ELEMENT]"
"RTN","PXRMDEDT",53,0)
 ;Additional Prompt
"RTN","PXRMDEDT",54,0)
 ;I TYP="P" S DR="[PXRM EDIT PROMPT]"
"RTN","PXRMDEDT",55,0)
 ;Forced Value
"RTN","PXRMDEDT",56,0)
 I TYP="F" S DR="[PXRM EDIT FORCED VALUE]"
"RTN","PXRMDEDT",57,0)
 ;Dialog Group (Finding item dialog)
"RTN","PXRMDEDT",58,0)
 I TYP="G" S DR="[PXRM EDIT GROUP]" ;S VALMBCK="R"
"RTN","PXRMDEDT",59,0)
 ;Result Group
"RTN","PXRMDEDT",60,0)
 I TYP="S" S DR="[PXRM RESULT GROUP]"
"RTN","PXRMDEDT",61,0)
 ;Result Element
"RTN","PXRMDEDT",62,0)
 I TYP="T" S DR="[PXRM RESULT ELEMENT]"
"RTN","PXRMDEDT",63,0)
 ;Allows limited edit of national dialogs
"RTN","PXRMDEDT",64,0)
 I $P($G(^PXRMD(801.41,DA,100)),U)="N" D
"RTN","PXRMDEDT",65,0)
 .I TYP="T",+$P($G(^PXMRD(801.41,DA,100)),U,4)=0 Q
"RTN","PXRMDEDT",66,0)
 .I $G(PXRMINST)=1,DUZ(0)="@" Q
"RTN","PXRMDEDT",67,0)
 .S DR="[PXRM EDIT NATIONAL DIALOG]",DINUSE=1
"RTN","PXRMDEDT",68,0)
 ;
"RTN","PXRMDEDT",69,0)
 I "GEPFS"[TYP D
"RTN","PXRMDEDT",70,0)
 .I '$D(^PXRMD(801.41,"AD",DA)),'$D(^PXRMD(801.41,"R",DA)),'$D(^PXRMD(801.41,"RG",DA)) W !,"Not used by any other dialog",! Q
"RTN","PXRMDEDT",71,0)
 .I PXRMGTYP'="DLG" S DINUSE=1 Q
"RTN","PXRMDEDT",72,0)
 .I PXRMGTYP="DLG" D  Q
"RTN","PXRMDEDT",73,0)
 ..N SUB
"RTN","PXRMDEDT",74,0)
 ..S SUB=0
"RTN","PXRMDEDT",75,0)
 ..F  S SUB=$O(^PXRMD(801.41,"AD",DA,SUB)) Q:'SUB  Q:DINUSE  D
"RTN","PXRMDEDT",76,0)
 ...I SUB'=PXRMDIEN S DINUSE=1
"RTN","PXRMDEDT",77,0)
 I DINUSE D
"RTN","PXRMDEDT",78,0)
 .W !,"Current dialog "_$S(TYP="S":"result group",1:"element/group")_" name: "_$P($G(^PXRMD(801.41,DA,0)),U)
"RTN","PXRMDEDT",79,0)
 .I TYP="S" W !,"Used by:" D USE^PXRMDLST(DA,10,PXRMDIEN,"RG") Q
"RTN","PXRMDEDT",80,0)
 .I PXRMGTYP="DLGE" D
"RTN","PXRMDEDT",81,0)
 ..W !,"Used by:" D USE^PXRMDLST(DA,10,"","AD")
"RTN","PXRMDEDT",82,0)
 ..I $D(^PXRMD(801.41,"R",DA))'>0 Q
"RTN","PXRMDEDT",83,0)
 ..W !,"Used as a Replacement Element/Group for: " D USE^PXRMDLST(DA,10,"","R")
"RTN","PXRMDEDT",84,0)
 .I PXRMGTYP'="DLGE" D
"RTN","PXRMDEDT",85,0)
 ..W !,"Used by:" D USE^PXRMDLST(DA,10,PXRMDIEN,"AD")
"RTN","PXRMDEDT",86,0)
 ..I $D(^PXRMD(801.41,"R",DA))'>0 Q
"RTN","PXRMDEDT",87,0)
 ..W !,"Used as a Replacement Element/Group for: " D USE^PXRMDLST(DA,10,PXRMDIEN,"R")
"RTN","PXRMDEDT",88,0)
 ;
"RTN","PXRMDEDT",89,0)
 ;Save list of components
"RTN","PXRMDEDT",90,0)
 N COMP D COMP^PXRMDEDX(DA,.COMP)
"RTN","PXRMDEDT",91,0)
 ;Edit dialog then unlock
"RTN","PXRMDEDT",92,0)
 I TYP'="P" D ^DIE D UNLOCK(ODA) I $G(DA)="",$G(OIEN)>0 D
"RTN","PXRMDEDT",93,0)
 .S DA=OIEN,DR="118////@" D ^DIE K DA
"RTN","PXRMDEDT",94,0)
 I TYP="P" D PROMPT(DA) D UNLOCK(ODA)
"RTN","PXRMDEDT",95,0)
 ;I '$D(DUOUT)&($G(D1)'="") D  Q
"RTN","PXRMDEDT",96,0)
 I $G(D1)'="" D
"RTN","PXRMDEDT",97,0)
 . I $P($G(^PXRMD(801.41,DA,10,D1,0)),U,2)="" D  Q
"RTN","PXRMDEDT",98,0)
 . . S DA(1)=DA,DA=D1 Q:'DA
"RTN","PXRMDEDT",99,0)
 . . S DIK="^PXRMD(801.41,"_DA(1)_",10,"
"RTN","PXRMDEDT",100,0)
 . . D ^DIK
"RTN","PXRMDEDT",101,0)
 . . ;S VALMBG=1
"RTN","PXRMDEDT",102,0)
 I $D(DUOUT) S VALMBG=1 Q
"RTN","PXRMDEDT",103,0)
 I '$D(DA) D  Q
"RTN","PXRMDEDT",104,0)
 .;Clear any pointers from #811.9
"RTN","PXRMDEDT",105,0)
 .I $D(PXRMDIEN) D PURGE(PXRMDIEN)
"RTN","PXRMDEDT",106,0)
 .;Option to delete components
"RTN","PXRMDEDT",107,0)
 .I $D(COMP) D DELETE^PXRMDEDX(.COMP)
"RTN","PXRMDEDT",108,0)
 .S VALMBCK="R"
"RTN","PXRMDEDT",109,0)
 ;
"RTN","PXRMDEDT",110,0)
 ;Update edit history
"RTN","PXRMDEDT",111,0)
 I (TYP'="R") D
"RTN","PXRMDEDT",112,0)
 .S CS2=$$FILE^PXRMEXCS(801.41,DA) Q:CS2=CS1  Q:+CS2=0
"RTN","PXRMDEDT",113,0)
 .S DIC="^PXRMD(801.41,"
"RTN","PXRMDEDT",114,0)
 .D SEHIST^PXRMUTIL(801.41,DIC,DA)
"RTN","PXRMDEDT",115,0)
 ;
"RTN","PXRMDEDT",116,0)
 ;Redisplay changes (reminder dialog option only)
"RTN","PXRMDEDT",117,0)
 I PXRMGTYP="DLG",TYP="R" D
"RTN","PXRMDEDT",118,0)
 .;Get name of reminder dialog again
"RTN","PXRMDEDT",119,0)
 .S Y=$P($G(^PXRMD(801.41,DA,0)),U)
"RTN","PXRMDEDT",120,0)
 .;Format headings to include dialog name
"RTN","PXRMDEDT",121,0)
 .S PXRMHD="REMINDER DIALOG NAME: "_$P(Y,U)
"RTN","PXRMDEDT",122,0)
 .;Check if the set is disable and add to header if disabled
"RTN","PXRMDEDT",123,0)
 .I $P(^PXRMD(801.41,DA,0),U,3)]"" S PXRMHD=PXRMHD_" (DISABLED)"
"RTN","PXRMDEDT",124,0)
 .;Reset header in case name has changed
"RTN","PXRMDEDT",125,0)
 .S VALMHDR(1)=PXRMHD
"RTN","PXRMDEDT",126,0)
 Q
"RTN","PXRMDEDT",127,0)
 ;
"RTN","PXRMDEDT",128,0)
 ;Add SINGLE dialog element (protocol PXRM DIALOG SELECTION ITEM)
"RTN","PXRMDEDT",129,0)
 ;-------------------------
"RTN","PXRMDEDT",130,0)
ESEL(PXRMDIEN,SEL) ;
"RTN","PXRMDEDT",131,0)
 N DA,DIC,DLAYGO,DNEW,DTOUT,DUOUT,DTYP,Y
"RTN","PXRMDEDT",132,0)
 ;
"RTN","PXRMDEDT",133,0)
 S DIC="^PXRMD(801.41,"
"RTN","PXRMDEDT",134,0)
 S DLAYGO="801.41"
"RTN","PXRMDEDT",135,0)
 ;Set the starting place for additions.
"RTN","PXRMDEDT",136,0)
 D SETSTART^PXRMCOPY(DIC)
"RTN","PXRMDEDT",137,0)
 S DIC(0)="AEMQL"
"RTN","PXRMDEDT",138,0)
 S DIC("A")="Select new DIALOG ELEMENT: "
"RTN","PXRMDEDT",139,0)
 S DIC("S")="I ""EGPF""[$P(^PXRMD(801.41,Y,0),U,4)"
"RTN","PXRMDEDT",140,0)
 S DIC("DR")="4///E"
"RTN","PXRMDEDT",141,0)
 W !
"RTN","PXRMDEDT",142,0)
 D ^DIC
"RTN","PXRMDEDT",143,0)
 I $D(DUOUT) S DTOUT=1
"RTN","PXRMDEDT",144,0)
 I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","PXRMDEDT",145,0)
 I Y=-1 K DIC S DTOUT=1 Q
"RTN","PXRMDEDT",146,0)
 S DA=$P(Y,U,1) Q:'DA
"RTN","PXRMDEDT",147,0)
 S DNEW=$P(Y,U,3)
"RTN","PXRMDEDT",148,0)
 ;Group points to itself
"RTN","PXRMDEDT",149,0)
 I 'DNEW,$$VGROUP(DA,PXRMDIEN) Q
"RTN","PXRMDEDT",150,0)
 ;Add to dialog
"RTN","PXRMDEDT",151,0)
 D EADD(SEL,DA,PXRMDIEN)
"RTN","PXRMDEDT",152,0)
 ;Determine dialog type
"RTN","PXRMDEDT",153,0)
 S DTYP=$P($G(^PXRMD(801.41,DA,0)),U,4)
"RTN","PXRMDEDT",154,0)
 ;
"RTN","PXRMDEDT",155,0)
 ;Edit Dialog
"RTN","PXRMDEDT",156,0)
 I DNEW D EDIT(DTYP,DA)
"RTN","PXRMDEDT",157,0)
 Q
"RTN","PXRMDEDT",158,0)
 ;
"RTN","PXRMDEDT",159,0)
 ;Update dialog component multiple
"RTN","PXRMDEDT",160,0)
 ;--------------------------------
"RTN","PXRMDEDT",161,0)
EADD(SEL,NSUB,PXRMDIEN) ;
"RTN","PXRMDEDT",162,0)
 N ERRMSG,FDAIEN,FDA,IENS
"RTN","PXRMDEDT",163,0)
 S IENS="+2,"_PXRMDIEN_","
"RTN","PXRMDEDT",164,0)
 S FDA(801.412,IENS,.01)=SEL
"RTN","PXRMDEDT",165,0)
 S FDA(801.412,IENS,2)=NSUB
"RTN","PXRMDEDT",166,0)
 D UPDATE^DIE("","FDA","FDAIEN","ERRMSG")
"RTN","PXRMDEDT",167,0)
 I $D(MSG) D AWRITE^PXRMUTIL("ERRMSG")
"RTN","PXRMDEDT",168,0)
 Q
"RTN","PXRMDEDT",169,0)
 ;
"RTN","PXRMDEDT",170,0)
 ;Change Dialog Element Type
"RTN","PXRMDEDT",171,0)
 ;--------------------------
"RTN","PXRMDEDT",172,0)
NTYP(TYP) ;
"RTN","PXRMDEDT",173,0)
 N X,Y,DIR K DIROUT,DIRUT,DTOUT,DUOUT
"RTN","PXRMDEDT",174,0)
 S DIR(0)="SA"_U_"E:Element;"
"RTN","PXRMDEDT",175,0)
 S DIR(0)=DIR(0)_"G:Group;"
"RTN","PXRMDEDT",176,0)
 S DIR("A")="Dialog Element Type: "
"RTN","PXRMDEDT",177,0)
 S DIR("B")="E"
"RTN","PXRMDEDT",178,0)
 S DIR("?")="Select from the codes displayed. For detailed help type ??"
"RTN","PXRMDEDT",179,0)
 S DIR("??")=U_"D HELP^PXRMDEDT(3)"
"RTN","PXRMDEDT",180,0)
 D ^DIR K DIR
"RTN","PXRMDEDT",181,0)
 I $D(DIROUT) S DTOUT=1
"RTN","PXRMDEDT",182,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","PXRMDEDT",183,0)
 S TYP=Y
"RTN","PXRMDEDT",184,0)
 Q
"RTN","PXRMDEDT",185,0)
 ;
"RTN","PXRMDEDT",186,0)
 ;Clear pointers from the reminder file and process ID file
"RTN","PXRMDEDT",187,0)
 ;---------------------------------------------------------
"RTN","PXRMDEDT",188,0)
PURGE(DIEN) ;
"RTN","PXRMDEDT",189,0)
 ;Purge pointers to this dialog from reminder file
"RTN","PXRMDEDT",190,0)
 N RIEN
"RTN","PXRMDEDT",191,0)
 S RIEN=0
"RTN","PXRMDEDT",192,0)
 F  S RIEN=$O(^PXD(811.9,"AG",DIEN,RIEN)) Q:'RIEN  D
"RTN","PXRMDEDT",193,0)
 .K ^PXD(811.9,RIEN,51),^PXD(811.9,"AG",DIEN,RIEN)
"RTN","PXRMDEDT",194,0)
 ;
"RTN","PXRMDEDT",195,0)
 Q
"RTN","PXRMDEDT",196,0)
 ;
"RTN","PXRMDEDT",197,0)
VGROUP(DA,IEN) ;Check dialog index to see if group will point to itself 
"RTN","PXRMDEDT",198,0)
 N FOUND
"RTN","PXRMDEDT",199,0)
 S FOUND=0
"RTN","PXRMDEDT",200,0)
 ;
"RTN","PXRMDEDT",201,0)
 ;Only do check if dialog is a group
"RTN","PXRMDEDT",202,0)
 I $P($G(^PXRMD(801.41,DA,0)),U,4)'="G" Q FOUND
"RTN","PXRMDEDT",203,0)
 ;
"RTN","PXRMDEDT",204,0)
 ;Group cannot be added to itself
"RTN","PXRMDEDT",205,0)
 I DA=IEN D  Q FOUND
"RTN","PXRMDEDT",206,0)
 .S FOUND=1
"RTN","PXRMDEDT",207,0)
 .W !,"A group cannot be added to itself" H 2
"RTN","PXRMDEDT",208,0)
 ;
"RTN","PXRMDEDT",209,0)
 ;IEN is the dialog group being added to 
"RTN","PXRMDEDT",210,0)
 D VGROUP1(DA,IEN)
"RTN","PXRMDEDT",211,0)
 Q FOUND
"RTN","PXRMDEDT",212,0)
 ;
"RTN","PXRMDEDT",213,0)
VGROUP1(DA,DIEN) ;Examine all parent dialogs
"RTN","PXRMDEDT",214,0)
 ;
"RTN","PXRMDEDT",215,0)
 ;End search if already found
"RTN","PXRMDEDT",216,0)
 Q:FOUND
"RTN","PXRMDEDT",217,0)
 ;
"RTN","PXRMDEDT",218,0)
 ;Check if dialog being added is a parent at this level
"RTN","PXRMDEDT",219,0)
 I $D(^PXRMD(801.41,"AD",DIEN,DA)) D  Q
"RTN","PXRMDEDT",220,0)
 .S FOUND=1
"RTN","PXRMDEDT",221,0)
 .W !,"A group cannot be added as it's own descendant" H 2
"RTN","PXRMDEDT",222,0)
 ;
"RTN","PXRMDEDT",223,0)
 ;If not look at other parents
"RTN","PXRMDEDT",224,0)
 N SUB
"RTN","PXRMDEDT",225,0)
 S SUB=0
"RTN","PXRMDEDT",226,0)
 F  S SUB=$O(^PXRMD(801.41,"AD",DIEN,SUB)) Q:'SUB  D  Q:FOUND
"RTN","PXRMDEDT",227,0)
 .;Ignore reminder dialogs
"RTN","PXRMDEDT",228,0)
 .I $P($G(^PXRMD(801.41,SUB,0)),U,4)'="G" Q
"RTN","PXRMDEDT",229,0)
 .;Repeat check on other parents
"RTN","PXRMDEDT",230,0)
 .D VGROUP1(DA,SUB)
"RTN","PXRMDEDT",231,0)
 Q
"RTN","PXRMDEDT",232,0)
 ;
"RTN","PXRMDEDT",233,0)
HELP(CALL) ;General help text routine
"RTN","PXRMDEDT",234,0)
 N HTEXT
"RTN","PXRMDEDT",235,0)
 N DIWF,DIWL,DIWR,IC
"RTN","PXRMDEDT",236,0)
 S DIWF="C70",DIWL=0,DIWR=70
"RTN","PXRMDEDT",237,0)
 ;
"RTN","PXRMDEDT",238,0)
 I CALL=1 D
"RTN","PXRMDEDT",239,0)
 .S HTEXT(1)="Select E to edit dialog element. If you wish to create"
"RTN","PXRMDEDT",240,0)
 .S HTEXT(2)="a new dialog element just for this reminder dialog select"
"RTN","PXRMDEDT",241,0)
 .S HTEXT(3)="C to copy and replace the current element. Select D to"
"RTN","PXRMDEDT",242,0)
 .S HTEXT(4)="delete the sequence number/element from the dialog."
"RTN","PXRMDEDT",243,0)
 I CALL=2 D
"RTN","PXRMDEDT",244,0)
 .S HTEXT(1)="Enter Y to copy the current dialog element to a new name"
"RTN","PXRMDEDT",245,0)
 .S HTEXT(2)="and then use this new element in the reminder dialog."
"RTN","PXRMDEDT",246,0)
 I CALL=3 D
"RTN","PXRMDEDT",247,0)
 .S HTEXT(1)="Enter G to change the current dialog element into a dialog"
"RTN","PXRMDEDT",248,0)
 .S HTEXT(2)="group so that additional elements can be added. Enter E to"
"RTN","PXRMDEDT",249,0)
 .S HTEXT(3)="leave the type of the dialog element unchanged."
"RTN","PXRMDEDT",250,0)
 I CALL=4 D
"RTN","PXRMDEDT",251,0)
 .S HTEXT(1)="Enter Y to change the dialog prompt created into a forced"
"RTN","PXRMDEDT",252,0)
 .S HTEXT(2)="value. To edit the new forced value switch to the forced"
"RTN","PXRMDEDT",253,0)
 .S HTEXT(3)="value screen using CV. This option only applies to prompts"
"RTN","PXRMDEDT",254,0)
 .S HTEXT(4)="which update PCE or vitals."
"RTN","PXRMDEDT",255,0)
 .S HTEXT(5)="Enter N to leave the dialog prompt unchanged."
"RTN","PXRMDEDT",256,0)
 K ^UTILITY($J,"W")
"RTN","PXRMDEDT",257,0)
 S IC=""
"RTN","PXRMDEDT",258,0)
 F  S IC=$O(HTEXT(IC)) Q:IC=""  D
"RTN","PXRMDEDT",259,0)
 . S X=HTEXT(IC)
"RTN","PXRMDEDT",260,0)
 . D ^DIWP
"RTN","PXRMDEDT",261,0)
 W !
"RTN","PXRMDEDT",262,0)
 S IC=0
"RTN","PXRMDEDT",263,0)
 F  S IC=$O(^UTILITY($J,"W",0,IC)) Q:IC=""  D
"RTN","PXRMDEDT",264,0)
 . W !,^UTILITY($J,"W",0,IC,0)
"RTN","PXRMDEDT",265,0)
 K ^UTILITY($J,"W")
"RTN","PXRMDEDT",266,0)
 W !
"RTN","PXRMDEDT",267,0)
 Q
"RTN","PXRMDEDT",268,0)
 ;
"RTN","PXRMDEDT",269,0)
LOCK(DA) ;Lock the record
"RTN","PXRMDEDT",270,0)
 N OK
"RTN","PXRMDEDT",271,0)
 S OK=1
"RTN","PXRMDEDT",272,0)
 I '$$VEDIT^PXRMUTIL("^PXRMD(801.41,",DA) D
"RTN","PXRMDEDT",273,0)
 .N DTYP
"RTN","PXRMDEDT",274,0)
 .S DTYP=$P($G(^PXRMD(801.41,DA,0)),U,4)
"RTN","PXRMDEDT",275,0)
 .;Allow limit edit of Result Elements that are not lock
"RTN","PXRMDEDT",276,0)
 .I DTYP="T",+$P($G(^PXRMD(801.41,DA,100)),U,4)=0 Q
"RTN","PXRMDEDT",277,0)
 .;Allow edit of findings but not component multiple on groups 
"RTN","PXRMDEDT",278,0)
 .I DTYP="G",$G(PXRMDIEN),DA'=PXRMDIEN Q
"RTN","PXRMDEDT",279,0)
 .I DTYP="G",$G(PXRMGTYP)="DLGE" Q
"RTN","PXRMDEDT",280,0)
 .;Allow edit of element findings
"RTN","PXRMDEDT",281,0)
 .I DTYP="E" Q
"RTN","PXRMDEDT",282,0)
 .S OK=0
"RTN","PXRMDEDT",283,0)
 .W !!,?5,"VA- and national class reminder dialogs may not be edited" H 2
"RTN","PXRMDEDT",284,0)
 I 'OK Q 0
"RTN","PXRMDEDT",285,0)
 ;
"RTN","PXRMDEDT",286,0)
 L +^PXRMD(801.41,DA):0 I  Q 1
"RTN","PXRMDEDT",287,0)
 E  W !!,?5,"Another user is editing this entry, try later." H 2 Q 0
"RTN","PXRMDEDT",288,0)
 ;
"RTN","PXRMDEDT",289,0)
PROMPT(IEN) ;
"RTN","PXRMDEDT",290,0)
 N DIE,DR
"RTN","PXRMDEDT",291,0)
 S DIE="^PXRMD(801.41,",DA=IEN
"RTN","PXRMDEDT",292,0)
 S DR=".01;3;100;101;102;24;23;21"
"RTN","PXRMDEDT",293,0)
 S IEN=$G(^PXRMD(801.41,IEN,46)) I $G(IEN)="" G EX
"RTN","PXRMDEDT",294,0)
 I $P($G(^PXRMD(801.42,IEN,0)),U)="COM" S DR=DR_";45"
"RTN","PXRMDEDT",295,0)
EX ;
"RTN","PXRMDEDT",296,0)
 D ^DIE
"RTN","PXRMDEDT",297,0)
 Q
"RTN","PXRMDEDT",298,0)
 ;
"RTN","PXRMDEDT",299,0)
UNLOCK(DA) ;Unlock the record
"RTN","PXRMDEDT",300,0)
 L -^PXRMD(801.41,DA)
"RTN","PXRMDEDT",301,0)
 Q
"RTN","PXRMDEV")
0^24^B78211075
"RTN","PXRMDEV",1,0)
PXRMDEV ;SLC/PKR - This is a driver for testing Clinical Reminders. ;10/09/2012
"RTN","PXRMDEV",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,11,16,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMDEV",3,0)
 ;
"RTN","PXRMDEV",4,0)
 ;==================================================
"RTN","PXRMDEV",5,0)
CMOUT(PXRHM,NL,OUTPUT) ;Do formatted Clinical Maintenance output.
"RTN","PXRMDEV",6,0)
 N DUE,DUECOL,HIST,LAST,LASTCOL,LNUM,RIEN,RNAME,STATUS,STATCOL
"RTN","PXRMDEV",7,0)
 N TEMP,TEXT,TYPE
"RTN","PXRMDEV",8,0)
 S TEXT=$S(PXRHM=0:"Due Now ",PXRHM=1:"Summary ",PXRHM=5:"Maintenance ",PXRHM=55:"Order Check ",1:"")
"RTN","PXRMDEV",9,0)
 S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",10,0)
 S NL=NL+1,OUTPUT(NL)=TEXT_"Output:"
"RTN","PXRMDEV",11,0)
 S RIEN=$O(^TMP("PXRHM",$J,""))
"RTN","PXRMDEV",12,0)
 S RNAME=$O(^TMP("PXRHM",$J,RIEN,""))
"RTN","PXRMDEV",13,0)
 S TEMP=$G(^TMP("PXRHM",$J,RIEN,RNAME))
"RTN","PXRMDEV",14,0)
 S STATUS=$P(TEMP,U,1)
"RTN","PXRMDEV",15,0)
 S DUE=$$DDATE^PXRMDATE($P(TEMP,U,2))
"RTN","PXRMDEV",16,0)
 S LAST=$$DDATE^PXRMDATE($P(TEMP,U,3))
"RTN","PXRMDEV",17,0)
 S STATCOL=41-($L(STATUS)/2)
"RTN","PXRMDEV",18,0)
 S DUECOL=53-($L(DUE)/2)
"RTN","PXRMDEV",19,0)
 S LASTCOL=67-($L(LAST)/2)
"RTN","PXRMDEV",20,0)
 S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",21,0)
 S TEXT=$$REPEAT^XLFSTR(" ",36)_"--STATUS-- --DUE DATE--  --LAST DONE--"
"RTN","PXRMDEV",22,0)
 S NL=NL+1,OUTPUT(NL)=TEXT
"RTN","PXRMDEV",23,0)
 S TEXT=RNAME_$$REPEAT^XLFSTR(" ",(STATCOL-$L(RNAME)))_STATUS
"RTN","PXRMDEV",24,0)
 S TEXT=TEXT_$$REPEAT^XLFSTR(" ",(DUECOL-$L(TEXT)))_DUE
"RTN","PXRMDEV",25,0)
 S TEXT=TEXT_$$REPEAT^XLFSTR(" ",(LASTCOL-$L(TEXT)))_LAST
"RTN","PXRMDEV",26,0)
 S NL=NL+1,OUTPUT(NL)=TEXT
"RTN","PXRMDEV",27,0)
 S LNUM=0
"RTN","PXRMDEV",28,0)
 F  S LNUM=$O(^TMP("PXRHM",$J,RIEN,RNAME,"TXT",LNUM)) Q:LNUM=""  D
"RTN","PXRMDEV",29,0)
 . S NL=NL+1,OUTPUT(NL)=^TMP("PXRHM",$J,RIEN,RNAME,"TXT",LNUM)
"RTN","PXRMDEV",30,0)
 Q
"RTN","PXRMDEV",31,0)
 ;
"RTN","PXRMDEV",32,0)
 ;==================================================
"RTN","PXRMDEV",33,0)
DEB ;Prompt for patient and reminder by name input component.
"RTN","PXRMDEV",34,0)
 N DATE,DFN,DIC,DIR,DIROUT,DTOUT,DUOUT,HASFF,HASTERM,IND
"RTN","PXRMDEV",35,0)
 N PXRHM,PXRMFFSS,PXRMITEM,PXRMTDEB,X,Y
"RTN","PXRMDEV",36,0)
 S DIC=2,DIC("A")="Select Patient: "
"RTN","PXRMDEV",37,0)
 S DIC(0)="AEQMZ"
"RTN","PXRMDEV",38,0)
GPAT1 D ^DIC
"RTN","PXRMDEV",39,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",40,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",41,0)
 S DFN=+$P(Y,U,1)
"RTN","PXRMDEV",42,0)
 I DFN=-1 G GPAT1
"RTN","PXRMDEV",43,0)
 S DIC=811.9,DIC("A")="Select Reminder: "
"RTN","PXRMDEV",44,0)
GREM1 D ^DIC
"RTN","PXRMDEV",45,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",46,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",47,0)
 S PXRMITEM=+$P(Y,U,1)
"RTN","PXRMDEV",48,0)
 I PXRMITEM=-1 G GREM1
"RTN","PXRMDEV",49,0)
 S DIR(0)="LA"_U_"0"
"RTN","PXRMDEV",50,0)
 S DIR("A")="Enter component number 0, 1, 5, 12, 55: "
"RTN","PXRMDEV",51,0)
 D ^DIR
"RTN","PXRMDEV",52,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",53,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",54,0)
 I X="" S X=5
"RTN","PXRMDEV",55,0)
 S PXRHM=X
"RTN","PXRMDEV",56,0)
 S DIR(0)="DA^"_0_"::ETX"
"RTN","PXRMDEV",57,0)
 S DIR("A")="Enter date for reminder evaluation: "
"RTN","PXRMDEV",58,0)
 S DIR("B")=$$FMTE^XLFDT($$DT^XLFDT,"D")
"RTN","PXRMDEV",59,0)
 S DIR("PRE")="S X=$$DCHECK^PXRMDATE(X) K:X=-1 X"
"RTN","PXRMDEV",60,0)
 W !
"RTN","PXRMDEV",61,0)
 D ^DIR K DIR
"RTN","PXRMDEV",62,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",63,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",64,0)
 S DATE=Y
"RTN","PXRMDEV",65,0)
 S (HASFF,HASTERM,PXRMFFSS,PXRMTDEB)=0
"RTN","PXRMDEV",66,0)
 I $D(^PXD(811.9,PXRMITEM,25,"B")) S HASFF=1
"RTN","PXRMDEV",67,0)
 I HASFF S PXRMFFSS=$$ASKYN^PXRMEUT("N","Display step-by-step function finding evaluation","","")
"RTN","PXRMDEV",68,0)
 I $D(^PXD(811.9,PXRMITEM,20,"E","PXRMD(811.5,")) S HASTERM=1
"RTN","PXRMDEV",69,0)
 I 'HASTERM D
"RTN","PXRMDEV",70,0)
 . S IND=0
"RTN","PXRMDEV",71,0)
 . F  S IND=+$O(^PXD(811.9,PXRMITEM,20,"EDEP",IND)) Q:IND=0  D
"RTN","PXRMDEV",72,0)
 .. I $D(^PXD(811.9,PXRMITEM,20,"EDEP",IND,"PXRMD(811.5,")) S HASTERM=1
"RTN","PXRMDEV",73,0)
 I HASTERM S PXRMTDEB=$$ASKYN^PXRMEUT("N","Display all term findings","","")
"RTN","PXRMDEV",74,0)
 D DOREM(DFN,PXRMITEM,PXRHM,DATE)
"RTN","PXRMDEV",75,0)
 Q
"RTN","PXRMDEV",76,0)
 ;
"RTN","PXRMDEV",77,0)
 ;==================================================
"RTN","PXRMDEV",78,0)
DEV ;Prompt for patient and reminder by name and evaluation date.
"RTN","PXRMDEV",79,0)
 N DATE,DFN,DIC,DIROUT,DIRUT,DTOUT,DUOUT,HASFF,HASTERM,IND
"RTN","PXRMDEV",80,0)
 N PXRHM,PXRMFFSS,PXRMITEM,PXRMTDEB,REF,X,Y
"RTN","PXRMDEV",81,0)
 S DIC=2,DIC("A")="Select Patient: "
"RTN","PXRMDEV",82,0)
 S DIC(0)="AEQMZ"
"RTN","PXRMDEV",83,0)
GPAT2 D ^DIC
"RTN","PXRMDEV",84,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",85,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",86,0)
 S DFN=+$P(Y,U,1)
"RTN","PXRMDEV",87,0)
 I DFN=-1 G GPAT2
"RTN","PXRMDEV",88,0)
 S DIC=811.9,DIC("A")="Select Reminder: "
"RTN","PXRMDEV",89,0)
GREM2 D ^DIC
"RTN","PXRMDEV",90,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",91,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",92,0)
 S PXRMITEM=+$P(Y,U,1)
"RTN","PXRMDEV",93,0)
 I PXRMITEM=-1 G GREM2
"RTN","PXRMDEV",94,0)
 S PXRHM=5
"RTN","PXRMDEV",95,0)
 S DIR(0)="DA^"_0_"::ETX"
"RTN","PXRMDEV",96,0)
 S DIR("A")="Enter date for reminder evaluation: "
"RTN","PXRMDEV",97,0)
 S DIR("B")=$$FMTE^XLFDT($$DT^XLFDT,"D")
"RTN","PXRMDEV",98,0)
 S DIR("PRE")="S X=$$DCHECK^PXRMDATE(X) K:X=-1 X"
"RTN","PXRMDEV",99,0)
 W !
"RTN","PXRMDEV",100,0)
 D ^DIR K DIR
"RTN","PXRMDEV",101,0)
 I $D(DIROUT)!$D(DIRUT) Q
"RTN","PXRMDEV",102,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMDEV",103,0)
 S DATE=Y
"RTN","PXRMDEV",104,0)
 S (HASFF,HASTERM,PXRMFFSS,PXRMTDEB)=0
"RTN","PXRMDEV",105,0)
 I $D(^PXD(811.9,PXRMITEM,25,"B")) S HASFF=1
"RTN","PXRMDEV",106,0)
 I HASFF S PXRMFFSS=$$ASKYN^PXRMEUT("N","Display step-by-step function finding evaluation","","")
"RTN","PXRMDEV",107,0)
 I $D(^PXD(811.9,PXRMITEM,20,"E","PXRMD(811.5,")) S HASTERM=1
"RTN","PXRMDEV",108,0)
 I 'HASTERM D
"RTN","PXRMDEV",109,0)
 . S IND=0
"RTN","PXRMDEV",110,0)
 . F  S IND=+$O(^PXD(811.9,PXRMITEM,20,"EDEP",IND)) Q:IND=0  D
"RTN","PXRMDEV",111,0)
 .. I $D(^PXD(811.9,PXRMITEM,20,"EDEP",IND,"PXRMD(811.5,")) S HASTERM=1
"RTN","PXRMDEV",112,0)
 I HASTERM S PXRMTDEB=$$ASKYN^PXRMEUT("N","Display all term findings","","")
"RTN","PXRMDEV",113,0)
 D DOREM(DFN,PXRMITEM,PXRHM,DATE)
"RTN","PXRMDEV",114,0)
 Q
"RTN","PXRMDEV",115,0)
 ;
"RTN","PXRMDEV",116,0)
 ;==================================================
"RTN","PXRMDEV",117,0)
DOREM(DFN,PXRMITEM,PXRHM,DATE) ;Do the reminder
"RTN","PXRMDEV",118,0)
 N BOP,DEFARR,FIEVAL,FINDING,IND,JND,NL,NOUT,OUTPUT,PNAME,PXRMDEBG,PXRMID
"RTN","PXRMDEV",119,0)
 N REF,TEXTOUT,TFIEVAL,TTEXT,X
"RTN","PXRMDEV",120,0)
 ;This is a debugging run so set PXRMDEBG.
"RTN","PXRMDEV",121,0)
 S NL=0,PXRMDEBG=1
"RTN","PXRMDEV",122,0)
 D DEF^PXRMLDR(PXRMITEM,.DEFARR)
"RTN","PXRMDEV",123,0)
 I +$G(DATE)=0 D EVAL^PXRM(DFN,.DEFARR,PXRHM,1,.FIEVAL)
"RTN","PXRMDEV",124,0)
 I +$G(DATE)>0 D EVAL^PXRM(DFN,.DEFARR,PXRHM,1,.FIEVAL,DATE)
"RTN","PXRMDEV",125,0)
 ;
"RTN","PXRMDEV",126,0)
 I $D(^TMP(PXRMID,$J,"FFDEB")) M FIEVAL=^TMP(PXRMID,$J,"FFDEB") K ^TMP(PXRMID,$J,"FFDEB")
"RTN","PXRMDEV",127,0)
 ;
"RTN","PXRMDEV",128,0)
 S TTEXT=^PXD(811.9,PXRMITEM,0)
"RTN","PXRMDEV",129,0)
 S PNAME=$P(TTEXT,U,2)
"RTN","PXRMDEV",130,0)
 I PNAME="" S PNAME=$P(TTEXT,U,1)
"RTN","PXRMDEV",131,0)
 S NL=NL+1,OUTPUT(NL)="Reminder: "_PNAME
"RTN","PXRMDEV",132,0)
 S NL=NL+1,OUTPUT(NL)="Patient: "_$$GET1^DIQ(2,DFN,.01)
"RTN","PXRMDEV",133,0)
 S NL=NL+1,OUTPUT(NL)=" "
"RTN","PXRMDEV",134,0)
 S NL=NL+1,OUTPUT(NL)="The elements of the FIEVAL array are:"
"RTN","PXRMDEV",135,0)
 S REF="FIEVAL"
"RTN","PXRMDEV",136,0)
 D ACOPY^PXRMUTIL(REF,"TTEXT()")
"RTN","PXRMDEV",137,0)
 S IND=0
"RTN","PXRMDEV",138,0)
 F  S IND=$O(TTEXT(IND)) Q:IND=""  D
"RTN","PXRMDEV",139,0)
 . I $L(TTEXT(IND))<79 S NL=NL+1,OUTPUT(NL)=TTEXT(IND) Q
"RTN","PXRMDEV",140,0)
 . D FORMATS^PXRMTEXT(1,79,TTEXT(IND),.NOUT,.TEXTOUT)
"RTN","PXRMDEV",141,0)
 . F JND=1:1:NOUT S NL=NL+1,OUTPUT(NL)=TEXTOUT(JND)
"RTN","PXRMDEV",142,0)
 ;
"RTN","PXRMDEV",143,0)
 I $G(PXRMFFSS) D
"RTN","PXRMDEV",144,0)
 . N FFN,STEP
"RTN","PXRMDEV",145,0)
 . S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",146,0)
 . S NL=NL+1,OUTPUT(NL)="Step-by-step function finding evaluation:"
"RTN","PXRMDEV",147,0)
 . S FFN=""
"RTN","PXRMDEV",148,0)
 . F  S FFN=$O(^TMP("PXRMFFSS",$J,FFN)) Q:FFN=""  D
"RTN","PXRMDEV",149,0)
 .. S NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",150,0)
 .. S NL=NL+1,OUTPUT(NL)=" Function finding "_FFN
"RTN","PXRMDEV",151,0)
 .. D FORMATS^PXRMTEXT(1,79,$P(FIEVAL(FFN,"DETAIL"),U,2),.NOUT,.TEXTOUT)
"RTN","PXRMDEV",152,0)
 .. F JND=1:1:NOUT S NL=NL+1,OUTPUT(NL)=TEXTOUT(JND)
"RTN","PXRMDEV",153,0)
 .. S NL=NL+1,OUTPUT(NL)=" = "_^TMP("PXRMFFSS",$J,FFN,0)
"RTN","PXRMDEV",154,0)
 .. S NL=NL+1,OUTPUT(NL)="Step Result"
"RTN","PXRMDEV",155,0)
 .. S STEP=0
"RTN","PXRMDEV",156,0)
 .. F  S STEP=$O(^TMP("PXRMFFSS",$J,FFN,STEP)) Q:STEP=""  D
"RTN","PXRMDEV",157,0)
 ... S NL=NL+1,OUTPUT(NL)=$$RJ^XLFSTR(STEP_".",4," ")_"     "_^TMP("PXRMFFSS",$J,FFN,STEP)
"RTN","PXRMDEV",158,0)
 . K ^TMP("PXRMFFSS",$J)
"RTN","PXRMDEV",159,0)
 I $G(PXRMTDEB) D
"RTN","PXRMDEV",160,0)
 . S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",161,0)
 . S NL=NL+1,OUTPUT(NL)="Term findings:"
"RTN","PXRMDEV",162,0)
 . S REF="TFIEVAL"
"RTN","PXRMDEV",163,0)
 . S FINDING=0
"RTN","PXRMDEV",164,0)
 . F  S FINDING=$O(^TMP("PXRMTDEB",$J,FINDING)) Q:FINDING=""  D
"RTN","PXRMDEV",165,0)
 .. K TFIEVAL M TFIEVAL(FINDING)=^TMP("PXRMTDEB",$J,FINDING)
"RTN","PXRMDEV",166,0)
 .. S NL=NL+1,OUTPUT(NL)="Finding "_FINDING_":"
"RTN","PXRMDEV",167,0)
 .. K TTEXT
"RTN","PXRMDEV",168,0)
 .. D ACOPY^PXRMUTIL(REF,"TTEXT()")
"RTN","PXRMDEV",169,0)
 .. S IND=0
"RTN","PXRMDEV",170,0)
 .. F  S IND=$O(TTEXT(IND)) Q:IND=""  S NL=NL+1,OUTPUT(NL)=TTEXT(IND)
"RTN","PXRMDEV",171,0)
 . K ^TMP("PXRMTDEB",$J)
"RTN","PXRMDEV",172,0)
 ;
"RTN","PXRMDEV",173,0)
 I $D(^TMP(PXRMID,$J)) D
"RTN","PXRMDEV",174,0)
 . S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",175,0)
 . S NL=NL+1,OUTPUT(NL)="The elements of the ^TMP(PXRMID,$J) array are:"
"RTN","PXRMDEV",176,0)
 . S REF="^TMP(PXRMID,$J)"
"RTN","PXRMDEV",177,0)
 . K TTEXT
"RTN","PXRMDEV",178,0)
 . D ACOPY^PXRMUTIL(REF,"TTEXT()")
"RTN","PXRMDEV",179,0)
 . S IND=0
"RTN","PXRMDEV",180,0)
 . F  S IND=$O(TTEXT(IND)) Q:IND=""  S NL=NL+1,OUTPUT(NL)=TTEXT(IND)
"RTN","PXRMDEV",181,0)
 . K ^TMP(PXRMID,$J)
"RTN","PXRMDEV",182,0)
 ;
"RTN","PXRMDEV",183,0)
 I $D(^TMP("PXRHM",$J)) D
"RTN","PXRMDEV",184,0)
 . S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",185,0)
 . S NL=NL+1,OUTPUT(NL)="The elements of the ^TMP(""PXRHM"",$J) array are:"
"RTN","PXRMDEV",186,0)
 . S REF="^TMP(""PXRHM"",$J)"
"RTN","PXRMDEV",187,0)
 . K TTEXT
"RTN","PXRMDEV",188,0)
 . D ACOPY^PXRMUTIL(REF,"TTEXT()")
"RTN","PXRMDEV",189,0)
 . S IND=0
"RTN","PXRMDEV",190,0)
 . F  S IND=$O(TTEXT(IND)) Q:IND=""  S NL=NL+1,OUTPUT(NL)=TTEXT(IND)
"RTN","PXRMDEV",191,0)
 ;
"RTN","PXRMDEV",192,0)
 I $D(^TMP("PXRHM",$J)) D CMOUT(PXRHM,.NL,.OUTPUT)
"RTN","PXRMDEV",193,0)
 I $D(^TMP("PXRMMHVC",$J)) D MHVOUT(PXRHM,.NL,.OUTPUT)
"RTN","PXRMDEV",194,0)
 K ^TMP("PXRM",$J),^TMP("PXRHM",$J),^TMP("PXRMMHVC",$J)
"RTN","PXRMDEV",195,0)
 S BOP=$$BORP^PXRMUTIL("P")
"RTN","PXRMDEV",196,0)
 I BOP="B" D
"RTN","PXRMDEV",197,0)
 . S X="IORESET"
"RTN","PXRMDEV",198,0)
 . D ENDR^%ZISS
"RTN","PXRMDEV",199,0)
 . D BROWSE^DDBR("OUTPUT","N","Reminder Test")
"RTN","PXRMDEV",200,0)
 . W IORESET
"RTN","PXRMDEV",201,0)
 . D KILL^%ZISS
"RTN","PXRMDEV",202,0)
 I BOP="P" D GPRINT^PXRMUTIL("OUTPUT")
"RTN","PXRMDEV",203,0)
 Q
"RTN","PXRMDEV",204,0)
 ;
"RTN","PXRMDEV",205,0)
 ;==================================================
"RTN","PXRMDEV",206,0)
MHVOUT(PXRHM,NL,OUTPUT) ;Do formatted MHV combined output.
"RTN","PXRMDEV",207,0)
 N DUE,DUECOL,HIST,LAST,LASTCOL,LNUM,RIEN,RNAME
"RTN","PXRMDEV",208,0)
 N STATUS,STATCOL,TEMP,TEXT,TYPE
"RTN","PXRMDEV",209,0)
 S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",210,0)
 S NL=NL+1,OUTPUT(NL)="MHV Summary and Detailed Output:"
"RTN","PXRMDEV",211,0)
 S RIEN=$O(^TMP("PXRMMHVC",$J,""))
"RTN","PXRMDEV",212,0)
 S TEMP=^TMP("PXRMMHVC",$J,RIEN,"STATUS")
"RTN","PXRMDEV",213,0)
 S STATUS=$P(TEMP,U,1)
"RTN","PXRMDEV",214,0)
 S DUE=$$DDATE^PXRMDATE($P(TEMP,U,2))
"RTN","PXRMDEV",215,0)
 S LAST=$$DDATE^PXRMDATE($P(TEMP,U,3))
"RTN","PXRMDEV",216,0)
 S STATCOL=41-($L(STATUS)/2)
"RTN","PXRMDEV",217,0)
 S DUECOL=53-($L(DUE)/2)
"RTN","PXRMDEV",218,0)
 S LASTCOL=67-($L(LAST)/2)
"RTN","PXRMDEV",219,0)
 S RNAME=$P(^PXD(811.9,RIEN,0),U,3)
"RTN","PXRMDEV",220,0)
 I RNAME="" S RNAME=$P(^PXD(811.9,RIEN,0),U,1)
"RTN","PXRMDEV",221,0)
 S TEXT=$$REPEAT^XLFSTR(" ",36)_"--STATUS-- --DUE DATE--  --LAST DONE--"
"RTN","PXRMDEV",222,0)
 S NL=NL+1,OUTPUT(NL)=TEXT
"RTN","PXRMDEV",223,0)
 S TEXT=RNAME_$$REPEAT^XLFSTR(" ",(STATCOL-$L(RNAME)))_STATUS
"RTN","PXRMDEV",224,0)
 S TEXT=TEXT_$$REPEAT^XLFSTR(" ",(DUECOL-$L(TEXT)))_DUE
"RTN","PXRMDEV",225,0)
 S TEXT=TEXT_$$REPEAT^XLFSTR(" ",(LASTCOL-$L(TEXT)))_LAST
"RTN","PXRMDEV",226,0)
 S NL=NL+1,OUTPUT(NL)=TEXT
"RTN","PXRMDEV",227,0)
 I '$D(^TMP("PXRMMHVC",$J)) Q
"RTN","PXRMDEV",228,0)
 I (PXRHM=11)!(PXRHM=12) D
"RTN","PXRMDEV",229,0)
 .; W !!,"---------- Detailed Output ----------"
"RTN","PXRMDEV",230,0)
 . S NL=NL+1,OUTPUT(NL)="---------- Detailed Output ----------"
"RTN","PXRMDEV",231,0)
 . S LNUM=0
"RTN","PXRMDEV",232,0)
 . F  S LNUM=$O(^TMP("PXRMMHVC",$J,RIEN,"DETAIL",LNUM)) Q:LNUM=""  D
"RTN","PXRMDEV",233,0)
 .. S NL=NL+1,OUTPUT(NL)=^TMP("PXRMMHVC",$J,RIEN,"DETAIL",LNUM)
"RTN","PXRMDEV",234,0)
 I (PXRHM=10)!(PXRHM=12) D
"RTN","PXRMDEV",235,0)
 . S NL=NL+1,OUTPUT(NL)="",NL=NL+1,OUTPUT(NL)=""
"RTN","PXRMDEV",236,0)
 . S NL=NL+1,OUTPUT(NL)="---------- Summary Output ----------"
"RTN","PXRMDEV",237,0)
 . S LNUM=0
"RTN","PXRMDEV",238,0)
 . F  S LNUM=$O(^TMP("PXRMMHVC",$J,RIEN,"SUMMARY",LNUM)) Q:LNUM=""  D
"RTN","PXRMDEV",239,0)
 .. S NL=NL+1,OUTPUT(NL)=^TMP("PXRMMHVC",$J,RIEN,"SUMMARY",LNUM)
"RTN","PXRMDEV",240,0)
 Q
"RTN","PXRMDEV",241,0)
 ;
"RTN","PXRMDUTL")
0^22^B9494253
"RTN","PXRMDUTL",1,0)
PXRMDUTL ; SLC/AGP - DIALOG UTILITIES. ;09/6/2012
"RTN","PXRMDUTL",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 193
"RTN","PXRMDUTL",3,0)
 Q
"RTN","PXRMDUTL",4,0)
 ;
"RTN","PXRMDUTL",5,0)
 ;==========================================
"RTN","PXRMDUTL",6,0)
ALLOWDEL(IEN) ; check to see if the item can be deleted
"RTN","PXRMDUTL",7,0)
 N CLASS,TYPE
"RTN","PXRMDUTL",8,0)
 S TYPE=$P($G(^PXRMD(801.41,IEN,0)),U,4)
"RTN","PXRMDUTL",9,0)
 S CLASS=$P($G(^PXRMD(801.41,IEN,100)),U)
"RTN","PXRMDUTL",10,0)
 I (CLASS="N")&((TYPE="P")!(TYPE="F")) Q 0
"RTN","PXRMDUTL",11,0)
 Q 1
"RTN","PXRMDUTL",12,0)
 ;
"RTN","PXRMDUTL",13,0)
DELD(DIEN) ; delete the dialog item
"RTN","PXRMDUTL",14,0)
 N ARRAY,CNT,DARRAY,DA,DIK,PXRMINST
"RTN","PXRMDUTL",15,0)
 S CNT=0
"RTN","PXRMDUTL",16,0)
 D DITEMAR(DIEN,.ARRAY,.DARRAY,.CNT)
"RTN","PXRMDUTL",17,0)
 S PXRMINST=1
"RTN","PXRMDUTL",18,0)
 S DIK="^PXRMD(801.41,"
"RTN","PXRMDUTL",19,0)
 S CNT="" F  S CNT=$O(ARRAY(CNT),-1) Q:CNT=""  D
"RTN","PXRMDUTL",20,0)
 .S DA=$O(ARRAY(CNT,"")) Q:DA'>0
"RTN","PXRMDUTL",21,0)
 .I $$ALLOWDEL(DA)=0 Q
"RTN","PXRMDUTL",22,0)
 .D ^DIK
"RTN","PXRMDUTL",23,0)
 Q
"RTN","PXRMDUTL",24,0)
 ;
"RTN","PXRMDUTL",25,0)
 ; builds an array of items beneath the dialog item, lowest item first.
"RTN","PXRMDUTL",26,0)
DITEMAR(DIEN,ARRAY,DARRAY,DCNT) ;
"RTN","PXRMDUTL",27,0)
 ;  DIEN is the IEN of the dialog top level
"RTN","PXRMDUTL",28,0)
 ;  Array contains the dialog elements and groups within the dialog.
"RTN","PXRMDUTL",29,0)
 N CNT,IEN,REPIEN,TYPE
"RTN","PXRMDUTL",30,0)
 S CNT=0 F  S CNT=$O(^PXRMD(801.41,DIEN,10,CNT)) Q:CNT'>0  D
"RTN","PXRMDUTL",31,0)
 .S IEN=$P($G(^PXRMD(801.41,DIEN,10,CNT,0)),U,2) Q:IEN'>0
"RTN","PXRMDUTL",32,0)
 .S REPIEN=$P($G(^PXRMD(801.41,IEN,49)),U,3)
"RTN","PXRMDUTL",33,0)
 .I REPIEN>0 D DITEMAR(REPIEN,.ARRAY,.DARRAY,.DCNT)
"RTN","PXRMDUTL",34,0)
 .S TYPE=$P($G(^PXRMD(801.41,IEN,0)),U,4)
"RTN","PXRMDUTL",35,0)
 .I TYPE="G"!(TYPE="E") D DITEMAR(IEN,.ARRAY,.DARRAY,.DCNT)
"RTN","PXRMDUTL",36,0)
 .I '$D(DARRAY(IEN)) S DARRAY(IEN)="",DCNT=DCNT+1,ARRAY(DCNT,IEN)=""
"RTN","PXRMDUTL",37,0)
 I '$D(DARRAY(DIEN)) S DARRAY(DIEN)="",DCNT=DCNT+1,ARRAY(DCNT,DIEN)=""
"RTN","PXRMDUTL",38,0)
 Q
"RTN","PXRMDUTL",39,0)
 ;
"RTN","PXRMDUTL",40,0)
DMAKENAT(DA) ; sets the class field and renamed to the correct national format
"RTN","PXRMDUTL",41,0)
 N CLASS,DIE,DR,IEN,NAME,NEWNAME,PREFIX,TYPE
"RTN","PXRMDUTL",42,0)
 S NAME=$P($G(^PXRMD(801.41,DA,0)),U)
"RTN","PXRMDUTL",43,0)
 I $E(NAME,1,3)="VA-"!($E(NAME,1,4)="PXRM") Q
"RTN","PXRMDUTL",44,0)
 S CLASS="N"
"RTN","PXRMDUTL",45,0)
 S DIE="^PXRMXD(801.41,"
"RTN","PXRMDUTL",46,0)
 S DR="100////^S X=CLASS"
"RTN","PXRMDUTL",47,0)
 D ^DIE
"RTN","PXRMDUTL",48,0)
 S TYPE=$P($G(^PXRMD(801.41,DA,0)),U,4)
"RTN","PXRMDUTL",49,0)
 S PREFIX=$S(TYPE="R":"VA-",TYPE="G":"VA-",TYPE="E":"VA-",1:"PXRM ")
"RTN","PXRMDUTL",50,0)
 S NEWNAME=PREFIX_NAME
"RTN","PXRMDUTL",51,0)
 D RENAME^PXRMUTIL(801.41,NAME,NEWNAME)
"RTN","PXRMDUTL",52,0)
 Q
"RTN","PXRMDUTL",53,0)
 ;
"RTN","PXRMDUTL",54,0)
 ;=============================================================
"RTN","PXRMDUTL",55,0)
 ; Build an array of findings for dialog types
"RTN","PXRMDUTL",56,0)
 ; Input a string of characters for the dailog type field.
"RTN","PXRMDUTL",57,0)
 ;    example "EGS" = search element, groups, result groups
"RTN","PXRMDUTL",58,0)
 ; Output an array by finding types, Finding IEN, Dialog IEN, "F" or "A"
"RTN","PXRMDUTL",59,0)
 ;    example OUT("AUTTHF(",608,631,"F")=""
"RTN","PXRMDUTL",60,0)
FARRAY(OUTPUT,TYPES) ;
"RTN","PXRMDUTL",61,0)
 N AFIEN,AFIND,DIEN,FIND,NODE,OI,TYPE,X
"RTN","PXRMDUTL",62,0)
 F X=1:1:$L(TYPES)  S TYPE=$E(TYPES,X) D 
"RTN","PXRMDUTL",63,0)
 .S DIEN=""
"RTN","PXRMDUTL",64,0)
 .F  S DIEN=$O(^PXRMD(801.41,"TYPE",TYPE,DIEN)) Q:DIEN'>0  D
"RTN","PXRMDUTL",65,0)
 ..I TYPE="S" D  Q
"RTN","PXRMDUTL",66,0)
 ...S FIND=$P($G(^PXRMD(801.41,DIEN,50)),U)
"RTN","PXRMDUTL",67,0)
 ...I FIND'="" D SETGBL(.OUTPUT,DIEN,FIND_";YTT(601.71,","RG",0)
"RTN","PXRMDUTL",68,0)
 ..S NODE=$G(^PXRMD(801.41,DIEN,1))
"RTN","PXRMDUTL",69,0)
 ..S FIND=$P(NODE,U,5),OI=$P(NODE,U,7)
"RTN","PXRMDUTL",70,0)
 ..I FIND'="" D SETGBL(.OUTPUT,DIEN,FIND,"F",0)
"RTN","PXRMDUTL",71,0)
 ..I OI'="" D SETGBL(.OUTPUT,DIEN,OI_";ORD(101.43,","O",0)
"RTN","PXRMDUTL",72,0)
 ..S AFIND=""
"RTN","PXRMDUTL",73,0)
 ..F  S AFIND=$O(^PXRMD(801.41,DIEN,3,"B",AFIND)) Q:AFIND=""  D
"RTN","PXRMDUTL",74,0)
 ...S AFIEN=$O(^PXRMD(801.41,DIEN,3,"B",AFIND,""))
"RTN","PXRMDUTL",75,0)
 ...D SETGBL(.OUTPUT,DIEN,AFIND,"A",AFIEN)
"RTN","PXRMDUTL",76,0)
 Q
"RTN","PXRMDUTL",77,0)
 ;
"RTN","PXRMDUTL",78,0)
SETGBL(ARRAY,DIEN,VARP,LOC,IEN) ;
"RTN","PXRMDUTL",79,0)
 N FIEN,GBL
"RTN","PXRMDUTL",80,0)
 S GBL=$P(VARP,";",2),FIEN=$P(VARP,";")
"RTN","PXRMDUTL",81,0)
 I LOC="A" S ARRAY(GBL,FIEN,DIEN,LOC,IEN)="" Q
"RTN","PXRMDUTL",82,0)
 S ARRAY(GBL,FIEN,DIEN,LOC)=""
"RTN","PXRMDUTL",83,0)
 Q
"RTN","PXRMDUTL",84,0)
 ;
"RTN","PXRMDUTL",85,0)
NATCONV(DIEN) ; entry point to convert a local dialog to a national dialog
"RTN","PXRMDUTL",86,0)
 N ARRAY,IEN
"RTN","PXRMDUTL",87,0)
 D DITEMAR(DIEN,.ARRAY)
"RTN","PXRMDUTL",88,0)
 S IEN=0 F  S IEN=$O(ARRAY(IEN)) Q:IEN'>0  D
"RTN","PXRMDUTL",89,0)
 .D DMAKENAT(IEN)
"RTN","PXRMDUTL",90,0)
 D DMAKENAT(DIEN)
"RTN","PXRMDUTL",91,0)
 Q
"RTN","PXRMDUTL",92,0)
 ;
"RTN","PXRMEXFI")
0^13^B53496841
"RTN","PXRMEXFI",1,0)
PXRMEXFI ;SLC/PKR/PJH - Exchange utilities for file entries. ;05/18/2012
"RTN","PXRMEXFI",2,0)
 ;;2.0;CLINICAL REMINDERS;**6,12,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXFI",3,0)
 ;==============================================
"RTN","PXRMEXFI",4,0)
DELALL(FILENUM,NAME) ;Delete all file entries named NAME.
"RTN","PXRMEXFI",5,0)
 N IEN,IND,LIST,MSG
"RTN","PXRMEXFI",6,0)
 D FIND^DIC(FILENUM,"","@","K",NAME,"*","","","","LIST","MSG")
"RTN","PXRMEXFI",7,0)
 I $P(LIST("DILIST",0),U,1)=0 Q
"RTN","PXRMEXFI",8,0)
 S IND=0
"RTN","PXRMEXFI",9,0)
 F  S IND=$O(LIST("DILIST",2,IND)) Q:IND=""  D
"RTN","PXRMEXFI",10,0)
 . S IEN=LIST("DILIST",2,IND)
"RTN","PXRMEXFI",11,0)
 . D DELETE(FILENUM,IEN)
"RTN","PXRMEXFI",12,0)
 Q
"RTN","PXRMEXFI",13,0)
 ;
"RTN","PXRMEXFI",14,0)
 ;==============================================
"RTN","PXRMEXFI",15,0)
DELETE(FILENUM,DA) ;Delete a file entry.
"RTN","PXRMEXFI",16,0)
 N DIK
"RTN","PXRMEXFI",17,0)
 S DIK=$$ROOT^DILFD(FILENUM)
"RTN","PXRMEXFI",18,0)
 D ^DIK
"RTN","PXRMEXFI",19,0)
 Q
"RTN","PXRMEXFI",20,0)
 ;
"RTN","PXRMEXFI",21,0)
 ;==============================================
"RTN","PXRMEXFI",22,0)
FEIMSG(SAME,ATTR) ;Output the general file exists install message.
"RTN","PXRMEXFI",23,0)
 N IND,NOUT,TEXT,TEXTO
"RTN","PXRMEXFI",24,0)
 S TEXT(1)=ATTR("FILE NAME")_" entry named "_ATTR("NAME")_" already exists"
"RTN","PXRMEXFI",25,0)
 I SAME D
"RTN","PXRMEXFI",26,0)
 . S TEXT(2)="and the packed component is identical, skipping."
"RTN","PXRMEXFI",27,0)
 . S TEXT(3)=" "
"RTN","PXRMEXFI",28,0)
 . D FORMAT^PXRMTEXT(1,70,3,.TEXT,.NOUT,.TEXTO)
"RTN","PXRMEXFI",29,0)
 . F IND=1:1:NOUT W !,TEXTO(IND)
"RTN","PXRMEXFI",30,0)
 . H 1
"RTN","PXRMEXFI",31,0)
 I 'SAME D
"RTN","PXRMEXFI",32,0)
 . S TEXT(2)="but the packed component is different, what do you want to do?"
"RTN","PXRMEXFI",33,0)
 . D FORMAT^PXRMTEXT(1,70,2,.TEXT,.NOUT,.TEXTO)
"RTN","PXRMEXFI",34,0)
 . F IND=1:1:NOUT W !,TEXTO(IND)
"RTN","PXRMEXFI",35,0)
 Q
"RTN","PXRMEXFI",36,0)
 ;
"RTN","PXRMEXFI",37,0)
 ;==============================================
"RTN","PXRMEXFI",38,0)
FOKTT(FILENUM) ;Check if it is ok to transport items from this file.
"RTN","PXRMEXFI",39,0)
 ;
"RTN","PXRMEXFI",40,0)
 I $G(PXRMIGDS) Q 1
"RTN","PXRMEXFI",41,0)
 ;If a file has been standardized do not transport it.
"RTN","PXRMEXFI",42,0)
 ;DBIA #4640
"RTN","PXRMEXFI",43,0)
 I $P($$GETSTAT^HDISVF01(FILENUM),U,1)>0 Q 0
"RTN","PXRMEXFI",44,0)
 ;
"RTN","PXRMEXFI",45,0)
 ;Drugs not allowed.
"RTN","PXRMEXFI",46,0)
 I FILENUM=50 Q 0
"RTN","PXRMEXFI",47,0)
 ;
"RTN","PXRMEXFI",48,0)
 ;VA Generic not allowed.
"RTN","PXRMEXFI",49,0)
 I FILENUM=50.6 Q 0
"RTN","PXRMEXFI",50,0)
 ;
"RTN","PXRMEXFI",51,0)
 ;VA Drug Class not allowed.
"RTN","PXRMEXFI",52,0)
 I FILENUM=50.605 Q 0
"RTN","PXRMEXFI",53,0)
 ;
"RTN","PXRMEXFI",54,0)
 ;Lab tests not allowed.
"RTN","PXRMEXFI",55,0)
 I FILENUM=60 Q 0
"RTN","PXRMEXFI",56,0)
 ;
"RTN","PXRMEXFI",57,0)
 ;Radiology procedures not allowed.
"RTN","PXRMEXFI",58,0)
 I FILENUM=71 Q 0
"RTN","PXRMEXFI",59,0)
 ;
"RTN","PXRMEXFI",60,0)
 ;ICD9 (used in Dialogs) not allowed.
"RTN","PXRMEXFI",61,0)
 I FILENUM=80 Q 0
"RTN","PXRMEXFI",62,0)
 ;
"RTN","PXRMEXFI",63,0)
 ;ICD0 not allowed.
"RTN","PXRMEXFI",64,0)
 I FILENUM=80.1 Q 0
"RTN","PXRMEXFI",65,0)
 ;
"RTN","PXRMEXFI",66,0)
 ;CPT (used in Dialogs) not allowed.
"RTN","PXRMEXFI",67,0)
 I FILENUM=81 Q 0
"RTN","PXRMEXFI",68,0)
 ;
"RTN","PXRMEXFI",69,0)
 ;Order Dialogs not allowed.
"RTN","PXRMEXFI",70,0)
 I FILENUM=101.41 Q 0
"RTN","PXRMEXFI",71,0)
 ;
"RTN","PXRMEXFI",72,0)
 ;Orderable Items not allowed.
"RTN","PXRMEXFI",73,0)
 I FILENUM=101.43 Q 0
"RTN","PXRMEXFI",74,0)
 ;
"RTN","PXRMEXFI",75,0)
 ;GMRV VITAL TYPE not allowed.
"RTN","PXRMEXFI",76,0)
 I FILENUM=120.51 Q 0
"RTN","PXRMEXFI",77,0)
 ;
"RTN","PXRMEXFI",78,0)
 ;Health Summary Type allowed in certain cases.
"RTN","PXRMEXFI",79,0)
 I FILENUM=142 Q 1
"RTN","PXRMEXFI",80,0)
 ;
"RTN","PXRMEXFI",81,0)
 ;Health Summary Components allowed in certain cases.
"RTN","PXRMEXFI",82,0)
 I FILENUM=142.1 Q 1
"RTN","PXRMEXFI",83,0)
 ;
"RTN","PXRMEXFI",84,0)
 ;Health Summary Object allowed in certain cases.
"RTN","PXRMEXFI",85,0)
 I FILENUM=142.5 Q 1
"RTN","PXRMEXFI",86,0)
 ;
"RTN","PXRMEXFI",87,0)
 ;Mental Health Instruments not allowed.
"RTN","PXRMEXFI",88,0)
 I FILENUM=601 Q 0
"RTN","PXRMEXFI",89,0)
 I FILENUM=601.71 Q 0
"RTN","PXRMEXFI",90,0)
 ;
"RTN","PXRMEXFI",91,0)
 ;WV Notification Purpose not allowed.
"RTN","PXRMEXFI",92,0)
 I FILENUM=790.404 Q 0
"RTN","PXRMEXFI",93,0)
 ;
"RTN","PXRMEXFI",94,0)
 ;TIU Document Definition allowed in certain cases.
"RTN","PXRMEXFI",95,0)
 I FILENUM=8925.1 Q 1
"RTN","PXRMEXFI",96,0)
 ;
"RTN","PXRMEXFI",97,0)
 ;If control gets to here then it is an allowed file type.
"RTN","PXRMEXFI",98,0)
 Q 1
"RTN","PXRMEXFI",99,0)
 ;
"RTN","PXRMEXFI",100,0)
 ;==============================================
"RTN","PXRMEXFI",101,0)
GETFACT(PT01,ATTR,NEWPT01,NAMECHG,IEN) ;Get the action for a file.
"RTN","PXRMEXFI",102,0)
 N ACTION,CHOICES,CSUM,DIR,FILENUM,MSG,RESULT
"RTN","PXRMEXFI",103,0)
 N SAME,X,Y
"RTN","PXRMEXFI",104,0)
 ;See if this entry is already defined.
"RTN","PXRMEXFI",105,0)
CHK ;
"RTN","PXRMEXFI",106,0)
 S NEWPT01=""
"RTN","PXRMEXFI",107,0)
 S FILENUM=ATTR("FILE NUMBER")
"RTN","PXRMEXFI",108,0)
 I IEN="" S IEN=$$EXISTS^PXRMEXIU(FILENUM,PT01)
"RTN","PXRMEXFI",109,0)
 I IEN D
"RTN","PXRMEXFI",110,0)
 .;If the entry already exists compare the existing entry checksum
"RTN","PXRMEXFI",111,0)
 .;with the packed entry checksum.
"RTN","PXRMEXFI",112,0)
 . S CSUM=$$FILE^PXRMEXCS(ATTR("FILE NUMBER"),IEN)
"RTN","PXRMEXFI",113,0)
 . S SAME=$S(ATTR("CHECKSUM")=CSUM:1,1:0)
"RTN","PXRMEXFI",114,0)
 . D FEIMSG(SAME,.ATTR)
"RTN","PXRMEXFI",115,0)
 . I SAME S ACTION="S"
"RTN","PXRMEXFI",116,0)
 . I 'SAME D
"RTN","PXRMEXFI",117,0)
 .. S CHOICES=$S(FILENUM=801.41:"CMOUQS",FILENUM=811.5:"CMOUQS",1:"COUQS")
"RTN","PXRMEXFI",118,0)
 .. S DIR("B")="O"
"RTN","PXRMEXFI",119,0)
 .. S ACTION=$$GETACT^PXRMEXIU(CHOICES,.DIR)
"RTN","PXRMEXFI",120,0)
 E  D
"RTN","PXRMEXFI",121,0)
 . W !!,ATTR("FILE NAME")," entry ",PT01," is NEW,"
"RTN","PXRMEXFI",122,0)
 . W !,"what do you want to do?"
"RTN","PXRMEXFI",123,0)
 . S CHOICES="CIQS"
"RTN","PXRMEXFI",124,0)
 . S DIR("B")="I"
"RTN","PXRMEXFI",125,0)
 . S ACTION=$$GETACT^PXRMEXIU(CHOICES,.DIR)
"RTN","PXRMEXFI",126,0)
 ;
"RTN","PXRMEXFI",127,0)
 I ACTION="Q" Q ACTION
"RTN","PXRMEXFI",128,0)
 I ACTION="C" D
"RTN","PXRMEXFI",129,0)
 . S NEWPT01=$$GETUNAME^PXRMEXIU(.ATTR)
"RTN","PXRMEXFI",130,0)
 .;Make sure the NEW .01 passes any input transforms.
"RTN","PXRMEXFI",131,0)
 . I NEWPT01="" S ACTION="S"
"RTN","PXRMEXFI",132,0)
 . E  D CHK^DIE(ATTR("FILE NUMBER"),.01,"",NEWPT01,.RESULT,"MSG")
"RTN","PXRMEXFI",133,0)
 I $G(RESULT)="^" D  G CHK
"RTN","PXRMEXFI",134,0)
 . D AWRITE^PXRMUTIL("MSG")
"RTN","PXRMEXFI",135,0)
 . K RESULT
"RTN","PXRMEXFI",136,0)
 ;
"RTN","PXRMEXFI",137,0)
 I ACTION="O" D
"RTN","PXRMEXFI",138,0)
 .;If the action is overwrite double check that is what the user
"RTN","PXRMEXFI",139,0)
 .;really wants to do.
"RTN","PXRMEXFI",140,0)
 . N DIROUT,DIRUT,DTOUT,DUOUT
"RTN","PXRMEXFI",141,0)
 . K DIR
"RTN","PXRMEXFI",142,0)
 . S DIR(0)="Y"_U_"A"
"RTN","PXRMEXFI",143,0)
 . S DIR("A")="Are you sure you want to overwrite"
"RTN","PXRMEXFI",144,0)
 . S DIR("B")="N"
"RTN","PXRMEXFI",145,0)
 . D ^DIR
"RTN","PXRMEXFI",146,0)
 . I $D(DIROUT)!$D(DIRUT) S Y=0
"RTN","PXRMEXFI",147,0)
 . I $D(DTOUT)!$D(DUOUT) S Y=0
"RTN","PXRMEXFI",148,0)
 . S ACTION=$S(Y:"O",1:"S")
"RTN","PXRMEXFI",149,0)
 ;
"RTN","PXRMEXFI",150,0)
 I ACTION="P" D
"RTN","PXRMEXFI",151,0)
 . N DIC,Y
"RTN","PXRMEXFI",152,0)
 . S DIC=ATTR("FILE NUMBER")
"RTN","PXRMEXFI",153,0)
 . S DIC(0)="AEMQ"
"RTN","PXRMEXFI",154,0)
 . D ^DIC
"RTN","PXRMEXFI",155,0)
 . I Y=-1 S ACTION="S"
"RTN","PXRMEXFI",156,0)
 . E  S NEWPT01=$P(Y,U,2)
"RTN","PXRMEXFI",157,0)
 ;
"RTN","PXRMEXFI",158,0)
 I NEWPT01'="" S NAMECHG(ATTR("FILE NUMBER"),PT01)=NEWPT01
"RTN","PXRMEXFI",159,0)
 Q ACTION
"RTN","PXRMEXFI",160,0)
 ;
"RTN","PXRMEXFI",161,0)
 ;==============================================
"RTN","PXRMEXFI",162,0)
IOKTI(FILENUM,ITEMINFO) ;Check if it is ok to install this item.
"RTN","PXRMEXFI",163,0)
 ;To be installable, items from 801.41 need to be marked as selectable.
"RTN","PXRMEXFI",164,0)
 I FILENUM=801.41 Q $P(ITEMINFO,U,7)
"RTN","PXRMEXFI",165,0)
 N FDASTART,FDAEND
"RTN","PXRMEXFI",166,0)
 S FDASTART=$P(ITEMINFO,U,2)
"RTN","PXRMEXFI",167,0)
 S FDAEND=$P(ITEMINFO,U,3)
"RTN","PXRMEXFI",168,0)
 ;If FDSTART=FDAEND then only the .01 was packed so it may not
"RTN","PXRMEXFI",169,0)
 ;be installable.
"RTN","PXRMEXFI",170,0)
 I FDASTART=FDAEND Q $$IOKTP(FILENUM)
"RTN","PXRMEXFI",171,0)
 Q 1
"RTN","PXRMEXFI",172,0)
 ;
"RTN","PXRMEXFI",173,0)
 ;==============================================
"RTN","PXRMEXFI",174,0)
IOKTP(FILENUM,IEN) ;Check if it is ok to pack this item.
"RTN","PXRMEXFI",175,0)
 ;If the entire file is not transportable we are done
"RTN","PXRMEXFI",176,0)
 I '$$FOKTT(FILENUM) Q 0
"RTN","PXRMEXFI",177,0)
 N OK
"RTN","PXRMEXFI",178,0)
 S OK=1
"RTN","PXRMEXFI",179,0)
 ;Check files where only specific entries can be packed.
"RTN","PXRMEXFI",180,0)
 ;Health Summary Object not allowed if the type is not allowed
"RTN","PXRMEXFI",181,0)
 I FILENUM=142.5 D  Q OK
"RTN","PXRMEXFI",182,0)
 . I '$D(IEN)!($G(IEN)="") S OK=0 Q
"RTN","PXRMEXFI",183,0)
 . N HSTIEN
"RTN","PXRMEXFI",184,0)
 . S HSTIEN=$P($G(^GMT(142.5,IEN,0)),U,3) I HSTIEN'>0 S OK=0 Q
"RTN","PXRMEXFI",185,0)
 . S OK=$$IOKTP(142,HSTIEN)
"RTN","PXRMEXFI",186,0)
 .;DBIA #5445
"RTN","PXRMEXFI",187,0)
 . I OK=0 D EN^GMTSDESC(IEN,142.5,"HS OBJECT")
"RTN","PXRMEXFI",188,0)
 ;
"RTN","PXRMEXFI",189,0)
 ;Health Summary Type not allowed if it contains local components
"RTN","PXRMEXFI",190,0)
 ;or PROGRESS NOTE SELECTED component
"RTN","PXRMEXFI",191,0)
 I FILENUM=142 D  Q OK
"RTN","PXRMEXFI",192,0)
 . I +$G(IEN)=0 S OK=0 Q
"RTN","PXRMEXFI",193,0)
 . N IND,PGSIEN
"RTN","PXRMEXFI",194,0)
 . S PGSIEN=$O(^GMT(142.1,"B","PROGRESS NOTES SELECTED",""))
"RTN","PXRMEXFI",195,0)
 . S IND=0,OK=1
"RTN","PXRMEXFI",196,0)
 . ;Scan HS Type for components, do not pack if it contains local
"RTN","PXRMEXFI",197,0)
 . ;components or selected Progress Note Component.
"RTN","PXRMEXFI",198,0)
 . F  S IND=$O(^GMT(142,IEN,1,IND)) Q:('OK)!(IND="")  D
"RTN","PXRMEXFI",199,0)
 .. I $P($G(^GMT(142,IEN,1,IND,0)),U,2)>99999 S OK=0 Q
"RTN","PXRMEXFI",200,0)
 .. I $P($G(^GMT(142,IEN,1,IND,0)),U,2)=PGSIEN S OK=0 Q
"RTN","PXRMEXFI",201,0)
 .;DBIA #5445
"RTN","PXRMEXFI",202,0)
 . I OK=0 D EN^GMTSDESC(IEN,142,"HS TYPE")
"RTN","PXRMEXFI",203,0)
 ;
"RTN","PXRMEXFI",204,0)
 ;Health Summary Components not allowed. National components do not
"RTN","PXRMEXFI",205,0)
 ;need to be packed, they already exist.
"RTN","PXRMEXFI",206,0)
 I FILENUM=142.1 D  Q OK
"RTN","PXRMEXFI",207,0)
 .;Only use to pack new national components being released
"RTN","PXRMEXFI",208,0)
 .;with the patch.
"RTN","PXRMEXFI",209,0)
 . I '$G(PXRMINST) S OK=0
"RTN","PXRMEXFI",210,0)
 .;DBIA #5445
"RTN","PXRMEXFI",211,0)
 .;Create description of local HS Components
"RTN","PXRMEXFI",212,0)
 . I +$G(IEN)>99999 D EN^GMTSDESC(IEN,142.1,"HS COMP")
"RTN","PXRMEXFI",213,0)
 ;
"RTN","PXRMEXFI",214,0)
 ;TIU Document Definition, allowed only if it is a health summary object.
"RTN","PXRMEXFI",215,0)
 I FILENUM=8925.1 D  Q OK
"RTN","PXRMEXFI",216,0)
 . N ARY,HSOIEN
"RTN","PXRMEXFI",217,0)
 . I '$D(IEN)!($G(IEN)="") S OK=0 Q
"RTN","PXRMEXFI",218,0)
 .;DBIA #5447
"RTN","PXRMEXFI",219,0)
 . D OBJBYIEN^TIUCHECK(.ARY,IEN)
"RTN","PXRMEXFI",220,0)
 . ;
"RTN","PXRMEXFI",221,0)
 . ;If not TIU object and INST is set, assume this is called from a
"RTN","PXRMEXFI",222,0)
 . ;national patch installing TIU Title and Document Class.
"RTN","PXRMEXFI",223,0)
 . I ARY(IEN,.04)'="O",PXRMINST=1 S OK=1 Q
"RTN","PXRMEXFI",224,0)
 . ;
"RTN","PXRMEXFI",225,0)
 . ;Only allow TIU/HS Object to be installed.
"RTN","PXRMEXFI",226,0)
 . I $G(ARY(IEN,9))'["S X=$$TIU^GMTSOBJ(" S OK=0 Q
"RTN","PXRMEXFI",227,0)
 . S HSOIEN=+$P(ARY(IEN,9),",",2)
"RTN","PXRMEXFI",228,0)
 . I HSOIEN'>0 S OK=0 Q
"RTN","PXRMEXFI",229,0)
 . S OK=$$IOKTP(142.5,HSOIEN)
"RTN","PXRMEXFI",230,0)
 . I OK=0 D TIU^PXRMEXU5(IEN,.ARY,"TIU OBJECT")
"RTN","PXRMEXFI",231,0)
 ;
"RTN","PXRMEXFI",232,0)
 Q OK
"RTN","PXRMEXFI",233,0)
 ;
"RTN","PXRMEXFI",234,0)
 ;==============================================
"RTN","PXRMEXFI",235,0)
NTHLOC(IEN,SUB) ;Save information about non-transportable hospital locations.
"RTN","PXRMEXFI",236,0)
 N HLOC,IND,NL
"RTN","PXRMEXFI",237,0)
 S NL=1,^TMP($J,SUB,IEN,NL)="Location List: "_$P(^PXRMD(810.9,IEN,0),U,1)
"RTN","PXRMEXFI",238,0)
 S IND=0
"RTN","PXRMEXFI",239,0)
 F  S IND=+$O(^PXRMD(810.9,IEN,44,IND)) Q:IND=0  D
"RTN","PXRMEXFI",240,0)
 . S NL=NL+1
"RTN","PXRMEXFI",241,0)
 .;DBIA #10040
"RTN","PXRMEXFI",242,0)
 . S HLOC=^PXRMD(810.9,IEN,44,IND,0),HLOC=$P(^SC(HLOC,0),U,1)
"RTN","PXRMEXFI",243,0)
 . S ^TMP($J,SUB,IEN,NL)="  "_HLOC
"RTN","PXRMEXFI",244,0)
 Q
"RTN","PXRMEXFI",245,0)
 ;
"RTN","PXRMEXFI",246,0)
 ;==============================================
"RTN","PXRMEXFI",247,0)
SETATTR(ATTR,FILE,PT01) ;Set the file attributes for the file FILE.
"RTN","PXRMEXFI",248,0)
 N MSG
"RTN","PXRMEXFI",249,0)
 S ATTR("FILE NUMBER")=FILE
"RTN","PXRMEXFI",250,0)
 S ATTR("FILE NAME")=$$GET1^DID(FILE,"","","NAME","","MSG")
"RTN","PXRMEXFI",251,0)
 ;This call gets the field length.
"RTN","PXRMEXFI",252,0)
 D FIELD^DID(FILE,.01,"","FIELD LENGTH","ATTR","MSG")
"RTN","PXRMEXFI",253,0)
 S ATTR("MIN FIELD LENGTH")=3
"RTN","PXRMEXFI",254,0)
 S (ATTR("NAME"),ATTR("PT01"))=PT01
"RTN","PXRMEXFI",255,0)
 Q
"RTN","PXRMEXFI",256,0)
 ;
"RTN","PXRMEXIC")
0^21^B80167234
"RTN","PXRMEXIC",1,0)
PXRMEXIC ;SLC/PKR/PJH - Routines to install repository entry components. ;09/07/2012
"RTN","PXRMEXIC",2,0)
 ;;2.0;CLINICAL REMINDERS;**6,12,17,16,18,22,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXIC",3,0)
 ;=================================================
"RTN","PXRMEXIC",4,0)
FILE(PXRMRIEN,SITEIEN,IND120,JND120,ACTION,ATTR,NAMECHG) ;Read and process a
"RTN","PXRMEXIC",5,0)
 ;file entry in repository entry PXRMRIEN. IND120 and JND120 are the
"RTN","PXRMEXIC",6,0)
 ;indexes for the component list. ACTION is one of the possible actions.
"RTN","PXRMEXIC",7,0)
 I ACTION="S" Q
"RTN","PXRMEXIC",8,0)
 N DATA,DUZ0S,EDULIST,FDA,FDAEND,FDASTART,FIELD,FILENUM
"RTN","PXRMEXIC",9,0)
 N IEN,IENS,IENREND,IENROOT,IENRSTR,IENUSED,IND,INDICES
"RTN","PXRMEXIC",10,0)
 N LINE,MSG,NAME,NEW01,PXNAT,PXRMEDOK,PXRMEXCH
"RTN","PXRMEXIC",11,0)
 N SRCIEN,START,TEMP,TEXT,TFDA,TIENROOT,TIUFPRIV,TNAME,TOPFNUM,VERSN,XUMF
"RTN","PXRMEXIC",12,0)
 N WPLCNT,WPTMP
"RTN","PXRMEXIC",13,0)
 ;I $G(PXRMIGDS) S DUZ0S=DUZ(0),DUZ(0)="^",XUMF=1
"RTN","PXRMEXIC",14,0)
 ;Set PXRMEDOK so files pointing to sponsors can be installed.
"RTN","PXRMEXIC",15,0)
 ;Set PXRMEXCH so national entries can be installed and prevent
"RTN","PXRMEXIC",16,0)
 ;execution of the input transform for custom logic fields.
"RTN","PXRMEXIC",17,0)
 ;Set PXNAT to allow installation of national (those starting with VA-)
"RTN","PXRMEXIC",18,0)
 ;PCE items.
"RTN","PXRMEXIC",19,0)
 S (PXNAT,PXRMEDOK,PXRMEXCH)=1
"RTN","PXRMEXIC",20,0)
 S TEMP=^PXD(811.8,PXRMRIEN,120,IND120,1,JND120,0)
"RTN","PXRMEXIC",21,0)
 S FDASTART=+$P(TEMP,U,2)
"RTN","PXRMEXIC",22,0)
 S FDAEND=+$P(TEMP,U,3)
"RTN","PXRMEXIC",23,0)
 S IENRSTR=+$P(TEMP,U,4)
"RTN","PXRMEXIC",24,0)
 S IENREND=+$P(TEMP,U,5)
"RTN","PXRMEXIC",25,0)
 F IND=FDASTART:1:FDAEND D
"RTN","PXRMEXIC",26,0)
 . S LINE=^PXD(811.8,PXRMRIEN,100,IND,0)
"RTN","PXRMEXIC",27,0)
 . S INDICES=$P(LINE,"~",1)
"RTN","PXRMEXIC",28,0)
 . S DATA=$P(LINE,"~",2)
"RTN","PXRMEXIC",29,0)
 . S FILENUM=$P(INDICES,";",1)
"RTN","PXRMEXIC",30,0)
 . S IENS=$P(INDICES,";",2)
"RTN","PXRMEXIC",31,0)
 . I IND=FDASTART S SRCIEN=+IENS
"RTN","PXRMEXIC",32,0)
 . S FIELD=$P(INDICES,";",3)
"RTN","PXRMEXIC",33,0)
 . I LINE["WP-start" D
"RTN","PXRMEXIC",34,0)
 .. S DATA="WPTMP("_IND_","_+FIELD_")"
"RTN","PXRMEXIC",35,0)
 .. S WPLCNT=$P(LINE,"~",3)
"RTN","PXRMEXIC",36,0)
 .. D WORDPROC(PXRMRIEN,.WPTMP,IND,+FIELD,.IND,WPLCNT)
"RTN","PXRMEXIC",37,0)
 . I (IND=FDASTART)&((FIELD=.01)!(FIELD=.001)) D
"RTN","PXRMEXIC",38,0)
 ..;Save the top level file number.
"RTN","PXRMEXIC",39,0)
 .. S TOPFNUM=FILENUM
"RTN","PXRMEXIC",40,0)
 ..;If the action is copy put it in the first open spot. PCE files go
"RTN","PXRMEXIC",41,0)
 ..;in the site number space.
"RTN","PXRMEXIC",42,0)
 .. I ACTION="C" D
"RTN","PXRMEXIC",43,0)
 ... S START=$S($$ISPCEFIL^PXRMEXU0(TOPFNUM):$P($$SITE^VASITE,U,3)_"000",1:0)
"RTN","PXRMEXIC",44,0)
 ... S IENROOT(SRCIEN)=$$LOIEN^PXRMEXU5(TOPFNUM,START)
"RTN","PXRMEXIC",45,0)
 ..;
"RTN","PXRMEXIC",46,0)
 ..;If the entry does not exist and the action is not copy set the
"RTN","PXRMEXIC",47,0)
 ..;action to install.
"RTN","PXRMEXIC",48,0)
 .. I SITEIEN=0 S ACTION="I"
"RTN","PXRMEXIC",49,0)
 ..;
"RTN","PXRMEXIC",50,0)
 ..;If the action is install try to install at the source ien. If
"RTN","PXRMEXIC",51,0)
 ..;an entry already exists at the source ien put it in the first
"RTN","PXRMEXIC",52,0)
 ..;open spot. For PCE entries install at source ien unless they
"RTN","PXRMEXIC",53,0)
 ..;are national.
"RTN","PXRMEXIC",54,0)
 .. I ACTION="I" D
"RTN","PXRMEXIC",55,0)
 ... S IENUSED=+$$FIND1^DIC(FILENUM,"","Q","`"_SRCIEN)
"RTN","PXRMEXIC",56,0)
 ... S IENROOT(SRCIEN)=$S(IENUSED=0:SRCIEN,1:$$LOIEN^PXRMEXU5(FILENUM))
"RTN","PXRMEXIC",57,0)
 ... I $$ISPCEFIL^PXRMEXU0(TOPFNUM) D
"RTN","PXRMEXIC",58,0)
 .... I IENUSED=0 S IENROOT(SRCIEN)=SRCIEN
"RTN","PXRMEXIC",59,0)
 .... I IENUSED>0 D
"RTN","PXRMEXIC",60,0)
 ..... S START=$S(IENUSED>100000:$E(IENUSED,1,3)_"000",1:0)
"RTN","PXRMEXIC",61,0)
 ..... S IENROOT(SRCIEN)=$$LOIEN^PXRMEXU5(TOPFNUM,START)
"RTN","PXRMEXIC",62,0)
 .... I $G(PXRMMNAT) S IENROOT(SRCIEN)=$$LOIEN^PXRMEXU5(TOPFNUM)
"RTN","PXRMEXIC",63,0)
 ..;
"RTN","PXRMEXIC",64,0)
 ..;If the action is merge, overwrite,or update install at the site's
"RTN","PXRMEXIC",65,0)
 ..;ien.
"RTN","PXRMEXIC",66,0)
 .. I (ACTION="M")!(ACTION="O")!(ACTION="U") S IENROOT(SRCIEN)=SITEIEN
"RTN","PXRMEXIC",67,0)
 .;
"RTN","PXRMEXIC",68,0)
 .;This line is use to convert pre-patch 12 disable text to the new
"RTN","PXRMEXIC",69,0)
 .;value of 1 for disable
"RTN","PXRMEXIC",70,0)
 . I FILENUM=801.41,FIELD=3,DATA'="",$L(DATA)>2 D
"RTN","PXRMEXIC",71,0)
 ..I DATA="DISABLE AND DO NOT SEND MESSAGE" Q
"RTN","PXRMEXIC",72,0)
 ..S DATA="DISABLE AND SEND MESSAGE"
"RTN","PXRMEXIC",73,0)
 .;
"RTN","PXRMEXIC",74,0)
 . S FDA(FILENUM,IENS,FIELD)=DATA
"RTN","PXRMEXIC",75,0)
 ;
"RTN","PXRMEXIC",76,0)
 ;Initialize the edit history.
"RTN","PXRMEXIC",77,0)
 D INIEH(TOPFNUM,IENS,.FDA,.WPTMP)
"RTN","PXRMEXIC",78,0)
 ;Build the IENROOT
"RTN","PXRMEXIC",79,0)
 F IND=IENRSTR:1:IENREND D
"RTN","PXRMEXIC",80,0)
 . I IND=0 Q
"RTN","PXRMEXIC",81,0)
 . S TEMP=^PXD(811.8,PXRMRIEN,100,IND,0)
"RTN","PXRMEXIC",82,0)
 . S IENROOT($P(TEMP,U,1))=$P(TEMP,U,2)
"RTN","PXRMEXIC",83,0)
 ;Check for name changes, i.e., the copy action.
"RTN","PXRMEXIC",84,0)
 D NAMECHG(.FDA,.NAMECHG,TOPFNUM)
"RTN","PXRMEXIC",85,0)
 ;
"RTN","PXRMEXIC",86,0)
 ;Special handling for file 142.
"RTN","PXRMEXIC",87,0)
 I TOPFNUM=142 D  Q:'$D(FDA)
"RTN","PXRMEXIC",88,0)
 . D SFMVPI^PXRMEXIU(.FDA,.NAMECHG,142.14)
"RTN","PXRMEXIC",89,0)
 ;
"RTN","PXRMEXIC",90,0)
 ;Special handling for file 801
"RTN","PXRMEXIC",91,0)
 I TOPFNUM=801 D  Q:PXRMDONE
"RTN","PXRMEXIC",92,0)
 . D SFMVPI^PXRMEXIU(.FDA,.NAMECHG,801.015)
"RTN","PXRMEXIC",93,0)
 . D ROC^PXRMEXU5(.FDA)
"RTN","PXRMEXIC",94,0)
 ;
"RTN","PXRMEXIC",95,0)
 ;Special handling for file 801.1
"RTN","PXRMEXIC",96,0)
 I TOPFNUM=801.1 D  Q:PXRMDONE
"RTN","PXRMEXIC",97,0)
 . D ROCR^PXRMEXU5(.FDA)
"RTN","PXRMEXIC",98,0)
 ;
"RTN","PXRMEXIC",99,0)
 ;Special handling for file 801.41
"RTN","PXRMEXIC",100,0)
 I TOPFNUM=801.41 D  Q:PXRMDONE
"RTN","PXRMEXIC",101,0)
 . I ACTION="M" D MOU^PXRMEXU5(801.41,SITEIEN,"18*",.FDA,.IENROOT,ACTION,.WPTMP)
"RTN","PXRMEXIC",102,0)
 . D DLG^PXRMEXU4(.FDA,.NAMECHG)
"RTN","PXRMEXIC",103,0)
 ;
"RTN","PXRMEXIC",104,0)
 ;Special handling for file 810.9
"RTN","PXRMEXIC",105,0)
 I TOPFNUM=810.9 D LOC^PXRMEXU0(.FDA)
"RTN","PXRMEXIC",106,0)
 ;
"RTN","PXRMEXIC",107,0)
 ;If the file number is 811.4 the user must have programmer
"RTN","PXRMEXIC",108,0)
 ;access to install it.
"RTN","PXRMEXIC",109,0)
 I (TOPFNUM=811.4)&(DUZ(0)'="@") D  Q
"RTN","PXRMEXIC",110,0)
 . W !,"Only programmers can install Reminder Computed Findings."
"RTN","PXRMEXIC",111,0)
 ;
"RTN","PXRMEXIC",112,0)
 ;Special handling for file 811.5.
"RTN","PXRMEXIC",113,0)
 I TOPFNUM=811.5 D  Q:'$D(FDA)
"RTN","PXRMEXIC",114,0)
 .;If the site has any findings already mapped merge them in.
"RTN","PXRMEXIC",115,0)
 . I (ACTION="M")!(ACTION="U") D MOU^PXRMEXU5(811.5,SITEIEN,"20*",.FDA,.IENROOT,ACTION,.WPTMP)
"RTN","PXRMEXIC",116,0)
 . D SFMVPI^PXRMEXIU(.FDA,.NAMECHG,811.52)
"RTN","PXRMEXIC",117,0)
 ;
"RTN","PXRMEXIC",118,0)
 ;Special handling for file 811.9.
"RTN","PXRMEXIC",119,0)
 I TOPFNUM=811.9 D
"RTN","PXRMEXIC",120,0)
 .;Don't execute the input transform for custom logic fields.
"RTN","PXRMEXIC",121,0)
 . S PXRMEXCH=1
"RTN","PXRMEXIC",122,0)
 . D DEF^PXRMEXIU(.FDA,.NAMECHG)
"RTN","PXRMEXIC",123,0)
 ;
"RTN","PXRMEXIC",124,0)
 ;Special handling for file 9999999.09, EDUCATION TOPICS.
"RTN","PXRMEXIC",125,0)
 I TOPFNUM=9999999.09 D
"RTN","PXRMEXIC",126,0)
 . S IENS=$O(FDA(TOPFNUM,""))
"RTN","PXRMEXIC",127,0)
 . S EDULIST(FDA(TOPFNUM,IENS,.01))=""
"RTN","PXRMEXIC",128,0)
 ;
"RTN","PXRMEXIC",129,0)
 ;Special handling for file 8925.1
"RTN","PXRMEXIC",130,0)
 I TOPFNUM=8925.1 D
"RTN","PXRMEXIC",131,0)
 . S TIUFPRIV=1
"RTN","PXRMEXIC",132,0)
 . D TIUOBJ^PXRMEXIU(.FDA)
"RTN","PXRMEXIC",133,0)
 ;
"RTN","PXRMEXIC",134,0)
 ;Special handling for file 9999999.64.
"RTN","PXRMEXIC",135,0)
 I TOPFNUM=9999999.64 D
"RTN","PXRMEXIC",136,0)
 . D HF^PXRMEXIU(.FDA,.NAMECHG)
"RTN","PXRMEXIC",137,0)
 ;
"RTN","PXRMEXIC",138,0)
 ;If FDA is not defined at this point the user has opted to abort
"RTN","PXRMEXIC",139,0)
 ;the install.
"RTN","PXRMEXIC",140,0)
 I '$D(FDA) Q
"RTN","PXRMEXIC",141,0)
 ;
"RTN","PXRMEXIC",142,0)
 ;If the action is merge, overwrite, or update do a test install
"RTN","PXRMEXIC",143,0)
 ;before deleting the original entry.
"RTN","PXRMEXIC",144,0)
 I (ACTION="M")!(ACTION="O")!(ACTION="U") D
"RTN","PXRMEXIC",145,0)
 .;Make the .01 unique for the test install.
"RTN","PXRMEXIC",146,0)
 . S IENS=$O(FDA(TOPFNUM,""))
"RTN","PXRMEXIC",147,0)
 .;Get the length of the .01 field
"RTN","PXRMEXIC",148,0)
 . D FIELD^DID(TOPFNUM,.01,"","FIELD LENGTH","ATTR")
"RTN","PXRMEXIC",149,0)
 . S TNAME="tmp"_$E(FDA(TOPFNUM,IENS,.01),1,ATTR("FIELD LENGTH")-3)
"RTN","PXRMEXIC",150,0)
 .;Make sure the test entry does not already exist.
"RTN","PXRMEXIC",151,0)
 . D DELALL^PXRMEXFI(TOPFNUM,TNAME)
"RTN","PXRMEXIC",152,0)
 . M TFDA=FDA
"RTN","PXRMEXIC",153,0)
 . S TFDA(TOPFNUM,IENS,.01)=TNAME
"RTN","PXRMEXIC",154,0)
 . K TIENROOT M TIENROOT=IENROOT
"RTN","PXRMEXIC",155,0)
 . S TIENROOT(SRCIEN)=$$LOIEN^PXRMEXU5(TOPFNUM)
"RTN","PXRMEXIC",156,0)
 . D UPDATE^DIE("E","TFDA","TIENROOT","MSG")
"RTN","PXRMEXIC",157,0)
 . I $D(MSG) D  Q
"RTN","PXRMEXIC",158,0)
 .. S TEXT(1)=ATTR("FILE NAME")_" entry "_$G(ATTR("PT01"))_" did not get installed!"
"RTN","PXRMEXIC",159,0)
 .. S TEXT(2)="Examine the following error message for the reason."
"RTN","PXRMEXIC",160,0)
 .. S TEXT(3)=""
"RTN","PXRMEXIC",161,0)
 .. S TEXT(4)="The test update failed, UPDATE^DIE returned the following error message:"
"RTN","PXRMEXIC",162,0)
 .. D MES^XPDUTL(.TEXT)
"RTN","PXRMEXIC",163,0)
 .. D AWRITE^PXRMUTIL("MSG")
"RTN","PXRMEXIC",164,0)
 .. H 2
"RTN","PXRMEXIC",165,0)
 .;Delete the test entry.
"RTN","PXRMEXIC",166,0)
 . D DELALL^PXRMEXFI(TOPFNUM,TNAME)
"RTN","PXRMEXIC",167,0)
 .;If the original update worked put the entry at its original ien.
"RTN","PXRMEXIC",168,0)
 .;Delete the existing entry.
"RTN","PXRMEXIC",169,0)
 . D DELETE^PXRMEXFI(TOPFNUM,SITEIEN)
"RTN","PXRMEXIC",170,0)
 D UPDATE^DIE("E","FDA","IENROOT","MSG")
"RTN","PXRMEXIC",171,0)
 I $D(MSG) D
"RTN","PXRMEXIC",172,0)
 . S TEXT(1)=ATTR("FILE NAME")_" entry "_$G(ATTR("PT01"))_" did not get installed!"
"RTN","PXRMEXIC",173,0)
 . S TEXT(2)="Examine the following error message for the reason."
"RTN","PXRMEXIC",174,0)
 . S TEXT(3)=""
"RTN","PXRMEXIC",175,0)
 . S TEXT(4)="The update failed, UPDATE^DIE returned the following error message:"
"RTN","PXRMEXIC",176,0)
 . D MES^XPDUTL(.TEXT)
"RTN","PXRMEXIC",177,0)
 . D AWRITE^PXRMUTIL("MSG")
"RTN","PXRMEXIC",178,0)
 . W !
"RTN","PXRMEXIC",179,0)
 . H 2
"RTN","PXRMEXIC",180,0)
 S VERSN=$$GETTAGV^PXRMEXU3(^PXD(811.8,PXRMRIEN,100,3,0),"<PACKAGE_VERSION>")
"RTN","PXRMEXIC",181,0)
 I TOPFNUM=811.2 D
"RTN","PXRMEXIC",182,0)
 .;Rebuild taxonomy expansions.
"RTN","PXRMEXIC",183,0)
 . N IEN,PXRMEXCH
"RTN","PXRMEXIC",184,0)
 . S IEN=+$O(^PXD(811.2,"B",ATTR("PT01"),""))
"RTN","PXRMEXIC",185,0)
 . I IEN>0 D EXPAND^PXRMBXTL(IEN,"")
"RTN","PXRMEXIC",186,0)
 I TOPFNUM=811.9,VERSN=1.5 D
"RTN","PXRMEXIC",187,0)
 . N IEN,PXRMEXCH,X
"RTN","PXRMEXIC",188,0)
 . S IEN=+$O(^PXD(811.9,"B",ATTR("PT01"),""))
"RTN","PXRMEXIC",189,0)
 . I IEN=0 Q
"RTN","PXRMEXIC",190,0)
 .;For reminder definitions build the found/not found text counts.
"RTN","PXRMEXIC",191,0)
 . D SFNFTC^PXRMEXU0(IEN)
"RTN","PXRMEXIC",192,0)
 .;Build the internal logic and finding strings.
"RTN","PXRMEXIC",193,0)
 . S X=$G(^PXD(811.9,IEN,30))
"RTN","PXRMEXIC",194,0)
 . I X'="" D CPPCLS^PXRMLOGX(IEN,X)
"RTN","PXRMEXIC",195,0)
 . S X=$G(^PXD(811.9,IEN,34))
"RTN","PXRMEXIC",196,0)
 . I X'="" D CPRESLS^PXRMLOGX(IEN,X)
"RTN","PXRMEXIC",197,0)
 . D BLDALL^PXRMLOGX(IEN,"","")
"RTN","PXRMEXIC",198,0)
 ;If there are national education topics rename them so they start
"RTN","PXRMEXIC",199,0)
 ;with VA-
"RTN","PXRMEXIC",200,0)
 I $D(EDULIST),$G(PXRMMNAT) D
"RTN","PXRMEXIC",201,0)
 .;Get the length of the .01 field
"RTN","PXRMEXIC",202,0)
 . D FIELD^DID(TOPFNUM,.01,"","FIELD LENGTH","ATTR")
"RTN","PXRMEXIC",203,0)
 . S NAME=""
"RTN","PXRMEXIC",204,0)
 . F  S NAME=$O(EDULIST(NAME)) Q:NAME=""  D
"RTN","PXRMEXIC",205,0)
 .. I $E(NAME,1,3)="VA-" Q
"RTN","PXRMEXIC",206,0)
 .. S TNAME="VA-"_$E(ATTR("FIELD LENGTH")-3)
"RTN","PXRMEXIC",207,0)
 .. D RENAME^PXRMUTIL(TOPFNUM,NAME,TNAME)
"RTN","PXRMEXIC",208,0)
 ;I $G(PXRMIGDS) S DUZ(0)=DUZ0S
"RTN","PXRMEXIC",209,0)
 Q
"RTN","PXRMEXIC",210,0)
 ;
"RTN","PXRMEXIC",211,0)
 ;=================================================
"RTN","PXRMEXIC",212,0)
INIEH(FILENUM,IENS,FDA,WPTMP) ;If the file is a clinical reminder file and
"RTN","PXRMEXIC",213,0)
 ;it has an edit history initialize the history.
"RTN","PXRMEXIC",214,0)
 I (FILENUM<800)!(FILENUM>811.9) Q
"RTN","PXRMEXIC",215,0)
 N IENS,SFN,TARGET,WP
"RTN","PXRMEXIC",216,0)
 D FIELD^DID(FILENUM,"EDIT HISTORY","","SPECIFIER","TARGET")
"RTN","PXRMEXIC",217,0)
 S SFN=+$G(TARGET("SPECIFIER"))
"RTN","PXRMEXIC",218,0)
 I SFN=0 Q
"RTN","PXRMEXIC",219,0)
 S IENS=$O(FDA(SFN,""))
"RTN","PXRMEXIC",220,0)
 I IENS="" Q
"RTN","PXRMEXIC",221,0)
 S FDA(SFN,IENS,.01)=$$FMTE^XLFDT($$NOW^XLFDT,"5Z")
"RTN","PXRMEXIC",222,0)
 S FDA(SFN,IENS,1)="`"_DUZ
"RTN","PXRMEXIC",223,0)
 ;The word-processing field is set when the packing is done.
"RTN","PXRMEXIC",224,0)
 S WP=FDA(SFN,IENS,2)
"RTN","PXRMEXIC",225,0)
 K @WP
"RTN","PXRMEXIC",226,0)
 S @WP@(1)="Exchange Install"
"RTN","PXRMEXIC",227,0)
 Q
"RTN","PXRMEXIC",228,0)
 ;
"RTN","PXRMEXIC",229,0)
 ;=================================================
"RTN","PXRMEXIC",230,0)
NAMECHG(FDA,NAMECHG,FILENUM) ;If this component has been copied to a new
"RTN","PXRMEXIC",231,0)
 ;name make the change.
"RTN","PXRMEXIC",232,0)
 N CLASS,IENS,PT01
"RTN","PXRMEXIC",233,0)
 S IENS=$O(FDA(FILENUM,""))
"RTN","PXRMEXIC",234,0)
 S PT01=FDA(FILENUM,IENS,.01)
"RTN","PXRMEXIC",235,0)
 I $D(NAMECHG(FILENUM,PT01)) D
"RTN","PXRMEXIC",236,0)
 . S FDA(FILENUM,IENS,.01)=NAMECHG(FILENUM,PT01)
"RTN","PXRMEXIC",237,0)
 . I (FILENUM<801.41)!(FILENUM>811.9) Q
"RTN","PXRMEXIC",238,0)
 .;Once a component has been copied CLASS can no longer be national.
"RTN","PXRMEXIC",239,0)
 . S CLASS=$G(FDA(FILENUM,IENS,100))
"RTN","PXRMEXIC",240,0)
 . I CLASS["N" S FDA(FILENUM,IENS,100)="LOCAL"
"RTN","PXRMEXIC",241,0)
 .;The Sponsor is also removed.
"RTN","PXRMEXIC",242,0)
 . K FDA(FILENUM,IENS,101)
"RTN","PXRMEXIC",243,0)
 Q
"RTN","PXRMEXIC",244,0)
 ;
"RTN","PXRMEXIC",245,0)
 ;=================================================
"RTN","PXRMEXIC",246,0)
RTNLD(PXRMRIEN,START,END,ATTR,RTN) ;Load a routine from the repository into
"RTN","PXRMEXIC",247,0)
 ;the array RTN.
"RTN","PXRMEXIC",248,0)
 N IND,LINE,LN,ROUTINE
"RTN","PXRMEXIC",249,0)
 S LINE=^PXD(811.8,PXRMRIEN,100,START,0)
"RTN","PXRMEXIC",250,0)
 S ROUTINE=$P(LINE,";",1)
"RTN","PXRMEXIC",251,0)
 S ROUTINE=$TR(ROUTINE," ","")
"RTN","PXRMEXIC",252,0)
 S ATTR("FILE NUMBER")=0
"RTN","PXRMEXIC",253,0)
 S ATTR("NAME")=$P(LINE,";",1)
"RTN","PXRMEXIC",254,0)
 S ATTR("NAME")=$TR(ATTR("NAME")," ","")
"RTN","PXRMEXIC",255,0)
 S ATTR("MIN FIELD LENGTH")=3
"RTN","PXRMEXIC",256,0)
 S ATTR("FIELD LENGTH")=8
"RTN","PXRMEXIC",257,0)
 S LN=0
"RTN","PXRMEXIC",258,0)
 F IND=START:1:END D
"RTN","PXRMEXIC",259,0)
 . S LN=LN+1
"RTN","PXRMEXIC",260,0)
 . S LINE=^PXD(811.8,PXRMRIEN,100,IND,0)
"RTN","PXRMEXIC",261,0)
 . S RTN(LN,0)=LINE
"RTN","PXRMEXIC",262,0)
 Q
"RTN","PXRMEXIC",263,0)
 ;
"RTN","PXRMEXIC",264,0)
 ;=================================================
"RTN","PXRMEXIC",265,0)
RTNSAVE(RTN,NAME) ;Save the routine loaded in RTN to the name
"RTN","PXRMEXIC",266,0)
 ;found in NAMECHG.
"RTN","PXRMEXIC",267,0)
 N DIE,XCN
"RTN","PXRMEXIC",268,0)
 ;%ZOSF("SAVE") requires a global.
"RTN","PXRMEXIC",269,0)
 K ^TMP($J,"PXRMRTN")
"RTN","PXRMEXIC",270,0)
 S DIE="^TMP($J,""PXRMRTN"","
"RTN","PXRMEXIC",271,0)
 M ^TMP($J,"PXRMRTN")=RTN
"RTN","PXRMEXIC",272,0)
 S XCN=0
"RTN","PXRMEXIC",273,0)
 S X=NAME
"RTN","PXRMEXIC",274,0)
 X ^%ZOSF("SAVE")
"RTN","PXRMEXIC",275,0)
 K ^TMP($J,"PXRMRTN")
"RTN","PXRMEXIC",276,0)
 Q
"RTN","PXRMEXIC",277,0)
 ;
"RTN","PXRMEXIC",278,0)
 ;=================================================
"RTN","PXRMEXIC",279,0)
WORDPROC(PXRMRIEN,WPTMP,I1,I2,IND,WPLCNT) ;Load WPTMP with the word
"RTN","PXRMEXIC",280,0)
 ;processing field.
"RTN","PXRMEXIC",281,0)
 N I3
"RTN","PXRMEXIC",282,0)
 F I3=1:1:WPLCNT D
"RTN","PXRMEXIC",283,0)
 . S IND=IND+1
"RTN","PXRMEXIC",284,0)
 . S WPTMP(I1,I2,I3)=$G(^PXD(811.8,PXRMRIEN,100,IND,0))
"RTN","PXRMEXIC",285,0)
 Q
"RTN","PXRMEXIC",286,0)
 ;
"RTN","PXRMEXID")
0^8^B65987316
"RTN","PXRMEXID",1,0)
PXRMEXID ;SLC/PJH - Reminder Dialog Exchange Install Routine. ;11/20/2011
"RTN","PXRMEXID",2,0)
 ;;2.0;CLINICAL REMINDERS;**6,12,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXID",3,0)
 ;
"RTN","PXRMEXID",4,0)
 ;==================================================
"RTN","PXRMEXID",5,0)
 ;Install all dialog components in an exchange file entry
"RTN","PXRMEXID",6,0)
 ;------------------------------------------------
"RTN","PXRMEXID",7,0)
INSALL N ALL,DIROUT,DIRUT,DTOUT,DUOUT,IND,PXRMDONE
"RTN","PXRMEXID",8,0)
 ;
"RTN","PXRMEXID",9,0)
 ;Set the install date and time.
"RTN","PXRMEXID",10,0)
 S IND="",PXRMDONE=0
"RTN","PXRMEXID",11,0)
 ;
"RTN","PXRMEXID",12,0)
 ;Go to full screen mode.
"RTN","PXRMEXID",13,0)
 D FULL^VALM1
"RTN","PXRMEXID",14,0)
 ;
"RTN","PXRMEXID",15,0)
 ;Check if all or none exists - option to install all unchanged
"RTN","PXRMEXID",16,0)
 N DNAME
"RTN","PXRMEXID",17,0)
 S DNAME=$G(^TMP("PXRMEXTMP",$J,"PXRMDNAME"))
"RTN","PXRMEXID",18,0)
 D EXIST^PXRMEXIX(.ALL,DNAME,"reminder dialog","")
"RTN","PXRMEXID",19,0)
 I ALL=0 D DISP^PXRMEXLD(PXRMMODE) Q
"RTN","PXRMEXID",20,0)
 ;
"RTN","PXRMEXID",21,0)
 ;Lock the entire file
"RTN","PXRMEXID",22,0)
 Q:'$$LOCK
"RTN","PXRMEXID",23,0)
 F  S IND=$O(^TMP("PXRMEXLD",$J,"SEL",IND),-1) Q:(IND="")!(PXRMDONE)  D
"RTN","PXRMEXID",24,0)
 .D INSCOM(DNAME,IND,1)
"RTN","PXRMEXID",25,0)
 ;
"RTN","PXRMEXID",26,0)
 ;Clear lock
"RTN","PXRMEXID",27,0)
 D UNLOCK
"RTN","PXRMEXID",28,0)
 ;
"RTN","PXRMEXID",29,0)
 ;Rebuild display workfile
"RTN","PXRMEXID",30,0)
 D DISP^PXRMEXLD(PXRMMODE)
"RTN","PXRMEXID",31,0)
 ;
"RTN","PXRMEXID",32,0)
 K PXRMNMCH
"RTN","PXRMEXID",33,0)
 Q
"RTN","PXRMEXID",34,0)
 ;
"RTN","PXRMEXID",35,0)
 ;Build list of descendents names
"RTN","PXRMEXID",36,0)
 ;-------------------------------
"RTN","PXRMEXID",37,0)
INSBLD(DIALNAM,NAME,INAME) ;
"RTN","PXRMEXID",38,0)
 N DNAME,IDATA,ISEQ
"RTN","PXRMEXID",39,0)
 S ISEQ=0
"RTN","PXRMEXID",40,0)
 F  S ISEQ=$O(^TMP("PXRMEXTMP",$J,"DMAP",NAME,ISEQ)) Q:'ISEQ  D
"RTN","PXRMEXID",41,0)
 .S IDATA=$G(^TMP("PXRMEXTMP",$J,"DMAP",NAME,ISEQ)) Q:IDATA=""
"RTN","PXRMEXID",42,0)
 .S DNAME=$P(IDATA,U) Q:DNAME=""
"RTN","PXRMEXID",43,0)
 .;
"RTN","PXRMEXID",44,0)
 .I $D(^TMP("PXRMEXTMP",$J,"DREPL"))>0 D
"RTN","PXRMEXID",45,0)
 ..S REPL=$$CHKREPL^PXRMEXDB(DIALNAM,NAME) I REPL>0 D INSREPL(DIALNAM,NAME,REPL,.INAME)
"RTN","PXRMEXID",46,0)
 .S INAME(DNAME)=""
"RTN","PXRMEXID",47,0)
 .;Check for descendants
"RTN","PXRMEXID",48,0)
 .I $D(^TMP("PXRMEXTMP",$J,"DMAP",DNAME)) D INSBLD(DIALNAM,DNAME,.INAME)
"RTN","PXRMEXID",49,0)
 Q
"RTN","PXRMEXID",50,0)
 ;
"RTN","PXRMEXID",51,0)
 ;Build list of replacement names
"RTN","PXRMEXID",52,0)
 ;-------------------------------
"RTN","PXRMEXID",53,0)
INSREPL(DIALNAME,NAME,REPL,INAME) ;
"RTN","PXRMEXID",54,0)
 N DNAME,IDATA,ISEQ
"RTN","PXRMEXID",55,0)
 S ISEQ=0
"RTN","PXRMEXID",56,0)
 S IDATA=$G(^TMP("PXRMEXTMP",$J,"DREPL",DIALNAM,REPL,NAME)) Q:IDATA=""
"RTN","PXRMEXID",57,0)
 S DNAME=$P(IDATA,U) Q:DNAME=""  S INAME(DNAME)=""
"RTN","PXRMEXID",58,0)
 ;Check for descendants
"RTN","PXRMEXID",59,0)
 I $D(^TMP("PXRMEXTMP",$J,"DMAP",DNAME)) D INSBLD(DIALNAM,DNAME,.INAME)
"RTN","PXRMEXID",60,0)
 Q
"RTN","PXRMEXID",61,0)
 ;
"RTN","PXRMEXID",62,0)
 ;Install component IND
"RTN","PXRMEXID",63,0)
 ;---------------------
"RTN","PXRMEXID",64,0)
INSCOM(DIALNAM,IND,SILENT) ;
"RTN","PXRMEXID",65,0)
 N ACTION,ATTR,CSUM,DTYP,EXIEN,END,EXISTS,FILENUM,IND120,JND120
"RTN","PXRMEXID",66,0)
 N NEWPT01,PT01,START,REPL,SAME,TEMP
"RTN","PXRMEXID",67,0)
 S TEMP=^TMP("PXRMEXLD",$J,"SEL",IND),FILENUM=$P(TEMP,U,1)
"RTN","PXRMEXID",68,0)
 S START=$P(TEMP,U,2),END=$P(TEMP,U,3) Q:START=""
"RTN","PXRMEXID",69,0)
 S IND120=$P(TEMP,U,4) Q:'IND120
"RTN","PXRMEXID",70,0)
 S JND120=$P(TEMP,U,5) Q:'JND120
"RTN","PXRMEXID",71,0)
 S EXISTS=$P(TEMP,U,6)
"RTN","PXRMEXID",72,0)
 S TEMP=^PXD(811.8,PXRMRIEN,100,START,0),PT01=$P(TEMP,"~",2) Q:PT01=""
"RTN","PXRMEXID",73,0)
 S DTYP=$G(^TMP("PXRMEXTMP",$J,"DTYP",PT01))
"RTN","PXRMEXID",74,0)
 I DTYP="dialog" S DTYP="reminder dialog"
"RTN","PXRMEXID",75,0)
 ;
"RTN","PXRMEXID",76,0)
 ;Go to full screen mode.
"RTN","PXRMEXID",77,0)
 D FULL^VALM1
"RTN","PXRMEXID",78,0)
 ;
"RTN","PXRMEXID",79,0)
 ;Check for descendents
"RTN","PXRMEXID",80,0)
 S REPL=$$CHKREPL^PXRMEXDB(DIALNAM,PT01)
"RTN","PXRMEXID",81,0)
 I 'SILENT&($$INSDSC(PT01)!(REPL>0)) D  Q:PXRMDONE
"RTN","PXRMEXID",82,0)
 .N ANS,INDS,TEXT
"RTN","PXRMEXID",83,0)
 .S TEXT(1)=PT01_" ("_DTYP_") contains sub-components."
"RTN","PXRMEXID",84,0)
 .S TEXT="Install all sub-components with the "_DTYP_": "
"RTN","PXRMEXID",85,0)
 .;Give option to install all descendents
"RTN","PXRMEXID",86,0)
 .D ASK^PXRMEXIX(.ANS,.TEXT,1) Q:PXRMDONE
"RTN","PXRMEXID",87,0)
 .I $G(ANS)="N" S PXRMDONE=1 Q
"RTN","PXRMEXID",88,0)
 .I $G(ANS)="Y" D
"RTN","PXRMEXID",89,0)
 ..S INDS=IND
"RTN","PXRMEXID",90,0)
 ..N IDATA,INAME,IND
"RTN","PXRMEXID",91,0)
 ..I REPL>0 D INSREPL(DIALNAM,PT01,REPL,.INAME)
"RTN","PXRMEXID",92,0)
 ..;Build list of decendents to install
"RTN","PXRMEXID",93,0)
 ..D INSBLD(DIALNAM,PT01,.INAME)
"RTN","PXRMEXID",94,0)
 ..;Check if all or none exists - option to install all unchanged
"RTN","PXRMEXID",95,0)
 ..D EXIST^PXRMEXIX(.ALL,PT01,DTYP,.INAME) Q:PXRMDONE
"RTN","PXRMEXID",96,0)
 ..;Start at the end of the list
"RTN","PXRMEXID",97,0)
 ..S IND=""
"RTN","PXRMEXID",98,0)
 ..F  S IND=$O(^TMP("PXRMEXLD",$J,"SEL",IND),-1) Q:PXRMDONE!(IND=INDS)  D
"RTN","PXRMEXID",99,0)
 ...N PT01,START,TEMP
"RTN","PXRMEXID",100,0)
 ...S TEMP=^TMP("PXRMEXLD",$J,"SEL",IND),START=$P(TEMP,U,2) Q:START=""
"RTN","PXRMEXID",101,0)
 ...S PT01=$P(^PXD(811.8,PXRMRIEN,100,START,0),"~",2) Q:PT01=""
"RTN","PXRMEXID",102,0)
 ...;Ignore namechanges
"RTN","PXRMEXID",103,0)
 ...I $D(PXRMNMCH(801.41,PT01)) Q
"RTN","PXRMEXID",104,0)
 ...;Only install descendents
"RTN","PXRMEXID",105,0)
 ...I $D(INAME(PT01)) D INSCOM(DIALNAM,IND,1)
"RTN","PXRMEXID",106,0)
 ;
"RTN","PXRMEXID",107,0)
SETENTRY ;
"RTN","PXRMEXID",108,0)
 D SETATTR^PXRMEXFI(.ATTR,FILENUM,PT01)
"RTN","PXRMEXID",109,0)
 S ACTION=""
"RTN","PXRMEXID",110,0)
 ;Double check that it hasn't been installed
"RTN","PXRMEXID",111,0)
 S EXIEN=$$EXISTS^PXRMEXIU(801.41,PT01)
"RTN","PXRMEXID",112,0)
 I EXIEN,'EXISTS S EXISTS=1
"RTN","PXRMEXID",113,0)
 I EXISTS D
"RTN","PXRMEXID",114,0)
 . D CHECKSUM^PXRMEXCS(.ATTR,START,END)
"RTN","PXRMEXID",115,0)
 . S CSUM=$$FILE^PXRMEXCS(ATTR("FILE NUMBER"),EXIEN)
"RTN","PXRMEXID",116,0)
 . S SAME=$S(ATTR("CHECKSUM")=CSUM:1,1:0)
"RTN","PXRMEXID",117,0)
 . I SAME D FEIMSG^PXRMEXFI(SAME,.ATTR) S ACTION="S",(PXRMNMCH,NEWPT01)=""
"RTN","PXRMEXID",118,0)
 I ACTION="" D
"RTN","PXRMEXID",119,0)
 .;If all components installed the default is 'Install or Overwrite'
"RTN","PXRMEXID",120,0)
 . S:ALL ACTION=$S(EXISTS:"O",1:"I"),(PXRMNMCH,NEWPT01)=""
"RTN","PXRMEXID",121,0)
 . S:'ALL ACTION=$$GETFACT^PXRMEXFI(PT01,.ATTR,.NEWPT01,.PXRMNMCH,EXIEN)
"RTN","PXRMEXID",122,0)
 ;Save what was done for the installation summary.
"RTN","PXRMEXID",123,0)
 S ^TMP("PXRMEXIAD",$J,IND,ATTR("FILE NAME"),ATTR("PT01"),ACTION)=NEWPT01
"RTN","PXRMEXID",124,0)
 ;Clear heading
"RTN","PXRMEXID",125,0)
 S VALMHDR(2)=""
"RTN","PXRMEXID",126,0)
 ;If the ACTION is Quit then quit the entire install.
"RTN","PXRMEXID",127,0)
 I ACTION="Q" S PXRMDONE=1 S VALMHDR(2)="Install not completed" Q
"RTN","PXRMEXID",128,0)
 ;If the ACTION is Skip then skip this component.
"RTN","PXRMEXID",129,0)
 I ACTION="S" S VALMBCK="R" Q
"RTN","PXRMEXID",130,0)
 ;If the ACTION is Replace then skip this component.
"RTN","PXRMEXID",131,0)
 I ACTION="P" S VALMBCK="R",VALMHDR(2)=PT01_" replaced with "_NEWPT01 Q
"RTN","PXRMEXID",132,0)
 ;Install this component.
"RTN","PXRMEXID",133,0)
 D FILE^PXRMEXIC(PXRMRIEN,EXIEN,IND120,JND120,ACTION,.ATTR,.PXRMNMCH)
"RTN","PXRMEXID",134,0)
 S VALMBCK="R"
"RTN","PXRMEXID",135,0)
 I PXRMDONE S VALMHDR(2)="Install aborted" Q
"RTN","PXRMEXID",136,0)
 I NEWPT01="" S VALMHDR(2)=PT01_" ("_DTYP_") installed from exchange file."
"RTN","PXRMEXID",137,0)
 I NEWPT01'="" S VALMHDR(2)=PT01_" installed as "_NEWPT01_"."
"RTN","PXRMEXID",138,0)
 ;If reminder dialog - disable and give option to link
"RTN","PXRMEXID",139,0)
 I DTYP="reminder dialog" D
"RTN","PXRMEXID",140,0)
 .N DNAME
"RTN","PXRMEXID",141,0)
 .S DNAME=PT01
"RTN","PXRMEXID",142,0)
 .I NEWPT01'="" S DNAME=NEWPT01
"RTN","PXRMEXID",143,0)
 .D INSLNK(DNAME)
"RTN","PXRMEXID",144,0)
 Q
"RTN","PXRMEXID",145,0)
 ;
"RTN","PXRMEXID",146,0)
 ;Check for descendents (either elements or prompts)
"RTN","PXRMEXID",147,0)
 ;--------------------------------------------------
"RTN","PXRMEXID",148,0)
INSDSC(NAME) ;
"RTN","PXRMEXID",149,0)
 N DATA,DFOUND,SUB
"RTN","PXRMEXID",150,0)
 S DFOUND=0,SUB=0
"RTN","PXRMEXID",151,0)
 F  S SUB=$O(^TMP("PXRMEXTMP",$J,"DMAP",NAME,SUB)) Q:'SUB  D  Q:DFOUND
"RTN","PXRMEXID",152,0)
 .S DATA=$G(^TMP("PXRMEXTMP",$J,"DMAP",NAME,SUB)) Q:DATA=""
"RTN","PXRMEXID",153,0)
 .S DFOUND=1
"RTN","PXRMEXID",154,0)
 Q DFOUND
"RTN","PXRMEXID",155,0)
 ;
"RTN","PXRMEXID",156,0)
INSREPL1(NAME) ;
"RTN","PXRMEXID",157,0)
 N DATA,DFOUND,SUB
"RTN","PXRMEXID",158,0)
 S DFOUND=0,SUB=0
"RTN","PXRMEXID",159,0)
 F  S SUB=$O(^TMP("PXRMEXTMP",$J,"DREPL",NAME,SUB)) Q:'SUB  D  Q:DFOUND
"RTN","PXRMEXID",160,0)
 .S DATA=$G(^TMP("PXRMEXTMP",$J,"DREPL",NAME,SUB)) Q:DATA=""
"RTN","PXRMEXID",161,0)
 .S DFOUND=1
"RTN","PXRMEXID",162,0)
 Q DFOUND
"RTN","PXRMEXID",163,0)
 ;Option to link dialog to a reminder
"RTN","PXRMEXID",164,0)
 ;-----------------------------------
"RTN","PXRMEXID",165,0)
INSLNK(DNAME) ;
"RTN","PXRMEXID",166,0)
 N DIEN,DISABLE,DSRC,RNAME
"RTN","PXRMEXID",167,0)
 N DA,DIE,DR
"RTN","PXRMEXID",168,0)
 ;Disable
"RTN","PXRMEXID",169,0)
 S DIEN=$O(^PXRMD(801.41,"B",DNAME,"")) Q:'DIEN
"RTN","PXRMEXID",170,0)
 ;Set dialog as disabled
"RTN","PXRMEXID",171,0)
 S DISABLE=1
"RTN","PXRMEXID",172,0)
 ;Except for National dialogs
"RTN","PXRMEXID",173,0)
 I $P(^PXRMD(801.41,DIEN,100),U)="N" S DISABLE=0
"RTN","PXRMEXID",174,0)
 ;
"RTN","PXRMEXID",175,0)
 S DR="3///^S X=DISABLE",DIE="^PXRMD(801.41,",DA=$P(DIEN,U)
"RTN","PXRMEXID",176,0)
 D ^DIE
"RTN","PXRMEXID",177,0)
 ;
"RTN","PXRMEXID",178,0)
 ;Quit if already linked
"RTN","PXRMEXID",179,0)
 I $D(^PXD(811.9,"AG",DIEN)) Q
"RTN","PXRMEXID",180,0)
 ;
"RTN","PXRMEXID",181,0)
 S RNAME=$O(^TMP("PXRMEXDL",$J,DNAME,""))
"RTN","PXRMEXID",182,0)
 ;
"RTN","PXRMEXID",183,0)
 ;Otherwise use original reminder name as default
"RTN","PXRMEXID",184,0)
 I RNAME="" D
"RTN","PXRMEXID",185,0)
 .N DATA,FOUND,RIEN,SUB
"RTN","PXRMEXID",186,0)
 .;Rebuild ^TMP("PXRMEXLC",$J
"RTN","PXRMEXID",187,0)
 .D CDISP^PXRMEXLC(PXRMRIEN)
"RTN","PXRMEXID",188,0)
 .;
"RTN","PXRMEXID",189,0)
 .S SUB="",FOUND=0
"RTN","PXRMEXID",190,0)
 .F  S SUB=$O(^TMP("PXRMEXLC",$J,"SEL",SUB),-1) Q:'SUB  Q:FOUND  D
"RTN","PXRMEXID",191,0)
 ..S DATA=$G(^TMP("PXRMEXLC",$J,"SEL",SUB)) Q:$P(DATA,U)'=811.9
"RTN","PXRMEXID",192,0)
 ;
"RTN","PXRMEXID",193,0)
 I RNAME="" Q
"RTN","PXRMEXID",194,0)
TAG W !!,"Reminder Dialog "_DNAME_" is not linked to a reminder.",!
"RTN","PXRMEXID",195,0)
 ;Select reminder to link
"RTN","PXRMEXID",196,0)
 S IEN=$$SELECT^PXRMINQ("^PXD(811.9,","Select Reminder to Link: ",RNAME)
"RTN","PXRMEXID",197,0)
 ;Update reminder link in #811.9
"RTN","PXRMEXID",198,0)
 I $P(IEN,U)'=-1 D
"RTN","PXRMEXID",199,0)
 .N DA,DIE,DIK,DR
"RTN","PXRMEXID",200,0)
 .;Set reminder to dialog pointer
"RTN","PXRMEXID",201,0)
 .S DR="51///^S X=DNAME",DIE="^PXD(811.9,",DA=$P(IEN,U)
"RTN","PXRMEXID",202,0)
 .D ^DIE
"RTN","PXRMEXID",203,0)
 .;If source reminder is null replace with linked reminder
"RTN","PXRMEXID",204,0)
 .S DSRC=$P($G(^PXRMD(801.41,DIEN,0)),U,2) Q:DSRC
"RTN","PXRMEXID",205,0)
 .S DSRC=$P(IEN,U)
"RTN","PXRMEXID",206,0)
 .S DR="2///^S X=DSRC",DIE="^PXRMD(801.41,",DA=$P(DIEN,U)
"RTN","PXRMEXID",207,0)
 .D ^DIE
"RTN","PXRMEXID",208,0)
 Q
"RTN","PXRMEXID",209,0)
 ;
"RTN","PXRMEXID",210,0)
 ;Install Selected Components
"RTN","PXRMEXID",211,0)
 ;---------------------------
"RTN","PXRMEXID",212,0)
INSSEL N ALL,IND,PXRMDONE,VALMY
"RTN","PXRMEXID",213,0)
 N DIROUT,DIRUT,DNAME,DTOUT,DUOUT
"RTN","PXRMEXID",214,0)
 N VALMBG,VALMLST
"RTN","PXRMEXID",215,0)
 S VALMBG=1,VALMLST=+$O(^TMP("PXRMEXLD",$J,"IDX",""),-1)
"RTN","PXRMEXID",216,0)
 ;Get the list to install.
"RTN","PXRMEXID",217,0)
 D EN^VALM2(XQORNOD(0))
"RTN","PXRMEXID",218,0)
 ;
"RTN","PXRMEXID",219,0)
 ;Set the install date and time.
"RTN","PXRMEXID",220,0)
 S ALL="",PXRMDONE=0
"RTN","PXRMEXID",221,0)
 ;
"RTN","PXRMEXID",222,0)
 ;Lock the entire file
"RTN","PXRMEXID",223,0)
 Q:'$$LOCK
"RTN","PXRMEXID",224,0)
 ;
"RTN","PXRMEXID",225,0)
 S DNAME=$G(^TMP("PXRMEXTMP",$J,"PXRMDNAME"))
"RTN","PXRMEXID",226,0)
 S IND=0
"RTN","PXRMEXID",227,0)
 F  S IND=$O(VALMY(IND)) Q:(+IND=0)!(PXRMDONE)  D INSCOM(DNAME,IND,0)
"RTN","PXRMEXID",228,0)
 ;
"RTN","PXRMEXID",229,0)
 ;Clear locks
"RTN","PXRMEXID",230,0)
 D UNLOCK
"RTN","PXRMEXID",231,0)
 ;
"RTN","PXRMEXID",232,0)
 ;Rebuild workfile
"RTN","PXRMEXID",233,0)
 D DISP^PXRMEXLD(PXRMMODE)
"RTN","PXRMEXID",234,0)
 Q
"RTN","PXRMEXID",235,0)
 ;
"RTN","PXRMEXID",236,0)
 ;Install the exchange entry PXRMRIEN
"RTN","PXRMEXID",237,0)
 ;-----------------------------------
"RTN","PXRMEXID",238,0)
INSTALL N CLOK,IEN,IND,VALMY
"RTN","PXRMEXID",239,0)
 ;Make sure the component list exists for this entry. PXRMRIEN is
"RTN","PXRMEXID",240,0)
 ;set in INSTALL^PXRMEXLR.
"RTN","PXRMEXID",241,0)
 S CLOK=1
"RTN","PXRMEXID",242,0)
 I '$D(^PXD(811.8,PXRMRIEN,120)) D CLIST^PXRMEXCO(PXRMRIEN,.CLOK)
"RTN","PXRMEXID",243,0)
 I 'CLOK Q
"RTN","PXRMEXID",244,0)
 D CDISP^PXRMEXLC(PXRMRIEN)
"RTN","PXRMEXID",245,0)
 S VALMBCK="R",VALMCNT=$O(^TMP("PXRMEXLD",$J,"IDX"),-1)
"RTN","PXRMEXID",246,0)
 Q
"RTN","PXRMEXID",247,0)
 ;
"RTN","PXRMEXID",248,0)
PXRM(NAME) ;Validate prompts
"RTN","PXRMEXID",249,0)
 ;Ignore non-PXRM
"RTN","PXRMEXID",250,0)
 I $E(NAME,1,4)'="PXRM" Q 0
"RTN","PXRMEXID",251,0)
 N DIEN,RESULT
"RTN","PXRMEXID",252,0)
 I $G(PXRMINST)=1 D  Q RESULT
"RTN","PXRMEXID",253,0)
 .S RESULT=0
"RTN","PXRMEXID",254,0)
 .S DIEN=$O(^PXRMD(801.41,"B",NAME,"")) I 'DIEN Q
"RTN","PXRMEXID",255,0)
 .I $P($G(^PXRMD(801.41,DIEN,100)),U)'="N" Q
"RTN","PXRMEXID",256,0)
 .I ($P($G(^PXRMD(801.41,DIEN,0)),U,4)="P")!($P($G(^PXRMD(801.41,DIEN,0)),U,4)="F") S RESULT=1
"RTN","PXRMEXID",257,0)
 ;
"RTN","PXRMEXID",258,0)
 ;Check if this is a national code
"RTN","PXRMEXID",259,0)
 S DIEN=$O(^PXRMD(801.41,"B",NAME,""))
"RTN","PXRMEXID",260,0)
 ;If not found abort
"RTN","PXRMEXID",261,0)
 I 'DIEN Q 0
"RTN","PXRMEXID",262,0)
 ;if result group/element quit
"RTN","PXRMEXID",263,0)
 I $P($G(^PXRMD(801.41,DIEN,0)),U,4)="S"!($P($G(^PXRMD(801.41,DIEN,0)),U,4)="T") Q 0
"RTN","PXRMEXID",264,0)
 ;Check class
"RTN","PXRMEXID",265,0)
 I $P($G(^PXRMD(801.41,DIEN,100)),U)="N" Q 1
"RTN","PXRMEXID",266,0)
 ;Otherwise local
"RTN","PXRMEXID",267,0)
 Q 0
"RTN","PXRMEXID",268,0)
 ;
"RTN","PXRMEXID",269,0)
 ;Lock the dialog file
"RTN","PXRMEXID",270,0)
LOCK() ;
"RTN","PXRMEXID",271,0)
 L +^PXRMD(801.41):0 I  Q 1
"RTN","PXRMEXID",272,0)
 E  W !,"Another user is editing this file, try later" H 2
"RTN","PXRMEXID",273,0)
 Q 0
"RTN","PXRMEXID",274,0)
 ;
"RTN","PXRMEXID",275,0)
 ;Clear lock
"RTN","PXRMEXID",276,0)
UNLOCK L -^PXRMD(801.41)
"RTN","PXRMEXID",277,0)
 Q
"RTN","PXRMEXIU")
0^7^B66069083
"RTN","PXRMEXIU",1,0)
PXRMEXIU ;SLC/PKR/PJH - Utilities for installing repository entries. ;04/19/2012
"RTN","PXRMEXIU",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,12,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXIU",3,0)
 ;===============================================
"RTN","PXRMEXIU",4,0)
DEF(FDA,NAMECHG) ;Check the reminder definition to make sure the related
"RTN","PXRMEXIU",5,0)
 ;reminder exists and all the findings exist.
"RTN","PXRMEXIU",6,0)
 N ABBR,ALIST,IEN,IENS,FILENUM,FINDING,LRD,OFINDING,PT01
"RTN","PXRMEXIU",7,0)
 N RNAME,RRG,SPONSOR,TEXT,VERSN
"RTN","PXRMEXIU",8,0)
 S IENS=$O(FDA(811.9,""))
"RTN","PXRMEXIU",9,0)
 ;Related reminder guideline field 1.4.
"RTN","PXRMEXIU",10,0)
 I $D(FDA(811.9,IENS,1.4)) D
"RTN","PXRMEXIU",11,0)
 . S RRG=FDA(811.9,IENS,1.4)
"RTN","PXRMEXIU",12,0)
 . S IEN=$$EXISTS^PXRMEXIU(811.9,RRG)
"RTN","PXRMEXIU",13,0)
 . I IEN=0 D
"RTN","PXRMEXIU",14,0)
 ..;Get replacement.
"RTN","PXRMEXIU",15,0)
 .. N DIC,X,Y
"RTN","PXRMEXIU",16,0)
 .. S TEXT(1)=" "
"RTN","PXRMEXIU",17,0)
 .. S TEXT(2)="The Related Reminder Guideline does not exist on your system!"
"RTN","PXRMEXIU",18,0)
 .. S TEXT(3)="It is "_RRG_" input a replacement or ^ to leave it empty."
"RTN","PXRMEXIU",19,0)
 .. D MES^XPDUTL(.TEXT)
"RTN","PXRMEXIU",20,0)
 ..;If this is being called during a KIDS install we need echoing on.
"RTN","PXRMEXIU",21,0)
 .. I $D(XPDNM) X ^%ZOSF("EON")
"RTN","PXRMEXIU",22,0)
 .. S DIC=811.9,DIC(0)="AEMQ"
"RTN","PXRMEXIU",23,0)
 .. D ^DIC
"RTN","PXRMEXIU",24,0)
 .. I $D(XPDNM) X ^%ZOSF("EOFF")
"RTN","PXRMEXIU",25,0)
 .. I Y=-1 K FDA(811.9,IENS,1.4)
"RTN","PXRMEXIU",26,0)
 .. E  S FDA(811.9,IENS,1.4)=$P(Y,U,2)
"RTN","PXRMEXIU",27,0)
 ;
"RTN","PXRMEXIU",28,0)
 ;Sponsor field 101.
"RTN","PXRMEXIU",29,0)
 I $D(FDA(811.9,IENS,101)) D
"RTN","PXRMEXIU",30,0)
 . S SPONSOR=FDA(811.9,IENS,101)
"RTN","PXRMEXIU",31,0)
 . S IEN=$$FIND1^DIC(811.6,"","",SPONSOR)
"RTN","PXRMEXIU",32,0)
 . I IEN=0 D
"RTN","PXRMEXIU",33,0)
 ..;Get replacement.
"RTN","PXRMEXIU",34,0)
 .. N DIC,X,Y
"RTN","PXRMEXIU",35,0)
 .. S TEXT(1)=" "
"RTN","PXRMEXIU",36,0)
 .. S TEXT(2)="The Sponsor does not exist on your system!"
"RTN","PXRMEXIU",37,0)
 .. S TEXT(3)="It is "_SPONSOR_" input a replacement or ^ to leave it empty."
"RTN","PXRMEXIU",38,0)
 .. D MES^XPDUTL(.TEXT)
"RTN","PXRMEXIU",39,0)
 ..;If this is being called during a KIDS install we need echoing on.
"RTN","PXRMEXIU",40,0)
 .. I $D(XPDNM) X ^%ZOSF("EON")
"RTN","PXRMEXIU",41,0)
 .. S DIC=811.6,DIC(0)="AEMQ"
"RTN","PXRMEXIU",42,0)
 .. D ^DIC
"RTN","PXRMEXIU",43,0)
 .. I $D(XPDNM) X ^%ZOSF("EOFF")
"RTN","PXRMEXIU",44,0)
 .. I Y=-1 K FDA(811.9,IENS,101)
"RTN","PXRMEXIU",45,0)
 .. E  S FDA(811.9,IENS,101)=$P(Y,U,2)
"RTN","PXRMEXIU",46,0)
 ;
"RTN","PXRMEXIU",47,0)
 ;Linked reminder dialog field 51.
"RTN","PXRMEXIU",48,0)
 S LRD=$G(FDA(811.9,IENS,51))
"RTN","PXRMEXIU",49,0)
 S RNAME=$G(FDA(811.9,IENS,.01))
"RTN","PXRMEXIU",50,0)
 I LRD'="",RNAME'="" S ^TMP("PXRMEXDL",$J,LRD,RNAME)=""
"RTN","PXRMEXIU",51,0)
 K FDA(811.9,IENS,51)
"RTN","PXRMEXIU",52,0)
 ;
"RTN","PXRMEXIU",53,0)
 ;Search the finding multiple for replacements and missing findings.
"RTN","PXRMEXIU",54,0)
 D SFMVPI(.FDA,.NAMECHG,811.902)
"RTN","PXRMEXIU",55,0)
 S VERSN=$$GETTAGV^PXRMEXU3(^PXD(811.8,PXRMRIEN,100,3,0),"<PACKAGE_VERSION>")
"RTN","PXRMEXIU",56,0)
 I VERSN=1.5 D CEFD^PXRMDATE(.FDA)
"RTN","PXRMEXIU",57,0)
 Q
"RTN","PXRMEXIU",58,0)
 ;
"RTN","PXRMEXIU",59,0)
 ;===============================================
"RTN","PXRMEXIU",60,0)
EXISTS(FILENUM,NAME,FLAG) ;Check for existence of an entry with the
"RTN","PXRMEXIU",61,0)
 ;same name. Return 0 for null name. If FLAG="W" then if necessary
"RTN","PXRMEXIU",62,0)
 ;display the warning message.
"RTN","PXRMEXIU",63,0)
 I NAME="" Q 0
"RTN","PXRMEXIU",64,0)
 ;Return the ien if it does, 0 otherwise.
"RTN","PXRMEXIU",65,0)
 N IEN
"RTN","PXRMEXIU",66,0)
 I FILENUM=0 S IEN=$$EXISTS^PXRMEXCF(NAME) Q
"RTN","PXRMEXIU",67,0)
 N FLAGS,RESULT
"RTN","PXRMEXIU",68,0)
 S RESULT=NAME
"RTN","PXRMEXIU",69,0)
 ;Special lookup for files 80 and 80.1, they do not have a standard "B"
"RTN","PXRMEXIU",70,0)
 ;cross-reference.
"RTN","PXRMEXIU",71,0)
 I (FILENUM=80)!(FILENUM=80.1) D
"RTN","PXRMEXIU",72,0)
 .;Name may or may not have the necessary space appended, make sure
"RTN","PXRMEXIU",73,0)
 .;it does.
"RTN","PXRMEXIU",74,0)
 . S RESULT=$S($E(NAME,$L(NAME))'=" ":NAME_" ",1:NAME)
"RTN","PXRMEXIU",75,0)
 . S FLAGS="MX"
"RTN","PXRMEXIU",76,0)
 E  S FLAGS="BX"
"RTN","PXRMEXIU",77,0)
 I FILENUM=811.6 S FLAGS=FLAGS_"U"
"RTN","PXRMEXIU",78,0)
 ;File 8927.1 only allows upper case .01s.
"RTN","PXRMEXIU",79,0)
 I FILENUM=8927.1 S RESULT=$$UP^XLFSTR(NAME)
"RTN","PXRMEXIU",80,0)
 S IEN=$$FIND1^DIC(FILENUM,"",FLAGS,RESULT)
"RTN","PXRMEXIU",81,0)
 I +IEN>0 Q IEN
"RTN","PXRMEXIU",82,0)
 ;If IEN is null then there was an error try FIND^DIC.
"RTN","PXRMEXIU",83,0)
 N FILENAME,LIST,MSG,NFOUND,TEXT
"RTN","PXRMEXIU",84,0)
 D FIND^DIC(FILENUM,"","",FLAGS,NAME,"","","","","LIST","MSG")
"RTN","PXRMEXIU",85,0)
 S NFOUND=+$P(LIST("DILIST",0),U,1)
"RTN","PXRMEXIU",86,0)
 I NFOUND=0 Q 0
"RTN","PXRMEXIU",87,0)
 I NFOUND=1 Q LIST("DILIST",2,1)
"RTN","PXRMEXIU",88,0)
 ;Multiple entries with the same name found. If FLAG="W" display the
"RTN","PXRMEXIU",89,0)
 ;warning message, return the first entry on the list and quit.
"RTN","PXRMEXIU",90,0)
 I $G(FLAG)="W" D  Q LIST("DILIST",2,1)
"RTN","PXRMEXIU",91,0)
 . S FILENAME=$$GET1^DID(FILENUM,"","","NAME")
"RTN","PXRMEXIU",92,0)
 . S TEXT(1)="Warning there are "_NFOUND_" "_FILENAME_" entries with the name "_NAME_"!"
"RTN","PXRMEXIU",93,0)
 . S TEXT(2)="If this is used as a finding, and it is not resolved by FileMan during"
"RTN","PXRMEXIU",94,0)
 . S TEXT(3)="installation, any component using this finding will not install."
"RTN","PXRMEXIU",95,0)
 . D EN^DDIOL(.TEXT)
"RTN","PXRMEXIU",96,0)
 . H 3
"RTN","PXRMEXIU",97,0)
 ;If FLAG is not "W" prompt the user for the replacement.
"RTN","PXRMEXIU",98,0)
 I NFOUND>1 S IEN=$$GETIEN^PXRMEXU0(NFOUND,.LIST)
"RTN","PXRMEXIU",99,0)
 Q IEN
"RTN","PXRMEXIU",100,0)
 ;
"RTN","PXRMEXIU",101,0)
 ;===============================================
"RTN","PXRMEXIU",102,0)
GETACT(CHOICES,DIR) ;Get the action
"RTN","PXRMEXIU",103,0)
 ;If CHOICES is empty the only action is skip.
"RTN","PXRMEXIU",104,0)
 I CHOICES="" Q "S"
"RTN","PXRMEXIU",105,0)
 N DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","PXRMEXIU",106,0)
 S DIR(0)="S"_U
"RTN","PXRMEXIU",107,0)
 I CHOICES["C" S DIR(0)=DIR(0)_"C:Create a new entry by copying to a new name"
"RTN","PXRMEXIU",108,0)
 I CHOICES["D" S DIR(0)=DIR(0)_";D:Delete"
"RTN","PXRMEXIU",109,0)
 I CHOICES["I" S DIR(0)=DIR(0)_";I:Install"
"RTN","PXRMEXIU",110,0)
 I CHOICES["M" S DIR(0)=DIR(0)_";M:Merge findings"
"RTN","PXRMEXIU",111,0)
 I CHOICES["O" S DIR(0)=DIR(0)_";O:Overwrite the current entry"
"RTN","PXRMEXIU",112,0)
 I CHOICES["P" S DIR(0)=DIR(0)_";P:Replace with an existing entry"
"RTN","PXRMEXIU",113,0)
 I CHOICES["U" S DIR(0)=DIR(0)_";U:Update"
"RTN","PXRMEXIU",114,0)
 I CHOICES["Q" S DIR(0)=DIR(0)_";Q:Quit the install"
"RTN","PXRMEXIU",115,0)
 I CHOICES["R" S DIR(0)=DIR(0)_";R:Restart"
"RTN","PXRMEXIU",116,0)
 I CHOICES["S" S DIR(0)=DIR(0)_";S:Skip, do not install this entry"
"RTN","PXRMEXIU",117,0)
 ;If this is being called during a KIDS install we need echoing on.
"RTN","PXRMEXIU",118,0)
 I $D(XPDNM) X ^%ZOSF("EON")
"RTN","PXRMEXIU",119,0)
 D ^DIR
"RTN","PXRMEXIU",120,0)
 I $D(XPDNM) X ^%ZOSF("EOFF")
"RTN","PXRMEXIU",121,0)
 I $D(DIROUT)!$D(DIRUT) S Y="S"
"RTN","PXRMEXIU",122,0)
 I $D(DTOUT)!($D(DUOUT)) S Y="S"
"RTN","PXRMEXIU",123,0)
 Q Y
"RTN","PXRMEXIU",124,0)
 ;
"RTN","PXRMEXIU",125,0)
 ;===============================================
"RTN","PXRMEXIU",126,0)
GETNAME(MIN,MAX) ;Get a name to use.
"RTN","PXRMEXIU",127,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","PXRMEXIU",128,0)
 S DIR(0)="FAOU"_U_MIN_":"_MAX
"RTN","PXRMEXIU",129,0)
 S DIR("A")="Input the new name: "
"RTN","PXRMEXIU",130,0)
 D ^DIR
"RTN","PXRMEXIU",131,0)
 I $D(DIROUT)!$D(DIRUT) Q ""
"RTN","PXRMEXIU",132,0)
 I $D(DTOUT)!$D(DUOUT) Q ""
"RTN","PXRMEXIU",133,0)
 Q Y
"RTN","PXRMEXIU",134,0)
 ;
"RTN","PXRMEXIU",135,0)
 ;===============================================
"RTN","PXRMEXIU",136,0)
GETUNAME(ATTR) ;Get a unique name to use, ATTR holds the attributes.
"RTN","PXRMEXIU",137,0)
 N IEN,NEWPT01,TEXT
"RTN","PXRMEXIU",138,0)
GNEW S NEWPT01=$$GETNAME(ATTR("MIN FIELD LENGTH"),ATTR("FIELD LENGTH"))
"RTN","PXRMEXIU",139,0)
 S IEN=+$$EXISTS(ATTR("FILE NUMBER"),NEWPT01)
"RTN","PXRMEXIU",140,0)
 I IEN>0 D  G GNEW
"RTN","PXRMEXIU",141,0)
 . S TEXT(1)=ATTR("FILE NAME")_" entry "_NEWPT01_" already exists."
"RTN","PXRMEXIU",142,0)
 . S TEXT(2)="Input a different name or type <ENTER> to quit."
"RTN","PXRMEXIU",143,0)
 . D EN^DDIOL(.TEXT)
"RTN","PXRMEXIU",144,0)
 E  S ATTR("NAME")=NEWPT01
"RTN","PXRMEXIU",145,0)
 Q NEWPT01
"RTN","PXRMEXIU",146,0)
 ;
"RTN","PXRMEXIU",147,0)
 ;===============================================
"RTN","PXRMEXIU",148,0)
HF(FDA,NAMECHG) ;Check the health factor to make sure a category does not
"RTN","PXRMEXIU",149,0)
 ;have a category.
"RTN","PXRMEXIU",150,0)
 N IENS
"RTN","PXRMEXIU",151,0)
 S IENS=$O(FDA(9999999.64,""))
"RTN","PXRMEXIU",152,0)
 I IENS="" Q
"RTN","PXRMEXIU",153,0)
 I FDA(9999999.64,IENS,.1)="CATEGORY" K FDA(9999999.64,IENS,.03)
"RTN","PXRMEXIU",154,0)
 Q
"RTN","PXRMEXIU",155,0)
 ;
"RTN","PXRMEXIU",156,0)
 ;===============================================
"RTN","PXRMEXIU",157,0)
REXISTS(NAME,DATEP) ;See if this Exchange File entry already exists.
"RTN","PXRMEXIU",158,0)
 N IEN,LUVALUE
"RTN","PXRMEXIU",159,0)
 S LUVALUE(1)=NAME
"RTN","PXRMEXIU",160,0)
 S LUVALUE(2)=DATEP
"RTN","PXRMEXIU",161,0)
 S IEN=+$$FIND1^DIC(811.8,"","KU",.LUVALUE)
"RTN","PXRMEXIU",162,0)
 Q IEN
"RTN","PXRMEXIU",163,0)
 ;
"RTN","PXRMEXIU",164,0)
 ;===============================================
"RTN","PXRMEXIU",165,0)
SFMVPI(FDA,NAMECHG,SFN) ;Search a variable pointer list for items that do not
"RTN","PXRMEXIU",166,0)
 ;exist and prompt the user for a replacement. Works for definitions,
"RTN","PXRMEXIU",167,0)
 ;terms, and health summary types.
"RTN","PXRMEXIU",168,0)
 N ABBR,ACTION,ALIST,DIR,IEN,IENS,FILENUM,FINDING,HSUB,OFINDING,PT01,TYPE
"RTN","PXRMEXIU",169,0)
 ;Search the finding multiple for replacements and missing findings.
"RTN","PXRMEXIU",170,0)
 S HSUB=$S(SFN=142.14:"HSTI",SFN=811.52:"TRMF",1:"DEFF")
"RTN","PXRMEXIU",171,0)
 S TYPE=$S(SFN=142.14:"Selection item",1:"Finding")
"RTN","PXRMEXIU",172,0)
 D BLDALIST^PXRMVPTR(SFN,.01,.ALIST)
"RTN","PXRMEXIU",173,0)
 S (ACTION,IENS)=""
"RTN","PXRMEXIU",174,0)
 F  S IENS=$O(FDA(SFN,IENS)) Q:(IENS="")!(ACTION="Q")  D
"RTN","PXRMEXIU",175,0)
 . S (FINDING,OFINDING)=FDA(SFN,IENS,.01)
"RTN","PXRMEXIU",176,0)
 . S ABBR=$P(FINDING,".",1)
"RTN","PXRMEXIU",177,0)
 . S PT01=$P(FINDING,".",2)
"RTN","PXRMEXIU",178,0)
 . S FILENUM=$P(ALIST(ABBR),U,1)
"RTN","PXRMEXIU",179,0)
 . I $D(NAMECHG(FILENUM,PT01)) D
"RTN","PXRMEXIU",180,0)
 .. S FINDING=ABBR_"."_NAMECHG(FILENUM,PT01)
"RTN","PXRMEXIU",181,0)
 .. S FDA(SFN,IENS,.01)=FINDING
"RTN","PXRMEXIU",182,0)
 . S IEN=+$$VFIND1(FINDING,.ALIST)
"RTN","PXRMEXIU",183,0)
 . I IEN>0 S FDA(SFN,IENS,.01)=ABBR_".`"_IEN
"RTN","PXRMEXIU",184,0)
 . I IEN=0 D
"RTN","PXRMEXIU",185,0)
 ..;Get replacement
"RTN","PXRMEXIU",186,0)
 .. N DIC,DUOUT,ROOT,TEXT,X,Y,YY
"RTN","PXRMEXIU",187,0)
 .. S TEXT(1)=TYPE_" "_FINDING_" does not exist, what do you want to do?"
"RTN","PXRMEXIU",188,0)
 .. D BMES^XPDUTL(.TEXT)
"RTN","PXRMEXIU",189,0)
 .. S ACTION=$$GETACT^PXRMEXIU("DPQ",.DIR)
"RTN","PXRMEXIU",190,0)
 .. I ACTION="Q" K FDA Q
"RTN","PXRMEXIU",191,0)
 .. I ACTION="D" K FDA(SFN,IENS) Q
"RTN","PXRMEXIU",192,0)
 .. S DIC=FILENUM
"RTN","PXRMEXIU",193,0)
 .. S ROOT=$P($$ROOT^DILFD(FILENUM),U,2)
"RTN","PXRMEXIU",194,0)
 .. S DIC("S")="S YY=Y_"";""_ROOT I $$VFINDING^PXRMINTR(YY)"
"RTN","PXRMEXIU",195,0)
 .. S DIC(0)="AEMNQ"
"RTN","PXRMEXIU",196,0)
 .. S Y=-1
"RTN","PXRMEXIU",197,0)
 .. F  Q:+Y'=-1  D
"RTN","PXRMEXIU",198,0)
 ...;If this is being called during a KIDS install we need echoing on.
"RTN","PXRMEXIU",199,0)
 ... I $D(XPDNM) X ^%ZOSF("EON")
"RTN","PXRMEXIU",200,0)
 ... D ^DIC
"RTN","PXRMEXIU",201,0)
 ... I $D(XPDNM) X ^%ZOSF("EOFF")
"RTN","PXRMEXIU",202,0)
 ... I $D(DUOUT) D
"RTN","PXRMEXIU",203,0)
 .... S Y=""
"RTN","PXRMEXIU",204,0)
 .... K FDA
"RTN","PXRMEXIU",205,0)
 .. I Y="" K FDA(SFN,IENS)
"RTN","PXRMEXIU",206,0)
 .. E  D
"RTN","PXRMEXIU",207,0)
 ... S FINDING=ABBR_"."_$P(Y,U,2)
"RTN","PXRMEXIU",208,0)
 ... S FDA(SFN,IENS,.01)=FINDING
"RTN","PXRMEXIU",209,0)
 .;Save the finding information for the history.
"RTN","PXRMEXIU",210,0)
 . S ^TMP("PXRMEXIA",$J,HSUB,$P(IENS,",",1),OFINDING)=FINDING
"RTN","PXRMEXIU",211,0)
 Q
"RTN","PXRMEXIU",212,0)
 ;
"RTN","PXRMEXIU",213,0)
 ;===============================================
"RTN","PXRMEXIU",214,0)
TIUOBJ(FDA) ;Resolve the name of the health summary object.
"RTN","PXRMEXIU",215,0)
 N END,HSOBJIEN,IENS,START,TEMP
"RTN","PXRMEXIU",216,0)
 S IENS=$O(FDA(8925.1,""))
"RTN","PXRMEXIU",217,0)
 S TEMP=$G(FDA(8925.1,IENS,9))
"RTN","PXRMEXIU",218,0)
 I TEMP'["TIU^GMTSOBJ" Q
"RTN","PXRMEXIU",219,0)
 S START=$F(TEMP,"DFN,")
"RTN","PXRMEXIU",220,0)
 S END=$L(TEMP)-1
"RTN","PXRMEXIU",221,0)
 S TEMP=$E(TEMP,START,END)
"RTN","PXRMEXIU",222,0)
 S HSOBJIEN=$O(^GMT(142.5,"B",TEMP,""))
"RTN","PXRMEXIU",223,0)
 I HSOBJIEN="" D  Q
"RTN","PXRMEXIU",224,0)
 . N TEXT
"RTN","PXRMEXIU",225,0)
 . S TEXT(1)="Health Summary Object "_TEMP_" does not exist."
"RTN","PXRMEXIU",226,0)
 . S TEXT(2)="It must be installed before this TIU Health Summary Object can be installed."
"RTN","PXRMEXIU",227,0)
 . S TEXT(3)="Please go back and install it, making sure the corresponding Health Summary"
"RTN","PXRMEXIU",228,0)
 . S TEXT(4)="Type has been installed first."
"RTN","PXRMEXIU",229,0)
 . S TEXT(5)=" "
"RTN","PXRMEXIU",230,0)
 . I '$D(XPDNM) D EN^DDIOL(.TEXT)
"RTN","PXRMEXIU",231,0)
 . I $D(XPDNM) D BMES^XPDUTL(.TEXT)
"RTN","PXRMEXIU",232,0)
 S FDA(8925.1,IENS,9)="S X=$$TIU^GMTSOBJ(DFN,"_HSOBJIEN_")"
"RTN","PXRMEXIU",233,0)
 Q
"RTN","PXRMEXIU",234,0)
 ;
"RTN","PXRMEXIU",235,0)
 ;===============================================
"RTN","PXRMEXIU",236,0)
VDLGFIND(ABBR,IEN,ALIST) ;Determine if the finding item associated with a
"RTN","PXRMEXIU",237,0)
 ;reminder dialog is active returns a 1 if it is inactive returns a 0.
"RTN","PXRMEXIU",238,0)
 N FILENUM
"RTN","PXRMEXIU",239,0)
 S FILENUM=$P(ALIST(ABBR),U,1)
"RTN","PXRMEXIU",240,0)
 Q $$FILESCR^PXRMDLG6(IEN,FILENUM)
"RTN","PXRMEXIU",241,0)
 ;
"RTN","PXRMEXIU",242,0)
 ;===============================================
"RTN","PXRMEXIU",243,0)
VFIND1(VPTR,ALIST) ;Given a variable pointer of the form ABBR.NAME
"RTN","PXRMEXIU",244,0)
 ;and ALIST which contains the link between abbreviations and files
"RTN","PXRMEXIU",245,0)
 ;return the IEN if it exists and 0 if no match if found.
"RTN","PXRMEXIU",246,0)
 N ABBR,IEN,FILENUM,PT01,RESULT
"RTN","PXRMEXIU",247,0)
 S IEN=0
"RTN","PXRMEXIU",248,0)
 S ABBR=$P(VPTR,".",1)
"RTN","PXRMEXIU",249,0)
 S PT01=$P(VPTR,".",2,99)
"RTN","PXRMEXIU",250,0)
 S FILENUM=$P(ALIST(ABBR),U,1)
"RTN","PXRMEXIU",251,0)
 S IEN=$$EXISTS(FILENUM,PT01)
"RTN","PXRMEXIU",252,0)
 Q IEN
"RTN","PXRMEXIU",253,0)
 ;
"RTN","PXRMEXLM")
0^9^B46743705
"RTN","PXRMEXLM",1,0)
PXRMEXLM ;SLC/PKR/PJH - Clinical Reminder Exchange List Manager routines. ;04/19/2012
"RTN","PXRMEXLM",2,0)
 ;;2.0;CLINICAL REMINDERS;**6,12,17,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXLM",3,0)
 ;
"RTN","PXRMEXLM",4,0)
 ;=====================================================
"RTN","PXRMEXLM",5,0)
CRE ;Create a packed reminder and store it in the repository.
"RTN","PXRMEXLM",6,0)
 D FULL^VALM1
"RTN","PXRMEXLM",7,0)
 D CRE^PXRMEXPD
"RTN","PXRMEXLM",8,0)
 S VALMBCK="R"
"RTN","PXRMEXLM",9,0)
 Q
"RTN","PXRMEXLM",10,0)
 ;
"RTN","PXRMEXLM",11,0)
 ;=====================================================
"RTN","PXRMEXLM",12,0)
DEFINQ ;Reminder definition inquiry.
"RTN","PXRMEXLM",13,0)
 N GBL,IEN,PXRMROOT,VALMCNT
"RTN","PXRMEXLM",14,0)
 S GBL="^TMP(""PXRMRINQ"",$J)"
"RTN","PXRMEXLM",15,0)
 S GBL=$NA(@GBL)
"RTN","PXRMEXLM",16,0)
 S PXRMROOT="^PXD(811.9,"
"RTN","PXRMEXLM",17,0)
 S IEN=$$SELECT^PXRMINQ(PXRMROOT,"Select Reminder Definition: ","")
"RTN","PXRMEXLM",18,0)
 S IEN=$P(IEN,U,1)
"RTN","PXRMEXLM",19,0)
 I IEN=-1 S VALMBCK="R" Q
"RTN","PXRMEXLM",20,0)
 K ^TMP("PXRMRINQ",$J)
"RTN","PXRMEXLM",21,0)
 D REMVAR^PXRMINQ(GBL,IEN)
"RTN","PXRMEXLM",22,0)
 S VALMCNT=$O(^TMP("PXRMRINQ",$J,""),-1)
"RTN","PXRMEXLM",23,0)
 D EN^VALM("PXRM EX DEFINITION INQUIRY")
"RTN","PXRMEXLM",24,0)
 K ^TMP("PXRMRINQ",$J)
"RTN","PXRMEXLM",25,0)
 S VALMBCK="R"
"RTN","PXRMEXLM",26,0)
 Q
"RTN","PXRMEXLM",27,0)
 ;
"RTN","PXRMEXLM",28,0)
 ;=====================================================
"RTN","PXRMEXLM",29,0)
ENTRY ;Entry code
"RTN","PXRMEXLM",30,0)
 D INITMPG^PXRMEXLM
"RTN","PXRMEXLM",31,0)
 D BLDLIST^PXRMEXLC(0)
"RTN","PXRMEXLM",32,0)
 D XQORM
"RTN","PXRMEXLM",33,0)
 Q
"RTN","PXRMEXLM",34,0)
 ;
"RTN","PXRMEXLM",35,0)
 ;=====================================================
"RTN","PXRMEXLM",36,0)
EXIT ;Exit code
"RTN","PXRMEXLM",37,0)
 D INITMPG^PXRMEXLM
"RTN","PXRMEXLM",38,0)
 D CLEAN^VALM10
"RTN","PXRMEXLM",39,0)
 D FULL^VALM1
"RTN","PXRMEXLM",40,0)
 S VALMBCK="Q"
"RTN","PXRMEXLM",41,0)
 K PXRMIGDS,PXRMINST
"RTN","PXRMEXLM",42,0)
 Q
"RTN","PXRMEXLM",43,0)
 ;
"RTN","PXRMEXLM",44,0)
 ;=====================================================
"RTN","PXRMEXLM",45,0)
HDR ; Header code
"RTN","PXRMEXLM",46,0)
 S VALMHDR(1)="Exchange File Entries."
"RTN","PXRMEXLM",47,0)
 S VALMSG="+ Next Screen   - Prev Screen   ?? More Actions"
"RTN","PXRMEXLM",48,0)
 Q
"RTN","PXRMEXLM",49,0)
 ;
"RTN","PXRMEXLM",50,0)
 ;=====================================================
"RTN","PXRMEXLM",51,0)
HELP ;Help code
"RTN","PXRMEXLM",52,0)
 ;The following variables have to be newed so that when we return
"RTN","PXRMEXLM",53,0)
 ;from the help display they will be defined.
"RTN","PXRMEXLM",54,0)
 N ORU,ORUPRMT,XQORM
"RTN","PXRMEXLM",55,0)
 D EN^VALM("PXRM EX MAIN HELP")
"RTN","PXRMEXLM",56,0)
 Q
"RTN","PXRMEXLM",57,0)
 ;
"RTN","PXRMEXLM",58,0)
 ;=====================================================
"RTN","PXRMEXLM",59,0)
INIT ;Init
"RTN","PXRMEXLM",60,0)
 S VALMCNT=0
"RTN","PXRMEXLM",61,0)
 Q
"RTN","PXRMEXLM",62,0)
 ;
"RTN","PXRMEXLM",63,0)
 ;=====================================================
"RTN","PXRMEXLM",64,0)
INITMPG ;Initialized all the ^TMP globals.
"RTN","PXRMEXLM",65,0)
 K ^TMP("PXRMEXDH",$J)
"RTN","PXRMEXLM",66,0)
 K ^TMP("PXRMEXDGH",$J)
"RTN","PXRMEXLM",67,0)
 K ^TMP("PXRMEXDL",$J)
"RTN","PXRMEXLM",68,0)
 K ^TMP("PXRMEXHF",$J)
"RTN","PXRMEXLM",69,0)
 K ^TMP("PXRMEXFND",$J)
"RTN","PXRMEXLM",70,0)
 K ^TMP("PXRMEXIA",$J)
"RTN","PXRMEXLM",71,0)
 K ^TMP("PXRMEXIAD",$J)
"RTN","PXRMEXLM",72,0)
 K ^TMP("PXRMEXID",$J)
"RTN","PXRMEXLM",73,0)
 K ^TMP("PXRMEXIH",$J)
"RTN","PXRMEXLM",74,0)
 K ^TMP("PXRMEXLC",$J)
"RTN","PXRMEXLM",75,0)
 K ^TMP("PXRMEXLD",$J)
"RTN","PXRMEXLM",76,0)
 K ^TMP("PXRMEXLHF",$J)
"RTN","PXRMEXLM",77,0)
 K ^TMP("PXRMEXLMM",$J)
"RTN","PXRMEXLM",78,0)
 K ^TMP("PXRMEXLR",$J)
"RTN","PXRMEXLM",79,0)
 K ^TMP("PXRMEXMH",$J)
"RTN","PXRMEXLM",80,0)
 K ^TMP("PXRMEXMM",$J)
"RTN","PXRMEXLM",81,0)
 K ^TMP("PXRMEXRI",$J)
"RTN","PXRMEXLM",82,0)
 K ^TMP("PXRMEXTMP",$J)
"RTN","PXRMEXLM",83,0)
 K ^TMP("PXRMEXTXT",$J)
"RTN","PXRMEXLM",84,0)
 K ^TMP($J,"HS TYPE")
"RTN","PXRMEXLM",85,0)
 K ^TMP($J,"HS OBJECT")
"RTN","PXRMEXLM",86,0)
 K ^TMP($J,"TIU OBJECT")
"RTN","PXRMEXLM",87,0)
 K ^TMP($J,"ORDER DIALOG")
"RTN","PXRMEXLM",88,0)
 Q
"RTN","PXRMEXLM",89,0)
 ;
"RTN","PXRMEXLM",90,0)
 ;=====================================================
"RTN","PXRMEXLM",91,0)
LDHF ;Load a host file into the repository.
"RTN","PXRMEXLM",92,0)
 N IND,FILE,PATH,RBL,SUCCESS,TEMP
"RTN","PXRMEXLM",93,0)
 ;Select the host file to load.
"RTN","PXRMEXLM",94,0)
 D CLEAR^VALM1
"RTN","PXRMEXLM",95,0)
 S TEMP=$$GETEHF^PXRMEXHF("PRD")
"RTN","PXRMEXLM",96,0)
 I TEMP="" S VALMBCK="R" Q
"RTN","PXRMEXLM",97,0)
 S PATH=$P(TEMP,U,1)
"RTN","PXRMEXLM",98,0)
 S FILE=$P(TEMP,U,2)
"RTN","PXRMEXLM",99,0)
 D LHF^PXRMEXHF(.SUCCESS,PATH,FILE)
"RTN","PXRMEXLM",100,0)
 S RBL=SUCCESS
"RTN","PXRMEXLM",101,0)
 I SUCCESS D
"RTN","PXRMEXLM",102,0)
 . S VALMHDR(1)="Host file "_PATH_FILE_" successfully loaded."
"RTN","PXRMEXLM",103,0)
 E  D
"RTN","PXRMEXLM",104,0)
 . S VALMHDR(1)="There were problems loading host file "_PATH_FILE_"."
"RTN","PXRMEXLM",105,0)
 . S TEMP=""
"RTN","PXRMEXLM",106,0)
 . S IND=""
"RTN","PXRMEXLM",107,0)
 . F  S IND=$O(SUCCESS(IND)) Q:+IND=0  D
"RTN","PXRMEXLM",108,0)
 .. I SUCCESS(IND) S RBL=1 Q
"RTN","PXRMEXLM",109,0)
 .. I +$O(SUCCESS(IND))=0 S TEMP=TEMP_IND
"RTN","PXRMEXLM",110,0)
 .. E  S TEMP=TEMP_IND_", "
"RTN","PXRMEXLM",111,0)
 . S VALMHDR(2)="Entries with problems were "_TEMP_"."
"RTN","PXRMEXLM",112,0)
 ;Rebuild the list for display.
"RTN","PXRMEXLM",113,0)
 D BLDLIST^PXRMEXLC(RBL)
"RTN","PXRMEXLM",114,0)
 S VALMBCK="R"
"RTN","PXRMEXLM",115,0)
 Q
"RTN","PXRMEXLM",116,0)
 ;
"RTN","PXRMEXLM",117,0)
 ;=====================================================
"RTN","PXRMEXLM",118,0)
LDMM ;Load a MailMan message into the repository.
"RTN","PXRMEXLM",119,0)
 N IND,RBL,TEMP,XMZ
"RTN","PXRMEXLM",120,0)
 ;Select the MailMan message to load.
"RTN","PXRMEXLM",121,0)
 D CLEAR^VALM1
"RTN","PXRMEXLM",122,0)
 S XMZ=$$GETMESSN^PXRMEXMM
"RTN","PXRMEXLM",123,0)
 I XMZ=-1 W !,"No packed reminder definitions selected/found!" H 2
"RTN","PXRMEXLM",124,0)
 I +XMZ'>0 S VALMBCK="R" Q
"RTN","PXRMEXLM",125,0)
 D LMM^PXRMEXMM(.SUCCESS,XMZ)
"RTN","PXRMEXLM",126,0)
 S RBL=SUCCESS
"RTN","PXRMEXLM",127,0)
 I SUCCESS D
"RTN","PXRMEXLM",128,0)
 . S VALMHDR(1)="MailMan message "_XMZ_" successfully loaded."
"RTN","PXRMEXLM",129,0)
 .;Rebuild the list for display.
"RTN","PXRMEXLM",130,0)
 . D BLDLIST^PXRMEXLC(1)
"RTN","PXRMEXLM",131,0)
 E  D
"RTN","PXRMEXLM",132,0)
 . S VALMHDR(1)="There were problems loading MailMan message "_XMZ_"."
"RTN","PXRMEXLM",133,0)
 . S TEMP=""
"RTN","PXRMEXLM",134,0)
 . S IND=""
"RTN","PXRMEXLM",135,0)
 . F  S IND=$O(SUCCESS(IND)) Q:+IND=0  D
"RTN","PXRMEXLM",136,0)
 .. I SUCCESS(IND) S RBL=1 Q
"RTN","PXRMEXLM",137,0)
 .. I +$O(SUCCESS(IND))=0 S TEMP=TEMP_IND
"RTN","PXRMEXLM",138,0)
 .. E  S TEMP=TEMP_IND_", "
"RTN","PXRMEXLM",139,0)
 . S VALMHDR(2)="Entries with problems were "_TEMP_"."
"RTN","PXRMEXLM",140,0)
 ;Rebuild the list for display.
"RTN","PXRMEXLM",141,0)
 D BLDLIST^PXRMEXLC(RBL)
"RTN","PXRMEXLM",142,0)
 S VALMBCK="R"
"RTN","PXRMEXLM",143,0)
 Q
"RTN","PXRMEXLM",144,0)
 ;
"RTN","PXRMEXLM",145,0)
 ;=====================================================
"RTN","PXRMEXLM",146,0)
LRDEF ;List the name and print name of all reminder definitions.
"RTN","PXRMEXLM",147,0)
 N VALMCNT
"RTN","PXRMEXLM",148,0)
 I $D(^TMP("PXRMEXLD",$J,"VALMCNT")) S VALMCNT=^TMP("PXRMEXLD",$J,"VALMCNT")
"RTN","PXRMEXLM",149,0)
 E  D
"RTN","PXRMEXLM",150,0)
 . N ARO,DEFLIST
"RTN","PXRMEXLM",151,0)
 . S ARO=$$QUERYAO^PXRMLIST
"RTN","PXRMEXLM",152,0)
 . S ^TMP("PXRMEXLD",$J,"ARO")=ARO
"RTN","PXRMEXLM",153,0)
 . D RDEF^PXRMLIST(.DEFLIST,ARO)
"RTN","PXRMEXLM",154,0)
 . M ^TMP("PXRMEXLD",$J)=DEFLIST
"RTN","PXRMEXLM",155,0)
 . S VALMCNT=DEFLIST("VALMCNT")
"RTN","PXRMEXLM",156,0)
 I '$G(^TMP("PXRMEXLD",$J,"ARO")) D CHGCAP^VALM("INACTIVE","Inactive")
"RTN","PXRMEXLM",157,0)
 D EN^VALM("PXRM EX REMINDER LIST")
"RTN","PXRMEXLM",158,0)
 Q
"RTN","PXRMEXLM",159,0)
 ;
"RTN","PXRMEXLM",160,0)
 ;=====================================================
"RTN","PXRMEXLM",161,0)
PEXIT ;PXRM EXCH MENU protocol exit code
"RTN","PXRMEXLM",162,0)
 S VALMSG="+ Next Screen   - Prev Screen   ?? More Actions"
"RTN","PXRMEXLM",163,0)
 ;Reset after page up/down etc
"RTN","PXRMEXLM",164,0)
 D XQORM
"RTN","PXRMEXLM",165,0)
 Q
"RTN","PXRMEXLM",166,0)
 ;
"RTN","PXRMEXLM",167,0)
 ;=====================================================
"RTN","PXRMEXLM",168,0)
START ;Main entry point for PXRM EXCHANGE
"RTN","PXRMEXLM",169,0)
 N PXRMDONE,PXRMNMCH
"RTN","PXRMEXLM",170,0)
 ;PXRMDONE is set to true if the user enters an action of Quit.
"RTN","PXRMEXLM",171,0)
 S PXRMDONE=0
"RTN","PXRMEXLM",172,0)
 ;PXRMNMCH is used to store name change information. If a finding
"RTN","PXRMEXLM",173,0)
 ;is copied to a new name or is replaced by another finding the
"RTN","PXRMEXLM",174,0)
 ;information is stored here. It is used when installing definitions
"RTN","PXRMEXLM",175,0)
 ;or dialogs so they use the new or replaced finding.
"RTN","PXRMEXLM",176,0)
 N VALMBCK,VALMSG,X,XMZ
"RTN","PXRMEXLM",177,0)
 S X="IORESET"
"RTN","PXRMEXLM",178,0)
 D ENDR^%ZISS
"RTN","PXRMEXLM",179,0)
 D EN^VALM("PXRM EX REMINDER EXCHANGE")
"RTN","PXRMEXLM",180,0)
 W IORESET
"RTN","PXRMEXLM",181,0)
 D KILL^%ZISS
"RTN","PXRMEXLM",182,0)
 Q
"RTN","PXRMEXLM",183,0)
 ;
"RTN","PXRMEXLM",184,0)
 ;=====================================================
"RTN","PXRMEXLM",185,0)
XQORM S XQORM("#")=$O(^ORD(101,"B","PXRM EXCH SELECT ENTRY",0))_U_"1:"_VALMCNT
"RTN","PXRMEXLM",186,0)
 S XQORM("A")="Select Action: "
"RTN","PXRMEXLM",187,0)
 Q
"RTN","PXRMEXLM",188,0)
 ;
"RTN","PXRMEXLM",189,0)
 ;=====================================================
"RTN","PXRMEXLM",190,0)
XSEL ;PXRM EXCH SELECT COMPONENT validation
"RTN","PXRMEXLM",191,0)
 N SEL,PXRMRIEN
"RTN","PXRMEXLM",192,0)
 S SEL=$P(XQORNOD(0),"=",2)
"RTN","PXRMEXLM",193,0)
 ;Remove trailing ,
"RTN","PXRMEXLM",194,0)
 I $E(SEL,$L(SEL))="," S SEL=$E(SEL,1,$L(SEL)-1)
"RTN","PXRMEXLM",195,0)
 ;Invalid selection
"RTN","PXRMEXLM",196,0)
 I SEL["," D  Q
"RTN","PXRMEXLM",197,0)
 .W $C(7),!,"Only one item number allowed." H 2
"RTN","PXRMEXLM",198,0)
 .S VALMBCK="R"
"RTN","PXRMEXLM",199,0)
 I ('SEL)!(SEL>VALMCNT)!('$D(@VALMAR@("SEL",SEL))) D  Q
"RTN","PXRMEXLM",200,0)
 .W $C(7),!,SEL_" is not a valid item number." H 2
"RTN","PXRMEXLM",201,0)
 .S VALMBCK="R"
"RTN","PXRMEXLM",202,0)
 ;
"RTN","PXRMEXLM",203,0)
 ;Get the repository ien.
"RTN","PXRMEXLM",204,0)
 S PXRMRIEN=^TMP("PXRMEXLR",$J,"SEL",SEL)
"RTN","PXRMEXLM",205,0)
 ;
"RTN","PXRMEXLM",206,0)
 ;Full screen mode
"RTN","PXRMEXLM",207,0)
 D FULL^VALM1
"RTN","PXRMEXLM",208,0)
 ;
"RTN","PXRMEXLM",209,0)
 ;Option to Install, Delete or Install History
"RTN","PXRMEXLM",210,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,OPTION,X,Y
"RTN","PXRMEXLM",211,0)
 S DIR(0)="SBM"_U_"IFE:Install Exchange File Entry;"
"RTN","PXRMEXLM",212,0)
 S DIR(0)=DIR(0)_"DFE:Delete Exchange File Entry;"
"RTN","PXRMEXLM",213,0)
 S DIR(0)=DIR(0)_"IH:Installation History;"
"RTN","PXRMEXLM",214,0)
 S DIR("A")="Select Action: "
"RTN","PXRMEXLM",215,0)
 S DIR("B")="IFE"
"RTN","PXRMEXLM",216,0)
 S DIR("?")="Select from the codes displayed. For detailed help type ??"
"RTN","PXRMEXLM",217,0)
 S DIR("??")=U_"D HLP^PXRMEXIX(3)"
"RTN","PXRMEXLM",218,0)
 D ^DIR
"RTN","PXRMEXLM",219,0)
 I $D(DIROUT)!$D(DIRUT) S VALMBCK="R" Q
"RTN","PXRMEXLM",220,0)
 I $D(DTOUT)!$D(DUOUT) S VALMBCK="R" Q
"RTN","PXRMEXLM",221,0)
 S OPTION=Y
"RTN","PXRMEXLM",222,0)
 ;
"RTN","PXRMEXLM",223,0)
 ;Install
"RTN","PXRMEXLM",224,0)
 I OPTION="IFE" D
"RTN","PXRMEXLM",225,0)
 .D EN^VALM("PXRM EX LIST COMPONENTS")
"RTN","PXRMEXLM",226,0)
 .K ^TMP("PXRMEXLC",$J)
"RTN","PXRMEXLM",227,0)
 ;
"RTN","PXRMEXLM",228,0)
 I OPTION="DFE" D
"RTN","PXRMEXLM",229,0)
 .N COUNT,DELLIST,IEN,IND,RELIST,VALMY
"RTN","PXRMEXLM",230,0)
 .S DELLIST(PXRMRIEN)=""
"RTN","PXRMEXLM",231,0)
 .D DELETE^PXRMEXU1(.DELLIST)
"RTN","PXRMEXLM",232,0)
 .;Rebuild the list for List Manager to display.
"RTN","PXRMEXLM",233,0)
 .K ^TMP("PXRMEXLR",$J)
"RTN","PXRMEXLM",234,0)
 .D REXL^PXRMLIST("PXRMEXLR")
"RTN","PXRMEXLM",235,0)
 .S VALMCNT=^TMP("PXRMEXLR",$J,"VALMCNT")
"RTN","PXRMEXLM",236,0)
 .S VALMHDR(1)="Deleted 1 exchange file entry",VALMHDR(2)=" ",VALMBCK="R"
"RTN","PXRMEXLM",237,0)
 ;
"RTN","PXRMEXLM",238,0)
 I OPTION="IH" D START^PXRMEXIH
"RTN","PXRMEXLM",239,0)
 ;
"RTN","PXRMEXLM",240,0)
 S VALMBCK="R"
"RTN","PXRMEXLM",241,0)
 Q
"RTN","PXRMEXLM",242,0)
 ;
"RTN","PXRMEXPS")
0^20^B192149462
"RTN","PXRMEXPS",1,0)
PXRMEXPS ; SLC/PKR - Packing save routines. ;08/23/2012
"RTN","PXRMEXPS",2,0)
 ;;2.0;CLINICAL REMINDERS;**12,16,18,22,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXPS",3,0)
 ;==========================================
"RTN","PXRMEXPS",4,0)
ADD(FILENUM,IEN,PACKLIST,NF) ;
"RTN","PXRMEXPS",5,0)
 S NF=+$O(PACKLIST(FILENUM,"IEN"),-1)+1
"RTN","PXRMEXPS",6,0)
 S PACKLIST(FILENUM,NF)=IEN
"RTN","PXRMEXPS",7,0)
 S PACKLIST(FILENUM,"IEN",IEN)=NF
"RTN","PXRMEXPS",8,0)
 Q
"RTN","PXRMEXPS",9,0)
 ;
"RTN","PXRMEXPS",10,0)
 ;==========================================
"RTN","PXRMEXPS",11,0)
CHKCF(ROOT,TOPIEN,GBL,PACKLIST) ;
"RTN","PXRMEXPS",12,0)
 N IEN,NAME,NUM,PARM,RIEN,ROUTINE
"RTN","PXRMEXPS",13,0)
 S IEN=""
"RTN","PXRMEXPS",14,0)
 F  S IEN=$O(@ROOT@(TOPIEN,20,"E",GBL,IEN)) Q:IEN=""  D
"RTN","PXRMEXPS",15,0)
 . I $P($G(^PXRMD(811.4,IEN,0)),U,1)'="VA-REMINDER DEFINITION" Q
"RTN","PXRMEXPS",16,0)
 . S NUM=$O(@ROOT@(TOPIEN,20,"E",GBL,IEN,"")) Q:NUM'>0
"RTN","PXRMEXPS",17,0)
 . S PARM=$P($G(@ROOT@(TOPIEN,20,NUM,15)),U,1)
"RTN","PXRMEXPS",18,0)
 . S NAME=$P(PARM,U,1)
"RTN","PXRMEXPS",19,0)
 . S RIEN=$O(^PXD(811.9,"B",NAME,"")) Q:RIEN'>0
"RTN","PXRMEXPS",20,0)
 . S ROUTINE=$$GETSRTN(811.9)_"(811.9,RIEN,.PACKLIST)"
"RTN","PXRMEXPS",21,0)
 . D @ROUTINE
"RTN","PXRMEXPS",22,0)
 Q
"RTN","PXRMEXPS",23,0)
 ;
"RTN","PXRMEXPS",24,0)
 ;==========================================
"RTN","PXRMEXPS",25,0)
EXISTS(FILENUM,IEN,PACKLIST) ;If the entry already exists remove it
"RTN","PXRMEXPS",26,0)
 ;and keep only the higher entry.
"RTN","PXRMEXPS",27,0)
 I '$D(PACKLIST(FILENUM,"IEN",IEN)) Q
"RTN","PXRMEXPS",28,0)
 N NUM
"RTN","PXRMEXPS",29,0)
 S NUM=PACKLIST(FILENUM,"IEN",IEN)
"RTN","PXRMEXPS",30,0)
 K PACKLIST(FILENUM,NUM)
"RTN","PXRMEXPS",31,0)
 Q
"RTN","PXRMEXPS",32,0)
 ;
"RTN","PXRMEXPS",33,0)
 ;==========================================
"RTN","PXRMEXPS",34,0)
GEDSUB(EDUIEN,NSUB,LIST) ;Build the recursive list of education topic
"RTN","PXRMEXPS",35,0)
 ;subtopics.
"RTN","PXRMEXPS",36,0)
 ;DBIA #3085
"RTN","PXRMEXPS",37,0)
 N IND,SUBIEN
"RTN","PXRMEXPS",38,0)
 S IND=0
"RTN","PXRMEXPS",39,0)
 F  S IND=+$O(^AUTTEDT(EDUIEN,10,IND)) Q:IND=0  D
"RTN","PXRMEXPS",40,0)
 . S NSUB=NSUB+1
"RTN","PXRMEXPS",41,0)
 . S SUBIEN=$P(^AUTTEDT(EDUIEN,10,IND,0),U,1)
"RTN","PXRMEXPS",42,0)
 . S LIST(NSUB)=SUBIEN
"RTN","PXRMEXPS",43,0)
 . D GEDSUB(SUBIEN,.NSUB,.LIST)
"RTN","PXRMEXPS",44,0)
 Q
"RTN","PXRMEXPS",45,0)
 ;
"RTN","PXRMEXPS",46,0)
 ;==========================================
"RTN","PXRMEXPS",47,0)
GETFNUM(GBL) ;Return the file number for a global.
"RTN","PXRMEXPS",48,0)
 S GBL="^"_GBL_"0)"
"RTN","PXRMEXPS",49,0)
 Q +$P(@GBL,U,2)
"RTN","PXRMEXPS",50,0)
 ;
"RTN","PXRMEXPS",51,0)
 ;==========================================
"RTN","PXRMEXPS",52,0)
GETSRTN(FILENUM) ;Return the save routine according to the file number.
"RTN","PXRMEXPS",53,0)
 I FILENUM=50 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",54,0)
 I FILENUM=50.6 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",55,0)
 I FILENUM=50.605 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",56,0)
 I FILENUM=60 Q "SLT^PXRMEXPS"
"RTN","PXRMEXPS",57,0)
 I FILENUM=71 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",58,0)
 I FILENUM=80 Q "NOSAVE^PXRMEXPS"
"RTN","PXRMEXPS",59,0)
 I FILENUM=80.1 Q "NOSAVE^PXRMEXPS"
"RTN","PXRMEXPS",60,0)
 I FILENUM=81 Q "NOSAVE^PXRMEXPS"
"RTN","PXRMEXPS",61,0)
 I FILENUM=101.41 Q "SODIALOG^PXRMEXPS"
"RTN","PXRMEXPS",62,0)
 I FILENUM=101.43 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",63,0)
 I FILENUM=120.51 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",64,0)
 I FILENUM=142 Q "SHST^PXRMEXPS"
"RTN","PXRMEXPS",65,0)
 I FILENUM=142.1 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",66,0)
 I FILENUM=142.5 Q "SHSO^PXRMEXPS"
"RTN","PXRMEXPS",67,0)
 I FILENUM=601.71 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",68,0)
 I FILENUM=790.404 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",69,0)
 I FILENUM=801 Q "SROC^PXRMEXPS"
"RTN","PXRMEXPS",70,0)
 I FILENUM=801.1 Q "SRULE^PXRMEXPS"
"RTN","PXRMEXPS",71,0)
 I FILENUM=801.41 Q "SDIALOG^PXRMEXPS"
"RTN","PXRMEXPS",72,0)
 I FILENUM=810.2 Q "SEDEF^PXRMEXPS"
"RTN","PXRMEXPS",73,0)
 I FILENUM=810.4 Q "SLR^PXRMEXPS"
"RTN","PXRMEXPS",74,0)
 I FILENUM=810.7 Q "SRECR^PXRMEXPS"
"RTN","PXRMEXPS",75,0)
 I FILENUM=810.8 Q "SRCG^PXRMEXPS"
"RTN","PXRMEXPS",76,0)
 I FILENUM=810.9 Q "SLL^PXRMEXPS"
"RTN","PXRMEXPS",77,0)
 I FILENUM=811.2 Q "SGENR^PXRMEXPS"
"RTN","PXRMEXPS",78,0)
 I FILENUM=811.4 Q "SCF^PXRMEXPS"
"RTN","PXRMEXPS",79,0)
 I FILENUM=811.5 Q "SRT^PXRMEXPS"
"RTN","PXRMEXPS",80,0)
 I FILENUM=811.6 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",81,0)
 I FILENUM=811.9 Q "SDEF^PXRMEXPS"
"RTN","PXRMEXPS",82,0)
 I FILENUM=8925.1 Q "STIUOBJ^PXRMEXPS"
"RTN","PXRMEXPS",83,0)
 I FILENUM=8927.1 Q "STIUTEMP^PXRMEXPS"
"RTN","PXRMEXPS",84,0)
 I FILENUM=9999999.09 Q "SED^PXRMEXPS"
"RTN","PXRMEXPS",85,0)
 I FILENUM=9999999.14 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",86,0)
 I FILENUM=9999999.15 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",87,0)
 I FILENUM=9999999.28 Q "SGEN^PXRMEXPS"
"RTN","PXRMEXPS",88,0)
 I FILENUM=9999999.64 Q "SHF^PXRMEXPS"
"RTN","PXRMEXPS",89,0)
 Q "NORTN^PXRMEXPS"
"RTN","PXRMEXPS",90,0)
 ;
"RTN","PXRMEXPS",91,0)
 ;==========================================
"RTN","PXRMEXPS",92,0)
NORTN(FILENUM,IEN,PACKLIST) ;Don't have a routine for this file number.
"RTN","PXRMEXPS",93,0)
 S NF=+$O(PACKLIST(FILENUM,"IEN"),-1)+1
"RTN","PXRMEXPS",94,0)
 S PACKLIST(FILENUM,NF)=IEN
"RTN","PXRMEXPS",95,0)
 S PACKLIST(FILENUM,"IEN",IEN)=NF
"RTN","PXRMEXPS",96,0)
 S PACKLIST(FILENUM,"ERROR",IEN)="No packing routine for file number "_FILENUM_"."
"RTN","PXRMEXPS",97,0)
 Q
"RTN","PXRMEXPS",98,0)
 ;
"RTN","PXRMEXPS",99,0)
 ;==========================================
"RTN","PXRMEXPS",100,0)
NOSAVE(FILENUM,IEN,PACKLIST) ;Don't do anything for this file number.
"RTN","PXRMEXPS",101,0)
 Q
"RTN","PXRMEXPS",102,0)
 ;
"RTN","PXRMEXPS",103,0)
 ;==========================================
"RTN","PXRMEXPS",104,0)
SCF(FILENUM,IEN,PACKLIST) ;Reminder computed findings.
"RTN","PXRMEXPS",105,0)
 N CFRTN
"RTN","PXRMEXPS",106,0)
 ;Add the computed finding file entry.
"RTN","PXRMEXPS",107,0)
 D SGENR(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",108,0)
 S CFRTN=$P(^PXRMD(811.4,IEN,0),U,2)
"RTN","PXRMEXPS",109,0)
 ;Add the routine; mark routines with file number 0.
"RTN","PXRMEXPS",110,0)
 D SGEN(0,CFRTN,.PACKLIST)
"RTN","PXRMEXPS",111,0)
 Q
"RTN","PXRMEXPS",112,0)
 ;
"RTN","PXRMEXPS",113,0)
 ;==========================================
"RTN","PXRMEXPS",114,0)
SDEF(FILENUM,RIEN,PACKLIST) ;Reminder definitions.
"RTN","PXRMEXPS",115,0)
 N DIALOG,ENODE,EO,FINDING,FINUM,FNUM,GBL,IEN,NF,ROUTINE,SPON
"RTN","PXRMEXPS",116,0)
 D SGENR(FILENUM,RIEN,.PACKLIST)
"RTN","PXRMEXPS",117,0)
 ;Process the finding multiple.
"RTN","PXRMEXPS",118,0)
 S FINUM=0
"RTN","PXRMEXPS",119,0)
 F  S FINUM=+$O(^PXD(811.9,RIEN,20,FINUM)) Q:FINUM=0  D
"RTN","PXRMEXPS",120,0)
 . S FINDING=$P(^PXD(811.9,RIEN,20,FINUM,0),U,1)
"RTN","PXRMEXPS",121,0)
 . S IEN=$P(FINDING,";",1)
"RTN","PXRMEXPS",122,0)
 . S GBL=$P(FINDING,";",2)
"RTN","PXRMEXPS",123,0)
 . S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",124,0)
 . I FNUM=811.4 D CHKCF("^PXD(811.9)",RIEN,GBL,.PACKLIST)
"RTN","PXRMEXPS",125,0)
 . S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,IEN,.PACKLIST)"
"RTN","PXRMEXPS",126,0)
 . D @ROUTINE
"RTN","PXRMEXPS",127,0)
 ;Dialog
"RTN","PXRMEXPS",128,0)
 S DIALOG=+$G(^PXD(811.9,RIEN,51))
"RTN","PXRMEXPS",129,0)
 I DIALOG>0,'$D(PACKLIST(801.41,"IEN",DIALOG)) D SDIALOG(801.41,DIALOG,.PACKLIST)
"RTN","PXRMEXPS",130,0)
 Q
"RTN","PXRMEXPS",131,0)
 ;
"RTN","PXRMEXPS",132,0)
 ;==========================================
"RTN","PXRMEXPS",133,0)
SDIALOG(FILENUM,DIEN,PACKLIST) ;Reminder dialogs.
"RTN","PXRMEXPS",134,0)
 I DIEN'>0 Q
"RTN","PXRMEXPS",135,0)
 N IEN,IND,FI,FNUM,GBL,MHT,OI,OLIST,REG,ROUTINE,TEMP,TERM,TLIST
"RTN","PXRMEXPS",136,0)
 D SGENR(FILENUM,DIEN,.PACKLIST)
"RTN","PXRMEXPS",137,0)
 ;Get the source reminder.
"RTN","PXRMEXPS",138,0)
 S IEN=$P(^PXRMD(801.41,DIEN,0),U,2)
"RTN","PXRMEXPS",139,0)
 I IEN'="" D
"RTN","PXRMEXPS",140,0)
 . S ROUTINE=$$GETSRTN(811.9)_"(811.9,IEN,.PACKLIST)"
"RTN","PXRMEXPS",141,0)
 . D @ROUTINE
"RTN","PXRMEXPS",142,0)
 ;Check for a finding item.
"RTN","PXRMEXPS",143,0)
 S TEMP=$G(^PXRMD(801.41,DIEN,1))
"RTN","PXRMEXPS",144,0)
 S FI=$P(TEMP,U,5)
"RTN","PXRMEXPS",145,0)
 I FI'="" D
"RTN","PXRMEXPS",146,0)
 . S IEN=$P(FI,";",1)
"RTN","PXRMEXPS",147,0)
 . S GBL=$P(FI,";",2)
"RTN","PXRMEXPS",148,0)
 . S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",149,0)
 . S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,IEN,.PACKLIST)"
"RTN","PXRMEXPS",150,0)
 . D @ROUTINE
"RTN","PXRMEXPS",151,0)
 ;Check for an orderable item.
"RTN","PXRMEXPS",152,0)
 S OI=$P(TEMP,U,7)
"RTN","PXRMEXPS",153,0)
 I OI'="" D
"RTN","PXRMEXPS",154,0)
 . S ROUTINE=$$GETSRTN(101.43)_"(101.43,OI,.PACKLIST)"
"RTN","PXRMEXPS",155,0)
 . D @ROUTINE
"RTN","PXRMEXPS",156,0)
 ;Check for additional findings.
"RTN","PXRMEXPS",157,0)
 S IND=0
"RTN","PXRMEXPS",158,0)
 F  S IND=+$O(^PXRMD(801.41,DIEN,3,IND)) Q:IND=0  D
"RTN","PXRMEXPS",159,0)
 . S FI=$P(^PXRMD(801.41,DIEN,3,IND,0),U,1)
"RTN","PXRMEXPS",160,0)
 . S IEN=$P(FI,";",1)
"RTN","PXRMEXPS",161,0)
 . S GBL=$P(FI,";",2)
"RTN","PXRMEXPS",162,0)
 . S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",163,0)
 . S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,IEN,.PACKLIST)"
"RTN","PXRMEXPS",164,0)
 . D @ROUTINE
"RTN","PXRMEXPS",165,0)
 ;Check word processing fields for TIU Object and Template Fields
"RTN","PXRMEXPS",166,0)
 D TIUSRCH^PXRMEXU1("^PXRMD(801.41,",DIEN,25,.OLIST,.TLIST)
"RTN","PXRMEXPS",167,0)
 I $D(OLIST)>0 D
"RTN","PXRMEXPS",168,0)
 . S ROUTINE=$$GETSRTN(8925.1)_"(8925.1,.OLIST,.PACKLIST)"
"RTN","PXRMEXPS",169,0)
 . D @ROUTINE K OLIST
"RTN","PXRMEXPS",170,0)
 I $D(TLIST)>0 D
"RTN","PXRMEXPS",171,0)
 . S ROUTINE=$$GETSRTN(8927.1)_"(8927.1,.TLIST,.PACKLIST)"
"RTN","PXRMEXPS",172,0)
 . D @ROUTINE K TLIST
"RTN","PXRMEXPS",173,0)
 D TIUSRCH^PXRMEXU1("^PXRMD(801.41,",DIEN,35,.OLIST,.TLIST)
"RTN","PXRMEXPS",174,0)
 I $D(OLIST)>0 D
"RTN","PXRMEXPS",175,0)
 . S ROUTINE=$$GETSRTN(8925.1)_"(8925.1,.OLIST,.PACKLIST)"
"RTN","PXRMEXPS",176,0)
 . D @ROUTINE K OLIST
"RTN","PXRMEXPS",177,0)
 I $D(TLIST)>0 D
"RTN","PXRMEXPS",178,0)
 . S ROUTINE=$$GETSRTN(8927.1)_"(8927.1,.TLIST,.PACKLIST)"
"RTN","PXRMEXPS",179,0)
 . D @ROUTINE K TLIST
"RTN","PXRMEXPS",180,0)
 ;Check the components multiple for elements.
"RTN","PXRMEXPS",181,0)
 I $D(^PXRMD(801.41,DIEN,10)) D
"RTN","PXRMEXPS",182,0)
 . S ROUTINE=$$GETSRTN(801.41)_"(801.41,IEN,.PACKLIST)"
"RTN","PXRMEXPS",183,0)
 . S IND=0
"RTN","PXRMEXPS",184,0)
 . F  S IND=+$O(^PXRMD(801.41,DIEN,10,IND)) Q:IND=0  D
"RTN","PXRMEXPS",185,0)
 .. S IEN=$P(^PXRMD(801.41,DIEN,10,IND,0),U,2)
"RTN","PXRMEXPS",186,0)
 .. D @ROUTINE
"RTN","PXRMEXPS",187,0)
 ;Check for a term and a replacement element/group.
"RTN","PXRMEXPS",188,0)
 S TEMP=$G(^PXRMD(801.41,DIEN,49))
"RTN","PXRMEXPS",189,0)
 S TERM=$P(TEMP,U,1)
"RTN","PXRMEXPS",190,0)
 I TERM'="" D
"RTN","PXRMEXPS",191,0)
 . S ROUTINE=$$GETSRTN(811.5)_"(811.5,TERM,.PACKLIST)"
"RTN","PXRMEXPS",192,0)
 . D @ROUTINE
"RTN","PXRMEXPS",193,0)
 S REG=$P(TEMP,U,3)
"RTN","PXRMEXPS",194,0)
 I REG'="" D
"RTN","PXRMEXPS",195,0)
 . S ROUTINE=$$GETSRTN(801.41)_"(801.41,REG,.PACKLIST)"
"RTN","PXRMEXPS",196,0)
 . D @ROUTINE
"RTN","PXRMEXPS",197,0)
 ;Check for a mental health test.
"RTN","PXRMEXPS",198,0)
 S MHT=$P($G(^PXRMD(801.41,DIEN,50)),U,1)
"RTN","PXRMEXPS",199,0)
 I MHT'="" D
"RTN","PXRMEXPS",200,0)
 . S ROUTINE=$$GETSRTN(601.71)_"(601.71,MHT,.PACKLIST)"
"RTN","PXRMEXPS",201,0)
 . D @ROUTINE
"RTN","PXRMEXPS",202,0)
 ;Check for result groups.
"RTN","PXRMEXPS",203,0)
 I $D(^PXRMD(801.41,DIEN,51)) D
"RTN","PXRMEXPS",204,0)
 . S ROUTINE=$$GETSRTN(801.41)_"(801.41,IEN,.PACKLIST)"
"RTN","PXRMEXPS",205,0)
 . S IND=0
"RTN","PXRMEXPS",206,0)
 . F  S IND=+$O(^PXRMD(801.41,DIEN,51,IND)) Q:IND=0  D
"RTN","PXRMEXPS",207,0)
 .. S IEN=$P(^PXRMD(801.41,DIEN,51,IND,0),U,1)
"RTN","PXRMEXPS",208,0)
 .. D @ROUTINE
"RTN","PXRMEXPS",209,0)
 Q
"RTN","PXRMEXPS",210,0)
 ;
"RTN","PXRMEXPS",211,0)
 ;==========================================
"RTN","PXRMEXPS",212,0)
SED(FILENUM,IEN,PACKLIST) ;Education topics.
"RTN","PXRMEXPS",213,0)
 N IND,NF,NSUB,SUBLIST
"RTN","PXRMEXPS",214,0)
 D EXISTS(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",215,0)
 D ADD(FILENUM,IEN,.PACKLIST,.NF)
"RTN","PXRMEXPS",216,0)
 S NSUB=0
"RTN","PXRMEXPS",217,0)
 ;Get all the subtopics.
"RTN","PXRMEXPS",218,0)
 D GEDSUB(IEN,.NSUB,.SUBLIST)
"RTN","PXRMEXPS",219,0)
 F IND=1:1:NSUB D
"RTN","PXRMEXPS",220,0)
 . D EXISTS(FILENUM,SUBLIST(IND),.PACKLIST)
"RTN","PXRMEXPS",221,0)
 . S NF=NF+1
"RTN","PXRMEXPS",222,0)
 . S PACKLIST(FILENUM,NF)=SUBLIST(IND)
"RTN","PXRMEXPS",223,0)
 . S PACKLIST(FILENUM,"IEN",SUBLIST(IND))=NF
"RTN","PXRMEXPS",224,0)
 Q
"RTN","PXRMEXPS",225,0)
 ;
"RTN","PXRMEXPS",226,0)
 ;==========================================
"RTN","PXRMEXPS",227,0)
SEDEF(FILENUM,IEN,PACKLIST) ;Reminder extract definitions.
"RTN","PXRMEXPS",228,0)
 N CR,CRRTN,IND,JND,LRRTN,LRS,RDEF,RDEFRTN,TEMP
"RTN","PXRMEXPS",229,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",230,0)
 ;Initialize the save routines.
"RTN","PXRMEXPS",231,0)
 S LRRTN=$$GETSRTN(810.4)_"(810.4,LRS,.PACKLIST)"
"RTN","PXRMEXPS",232,0)
 S CRRTN=$$GETSRTN(810.7)_"(810.7,CR,.PACKLIST)"
"RTN","PXRMEXPS",233,0)
 S RDEFRTN=$$GETSRTN(811.9)_"(811.9,RDEF,.PACKLIST)"
"RTN","PXRMEXPS",234,0)
 ;Go through the extract sequence.
"RTN","PXRMEXPS",235,0)
 S IND=0
"RTN","PXRMEXPS",236,0)
 F  S IND=+$O(^PXRM(810.2,IEN,10,IND)) Q:IND=0  D
"RTN","PXRMEXPS",237,0)
 . S LRS=$P(^PXRM(810.2,IEN,10,IND,0),U,2)
"RTN","PXRMEXPS",238,0)
 . D @LRRTN
"RTN","PXRMEXPS",239,0)
 .;Go through the reminders and counting rules.
"RTN","PXRMEXPS",240,0)
 . S JND=0
"RTN","PXRMEXPS",241,0)
 . F  S JND=+$O(^PXRM(810.2,IEN,10,IND,10,JND)) Q:JND=0  D
"RTN","PXRMEXPS",242,0)
 .. S TEMP=^PXRM(810.2,IEN,10,IND,10,JND,0)
"RTN","PXRMEXPS",243,0)
 .. S RDEF=$P(TEMP,U,2)
"RTN","PXRMEXPS",244,0)
 .. I RDEF'="" D @RDEFRTN
"RTN","PXRMEXPS",245,0)
 .. S CR=$P(TEMP,U,3)
"RTN","PXRMEXPS",246,0)
 .. I CR'="" D @CRRTN
"RTN","PXRMEXPS",247,0)
 Q
"RTN","PXRMEXPS",248,0)
 ;
"RTN","PXRMEXPS",249,0)
 ;==========================================
"RTN","PXRMEXPS",250,0)
SGEN(FILENUM,IEN,PACKLIST) ;General save routine, used for everything that
"RTN","PXRMEXPS",251,0)
 ;does not require special handling.
"RTN","PXRMEXPS",252,0)
 N NF
"RTN","PXRMEXPS",253,0)
 D EXISTS(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",254,0)
 D ADD(FILENUM,IEN,.PACKLIST,.NF)
"RTN","PXRMEXPS",255,0)
 Q
"RTN","PXRMEXPS",256,0)
 ;
"RTN","PXRMEXPS",257,0)
 ;==========================================
"RTN","PXRMEXPS",258,0)
SGENR(FILENUM,IEN,PACKLIST) ;General reminder global save routine, used for
"RTN","PXRMEXPS",259,0)
 ;reminder globals that do not require special handling.
"RTN","PXRMEXPS",260,0)
 N SPON
"RTN","PXRMEXPS",261,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",262,0)
 S SPON=+$$GET1^DIQ(FILENUM,IEN,101,"I")
"RTN","PXRMEXPS",263,0)
 I SPON>0 D SGEN(811.6,SPON,.PACKLIST)
"RTN","PXRMEXPS",264,0)
 Q
"RTN","PXRMEXPS",265,0)
 ;
"RTN","PXRMEXPS",266,0)
 ;==========================================
"RTN","PXRMEXPS",267,0)
SHF(FILENUM,IEN,PACKLIST) ;Health factors.
"RTN","PXRMEXPS",268,0)
 N CAT,HF,NF
"RTN","PXRMEXPS",269,0)
 ;All health factor references covered by DBIA #3083.
"RTN","PXRMEXPS",270,0)
 ;If the health factor is a category then it has to be coming from
"RTN","PXRMEXPS",271,0)
 ;a health summary so include all the health factors in the category.
"RTN","PXRMEXPS",272,0)
 I $P(^AUTTHF(IEN,0),U,10)="C" D
"RTN","PXRMEXPS",273,0)
 . S CAT=1,HF=0
"RTN","PXRMEXPS",274,0)
 . F  S HF=$O(^AUTTHF("AC",IEN,HF)) Q:HF'>0  D
"RTN","PXRMEXPS",275,0)
 .. D EXISTS(FILENUM,HF,.PACKLIST)
"RTN","PXRMEXPS",276,0)
 .. D ADD(FILENUM,HF,.PACKLIST,.NF)
"RTN","PXRMEXPS",277,0)
 D EXISTS(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",278,0)
 D ADD(FILENUM,IEN,.PACKLIST,.NF)
"RTN","PXRMEXPS",279,0)
 I $G(CAT) Q
"RTN","PXRMEXPS",280,0)
 ;For a regular health factor make sure the category is on the list.
"RTN","PXRMEXPS",281,0)
 S CAT=$P(^AUTTHF(IEN,0),U,3)
"RTN","PXRMEXPS",282,0)
 D EXISTS(FILENUM,CAT,.PACKLIST)
"RTN","PXRMEXPS",283,0)
 S NF=NF+1
"RTN","PXRMEXPS",284,0)
 S PACKLIST(FILENUM,NF)=CAT
"RTN","PXRMEXPS",285,0)
 S PACKLIST(FILENUM,"IEN",CAT)=NF
"RTN","PXRMEXPS",286,0)
 Q
"RTN","PXRMEXPS",287,0)
 ;
"RTN","PXRMEXPS",288,0)
 ;==========================================
"RTN","PXRMEXPS",289,0)
SHSO(FILENUM,IEN,PACKLIST) ;Health summary object.
"RTN","PXRMEXPS",290,0)
 N HST
"RTN","PXRMEXPS",291,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",292,0)
 S HST=$P($G(^GMT(142.5,IEN,0)),U,3)
"RTN","PXRMEXPS",293,0)
 S ROUTINE=$$GETSRTN(142)_"(142,HST,.PACKLIST)"
"RTN","PXRMEXPS",294,0)
 D @ROUTINE
"RTN","PXRMEXPS",295,0)
 Q
"RTN","PXRMEXPS",296,0)
 ;
"RTN","PXRMEXPS",297,0)
 ;==========================================
"RTN","PXRMEXPS",298,0)
SHST(FILENUM,IEN,PACKLIST) ;Health Summary Type
"RTN","PXRMEXPS",299,0)
 N CNT,FNUM,GBL,HSC,ITEM,NODE,ROUTINE,SEL
"RTN","PXRMEXPS",300,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",301,0)
 S CNT=0 F  S CNT=$O(^GMT(142,IEN,1,CNT)) Q:CNT'>0  D
"RTN","PXRMEXPS",302,0)
 .S HSC=$P($G(^GMT(142,IEN,1,CNT,0)),U,2)
"RTN","PXRMEXPS",303,0)
 .S ROUTINE=$$GETSRTN(142.1)_"(142.1,HSC,.PACKLIST)"
"RTN","PXRMEXPS",304,0)
 .D @ROUTINE
"RTN","PXRMEXPS",305,0)
 .;Loop through selection item, variable pointer
"RTN","PXRMEXPS",306,0)
 .S SEL=0 F  S SEL=$O(^GMT(142,IEN,1,CNT,1,SEL)) Q:SEL'>0  D
"RTN","PXRMEXPS",307,0)
 ..S NODE=$P($G(^GMT(142,IEN,1,CNT,1,SEL,0)),U)
"RTN","PXRMEXPS",308,0)
 ..I NODE'="" D
"RTN","PXRMEXPS",309,0)
 ...S ITEM=$P(NODE,";",1)
"RTN","PXRMEXPS",310,0)
 ...S GBL=$P(NODE,";",2)
"RTN","PXRMEXPS",311,0)
 ...S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",312,0)
 ...S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,ITEM,.PACKLIST)"
"RTN","PXRMEXPS",313,0)
 ...I ROUTINE="NOROUTINE" Q
"RTN","PXRMEXPS",314,0)
 ...D @ROUTINE
"RTN","PXRMEXPS",315,0)
 Q
"RTN","PXRMEXPS",316,0)
 ;
"RTN","PXRMEXPS",317,0)
 ;==========================================
"RTN","PXRMEXPS",318,0)
SLL(FILENUM,IEN,PACKLIST) ;Reminder location lists.
"RTN","PXRMEXPS",319,0)
 N CSTEXL,IND,ROUTINE
"RTN","PXRMEXPS",320,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",321,0)
 ;If CREDIT STOPS TO EXCLUDE (LIST) has been used put it on the packing
"RTN","PXRMEXPS",322,0)
 ;list.
"RTN","PXRMEXPS",323,0)
 S IND=0
"RTN","PXRMEXPS",324,0)
 F  S IND=+$O(^PXRMD(810.9,IEN,40.7,IND)) Q:IND=0  D
"RTN","PXRMEXPS",325,0)
 . S CSTEXL=$G(^PXRMD(810.9,IEN,40.7,IND,2))
"RTN","PXRMEXPS",326,0)
 . I CSTEXL="" Q
"RTN","PXRMEXPS",327,0)
 . S ROUTINE=$$GETSRTN(810.9)_"(810.9,CSTEXL,.PACKLIST)"
"RTN","PXRMEXPS",328,0)
 . D @ROUTINE
"RTN","PXRMEXPS",329,0)
 ;Save information about hospital locations which are non-transportable.
"RTN","PXRMEXPS",330,0)
 I $D(^PXRMD(810.9,IEN,44))>1 D NTHLOC^PXRMEXFI(IEN,"LOCATION LIST")
"RTN","PXRMEXPS",331,0)
 Q
"RTN","PXRMEXPS",332,0)
 ;
"RTN","PXRMEXPS",333,0)
 ;==========================================
"RTN","PXRMEXPS",334,0)
SLR(FILENUM,IEN,PACKLIST) ;Reminder list rules.
"RTN","PXRMEXPS",335,0)
 N IND,LR,RDEF,RTERM,ROUTINE,TEMP
"RTN","PXRMEXPS",336,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",337,0)
 S TEMP=^PXRM(810.4,IEN,0)
"RTN","PXRMEXPS",338,0)
 S RTERM=$P(TEMP,U,7)
"RTN","PXRMEXPS",339,0)
 I RTERM'="" D
"RTN","PXRMEXPS",340,0)
 . S ROUTINE=$$GETSRTN(811.5)_"(811.5,RTERM,.PACKLIST)"
"RTN","PXRMEXPS",341,0)
 . D @ROUTINE
"RTN","PXRMEXPS",342,0)
 S RDEF=$P(TEMP,U,10)
"RTN","PXRMEXPS",343,0)
 I RDEF'="" D
"RTN","PXRMEXPS",344,0)
 . S ROUTINE=$$GETSRTN(811.9)_"(811.9,RDEF,.PACKLIST)"
"RTN","PXRMEXPS",345,0)
 . D @ROUTINE
"RTN","PXRMEXPS",346,0)
 ;If there is a sequence save the list rules.
"RTN","PXRMEXPS",347,0)
 I '$D(^PXRM(810.4,IEN,30)) Q
"RTN","PXRMEXPS",348,0)
 S ROUTINE=$$GETSRTN(810.4)_"(810.4,LR,.PACKLIST)"
"RTN","PXRMEXPS",349,0)
 S IND=0
"RTN","PXRMEXPS",350,0)
 F  S IND=+$O(^PXRM(810.4,IEN,30,IND)) Q:IND=0  D
"RTN","PXRMEXPS",351,0)
 . S LR=$P(^PXRM(810.4,IEN,30,IND,0),U,2)
"RTN","PXRMEXPS",352,0)
 . D @ROUTINE
"RTN","PXRMEXPS",353,0)
 Q
"RTN","PXRMEXPS",354,0)
 ;
"RTN","PXRMEXPS",355,0)
 ;==========================================
"RTN","PXRMEXPS",356,0)
SLT(FILENUM,IEN,PACKLIST) ;Lab tests
"RTN","PXRMEXPS",357,0)
 I +IEN'=IEN S IEN=$P(IEN,";",3)
"RTN","PXRMEXPS",358,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",359,0)
 Q
"RTN","PXRMEXPS",360,0)
 ;
"RTN","PXRMEXPS",361,0)
 ;==========================================
"RTN","PXRMEXPS",362,0)
SODIALOG(FILENUM,IEN,PACKLIST) ;Order dialogs.
"RTN","PXRMEXPS",363,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",364,0)
 ;DBIA 5446
"RTN","PXRMEXPS",365,0)
 D EN^ORORDDSC(IEN,"ORDER DIALOG")
"RTN","PXRMEXPS",366,0)
 Q
"RTN","PXRMEXPS",367,0)
 ;
"RTN","PXRMEXPS",368,0)
 ;==========================================
"RTN","PXRMEXPS",369,0)
SRCG(FILENUM,IEN,PACKLIST) ;Reminder counting groups.
"RTN","PXRMEXPS",370,0)
 N IND,ROUTINE,TIEN
"RTN","PXRMEXPS",371,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",372,0)
 ;Put terms on the pack list.
"RTN","PXRMEXPS",373,0)
 S ROUTINE=$$GETSRTN(811.5)_"(811.5,TIEN,.PACKLIST)"
"RTN","PXRMEXPS",374,0)
 S IND=0
"RTN","PXRMEXPS",375,0)
 F  S IND=+$O(^PXRM(810.8,IEN,10,IND)) Q:IND=0  D
"RTN","PXRMEXPS",376,0)
 . S TIEN=$P(^PXRM(810.8,IEN,10,IND,0),U,2)
"RTN","PXRMEXPS",377,0)
 . D @ROUTINE
"RTN","PXRMEXPS",378,0)
 Q
"RTN","PXRMEXPS",379,0)
 ;
"RTN","PXRMEXPS",380,0)
 ;==========================================
"RTN","PXRMEXPS",381,0)
SRECR(FILENUM,IEN,PACKLIST) ;Reminder extract counting rule.
"RTN","PXRMEXPS",382,0)
 N CGIEN,IND,ROUTINE,TIEN
"RTN","PXRMEXPS",383,0)
 D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",384,0)
 ;Put counting groups on the pack list.
"RTN","PXRMEXPS",385,0)
 S ROUTINE=$$GETSRTN(810.8)_"(810.8,CGIEN,.PACKLIST)"
"RTN","PXRMEXPS",386,0)
 S IND=0
"RTN","PXRMEXPS",387,0)
 F  S IND=+$O(^PXRM(810.7,IEN,10,IND)) Q:IND=0  D
"RTN","PXRMEXPS",388,0)
 . S CGIEN=$P(^PXRM(810.7,IEN,10,IND,0),U,2)
"RTN","PXRMEXPS",389,0)
 . D @ROUTINE
"RTN","PXRMEXPS",390,0)
 Q
"RTN","PXRMEXPS",391,0)
 ;
"RTN","PXRMEXPS",392,0)
 ;==========================================
"RTN","PXRMEXPS",393,0)
SRT(FILENUM,TIEN,PACKLIST) ;Reminder terms.
"RTN","PXRMEXPS",394,0)
 N FNUM,GBL,IEN,NF,ROUTINE,SPON
"RTN","PXRMEXPS",395,0)
 N ITEM,NUM,RIEN
"RTN","PXRMEXPS",396,0)
 D EXISTS(FILENUM,TIEN,.PACKLIST)
"RTN","PXRMEXPS",397,0)
 D ADD(FILENUM,TIEN,.PACKLIST,.NF)
"RTN","PXRMEXPS",398,0)
 ;Process the finding multiple.
"RTN","PXRMEXPS",399,0)
 S GBL=""
"RTN","PXRMEXPS",400,0)
 F  S GBL=$O(^PXRMD(811.5,TIEN,20,"E",GBL)) Q:GBL=""  D
"RTN","PXRMEXPS",401,0)
 . S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",402,0)
 . I FNUM=811.4 D CHKCF("^PXRMD(811.5)",TIEN,GBL,.PACKLIST)
"RTN","PXRMEXPS",403,0)
 . S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,IEN,.PACKLIST)"
"RTN","PXRMEXPS",404,0)
 . S IEN=""
"RTN","PXRMEXPS",405,0)
 . F  S IEN=$O(^PXRMD(811.5,TIEN,20,"E",GBL,IEN)) Q:IEN=""  D @ROUTINE
"RTN","PXRMEXPS",406,0)
 ;Sponsor
"RTN","PXRMEXPS",407,0)
 S SPON=+$P(^PXRMD(811.5,TIEN,100),U,2)
"RTN","PXRMEXPS",408,0)
 I SPON>0 D SGEN(811.6,SPON,.PACKLIST)
"RTN","PXRMEXPS",409,0)
 Q
"RTN","PXRMEXPS",410,0)
 ;
"RTN","PXRMEXPS",411,0)
 ;==========================================
"RTN","PXRMEXPS",412,0)
SROC(FILENUM,ROCIEN,PACKLIST) ;Reminder Order Checks.
"RTN","PXRMEXPS",413,0)
 ;packed order check structure up
"RTN","PXRMEXPS",414,0)
 D SGENR(FILENUM,ROCIEN,.PACKLIST)
"RTN","PXRMEXPS",415,0)
 N GBL,SUB,DRCL,FNUM,OI,OLIST,PHAR,RIEN,ROUTINE,TIEN,TLIST,WPNODE
"RTN","PXRMEXPS",416,0)
 ;Process the pharmacy multiple.
"RTN","PXRMEXPS",417,0)
 S PHAR=""
"RTN","PXRMEXPS",418,0)
 F  S PHAR=$O(^PXD(801,ROCIEN,1.5,"B",PHAR)) Q:PHAR=""  D
"RTN","PXRMEXPS",419,0)
 . S IEN=$P(PHAR,";"),GBL=$P(PHAR,";",2)
"RTN","PXRMEXPS",420,0)
 . S FNUM=$$GETFNUM(GBL)
"RTN","PXRMEXPS",421,0)
 . S ROUTINE=$$GETSRTN(FNUM)_"(FNUM,IEN,.PACKLIST)"
"RTN","PXRMEXPS",422,0)
 . D @ROUTINE
"RTN","PXRMEXPS",423,0)
 ;packed list of Orderable Item
"RTN","PXRMEXPS",424,0)
 I $D(^PXD(801,ROCIEN,2)) D
"RTN","PXRMEXPS",425,0)
 .S SUB=0 F  S SUB=$O(^PXD(801,ROCIEN,2,SUB)) Q:SUB'>0  D
"RTN","PXRMEXPS",426,0)
 ..S OI=$P($G(^PXD(801,ROCIEN,2,SUB,0)),U) Q:OI'>0
"RTN","PXRMEXPS",427,0)
 ..S ROUTINE=$$GETSRTN(101.43)_"(101.43,OI,.PACKLIST)"
"RTN","PXRMEXPS",428,0)
 ..D @ROUTINE
"RTN","PXRMEXPS",429,0)
 ;loop through rules and packed definitions or terms
"RTN","PXRMEXPS",430,0)
 S SUB=0 F  S SUB=$O(^PXD(801,ROCIEN,3,SUB)) Q:SUB'>0  D
"RTN","PXRMEXPS",431,0)
 .S RIEN=$P($G(^PXD(801,ROCIEN,3,SUB,0)),U) Q:RIEN'>0
"RTN","PXRMEXPS",432,0)
 .S ROUTINE=$$GETSRTN(801.1)_"(801.1,RIEN,.PACKLIST)"
"RTN","PXRMEXPS",433,0)
 .D @ROUTINE
"RTN","PXRMEXPS",434,0)
 Q
"RTN","PXRMEXPS",435,0)
 ;
"RTN","PXRMEXPS",436,0)
 ;==========================================
"RTN","PXRMEXPS",437,0)
SRULE(FILENUM,RULEIEN,PACKLIST) ;Reminder Order Check Rules.
"RTN","PXRMEXPS",438,0)
 ;packed order check structure up
"RTN","PXRMEXPS",439,0)
 D SGENR(FILENUM,RULEIEN,.PACKLIST)
"RTN","PXRMEXPS",440,0)
 N OLIST,RIEN,ROUTINE,TIEN,TLIST
"RTN","PXRMEXPS",441,0)
 I $D(^PXD(801.1,RULEIEN,3,4))>0 D
"RTN","PXRMEXPS",442,0)
 .;search for TIU Objects
"RTN","PXRMEXPS",443,0)
 .D TIUSRCH^PXRMEXU1("^PXD(801.1,",RULEIEN,",4",.OLIST,.TLIST)
"RTN","PXRMEXPS",444,0)
 .I $D(OLIST)>0 D
"RTN","PXRMEXPS",445,0)
 ..S ROUTINE=$$GETSRTN(8925.1)_"(8925.1,.OLIST,.PACKLIST)"
"RTN","PXRMEXPS",446,0)
 ..D @ROUTINE K OLIST
"RTN","PXRMEXPS",447,0)
 .K TLIST
"RTN","PXRMEXPS",448,0)
 .;packed term up only
"RTN","PXRMEXPS",449,0)
 S TIEN=$P($G(^PXD(801.1,RULEIEN,2)),U) I TIEN>0 D  Q
"RTN","PXRMEXPS",450,0)
 .S ROUTINE=$$GETSRTN(811.5)_"(811.5,TIEN,.PACKLIST)"
"RTN","PXRMEXPS",451,0)
 .D @ROUTINE
"RTN","PXRMEXPS",452,0)
 ;packed definition up if defined
"RTN","PXRMEXPS",453,0)
 S RIEN=$P($G(^PXD(801.1,RULEIEN,3)),U) I RIEN>0 D
"RTN","PXRMEXPS",454,0)
 .S ROUTINE=$$GETSRTN(811.9)_"(811.9,RIEN,.PACKLIST)"
"RTN","PXRMEXPS",455,0)
 .D @ROUTINE
"RTN","PXRMEXPS",456,0)
 Q
"RTN","PXRMEXPS",457,0)
 ;
"RTN","PXRMEXPS",458,0)
 ;==========================================
"RTN","PXRMEXPS",459,0)
STIUOBJ(FILENUM,OLIST,PACKLIST) ;
"RTN","PXRMEXPS",460,0)
 N ARY,CNT,HSO,IEN,NAME,ROUTINE,TEMP
"RTN","PXRMEXPS",461,0)
 S CNT=0 F  S CNT=$O(OLIST(CNT)) Q:CNT'>0  D
"RTN","PXRMEXPS",462,0)
 . S NAME=OLIST(CNT)
"RTN","PXRMEXPS",463,0)
 . ;DBIA 5447
"RTN","PXRMEXPS",464,0)
 . S IEN=$$OBJBYNAM^TIUCHECK(.ARY,NAME) I IEN=-1 Q
"RTN","PXRMEXPS",465,0)
 .;Do not ship non TIU/HS Objects
"RTN","PXRMEXPS",466,0)
 . I $G(ARY(IEN,9))'["S X=$$TIU^GMTSOBJ(" D  Q
"RTN","PXRMEXPS",467,0)
 .. D TIU^PXRMEXU5(IEN,.ARY,"TIU OBJECT")
"RTN","PXRMEXPS",468,0)
 .. D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",469,0)
 . D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",470,0)
 . S TEMP=$P($G(ARY(IEN,9)),",",2)
"RTN","PXRMEXPS",471,0)
 . S HSO=$P(TEMP,")")
"RTN","PXRMEXPS",472,0)
 . S ROUTINE=$$GETSRTN(142.5)_"(142.5,.HSO,.PACKLIST)"
"RTN","PXRMEXPS",473,0)
 . D @ROUTINE
"RTN","PXRMEXPS",474,0)
 Q
"RTN","PXRMEXPS",475,0)
 ;
"RTN","PXRMEXPS",476,0)
 ;==========================================
"RTN","PXRMEXPS",477,0)
STIUTEMP(FILENUM,TLIST,PACKLIST) ;
"RTN","PXRMEXPS",478,0)
 N CNT,IEN,NAME
"RTN","PXRMEXPS",479,0)
 S CNT=0 F  S CNT=$O(TLIST(CNT)) Q:CNT'>0  D
"RTN","PXRMEXPS",480,0)
 .S NAME=TLIST(CNT)
"RTN","PXRMEXPS",481,0)
 .S IEN=$O(^TIU(8927.1,"B",NAME,"")) Q:IEN'>0
"RTN","PXRMEXPS",482,0)
 .D SGEN(FILENUM,IEN,.PACKLIST)
"RTN","PXRMEXPS",483,0)
 Q
"RTN","PXRMEXPS",484,0)
 ;
"RTN","PXRMEXSI")
0^6^B40410891
"RTN","PXRMEXSI",1,0)
PXRMEXSI ;SLC/PKR/PJH - Silent Exchange entry install. ;04/19/2012
"RTN","PXRMEXSI",2,0)
 ;;2.0;CLINICAL REMINDERS;**6,12,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMEXSI",3,0)
 ;
"RTN","PXRMEXSI",4,0)
 ;=======================================
"RTN","PXRMEXSI",5,0)
DELEXE(ENTRY,ROUTINE) ;If the Exchange File entry already exists delete it.
"RTN","PXRMEXSI",6,0)
 N EXARRAY,IC,IND,LIST,LUVALUE,NUM
"RTN","PXRMEXSI",7,0)
 D LDARRAY^PXRMEXSI("L",ENTRY,ROUTINE,.EXARRAY)
"RTN","PXRMEXSI",8,0)
 S IC=0
"RTN","PXRMEXSI",9,0)
 F  S IC=$O(EXARRAY(IC)) Q:'IC  D
"RTN","PXRMEXSI",10,0)
 . S LUVALUE(1)=EXARRAY(IC,1)
"RTN","PXRMEXSI",11,0)
 . D FIND^DIC(811.8,"","","U",.LUVALUE,"","","","","LIST")
"RTN","PXRMEXSI",12,0)
 . I '$D(LIST) Q
"RTN","PXRMEXSI",13,0)
 . S NUM=$P(LIST("DILIST",0),U,1)
"RTN","PXRMEXSI",14,0)
 . I NUM'=0 D
"RTN","PXRMEXSI",15,0)
 .. F IND=1:1:NUM D
"RTN","PXRMEXSI",16,0)
 ... N DA,DIK
"RTN","PXRMEXSI",17,0)
 ... S DIK="^PXD(811.8,"
"RTN","PXRMEXSI",18,0)
 ... S DA=LIST("DILIST",2,IND)
"RTN","PXRMEXSI",19,0)
 ... D ^DIK
"RTN","PXRMEXSI",20,0)
 Q
"RTN","PXRMEXSI",21,0)
 ;
"RTN","PXRMEXSI",22,0)
 ;=======================================
"RTN","PXRMEXSI",23,0)
EXFINC(Y,ENTRY,ROUTINE) ;Return a 1 if the Exchange file entry is in the list
"RTN","PXRMEXSI",24,0)
 ;to include in the build. This is used in the build to determine which
"RTN","PXRMEXSI",25,0)
 ;entries to include.
"RTN","PXRMEXSI",26,0)
 N EXARRAY,FOUND,IEN,IC,LUVALUE
"RTN","PXRMEXSI",27,0)
 D LDARRAY^PXRMEXSI("I",ENTRY,ROUTINE,.EXARRAY)
"RTN","PXRMEXSI",28,0)
 S FOUND=0
"RTN","PXRMEXSI",29,0)
 S IC=0
"RTN","PXRMEXSI",30,0)
 F  S IC=+$O(EXARRAY(IC)) Q:(IC=0)!(FOUND)  D
"RTN","PXRMEXSI",31,0)
 . M LUVALUE=EXARRAY(IC)
"RTN","PXRMEXSI",32,0)
 . S IEN=+$$FIND1^DIC(811.8,"","KU",.LUVALUE)
"RTN","PXRMEXSI",33,0)
 . I IEN=Y S FOUND=1 Q
"RTN","PXRMEXSI",34,0)
 Q FOUND
"RTN","PXRMEXSI",35,0)
 ;
"RTN","PXRMEXSI",36,0)
 ;=======================================
"RTN","PXRMEXSI",37,0)
INSCOM(PXRMRIEN,ACTION,IND,TEMP,HISTSUB) ;Install component IND
"RTN","PXRMEXSI",38,0)
 ;of PXRMRIEN.
"RTN","PXRMEXSI",39,0)
 N ATTR,CSUM,END,EXISTS,FILENUM,IND120,JND120,NAME
"RTN","PXRMEXSI",40,0)
 N PT01,RTN,SAME,START,TEXT
"RTN","PXRMEXSI",41,0)
 S FILENUM=$P(TEMP,U,1),EXISTS=$P(TEMP,U,4)
"RTN","PXRMEXSI",42,0)
 S IND120=$P(TEMP,U,2),JND120=$P(TEMP,U,3)
"RTN","PXRMEXSI",43,0)
 I (IND120="")!(JND120="") Q
"RTN","PXRMEXSI",44,0)
 S TEMP=^PXD(811.8,PXRMRIEN,120,IND120,1,JND120,0)
"RTN","PXRMEXSI",45,0)
 ;If the component does not exist then the action has to be "I".
"RTN","PXRMEXSI",46,0)
 ;If the component exists and the action is "I" change it to "O".
"RTN","PXRMEXSI",47,0)
 ;Otherwise leave the action as is.
"RTN","PXRMEXSI",48,0)
 S ACTION=$S('EXISTS:"I",ACTION="I":"O",1:ACTION)
"RTN","PXRMEXSI",49,0)
 S SAME=0
"RTN","PXRMEXSI",50,0)
 S START=$P(TEMP,U,2)
"RTN","PXRMEXSI",51,0)
 S END=$P(TEMP,U,3)
"RTN","PXRMEXSI",52,0)
 I FILENUM=0 D
"RTN","PXRMEXSI",53,0)
 . D RTNLD^PXRMEXIC(PXRMRIEN,START,END,.ATTR,.RTN)
"RTN","PXRMEXSI",54,0)
 . I EXISTS D
"RTN","PXRMEXSI",55,0)
 .. D CHECKSUM^PXRMEXCS(.ATTR,START,END)
"RTN","PXRMEXSI",56,0)
 .. S CSUM=$$RTNCS^PXRMEXCS(ATTR("NAME"))
"RTN","PXRMEXSI",57,0)
 .. I ATTR("CHECKSUM")=CSUM S SAME=1,ACTION="S"
"RTN","PXRMEXSI",58,0)
 . S ^TMP("PXRMEXIA",$J,IND,"ROUTINE",ATTR("NAME"),ACTION)=""
"RTN","PXRMEXSI",59,0)
 E  D
"RTN","PXRMEXSI",60,0)
 . S TEMP=^PXD(811.8,PXRMRIEN,100,START,0)
"RTN","PXRMEXSI",61,0)
 . S PT01=$P(TEMP,"~",2)
"RTN","PXRMEXSI",62,0)
 .;Save reminder name for dialog install.
"RTN","PXRMEXSI",63,0)
 . ;I FILENUM=811.9 S REMNAME=PT01
"RTN","PXRMEXSI",64,0)
 . D SETATTR^PXRMEXFI(.ATTR,FILENUM,PT01)
"RTN","PXRMEXSI",65,0)
 . I EXISTS D
"RTN","PXRMEXSI",66,0)
 .. D CHECKSUM^PXRMEXCS(.ATTR,START,END)
"RTN","PXRMEXSI",67,0)
 .. S CSUM=$$FILE^PXRMEXCS(ATTR("FILE NUMBER"),EXISTS)
"RTN","PXRMEXSI",68,0)
 .. I ATTR("CHECKSUM")=CSUM S SAME=1,ACTION="S"
"RTN","PXRMEXSI",69,0)
 .;Save what was done for the installation summary.
"RTN","PXRMEXSI",70,0)
 . S ^TMP(HISTSUB,$J,IND,ATTR("FILE NAME"),PT01,ACTION)=""
"RTN","PXRMEXSI",71,0)
 ;If the packed component and the installed component are the same
"RTN","PXRMEXSI",72,0)
 ;there is nothing to do.
"RTN","PXRMEXSI",73,0)
 I SAME Q
"RTN","PXRMEXSI",74,0)
 ;Install this component.
"RTN","PXRMEXSI",75,0)
 I FILENUM=0 D RTNSAVE^PXRMEXIC(.RTN,ATTR("NAME"))
"RTN","PXRMEXSI",76,0)
 E  D FILE^PXRMEXIC(PXRMRIEN,EXISTS,IND120,JND120,ACTION,.ATTR,.PXRMNMCH)
"RTN","PXRMEXSI",77,0)
 Q
"RTN","PXRMEXSI",78,0)
 ;
"RTN","PXRMEXSI",79,0)
 ;=======================================
"RTN","PXRMEXSI",80,0)
INSDLG(PXRMRIEN,IND120,JND120,ACTION) ;Install dialog components directly
"RTN","PXRMEXSI",81,0)
 ;from the "SEL" array.
"RTN","PXRMEXSI",82,0)
 N IND,FILENUM,ITEMP,NAME,TEMP
"RTN","PXRMEXSI",83,0)
 ;Build the selection array in ^TMP("PXRMEXLD",$J,"SEL"). For dialogs
"RTN","PXRMEXSI",84,0)
 ;the selection array is:
"RTN","PXRMEXSI",85,0)
 ;file no.^FDA start^FDA end^EXISTS^IND120^JND120^NAME
"RTN","PXRMEXSI",86,0)
 S FILENUM=801.41
"RTN","PXRMEXSI",87,0)
 D DBUILD^PXRMEXLB(PXRMRIEN,IND120,JND120)
"RTN","PXRMEXSI",88,0)
 D BLDDISP^PXRMEXDB(0)
"RTN","PXRMEXSI",89,0)
 ;Work through the selection array installing the dialog parts
"RTN","PXRMEXSI",90,0)
 ;in reverse order.
"RTN","PXRMEXSI",91,0)
 S IND=""
"RTN","PXRMEXSI",92,0)
 F  S IND=$O(^TMP("PXRMEXLD",$J,"SEL",IND),-1) Q:(IND="")!(PXRMDONE)  D
"RTN","PXRMEXSI",93,0)
 . S TEMP=^TMP("PXRMEXLD",$J,"SEL",IND)
"RTN","PXRMEXSI",94,0)
 . S FILENUM=$P(TEMP,U,1),NAME=$P(TEMP,U,7)
"RTN","PXRMEXSI",95,0)
 .;Dialog elements may be used more than once in a dialog so make sure
"RTN","PXRMEXSI",96,0)
 .;the element has not already been installed.
"RTN","PXRMEXSI",97,0)
 . S ITEMP=$P(TEMP,U,1)_U_$P(TEMP,U,4,5)_U_$$EXISTS^PXRMEXIU(FILENUM,NAME)
"RTN","PXRMEXSI",98,0)
 . D INSCOM(PXRMRIEN,ACTION,IND,ITEMP,"PXRMEXIAD")
"RTN","PXRMEXSI",99,0)
 Q
"RTN","PXRMEXSI",100,0)
 ;
"RTN","PXRMEXSI",101,0)
 ;=======================================
"RTN","PXRMEXSI",102,0)
INSTALL(PXRMRIEN,ACTION,NOCF,NOR) ;Install all components in a repository entry.
"RTN","PXRMEXSI",103,0)
 ;If NOCF is true do not install computed findings, if NOR is true
"RTN","PXRMEXSI",104,0)
 ;do not install routines.
"RTN","PXRMEXSI",105,0)
 N CLOK,DNAME,FILENUM,IND,PXRMDONE,PXRMNMCH,REMNAME,TEMP,RNAME
"RTN","PXRMEXSI",106,0)
 S PXRMDONE=0
"RTN","PXRMEXSI",107,0)
 S NOCF=$G(NOCF),NOR=$G(NOR)
"RTN","PXRMEXSI",108,0)
 ;Initialize ^TMP globals.
"RTN","PXRMEXSI",109,0)
 D INITMPG^PXRMEXLM
"RTN","PXRMEXSI",110,0)
 ;Build the component list.
"RTN","PXRMEXSI",111,0)
 K ^PXD(811.8,PXRMRIEN,100,"B")
"RTN","PXRMEXSI",112,0)
 K ^PXD(811.8,PXRMRIEN,120)
"RTN","PXRMEXSI",113,0)
 D CLIST^PXRMEXCO(PXRMRIEN,.CLOK)
"RTN","PXRMEXSI",114,0)
 I 'CLOK Q
"RTN","PXRMEXSI",115,0)
 ;Build the selectable list.
"RTN","PXRMEXSI",116,0)
 D CDISP^PXRMEXLC(PXRMRIEN)
"RTN","PXRMEXSI",117,0)
 ;Set the install type.
"RTN","PXRMEXSI",118,0)
 S ^TMP("PXRMEXIA",$J,"TYPE")="SILENT"
"RTN","PXRMEXSI",119,0)
 ;Initialize the name change storage.
"RTN","PXRMEXSI",120,0)
 K PXRMNMCH
"RTN","PXRMEXSI",121,0)
 S IND=0
"RTN","PXRMEXSI",122,0)
 F  S IND=$O(^TMP("PXRMEXLC",$J,"SEL",IND)) Q:(IND="")!(PXRMDONE)  D
"RTN","PXRMEXSI",123,0)
 . S TEMP=^TMP("PXRMEXLC",$J,"SEL",IND)
"RTN","PXRMEXSI",124,0)
 . S FILENUM=$P(TEMP,U,1)
"RTN","PXRMEXSI",125,0)
 .;If NOCF is true do not install computed findings.
"RTN","PXRMEXSI",126,0)
 . I FILENUM=811.4,NOCF Q
"RTN","PXRMEXSI",127,0)
 .;If NOR is true do not install routines.
"RTN","PXRMEXSI",128,0)
 . I FILENUM=0,NOR Q
"RTN","PXRMEXSI",129,0)
 . ;Install dialog components
"RTN","PXRMEXSI",130,0)
 . I FILENUM=801.41 D  Q
"RTN","PXRMEXSI",131,0)
 .. N IND120,JND120,PXRMDONE
"RTN","PXRMEXSI",132,0)
 .. S IND120=$P(TEMP,U,2),JND120=$P(TEMP,U,3),PXRMDONE=0
"RTN","PXRMEXSI",133,0)
 .. D INSDLG(PXRMRIEN,IND120,JND120,ACTION)
"RTN","PXRMEXSI",134,0)
 . ;Install component
"RTN","PXRMEXSI",135,0)
 . E  D INSCOM(PXRMRIEN,ACTION,IND,TEMP,"PXRMEXIA")
"RTN","PXRMEXSI",136,0)
 ;
"RTN","PXRMEXSI",137,0)
 ;Get the dialog name
"RTN","PXRMEXSI",138,0)
 S DNAME="" F  S DNAME=$O(^TMP("PXRMEXDL",$J,DNAME)) Q:DNAME=""  D
"RTN","PXRMEXSI",139,0)
 . S RNAME=""
"RTN","PXRMEXSI",140,0)
 . F  S RNAME=$O(^TMP("PXRMEXDL",$J,DNAME,RNAME)) Q:RNAME=""  D
"RTN","PXRMEXSI",141,0)
 ..;Link the dialog if it exists
"RTN","PXRMEXSI",142,0)
 .. N DIEN,RIEN
"RTN","PXRMEXSI",143,0)
 ..;Get the dialog ien.
"RTN","PXRMEXSI",144,0)
 .. S DIEN=$$EXISTS^PXRMEXIU(801.41,DNAME) Q:'DIEN
"RTN","PXRMEXSI",145,0)
 ..;Get the reminder ien.
"RTN","PXRMEXSI",146,0)
 .. S RIEN=+$$EXISTS^PXRMEXIU(811.9,$G(RNAME)) Q:'RIEN
"RTN","PXRMEXSI",147,0)
 .. N DA,DIE,DIK,DR
"RTN","PXRMEXSI",148,0)
 ..;Set reminder to dialog pointer.
"RTN","PXRMEXSI",149,0)
 .. S DR="51///^S X=DNAME",DIE="^PXD(811.9,",DA=RIEN
"RTN","PXRMEXSI",150,0)
 .. D ^DIE
"RTN","PXRMEXSI",151,0)
 ;
"RTN","PXRMEXSI",152,0)
 ;Save the install history.
"RTN","PXRMEXSI",153,0)
 D SAVHIST^PXRMEXU1
"RTN","PXRMEXSI",154,0)
 ;If any components were skipped send the message.
"RTN","PXRMEXSI",155,0)
 I $D(^TMP("PXRMEXNI",$J)) D
"RTN","PXRMEXSI",156,0)
 . N NE,XMSUB
"RTN","PXRMEXSI",157,0)
 . S NE=$O(^TMP("PXRMEXNI",$J,""),-1)+1
"RTN","PXRMEXSI",158,0)
 . S ^TMP("PXRMEXNI",$J,NE,0)="Please review and make changes as necessary."
"RTN","PXRMEXSI",159,0)
 . K ^TMP("PXRMXMZ",$J)
"RTN","PXRMEXSI",160,0)
 . M ^TMP("PXRMXMZ",$J)=^TMP("PXRMEXNI",$J)
"RTN","PXRMEXSI",161,0)
 . S XMSUB="COMPONENTS SKIPPED DURING SILENT MODE INSTALL"
"RTN","PXRMEXSI",162,0)
 . D SEND^PXRMMSG("PXRMXMZ",XMSUB,"",DUZ)
"RTN","PXRMEXSI",163,0)
 ;Cleanup TMP globals.
"RTN","PXRMEXSI",164,0)
 D INITMPG^PXRMEXLM
"RTN","PXRMEXSI",165,0)
 Q
"RTN","PXRMEXSI",166,0)
 ;
"RTN","PXRMEXSI",167,0)
 ;=======================================
"RTN","PXRMEXSI",168,0)
LDARRAY(MODE,ENTRY,ROUTINE,ARRAY) ;Load ARRAY with
"RTN","PXRMEXSI",169,0)
 ;MODE is a string that may contain any of the following:
"RTN","PXRMEXSI",170,0)
 ; A = include action, stored in the third column of the ARRAY entry.
"RTN","PXRMEXSI",171,0)
 ; I = include in build, used for the data screen in the KIDS build.
"RTN","PXRMEXSI",172,0)
 ; If MODE contains I then the date and time are stored in the second
"RTN","PXRMEXSI",173,0)
 ; column of the ARRAY entry.
"RTN","PXRMEXSI",174,0)
 ; L = load action, store the name in the first column of the ARRAY
"RTN","PXRMEXSI",175,0)
 ; entry. This is the default and both A and I imply L.
"RTN","PXRMEXSI",176,0)
 ;ENTRY is the entry point in ROUTINE which is called to populate
"RTN","PXRMEXSI",177,0)
 ;ARRAY.
"RTN","PXRMEXSI",178,0)
 N RTN
"RTN","PXRMEXSI",179,0)
 S RTN=ENTRY_"^"_ROUTINE_"(MODE,.ARRAY)"
"RTN","PXRMEXSI",180,0)
 D @RTN
"RTN","PXRMEXSI",181,0)
 Q
"RTN","PXRMEXSI",182,0)
 ;
"RTN","PXRMEXSI",183,0)
 ;=======================================
"RTN","PXRMEXSI",184,0)
SMEXINS(ENTRY,ROUTINE) ;Silent mode install.
"RTN","PXRMEXSI",185,0)
 N ACTION,EXARRAY,FMTSTR,IC,IEN,LUVALUE,NOUT,NTI,PXRMINST,TEXT,TEXTOUT
"RTN","PXRMEXSI",186,0)
 S PXRMINST=1
"RTN","PXRMEXSI",187,0)
 D LDARRAY^PXRMEXSI("IA",ENTRY,ROUTINE,.EXARRAY)
"RTN","PXRMEXSI",188,0)
 S NTI=$O(EXARRAY(""),-1),NTI=$L(NTI)+1
"RTN","PXRMEXSI",189,0)
 S FMTSTR=NTI_"R1^"_(77-NTI)_"L"
"RTN","PXRMEXSI",190,0)
 S IC=0
"RTN","PXRMEXSI",191,0)
 F  S IC=$O(EXARRAY(IC)) Q:'IC  D
"RTN","PXRMEXSI",192,0)
 . S LUVALUE(1)=EXARRAY(IC,1),LUVALUE(2)=EXARRAY(IC,2)
"RTN","PXRMEXSI",193,0)
 . S IEN=+$$FIND1^DIC(811.8,"","KU",.LUVALUE)
"RTN","PXRMEXSI",194,0)
 . I IEN=0 Q
"RTN","PXRMEXSI",195,0)
 . S TEXT=IC_".^Installing Reminder Exchange entry "_LUVALUE(1)
"RTN","PXRMEXSI",196,0)
 . K TEXTOUT
"RTN","PXRMEXSI",197,0)
 . D COLFMT^PXRMTEXT(FMTSTR,TEXT," ",.NOUT,.TEXTOUT)
"RTN","PXRMEXSI",198,0)
 . D MES^XPDUTL(.TEXTOUT)
"RTN","PXRMEXSI",199,0)
 . S ACTION=EXARRAY(IC,3)
"RTN","PXRMEXSI",200,0)
 . D INSTALL^PXRMEXSI(IEN,ACTION,1,1)
"RTN","PXRMEXSI",201,0)
 Q
"RTN","PXRMEXSI",202,0)
 ;
"RTN","PXRMFF")
0^25^B65126590
"RTN","PXRMFF",1,0)
PXRMFF ;SLC/PKR - Clinical Reminders function finding evaluation. ;09/18/2012
"RTN","PXRMFF",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,11,18,22,24**;Feb 04, 2005;Build 193
"RTN","PXRMFF",3,0)
 ;===========================================
"RTN","PXRMFF",4,0)
EVAL(DFN,DEFARR,FIEVAL) ;Evaluate function findings.
"RTN","PXRMFF",5,0)
 N FFIND,FFN,ARGLIST,FN,FUN,FUNIND,FUNN,FVALUE,JND
"RTN","PXRMFF",6,0)
 N LOGIC,LOGVAL,NL,NLOGIC,ROUTINE,TEMP
"RTN","PXRMFF",7,0)
 I '$D(DEFARR(25)) Q
"RTN","PXRMFF",8,0)
 S FFN="FF"
"RTN","PXRMFF",9,0)
 F  S FFN=$O(DEFARR(25,FFN)) Q:FFN'["FF"  D
"RTN","PXRMFF",10,0)
 . K FN
"RTN","PXRMFF",11,0)
 . S FUNIND=0
"RTN","PXRMFF",12,0)
 . F  S FUNIND=+$O(DEFARR(25,FFN,5,FUNIND)) Q:FUNIND=0  D
"RTN","PXRMFF",13,0)
 .. S FUNN=$P(DEFARR(25,FFN,5,FUNIND,0),U,1)
"RTN","PXRMFF",14,0)
 .. S FUN=$P(DEFARR(25,FFN,5,FUNIND,0),U,2)
"RTN","PXRMFF",15,0)
 .. S TEMP=^PXRMD(802.4,FUN,0)
"RTN","PXRMFF",16,0)
 .. S ROUTINE=$P(TEMP,U,2,3)_"(.ARGLIST,.FIEVAL,.FVALUE)"
"RTN","PXRMFF",17,0)
 .. K ARGLIST
"RTN","PXRMFF",18,0)
 .. S (JND,NL)=0
"RTN","PXRMFF",19,0)
 .. F  S JND=+$O(DEFARR(25,FFN,5,FUNIND,20,JND)) Q:JND=0  D
"RTN","PXRMFF",20,0)
 ... S NL=NL+1
"RTN","PXRMFF",21,0)
 ... S ARGLIST(NL)=DEFARR(25,FFN,5,FUNIND,20,JND,0)
"RTN","PXRMFF",22,0)
 .. S ARGLIST(0)=NL
"RTN","PXRMFF",23,0)
 .. D @ROUTINE
"RTN","PXRMFF",24,0)
 .. S FN(FUNIND)=FVALUE
"RTN","PXRMFF",25,0)
 . S LOGIC=$G(DEFARR(25,FFN,10))
"RTN","PXRMFF",26,0)
 . S LOGIC=$S(LOGIC'="":LOGIC,1:0)
"RTN","PXRMFF",27,0)
 . S NLOGIC=$$NLOGIC(LOGIC,.FN)
"RTN","PXRMFF",28,0)
 . S LOGVAL=$$EVALLOG(NLOGIC)
"RTN","PXRMFF",29,0)
 . S FIEVAL(FFN)=LOGVAL
"RTN","PXRMFF",30,0)
 . S FIEVAL(FFN,"NUMBER")=$P(FFN,"FF",2)
"RTN","PXRMFF",31,0)
 . S FIEVAL(FFN,"FINDING")=$G(FUN)_";PXRMD(802.4,"
"RTN","PXRMFF",32,0)
 . I $G(PXRMDEBG) D
"RTN","PXRMFF",33,0)
 .. S ^TMP(PXRMPID,$J,"FFDEB",FFN,"DETAIL")=FIEVAL(FFN)_U_DEFARR(25,FFN,3)_U_NLOGIC
"RTN","PXRMFF",34,0)
 .. I $G(PXRMFFSS) D SBSDISP(NLOGIC,FFN)
"RTN","PXRMFF",35,0)
 Q
"RTN","PXRMFF",36,0)
 ;
"RTN","PXRMFF",37,0)
 ;===========================================
"RTN","PXRMFF",38,0)
EVALLOG(NLOGIC) ;Evaluate the logic string.
"RTN","PXRMFF",39,0)
 N DIVBY0,DIVOP,IND,NULL,NUMSTACK,OP1,OP2,OPER,OPERS,PFSTACK
"RTN","PXRMFF",40,0)
 N RES,TEMP,UNARY
"RTN","PXRMFF",41,0)
 I NLOGIC="" Q 0
"RTN","PXRMFF",42,0)
 S NULL=""
"RTN","PXRMFF",43,0)
 S DIVBY0=0,DIVOP="/\#"
"RTN","PXRMFF",44,0)
 S OPERS=$$GETOPERS^PXRMFFDB
"RTN","PXRMFF",45,0)
 D POSTFIX^PXRMSTAC(NLOGIC,OPERS,.PFSTACK)
"RTN","PXRMFF",46,0)
 F IND=1:1:PFSTACK(0) D
"RTN","PXRMFF",47,0)
 . S TEMP=PFSTACK(IND)
"RTN","PXRMFF",48,0)
 . S OPER=$P(TEMP,"U",1)
"RTN","PXRMFF",49,0)
 . I OPERS'[OPER D PUSH^PXRMSTAC(.NUMSTACK,TEMP) Q
"RTN","PXRMFF",50,0)
 .;If control gets to here we have an operator.
"RTN","PXRMFF",51,0)
 .;Check for a unary operator
"RTN","PXRMFF",52,0)
 . S UNARY=$S($E(TEMP,2)="U":1,1:0)
"RTN","PXRMFF",53,0)
 . S OP2=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",54,0)
 . I UNARY S TEMP="S RES="_OPER_"OP2"
"RTN","PXRMFF",55,0)
 . I 'UNARY D
"RTN","PXRMFF",56,0)
 .. S OP1=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",57,0)
 ..;Flag division by 0 with ~
"RTN","PXRMFF",58,0)
 .. I DIVOP[OPER,+OP2=0 S DIVBY0=1,TEMP="S RES=""~"""
"RTN","PXRMFF",59,0)
 .. E  S TEMP="S RES=OP1"_OPER_"OP2"
"RTN","PXRMFF",60,0)
 .;Do the math and put the result on the stack. The result of division
"RTN","PXRMFF",61,0)
 .;by 0 with any operator is 0.
"RTN","PXRMFF",62,0)
 . I ($G(OP1)="~")!(OP2="~") S RES=0
"RTN","PXRMFF",63,0)
 . E  X TEMP
"RTN","PXRMFF",64,0)
 . D PUSH^PXRMSTAC(.NUMSTACK,RES)
"RTN","PXRMFF",65,0)
 S RES=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",66,0)
 I PFSTACK(0)=1 D
"RTN","PXRMFF",67,0)
 . I @NLOGIC S RES=1
"RTN","PXRMFF",68,0)
 . E  S RES=0
"RTN","PXRMFF",69,0)
 Q RES
"RTN","PXRMFF",70,0)
 ;
"RTN","PXRMFF",71,0)
 ;===========================================
"RTN","PXRMFF",72,0)
EVALPL(DEFARR,FFIND,PLIST) ;Build a list of patients based on a function
"RTN","PXRMFF",73,0)
 ;finding.
"RTN","PXRMFF",74,0)
 N ARGL,ARGLIST,AT,COUNT,DAS,DATE,DFN
"RTN","PXRMFF",75,0)
 N FI,FIEVAL,FIEVT,FILIST,FILENUM,FINDPA,FN
"RTN","PXRMFF",76,0)
 N FUN,FUNCTION,FUNNM,FUNN,FUNNUM,FVALUE
"RTN","PXRMFF",77,0)
 N IND,ITEM,JND,LOGIC,LNAME,NARG,NFI,NFUN
"RTN","PXRMFF",78,0)
 N ROUTINE,TEMP,TERMARR,UNIQFIL
"RTN","PXRMFF",79,0)
 S LOGIC=DEFARR(25,FFIND,10)
"RTN","PXRMFF",80,0)
 I LOGIC="" Q
"RTN","PXRMFF",81,0)
 ;Build the list of functions and findings used by the function finding.
"RTN","PXRMFF",82,0)
 S (FUNNUM,NFUN)=0
"RTN","PXRMFF",83,0)
 F  S FUNNUM=+$O(DEFARR(25,FFIND,5,FUNNUM)) Q:FUNNUM=0  D
"RTN","PXRMFF",84,0)
 . S NFUN=NFUN+1
"RTN","PXRMFF",85,0)
 . S FUNN=$P(DEFARR(25,FFIND,5,FUNNUM,0),U,1)
"RTN","PXRMFF",86,0)
 . S FUN=$P(DEFARR(25,FFIND,5,FUNNUM,0),U,2)
"RTN","PXRMFF",87,0)
 . S TEMP=^PXRMD(802.4,FUN,0)
"RTN","PXRMFF",88,0)
 . S FUN=$P(TEMP,U,1)
"RTN","PXRMFF",89,0)
 . S FUNCTION(NFUN)=$TR(FUN,"_","")
"RTN","PXRMFF",90,0)
 . S ROUTINE(NFUN)=$P(TEMP,U,2,3)_"(.ARGL,.FIEVAL,.FVALUE)"
"RTN","PXRMFF",91,0)
 . S (FI,NARG,NFI)=0
"RTN","PXRMFF",92,0)
 . F  S FI=+$O(DEFARR(25,FFIND,5,FUNNUM,20,FI)) Q:FI=0  D
"RTN","PXRMFF",93,0)
 .. S NARG=NARG+1,ARGLIST(NFUN,NARG)=DEFARR(25,FFIND,5,FUNNUM,20,FI,0)
"RTN","PXRMFF",94,0)
 .. S AT=$$ARGTYPE^PXRMFFAT(FUNCTION(NFUN),FI)
"RTN","PXRMFF",95,0)
 .. I AT="F" S NFI=NFI+1,FILIST(NFUN,NFI)=ARGLIST(NFUN,NARG)
"RTN","PXRMFF",96,0)
 . S ARGLIST(NFUN,0)=NARG
"RTN","PXRMFF",97,0)
 . S FILIST(NFUN,0)=NFI
"RTN","PXRMFF",98,0)
 ;A finding may be used in more than one function in the function
"RTN","PXRMFF",99,0)
 ;finding so build a list of the unique findings.
"RTN","PXRMFF",100,0)
 F IND=1:1:NFUN D
"RTN","PXRMFF",101,0)
 . F JND=1:1:FILIST(IND,0) D
"RTN","PXRMFF",102,0)
 .. S TEMP=$P(DEFARR(20,FILIST(IND,JND),0),U,1)
"RTN","PXRMFF",103,0)
 .. S ITEM=$P(TEMP,";",1)
"RTN","PXRMFF",104,0)
 .. S FILENUM=$$GETFNUM^PXRMDATA($P(TEMP,";",2))
"RTN","PXRMFF",105,0)
 .. S UNIQFIL(FILIST(IND,JND))=""
"RTN","PXRMFF",106,0)
 K ^TMP($J,"PXRMFFDFN")
"RTN","PXRMFF",107,0)
 S IND=0
"RTN","PXRMFF",108,0)
 F  S IND=$O(UNIQFIL(IND)) Q:IND=""  D
"RTN","PXRMFF",109,0)
 . S FINDPA(0)=DEFARR(20,IND,0)
"RTN","PXRMFF",110,0)
 . S FINDPA(3)=DEFARR(20,IND,3)
"RTN","PXRMFF",111,0)
 . S FINDPA(10)=DEFARR(20,IND,10)
"RTN","PXRMFF",112,0)
 . S FINDPA(11)=DEFARR(20,IND,11)
"RTN","PXRMFF",113,0)
 . D GENTERM^PXRMPLST(FINDPA(0),IND,.TERMARR)
"RTN","PXRMFF",114,0)
 . S LNAME(IND)="PXRMFF"_IND
"RTN","PXRMFF",115,0)
 . K ^TMP($J,LNAME(IND))
"RTN","PXRMFF",116,0)
 . D EVALPL^PXRMTERL(.FINDPA,.TERMARR,LNAME(IND))
"RTN","PXRMFF",117,0)
 .;Get rid of the false part of the list.
"RTN","PXRMFF",118,0)
 . K ^TMP($J,LNAME(IND),0)
"RTN","PXRMFF",119,0)
 .;Build a complete list of patients.
"RTN","PXRMFF",120,0)
 . S DFN=0
"RTN","PXRMFF",121,0)
 . F  S DFN=$O(^TMP($J,LNAME(IND),1,DFN)) Q:DFN=""  S ^TMP($J,"PXRMFFDFN",DFN)=""
"RTN","PXRMFF",122,0)
 ;Evaluate the function finding for each patient. If the function
"RTN","PXRMFF",123,0)
 ;finding is true then add the patient to PLIST.
"RTN","PXRMFF",124,0)
 S DFN=0
"RTN","PXRMFF",125,0)
 F  S DFN=$O(^TMP($J,"PXRMFFDFN",DFN)) Q:DFN=""  D
"RTN","PXRMFF",126,0)
 . K FIEVAL
"RTN","PXRMFF",127,0)
 . S IND=""
"RTN","PXRMFF",128,0)
 . F  S IND=$O(UNIQFIL(IND)) Q:IND=""  D
"RTN","PXRMFF",129,0)
 .. S FIEVAL(IND)=0
"RTN","PXRMFF",130,0)
 .. S ITEM=""
"RTN","PXRMFF",131,0)
 .. F  S ITEM=$O(^TMP($J,LNAME(IND),1,DFN,ITEM)) Q:ITEM=""  D
"RTN","PXRMFF",132,0)
 ... S COUNT=0
"RTN","PXRMFF",133,0)
 ... F  S COUNT=$O(^TMP($J,LNAME(IND),1,DFN,ITEM,COUNT)) Q:COUNT=""  D
"RTN","PXRMFF",134,0)
 .... S FILENUM=$O(^TMP($J,LNAME(IND),1,DFN,ITEM,COUNT,""))
"RTN","PXRMFF",135,0)
 .... S TEMP=^TMP($J,LNAME(IND),1,DFN,ITEM,COUNT,FILENUM)
"RTN","PXRMFF",136,0)
 .... S DAS=$P(TEMP,U,1)
"RTN","PXRMFF",137,0)
 .... S DATE=$P(TEMP,U,2)
"RTN","PXRMFF",138,0)
 .... K FIEVT
"RTN","PXRMFF",139,0)
 .... D GETDATA^PXRMDATA(FILENUM,DAS,.FIEVT)
"RTN","PXRMFF",140,0)
 .... M FIEVAL(IND,COUNT)=FIEVT
"RTN","PXRMFF",141,0)
 .... S FIEVAL(IND,COUNT,"DATE")=DATE,FIEVAL(IND,COUNT)=1
"RTN","PXRMFF",142,0)
 .;Save the top level results for each finding.
"RTN","PXRMFF",143,0)
 . S IND=0
"RTN","PXRMFF",144,0)
 . F  S IND=$O(FIEVAL(IND)) Q:IND=""  D
"RTN","PXRMFF",145,0)
 .. K FIEVT M FIEVT=FIEVAL(IND)
"RTN","PXRMFF",146,0)
 .. S NFI=+$O(FIEVT(""),-1)
"RTN","PXRMFF",147,0)
 .. D SFRES^PXRMUTIL(-1,NFI,.FIEVT)
"RTN","PXRMFF",148,0)
 .. K FIEVAL(IND) M FIEVAL(IND)=FIEVT
"RTN","PXRMFF",149,0)
 .;Evaluate the function finding for this patient.
"RTN","PXRMFF",150,0)
 . K FN
"RTN","PXRMFF",151,0)
 . F IND=1:1:NFUN D
"RTN","PXRMFF",152,0)
 .. K ARGL M ARGL=ARGLIST(IND)
"RTN","PXRMFF",153,0)
 .. D @ROUTINE(IND)
"RTN","PXRMFF",154,0)
 .. S FN(IND)=FVALUE
"RTN","PXRMFF",155,0)
 . I @LOGIC S ^TMP($J,PLIST,1,DFN,1,FFIND)=""
"RTN","PXRMFF",156,0)
 ;Clean up.
"RTN","PXRMFF",157,0)
 K ^TMP($J,"PXRMFFDFN")
"RTN","PXRMFF",158,0)
 S IND=""
"RTN","PXRMFF",159,0)
 F  S IND=$O(UNIQFIL(IND)) Q:IND=""  K ^TMP($J,LNAME(IND))
"RTN","PXRMFF",160,0)
 Q
"RTN","PXRMFF",161,0)
 ;
"RTN","PXRMFF",162,0)
 ;===========================================
"RTN","PXRMFF",163,0)
MHVOUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the MHV output.
"RTN","PXRMFF",164,0)
 ;None currently defined.
"RTN","PXRMFF",165,0)
 Q
"RTN","PXRMFF",166,0)
 ;
"RTN","PXRMFF",167,0)
 ;===========================================
"RTN","PXRMFF",168,0)
NLOGIC(LOGIC,FN) ;Replace the symbols in the logic string with their values.
"RTN","PXRMFF",169,0)
 N IND,NLOGIC,TEMP
"RTN","PXRMFF",170,0)
 I LOGIC="" Q 0
"RTN","PXRMFF",171,0)
 S NLOGIC=LOGIC
"RTN","PXRMFF",172,0)
 I NLOGIC["$P" S NLOGIC=$$PRP(NLOGIC)
"RTN","PXRMFF",173,0)
 I $D(PXRMAGE) S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"PXRMAGE",PXRMAGE)
"RTN","PXRMFF",174,0)
 I $D(PXRMDOB) S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"PXRMDOB",PXRMDOB)
"RTN","PXRMFF",175,0)
 I $D(PXRMDOD) S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"PXRMDOD",PXRMDOD)
"RTN","PXRMFF",176,0)
 I $D(PXRMLAD) S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"PXRMLAD",PXRMLAD)
"RTN","PXRMFF",177,0)
 I $D(PXRMSEX) S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"PXRMSEX",""""_PXRMSEX_"""")
"RTN","PXRMFF",178,0)
 S IND=""
"RTN","PXRMFF",179,0)
 F  S IND=$O(FN(IND)) Q:IND=""  D
"RTN","PXRMFF",180,0)
 . S TEMP=$S(FN(IND)="":"NULL",+FN(IND)'=FN(IND):""""_FN(IND)_"""",1:FN(IND))
"RTN","PXRMFF",181,0)
 . S NLOGIC=$$STRREP^PXRMUTIL(NLOGIC,"FN("_IND_")",TEMP)
"RTN","PXRMFF",182,0)
 Q NLOGIC
"RTN","PXRMFF",183,0)
 ;
"RTN","PXRMFF",184,0)
 ;===========================================
"RTN","PXRMFF",185,0)
OUTPUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the clinical
"RTN","PXRMFF",186,0)
 ;maintenance output. None currently defined.
"RTN","PXRMFF",187,0)
 Q
"RTN","PXRMFF",188,0)
 ;
"RTN","PXRMFF",189,0)
 ;===========================================
"RTN","PXRMFF",190,0)
PRP(LOGIC) ;Process $P in logic.
"RTN","PXRMFF",191,0)
 N IND,PFSTACK,RES,T1,TEMP
"RTN","PXRMFF",192,0)
 D POSTFIX^PXRMSTAC(LOGIC,"",.PFSTACK)
"RTN","PXRMFF",193,0)
 F IND=1:1:PFSTACK(0) D
"RTN","PXRMFF",194,0)
 . I PFSTACK(IND)'="$P" Q
"RTN","PXRMFF",195,0)
 . S IND=IND+1,T1=PFSTACK(IND)
"RTN","PXRMFF",196,0)
 . I T1="FN" S IND=IND+1,T1=T1_"("_PFSTACK(IND)_")",IND=IND+1,T1=T1_PFSTACK(IND)
"RTN","PXRMFF",197,0)
 . S TEMP="$P("_T1_")"
"RTN","PXRMFF",198,0)
 . S T1="S RES="_TEMP
"RTN","PXRMFF",199,0)
 . X T1
"RTN","PXRMFF",200,0)
 . I RES="" S RES="NULL"
"RTN","PXRMFF",201,0)
 . S LOGIC=$$STRREP^PXRMUTIL(LOGIC,TEMP,RES)
"RTN","PXRMFF",202,0)
 Q LOGIC
"RTN","PXRMFF",203,0)
 ;
"RTN","PXRMFF",204,0)
 ;===========================================
"RTN","PXRMFF",205,0)
SBSDISP(NLOGIC,FFN) ;Create a step-by-step display of the function finding
"RTN","PXRMFF",206,0)
 ;evaluation for reminder test.
"RTN","PXRMFF",207,0)
 N DIVOP,IND,NUMSTACK,OP1,OP2,OPER,OPERS,PFSTACK
"RTN","PXRMFF",208,0)
 N RES,TEMP,TEXT,UNARY
"RTN","PXRMFF",209,0)
 N NSTEPS,REPL
"RTN","PXRMFF",210,0)
 I NLOGIC="" Q 0
"RTN","PXRMFF",211,0)
 K ^TMP("PXRMFFSS",$J,FFN)
"RTN","PXRMFF",212,0)
 S ^TMP("PXRMFFSS",$J,FFN,0)=NLOGIC
"RTN","PXRMFF",213,0)
 S NSTEPS=0
"RTN","PXRMFF",214,0)
 S DIVOP="/\#"
"RTN","PXRMFF",215,0)
 S OPERS=$$GETOPERS^PXRMFFDB
"RTN","PXRMFF",216,0)
 D POSTFIX^PXRMSTAC(NLOGIC,OPERS,.PFSTACK)
"RTN","PXRMFF",217,0)
 F IND=1:1:PFSTACK(0) D
"RTN","PXRMFF",218,0)
 . S TEMP=PFSTACK(IND)
"RTN","PXRMFF",219,0)
 . S OPER=$P(TEMP,"U",1)
"RTN","PXRMFF",220,0)
 . I OPERS'[OPER D PUSH^PXRMSTAC(.NUMSTACK,TEMP) Q
"RTN","PXRMFF",221,0)
 .;If control gets to here we have an operator.
"RTN","PXRMFF",222,0)
 .;Check for a unary operator
"RTN","PXRMFF",223,0)
 . S UNARY=$S($E(TEMP,2)="U":1,1:0)
"RTN","PXRMFF",224,0)
 . S OP2=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",225,0)
 . I UNARY S TEMP="S RES="_OPER_"OP2",TEXT=OPER_OP2
"RTN","PXRMFF",226,0)
 . I 'UNARY D
"RTN","PXRMFF",227,0)
 .. S OP1=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",228,0)
 ..;Flag division by 0 with ~
"RTN","PXRMFF",229,0)
 .. I DIVOP[OPER,+OP2=0 S TEMP="S RES=""~""",TEXT="0/0"
"RTN","PXRMFF",230,0)
 .. E  S TEMP="S RES=OP1"_OPER_"OP2",TEXT=OP1_OPER_OP2
"RTN","PXRMFF",231,0)
 .;Do the math and put the result on the stack. The result of division
"RTN","PXRMFF",232,0)
 .;by 0 with any operator is 0.
"RTN","PXRMFF",233,0)
 . I ($G(OP1)="~")!(OP2="~") S RES=0
"RTN","PXRMFF",234,0)
 . E  X TEMP
"RTN","PXRMFF",235,0)
 . S NSTEPS=NSTEPS+1
"RTN","PXRMFF",236,0)
 . S ^TMP("PXRMFFSS",$J,FFN,NSTEPS)=TEXT_"="_RES
"RTN","PXRMFF",237,0)
 . D PUSH^PXRMSTAC(.NUMSTACK,RES)
"RTN","PXRMFF",238,0)
 S RES=$$POP^PXRMSTAC(.NUMSTACK)
"RTN","PXRMFF",239,0)
 I PFSTACK(0)=1 D
"RTN","PXRMFF",240,0)
 . S RES=$S(NLOGIC:1,1:0)
"RTN","PXRMFF",241,0)
 . S ^TMP("PXRMFFSS",$J,FFN,1)=PFSTACK(1)_"="_RES
"RTN","PXRMFF",242,0)
 Q
"RTN","PXRMFF",243,0)
 ;
"RTN","PXRMICHK")
0^14^B132138736
"RTN","PXRMICHK",1,0)
PXRMICHK ;SLC/PKR - Integrity checking routines. ;04/24/2012
"RTN","PXRMICHK",2,0)
 ;;2.0;CLINICAL REMINDERS;**18,24**;Feb 04, 2005;Build 193
"RTN","PXRMICHK",3,0)
 ;
"RTN","PXRMICHK",4,0)
 ;======================================================
"RTN","PXRMICHK",5,0)
CCRLOGIC(COHOK,RESOK,DEFARR) ;Check cohort and resolution logic.
"RTN","PXRMICHK",6,0)
 N AGE,FIEVAL,FINDING,FF,FLIST,IND,JND,NUM,OCCN,PCLOG
"RTN","PXRMICHK",7,0)
 N RESLOG,RESLSTR,SEX,TEMP,TEST,TEXT
"RTN","PXRMICHK",8,0)
 N PXRMAGE,PXRMDOB,PXRMDOD,PXRMLAD,PXRMSEX
"RTN","PXRMICHK",9,0)
 S (PXRMAGE,PXRMDOB,PXRMDOD,PXRMLAD)=0
"RTN","PXRMICHK",10,0)
 S PXRMSEX=""
"RTN","PXRMICHK",11,0)
 ;Set all findings false.
"RTN","PXRMICHK",12,0)
 S (FIEVAL("AGE"),FIEVAL("SEX"))=0
"RTN","PXRMICHK",13,0)
 S IND=0
"RTN","PXRMICHK",14,0)
 F  S IND=+$O(DEFARR(20,IND)) Q:IND=0  D
"RTN","PXRMICHK",15,0)
 . S FIEVAL(IND)=0
"RTN","PXRMICHK",16,0)
 . S OCCN=$P(DEFARR(20,IND,0),U,14)
"RTN","PXRMICHK",17,0)
 . F JND=1:1:OCCN S FIEVAL(IND,JND)=0
"RTN","PXRMICHK",18,0)
 ;Evaluate function findings with all findings false.
"RTN","PXRMICHK",19,0)
 D EVAL^PXRMFF(0,.DEFARR,.FIEVAL)
"RTN","PXRMICHK",20,0)
 I COHOK D
"RTN","PXRMICHK",21,0)
 . S TEMP=DEFARR(32)
"RTN","PXRMICHK",22,0)
 . S NUM=+$P(TEMP,U,1)
"RTN","PXRMICHK",23,0)
 . I NUM=0 Q
"RTN","PXRMICHK",24,0)
 . S PCLOG=DEFARR(31)
"RTN","PXRMICHK",25,0)
 . S FLIST=$P(TEMP,U,2)
"RTN","PXRMICHK",26,0)
 . F IND=1:1:NUM D
"RTN","PXRMICHK",27,0)
 .. S FINDING=$P(FLIST,";",IND)
"RTN","PXRMICHK",28,0)
 .. I FINDING="AGE" S AGE=+$G(FIEVAL("AGE"))
"RTN","PXRMICHK",29,0)
 .. I FINDING="SEX" S SEX=+$G(FIEVAL("SEX"))
"RTN","PXRMICHK",30,0)
 .. I FINDING["FF" S TEMP=$P(FINDING,"FF",2),FF(TEMP)=FIEVAL(FINDING)
"RTN","PXRMICHK",31,0)
 .. E  S FI(FINDING)=FIEVAL(FINDING)
"RTN","PXRMICHK",32,0)
 . I @PCLOG
"RTN","PXRMICHK",33,0)
 . S TEST=$T
"RTN","PXRMICHK",34,0)
 . I TEST D
"RTN","PXRMICHK",35,0)
 .. S TEXT(1)="Warning cohort logic is true even when there are no true findings!"
"RTN","PXRMICHK",36,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",37,0)
 I RESOK D
"RTN","PXRMICHK",38,0)
 . S TEMP=DEFARR(36)
"RTN","PXRMICHK",39,0)
 . S NUM=+$P(TEMP,U,1)
"RTN","PXRMICHK",40,0)
 . I NUM=0 Q
"RTN","PXRMICHK",41,0)
 . S (RESLOG,RESLSTR)=DEFARR(35)
"RTN","PXRMICHK",42,0)
 . S FLIST=$P(TEMP,U,2)
"RTN","PXRMICHK",43,0)
 . F IND=1:1:NUM D
"RTN","PXRMICHK",44,0)
 .. S FINDING=$P(FLIST,";",IND)
"RTN","PXRMICHK",45,0)
 .. I FINDING["FF" S TEMP=$P(FINDING,"FF",2),FF(TEMP)=FIEVAL(FINDING)
"RTN","PXRMICHK",46,0)
 .. E  S FI(FINDING)=FIEVAL(FINDING)
"RTN","PXRMICHK",47,0)
 . I @RESLOG
"RTN","PXRMICHK",48,0)
 . S TEST=$T
"RTN","PXRMICHK",49,0)
 . I TEST D
"RTN","PXRMICHK",50,0)
 .. S TEXT(1)="Warning resolution logic is true even when there are no true findings!"
"RTN","PXRMICHK",51,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",52,0)
 Q
"RTN","PXRMICHK",53,0)
 ;
"RTN","PXRMICHK",54,0)
 ;======================================================
"RTN","PXRMICHK",55,0)
CHECKALL ;Check all definitions.
"RTN","PXRMICHK",56,0)
 N IEN,NAME,OK,POP,PXRMDONE,TEXT
"RTN","PXRMICHK",57,0)
 W #!,"Check the integrity of all reminder definitions."
"RTN","PXRMICHK",58,0)
 D ^%ZIS Q:POP
"RTN","PXRMICHK",59,0)
 U IO
"RTN","PXRMICHK",60,0)
 S NAME="",PXRMDONE=0
"RTN","PXRMICHK",61,0)
 F  S NAME=$O(^PXD(811.9,"B",NAME)) Q:(NAME="")!(PXRMDONE)  D
"RTN","PXRMICHK",62,0)
 . S IEN=$O(^PXD(811.9,"B",NAME,""))
"RTN","PXRMICHK",63,0)
 . S TEXT(1)=" "
"RTN","PXRMICHK",64,0)
 . S TEXT(2)="Checking "_NAME_" (IEN="_IEN_")"
"RTN","PXRMICHK",65,0)
 . D OUTPUT(2,.TEXT)
"RTN","PXRMICHK",66,0)
 . S OK=$$DEF^PXRMICHK(IEN)
"RTN","PXRMICHK",67,0)
 D ^%ZISC
"RTN","PXRMICHK",68,0)
 Q
"RTN","PXRMICHK",69,0)
 ;
"RTN","PXRMICHK",70,0)
 ;======================================================
"RTN","PXRMICHK",71,0)
CHECKONE ;Check selected definitions.
"RTN","PXRMICHK",72,0)
 N DIC,DTOUT,DUOUT,IEN,Y
"RTN","PXRMICHK",73,0)
 S DIC="^PXD(811.9,"
"RTN","PXRMICHK",74,0)
 S DIC(0)="AEMQ"
"RTN","PXRMICHK",75,0)
 S DIC("A")="Select Reminder Definition: "
"RTN","PXRMICHK",76,0)
GETDEF ;Get the definition to check.
"RTN","PXRMICHK",77,0)
 W !
"RTN","PXRMICHK",78,0)
 D ^DIC
"RTN","PXRMICHK",79,0)
 I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","PXRMICHK",80,0)
 I Y=-1 Q
"RTN","PXRMICHK",81,0)
 S IEN=$P(Y,U,1)
"RTN","PXRMICHK",82,0)
 W #
"RTN","PXRMICHK",83,0)
 D DEF^PXRMICHK(IEN)
"RTN","PXRMICHK",84,0)
 G GETDEF
"RTN","PXRMICHK",85,0)
 Q
"RTN","PXRMICHK",86,0)
 ;
"RTN","PXRMICHK",87,0)
 ;======================================================
"RTN","PXRMICHK",88,0)
DATECHK(FINDING,DATE,TYPE,DEFARR) ;Check Beginning and Ending Date/Times if
"RTN","PXRMICHK",89,0)
 ;they contain FIEVAL.
"RTN","PXRMICHK",90,0)
 N ARGS,DFI,DTYPE,OCC,OCN,OK,TEXT
"RTN","PXRMICHK",91,0)
 S OK=1
"RTN","PXRMICHK",92,0)
 S ARGS=$E(DATE,$F(DATE,"FIEVAL("),$F(DATE,"""DATE"")")-9)
"RTN","PXRMICHK",93,0)
 I ARGS="" Q OK
"RTN","PXRMICHK",94,0)
 S DFI=$P(ARGS,",",1)
"RTN","PXRMICHK",95,0)
 I '$D(DEFARR(20,DFI)) D
"RTN","PXRMICHK",96,0)
 . S DTYPE=$S(TYPE="BDT":"Beginning Date/Time",TYPE="EDT":"Ending Date/Time")
"RTN","PXRMICHK",97,0)
 . S TEXT(1)=DTYPE_" for finding number "_FINDING_" uses finding number "_DFI_" which does not exist."
"RTN","PXRMICHK",98,0)
 . D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",99,0)
 . S OK=0
"RTN","PXRMICHK",100,0)
 I OK D
"RTN","PXRMICHK",101,0)
 . S OCN=$P(ARGS,",",2)
"RTN","PXRMICHK",102,0)
 . I OCN="" Q
"RTN","PXRMICHK",103,0)
 . S OCC=+$P(DEFARR(20,DFI,0),U,14)
"RTN","PXRMICHK",104,0)
 . S OCC=$S(OCC=0:1,OCC>0:OCC,1:-OCC)
"RTN","PXRMICHK",105,0)
 . I OCN>OCC D
"RTN","PXRMICHK",106,0)
 .. S DTYPE=$S(TYPE="BDT":"Beginning Date/Time",TYPE="EDT":"Ending Date/Time")
"RTN","PXRMICHK",107,0)
 .. S TEXT(1)=DTYPE_" for finding number "_FINDING_" uses occurrence "_OCN_" of finding number "_DFI_";"
"RTN","PXRMICHK",108,0)
 .. S TEXT(2)="the Occurrence Count for finding "_DFI_" is "_OCC_"."
"RTN","PXRMICHK",109,0)
 .. D OUTPUT(2,.TEXT)
"RTN","PXRMICHK",110,0)
 .. S OK=0
"RTN","PXRMICHK",111,0)
 Q OK
"RTN","PXRMICHK",112,0)
 ;
"RTN","PXRMICHK",113,0)
 ;======================================================
"RTN","PXRMICHK",114,0)
DEF(IEN) ;Definition integrity check.
"RTN","PXRMICHK",115,0)
 N ARGTYPE,BDT,EDT,CFPR,CFNAME,COHOK,DEFARR,FFNUM,FI,FIEN,FLIST,FNUM
"RTN","PXRMICHK",116,0)
 N FUNCTION,GBL,IND,JND,KND,OCC,OCN,LOGSTR,NFI,NBFREQ,NFFREQ,OK,RESOK
"RTN","PXRMICHK",117,0)
 N TEXT,USAGE,ZNODE
"RTN","PXRMICHK",118,0)
 S OK=1
"RTN","PXRMICHK",119,0)
 ;Check usage.
"RTN","PXRMICHK",120,0)
 S ZNODE=^PXD(811.9,IEN,100)
"RTN","PXRMICHK",121,0)
 S USAGE=$P(ZNODE,U,4)
"RTN","PXRMICHK",122,0)
 I $P(ZNODE,U,1)'="N",USAGE["P" D
"RTN","PXRMICHK",123,0)
 . K TEXT
"RTN","PXRMICHK",124,0)
 . S TEXT(1)="Warning: Usage field contains a ""P"" and this is not a national reminder definition."
"RTN","PXRMICHK",125,0)
 . D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",126,0)
 ;
"RTN","PXRMICHK",127,0)
 D DEF^PXRMLDR(IEN,.DEFARR)
"RTN","PXRMICHK",128,0)
 ;Check findings and finding modifiers.
"RTN","PXRMICHK",129,0)
 S IND=0
"RTN","PXRMICHK",130,0)
 F  S IND=+$O(DEFARR(20,IND)) Q:IND=0  D
"RTN","PXRMICHK",131,0)
 . S ZNODE=DEFARR(20,IND,0)
"RTN","PXRMICHK",132,0)
 . S FI=$P(ZNODE,U,1)
"RTN","PXRMICHK",133,0)
 . S FIEN=$P(FI,";",1)
"RTN","PXRMICHK",134,0)
 . S GBL=$P(FI,";",2)
"RTN","PXRMICHK",135,0)
 . I (FIEN'=+FIEN)!(GBL="") D  Q
"RTN","PXRMICHK",136,0)
 .. K TEXT
"RTN","PXRMICHK",137,0)
 .. S TEXT(1)="Finding number "_IND_" is invalid."
"RTN","PXRMICHK",138,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",139,0)
 .. S OK=0
"RTN","PXRMICHK",140,0)
 . S FNUM=$$GETFNUM^PXRMEXPS(GBL)
"RTN","PXRMICHK",141,0)
 . I '$$FIND1^DIC(FNUM,"","X","`"_FIEN) D
"RTN","PXRMICHK",142,0)
 .. K TEXT
"RTN","PXRMICHK",143,0)
 .. S TEXT(1)="Finding number "_IND_", does not exist! It is entry number "_FIEN_" in file #"_FNUM_"."
"RTN","PXRMICHK",144,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",145,0)
 .. S OK=0
"RTN","PXRMICHK",146,0)
 . S BDT=$P(ZNODE,U,8)
"RTN","PXRMICHK",147,0)
 . I BDT["FIEVAL",'$$DATECHK(IND,BDT,"BDT",.DEFARR) S OK=0
"RTN","PXRMICHK",148,0)
 . S EDT=$P(ZNODE,U,11)
"RTN","PXRMICHK",149,0)
 . I EDT["FIEVAL",'$$DATECHK(IND,EDT,"EDT",.DEFARR) S OK=0
"RTN","PXRMICHK",150,0)
 .;Check computed findings to see if the Computed Finding Parameter
"RTN","PXRMICHK",151,0)
 .;is required.
"RTN","PXRMICHK",152,0)
 . I GBL="PXRMD(811.4," D
"RTN","PXRMICHK",153,0)
 .. S CFPR=$P(^PXRMD(811.4,FIEN,0),U,6)
"RTN","PXRMICHK",154,0)
 .. I CFPR,$G(DEFARR(20,IND,15))="" D
"RTN","PXRMICHK",155,0)
 ... S CFNAME=$P(^PXRMD(811.4,FIEN,0),U,1)
"RTN","PXRMICHK",156,0)
 ... K TEXT
"RTN","PXRMICHK",157,0)
 ... S TEXT(1)="Finding number "_IND_" uses computed finding "_CFNAME_"."
"RTN","PXRMICHK",158,0)
 ... S TEXT(2)="This computed finding will not work properly unless the"
"RTN","PXRMICHK",159,0)
 ... S TEXT(3)="Computed Finding Parameter is defined and in this case it is not."
"RTN","PXRMICHK",160,0)
 ... D OUTPUT(3,.TEXT)
"RTN","PXRMICHK",161,0)
 ... S OK=0
"RTN","PXRMICHK",162,0)
 ;
"RTN","PXRMICHK",163,0)
 ;Check function findings.
"RTN","PXRMICHK",164,0)
 S FFNUM="FF"
"RTN","PXRMICHK",165,0)
 F  S FFNUM=$O(DEFARR(25,FFNUM)) Q:FFNUM=""  D
"RTN","PXRMICHK",166,0)
 . S IND=$P(FFNUM,"FF",2)
"RTN","PXRMICHK",167,0)
 .;Check for an invalid function string.
"RTN","PXRMICHK",168,0)
 . I $L($G(DEFARR(25,FFNUM,3)))<2 D  Q
"RTN","PXRMICHK",169,0)
 .. K TEXT
"RTN","PXRMICHK",170,0)
 .. S TEXT(1)="Function finding number "_IND_" has an invalid function string."
"RTN","PXRMICHK",171,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",172,0)
 .. S OK=0
"RTN","PXRMICHK",173,0)
 . S JND=0
"RTN","PXRMICHK",174,0)
 . F  S JND=+$O(DEFARR(25,FFNUM,5,JND)) Q:JND=0  D
"RTN","PXRMICHK",175,0)
 .. S FUNCTION=$P(DEFARR(25,FFNUM,5,JND,0),U,2)
"RTN","PXRMICHK",176,0)
 .. S FUNCTION=$P(^PXRMD(802.4,FUNCTION,0),U,1)
"RTN","PXRMICHK",177,0)
 .. S KND=0
"RTN","PXRMICHK",178,0)
 .. F  S KND=+$O(DEFARR(25,FFNUM,5,JND,20,KND)) Q:KND=0  D
"RTN","PXRMICHK",179,0)
 ... S ARGTYPE=$$ARGTYPE^PXRMFFAT(FUNCTION,KND)
"RTN","PXRMICHK",180,0)
 ... I ARGTYPE="F" D
"RTN","PXRMICHK",181,0)
 .... S FI=DEFARR(25,FFNUM,5,JND,20,KND,0)
"RTN","PXRMICHK",182,0)
 .... I '$D(DEFARR(20,FI,0)) D
"RTN","PXRMICHK",183,0)
 ..... K TEXT
"RTN","PXRMICHK",184,0)
 ..... S TEXT(1)="Function finding number "_IND_" depends on finding number "_FI_" which does not exist."
"RTN","PXRMICHK",185,0)
 ..... D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",186,0)
 ..... S OK=0
"RTN","PXRMICHK",187,0)
 ... I OK,ARGTYPE="N" D
"RTN","PXRMICHK",188,0)
 .... S OCN=DEFARR(25,FFNUM,5,JND,20,KND,0)
"RTN","PXRMICHK",189,0)
 .... S OCC=+$P(DEFARR(20,FI,0),U,14)
"RTN","PXRMICHK",190,0)
 .... S OCC=$S(OCC=0:1,OCC>0:OCC,1:-OCC)
"RTN","PXRMICHK",191,0)
 .... I OCN>OCC D
"RTN","PXRMICHK",192,0)
 ..... K TEXT
"RTN","PXRMICHK",193,0)
 ..... S TEXT(1)="Function finding number "_IND_" uses occurrence number "_OCN
"RTN","PXRMICHK",194,0)
 ..... S TEXT(2)="of finding number "_FI_"."
"RTN","PXRMICHK",195,0)
 ..... S TEXT(3)="The Occurrence Count for finding "_FI_" is "_OCC_"."
"RTN","PXRMICHK",196,0)
 ..... D OUTPUT(3,.TEXT)
"RTN","PXRMICHK",197,0)
 ..... S OK=0
"RTN","PXRMICHK",198,0)
 I 'OK Q 0
"RTN","PXRMICHK",199,0)
 ;
"RTN","PXRMICHK",200,0)
 ;Check custom date due.
"RTN","PXRMICHK",201,0)
 S IND=0
"RTN","PXRMICHK",202,0)
 F  S IND=+$O(DEFARR(47,IND)) Q:IND=0  D
"RTN","PXRMICHK",203,0)
 . S FI=$P(DEFARR(47,IND,0),U,1)
"RTN","PXRMICHK",204,0)
 . I '$D(DEFARR(20,FI,0)) D
"RTN","PXRMICHK",205,0)
 .. K TEXT
"RTN","PXRMICHK",206,0)
 .. S TEXT(1)="Custom Date Due depends on finding number "_FI_" which does not exist."
"RTN","PXRMICHK",207,0)
 .. D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",208,0)
 .. S OK=0
"RTN","PXRMICHK",209,0)
 ;
"RTN","PXRMICHK",210,0)
 ;Check cohort logic structure and dependencies.
"RTN","PXRMICHK",211,0)
 S LOGSTR=$G(DEFARR(31))
"RTN","PXRMICHK",212,0)
 S NFI=+$P($G(DEFARR(32)),U,1)
"RTN","PXRMICHK",213,0)
 S FLIST=$P($G(DEFARR(32)),U,2)
"RTN","PXRMICHK",214,0)
 S COHOK=$$LOGCHECK(NFI,FLIST,LOGSTR,"Patient Cohort",.DEFARR)
"RTN","PXRMICHK",215,0)
 I 'COHOK S OK=0
"RTN","PXRMICHK",216,0)
 ;
"RTN","PXRMICHK",217,0)
 ;If the USAGE is List, check the cohort logic to make sure it
"RTN","PXRMICHK",218,0)
 ;meets the special requirements.
"RTN","PXRMICHK",219,0)
 I USAGE["L",COHOK S COHOK=$$LCOHORTC(.DEFARR)
"RTN","PXRMICHK",220,0)
 I 'COHOK S OK=0
"RTN","PXRMICHK",221,0)
 ;
"RTN","PXRMICHK",222,0)
 ;Check resolution structure and dependencies. Resolution logic is
"RTN","PXRMICHK",223,0)
 ;not needed for "L" type reminders.
"RTN","PXRMICHK",224,0)
 I USAGE["L" S RESOK=1
"RTN","PXRMICHK",225,0)
 I USAGE'["L" D
"RTN","PXRMICHK",226,0)
 . S LOGSTR=$G(DEFARR(35))
"RTN","PXRMICHK",227,0)
 . S NFI=+$P($G(DEFARR(36)),U,1)
"RTN","PXRMICHK",228,0)
 . S FLIST=$P($G(DEFARR(36)),U,2)
"RTN","PXRMICHK",229,0)
 . S RESOK=$$LOGCHECK(NFI,FLIST,LOGSTR,"Resolution",.DEFARR)
"RTN","PXRMICHK",230,0)
 . I 'RESOK S OK=0
"RTN","PXRMICHK",231,0)
 ;
"RTN","PXRMICHK",232,0)
 ;Make other checks for bad cohort and resolution logic; these are
"RTN","PXRMICHK",233,0)
 ;all just warnings.
"RTN","PXRMICHK",234,0)
 D CCRLOGIC(COHOK,RESOK,.DEFARR)
"RTN","PXRMICHK",235,0)
 ;
"RTN","PXRMICHK",236,0)
 ;A frequency is required if there is resolution logic.
"RTN","PXRMICHK",237,0)
 I $G(DEFARR(35))'="" D
"RTN","PXRMICHK",238,0)
 . S (IND,NBFREQ,NFFREQ)=0
"RTN","PXRMICHK",239,0)
 . F  S IND=+$O(DEFARR(7,IND)) Q:IND=0  S NBFREQ=NBFREQ+1
"RTN","PXRMICHK",240,0)
 . I NBFREQ=0 D
"RTN","PXRMICHK",241,0)
 .. S IND=0
"RTN","PXRMICHK",242,0)
 .. F  S IND=+$O(DEFARR(20,IND)) Q:IND=0  I $P(DEFARR(20,IND,0),U,4)'="" S NFFREQ=NFFREQ+1
"RTN","PXRMICHK",243,0)
 .. S IND="FF"
"RTN","PXRMICHK",244,0)
 .. F  S IND=$O(DEFARR(25,IND)) Q:IND=""  I $P(DEFARR(25,IND,0),U,4)'="" S NFFREQ=NFFREQ+1
"RTN","PXRMICHK",245,0)
 . I NBFREQ=0,NFFREQ=0 D
"RTN","PXRMICHK",246,0)
 .. S TEXT(1)="Definition has resolution logic but no baseline frequencies."
"RTN","PXRMICHK",247,0)
 .. S TEXT(2)="Also there are no findings or function findings that set a frequency."
"RTN","PXRMICHK",248,0)
 .. D OUTPUT(2,.TEXT)
"RTN","PXRMICHK",249,0)
 .. S OK=0
"RTN","PXRMICHK",250,0)
 . I NBFREQ=0,NFFREQ>0 D
"RTN","PXRMICHK",251,0)
 .. S TEXT(1)="Warning: definition has resolution logic but no baseline frequencies."
"RTN","PXRMICHK",252,0)
 .. S TEXT(2)="There are findings that set a frequency but if they are all false there will not be a frequency."
"RTN","PXRMICHK",253,0)
 .. D OUTPUT(2,.TEXT)
"RTN","PXRMICHK",254,0)
 K TEXT
"RTN","PXRMICHK",255,0)
 I OK S TEXT(1)="No fatal errors were found."
"RTN","PXRMICHK",256,0)
 E  S TEXT(1)="This definition has fatal errors and it will not work!"
"RTN","PXRMICHK",257,0)
 D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",258,0)
 Q OK
"RTN","PXRMICHK",259,0)
 ;
"RTN","PXRMICHK",260,0)
 ;======================================================
"RTN","PXRMICHK",261,0)
LCOHORTC(DEFARR) ;Check list type reminder cohort logic for special
"RTN","PXRMICHK",262,0)
 ;requirements.
"RTN","PXRMICHK",263,0)
 N IND,FREQ,MAXAGE,MINAGE,NL,OK,PCLOG,TEXT
"RTN","PXRMICHK",264,0)
 S (OK,NL)=1
"RTN","PXRMICHK",265,0)
 S PCLOG=DEFARR(31)
"RTN","PXRMICHK",266,0)
 ;The cohort logic cannot start with a logical not.
"RTN","PXRMICHK",267,0)
 I $E(PCLOG,1)="'" D
"RTN","PXRMICHK",268,0)
 . S NL=NL+1
"RTN","PXRMICHK",269,0)
 . S TEXT(NL)="The cohort logic cannot start with a logical not.\\"
"RTN","PXRMICHK",270,0)
 . S OK=0
"RTN","PXRMICHK",271,0)
 I PCLOG["!'" D
"RTN","PXRMICHK",272,0)
 . S NL=NL+1
"RTN","PXRMICHK",273,0)
 . S TEXT(NL)="The cohort logic cannot contain !' (OR NOT).\\"
"RTN","PXRMICHK",274,0)
 . S OK=0
"RTN","PXRMICHK",275,0)
 I PCLOG["AGE" D
"RTN","PXRMICHK",276,0)
 .;Make sure a baseline age range is defined.
"RTN","PXRMICHK",277,0)
 . I '$D(DEFARR(7)) D  Q
"RTN","PXRMICHK",278,0)
 .. S NL=NL+1
"RTN","PXRMICHK",279,0)
 .. S TEXT(NL)="The cohort logic contains AGE but no baseline age range is defined.\\"
"RTN","PXRMICHK",280,0)
 .. S OK=0
"RTN","PXRMICHK",281,0)
 . S IND=0 F  S IND=$O(DEFARR(7,IND)) Q:(IND="")  D
"RTN","PXRMICHK",282,0)
 .. S MINAGE=+$P(DEFARR(7,IND,0),U,2)
"RTN","PXRMICHK",283,0)
 .. S MAXAGE=+$P(DEFARR(7,IND,0),U,3)
"RTN","PXRMICHK",284,0)
 .. I (MINAGE=0),(MAXAGE=0) D
"RTN","PXRMICHK",285,0)
 ... S FREQ=$P(DEFARR(7,IND,0),U,1)
"RTN","PXRMICHK",286,0)
 ... S NL=NL+1
"RTN","PXRMICHK",287,0)
 ... S TEXT(NL)="The cohort logic contains AGE but baseline frequency "_FREQ_" does not define an age range.\\"
"RTN","PXRMICHK",288,0)
 ... S OK=0
"RTN","PXRMICHK",289,0)
 I PCLOG["SEX" D
"RTN","PXRMICHK",290,0)
 . I $P(DEFARR(0),U,9)="" D
"RTN","PXRMICHK",291,0)
 .. S NL=NL+1
"RTN","PXRMICHK",292,0)
 .. S TEXT(NL)="The cohort logic contains SEX but the SEX SPECIFIC field is not defined.\\"
"RTN","PXRMICHK",293,0)
 .. S OK=0
"RTN","PXRMICHK",294,0)
 I PCLOG["SEX" D
"RTN","PXRMICHK",295,0)
 . N PFSTACK
"RTN","PXRMICHK",296,0)
 . D POSTFIX^PXRMSTAC(PCLOG,"!&",.PFSTACK)
"RTN","PXRMICHK",297,0)
 . I PFSTACK(1)'="SEX" Q
"RTN","PXRMICHK",298,0)
 . I (PFSTACK(2)'="AGE")!(PFSTACK(3)'="&") D
"RTN","PXRMICHK",299,0)
 .. S NL=NL+1
"RTN","PXRMICHK",300,0)
 .. S TEXT(NL)="The cohort logic starts with SEX but SEX is not logically ANDED with AGE.\\"
"RTN","PXRMICHK",301,0)
 .. S OK=0
"RTN","PXRMICHK",302,0)
 I 'OK D
"RTN","PXRMICHK",303,0)
 . S TEXT(1)="F - List type definitions have the following restrictions:\\"
"RTN","PXRMICHK",304,0)
 . D OUTPUT(NL,.TEXT)
"RTN","PXRMICHK",305,0)
 Q OK
"RTN","PXRMICHK",306,0)
 ;
"RTN","PXRMICHK",307,0)
 ;======================================================
"RTN","PXRMICHK",308,0)
LOGCHECK(NFI,FLIST,LOGSTR,TYPE,DEFARR) ;Verify logic strings. Make sure the
"RTN","PXRMICHK",309,0)
 ;findings exist and the syntax is correct.
"RTN","PXRMICHK",310,0)
 N FFNUM,FI,IND,OK,TEXT,X
"RTN","PXRMICHK",311,0)
 S OK=1
"RTN","PXRMICHK",312,0)
 I NFI=0 D  Q OK
"RTN","PXRMICHK",313,0)
 . S TEXT(1)="Warning, there is no "_TYPE_" logic."
"RTN","PXRMICHK",314,0)
 . D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",315,0)
 F IND=1:1:NFI D
"RTN","PXRMICHK",316,0)
 . S FI=$P(FLIST,";",IND)
"RTN","PXRMICHK",317,0)
 . I FI=+FI D
"RTN","PXRMICHK",318,0)
 .. I '$D(DEFARR(20,FI,0)) D
"RTN","PXRMICHK",319,0)
 ... S TEXT(1)=TYPE_" logic uses finding "_FI_" which does not exist."
"RTN","PXRMICHK",320,0)
 ... D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",321,0)
 ... S OK=0
"RTN","PXRMICHK",322,0)
 . I FI["FF" D
"RTN","PXRMICHK",323,0)
 .. I '$D(DEFARR(25,FI,0)) D
"RTN","PXRMICHK",324,0)
 ... S FFNUM=$P(FI,"FF",2)
"RTN","PXRMICHK",325,0)
 ... S TEXT(1)=TYPE_" logic uses function finding "_FFNUM_" which does not exist."
"RTN","PXRMICHK",326,0)
 ... D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",327,0)
 ... S OK=0
"RTN","PXRMICHK",328,0)
 S X="S Y="_LOGSTR
"RTN","PXRMICHK",329,0)
 D ^DIM
"RTN","PXRMICHK",330,0)
 I '$D(X) D
"RTN","PXRMICHK",331,0)
 . S TEXT(1)=TYPE_" logic syntax is invalid."
"RTN","PXRMICHK",332,0)
 . D OUTPUT(1,.TEXT)
"RTN","PXRMICHK",333,0)
 . S OK=0
"RTN","PXRMICHK",334,0)
 Q OK
"RTN","PXRMICHK",335,0)
 ;
"RTN","PXRMICHK",336,0)
 ;======================================================
"RTN","PXRMICHK",337,0)
OUTPUT(NIN,TEXT) ;Format and output TEXT.
"RTN","PXRMICHK",338,0)
 I $G(PXRMDONE) Q
"RTN","PXRMICHK",339,0)
 N ANS,EXIT,IND,NOUT,TEXTOUT
"RTN","PXRMICHK",340,0)
 D FORMAT^PXRMTEXT(1,80,NIN,.TEXT,.NOUT,.TEXTOUT)
"RTN","PXRMICHK",341,0)
 S EXIT=0
"RTN","PXRMICHK",342,0)
 F IND=1:1:NOUT D
"RTN","PXRMICHK",343,0)
 . W !,TEXTOUT(IND)
"RTN","PXRMICHK",344,0)
 . I ($Y+2>IOSL),$E(IOST,1,2)="C-" D
"RTN","PXRMICHK",345,0)
 .. W !,"Press ENTER to continue or '^' to exit: "
"RTN","PXRMICHK",346,0)
 .. R ANS:DTIME
"RTN","PXRMICHK",347,0)
 .. S EXIT=('$T)!(ANS="^")
"RTN","PXRMICHK",348,0)
 .. I 'EXIT W #
"RTN","PXRMICHK",349,0)
 . I EXIT Q
"RTN","PXRMICHK",350,0)
 I EXIT S PXRMDONE=1
"RTN","PXRMICHK",351,0)
 Q
"RTN","PXRMICHK",352,0)
 ;
"RTN","PXRMLOCF")
0^17^B95753792
"RTN","PXRMLOCF",1,0)
PXRMLOCF ;SLC/PKR - Handle location findings. ;07/18/2012
"RTN","PXRMLOCF",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,11,12,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMLOCF",3,0)
 ;This routine is for location list patient findings.
"RTN","PXRMLOCF",4,0)
 ;=================================================
"RTN","PXRMLOCF",5,0)
ALL(FILENUM,DFN,PFINDPA,FIEVAL) ;Get all Visits with a location
"RTN","PXRMLOCF",6,0)
 ;for a patient.
"RTN","PXRMLOCF",7,0)
 N BDT,BTIME,CASESEN,COND,CONVAL,DAS,DATE,DEND,DONE,DS,EDT,ETIME,FIEVD
"RTN","PXRMLOCF",8,0)
 N ICOND,INVBD,INVDATE,INVDT,INVED,NFOUND,NOCC
"RTN","PXRMLOCF",9,0)
 N SAVE,SDIR,TEMP,TIME,UCIFS
"RTN","PXRMLOCF",10,0)
 ;Set the finding search parameters.
"RTN","PXRMLOCF",11,0)
 D SSPAR^PXRMUTIL(PFINDPA(0),.NOCC,.BDT,.EDT)
"RTN","PXRMLOCF",12,0)
 I $G(PXRMDEBG) S FIEVAL("BDTE")=BDT,FIEVAL("EDTE")=EDT
"RTN","PXRMLOCF",13,0)
 S SDIR=$S(NOCC<0:-1,1:1)
"RTN","PXRMLOCF",14,0)
 S NOCC=$S(NOCC<0:-NOCC,1:NOCC)
"RTN","PXRMLOCF",15,0)
 D SCPAR^PXRMCOND(.PFINDPA,.CASESEN,.COND,.UCIFS,.ICOND,.VSLIST)
"RTN","PXRMLOCF",16,0)
 I $G(PXRMDEBG) S FIEVAL("BDTE")=BDT,FIEVAL("EDTE")=EDT
"RTN","PXRMLOCF",17,0)
 S (DONE,NFOUND)=0
"RTN","PXRMLOCF",18,0)
 S DEND=$S(EDT[".":EDT,1:EDT+.235959)
"RTN","PXRMLOCF",19,0)
 S INVBD=9999999-$P(BDT,".",1),BTIME="."_$P(BDT,".",2)
"RTN","PXRMLOCF",20,0)
 S INVED=9999999-$P(DEND,".",1),ETIME="."_$P(DEND,".",2)
"RTN","PXRMLOCF",21,0)
 I SDIR=1 S DS=INVED-.000001
"RTN","PXRMLOCF",22,0)
 I SDIR=-1 S DS=INVBD+.000001
"RTN","PXRMLOCF",23,0)
 S INVDT=DS,(DONE,NFOUND)=0
"RTN","PXRMLOCF",24,0)
 ;DBIA 2028
"RTN","PXRMLOCF",25,0)
 F  S INVDT=$O(^AUPNVSIT("AA",DFN,INVDT),SDIR) Q:(DONE)!(INVDT="")  D
"RTN","PXRMLOCF",26,0)
 . S INVDATE=$P(INVDT,".",1)
"RTN","PXRMLOCF",27,0)
 . I (SDIR=1),INVDATE>INVBD S DONE=1 Q
"RTN","PXRMLOCF",28,0)
 . I (SDIR=-1),INVDATE<INVED S DONE=1 Q
"RTN","PXRMLOCF",29,0)
 . S TIME="."_$P(INVDT,".",2)
"RTN","PXRMLOCF",30,0)
 . I INVDATE=INVED,TIME>ETIME Q
"RTN","PXRMLOCF",31,0)
 . I INVDATE=INVBD,TIME<BTIME Q
"RTN","PXRMLOCF",32,0)
 . S DAS=0
"RTN","PXRMLOCF",33,0)
 . F  S DAS=$O(^AUPNVSIT("AA",DFN,INVDT,DAS)) Q:(DAS="")!(DONE)  D
"RTN","PXRMLOCF",34,0)
 .. D GETDATA^PXRMDATA(FILENUM,DAS,.FIEVD)
"RTN","PXRMLOCF",35,0)
 .. S DATE=$P(^AUPNVSIT(DAS,0),U,1)
"RTN","PXRMLOCF",36,0)
 .. S FIEVD("DATE")=DATE
"RTN","PXRMLOCF",37,0)
 .. S CONVAL=$S(COND="":1,1:$$COND^PXRMCOND(CASESEN,ICOND,VSLIST,.FIEVD))
"RTN","PXRMLOCF",38,0)
 .. S SAVE=$S('UCIFS:1,(UCIFS&CONVAL):1,1:0)
"RTN","PXRMLOCF",39,0)
 .. I SAVE D
"RTN","PXRMLOCF",40,0)
 ... S NFOUND=NFOUND+1
"RTN","PXRMLOCF",41,0)
 ... S FIEVAL(NFOUND)=CONVAL
"RTN","PXRMLOCF",42,0)
 ... I COND'="" S FIEVAL(NFOUND,"CONDITION")=CONVAL
"RTN","PXRMLOCF",43,0)
 ... S FIEVAL(NFOUND,"DAS")=DAS
"RTN","PXRMLOCF",44,0)
 ... S FIEVAL(NFOUND,"DATE")=DATE
"RTN","PXRMLOCF",45,0)
 ... M FIEVAL(NFOUND)=FIEVD
"RTN","PXRMLOCF",46,0)
 ... I $G(PXRMDEBG) M FIEVAL(NFOUND,"CSUB")=FIEVD
"RTN","PXRMLOCF",47,0)
 ... I NFOUND=NOCC S DONE=1
"RTN","PXRMLOCF",48,0)
 ;Save the finding result.
"RTN","PXRMLOCF",49,0)
 D SFRES^PXRMUTIL(-SDIR,NFOUND,.FIEVAL)
"RTN","PXRMLOCF",50,0)
 S FIEVAL("FILE NUMBER")=FILENUM
"RTN","PXRMLOCF",51,0)
 Q
"RTN","PXRMLOCF",52,0)
 ;
"RTN","PXRMLOCF",53,0)
 ;=================================================
"RTN","PXRMLOCF",54,0)
EVALFI(DFN,DEFARR,ENODE,FIEVAL) ;Evaluate location findings.
"RTN","PXRMLOCF",55,0)
 N BDT,EDT,FIEVT,FILENUM,FINDING,FINDPA,ITEM
"RTN","PXRMLOCF",56,0)
 S FILENUM=$$GETFNUM^PXRMDATA(ENODE)
"RTN","PXRMLOCF",57,0)
 S ITEM=""
"RTN","PXRMLOCF",58,0)
 F  S ITEM=$O(DEFARR("E",ENODE,ITEM)) Q:+ITEM=0  D
"RTN","PXRMLOCF",59,0)
 . S FINDING=""
"RTN","PXRMLOCF",60,0)
 . F  S FINDING=$O(DEFARR("E",ENODE,ITEM,FINDING)) Q:+FINDING=0  D
"RTN","PXRMLOCF",61,0)
 .. K FINDPA
"RTN","PXRMLOCF",62,0)
 .. M FINDPA=DEFARR(20,FINDING)
"RTN","PXRMLOCF",63,0)
 .. K FIEVT
"RTN","PXRMLOCF",64,0)
 .. D FIEVAL(FILENUM,"PI",DFN,ITEM,.FINDPA,.FIEVT)
"RTN","PXRMLOCF",65,0)
 .. M FIEVAL(FINDING)=FIEVT
"RTN","PXRMLOCF",66,0)
 .. S FIEVAL(FINDING,"FINDING")=$P(FINDPA(0),U,1)
"RTN","PXRMLOCF",67,0)
 Q
"RTN","PXRMLOCF",68,0)
 ;
"RTN","PXRMLOCF",69,0)
 ;=================================================
"RTN","PXRMLOCF",70,0)
EVALTERM(DFN,FINDPA,ENODE,TERMARR,TFIEVAL) ;Evaluate location terms.
"RTN","PXRMLOCF",71,0)
 N FIEVT,FILENUM,ITEM,PFINDPA
"RTN","PXRMLOCF",72,0)
 N TEMP,TFINDING,TFINDPA
"RTN","PXRMLOCF",73,0)
 S FILENUM=$$GETFNUM^PXRMDATA(ENODE)
"RTN","PXRMLOCF",74,0)
 S ITEM=""
"RTN","PXRMLOCF",75,0)
 F  S ITEM=$O(TERMARR("E",ENODE,ITEM)) Q:+ITEM=0  D
"RTN","PXRMLOCF",76,0)
 . S TFINDING=""
"RTN","PXRMLOCF",77,0)
 . F  S TFINDING=$O(TERMARR("E",ENODE,ITEM,TFINDING)) Q:+TFINDING=0  D
"RTN","PXRMLOCF",78,0)
 .. K FIEVT,PFINDPA,TFINDPA
"RTN","PXRMLOCF",79,0)
 .. M TFINDPA=TERMARR(20,TFINDING)
"RTN","PXRMLOCF",80,0)
 ..;Set the finding parameters.
"RTN","PXRMLOCF",81,0)
 .. D SPFINDPA^PXRMTERM(.FINDPA,.TFINDPA,.PFINDPA)
"RTN","PXRMLOCF",82,0)
 .. D FIEVAL(FILENUM,"PI",DFN,ITEM,.PFINDPA,.FIEVT)
"RTN","PXRMLOCF",83,0)
 .. M TFIEVAL(TFINDING)=FIEVT
"RTN","PXRMLOCF",84,0)
 .. S TFIEVAL(TFINDING,"FINDING")=$P(TFINDPA(0),U,1)
"RTN","PXRMLOCF",85,0)
 Q
"RTN","PXRMLOCF",86,0)
 ;
"RTN","PXRMLOCF",87,0)
 ;=================================================
"RTN","PXRMLOCF",88,0)
FIEVAL(FILENUM,SNODE,DFN,ITEM,PFINDPA,FIEVAL) ;
"RTN","PXRMLOCF",89,0)
 ;Evaluate regular patient findings.
"RTN","PXRMLOCF",90,0)
 N BDT,CASESEN,COND,CONVAL,DAS,DATE,EDT,FIEVD,FLIST,HLOC
"RTN","PXRMLOCF",91,0)
 N ICOND,IND,LNAME,NFOUND,NGET,NOCC,NP
"RTN","PXRMLOCF",92,0)
 N SAVE,SDIR,STATUSA,TEMP,UCIFS,VSLIST
"RTN","PXRMLOCF",93,0)
 I '$D(^PXRMD(810.9,ITEM)) D  Q
"RTN","PXRMLOCF",94,0)
 . S FIEVAL=0
"RTN","PXRMLOCF",95,0)
 . S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NOLL",ITEM)="Location List with IEN="_ITEM_" does not exist."
"RTN","PXRMLOCF",96,0)
 S LNAME=$P(^PXRMD(810.9,ITEM,0),U,1)
"RTN","PXRMLOCF",97,0)
 I LNAME="VA-ALL LOCATIONS" D ALL(FILENUM,DFN,.PFINDPA,.FIEVAL) Q
"RTN","PXRMLOCF",98,0)
 ;Set the finding search parameters.
"RTN","PXRMLOCF",99,0)
 D SSPAR^PXRMUTIL(PFINDPA(0),.NOCC,.BDT,.EDT)
"RTN","PXRMLOCF",100,0)
 I $G(PXRMDEBG) S FIEVAL("BDTE")=BDT,FIEVAL("EDTE")=EDT
"RTN","PXRMLOCF",101,0)
 S SDIR=$S(NOCC<0:-1,1:1)
"RTN","PXRMLOCF",102,0)
 D SCPAR^PXRMCOND(.PFINDPA,.CASESEN,.COND,.UCIFS,.ICOND,.VSLIST)
"RTN","PXRMLOCF",103,0)
 S NOCC=$S(NOCC<0:-NOCC,1:NOCC)
"RTN","PXRMLOCF",104,0)
 S NGET=$S(UCIFS:50,$D(STATUSA):50,1:NOCC)
"RTN","PXRMLOCF",105,0)
 ;Get a list of unique locations.
"RTN","PXRMLOCF",106,0)
 D LOCLIST(ITEM,"HLOCL")
"RTN","PXRMLOCF",107,0)
 D FPDAT(DFN,"HLOCL",NGET,SDIR,BDT,EDT,.NFOUND,.FLIST)
"RTN","PXRMLOCF",108,0)
 I NFOUND=0 S FIEVAL=0 Q
"RTN","PXRMLOCF",109,0)
 S NP=0
"RTN","PXRMLOCF",110,0)
 F IND=1:1:NFOUND Q:NP=NOCC  D
"RTN","PXRMLOCF",111,0)
 . S DAS=$P(FLIST(IND),U,1)
"RTN","PXRMLOCF",112,0)
 . D GETDATA^PXRMDATA(FILENUM,DAS,.FIEVD)
"RTN","PXRMLOCF",113,0)
 . S FIEVD("DATE")=$P(FLIST(IND),U,2)
"RTN","PXRMLOCF",114,0)
 . S CONVAL=$S(COND'="":$$COND^PXRMCOND(CASESEN,ICOND,VSLIST,.FIEVD),1:1)
"RTN","PXRMLOCF",115,0)
 . S SAVE=$S('UCIFS:1,(UCIFS&CONVAL):1,1:0)
"RTN","PXRMLOCF",116,0)
 . I SAVE D
"RTN","PXRMLOCF",117,0)
 .. S NP=NP+1
"RTN","PXRMLOCF",118,0)
 .. S FIEVAL(NP)=CONVAL
"RTN","PXRMLOCF",119,0)
 .. I COND'="" S FIEVAL(NP,"CONDITION")=CONVAL
"RTN","PXRMLOCF",120,0)
 .. S FIEVAL(NP,"DAS")=$P(FLIST(IND),U,1)
"RTN","PXRMLOCF",121,0)
 .. S FIEVAL(NP,"DATE")=FIEVD("DATE")
"RTN","PXRMLOCF",122,0)
 .. M FIEVAL(NP)=FIEVD
"RTN","PXRMLOCF",123,0)
 .. I $G(PXRMDEBG) M FIEVAL(NP,"CSUB")=FIEVD
"RTN","PXRMLOCF",124,0)
 ;
"RTN","PXRMLOCF",125,0)
 ;Save the finding result.
"RTN","PXRMLOCF",126,0)
 D SFRES^PXRMUTIL(-NOCC,NP,.FIEVAL)
"RTN","PXRMLOCF",127,0)
 S FIEVAL("FILE NUMBER")=FILENUM
"RTN","PXRMLOCF",128,0)
 Q
"RTN","PXRMLOCF",129,0)
 ;
"RTN","PXRMLOCF",130,0)
 ;=================================================
"RTN","PXRMLOCF",131,0)
FPDAT(DFN,HLOCL,NOCC,SDIR,BDT,EDT,NFOUND,FLIST) ;Find patient data for
"RTN","PXRMLOCF",132,0)
 ;visits at a specified hospital location. Return up to NOCC most
"RTN","PXRMLOCF",133,0)
 ;recent entries in FLIST where FLIST(1) is the most recent.
"RTN","PXRMLOCF",134,0)
 ;"AA" in Visit file is inverse date_.time instead of a full inverse
"RTN","PXRMLOCF",135,0)
 ;date and time. For example if the date/time is 3030704.104449 then
"RTN","PXRMLOCF",136,0)
 ;"AA" has 6969295.104449 instead of 6969295.89555
"RTN","PXRMLOCF",137,0)
 N BTIME,DAS,DATE,DEND,DLIST,DONE,DS,ETIME,HLOC
"RTN","PXRMLOCF",138,0)
 N INVBD,INVDATE,INVDT,INVED,NF,TEMP,TIME
"RTN","PXRMLOCF",139,0)
 S DEND=$S(EDT[".":EDT,1:EDT+.235959)
"RTN","PXRMLOCF",140,0)
 S INVBD=9999999-$P(BDT,".",1),BTIME="."_$P(BDT,".",2)
"RTN","PXRMLOCF",141,0)
 S INVED=9999999-$P(DEND,".",1),ETIME="."_$P(DEND,".",2)
"RTN","PXRMLOCF",142,0)
 I SDIR=1 S DS=INVED-.000001
"RTN","PXRMLOCF",143,0)
 I SDIR=-1 S DS=INVBD+.000001
"RTN","PXRMLOCF",144,0)
 ;DBIA #2028
"RTN","PXRMLOCF",145,0)
 S INVDT=DS,(DONE,NFOUND)=0
"RTN","PXRMLOCF",146,0)
 F  S INVDT=$O(^AUPNVSIT("AA",DFN,INVDT),SDIR) Q:(INVDT="")!(DONE)  D
"RTN","PXRMLOCF",147,0)
 . S NF=0
"RTN","PXRMLOCF",148,0)
 . S INVDATE=$P(INVDT,".",1)
"RTN","PXRMLOCF",149,0)
 . I (SDIR=1),INVDATE>INVBD S DONE=1 Q
"RTN","PXRMLOCF",150,0)
 . I (SDIR=-1),INVDATE<INVED S DONE=1 Q
"RTN","PXRMLOCF",151,0)
 . S TIME="."_$P(INVDT,".",2)
"RTN","PXRMLOCF",152,0)
 . I INVDATE=INVED,TIME>ETIME Q
"RTN","PXRMLOCF",153,0)
 . I INVDATE=INVBD,TIME<BTIME Q
"RTN","PXRMLOCF",154,0)
 . S DAS=0
"RTN","PXRMLOCF",155,0)
 . F  S DAS=$O(^AUPNVSIT("AA",DFN,INVDT,DAS)) Q:(DAS="")!(DONE)  D
"RTN","PXRMLOCF",156,0)
 .. S TEMP=^AUPNVSIT(DAS,0)
"RTN","PXRMLOCF",157,0)
 .. S HLOC=$P(TEMP,U,22)
"RTN","PXRMLOCF",158,0)
 .. I HLOC="" Q
"RTN","PXRMLOCF",159,0)
 .. I '$D(^TMP($J,HLOCL,HLOC)) Q
"RTN","PXRMLOCF",160,0)
 ..;Check the associated appointment for a valid status.
"RTN","PXRMLOCF",161,0)
 .. I '$$VAPSTAT^PXRMVSIT(DAS) Q
"RTN","PXRMLOCF",162,0)
 .. S DATE=$P(TEMP,U,1)
"RTN","PXRMLOCF",163,0)
 .. S NF=NF+1,NFOUND=NFOUND+1
"RTN","PXRMLOCF",164,0)
 .. I NFOUND=NOCC S DONE=1
"RTN","PXRMLOCF",165,0)
 .. S DLIST(INVDT,NF)=DAS_U_DATE
"RTN","PXRMLOCF",166,0)
 S INVDT="",NFOUND=0
"RTN","PXRMLOCF",167,0)
 F  S INVDT=$O(DLIST(INVDT)) Q:INVDT=""  D
"RTN","PXRMLOCF",168,0)
 . S NF=0
"RTN","PXRMLOCF",169,0)
 . F  S NF=$O(DLIST(INVDT,NF)) Q:NF=""  D
"RTN","PXRMLOCF",170,0)
 .. S NFOUND=NFOUND+1
"RTN","PXRMLOCF",171,0)
 .. S FLIST(NFOUND)=DLIST(INVDT,NF)
"RTN","PXRMLOCF",172,0)
 K ^TMP($J,"HLOCL")
"RTN","PXRMLOCF",173,0)
 Q
"RTN","PXRMLOCF",174,0)
 ;
"RTN","PXRMLOCF",175,0)
 ;=================================================
"RTN","PXRMLOCF",176,0)
LOCLIST(IEN,SUB) ;Build a list of unique locations based on stop code
"RTN","PXRMLOCF",177,0)
 ;and/or hospital location. Reads of ^SC covered by DBIA #4482.
"RTN","PXRMLOCF",178,0)
 N CSTOP,EXCL,EXCLNCS,EXCLP,IND,JND,HLOC,STOP
"RTN","PXRMLOCF",179,0)
 K ^TMP($J,SUB)
"RTN","PXRMLOCF",180,0)
 I IEN="" Q
"RTN","PXRMLOCF",181,0)
 I '$D(^PXRMD(810.9,IEN)) Q
"RTN","PXRMLOCF",182,0)
 ;Process stop codes. EXCL is the list of credit stops to exclude.
"RTN","PXRMLOCF",183,0)
 S IND=0
"RTN","PXRMLOCF",184,0)
 F  S IND=+$O(^PXRMD(810.9,IEN,40.7,IND)) Q:IND=0  D
"RTN","PXRMLOCF",185,0)
 . S STOP=$P(^PXRMD(810.9,IEN,40.7,IND,0),U,1)
"RTN","PXRMLOCF",186,0)
 . K EXCL
"RTN","PXRMLOCF",187,0)
 .;Check for individual credit stops to exclude entries.
"RTN","PXRMLOCF",188,0)
 . S JND=0
"RTN","PXRMLOCF",189,0)
 . F  S JND=+$O(^PXRMD(810.9,IEN,40.7,IND,1,JND)) Q:JND=0  D
"RTN","PXRMLOCF",190,0)
 .. S EXCL=$P(^PXRMD(810.9,IEN,40.7,IND,1,JND,0),U,1)
"RTN","PXRMLOCF",191,0)
 .. S EXCL(EXCL)=""
"RTN","PXRMLOCF",192,0)
 .;Check for a list of credit stops to exclude.
"RTN","PXRMLOCF",193,0)
 . S EXCLP=$G(^PXRMD(810.9,IEN,40.7,IND,2))
"RTN","PXRMLOCF",194,0)
 . I EXCLP'="" D
"RTN","PXRMLOCF",195,0)
 .. S JND=0
"RTN","PXRMLOCF",196,0)
 .. F  S JND=+$O(^PXRMD(810.9,EXCLP,40.7,JND)) Q:JND=0  D
"RTN","PXRMLOCF",197,0)
 ... S EXCL=$P(^PXRMD(810.9,EXCLP,40.7,JND,0),U,1)
"RTN","PXRMLOCF",198,0)
 ... S EXCL(EXCL)=""
"RTN","PXRMLOCF",199,0)
 .;See if locations with no credit stop should be excluded.
"RTN","PXRMLOCF",200,0)
 . S EXCLNCS=+$G(^PXRMD(810.9,IEN,40.7,IND,3))
"RTN","PXRMLOCF",201,0)
 . S HLOC=""
"RTN","PXRMLOCF",202,0)
 . F  S HLOC=$O(^SC("AST",STOP,HLOC)) Q:HLOC=""  D
"RTN","PXRMLOCF",203,0)
 .. ;See if there are any to exclude.
"RTN","PXRMLOCF",204,0)
 .. S CSTOP=$P(^SC(HLOC,0),U,18)
"RTN","PXRMLOCF",205,0)
 .. I CSTOP'="",$D(EXCL(CSTOP)) Q
"RTN","PXRMLOCF",206,0)
 .. I CSTOP="",EXCLNCS Q
"RTN","PXRMLOCF",207,0)
 .. S ^TMP($J,SUB,HLOC)=""
"RTN","PXRMLOCF",208,0)
 ;Process locations.
"RTN","PXRMLOCF",209,0)
 S IND=0
"RTN","PXRMLOCF",210,0)
 F  S IND=+$O(^PXRMD(810.9,IEN,44,IND)) Q:IND=0  D
"RTN","PXRMLOCF",211,0)
 . S HLOC=^PXRMD(810.9,IEN,44,IND,0)
"RTN","PXRMLOCF",212,0)
 . S ^TMP($J,SUB,HLOC)=""
"RTN","PXRMLOCF",213,0)
 I $D(^TMP($J,SUB))=0 D
"RTN","PXRMLOCF",214,0)
 . N MGIEN,MGROUP,TO
"RTN","PXRMLOCF",215,0)
 . S ^TMP("PXRMXMZ",$J,1,0)="Warning Reminder Location List "_$P(^PXRMD(810.9,IEN,0),U,1)
"RTN","PXRMLOCF",216,0)
 . S ^TMP("PXRMXMZ",$J,2,0)="does not contain or expand to contain any hospital locations!"
"RTN","PXRMLOCF",217,0)
 . D SEND^PXRMMSG("PXRMXMZ","Location List Problem",.TO,DUZ)
"RTN","PXRMLOCF",218,0)
 Q
"RTN","PXRMLOCF",219,0)
 ;
"RTN","PXRMLOCF",220,0)
 ;=================================================
"RTN","PXRMLOCF",221,0)
MHVOUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the MHV output.
"RTN","PXRMLOCF",222,0)
 ;DBIAs (^DIC(4: #10090), (^DIC(40.7: #557), (^SC: #10040)
"RTN","PXRMLOCF",223,0)
 N HLOC,IND,JND,LOC,NAME,NIN,NOUT,SC,TEMP,TEXTIN,TEXTOUT,VDATE
"RTN","PXRMLOCF",224,0)
 S NAME="Outpatient Encounter = "
"RTN","PXRMLOCF",225,0)
 S IND=0
"RTN","PXRMLOCF",226,0)
 F  S IND=+$O(IFIEVAL(IND)) Q:IND=0  D
"RTN","PXRMLOCF",227,0)
 . S NIN=0
"RTN","PXRMLOCF",228,0)
 . S VDATE=IFIEVAL(IND,"DATE")
"RTN","PXRMLOCF",229,0)
 . S LOC=$G(IFIEVAL(IND,"LOC. OF ENCOUNTER"))
"RTN","PXRMLOCF",230,0)
 . S LOC=$S(LOC="":"?",1:$P($G(^DIC(4,LOC,0)),U,1))
"RTN","PXRMLOCF",231,0)
 . S SC=$G(IFIEVAL(IND,"DSS ID"))
"RTN","PXRMLOCF",232,0)
 . S SC=$S(SC="":"?",1:" "_$P($G(^DIC(40.7,SC,0)),U,1))
"RTN","PXRMLOCF",233,0)
 . S HLOC=$G(IFIEVAL(IND,"HOSPITAL LOCATION"))
"RTN","PXRMLOCF",234,0)
 . S HLOC=$S(HLOC="":"?",1:" "_$P($G(^SC(HLOC,0)),U,1))
"RTN","PXRMLOCF",235,0)
 . S TEMP=NAME_LOC_HLOC_SC_" ("_$$EDATE^PXRMDATE(VDATE)_")"
"RTN","PXRMLOCF",236,0)
 . D FORMATS^PXRMTEXT(INDENT+2,PXRMRM,TEMP,.NOUT,.TEXTOUT)
"RTN","PXRMLOCF",237,0)
 . F JND=1:1:NOUT S NLINES=NLINES+1,TEXT(NLINES)=TEXTOUT(JND)
"RTN","PXRMLOCF",238,0)
 S NLINES=NLINES+1,TEXT(NLINES)=""
"RTN","PXRMLOCF",239,0)
 Q
"RTN","PXRMLOCF",240,0)
 ;
"RTN","PXRMLOCF",241,0)
 ;=================================================
"RTN","PXRMLOCF",242,0)
OUTPUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the clinical
"RTN","PXRMLOCF",243,0)
 ;maintenance output.
"RTN","PXRMLOCF",244,0)
 ;DBIAs (^DIC(4: #10090), (^DIC(40.7: #557), (^SC: #10040)
"RTN","PXRMLOCF",245,0)
 N EM,HLOC,IND,JND,LOC,NIN,NOUT,SC,STATUS,TEMP,TEXTIN,TEXTOUT,VDATE
"RTN","PXRMLOCF",246,0)
 S NLINES=NLINES+1
"RTN","PXRMLOCF",247,0)
 S TEXT(NLINES)=$$INSCHR^PXRMEXLC(INDENT," ")_"PCE Encounter:"
"RTN","PXRMLOCF",248,0)
 S IND=0
"RTN","PXRMLOCF",249,0)
 F  S IND=+$O(IFIEVAL(IND)) Q:IND=0  D
"RTN","PXRMLOCF",250,0)
 . S NIN=0
"RTN","PXRMLOCF",251,0)
 . S VDATE=IFIEVAL(IND,"DATE")
"RTN","PXRMLOCF",252,0)
 . S TEMP=$$EDATE^PXRMDATE(VDATE)
"RTN","PXRMLOCF",253,0)
 . S LOC=$G(IFIEVAL(IND,"LOC. OF ENCOUNTER"))
"RTN","PXRMLOCF",254,0)
 . S LOC=$S(LOC="":"?",1:$P($G(^DIC(4,LOC,0)),U,1))
"RTN","PXRMLOCF",255,0)
 . S TEMP=TEMP_" Facility - "_LOC
"RTN","PXRMLOCF",256,0)
 . D FORMATS^PXRMTEXT(INDENT+1,PXRMRM,TEMP,.NOUT,.TEXTOUT)
"RTN","PXRMLOCF",257,0)
 . F JND=1:1:NOUT S NLINES=NLINES+1,TEXT(NLINES)=TEXTOUT(JND)
"RTN","PXRMLOCF",258,0)
 . S HLOC=$G(IFIEVAL(IND,"HLOC"))
"RTN","PXRMLOCF",259,0)
 . I HLOC="" S HLOC="?"
"RTN","PXRMLOCF",260,0)
 . S TEMP="Hospital Location: "_HLOC
"RTN","PXRMLOCF",261,0)
 . S SC=$G(IFIEVAL(IND,"STOP CODE"))
"RTN","PXRMLOCF",262,0)
 . I SC="" S SC="?"
"RTN","PXRMLOCF",263,0)
 . S TEMP=TEMP_"; Clinic Stop: "_SC
"RTN","PXRMLOCF",264,0)
 . S NIN=NIN+1,TEXTIN(NIN)=TEMP_"\\"
"RTN","PXRMLOCF",265,0)
 . S SC=$G(IFIEVAL(IND,"SERVICE CATEGORY"))
"RTN","PXRMLOCF",266,0)
 . S TEMP="Service Category: "_SC_"="_$$EXTERNAL^DILFD(9000010,.07,"",SC,.EM)
"RTN","PXRMLOCF",267,0)
 . S NIN=NIN+1,TEXTIN(NIN)=TEMP_"\\"
"RTN","PXRMLOCF",268,0)
 . S STATUS=$P($G(IFIEVAL(IND,"STATUS")),U,2)
"RTN","PXRMLOCF",269,0)
 . I STATUS="" S STATUS="?"
"RTN","PXRMLOCF",270,0)
 . S TEMP="Appointment Status: "_STATUS
"RTN","PXRMLOCF",271,0)
 . S NIN=NIN+1,TEXTIN(NIN)=TEMP_"\\"
"RTN","PXRMLOCF",272,0)
 . D FORMAT^PXRMTEXT(INDENT+2,PXRMRM,NIN,.TEXTIN,.NOUT,.TEXTOUT)
"RTN","PXRMLOCF",273,0)
 . F JND=1:1:NOUT S NLINES=NLINES+1,TEXT(NLINES)=TEXTOUT(JND)
"RTN","PXRMLOCF",274,0)
 . I IFIEVAL(IND,"VISIT COMMENTS")'="" D
"RTN","PXRMLOCF",275,0)
 .. S TEMP="Comments: "_IFIEVAL(IND,"VISIT COMMENTS")
"RTN","PXRMLOCF",276,0)
 .. D FORMATS^PXRMTEXT(INDENT+3,PXRMRM,TEMP,.NOUT,.TEXTOUT)
"RTN","PXRMLOCF",277,0)
 .. F JND=1:1:NOUT S NLINES=NLINES+1,TEXT(NLINES)=TEXTOUT(JND)
"RTN","PXRMLOCF",278,0)
 S NLINES=NLINES+1,TEXT(NLINES)=""
"RTN","PXRMLOCF",279,0)
 Q
"RTN","PXRMLOCF",280,0)
 ;
"RTN","PXRMLPOE")
0^10^B14864405
"RTN","PXRMLPOE",1,0)
PXRMLPOE ;SLC/PJH,PKR - Build OE/RR Team from Patient List ;03/19/2012
"RTN","PXRMLPOE",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,24**;Feb 04, 2005;Build 193
"RTN","PXRMLPOE",3,0)
 ; 
"RTN","PXRMLPOE",4,0)
 ; Called from PXRM PATIENT LIST OE/RR protocol
"RTN","PXRMLPOE",5,0)
ASK(PLIEN,OPT) ;Verify patient list name
"RTN","PXRMLPOE",6,0)
 N DIR,X,Y,TEXT
"RTN","PXRMLPOE",7,0)
 K DIROUT,DIRUT,DTOUT,DUOUT
"RTN","PXRMLPOE",8,0)
 S DIR(0)="YA0"
"RTN","PXRMLPOE",9,0)
 S DIR("A")=OPT_" patient list "_$P($G(^PXRMXP(810.5,PLIEN,0)),U)_"?: "
"RTN","PXRMLPOE",10,0)
 S DIR("B")="N"
"RTN","PXRMLPOE",11,0)
 S DIR("?")="Enter Y or N. For detailed help type ??"
"RTN","PXRMLPOE",12,0)
 W !
"RTN","PXRMLPOE",13,0)
 D ^DIR K DIR
"RTN","PXRMLPOE",14,0)
 I $D(DIROUT) S DTOUT=1
"RTN","PXRMLPOE",15,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","PXRMLPOE",16,0)
 I $E(Y(0))="N" S DUOUT=1 Q
"RTN","PXRMLPOE",17,0)
 Q
"RTN","PXRMLPOE",18,0)
 ;
"RTN","PXRMLPOE",19,0)
LOCK(LIST) ;Lock the list
"RTN","PXRMLPOE",20,0)
 L +^PXRMXP(100.21,LIST):0
"RTN","PXRMLPOE",21,0)
 E  W !!?5,"Another user is using this OE/RR team list" S DUOUT=1
"RTN","PXRMLPOE",22,0)
 Q
"RTN","PXRMLPOE",23,0)
 ;
"RTN","PXRMLPOE",24,0)
OERR(IENO) ;Copy patient list to OE/RR Team
"RTN","PXRMLPOE",25,0)
 ;Check if OK to copy
"RTN","PXRMLPOE",26,0)
 D ASK(IENO,"Copy") Q:$D(DUOUT)!$D(DTOUT)
"RTN","PXRMLPOE",27,0)
 ;
"RTN","PXRMLPOE",28,0)
 N IENN,NNAME,ONAME,TEXT,X,Y
"RTN","PXRMLPOE",29,0)
 ;
"RTN","PXRMLPOE",30,0)
 ;Select OE/RR Team to copy to
"RTN","PXRMLPOE",31,0)
 S TEXT="Select OE/RR TEAM name to copy to: "
"RTN","PXRMLPOE",32,0)
 D OTEAM(.IENN,.NNAME,TEXT) Q:$D(DUOUT)!$D(DTOUT)  Q:'IENN
"RTN","PXRMLPOE",33,0)
 ;
"RTN","PXRMLPOE",34,0)
 S ONAME=$P($G(^PXRMXP(810.5,IENO,0)),U)
"RTN","PXRMLPOE",35,0)
 ;
"RTN","PXRMLPOE",36,0)
 ;Update OE/RR Team list
"RTN","PXRMLPOE",37,0)
 D UPDLST(IENO,IENN,NNAME)
"RTN","PXRMLPOE",38,0)
 Q
"RTN","PXRMLPOE",39,0)
 ;
"RTN","PXRMLPOE",40,0)
OK ;Option to overwrite existing list
"RTN","PXRMLPOE",41,0)
 N X,Y,TEXT
"RTN","PXRMLPOE",42,0)
 K DIROUT,DIRUT,DTOUT,DUOUT
"RTN","PXRMLPOE",43,0)
 S DIR(0)="YA0"
"RTN","PXRMLPOE",44,0)
 S DIR("A")="Overwrite existing OE/RR Team list: "
"RTN","PXRMLPOE",45,0)
 S DIR("B")="N"
"RTN","PXRMLPOE",46,0)
 S DIR("?")="Enter Y or N. For detailed help type ??"
"RTN","PXRMLPOE",47,0)
 S DIR("??")=U_"D HELP^PXRMLCR(1)"
"RTN","PXRMLPOE",48,0)
 W !
"RTN","PXRMLPOE",49,0)
 D ^DIR K DIR
"RTN","PXRMLPOE",50,0)
 I $D(DIROUT) S DTOUT=1
"RTN","PXRMLPOE",51,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","PXRMLPOE",52,0)
 I $E(Y(0))="N" S DUOUT=1 Q
"RTN","PXRMLPOE",53,0)
 Q
"RTN","PXRMLPOE",54,0)
 ;
"RTN","PXRMLPOE",55,0)
OTEAM(LIST,NAME,TEXT) ;Select OERR/Team
"RTN","PXRMLPOE",56,0)
 N X,Y,DIC,DIE,DR,DLAYGO
"RTN","PXRMLPOE",57,0)
 W !
"RTN","PXRMLPOE",58,0)
 W !,"To overwrite an existing list you must be the creator of the list and"
"RTN","PXRMLPOE",59,0)
 W !,"the OE/RR team list must be defined as a Team List."
"RTN","PXRMLPOE",60,0)
OT1 S DIC=100.21,DLAYGO=DIC,DIC(0)="QAEMZL"
"RTN","PXRMLPOE",61,0)
 S DIC("S")="I $P($G(^(0)),U,2)=""TM"",$P($G(^(0)),U,5)=DUZ"
"RTN","PXRMLPOE",62,0)
 S DIC("A")=TEXT
"RTN","PXRMLPOE",63,0)
 W !
"RTN","PXRMLPOE",64,0)
 D ^DIC
"RTN","PXRMLPOE",65,0)
 I X="" W !,"An OE/RR Team name must be entered" G OT1
"RTN","PXRMLPOE",66,0)
 I X=(U_U) S DTOUT=1
"RTN","PXRMLPOE",67,0)
 I Y=-1 S DUOUT=1
"RTN","PXRMLPOE",68,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMLPOE",69,0)
 ;
"RTN","PXRMLPOE",70,0)
 ;Check if OK to overwrite
"RTN","PXRMLPOE",71,0)
 I $P(Y,U,3)'=1  D  Q:$D(DTOUT)  G:$D(DUOUT) OT1
"RTN","PXRMLPOE",72,0)
 .D OK
"RTN","PXRMLPOE",73,0)
 ;Return list ien
"RTN","PXRMLPOE",74,0)
 S LIST=$P(Y,U),NAME=$P(Y,U,2)
"RTN","PXRMLPOE",75,0)
 Q
"RTN","PXRMLPOE",76,0)
 ;
"RTN","PXRMLPOE",77,0)
UPDLST(IENO,LIST,NAME) ;Update patient list
"RTN","PXRMLPOE",78,0)
 N CNT,DA,DFN,DIK,DUOUT,FDA,FDAIEN,IEN,MSG,SUB,TEMP
"RTN","PXRMLPOE",79,0)
 ;Lock patient list
"RTN","PXRMLPOE",80,0)
 D LOCK(LIST) Q:$D(DUOUT)
"RTN","PXRMLPOE",81,0)
 ;
"RTN","PXRMLPOE",82,0)
 ;Clear existing list
"RTN","PXRMLPOE",83,0)
 S SUB=0
"RTN","PXRMLPOE",84,0)
 F  S SUB=$O(^OR(100.21,LIST,10,SUB)) Q:'SUB  D
"RTN","PXRMLPOE",85,0)
 . S DA=SUB,DA(1)=LIST,DIK="^OR(100.21,"_DA(1)_",10,"
"RTN","PXRMLPOE",86,0)
 . D ^DIK
"RTN","PXRMLPOE",87,0)
 ;
"RTN","PXRMLPOE",88,0)
 ;DBIA #4561 covers putting data into OE/RR list.
"RTN","PXRMLPOE",89,0)
 ;Create the stub in file #100.21
"RTN","PXRMLPOE",90,0)
 W !,"Updating "_NAME
"RTN","PXRMLPOE",91,0)
 S FDA(100.21,"?1,",.01)=NAME
"RTN","PXRMLPOE",92,0)
 S FDA(100.21,"?1,",.1)=$$UP^XLFSTR(NAME)
"RTN","PXRMLPOE",93,0)
 S FDA(100.21,"?1,",1)="TM"
"RTN","PXRMLPOE",94,0)
 S FDA(100.21,"?1,",1.6)=DUZ
"RTN","PXRMLPOE",95,0)
 S FDA(100.21,"?1,",1.65)=$$NOW^XLFDT
"RTN","PXRMLPOE",96,0)
 S FDA(100.21,"?1,",11)="0"
"RTN","PXRMLPOE",97,0)
 D UPDATE^DIE("","FDA","FDAIEN","MSG")
"RTN","PXRMLPOE",98,0)
 ;Error
"RTN","PXRMLPOE",99,0)
 I $D(MSG) D  Q
"RTN","PXRMLPOE",100,0)
 . N TEXT
"RTN","PXRMLPOE",101,0)
 . S TEXT(1)="The patient list copy failed."
"RTN","PXRMLPOE",102,0)
 . S TEXT(2)="Examine the following error message for the reason."
"RTN","PXRMLPOE",103,0)
 . S TEXT(3)=""
"RTN","PXRMLPOE",104,0)
 . D MES^XPDUTL(.TEXT)
"RTN","PXRMLPOE",105,0)
 . D AWRITE^PXRMUTIL("MSG")
"RTN","PXRMLPOE",106,0)
 . W ! H 3
"RTN","PXRMLPOE",107,0)
 . D UNLOCK(LIST)
"RTN","PXRMLPOE",108,0)
 ;Do a direct copy of the patients.
"RTN","PXRMLPOE",109,0)
 S (CNT,SUB)=0,IEN=FDAIEN(1)
"RTN","PXRMLPOE",110,0)
 F  S SUB=$O(^PXRMXP(810.5,IENO,30,SUB)) Q:'SUB  D
"RTN","PXRMLPOE",111,0)
 . S DFN=$P($G(^PXRMXP(810.5,IENO,30,SUB,0)),U,1) Q:'DFN
"RTN","PXRMLPOE",112,0)
 . S CNT=CNT+1
"RTN","PXRMLPOE",113,0)
 . S TEMP=DFN_";DPT("
"RTN","PXRMLPOE",114,0)
 . S ^OR(100.21,IEN,10,CNT,0)=TEMP
"RTN","PXRMLPOE",115,0)
 . S ^OR(100.21,IEN,10,"B",TEMP,CNT)=""
"RTN","PXRMLPOE",116,0)
  S ^OR(100.21,IEN,10,0)="^100.2101AV"_U_CNT_U_CNT
"RTN","PXRMLPOE",117,0)
 ;Unlock patient list
"RTN","PXRMLPOE",118,0)
 D UNLOCK(LIST)
"RTN","PXRMLPOE",119,0)
 W !!,"Completed copy of patient list '"_ONAME_"'"
"RTN","PXRMLPOE",120,0)
 W !,"into OE/RR Team '"_NNAME_"'",! H 3
"RTN","PXRMLPOE",121,0)
 Q
"RTN","PXRMLPOE",122,0)
 ;
"RTN","PXRMLPOE",123,0)
UNLOCK(LIST) ;Unlock the list
"RTN","PXRMLPOE",124,0)
 L -^PXRMXP(100.21,LIST)
"RTN","PXRMLPOE",125,0)
 Q
"RTN","PXRMLPOE",126,0)
 ;
"RTN","PXRMMSER")
0^15^B106782052
"RTN","PXRMMSER",1,0)
PXRMMSER ;SLC/PKR,AJB - Computed findings for military service information. ;06/26/2012
"RTN","PXRMMSER",2,0)
 ;;2.0;CLINICAL REMINDERS;**11,12,21,24**;Feb 04, 2005;Build 193
"RTN","PXRMMSER",3,0)
 ;
"RTN","PXRMMSER",4,0)
 ;======================================================
"RTN","PXRMMSER",5,0)
AORANGE(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",6,0)
 ;finding will be true if the agent orange exposure registration
"RTN","PXRMMSER",7,0)
 ;date is in the date range specified by Beginning Date/Time
"RTN","PXRMMSER",8,0)
 ;and Ending Date/Time. VA-AGENT ORANGE EXPOSURE.
"RTN","PXRMMSER",9,0)
 N RDATE
"RTN","PXRMMSER",10,0)
 S NFOUND=0
"RTN","PXRMMSER",11,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",12,0)
 S TEST=^TMP($J,"SVC",DFN,2)
"RTN","PXRMMSER",13,0)
 I 'TEST Q
"RTN","PXRMMSER",14,0)
 S RDATE=+$P(^TMP($J,"SVC",DFN,2,1),U,1)
"RTN","PXRMMSER",15,0)
 I (RDATE=0)!(RDATE<BDT)!(RDATE>EDT) S TEST=0 Q
"RTN","PXRMMSER",16,0)
 S NFOUND=1
"RTN","PXRMMSER",17,0)
 S TEST(NFOUND)=1,DATE(NFOUND)=RDATE
"RTN","PXRMMSER",18,0)
 S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=$P(^TMP($J,"SVC",DFN,2,5),U,2)
"RTN","PXRMMSER",19,0)
 S TEXT(NFOUND)="Agent orange exposure registration date: "_$$FMTE^XLFDT(RDATE,"5Z")_"; location: "_DATA(NFOUND,"LOCATION")
"RTN","PXRMMSER",20,0)
 Q
"RTN","PXRMMSER",21,0)
 ;
"RTN","PXRMMSER",22,0)
 ;======================================================
"RTN","PXRMMSER",23,0)
COMBAT(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",24,0)
 ;finding will be true if combat service is found in the
"RTN","PXRMMSER",25,0)
 ;date range the date range specified by Beginning Date/Time
"RTN","PXRMMSER",26,0)
 ;and Ending Date/Time. VA-COMBAT SERVICE.
"RTN","PXRMMSER",27,0)
 N FDATE,TDATE
"RTN","PXRMMSER",28,0)
 S NFOUND=0
"RTN","PXRMMSER",29,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",30,0)
 S TEST=^TMP($J,"SVC",DFN,5)
"RTN","PXRMMSER",31,0)
 I 'TEST Q
"RTN","PXRMMSER",32,0)
 S FDATE=$P(^TMP($J,"SVC",DFN,5,1),U,1)
"RTN","PXRMMSER",33,0)
 S TDATE=$P(^TMP($J,"SVC",DFN,5,2),U,1)
"RTN","PXRMMSER",34,0)
 I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" S TEST=0 Q
"RTN","PXRMMSER",35,0)
 S NFOUND=1
"RTN","PXRMMSER",36,0)
 S TEST(NFOUND)=1,DATE(NFOUND)=FDATE
"RTN","PXRMMSER",37,0)
 S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=$P(^TMP($J,"SVC",DFN,5,3),U,2)
"RTN","PXRMMSER",38,0)
 S TEXT(NFOUND)="Combat service from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")_"; location: "_DATA(NFOUND,"LOCATION")
"RTN","PXRMMSER",39,0)
 Q
"RTN","PXRMMSER",40,0)
 ;
"RTN","PXRMMSER",41,0)
 ;======================================================
"RTN","PXRMMSER",42,0)
CVELIG(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Computed finding for
"RTN","PXRMMSER",43,0)
 ;combat vet eligiblity data. VA-COMBAT VET ELIGIBILITY.
"RTN","PXRMMSER",44,0)
 N CV,EDATE,ELIG,RESULT
"RTN","PXRMMSER",45,0)
 ;DBIA #4156
"RTN","PXRMMSER",46,0)
 S RESULT=$$CVEDT^DGCV(DFN,$$NOW^PXRMDATE)
"RTN","PXRMMSER",47,0)
 ;RESULT=(1,0,-1)^End Date (if populated, otherwise null)^CV
"RTN","PXRMMSER",48,0)
 ;      (piece 1)  1 - qualifies as a CV
"RTN","PXRMMSER",49,0)
 ;                 0 - does not qualify as a CV
"RTN","PXRMMSER",50,0)
 ;                -1 - bad DFN or date
"RTN","PXRMMSER",51,0)
 ;      (piece 3)  1 - vet was eligible on date specified (or DT)      
"RTN","PXRMMSER",52,0)
 ;                 0 - vet was not eligible on date specified (or DT)
"RTN","PXRMMSER",53,0)
 S CV=$P(RESULT,U,1),EDATE=$P(RESULT,U,2),ELIG=$P(RESULT,U,3)
"RTN","PXRMMSER",54,0)
 I 'CV S NFOUND=0 Q
"RTN","PXRMMSER",55,0)
 S NFOUND=1
"RTN","PXRMMSER",56,0)
 S TEST(NFOUND)=CV,DATE(NFOUND)=$$NOW^PXRMDATE
"RTN","PXRMMSER",57,0)
 S TEXT(NFOUND)="End date is "_$$FMTE^XLFDT(EDATE,"5Z")
"RTN","PXRMMSER",58,0)
 S DATA(NFOUND,"END DATE")=EDATE
"RTN","PXRMMSER",59,0)
 S DATA(NFOUND,"VALUE")=$S(ELIG:"ELIGIBLE",1:"EXPIRED")
"RTN","PXRMMSER",60,0)
 S DATA(NFOUND,"STATUS")=DATA(NFOUND,"VALUE")
"RTN","PXRMMSER",61,0)
 Q
"RTN","PXRMMSER",62,0)
 ;
"RTN","PXRMMSER",63,0)
 ;======================================================
"RTN","PXRMMSER",64,0)
DISCHDT(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;
"RTN","PXRMMSER",65,0)
 ; This computed finding returns the service separation date.
"RTN","PXRMMSER",66,0)
 ; CF.VA-SERVICE SEPARATION DATES
"RTN","PXRMMSER",67,0)
 N IND
"RTN","PXRMMSER",68,0)
 D MSDATA(DFN,NGET,BDT,EDT,.NFOUND,.TEST,.DATE,.DATA,.TEXT,1)
"RTN","PXRMMSER",69,0)
 F IND=1:1:NFOUND S DATA(IND,"VALUE")=DATE(IND)
"RTN","PXRMMSER",70,0)
 Q
"RTN","PXRMMSER",71,0)
 ;
"RTN","PXRMMSER",72,0)
 ;======================================================
"RTN","PXRMMSER",73,0)
GETSVCD(DFN) ;Get the SVC^VADPT service data.
"RTN","PXRMMSER",74,0)
 I $D(^TMP($J,"SVC",DFN)) Q
"RTN","PXRMMSER",75,0)
 N VAERR,VAROOT
"RTN","PXRMMSER",76,0)
 S VAROOT="^TMP($J,""SVC"",DFN)"
"RTN","PXRMMSER",77,0)
 D SVC^VADPT
"RTN","PXRMMSER",78,0)
 Q
"RTN","PXRMMSER",79,0)
 ;
"RTN","PXRMMSER",80,0)
 ;======================================================
"RTN","PXRMMSER",81,0)
MSDATA(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT,SEPDTR) ;This computed
"RTN","PXRMMSER",82,0)
 ;finding will return service branch information.
"RTN","PXRMMSER",83,0)
 ;CF.VA-SERVICE BRANCH.
"RTN","PXRMMSER",84,0)
 ;DBIA #5354
"RTN","PXRMMSER",85,0)
 N ENTRYDTA,MSDATA,NEPS
"RTN","PXRMMSER",86,0)
 D MSDATA^DGMSE(DFN,.NEPS,.ENTRYDTA,.MSDATA)
"RTN","PXRMMSER",87,0)
 I NEPS=0 S NFOUND=0 Q
"RTN","PXRMMSER",88,0)
 N BRANCH,DISTYPE,ENTRYDT,ENTRYDTO,IND,NOW
"RTN","PXRMMSER",89,0)
 N SCOMP,SDIR,SEPDT,SEPDTC,SEPDTCO
"RTN","PXRMMSER",90,0)
 S NOW=$$NOW^PXRMDATE
"RTN","PXRMMSER",91,0)
 S SDIR=$S(NGET>0:-1,1:1)
"RTN","PXRMMSER",92,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMMSER",93,0)
 S NFOUND=0,ENTRYDT=""
"RTN","PXRMMSER",94,0)
 F  S ENTRYDT=$O(ENTRYDTA(ENTRYDT),SDIR) Q:(ENTRYDT="")!(NFOUND=NGET)  D
"RTN","PXRMMSER",95,0)
 . S IND=ENTRYDTA(ENTRYDT)
"RTN","PXRMMSER",96,0)
 . S SEPDT=MSDATA(IND,"SEPARATION DATE")
"RTN","PXRMMSER",97,0)
 .;Check for separation date required.
"RTN","PXRMMSER",98,0)
 . I SEPDTR,SEPDT="" Q
"RTN","PXRMMSER",99,0)
 . I SEPDTR,(SEPDT>EDT) Q
"RTN","PXRMMSER",100,0)
 .;If there is no Separation Date use the evaluation date and time.
"RTN","PXRMMSER",101,0)
 . S SEPDTC=$S(SEPDT'="":SEPDT,1:NOW)
"RTN","PXRMMSER",102,0)
 . I $$OVERLAP^PXRMINDX(ENTRYDT,SEPDTC,BDT,EDT)'="O" Q
"RTN","PXRMMSER",103,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMMSER",104,0)
 . S TEST(NFOUND)=1
"RTN","PXRMMSER",105,0)
 . S DATE(NFOUND)=MSDATA(IND,"DATE")
"RTN","PXRMMSER",106,0)
 . S BRANCH=MSDATA(IND,"BRANCH")
"RTN","PXRMMSER",107,0)
 . I BRANCH="" S BRANCH="<NO DATA>"
"RTN","PXRMMSER",108,0)
 . S DATA(NFOUND,"BRANCH")=BRANCH
"RTN","PXRMMSER",109,0)
 . S SCOMP=MSDATA(IND,"SERVICE COMPONENT")
"RTN","PXRMMSER",110,0)
 . S SCOMP=$S(SCOMP="":"<NO DATA>",1:SCOMP)
"RTN","PXRMMSER",111,0)
 . S DATA(NFOUND,"SERVICE COMPONENT")=SCOMP
"RTN","PXRMMSER",112,0)
 . S DISTYPE=MSDATA(IND,"DISCHARGE TYPE")
"RTN","PXRMMSER",113,0)
 . S DISTYPE=$S(DISTYPE="":"<NO DATA>",1:DISTYPE)
"RTN","PXRMMSER",114,0)
 . S DATA(NFOUND,"DISCHARGE TYPE")=DISTYPE
"RTN","PXRMMSER",115,0)
 . S ENTRYDTO=$$FMTE^XLFDT(ENTRYDT,"5Z")
"RTN","PXRMMSER",116,0)
 . S SEPDTO=$S(SEPDT="":"<NO DATA>",1:$$FMTE^XLFDT(SEPDT,"5Z"))
"RTN","PXRMMSER",117,0)
 . S TEXT(NFOUND)="Service from "_ENTRYDTO_" to "_SEPDTO_" in "_BRANCH_"; service component "_SCOMP_"; discharge "_DISTYPE_"."
"RTN","PXRMMSER",118,0)
 Q
"RTN","PXRMMSER",119,0)
 ;
"RTN","PXRMMSER",120,0)
 ;======================================================
"RTN","PXRMMSER",121,0)
OEF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",122,0)
 ;finding will return OEF service information in the date range
"RTN","PXRMMSER",123,0)
 ;specified by Beginning Date/Time and Ending Date/Time.
"RTN","PXRMMSER",124,0)
 ;VA-OEF SERVICE.
"RTN","PXRMMSER",125,0)
 N FDATE,IND,SDIR,TDATE,TEMP
"RTN","PXRMMSER",126,0)
 S NFOUND=0
"RTN","PXRMMSER",127,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMMSER",128,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMMSER",129,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",130,0)
 I ^TMP($J,"SVC",DFN,12)=0 Q
"RTN","PXRMMSER",131,0)
 S IND=""
"RTN","PXRMMSER",132,0)
 F  S IND=$O(^TMP($J,"SVC",DFN,12,IND)) Q:IND=""  D
"RTN","PXRMMSER",133,0)
 . S FDATE=$P(^TMP($J,"SVC",DFN,12,IND,2),U,1)
"RTN","PXRMMSER",134,0)
 . I FDATE="" Q
"RTN","PXRMMSER",135,0)
 . S TDATE=$P(^TMP($J,"SVC",DFN,12,IND,3),U,1)
"RTN","PXRMMSER",136,0)
 . I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" Q
"RTN","PXRMMSER",137,0)
 . S TEMP(FDATE,"TEST")=1
"RTN","PXRMMSER",138,0)
 . S TEMP(FDATE,"DATA","LOCATION")=$P(^TMP($J,"SVC",DFN,12,IND,1),U,2)
"RTN","PXRMMSER",139,0)
 . S TEMP(FDATE,"TEXT")="OEF service from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")_"; location: "_TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",140,0)
 S FDATE=""
"RTN","PXRMMSER",141,0)
 F  S FDATE=$O(TEMP(FDATE),SDIR) Q:(FDATE="")!(NFOUND=NGET)  D
"RTN","PXRMMSER",142,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMMSER",143,0)
 . S TEST(NFOUND)=TEMP(FDATE,"TEST"),DATE(NFOUND)=FDATE
"RTN","PXRMMSER",144,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",145,0)
 . S TEXT(NFOUND)=TEMP(FDATE,"TEXT")
"RTN","PXRMMSER",146,0)
 Q
"RTN","PXRMMSER",147,0)
 ;
"RTN","PXRMMSER",148,0)
 ;======================================================
"RTN","PXRMMSER",149,0)
OEIF(NGET,BDT,EDT,TGLIST,PARAM) ;List computed finding to build patient
"RTN","PXRMMSER",150,0)
 ;list based on OEF/OIF/UNK data.
"RTN","PXRMMSER",151,0)
 ;VA-OEF/OIF
"RTN","PXRMMSER",152,0)
 N DA,DATE,DFN,FDATE,LOC,LOCATION,NFOUND,TDATE
"RTN","PXRMMSER",153,0)
 K ^TMP($J,TGLIST)
"RTN","PXRMMSER",154,0)
 ;DBIA #5354
"RTN","PXRMMSER",155,0)
 D OEIF^DGMSE(BDT,EDT,"OEIF")
"RTN","PXRMMSER",156,0)
 S DATE=$$NOW^PXRMDATE
"RTN","PXRMMSER",157,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMMSER",158,0)
 S LOCATION=$G(PARAM)
"RTN","PXRMMSER",159,0)
 I LOCATION="" S LOCATION="ANY"
"RTN","PXRMMSER",160,0)
 S DFN=""
"RTN","PXRMMSER",161,0)
 F  S DFN=$O(^TMP($J,"OEIF",DFN)) Q:DFN=""  D
"RTN","PXRMMSER",162,0)
 . S FDATE=""
"RTN","PXRMMSER",163,0)
 . F  S FDATE=$O(^TMP($J,"OEIF",DFN,FDATE)) Q:FDATE=""  D
"RTN","PXRMMSER",164,0)
 .. S TDATE=""
"RTN","PXRMMSER",165,0)
 .. F  S TDATE=$O(^TMP($J,"OEIF",DFN,FDATE,TDATE)) Q:TDATE=""  D
"RTN","PXRMMSER",166,0)
 ... S LOC=""
"RTN","PXRMMSER",167,0)
 ... F  S LOC=$O(^TMP($J,"OEIF",DFN,FDATE,TDATE,LOC)) Q:LOC=""  D
"RTN","PXRMMSER",168,0)
 .... S NFOUND=+$O(^TMP($J,TGLIST,DFN,""))
"RTN","PXRMMSER",169,0)
 .... I NFOUND=NGET Q
"RTN","PXRMMSER",170,0)
 .... I (LOCATION["ANY")!(LOCATION[LOC) D
"RTN","PXRMMSER",171,0)
 ..... S DA=""
"RTN","PXRMMSER",172,0)
 ..... F  S DA=$O(^TMP($J,"OEIF",DFN,FDATE,TDATE,LOC,DA)) Q:DA=""  D
"RTN","PXRMMSER",173,0)
 ...... S NFOUND=NFOUND+1
"RTN","PXRMMSER",174,0)
 ...... S ^TMP($J,TGLIST,DFN,NFOUND)=DFN_";"_DA_U_DATE_U_2_U_LOC_U_TDATE_";"_FDATE
"RTN","PXRMMSER",175,0)
 K ^TMP($J,"OEIF")
"RTN","PXRMMSER",176,0)
 Q
"RTN","PXRMMSER",177,0)
 ;
"RTN","PXRMMSER",178,0)
 ;======================================================
"RTN","PXRMMSER",179,0)
OIF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",180,0)
 ;finding will return OIF service information in the date range
"RTN","PXRMMSER",181,0)
 ;specified by Beginning Date/Time and Ending Date/Time.
"RTN","PXRMMSER",182,0)
 ;VA-OIF SERVICE.
"RTN","PXRMMSER",183,0)
 N FDATE,IND,SDIR,TDATE,TEMP
"RTN","PXRMMSER",184,0)
 S NFOUND=0
"RTN","PXRMMSER",185,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMMSER",186,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMMSER",187,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",188,0)
 I ^TMP($J,"SVC",DFN,11)=0 Q
"RTN","PXRMMSER",189,0)
 S IND=""
"RTN","PXRMMSER",190,0)
 F  S IND=$O(^TMP($J,"SVC",DFN,11,IND)) Q:IND=""  D
"RTN","PXRMMSER",191,0)
 . S FDATE=$P(^TMP($J,"SVC",DFN,11,IND,2),U,1)
"RTN","PXRMMSER",192,0)
 . I FDATE="" Q
"RTN","PXRMMSER",193,0)
 . S TDATE=$P(^TMP($J,"SVC",DFN,11,IND,3),U,1)
"RTN","PXRMMSER",194,0)
 . I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" Q
"RTN","PXRMMSER",195,0)
 . S TEMP(FDATE,"TEST")=1
"RTN","PXRMMSER",196,0)
 . S TEMP(FDATE,"DATA","LOCATION")=$P(^TMP($J,"SVC",DFN,11,IND,1),U,2)
"RTN","PXRMMSER",197,0)
 . S TEMP(FDATE,"TEXT")="OIFF service from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")_"; location: "_TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",198,0)
 S FDATE=""
"RTN","PXRMMSER",199,0)
 F  S FDATE=$O(TEMP(FDATE),SDIR) Q:(FDATE="")!(NFOUND=NGET)  D
"RTN","PXRMMSER",200,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMMSER",201,0)
 . S TEST(NFOUND)=TEMP(FDATE,"TEST"),DATE(NFOUND)=FDATE
"RTN","PXRMMSER",202,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",203,0)
 . S TEXT(NFOUND)=TEMP(FDATE,"TEXT")
"RTN","PXRMMSER",204,0)
 Q
"RTN","PXRMMSER",205,0)
 ;
"RTN","PXRMMSER",206,0)
 ;======================================================
"RTN","PXRMMSER",207,0)
PHEART(DFN,TEST,DATE,VALUE,TEXT) ;Single value computed finding for
"RTN","PXRMMSER",208,0)
 ;purple heart data. VA-PURPLE HEART.
"RTN","PXRMMSER",209,0)
 N CV,EDATE,ELIG,RESULT
"RTN","PXRMMSER",210,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",211,0)
 S TEST=^TMP($J,"SVC",DFN,9)
"RTN","PXRMMSER",212,0)
 I 'TEST Q
"RTN","PXRMMSER",213,0)
 S DATE=$$NOW^PXRMDATE
"RTN","PXRMMSER",214,0)
 S VALUE=""
"RTN","PXRMMSER",215,0)
 S TEXT="Patient is a Purple Heart recipient."
"RTN","PXRMMSER",216,0)
 Q
"RTN","PXRMMSER",217,0)
 ;
"RTN","PXRMMSER",218,0)
 ;======================================================
"RTN","PXRMMSER",219,0)
POW(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",220,0)
 ;finding will be true if the patient was a POW in the date range
"RTN","PXRMMSER",221,0)
 ;specified by Beginning Date/Time and Ending Date/Time.
"RTN","PXRMMSER",222,0)
 ;VA-POW.
"RTN","PXRMMSER",223,0)
 N FDATE,TDATE
"RTN","PXRMMSER",224,0)
 S NFOUND=0
"RTN","PXRMMSER",225,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",226,0)
 S TEST=^TMP($J,"SVC",DFN,4)
"RTN","PXRMMSER",227,0)
 I 'TEST Q
"RTN","PXRMMSER",228,0)
 S FDATE=$P(^TMP($J,"SVC",DFN,4,1),U,1)
"RTN","PXRMMSER",229,0)
 S TDATE=$P(^TMP($J,"SVC",DFN,4,2),U,1)
"RTN","PXRMMSER",230,0)
 I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" S TEST=0 Q
"RTN","PXRMMSER",231,0)
 S NFOUND=1
"RTN","PXRMMSER",232,0)
 S TEST(NFOUND)=1,DATE(NFOUND)=FDATE
"RTN","PXRMMSER",233,0)
 S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=$P(^TMP($J,"SVC",DFN,4,3),U,2)
"RTN","PXRMMSER",234,0)
 S TEXT(NFOUND)="Patient was a POW from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")_"; location: "_DATA(NFOUND,"LOCATION")
"RTN","PXRMMSER",235,0)
 Q
"RTN","PXRMMSER",236,0)
 ;
"RTN","PXRMMSER",237,0)
 ;======================================================
"RTN","PXRMMSER",238,0)
RADEXP(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;;This computed
"RTN","PXRMMSER",239,0)
 ;finding will be true if the radiation exposure registration
"RTN","PXRMMSER",240,0)
 ;date is in the date range specified by Beginning Date/Time
"RTN","PXRMMSER",241,0)
 ;and Ending Date/Time. DVA-RADIATION EXPOSURE.
"RTN","PXRMMSER",242,0)
 N RDATE
"RTN","PXRMMSER",243,0)
 S NFOUND=0
"RTN","PXRMMSER",244,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",245,0)
 S TEST=^TMP($J,"SVC",DFN,3)
"RTN","PXRMMSER",246,0)
 I 'TEST Q
"RTN","PXRMMSER",247,0)
 S RDATE=$P(^TMP($J,"SVC",DFN,3,1),U,1)
"RTN","PXRMMSER",248,0)
 I (RDATE<BDT)!(RDATE>EDT) S TEST=0 Q
"RTN","PXRMMSER",249,0)
 S NFOUND=1
"RTN","PXRMMSER",250,0)
 S TEST(NFOUND)=1,DATE(NFOUND)=RDATE
"RTN","PXRMMSER",251,0)
 S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"EXPOSURE METHOD"))=$P(^TMP($J,"SVC",DFN,3,2),U,2)
"RTN","PXRMMSER",252,0)
 S TEXT(NFOUND)="Radiation exposure registration date: "_$$FMTE^XLFDT(RDATE,"5Z")_"; exposure method: "_DATA(NFOUND,"EXPOSURE METHOD")
"RTN","PXRMMSER",253,0)
 Q
"RTN","PXRMMSER",254,0)
 ;
"RTN","PXRMMSER",255,0)
 ;======================================================
"RTN","PXRMMSER",256,0)
SBRANCH(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",257,0)
 ;finding will return service branch information.
"RTN","PXRMMSER",258,0)
 ;CF.VA-SERVICE BRANCH.
"RTN","PXRMMSER",259,0)
 N IND
"RTN","PXRMMSER",260,0)
 D MSDATA(DFN,NGET,BDT,EDT,.NFOUND,.TEST,.DATE,.DATA,.TEXT,0)
"RTN","PXRMMSER",261,0)
 F IND=1:1:NFOUND S DATA(IND,"VALUE")=DATA(IND,"BRANCH")
"RTN","PXRMMSER",262,0)
 Q
"RTN","PXRMMSER",263,0)
 ;
"RTN","PXRMMSER",264,0)
 ;======================================================
"RTN","PXRMMSER",265,0)
UNKOEIF(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed
"RTN","PXRMMSER",266,0)
 ;finding will return unknown OEF/OIF service information in the date
"RTN","PXRMMSER",267,0)
 ;range specified by Beginning Date/Time and Ending Date/Time.
"RTN","PXRMMSER",268,0)
 ;VA-UNKNOWN OEF/OIF SERVICE.
"RTN","PXRMMSER",269,0)
 N FDATE,IND,SDIR,TDATE,TEMP
"RTN","PXRMMSER",270,0)
 S NFOUND=0
"RTN","PXRMMSER",271,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMMSER",272,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMMSER",273,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",274,0)
 I ^TMP($J,"SVC",DFN,13)=0 Q
"RTN","PXRMMSER",275,0)
 S IND=""
"RTN","PXRMMSER",276,0)
 F  S IND=$O(^TMP($J,"SVC",DFN,13,IND)) Q:IND=""  D
"RTN","PXRMMSER",277,0)
 . S FDATE=$P(^TMP($J,"SVC",DFN,13,IND,2),U,1)
"RTN","PXRMMSER",278,0)
 . I FDATE="" Q
"RTN","PXRMMSER",279,0)
 . S TDATE=$P(^TMP($J,"SVC",DFN,13,IND,3),U,1)
"RTN","PXRMMSER",280,0)
 . I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" Q
"RTN","PXRMMSER",281,0)
 . S TEMP(FDATE,"TEST")=1
"RTN","PXRMMSER",282,0)
 . S TEMP(FDATE,"DATA","LOCATION")=$P(^TMP($J,"SVC",DFN,13,IND,1),U,2)
"RTN","PXRMMSER",283,0)
 . S TEMP(FDATE,"TEXT")="OEF/OIF service from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")_"; location: "_TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",284,0)
 S FDATE=""
"RTN","PXRMMSER",285,0)
 F  S FDATE=$O(TEMP(FDATE),SDIR) Q:(FDATE="")!(NFOUND=NGET)  D
"RTN","PXRMMSER",286,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMMSER",287,0)
 . S TEST(NFOUND)=TEMP(FDATE,"TEST"),DATE(NFOUND)=FDATE
"RTN","PXRMMSER",288,0)
 . S (DATA(NFOUND,"VALUE"),DATA(NFOUND,"LOCATION"))=TEMP(FDATE,"DATA","LOCATION")
"RTN","PXRMMSER",289,0)
 . S TEXT(NFOUND)=TEMP(FDATE,"TEXT")
"RTN","PXRMMSER",290,0)
 Q
"RTN","PXRMMSER",291,0)
 ;
"RTN","PXRMMSER",292,0)
 ;======================================================
"RTN","PXRMMSER",293,0)
VETERAN(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for checking if a
"RTN","PXRMMSER",294,0)
 ;patient is a veteran. VA-VETERAN.
"RTN","PXRMMSER",295,0)
 N VAEL
"RTN","PXRMMSER",296,0)
 S DATE=$$NOW^PXRMDATE
"RTN","PXRMMSER",297,0)
 D ELIG^VADPT
"RTN","PXRMMSER",298,0)
 S TEST=VAEL(4)
"RTN","PXRMMSER",299,0)
 S VALUE=""
"RTN","PXRMMSER",300,0)
 D KVA^VADPT
"RTN","PXRMMSER",301,0)
 Q
"RTN","PXRMMSER",302,0)
 ;
"RTN","PXRMMSER",303,0)
 ;======================================================
"RTN","PXRMMSER",304,0)
VIET(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;This computed will be
"RTN","PXRMMSER",305,0)
 ;true if Vietnam service in the date range specified by BDT and EDT
"RTN","PXRMMSER",306,0)
 ;is found. Note even though it is a multi structure it can only
"RTN","PXRMMSER",307,0)
 ;return one occurrence. VA-VIETNAM SERVICE.
"RTN","PXRMMSER",308,0)
 N FDATE,TDATE
"RTN","PXRMMSER",309,0)
 S NFOUND=0
"RTN","PXRMMSER",310,0)
 D GETSVCD(DFN)
"RTN","PXRMMSER",311,0)
 S TEST=^TMP($J,"SVC",DFN,1)
"RTN","PXRMMSER",312,0)
 I 'TEST Q
"RTN","PXRMMSER",313,0)
 S FDATE=$P(^TMP($J,"SVC",DFN,1,1),U,1)
"RTN","PXRMMSER",314,0)
 S TDATE=$P(^TMP($J,"SVC",DFN,1,2),U,1)
"RTN","PXRMMSER",315,0)
 I $$OVERLAP^PXRMINDX(FDATE,TDATE,BDT,EDT)'="O" S TEST=0 Q
"RTN","PXRMMSER",316,0)
 S NFOUND=1
"RTN","PXRMMSER",317,0)
 S TEST(NFOUND)=1,DATE(NFOUND)=FDATE
"RTN","PXRMMSER",318,0)
 S TEXT(NFOUND)="Vietnam service from "_$$FMTE^XLFDT(FDATE,"5Z")_" to "_$$FMTE^XLFDT(TDATE,"5Z")
"RTN","PXRMMSER",319,0)
 Q
"RTN","PXRMMSER",320,0)
 ;
"RTN","PXRMNTFY")
0^4^B3662059
"RTN","PXRMNTFY",1,0)
PXRMNTFY ;SLC/PKR - Routines for notifications. ;07/25/2012
"RTN","PXRMNTFY",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 193
"RTN","PXRMNTFY",3,0)
 ;
"RTN","PXRMNTFY",4,0)
 ;========================
"RTN","PXRMNTFY",5,0)
DELOPEN(DFN,ORN) ;Delete open OE/RR Notifications.
"RTN","PXRMNTFY",6,0)
 N ALIST,IND,ORID,XQAID
"RTN","PXRMNTFY",7,0)
 ;DBIA #10081
"RTN","PXRMNTFY",8,0)
 D PATIENT^XQALERT("ALIST",DFN)
"RTN","PXRMNTFY",9,0)
 F IND=1:1:ALIST D
"RTN","PXRMNTFY",10,0)
 . S XQAID=$P(ALIST(IND),U,2)
"RTN","PXRMNTFY",11,0)
 . S ORID=$P(XQAID,";",1)
"RTN","PXRMNTFY",12,0)
 . I $P(ORID,",",3)=ORN D DELETE^XQALERT
"RTN","PXRMNTFY",13,0)
 Q
"RTN","PXRMNTFY",14,0)
 ;
"RTN","PXRMNTFY",15,0)
 ;========================
"RTN","PXRMNTFY",16,0)
SUICIDE(EVENT,DFN,VISIT) ;Send an alert if the patient attempted or
"RTN","PXRMNTFY",17,0)
 ;completed suicide, as marked by a health factor. This is called
"RTN","PXRMNTFY",18,0)
 ;from DATACHGR^PXRMPINF which is invoked by the protocol PXK VISIT
"RTN","PXRMNTFY",19,0)
 ;DATA EVENT.
"RTN","PXRMNTFY",20,0)
 N DATE,HAFIEN,HFBIEN,HFSAIEN,HFSCIEN,MSG,VHFIEN
"RTN","PXRMNTFY",21,0)
 S HFSAIEN=$$FIND1^DIC(9999999.64,"","","MH SUICIDE ATTEMPTED")
"RTN","PXRMNTFY",22,0)
 S HFSCIEN=$$FIND1^DIC(9999999.64,"","","MH SUICIDE COMPLETED")
"RTN","PXRMNTFY",23,0)
 S (MSG,VHFIEN)=""
"RTN","PXRMNTFY",24,0)
 F  S VHFIEN=$O(^XTMP(EVENT,VISIT,"HF",VHFIEN)) Q:VHFIEN=""  D
"RTN","PXRMNTFY",25,0)
 . S HFAIEN=$P($G(^XTMP(EVENT,VISIT,"HF",VHFIEN,0,"AFTER")),U,1)
"RTN","PXRMNTFY",26,0)
 . S HFBIEN=$P($G(^XTMP(EVENT,VISIT,"HF",VHFIEN,0,"BEFORE")),U,1)
"RTN","PXRMNTFY",27,0)
 .;If after is null then the health factor has been deleted so delete
"RTN","PXRMNTFY",28,0)
 .;any open alerts.
"RTN","PXRMNTFY",29,0)
 . I HFAIEN="",HFBIEN'="" D DELOPEN^PXRMNTFY(DFN,77) Q
"RTN","PXRMNTFY",30,0)
 .;If the before and after are the same the HF is not new so do not
"RTN","PXRMNTFY",31,0)
 .;send the alert.
"RTN","PXRMNTFY",32,0)
 . I HFAIEN=HFBIEN Q
"RTN","PXRMNTFY",33,0)
 . I HFAIEN=HFSAIEN S MSG="Suicide attempted"
"RTN","PXRMNTFY",34,0)
 . I HFAIEN=HFSCIEN S MSG="Suicide completed"
"RTN","PXRMNTFY",35,0)
 I MSG="" Q
"RTN","PXRMNTFY",36,0)
 ;DBIA #2028
"RTN","PXRMNTFY",37,0)
 S DATE=$P(^AUPNVSIT(VISIT,0),U,1)
"RTN","PXRMNTFY",38,0)
 ;If DATE is more than 30 days in the past do not send the alert.
"RTN","PXRMNTFY",39,0)
 I $$FMDIFF^XLFDT(DT,DATE)>30 Q
"RTN","PXRMNTFY",40,0)
 S MSG=MSG_" on "_$$FMTE^XLFDT(DATE,"5Z")
"RTN","PXRMNTFY",41,0)
 ;DBIA #1362
"RTN","PXRMNTFY",42,0)
 D EN^ORB3(77,DFN,"","",MSG,"")
"RTN","PXRMNTFY",43,0)
 Q
"RTN","PXRMNTFY",44,0)
 ;
"RTN","PXRMP24E")
0^5^B2321909
"RTN","PXRMP24E",1,0)
PXRMP24E ;SLC/PKR - Exchange inits for PXRM*2.0*24 ;05/09/2013
"RTN","PXRMP24E",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 193
"RTN","PXRMP24E",3,0)
 ;====================================================
"RTN","PXRMP24E",4,0)
EXARRAY(MODE,ARRAY) ;List of exchange entries used by delete and install
"RTN","PXRMP24E",5,0)
 ;MODE values: I for include in build, A for include action.
"RTN","PXRMP24E",6,0)
 N LN
"RTN","PXRMP24E",7,0)
 S LN=0
"RTN","PXRMP24E",8,0)
 ;
"RTN","PXRMP24E",9,0)
 S LN=LN+1
"RTN","PXRMP24E",10,0)
 S ARRAY(LN,1)="VA-MH NO SHOW APPT CLINICS LL"
"RTN","PXRMP24E",11,0)
 I MODE["I" S ARRAY(LN,2)="10/05/2011@12:43:59"
"RTN","PXRMP24E",12,0)
 I MODE["A" S ARRAY(LN,3)="O"
"RTN","PXRMP24E",13,0)
 ;
"RTN","PXRMP24E",14,0)
 S LN=LN+1
"RTN","PXRMP24E",15,0)
 S ARRAY(LN,1)="VA-MHTC APPT STOP CODES AND EXCLUSION STOP"
"RTN","PXRMP24E",16,0)
 I MODE["I" S ARRAY(LN,2)="05/09/2013@11:28:49"
"RTN","PXRMP24E",17,0)
 I MODE["A" S ARRAY(LN,3)="O"
"RTN","PXRMP24E",18,0)
 ;
"RTN","PXRMP24E",19,0)
 S LN=LN+1
"RTN","PXRMP24E",20,0)
 S ARRAY(LN,1)="VA-MH HIGH RISK NO-SHOW FOLLOW-UP"
"RTN","PXRMP24E",21,0)
 I MODE["I" S ARRAY(LN,2)="12/06/2012@15:23:02"
"RTN","PXRMP24E",22,0)
 I MODE["A" S ARRAY(LN,3)="O"
"RTN","PXRMP24E",23,0)
 ;
"RTN","PXRMP24E",24,0)
 S LN=LN+1
"RTN","PXRMP24E",25,0)
 S ARRAY(LN,1)="VA-MH HIGH RISK NO-SHOW ADHOC RPT"
"RTN","PXRMP24E",26,0)
 I MODE["I" S ARRAY(LN,2)="12/06/2012@15:21:05"
"RTN","PXRMP24E",27,0)
 I MODE["A" S ARRAY(LN,3)="O"
"RTN","PXRMP24E",28,0)
 ;
"RTN","PXRMP24E",29,0)
 S LN=LN+1
"RTN","PXRMP24E",30,0)
 S ARRAY(LN,1)="VA-MHTC NEEDS ASSIGNMENT"
"RTN","PXRMP24E",31,0)
 I MODE["I" S ARRAY(LN,2)="12/06/2012@15:23:54"
"RTN","PXRMP24E",32,0)
 I MODE["A" S ARRAY(LN,3)="O"
"RTN","PXRMP24E",33,0)
 ;
"RTN","PXRMP24E",34,0)
 I MODE="IA" D BMES^XPDUTL("There are "_LN_" Reminder Exchange entries to be installed.")
"RTN","PXRMP24E",35,0)
 Q
"RTN","PXRMP24E",36,0)
 ;
"RTN","PXRMP24I")
0^^B14301202
"RTN","PXRMP24I",1,0)
PXRMP24I ;SLC/PKR - Inits for PXRM*2.0*24. ;10/12/2012
"RTN","PXRMP24I",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 193
"RTN","PXRMP24I",3,0)
 Q
"RTN","PXRMP24I",4,0)
 ;==========================================
"RTN","PXRMP24I",5,0)
CFINC(Y) ;List of computed findings to include in the build.
"RTN","PXRMP24I",6,0)
 N CFLIST,CFNAME,INC
"RTN","PXRMP24I",7,0)
 S CFLIST("VA-ADMISSIONS FOR A DATE RANGE")=""
"RTN","PXRMP24I",8,0)
 S CFLIST("VA-APPOINTMENTS FOR A PATIENT")=""
"RTN","PXRMP24I",9,0)
 S CFLIST("VA-ASU USER CLASS")=""
"RTN","PXRMP24I",10,0)
 S CFLIST("VA-EMPLOYEE")=""
"RTN","PXRMP24I",11,0)
 S CFLIST("VA-PATIENT RECORD FLAG LIST")=""
"RTN","PXRMP24I",12,0)
 S CFLIST("VA-PATIENTS WITH APPOINTMENTS")=""
"RTN","PXRMP24I",13,0)
 S CFLIST("VA-PCMM MHTC")=""
"RTN","PXRMP24I",14,0)
 ;S CFLIST("")=""
"RTN","PXRMP24I",15,0)
 S CFNAME=$P($G(^PXRMD(811.4,Y,0)),U)
"RTN","PXRMP24I",16,0)
 S INC=$S($D(CFLIST(CFNAME)):1,1:0)
"RTN","PXRMP24I",17,0)
 I INC D RMEHIST^PXRMUTIL(811.4,Y)
"RTN","PXRMP24I",18,0)
 Q INC
"RTN","PXRMP24I",19,0)
 ;
"RTN","PXRMP24I",20,0)
 ;==========================================
"RTN","PXRMP24I",21,0)
MPBPRE ;Pre-init for mult-package build.
"RTN","PXRMP24I",22,0)
 S XPDNOQUE=1
"RTN","PXRMP24I",23,0)
 Q
"RTN","PXRMP24I",24,0)
 ;
"RTN","PXRMP24I",25,0)
 ;==========================================
"RTN","PXRMP24I",26,0)
PRE ;Pre-init
"RTN","PXRMP24I",27,0)
 ;Disable options and protocols
"RTN","PXRMP24I",28,0)
 D OPTION^PXRMUTIL("DISABLE")
"RTN","PXRMP24I",29,0)
 D PROTOCOL^PXRMUTIL("DISABLE")
"RTN","PXRMP24I",30,0)
 D DELEXE^PXRMEXSI("EXARRAY","PXRMP24E")
"RTN","PXRMP24I",31,0)
 D REEXCH^PXRMP24I
"RTN","PXRMP24I",32,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH APPTS FOR MHTC ASSIGNMENT","VA-MH KEPT APPTS FOR MHTC ASSIGNMENT")
"RTN","PXRMP24I",33,0)
 Q
"RTN","PXRMP24I",34,0)
 ;
"RTN","PXRMP24I",35,0)
 ;==========================================
"RTN","PXRMP24I",36,0)
POST ;Post-init
"RTN","PXRMP24I",37,0)
 ;Enable options and protocols
"RTN","PXRMP24I",38,0)
 D OPTION^PXRMUTIL("ENABLE")
"RTN","PXRMP24I",39,0)
 D PROTOCOL^PXRMUTIL("ENABLE")
"RTN","PXRMP24I",40,0)
 D SETPVER^PXRMUTIL("2.0P24")
"RTN","PXRMP24I",41,0)
 ;Install Exchange File entries.
"RTN","PXRMP24I",42,0)
 D SMEXINS^PXRMEXSI("EXARRAY","PXRMP24E")
"RTN","PXRMP24I",43,0)
 D RHTF^PXRMP24I
"RTN","PXRMP24I",44,0)
 D SENDIM^PXRMP24I
"RTN","PXRMP24I",45,0)
 Q
"RTN","PXRMP24I",46,0)
 ;
"RTN","PXRMP24I",47,0)
 ;==========================================
"RTN","PXRMP24I",48,0)
REEXCH ;Rename reminder definition VA-MHTC CANDIDATE and remove the old
"RTN","PXRMP24I",49,0)
 ;Exchange entry
"RTN","PXRMP24I",50,0)
 N IEN,LIST,LUVALUE,PXRMINST
"RTN","PXRMP24I",51,0)
 S PXRMINST=1
"RTN","PXRMP24I",52,0)
 D RENAME^PXRMUTIL(811.9,"VA-MHTC CANDIDATE","VA-MHTC NEEDS ASSIGNMENT")
"RTN","PXRMP24I",53,0)
 S LUVALUE(1)="VA-MHTC CANDIDATE"
"RTN","PXRMP24I",54,0)
 S LUVALUE(2)="05/23/2012@09:42:32"
"RTN","PXRMP24I",55,0)
 S IEN=$$FIND1^DIC(811.8,"","KU",.LUVALUE)
"RTN","PXRMP24I",56,0)
 S LIST(IEN)=""
"RTN","PXRMP24I",57,0)
 D DELETE^PXRMEXU1(.LIST)
"RTN","PXRMP24I",58,0)
 Q
"RTN","PXRMP24I",59,0)
 ;
"RTN","PXRMP24I",60,0)
 ;==========================================
"RTN","PXRMP24I",61,0)
RHTF ;Rename and inactivate health factors and terms that are no longer used.
"RTN","PXRMP24I",62,0)
 N IEN,NAME
"RTN","PXRMP24I",63,0)
 D BMES^XPDUTL("Renaming/inactivating health factors and terms that are no longer used.")
"RTN","PXRMP24I",64,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW INITIATE WELLNESS CHECK","ZZMH NOSHOW INITIATE WELLNESS CHECK")
"RTN","PXRMP24I",65,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW SUPPORT CONTACT","ZZMH NOSHOW SUPPORT CONTACT")
"RTN","PXRMP24I",66,0)
 D RENAME^PXRMUTIL(9999999.64,"MH NOSHOW UNABLE TO REACH PT","ZZMH NOSHOW UNABLE TO REACH PT")
"RTN","PXRMP24I",67,0)
 F NAME="ZZMH NOSHOW INITIATE WELLNESS CHECK","ZZMH NOSHOW SUPPORT CONTACT","ZZMH NOSHOW UNABLE TO REACH PT" D
"RTN","PXRMP24I",68,0)
 . S IEN=+$$FIND1^DIC(9999999.64,"","BX",NAME)
"RTN","PXRMP24I",69,0)
 . I IEN>0 S $P(^AUTTHF(IEN,0),U,11)=1
"RTN","PXRMP24I",70,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW INITIATE WELLNESS CHECK","ZZVA-MH NOSHOW INITIATE WELLNESS CHECK")
"RTN","PXRMP24I",71,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW SUPPORT CONTACT","ZZVA-MH NOSHOW SUPPORT CONTACT")
"RTN","PXRMP24I",72,0)
 D RENAME^PXRMUTIL(811.5,"VA-MH NOSHOW UNABLE TO REACH PT","ZZVA-MH NOSHOW UNABLE TO REACH PT")
"RTN","PXRMP24I",73,0)
 Q
"RTN","PXRMP24I",74,0)
 ;
"RTN","PXRMP24I",75,0)
 ;==========================================
"RTN","PXRMP24I",76,0)
SENDIM ;Send install message.
"RTN","PXRMP24I",77,0)
 N FROM,NODE,PARAM,SYSTEM,SUBJECT,TO,VALUE
"RTN","PXRMP24I",78,0)
 S NODE="PXRM*2.0*24"
"RTN","PXRMP24I",79,0)
 K ^TMP(NODE,$J)
"RTN","PXRMP24I",80,0)
 ;DBIA #1131 for ^XMB("NETNAME")
"RTN","PXRMP24I",81,0)
 S FROM="PXRM*2.0*24 Install@"_^XMB("NETNAME")
"RTN","PXRMP24I",82,0)
 ;DBIA #2541
"RTN","PXRMP24I",83,0)
 S SYSTEM=$$KSP^XUPARAM("WHERE")
"RTN","PXRMP24I",84,0)
 I $$PROD^XUPROD(1) S TO("G.CLINICAL REMINDERS SUPPORT@D.DOMAIN.EXT")=""
"RTN","PXRMP24I",85,0)
 E  D
"RTN","PXRMP24I",86,0)
 . N MGIEN,MGROUP
"RTN","PXRMP24I",87,0)
 . S MGIEN=$G(^PXRM(800,1,"MGFE"))
"RTN","PXRMP24I",88,0)
 . S MGROUP=$S(MGIEN'="":"G."_$$GET1^DIQ(3.8,MGIEN,.01),1:DUZ)
"RTN","PXRMP24I",89,0)
 . S TO(MGROUP)=""
"RTN","PXRMP24I",90,0)
 S SUBJECT="Install of PXRM*2.0*24"
"RTN","PXRMP24I",91,0)
 S ^TMP(NODE,$J,1,0)="PXRM*2.0*24 has been installed."
"RTN","PXRMP24I",92,0)
 S ^TMP(NODE,$J,2,0)="System is "_SYSTEM
"RTN","PXRMP24I",93,0)
 D SEND^PXRMMSG(NODE,SUBJECT,.TO,FROM)
"RTN","PXRMP24I",94,0)
 Q
"RTN","PXRMP24I",95,0)
 ;
"RTN","PXRMPCMM")
0^1^B11797305
"RTN","PXRMPCMM",1,0)
PXRMPCMM ;SLC/PKR - Computed findings for PCMM. ;07/01/2012
"RTN","PXRMPCMM",2,0)
 ;;2.0;CLINICAL REMINDERS;**18,24**;Feb 04, 2005;Build 193
"RTN","PXRMPCMM",3,0)
 ;References to SCAPMC supported by DBIA #1916.
"RTN","PXRMPCMM",4,0)
 ;====================================
"RTN","PXRMPCMM",5,0)
INSTPCTM(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM PC TEAM
"RTN","PXRMPCMM",6,0)
 ;INSTITUTION computed finding. Return the institution and team for
"RTN","PXRMPCMM",7,0)
 ;the patient's primary care team as of the evaluation date. 
"RTN","PXRMPCMM",8,0)
 N IND,EFFDATE,RESULT
"RTN","PXRMPCMM",9,0)
 S EFFDATE=$$NOW^PXRMDATE
"RTN","PXRMPCMM",10,0)
 S RESULT=$$INSTPCTM^SCAPMC(DFN,EFFDATE)
"RTN","PXRMPCMM",11,0)
 I RESULT=0 S NFOUND=0 Q
"RTN","PXRMPCMM",12,0)
 S NFOUND=1,DATE(1)=EFFDATE,TEST(1)=1
"RTN","PXRMPCMM",13,0)
 S (DATA(1,"PCMM TEAM"),DATA(1,"VALUE"))=$P(RESULT,U,2)
"RTN","PXRMPCMM",14,0)
 S DATA(1,"INSTITUTION")=$P(RESULT,U,4)
"RTN","PXRMPCMM",15,0)
 S TEXT(1)="Primary care team is "_DATA(1,"PCMM TEAM")_", Institution is "_DATA(1,"INSTITUTION")_"."
"RTN","PXRMPCMM",16,0)
 Q
"RTN","PXRMPCMM",17,0)
 ;
"RTN","PXRMPCMM",18,0)
 ;====================================
"RTN","PXRMPCMM",19,0)
MHTC(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM MHTC computed
"RTN","PXRMPCMM",20,0)
 ;finding. MHTC stands for Mental Health Treatment Coordinator.
"RTN","PXRMPCMM",21,0)
 N RESULT
"RTN","PXRMPCMM",22,0)
 ;DBIA #5697
"RTN","PXRMPCMM",23,0)
 S RESULT=$$START^SCMCMHTC(DFN)
"RTN","PXRMPCMM",24,0)
 I RESULT="" S NFOUND=0 Q
"RTN","PXRMPCMM",25,0)
 ;S NFOUND=1,DATE(1)=$$NOW^PXRMDATE,TEST(1)=1
"RTN","PXRMPCMM",26,0)
 ;The API does not currently take a date.
"RTN","PXRMPCMM",27,0)
 S NFOUND=1,DATE(1)=$$NOW^XLFDT,TEST(1)=1
"RTN","PXRMPCMM",28,0)
 S (DATA(1,"MHTC"),DATA(1,"VALUE"))=$P(RESULT,U,2)
"RTN","PXRMPCMM",29,0)
 S DATA(1,"TEAM POSITION")=$P(RESULT,U,3)
"RTN","PXRMPCMM",30,0)
 S DATA(1,"ROLE")=$P(RESULT,U,4)
"RTN","PXRMPCMM",31,0)
 S DATA(1,"TEAM")=$P(RESULT,U,5)
"RTN","PXRMPCMM",32,0)
 S TEXT(1)="Team Position is "_DATA(1,"TEAM POSITION")_", Role is "_DATA(1,"ROLE")_", Team is "_DATA(1,"TEAM")_"."
"RTN","PXRMPCMM",33,0)
 Q
"RTN","PXRMPCMM",34,0)
 ;
"RTN","PXRMPCMM",35,0)
 ;====================================
"RTN","PXRMPCMM",36,0)
PRPT(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;VA-PCMM PRACTITIONERS
"RTN","PXRMPCMM",37,0)
 ;ASSIGNED TO A PATIENT computed finding. Return a list of
"RTN","PXRMPCMM",38,0)
 ;practitioners assigned to a patient.
"RTN","PXRMPCMM",39,0)
 N DATES,ERR,INCL,IND,LIST,RESULT
"RTN","PXRMPCMM",40,0)
 S INCL=+$P(TEST,U,1)
"RTN","PXRMPCMM",41,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"RTN","PXRMPCMM",42,0)
 S RESULT=$$PRPT^SCAPMC(DFN,"DATES","","","","","LIST","ERR")
"RTN","PXRMPCMM",43,0)
 S NFOUND=+$G(LIST(0))
"RTN","PXRMPCMM",44,0)
 I NFOUND=0 Q
"RTN","PXRMPCMM",45,0)
 F IND=1:1:NFOUND D
"RTN","PXRMPCMM",46,0)
 . S TEST(IND)=1
"RTN","PXRMPCMM",47,0)
 . S DATA(IND,"PROVIDER IEN")=$P(LIST(IND),U,1)
"RTN","PXRMPCMM",48,0)
 . S DATA(IND,"PROVIDER")=$P(LIST(IND),U,2)
"RTN","PXRMPCMM",49,0)
 . S DATA(IND,"POSITION")=$P(LIST(IND),U,4)
"RTN","PXRMPCMM",50,0)
 . S (DATA(IND,"ACTIVATION DATE"),DATE(IND))=$P(LIST(IND),U,9)
"RTN","PXRMPCMM",51,0)
 . S TEXT(IND)="Provider: "_DATA(IND,"PROVIDER")_"; Position: "_DATA(IND,"POSITION")
"RTN","PXRMPCMM",52,0)
 Q
"RTN","PXRMPCMM",53,0)
 ;
"RTN","PXRMPCMM",54,0)
 ;====================================
"RTN","PXRMPCMM",55,0)
PTPR(NGET,BDT,EDT,PLIST,PARAM) ;VA-PCMM PATIENTS ASSIGNED TO A PRACTITIONER.
"RTN","PXRMPCMM",56,0)
 ;List type computed finding that returns a list of patients
"RTN","PXRMPCMM",57,0)
 ;assigned to a list of practitioners within a time period.
"RTN","PXRMPCMM",58,0)
 N DATES,ERR,INCL,IND,JND,LIST,NPAT,NPR,PRAC,PRACLIST,RESULT
"RTN","PXRMPCMM",59,0)
 K ^TMP($J,PLIST)
"RTN","PXRMPCMM",60,0)
 S PRACLIST=$P(PARAM,U,1)
"RTN","PXRMPCMM",61,0)
 S INCL=+$P(PARAM,U,2)
"RTN","PXRMPCMM",62,0)
 S NPR=$L(PRACLIST,";")
"RTN","PXRMPCMM",63,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"RTN","PXRMPCMM",64,0)
 F IND=1:1:NPR D
"RTN","PXRMPCMM",65,0)
 . S PRAC=$P(PRACLIST,";",IND)
"RTN","PXRMPCMM",66,0)
 . S PRAC=$$FIND1^DIC(200,,"ABX",PRAC,,,"MSG")
"RTN","PXRMPCMM",67,0)
 . I PRAC=0 Q
"RTN","PXRMPCMM",68,0)
 . K LIST
"RTN","PXRMPCMM",69,0)
 . S RESULT=$$PTPR^SCAPMC(PRAC,"DATES","","","LIST","ERR","")
"RTN","PXRMPCMM",70,0)
 . S NPAT=+$G(LIST(0)) I NPAT=0 Q
"RTN","PXRMPCMM",71,0)
 . F JND=1:1:NPAT D
"RTN","PXRMPCMM",72,0)
 .. S DFN=$P(LIST(JND),U,1)
"RTN","PXRMPCMM",73,0)
 .. S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(JND),U,4)_U_DFN_U_$P(LIST(JND),U,2)
"RTN","PXRMPCMM",74,0)
 .. S ^TMP($J,PLIST,DFN,1,"VALUE")=DFN
"RTN","PXRMPCMM",75,0)
 Q
"RTN","PXRMPCMM",76,0)
 ;
"RTN","PXRMPCMM",77,0)
 ;====================================
"RTN","PXRMPCMM",78,0)
PTTM(NGET,BDT,EDT,PLIST,PARAM) ;VA-PCMM PATIENTS ASSIGNED TO A TEAM
"RTN","PXRMPCMM",79,0)
 ;List type computed finding that returns a list of patients
"RTN","PXRMPCMM",80,0)
 ;assigned to a team for a time period.
"RTN","PXRMPCMM",81,0)
 N DATES,ERR,INCL,LIST,MSG,RESULT,TEAM
"RTN","PXRMPCMM",82,0)
 S TEAM=$P(PARAM,U,1)
"RTN","PXRMPCMM",83,0)
 S TEAM=$$FIND1^DIC(404.51,,"ABX",TEAM,,,"MSG")
"RTN","PXRMPCMM",84,0)
 I TEAM=0 Q
"RTN","PXRMPCMM",85,0)
 S INCL=+$P(PARAM,U,2)
"RTN","PXRMPCMM",86,0)
 S DATES("BEGIN")=BDT,DATES("END")=EDT,DATES("INCL")=INCL
"RTN","PXRMPCMM",87,0)
 ;Return list in ^TMP.
"RTN","PXRMPCMM",88,0)
 S RESULT=$$PTTM^SCAPMC(TEAM,"DATES","LIST","MSG")
"RTN","PXRMPCMM",89,0)
 K ^TMP($J,PLIST)
"RTN","PXRMPCMM",90,0)
 S IND=0
"RTN","PXRMPCMM",91,0)
 F  S IND=+$O(LIST(IND)) Q:IND=0  D
"RTN","PXRMPCMM",92,0)
 . S DFN=$P(LIST(IND),U,1)
"RTN","PXRMPCMM",93,0)
 . S ^TMP($J,PLIST,DFN,1)=U_$P(LIST(IND),U,4)_U_DFN_U_$P(LIST(IND),U,2)
"RTN","PXRMPCMM",94,0)
 . S ^TMP($J,PLIST,DFN,1,"VALUE")=DFN
"RTN","PXRMPCMM",95,0)
 Q
"RTN","PXRMPCMM",96,0)
 ;
"RTN","PXRMPDEM")
0^28^B65842415
"RTN","PXRMPDEM",1,0)
PXRMPDEM ;SLC/PKR - Computed findings for patient demographics. ;09/27/2012
"RTN","PXRMPDEM",2,0)
 ;;2.0;CLINICAL REMINDERS;**5,4,11,12,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMPDEM",3,0)
 ;
"RTN","PXRMPDEM",4,0)
 ;======================================================
"RTN","PXRMPDEM",5,0)
AGE(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for returning a patient's
"RTN","PXRMPDEM",6,0)
 ;age
"RTN","PXRMPDEM",7,0)
 S DATE=$$NOW^PXRMDATE,TEST=1
"RTN","PXRMPDEM",8,0)
 I $D(PXRMPDEM) D  Q
"RTN","PXRMPDEM",9,0)
 . S VALUE=PXRMPDEM("AGE")
"RTN","PXRMPDEM",10,0)
 . I +PXRMPDEM("DOD")=0 S VALUE("DECEASED")=0 Q
"RTN","PXRMPDEM",11,0)
 . I +PXRMPDEM("DOD")>0 S VALUE("DECEASED")=1,TEXT="Patient is deceased"
"RTN","PXRMPDEM",12,0)
 I '$D(PXRMPDEM) D
"RTN","PXRMPDEM",13,0)
 . N DOB,DOD
"RTN","PXRMPDEM",14,0)
 .;DBIA #10035
"RTN","PXRMPDEM",15,0)
 . S DOB=$P(^DPT(DFN,0),U,3)
"RTN","PXRMPDEM",16,0)
 . S DOD=$P($G(^DPT(DFN,.35)),U,1)
"RTN","PXRMPDEM",17,0)
 . S VALUE=$$AGE^PXRMAGE(DOB,DOD,$$NOW^PXRMDATE)
"RTN","PXRMPDEM",18,0)
 . I +DOD=0 S VALUE("DECEASED")=0 Q
"RTN","PXRMPDEM",19,0)
 . I +DOD>0 S VALUE("DECEASED")=1,TEXT="Patient is deceased"
"RTN","PXRMPDEM",20,0)
 Q
"RTN","PXRMPDEM",21,0)
 ;
"RTN","PXRMPDEM",22,0)
 ;======================================================
"RTN","PXRMPDEM",23,0)
DFA(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;This computed finding
"RTN","PXRMPDEM",24,0)
 ;returns the date the patient turns a specified age. Based on
"RTN","PXRMPDEM",25,0)
 ;work by AJM: 9/16/08.
"RTN","PXRMPDEM",26,0)
 ;DBIA #10035 DATE OF BIRTH is a required field.
"RTN","PXRMPDEM",27,0)
 I TEST="" S NFOUND=0,DATE(1)=$$NOW^PXRMDATE,TEST(1)=0 Q
"RTN","PXRMPDEM",28,0)
 S TEST=$P(TEST,".",1)
"RTN","PXRMPDEM",29,0)
 N BDAY,DOB,YEAR,YOB
"RTN","PXRMPDEM",30,0)
 S NFOUND=1
"RTN","PXRMPDEM",31,0)
 S DOB=$S($D(PXRMDOB):PXRMDOB,1:$P(^DPT(DFN,0),U,3))
"RTN","PXRMPDEM",32,0)
 S YOB=$E(DOB,1,3)
"RTN","PXRMPDEM",33,0)
 S BDAY=$E(DOB,4,7)
"RTN","PXRMPDEM",34,0)
 S YEAR=YOB+TEST
"RTN","PXRMPDEM",35,0)
 I BDAY="0229",'$$ISLEAP^PXRMDATE(YEAR) S BDAY="0228"
"RTN","PXRMPDEM",36,0)
 S (DATE(1),VALUE(1,"VALUE"))=YEAR_BDAY
"RTN","PXRMPDEM",37,0)
 S TEST(1)=1
"RTN","PXRMPDEM",38,0)
 S TEXT(1)="Patient "_$S(DATE(1)>$$NOW^PXRMDATE:"will be ",1:"was ")_+TEST_" years old on "_$$FMTE^XLFDT(DATE(1),"5Z")
"RTN","PXRMPDEM",39,0)
 Q
"RTN","PXRMPDEM",40,0)
 ;
"RTN","PXRMPDEM",41,0)
 ;======================================================
"RTN","PXRMPDEM",42,0)
DOB(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for a patient's
"RTN","PXRMPDEM",43,0)
 ;date of birth.
"RTN","PXRMPDEM",44,0)
 I $D(PXRMPDEM) S VALUE=PXRMPDEM("DOB")
"RTN","PXRMPDEM",45,0)
 ;DBIA #10035 DATE OF BIRTH is a required field.
"RTN","PXRMPDEM",46,0)
 I '$D(PXRMPDEM) S VALUE=$P(^DPT(DFN,0),U,3)
"RTN","PXRMPDEM",47,0)
 S TEST=$S(VALUE<$$NOW^PXRMDATE:1,1:0)
"RTN","PXRMPDEM",48,0)
 I TEST S DATE=VALUE,TEXT=$$EDATE^PXRMDATE(VALUE)
"RTN","PXRMPDEM",49,0)
 Q
"RTN","PXRMPDEM",50,0)
 ;
"RTN","PXRMPDEM",51,0)
 ;======================================================
"RTN","PXRMPDEM",52,0)
DOD(DFN,TEST,DATE,VALUE,TEXT)   ;Computed finding for a patient's
"RTN","PXRMPDEM",53,0)
 ;date of death.
"RTN","PXRMPDEM",54,0)
 I $D(PXRMPDEM) S VALUE=+PXRMPDEM("DOD")
"RTN","PXRMPDEM",55,0)
 ;DBIA #10035
"RTN","PXRMPDEM",56,0)
 I '$D(PXRMPDEM) S VALUE=+$P($G(^DPT(DFN,.35)),U,1)
"RTN","PXRMPDEM",57,0)
 S TEST=$S(VALUE=0:0,VALUE>$$NOW^PXRMDATE:0,1:1)
"RTN","PXRMPDEM",58,0)
 I TEST S DATE=VALUE,TEXT=$$EDATE^PXRMDATE(VALUE)
"RTN","PXRMPDEM",59,0)
 Q
"RTN","PXRMPDEM",60,0)
 ;
"RTN","PXRMPDEM",61,0)
 ;======================================================
"RTN","PXRMPDEM",62,0)
EMPLOYE(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;This computed finding
"RTN","PXRMPDEM",63,0)
 ;will return true if the patient is an employee.
"RTN","PXRMPDEM",64,0)
 ;DBIA #10035, #10060
"RTN","PXRMPDEM",65,0)
 N EDATE,IEN,PAID,SSN,TDATE
"RTN","PXRMPDEM",66,0)
 S NFOUND=0,DATE(1)=$$NOW^PXRMDATE,TEST(1)=0
"RTN","PXRMPDEM",67,0)
 S SSN=$P($G(^DPT(DFN,0)),U,9)
"RTN","PXRMPDEM",68,0)
 I SSN="" Q
"RTN","PXRMPDEM",69,0)
 ;Use SSN to make the link to file #200.
"RTN","PXRMPDEM",70,0)
 S IEN=+$O(^VA(200,"SSN",SSN,""))
"RTN","PXRMPDEM",71,0)
 I IEN=0 Q
"RTN","PXRMPDEM",72,0)
 S PAID=+$P($G(^VA(200,IEN,450)),U,1)
"RTN","PXRMPDEM",73,0)
 I PAID=0 Q
"RTN","PXRMPDEM",74,0)
 ;Get the entered date.
"RTN","PXRMPDEM",75,0)
 S EDATE=+$P(^VA(200,IEN,1),U,7)
"RTN","PXRMPDEM",76,0)
 S VALUE(1,"DATE ENTERED")=EDATE
"RTN","PXRMPDEM",77,0)
 I (EDATE=0)!(EDATE>EDT) Q
"RTN","PXRMPDEM",78,0)
 ;Check for a termination date.
"RTN","PXRMPDEM",79,0)
 S TDATE=+$P(^VA(200,IEN,0),U,11)
"RTN","PXRMPDEM",80,0)
 S VALUE(1,"TERMINATION DATE")=TDATE
"RTN","PXRMPDEM",81,0)
 I (TDATE>0),(TDATE<BDT) Q
"RTN","PXRMPDEM",82,0)
 S NFOUND=1,TEST(1)=1,TEXT(1)="Patient is an employee."
"RTN","PXRMPDEM",83,0)
 Q
"RTN","PXRMPDEM",84,0)
 ;
"RTN","PXRMPDEM",85,0)
 ;======================================================
"RTN","PXRMPDEM",86,0)
ETHNY(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Computed finding for
"RTN","PXRMPDEM",87,0)
 ;a patient's ethnicity.
"RTN","PXRMPDEM",88,0)
 N CNT,CNT1,VADM
"RTN","PXRMPDEM",89,0)
 D DEM^VADPT
"RTN","PXRMPDEM",90,0)
 I $D(VADM(11))'=11 S NFOUND=0 D KVA^VADPT Q
"RTN","PXRMPDEM",91,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMPDEM",92,0)
 S (CNT,CNT1)=0
"RTN","PXRMPDEM",93,0)
 F  S CNT=$O(VADM(11,CNT)) Q:(CNT="")!(CNT1=NGET)  D
"RTN","PXRMPDEM",94,0)
 . S CNT1=CNT1+1,TEST(CNT1)=1,DATE(CNT1)=$$NOW^PXRMDATE
"RTN","PXRMPDEM",95,0)
 . S TEXT(CNT1)="",VALUE(CNT1,"VALUE")=$P($G(VADM(11,CNT)),U,2)
"RTN","PXRMPDEM",96,0)
 S NFOUND=CNT1
"RTN","PXRMPDEM",97,0)
 D KVA^VADPT
"RTN","PXRMPDEM",98,0)
 Q
"RTN","PXRMPDEM",99,0)
 ;
"RTN","PXRMPDEM",100,0)
 ;======================================================
"RTN","PXRMPDEM",101,0)
HDISCH(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Computed finding for
"RTN","PXRMPDEM",102,0)
 ;a list of a patient's discharge dates from PTF.
"RTN","PXRMPDEM",103,0)
 ;References to ^DGPT covered by DBIA #1372.
"RTN","PXRMPDEM",104,0)
 N DAS,DDATE,DDATEL,DONE,FEEBASIS,IEN,IND,INCEN,INFEE,NF,SDIR,TEMP,TYPE
"RTN","PXRMPDEM",105,0)
 S TEMP=$$UP^XLFSTR(TEST)
"RTN","PXRMPDEM",106,0)
 S TEMP=$P(TEMP,"IN:",2)
"RTN","PXRMPDEM",107,0)
 S INFEE=$S(TEMP["FEE":1,1:0)
"RTN","PXRMPDEM",108,0)
 S INCEN=$S(TEMP["CEN":1,1:0)
"RTN","PXRMPDEM",109,0)
 S IEN="",NFOUND=0
"RTN","PXRMPDEM",110,0)
 F  S IEN=$O(^DGPT("B",DFN,IEN)) Q:IEN=""  D
"RTN","PXRMPDEM",111,0)
 . S DDATE=+$P($G(^DGPT(IEN,70)),U,1)
"RTN","PXRMPDEM",112,0)
 . I DDATE>0,DDATE'<BDT,DDATE'>EDT S NFOUND=NFOUND+1,DDATEL(DDATE,NFOUND)=^DGPT(IEN,0)
"RTN","PXRMPDEM",113,0)
 I NFOUND=0 Q
"RTN","PXRMPDEM",114,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMPDEM",115,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMPDEM",116,0)
 S (DONE,NF)=0
"RTN","PXRMPDEM",117,0)
 S DDATE=""
"RTN","PXRMPDEM",118,0)
 F IND=1:1:NFOUND Q:DONE  D
"RTN","PXRMPDEM",119,0)
 . S DDATE=$O(DDATEL(DDATE),SDIR)
"RTN","PXRMPDEM",120,0)
 . I DDATE="" S DONE=1 Q
"RTN","PXRMPDEM",121,0)
 . S IEN=0
"RTN","PXRMPDEM",122,0)
 . F  S IEN=$O(DDATEL(DDATE,IEN)) Q:(IEN="")!(DONE)  D
"RTN","PXRMPDEM",123,0)
 .. S FEEBASIS=$P(DDATEL(DDATE,IEN),U,4)
"RTN","PXRMPDEM",124,0)
 .. I FEEBASIS=1,'INFEE Q
"RTN","PXRMPDEM",125,0)
 ..;Type 1 is PTF, Type 2 is Census
"RTN","PXRMPDEM",126,0)
 .. S TYPE=$P(DDATEL(DDATE,IEN),U,11)
"RTN","PXRMPDEM",127,0)
 .. I TYPE=2,'INCEN Q
"RTN","PXRMPDEM",128,0)
 .. S NF=NF+1
"RTN","PXRMPDEM",129,0)
 .. S TEST(NF)=1,(DATE(NF),VALUE(NF))=DDATE
"RTN","PXRMPDEM",130,0)
 .. I FEEBASIS=1 S TEXT(NF)="Fee basis"
"RTN","PXRMPDEM",131,0)
 .. I TYPE=2 S TEXT(NF)="Census"
"RTN","PXRMPDEM",132,0)
 .. I NF=NGET S DONE=1
"RTN","PXRMPDEM",133,0)
 S NFOUND=NF
"RTN","PXRMPDEM",134,0)
 Q
"RTN","PXRMPDEM",135,0)
 ;
"RTN","PXRMPDEM",136,0)
 ;======================================================
"RTN","PXRMPDEM",137,0)
INP(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Computed finding for
"RTN","PXRMPDEM",138,0)
 ;determining if a patient is an inpatient on the evaluation date.
"RTN","PXRMPDEM",139,0)
 N VAIN,VAINDT
"RTN","PXRMPDEM",140,0)
 S NFOUND=1
"RTN","PXRMPDEM",141,0)
 S (DATE(1),VAINDT)=$$NOW^PXRMDATE
"RTN","PXRMPDEM",142,0)
 D INP^VADPT
"RTN","PXRMPDEM",143,0)
 I VAIN(1)="" S TEST(1)=0 D KVA^VADPT Q
"RTN","PXRMPDEM",144,0)
 S TEST(1)=1
"RTN","PXRMPDEM",145,0)
 S VALUE(1,"PRIMARY PROVIDER")=$P(VAIN(2),U,2)
"RTN","PXRMPDEM",146,0)
 S VALUE(1,"TREATING SPECIALTY")=$P(VAIN(3),U,2)
"RTN","PXRMPDEM",147,0)
 S VALUE(1,"WARD LOCATION")=$P(VAIN(4),U,2)
"RTN","PXRMPDEM",148,0)
 S VALUE(1,"ADMISSION DATE/TIME")=$P(VAIN(7),U,1)
"RTN","PXRMPDEM",149,0)
 S VALUE(1,"ADMISSION TYPE")=$P(VAIN(8),U,2)
"RTN","PXRMPDEM",150,0)
 S VALUE(1,"ATTENDING PHYSICIAN")=$P(VAIN(11),U,2)
"RTN","PXRMPDEM",151,0)
 S TEXT(1)="Patient is an inpatient; admission date/time: "_$$FMTE^XLFDT(VALUE(1,"ADMISSION DATE/TIME"),"5Z")
"RTN","PXRMPDEM",152,0)
 D KVA^VADPT
"RTN","PXRMPDEM",153,0)
 Q
"RTN","PXRMPDEM",154,0)
 ;
"RTN","PXRMPDEM",155,0)
 ;======================================================
"RTN","PXRMPDEM",156,0)
NEWRACE(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Computed finding
"RTN","PXRMPDEM",157,0)
 ;for returning a patient's multi-valued race.
"RTN","PXRMPDEM",158,0)
 N IND,VADM
"RTN","PXRMPDEM",159,0)
 D DEM^VADPT
"RTN","PXRMPDEM",160,0)
 S NFOUND=VADM(12)
"RTN","PXRMPDEM",161,0)
 I NFOUND=0 D KVA^VADPT Q
"RTN","PXRMPDEM",162,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMPDEM",163,0)
 I NFOUND>NGET S NFOUND=NGET
"RTN","PXRMPDEM",164,0)
 F IND=1:1:NFOUND D
"RTN","PXRMPDEM",165,0)
 . S TEST(IND)=1,DATE(IND)=$$NOW^PXRMDATE,TEXT(IND)=""
"RTN","PXRMPDEM",166,0)
 . S (VALUE(IND,"VALUE"),VALUE(IND,"RACE"))=$P(VADM(12,IND),U,2)
"RTN","PXRMPDEM",167,0)
 D KVA^VADPT
"RTN","PXRMPDEM",168,0)
 Q
"RTN","PXRMPDEM",169,0)
 ;
"RTN","PXRMPDEM",170,0)
 ;======================================================
"RTN","PXRMPDEM",171,0)
PATTYPE(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding to return the patient
"RTN","PXRMPDEM",172,0)
 ;type
"RTN","PXRMPDEM",173,0)
 N VAEL
"RTN","PXRMPDEM",174,0)
 S VALUE=""
"RTN","PXRMPDEM",175,0)
 S DATE=$$NOW^PXRMDATE
"RTN","PXRMPDEM",176,0)
 D ELIG^VADPT
"RTN","PXRMPDEM",177,0)
 S TEST=$S($G(VAEL(6))'="":1,1:0)
"RTN","PXRMPDEM",178,0)
 S VALUE=$P(VAEL(6),U,2)
"RTN","PXRMPDEM",179,0)
 D KVA^VADPT
"RTN","PXRMPDEM",180,0)
 Q
"RTN","PXRMPDEM",181,0)
 ;
"RTN","PXRMPDEM",182,0)
 ;======================================================
"RTN","PXRMPDEM",183,0)
RACE(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for checking a patient's race.
"RTN","PXRMPDEM",184,0)
 N RACE
"RTN","PXRMPDEM",185,0)
 S DATE=$$NOW^PXRMDATE
"RTN","PXRMPDEM",186,0)
 ;DBIA #10035
"RTN","PXRMPDEM",187,0)
 S RACE=$P($G(^DPT(DFN,0)),U,6)
"RTN","PXRMPDEM",188,0)
 I RACE="" S TEST=0,VALUE="" Q
"RTN","PXRMPDEM",189,0)
 Q
"RTN","PXRMPDEM",190,0)
 ;
"RTN","PXRMPDEM",191,0)
 ;======================================================
"RTN","PXRMPDEM",192,0)
SEX(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for returning a patient's
"RTN","PXRMPDEM",193,0)
 ;sex.
"RTN","PXRMPDEM",194,0)
 S DATE=$$NOW^PXRMDATE,TEST=1
"RTN","PXRMPDEM",195,0)
 I $D(PXRMPDEM) S VALUE=PXRMPDEM("SEX") Q
"RTN","PXRMPDEM",196,0)
 ;DBIA #10035 SEX is a required field.
"RTN","PXRMPDEM",197,0)
 I '$D(PXRMPDEM) S VALUE=$P(^DPT(DFN,0),U,2)
"RTN","PXRMPDEM",198,0)
 Q
"RTN","PXRMPDEM",199,0)
 ;
"RTN","PXRMPDEM",200,0)
 ;======================================================
"RTN","PXRMPDEM",201,0)
WASINP(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Computed finding for
"RTN","PXRMPDEM",202,0)
 ;determining if a patient was an inpatient in the period defined
"RTN","PXRMPDEM",203,0)
 ;by BDT and EDT.
"RTN","PXRMPDEM",204,0)
 ;Access to DGPM covered by DBIA #1378
"RTN","PXRMPDEM",205,0)
 N ADATE,ADM,ADML,AWARD,DDATE,DWARD,IEN,INDT,FDATE,LOS,NOCC,SDIR,TEMP
"RTN","PXRMPDEM",206,0)
 S FDATE=$S(TEST="DISCH":"DISCH",1:"ADM")
"RTN","PXRMPDEM",207,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMPDEM",208,0)
 S NOCC=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMPDEM",209,0)
 S NFOUND=0
"RTN","PXRMPDEM",210,0)
 ;Use the "ATID3" index to build a last of past admissions and
"RTN","PXRMPDEM",211,0)
 ;discharges.
"RTN","PXRMPDEM",212,0)
 S INDT=""
"RTN","PXRMPDEM",213,0)
 F  S INDT=$O(^DGPM("ATID3",DFN,INDT)) Q:INDT=""  D
"RTN","PXRMPDEM",214,0)
 . S IEN=$O(^DGPM("ATID3",DFN,INDT,""))
"RTN","PXRMPDEM",215,0)
 . S TEMP=^DGPM(IEN,0)
"RTN","PXRMPDEM",216,0)
 . S DDATE=$P(TEMP,U,1)
"RTN","PXRMPDEM",217,0)
 . S ADM=$P(TEMP,U,14)
"RTN","PXRMPDEM",218,0)
 . S ADATE=$P(^DGPM(ADM,0),U,1)
"RTN","PXRMPDEM",219,0)
 . I $$OVERLAP^PXRMINDX(ADATE,DDATE,BDT,EDT)'="O" Q
"RTN","PXRMPDEM",220,0)
 . S AWARD=$$GET1^DIQ(405,ADM,.06),DWARD=$$GET1^DIQ(405,IEN,200)
"RTN","PXRMPDEM",221,0)
 . S ADML(ADATE)=DDATE_U_AWARD_U_DWARD
"RTN","PXRMPDEM",222,0)
 ;Check for the last admission and add it if it is not on the list.
"RTN","PXRMPDEM",223,0)
 S INDT=$O(^DGPM("ATID1",DFN,""))
"RTN","PXRMPDEM",224,0)
 I INDT'="" D
"RTN","PXRMPDEM",225,0)
 . S IEN=$O(^DGPM("ATID1",DFN,INDT,""))
"RTN","PXRMPDEM",226,0)
 . S TEMP=^DGPM(IEN,0)
"RTN","PXRMPDEM",227,0)
 . S ADATE=$P(TEMP,U,1),AWARD=$$GET1^DIQ(405,IEN,.06)
"RTN","PXRMPDEM",228,0)
 . I $D(ADML(ADATE)) Q
"RTN","PXRMPDEM",229,0)
 . S IEN=$P(TEMP,U,17)
"RTN","PXRMPDEM",230,0)
 .;Since this is the last admission there may not be a discharge.
"RTN","PXRMPDEM",231,0)
 . S DDATE=$S(IEN="":$$NOW^PXRMDATE,1:$P(^DGPM(IEN,0),U,1))
"RTN","PXRMPDEM",232,0)
 . I $$OVERLAP^PXRMINDX(ADATE,DDATE,BDT,EDT)="O" D
"RTN","PXRMPDEM",233,0)
 .. S DWARD=$S(IEN="":"",1:$$GET1^DIQ(405,IEN,200))
"RTN","PXRMPDEM",234,0)
 .. S ADML(ADATE)=DDATE_U_AWARD_U_DWARD
"RTN","PXRMPDEM",235,0)
 ;Sort the list.
"RTN","PXRMPDEM",236,0)
 S ADATE=""
"RTN","PXRMPDEM",237,0)
 F  S ADATE=$O(ADML(ADATE),SDIR) Q:(NFOUND=NOCC)!(ADATE="")  D
"RTN","PXRMPDEM",238,0)
 . S NFOUND=NFOUND+1,TEST(NFOUND)=1
"RTN","PXRMPDEM",239,0)
 . S DDATE=$P(ADML(ADATE),U,1),AWARD=$P(ADML(ADATE),U,2),DWARD=$P(ADML(ADATE),U,3)
"RTN","PXRMPDEM",240,0)
 . I DDATE="" S DDATE=PXRMDATE
"RTN","PXRMPDEM",241,0)
 . S DATE(NFOUND)=$S(FDATE="DISCH":DDATE,1:ADATE)
"RTN","PXRMPDEM",242,0)
 . S LOS=$$FMDIFF^XLFDT(DDATE,ADATE)
"RTN","PXRMPDEM",243,0)
 . S TEMP="Inpatient from: "_$$FMTE^XLFDT(ADATE,"5Z")_" to "
"RTN","PXRMPDEM",244,0)
 . S TEMP=TEMP_$S(DDATE=PXRMDATE:"now",1:$$FMTE^XLFDT(DDATE,"5Z"))
"RTN","PXRMPDEM",245,0)
 . S TEMP=TEMP_"; Length of stay "_LOS_" days"
"RTN","PXRMPDEM",246,0)
 . S TEMP=TEMP_"; Admission ward: "_AWARD
"RTN","PXRMPDEM",247,0)
 . I DWARD'="" S TEMP=TEMP_"; Discharge ward: "_DWARD
"RTN","PXRMPDEM",248,0)
 . S TEXT(NFOUND)=TEMP
"RTN","PXRMPDEM",249,0)
 . S VALUE(NFOUND,"ADMISSION DATE")=ADATE
"RTN","PXRMPDEM",250,0)
 . S VALUE(NFOUND,"ADMISSION WARD")=AWARD
"RTN","PXRMPDEM",251,0)
 . S VALUE(NFOUND,"DISCHARGE DATE")=DDATE
"RTN","PXRMPDEM",252,0)
 . S VALUE(NFOUND,"DISCHARGE WARD")=DWARD
"RTN","PXRMPDEM",253,0)
 . S VALUE(NFOUND,"LENGTH OF STAY")=LOS
"RTN","PXRMPDEM",254,0)
 Q
"RTN","PXRMPDEM",255,0)
 ;
"RTN","PXRMPINF")
0^3^B8130614
"RTN","PXRMPINF",1,0)
PXRMPINF ;SLC/PKR - Routines relating to patient information. ;04/17/2012
"RTN","PXRMPINF",2,0)
 ;;2.0;CLINICAL REMINDERS;**12,17,24**;Feb 04, 2005;Build 193
"RTN","PXRMPINF",3,0)
 ;
"RTN","PXRMPINF",4,0)
 ;======================================================
"RTN","PXRMPINF",5,0)
DATACHG ;This entry point is called whenever patient data has changed.
"RTN","PXRMPINF",6,0)
 ;It is attached to the following event points:
"RTN","PXRMPINF",7,0)
 ;PXK VISIT DATA EVENT via PXRM PATIENT DATA CHANGE
"RTN","PXRMPINF",8,0)
 ;
"RTN","PXRMPINF",9,0)
 I '$D(^TMP("PXKCO",$J)) Q
"RTN","PXRMPINF",10,0)
 N EVENT,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","PXRMPINF",11,0)
 S EVENT="PXRM PXK EVENT"_$J_" "_$$NOW^XLFDT
"RTN","PXRMPINF",12,0)
 ;Make sure EVENT is unique.
"RTN","PXRMPINF",13,0)
 I $D(^XTMP(EVENT)) H 1 S EVENT="PXRM PXK EVENT"_$J_" "_$$NOW^XLFDT
"RTN","PXRMPINF",14,0)
 K ^XTMP(EVENT)
"RTN","PXRMPINF",15,0)
 S ^XTMP(EVENT,0)=$$FMADD^XLFDT(DT,3)_U_DT
"RTN","PXRMPINF",16,0)
 M ^XTMP(EVENT)=^TMP("PXKCO",$J)
"RTN","PXRMPINF",17,0)
 L +^XTMP(EVENT):DILOCKTM
"RTN","PXRMPINF",18,0)
 S ZTSAVE("EVENT")=""
"RTN","PXRMPINF",19,0)
 S ZTSAVE("XTMP(")=""
"RTN","PXRMPINF",20,0)
 S ZTRTN="DATACHGR^PXRMPINF"
"RTN","PXRMPINF",21,0)
 S ZTDESC="Clinical Reminders PXK VISIT DATA EVENT handler"
"RTN","PXRMPINF",22,0)
 S ZTDTH=$H
"RTN","PXRMPINF",23,0)
 S ZTIO=""
"RTN","PXRMPINF",24,0)
 D ^%ZTLOAD
"RTN","PXRMPINF",25,0)
 Q
"RTN","PXRMPINF",26,0)
 ;
"RTN","PXRMPINF",27,0)
 ;======================================================
"RTN","PXRMPINF",28,0)
DATACHGR ;Process data from PXK VISIT DATA EVENT
"RTN","PXRMPINF",29,0)
 N DATA,DFN,DGBL,NODE,PXRMDFN,VIEN,VISIT,VF,VFL,VGBL
"RTN","PXRMPINF",30,0)
 S ZTREQ="@"
"RTN","PXRMPINF",31,0)
 ;Look for PXK VISIT DATA EVENT data.
"RTN","PXRMPINF",32,0)
 S VISIT=$O(^XTMP(EVENT,0))
"RTN","PXRMPINF",33,0)
 S VIEN=$O(^XTMP(EVENT,VISIT,"VST",""))
"RTN","PXRMPINF",34,0)
 S NODE=$O(^XTMP(EVENT,VISIT,"VST",VIEN,""))
"RTN","PXRMPINF",35,0)
 S DATA=$G(^XTMP(EVENT,VISIT,"VST",VIEN,NODE,"AFTER"))
"RTN","PXRMPINF",36,0)
 I DATA="" S DATA=$G(^XTMP(EVENT,VISIT,"VST",VIEN,NODE,"BEFORE"))
"RTN","PXRMPINF",37,0)
 S DFN=$P(DATA,U,5)
"RTN","PXRMPINF",38,0)
 ;Build the list of V Files.
"RTN","PXRMPINF",39,0)
 S VF=""
"RTN","PXRMPINF",40,0)
 F  S VF=$O(^XTMP(EVENT,VISIT,VF)) Q:VF=""  D
"RTN","PXRMPINF",41,0)
 . S DGBL=$S(VF="CPT":"PXD(811.2,",VF="HF":"AUTTHF(",VF="IMM":"AUTTIMM(",VF="PED":"AUTTEDT(",VF="POV":"PXD(811.2,",VF="SK":"AUTTSK(",VF="XAM":"AUTTEXAM(",1:"")
"RTN","PXRMPINF",42,0)
 . S VGBL=$S(VF="CPT":"AUPNVCPT(",VF="HF":"AUPNVHF(",VF="IMM":"AUPNVIMM(",VF="PED":"AUPNVPED(",VF="POV":"AUPNVPOV(",VF="SK":"AUPNVSK(",VF="XAM":"AUPNVXAM(",1:"")
"RTN","PXRMPINF",43,0)
 . S VFL(VF)=DGBL_U_VGBL
"RTN","PXRMPINF",44,0)
 ;Call the routines that need to process the data.
"RTN","PXRMPINF",45,0)
 D UPDPAT^PXRMMST(EVENT,DFN,VISIT,.VFL)
"RTN","PXRMPINF",46,0)
 D SUICIDE^PXRMNTFY(EVENT,DFN,VISIT)
"RTN","PXRMPINF",47,0)
 L -^XTMP(EVENT)
"RTN","PXRMPINF",48,0)
 K ^XTMP(EVENT)
"RTN","PXRMPINF",49,0)
 Q
"RTN","PXRMPINF",50,0)
 ;
"RTN","PXRMPINF",51,0)
 ;======================================================
"RTN","PXRMPINF",52,0)
DEM(DFN,TODAY,DEMARR) ;Load the patient demographics into DEMARR
"RTN","PXRMPINF",53,0)
 ;The patient's age is calculated using whatever date is passed as
"RTN","PXRMPINF",54,0)
 ;TODAY. If there is a date of death and it is greater than TODAY
"RTN","PXRMPINF",55,0)
 ;then set the date of death to null. Direct read of patient file
"RTN","PXRMPINF",56,0)
 ;supported DBIA #10035. DATE OF BIRTH and SEX are required fields
"RTN","PXRMPINF",57,0)
 ;in the patient file.
"RTN","PXRMPINF",58,0)
 N TEMP
"RTN","PXRMPINF",59,0)
 K DEMARR
"RTN","PXRMPINF",60,0)
 I $L(DFN)'>0 S DEMARR("PATIENT")="" Q
"RTN","PXRMPINF",61,0)
 S TEMP=$G(^DPT(DFN,0))
"RTN","PXRMPINF",62,0)
 I TEMP="" S DEMARR("PATIENT")="" Q
"RTN","PXRMPINF",63,0)
 S DEMARR("PATIENT")=$P(TEMP,U,1)
"RTN","PXRMPINF",64,0)
 S DEMARR("SEX")=$P(TEMP,U,2)
"RTN","PXRMPINF",65,0)
 S DEMARR("DOB")=$P(TEMP,U,3)
"RTN","PXRMPINF",66,0)
 S DEMARR("SSN")=$P(TEMP,U,9)
"RTN","PXRMPINF",67,0)
 S DEMARR("DOD")=$P($G(^DPT(DFN,.35)),U,1)
"RTN","PXRMPINF",68,0)
 I DEMARR("DOD")>TODAY S DEMARR("DOD")=""
"RTN","PXRMPINF",69,0)
 S DEMARR("DFN")=DFN
"RTN","PXRMPINF",70,0)
 S DEMARR("AGE")=$$AGE^PXRMAGE(DEMARR("DOB"),DEMARR("DOD"),TODAY)
"RTN","PXRMPINF",71,0)
 ;DBIA #1096
"RTN","PXRMPINF",72,0)
 S TEMP=$O(^DGPM("ATID1",DFN,""))
"RTN","PXRMPINF",73,0)
 I TEMP'="" S TEMP=9999999.999999-TEMP
"RTN","PXRMPINF",74,0)
 S DEMARR("LAD")=TEMP
"RTN","PXRMPINF",75,0)
 Q
"RTN","PXRMPINF",76,0)
 ;
"RTN","PXRMRDI")
0^11^B38535019
"RTN","PXRMRDI",1,0)
PXRMRDI ;SLC/PKR - Routines to support RDI list building. ;04/25/2012
"RTN","PXRMRDI",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMRDI",3,0)
 ;=========================================================
"RTN","PXRMRDI",4,0)
APPERR(TYPE) ;Handle errors getting appointment data.
"RTN","PXRMRDI",5,0)
 N ECODE,MGIEN,MGROUP,NL,TIME,TO,USER
"RTN","PXRMRDI",6,0)
 S USER=$S($D(ZTQUEUED):DBDUZ,1:DUZ)
"RTN","PXRMRDI",7,0)
 S TIME=$$NOW^XLFDT
"RTN","PXRMRDI",8,0)
 S TIME=$$FMTE^XLFDT(TIME)
"RTN","PXRMRDI",9,0)
 K ^TMP("PXRMXMZ",$J)
"RTN","PXRMRDI",10,0)
 S ^TMP("PXRMXMZ",$J,1,0)="The "_TYPE_" requested by "_$$GET1^DIQ(200,USER,.01)_" on "
"RTN","PXRMRDI",11,0)
 S ^TMP("PXRMXMZ",$J,2,0)=TIME_" requires appointment data which could not be obtained"
"RTN","PXRMRDI",12,0)
 S ^TMP("PXRMXMZ",$J,3,0)="from the Scheduling database due to the following error(s):"
"RTN","PXRMRDI",13,0)
 S ECODE=0,NL=3
"RTN","PXRMRDI",14,0)
 F  S ECODE=$O(^TMP($J,"SDAMA301",ECODE)) Q:ECODE=""  D
"RTN","PXRMRDI",15,0)
 . S NL=NL+1,^TMP("PXRMXMZ",$J,NL,0)=" "_^TMP($J,"SDAMA301",ECODE)
"RTN","PXRMRDI",16,0)
 S TO(DUZ)=""
"RTN","PXRMRDI",17,0)
 S MGIEN=$G(^PXRM(800,1,"MGFE"))
"RTN","PXRMRDI",18,0)
 I MGIEN'="" D
"RTN","PXRMRDI",19,0)
 . S MGROUP="G."_$$GET1^DIQ(3.8,MGIEN,.01)
"RTN","PXRMRDI",20,0)
 . S TO(MGROUP)=""
"RTN","PXRMRDI",21,0)
 D SEND^PXRMMSG("PXRMXMZ","Scheduling database error(s)",.TO,DUZ)
"RTN","PXRMRDI",22,0)
 K ^TMP($J,"SDAMA301")
"RTN","PXRMRDI",23,0)
 Q
"RTN","PXRMRDI",24,0)
 ;
"RTN","PXRMRDI",25,0)
 ;=========================================================
"RTN","PXRMRDI",26,0)
APPL(NGET,BDT,EDT,PLIST,PARAM) ;List type computed finding that returns
"RTN","PXRMRDI",27,0)
 ;a list of patients with appointments in the date range BDT to EDT.
"RTN","PXRMRDI",28,0)
 N FILTER,FLDS,RESULT
"RTN","PXRMRDI",29,0)
 K ^TMP($J,PLIST),^TMP($J,"SDAMA301")
"RTN","PXRMRDI",30,0)
 I BDT<2000000 S BDT=2000101
"RTN","PXRMRDI",31,0)
 S FILTER(1)=BDT_";"_EDT
"RTN","PXRMRDI",32,0)
 S FILTER("SORT")="P"
"RTN","PXRMRDI",33,0)
 ;Set the rest of the filter nodes.
"RTN","PXRMRDI",34,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"RTN","PXRMRDI",35,0)
 ;DBIA #4433
"RTN","PXRMRDI",36,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"RTN","PXRMRDI",37,0)
 I RESULT=-1 D APPERR("Patient List build") Q
"RTN","PXRMRDI",38,0)
 N COUNT,DATE,DFN,DONE,ITEM
"RTN","PXRMRDI",39,0)
 S DFN=""
"RTN","PXRMRDI",40,0)
 F  S DFN=$O(^TMP($J,"SDAMA301",DFN)) Q:DFN=""  D
"RTN","PXRMRDI",41,0)
 . S (COUNT,DONE)=0,DATE=""
"RTN","PXRMRDI",42,0)
 . F  S DATE=$O(^TMP($J,"SDAMA301",DFN,DATE),-1) Q:(DONE)!(DATE="")  D
"RTN","PXRMRDI",43,0)
 .. S COUNT=COUNT+1
"RTN","PXRMRDI",44,0)
 .. S ITEM=$P(^TMP($J,"SDAMA301",DFN,DATE),U,2)
"RTN","PXRMRDI",45,0)
 .. S ^TMP($J,PLIST,DFN,COUNT)=U_DATE_U_44_U_$P(ITEM,";",1)_U_$P(ITEM,";",2)
"RTN","PXRMRDI",46,0)
 .. I COUNT=NGET S DONE=1
"RTN","PXRMRDI",47,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"RTN","PXRMRDI",48,0)
 Q
"RTN","PXRMRDI",49,0)
 ;
"RTN","PXRMRDI",50,0)
 ;=========================================================
"RTN","PXRMRDI",51,0)
FSTATUS(STATUS) ;Format the STATUS, field #22.
"RTN","PXRMRDI",52,0)
 N TEXT,TMP
"RTN","PXRMRDI",53,0)
 S TMP=$P(STATUS,";",1)
"RTN","PXRMRDI",54,0)
 S TEXT=$S(TMP="":"",1:"Code - "_TMP)
"RTN","PXRMRDI",55,0)
 S TMP=$P(STATUS,";",2)
"RTN","PXRMRDI",56,0)
 I TMP'="" S TEXT=TEXT_"; Description - "_TMP
"RTN","PXRMRDI",57,0)
 S TMP=$P(STATUS,";",3)
"RTN","PXRMRDI",58,0)
 I TMP'="" S TEXT=TEXT_"; Print Status - "_TMP
"RTN","PXRMRDI",59,0)
 S TMP=$P(STATUS,";",4)
"RTN","PXRMRDI",60,0)
 I TMP'="" S TEXT=TEXT_"; Checked In Date/Time - "_$$EDATE^PXRMDATE(TMP)
"RTN","PXRMRDI",61,0)
 S TMP=$P(STATUS,";",5)
"RTN","PXRMRDI",62,0)
 I TMP'="" S TEXT=TEXT_"; Checked Out Date/Time - "_$$EDATE^PXRMDATE(TMP)
"RTN","PXRMRDI",63,0)
 S TMP=$P(STATUS,";",6)
"RTN","PXRMRDI",64,0)
 I TMP'="" S TEXT=TEXT_"; Admission Movement IFN - "_TMP
"RTN","PXRMRDI",65,0)
 Q TEXT
"RTN","PXRMRDI",66,0)
 ;
"RTN","PXRMRDI",67,0)
 ;=========================================================
"RTN","PXRMRDI",68,0)
PAPPL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,DATA,TEXT) ;Multiple type computed
"RTN","PXRMRDI",69,0)
 ;finding that returns a list appointments for a patient.
"RTN","PXRMRDI",70,0)
 N FIELD,FILTER,FLDS,PARAM,RESULT
"RTN","PXRMRDI",71,0)
 K ^TMP($J,"SDAMA301")
"RTN","PXRMRDI",72,0)
 S PARAM=TEST K TEST
"RTN","PXRMRDI",73,0)
 S NFOUND=0
"RTN","PXRMRDI",74,0)
 I BDT<2000000 S BDT=2000101
"RTN","PXRMRDI",75,0)
 S FILTER(1)=BDT_";"_EDT
"RTN","PXRMRDI",76,0)
 S FILTER(4)=DFN
"RTN","PXRMRDI",77,0)
 S FILTER("SORT")="P"
"RTN","PXRMRDI",78,0)
 ;Set the rest of the filter nodes.
"RTN","PXRMRDI",79,0)
 D SFILTER(PARAM,.FILTER,.FLDS)
"RTN","PXRMRDI",80,0)
 ;DBIA #4433
"RTN","PXRMRDI",81,0)
 S RESULT=$$SDAPI^SDAMA301(.FILTER)
"RTN","PXRMRDI",82,0)
 I RESULT=-1 D APPERR("Computed finding evaluation") Q
"RTN","PXRMRDI",83,0)
 N ALLNULL,APPDATE,DATALIST,DONE,FLABEL,IND,ITEM,STATUS,TMP
"RTN","PXRMRDI",84,0)
 S FLABEL(1)="APPOINTMENT DATE/TIME"
"RTN","PXRMRDI",85,0)
 S FLABEL(2)="CLINIC"
"RTN","PXRMRDI",86,0)
 S FLABEL(3)="APPOINTMENT STATUS"
"RTN","PXRMRDI",87,0)
 S FLABEL(4)="PATIENT"
"RTN","PXRMRDI",88,0)
 S FLABEL(5)="LENGTH OF APPOINTMENT"
"RTN","PXRMRDI",89,0)
 S FLABEL(6)="COMMENTS"
"RTN","PXRMRDI",90,0)
 S FLABEL(7)="OVERBOOK"
"RTN","PXRMRDI",91,0)
 S FLABEL(8)="ELIGIBILITY OF VISIT"
"RTN","PXRMRDI",92,0)
 S FLABEL(9)="CHECK-IN DATE/TIME"
"RTN","PXRMRDI",93,0)
 S FLABEL(10)="APPOINTMENT TYPE"
"RTN","PXRMRDI",94,0)
 S FLABEL(11)="CHECK-OUT DATE/TIME"
"RTN","PXRMRDI",95,0)
 S FLABEL(12)="OUTPATIENT ENCOUNTER IEN"
"RTN","PXRMRDI",96,0)
 S FLABEL(13)="PRIMARY STOP CODE"
"RTN","PXRMRDI",97,0)
 S FLABEL(14)="CREDIT STOP CODE"
"RTN","PXRMRDI",98,0)
 S FLABEL(15)="WORKLOAD NON-COUNT"
"RTN","PXRMRDI",99,0)
 S FLABEL(16)="DATE APPOINTMENT MADE"
"RTN","PXRMRDI",100,0)
 S FLABEL(17)="DESIRED DATE OF APPOINTMENT"
"RTN","PXRMRDI",101,0)
 S FLABEL(18)="PURPOSE OF VISIT and SHORT DESCRIPTION"
"RTN","PXRMRDI",102,0)
 S FLABEL(19)="EKG DATE/TIME"
"RTN","PXRMRDI",103,0)
 S FLABEL(20)="X-RAY DATE/TIME"
"RTN","PXRMRDI",104,0)
 S FLABEL(21)="LAB DATE/TIME"
"RTN","PXRMRDI",105,0)
 S FLABEL(22)="STATUS"
"RTN","PXRMRDI",106,0)
 S FLABEL(23)="X-RAY FILMS"
"RTN","PXRMRDI",107,0)
 S FLABEL(24)="AUTO-REBOOKED APPOINTMENT DATE/TIME"
"RTN","PXRMRDI",108,0)
 S FLABEL(25)="NO-SHOW/CANCEL DATE/TIME"
"RTN","PXRMRDI",109,0)
 S FLABEL(26)="RSA APPOINTMENT ID"
"RTN","PXRMRDI",110,0)
 S FLABEL(28)="DATA ENTRY CLERK"
"RTN","PXRMRDI",111,0)
 S FLABEL(29)="NO-SHOW/CANCELED BY"
"RTN","PXRMRDI",112,0)
 S FLABEL(30)="CHECK-IN USER"
"RTN","PXRMRDI",113,0)
 S FLABEL(31)="CHECK-OUT USER"
"RTN","PXRMRDI",114,0)
 S FLABEL(32)="CANCELLATION REASON"
"RTN","PXRMRDI",115,0)
 S FLABEL(33)="CONSULT LINK"
"RTN","PXRMRDI",116,0)
 S SDIR=$S(NGET<0:1,1:-1)
"RTN","PXRMRDI",117,0)
 S NGET=$S(NGET<0:-NGET,1:NGET)
"RTN","PXRMRDI",118,0)
 S APPDATE="",DONE=0
"RTN","PXRMRDI",119,0)
 F  S APPDATE=$O(^TMP($J,"SDAMA301",DFN,APPDATE),SDIR) Q:(DONE)!(APPDATE="")  D
"RTN","PXRMRDI",120,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMRDI",121,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=APPDATE
"RTN","PXRMRDI",122,0)
 .;Fields 1-26
"RTN","PXRMRDI",123,0)
 . S DATALIST=$G(^TMP($J,"SDAMA301",DFN,APPDATE))
"RTN","PXRMRDI",124,0)
 .;Fields 28-33
"RTN","PXRMRDI",125,0)
 . S TMP=$G(^TMP($J,"SDAMA301",DFN,APPDATE,0))
"RTN","PXRMRDI",126,0)
 . S ALLNULL=1
"RTN","PXRMRDI",127,0)
 . I TMP'="" F IND=1:1:$L(TMP,U) I $P(TMP,U,IND)'="" S ALLNULL=0
"RTN","PXRMRDI",128,0)
 . I 'ALLNULL S $P(DATALIST,U,28)=TMP
"RTN","PXRMRDI",129,0)
 . F IND=1:1:$L(DATALIST,U) D
"RTN","PXRMRDI",130,0)
 .. S FIELD=$P(DATALIST,U,IND)
"RTN","PXRMRDI",131,0)
 .. I IND=6 S FIELD=$G(^TMP($J,"SDAMA301",DFN,APPDATE,"C"))
"RTN","PXRMRDI",132,0)
 .. I FIELD="" Q
"RTN","PXRMRDI",133,0)
 .. I IND=22 S STATUS=FIELD
"RTN","PXRMRDI",134,0)
 .. I FLABEL(IND)["DATE" S FIELD=$$EDATE^PXRMDATE(FIELD)
"RTN","PXRMRDI",135,0)
 .. I FIELD[";" S FIELD=$P(FIELD,";",2)
"RTN","PXRMRDI",136,0)
 ..;Save the clinic as the value.
"RTN","PXRMRDI",137,0)
 .. I IND=2 S DATA(NFOUND,"VALUE")=FIELD
"RTN","PXRMRDI",138,0)
 .. I IND=22 S FIELD=$$FSTATUS(STATUS)
"RTN","PXRMRDI",139,0)
 .. S TEXT(NFOUND,IND)=FLABEL(IND)_": "_FIELD
"RTN","PXRMRDI",140,0)
 .. S DATA(NFOUND,FLABEL(IND))=FIELD
"RTN","PXRMRDI",141,0)
 . I NFOUND=NGET S DONE=1
"RTN","PXRMRDI",142,0)
 K ^TMP($J,"SDAMA301"),^TMP($J,"HLOCL")
"RTN","PXRMRDI",143,0)
 Q
"RTN","PXRMRDI",144,0)
 ;
"RTN","PXRMRDI",145,0)
 ;=========================================================
"RTN","PXRMRDI",146,0)
SFILTER(PARAM,FILTER,FLDS) ;Parse the PARMETER and set the appropriate
"RTN","PXRMRDI",147,0)
 ;fields.
"RTN","PXRMRDI",148,0)
 N IND,LL,P1,P2,STATUS,TEMP
"RTN","PXRMRDI",149,0)
 S (FLDS,LL,STATUS)=""
"RTN","PXRMRDI",150,0)
 F IND=1:1:$L(PARAM,U) D
"RTN","PXRMRDI",151,0)
 . S TEMP=$P(PARAM,U,IND)
"RTN","PXRMRDI",152,0)
 . S P1=$P(TEMP,":",1),P2=$P(TEMP,":",2)
"RTN","PXRMRDI",153,0)
 . I P1="FLDS" S FLDS=$TR(P2,",",";") Q
"RTN","PXRMRDI",154,0)
 . I P1="LL" S LL=P2 Q
"RTN","PXRMRDI",155,0)
 . I P1="STATUS" S STATUS=$TR(P2,",",";") Q
"RTN","PXRMRDI",156,0)
 S FILTER("FLDS")=$S(FLDS="":"1;2",1:FLDS)
"RTN","PXRMRDI",157,0)
 S FILTER(3)=$S(STATUS="":"I;R",1:STATUS)
"RTN","PXRMRDI",158,0)
 I LL="" Q
"RTN","PXRMRDI",159,0)
 S LL=$O(^PXRMD(810.9,"B",LL,""))
"RTN","PXRMRDI",160,0)
 I LL="" S ^TMP(PXRMPID,$J,PXRMITEM,"FERROR","NO LL")="Location List "_P2_" does not exist."
"RTN","PXRMRDI",161,0)
 D LOCLIST^PXRMLOCF(LL,"HLOCL")
"RTN","PXRMRDI",162,0)
 I $D(^TMP($J,"HLOCL")) S FILTER(2)="^TMP($J,""HLOCL"","
"RTN","PXRMRDI",163,0)
 Q
"RTN","PXRMRDI",164,0)
 ;
"RTN","PXRMRDI",165,0)
 ;=========================================================
"RTN","PXRMRDI",166,0)
TFL(DFN,NGET,BDT,EDT,NFOUND,TEST,DATE,VALUE,TEXT) ;Multiple type computed
"RTN","PXRMRDI",167,0)
 ;finding for a patient's treating facility list.
"RTN","PXRMRDI",168,0)
 N DONE,IND,NOW,SDIR,TDATE,TFL,TFLD
"RTN","PXRMRDI",169,0)
 S NFOUND=0
"RTN","PXRMRDI",170,0)
 ;DBIA #2990
"RTN","PXRMRDI",171,0)
 D TFL^VAFCTFU1(.TFL,DFN)
"RTN","PXRMRDI",172,0)
 I +TFL(1)=-1 Q
"RTN","PXRMRDI",173,0)
 S NOW=$$NOW^PXRMDATE
"RTN","PXRMRDI",174,0)
 S (DONE,IND)=0
"RTN","PXRMRDI",175,0)
 F  S IND=$O(TFL(IND)) Q:(DONE)!(IND="")  D
"RTN","PXRMRDI",176,0)
 . S NFOUND=NFOUND+1
"RTN","PXRMRDI",177,0)
 . S TEST(NFOUND)=1,DATE(NFOUND)=NOW
"RTN","PXRMRDI",178,0)
 . S VALUE(NFOUND,"VALUE")=TFL(IND)
"RTN","PXRMRDI",179,0)
 . I NFOUND=NGET S DONE=1 Q
"RTN","PXRMRDI",180,0)
 F IND=1:1:NFOUND S VALUE(IND,"NUM FACILITIES")=NFOUND
"RTN","PXRMRDI",181,0)
 Q
"RTN","PXRMRDI",182,0)
 ;
"RTN","PXRMSCR")
0^29^B88295
"RTN","PXRMSCR",1,0)
PXRMSCR ;SLC/PKR - Screens for Clinical Reminders. ;10/05/2012
"RTN","PXRMSCR",2,0)
 ;;2.0;CLINICAL REMINDERS;**24**;Feb 04, 2005;Build 193
"RTN","PXRMSCR",3,0)
 ;============================================
"RTN","PXRMSCR",4,0)
WHFSCR(NODE,PIECE) ;Whole file screen based on Class.
"RTN","PXRMSCR",5,0)
 I $G(PXRMNSCR)=1 Q 1
"RTN","PXRMSCR",6,0)
 ;Do not allow selection of entries whose Class is National.
"RTN","PXRMSCR",7,0)
 I $P($G(^(NODE)),U,PIECE)="N" Q 0
"RTN","PXRMSCR",8,0)
 Q 1
"RTN","PXRMSCR",9,0)
 ;
"RTN","PXRMTAX")
0^19^B65791721
"RTN","PXRMTAX",1,0)
PXRMTAX ;SLC/PKR - Handle taxonomy finding. ;09/13/2012
"RTN","PXRMTAX",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,12,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMTAX",3,0)
 ;
"RTN","PXRMTAX",4,0)
 ;==================================================
"RTN","PXRMTAX",5,0)
EVALFI(DFN,DEFARR,ENODE,FIEVAL) ;Evaluate taxonomy findings.
"RTN","PXRMTAX",6,0)
 N FIEVT,FINDPA,FINDING
"RTN","PXRMTAX",7,0)
 N TAXIEN
"RTN","PXRMTAX",8,0)
 S TAXIEN=""
"RTN","PXRMTAX",9,0)
 F  S TAXIEN=$O(DEFARR("E",ENODE,TAXIEN)) Q:+TAXIEN=0  D
"RTN","PXRMTAX",10,0)
 . S FINDING=""
"RTN","PXRMTAX",11,0)
 . F  S FINDING=$O(DEFARR("E",ENODE,TAXIEN,FINDING)) Q:+FINDING=0  D
"RTN","PXRMTAX",12,0)
 .. K FINDPA
"RTN","PXRMTAX",13,0)
 .. M FINDPA=DEFARR(20,FINDING)
"RTN","PXRMTAX",14,0)
 .. K FIEVT
"RTN","PXRMTAX",15,0)
 .. D FIEVAL(DFN,TAXIEN,.FINDPA,.FIEVT)
"RTN","PXRMTAX",16,0)
 .. M FIEVAL(FINDING)=FIEVT
"RTN","PXRMTAX",17,0)
 Q
"RTN","PXRMTAX",18,0)
 ;
"RTN","PXRMTAX",19,0)
 ;==================================================
"RTN","PXRMTAX",20,0)
EVALPL(FINDPA,ENODE,TERMARR,PLIST) ;Evaluate taxonomy terms for
"RTN","PXRMTAX",21,0)
 ;building patient lists.
"RTN","PXRMTAX",22,0)
 N PFIND3,PFIND4,PFINDPA,TAXIEN
"RTN","PXRMTAX",23,0)
 N TFINDPA,TFINDING
"RTN","PXRMTAX",24,0)
 S TAXIEN=""
"RTN","PXRMTAX",25,0)
 F  S TAXIEN=$O(TERMARR("E",ENODE,TAXIEN)) Q:+TAXIEN=0  D
"RTN","PXRMTAX",26,0)
 . S TFINDING=""
"RTN","PXRMTAX",27,0)
 . F  S TFINDING=$O(TERMARR("E",ENODE,TAXIEN,TFINDING)) Q:+TFINDING=0  D
"RTN","PXRMTAX",28,0)
 .. K PFINDPA,TFINDPA
"RTN","PXRMTAX",29,0)
 .. M TFINDPA=TERMARR(20,TFINDING)
"RTN","PXRMTAX",30,0)
 ..;Set the finding parameters.
"RTN","PXRMTAX",31,0)
 .. D SPFINDPA^PXRMTERM(.FINDPA,.TFINDPA,.PFINDPA)
"RTN","PXRMTAX",32,0)
 .. D GPLIST(TAXIEN,.PFINDPA,PLIST)
"RTN","PXRMTAX",33,0)
 Q
"RTN","PXRMTAX",34,0)
 ;
"RTN","PXRMTAX",35,0)
 ;==================================================
"RTN","PXRMTAX",36,0)
EVALTERM(DFN,FINDPA,ENODE,TERMARR,TFIEVAL) ;Evaluate taxonomy
"RTN","PXRMTAX",37,0)
 ;terms.
"RTN","PXRMTAX",38,0)
 N FIEVT,PFINDPA
"RTN","PXRMTAX",39,0)
 N TAXIEN,TFINDPA,TFINDING
"RTN","PXRMTAX",40,0)
 S TAXIEN=""
"RTN","PXRMTAX",41,0)
 F  S TAXIEN=$O(TERMARR("E",ENODE,TAXIEN)) Q:+TAXIEN=0  D
"RTN","PXRMTAX",42,0)
 . S TFINDING=""
"RTN","PXRMTAX",43,0)
 . F  S TFINDING=$O(TERMARR("E",ENODE,TAXIEN,TFINDING)) Q:+TFINDING=0  D
"RTN","PXRMTAX",44,0)
 .. K FIEVT,PFINDPA,TFINDPA
"RTN","PXRMTAX",45,0)
 .. M TFINDPA=TERMARR(20,TFINDING)
"RTN","PXRMTAX",46,0)
 ..;Set the finding parameters.
"RTN","PXRMTAX",47,0)
 .. D SPFINDPA^PXRMTERM(.FINDPA,.TFINDPA,.PFINDPA)
"RTN","PXRMTAX",48,0)
 .. D FIEVAL(DFN,TAXIEN,.PFINDPA,.FIEVT)
"RTN","PXRMTAX",49,0)
 .. M TFIEVAL(TFINDING)=FIEVT
"RTN","PXRMTAX",50,0)
 Q
"RTN","PXRMTAX",51,0)
 ;
"RTN","PXRMTAX",52,0)
 ;==================================================
"RTN","PXRMTAX",53,0)
FIEVAL(DFN,TAXIEN,FINDPA,FIEVAL) ;
"RTN","PXRMTAX",54,0)
 N BDT,CASESEN,CFILE,CODE,CODEP,COND,CONVAL,DAS,DATE,EDT,ENS
"RTN","PXRMTAX",55,0)
 N FIEVT,FILENUM,FLIST,ICOND,IND,INS,INVFD
"RTN","PXRMTAX",56,0)
 N NFOUND,NGET,NICD0,NICD9,NCPT,NOCC,NP,NRCPT,PLS
"RTN","PXRMTAX",57,0)
 N RAS,SAVE,SDIR,STATUSA,TAXARR,TLIST,UCIFS,USEINP,VSLIST
"RTN","PXRMTAX",58,0)
 ;Set the finding search parameters.
"RTN","PXRMTAX",59,0)
 D SSPAR^PXRMUTIL(FINDPA(0),.NOCC,.BDT,.EDT)
"RTN","PXRMTAX",60,0)
 I $G(PXRMDEBG) S FIEVAL("BDTE")=BDT,FIEVAL("EDTE")=EDT
"RTN","PXRMTAX",61,0)
 S INVFD=$P(FINDPA(0),U,16)
"RTN","PXRMTAX",62,0)
 D TAX^PXRMLDR(TAXIEN,.TAXARR)
"RTN","PXRMTAX",63,0)
 I TAXARR(0)["NO LOCK" S FIEVAL=0 Q
"RTN","PXRMTAX",64,0)
 D SETVAR^PXRMTAXS(.TAXARR,.ENS,.INS,.NICD0,.NICD9,.NCPT,.NRCPT,.PLS,.RAS)
"RTN","PXRMTAX",65,0)
 D SCPAR^PXRMCOND(.FINDPA,.CASESEN,.COND,.UCIFS,.ICOND,.VSLIST)
"RTN","PXRMTAX",66,0)
 S SDIR=$S(NOCC<0:+1,1:-1)
"RTN","PXRMTAX",67,0)
 S NOCC=$S(NOCC<0:-NOCC,1:NOCC)
"RTN","PXRMTAX",68,0)
 S NGET=$S(UCIFS:50,1:NOCC)
"RTN","PXRMTAX",69,0)
 ;
"RTN","PXRMTAX",70,0)
 I (NICD0>0),INS D FPDAT^PXRMDGPT(DFN,.TAXARR,NGET,SDIR,BDT,EDT,"ICD0",.TLIST)
"RTN","PXRMTAX",71,0)
 ;
"RTN","PXRMTAX",72,0)
 I (NICD9>0),INS D FPDAT^PXRMDGPT(DFN,.TAXARR,NGET,SDIR,BDT,EDT,"ICD9",.TLIST)
"RTN","PXRMTAX",73,0)
 I (NICD9>0),ENS D FPDAT^PXRMVPOV(DFN,.TAXARR,NGET,SDIR,BDT,EDT,.TLIST)
"RTN","PXRMTAX",74,0)
 I (NICD9>0),PLS D
"RTN","PXRMTAX",75,0)
 . K STATUSA
"RTN","PXRMTAX",76,0)
 . D GETSTATI^PXRMSTAT(9000011,.FINDPA,.STATUSA)
"RTN","PXRMTAX",77,0)
 . D FPDAT^PXRMPROB(DFN,.TAXARR,NGET,SDIR,BDT,EDT,.STATUSA,.TLIST)
"RTN","PXRMTAX",78,0)
 ;
"RTN","PXRMTAX",79,0)
 I (NCPT>0),(ENS) D FPDAT^PXRMVCPT(DFN,.TAXARR,NGET,SDIR,BDT,EDT,.TLIST)
"RTN","PXRMTAX",80,0)
 ;
"RTN","PXRMTAX",81,0)
 I (NRCPT>0),(RAS) D
"RTN","PXRMTAX",82,0)
 . K STATUSA
"RTN","PXRMTAX",83,0)
 . D GETSTATI^PXRMSTAT(70,.FINDPA,.STATUSA)
"RTN","PXRMTAX",84,0)
 . D FPDAT^PXRMRCPT(DFN,.TAXARR,NOCC,BDT,EDT,.STATUSA,.TLIST)
"RTN","PXRMTAX",85,0)
 ;
"RTN","PXRMTAX",86,0)
 ;Process the found list, returning the NOCC most recent results.
"RTN","PXRMTAX",87,0)
 S NFOUND=0
"RTN","PXRMTAX",88,0)
 S DATE=""
"RTN","PXRMTAX",89,0)
 F  S DATE=$O(TLIST(DATE),SDIR) Q:(DATE="")!(NFOUND=NOCC)  D
"RTN","PXRMTAX",90,0)
 . S IND=0
"RTN","PXRMTAX",91,0)
 . F  S IND=$O(TLIST(DATE,IND)) Q:(IND="")!(NFOUND=NOCC)  D
"RTN","PXRMTAX",92,0)
 .. S FILENUM=0
"RTN","PXRMTAX",93,0)
 .. F  S FILENUM=$O(TLIST(DATE,IND,FILENUM)) Q:FILENUM=""  D
"RTN","PXRMTAX",94,0)
 ... S NFOUND=NFOUND+1
"RTN","PXRMTAX",95,0)
 ... S DAS=$P(TLIST(DATE,IND,FILENUM),U,1)
"RTN","PXRMTAX",96,0)
 ... S FLIST(NFOUND)=TLIST(DATE,IND,FILENUM)
"RTN","PXRMTAX",97,0)
 ... S FLIST(NFOUND)=DAS_U_DATE_U_FILENUM_U_$P(TLIST(DATE,IND,FILENUM),U,2,10)
"RTN","PXRMTAX",98,0)
 I NFOUND=0 S FIEVAL=0 Q
"RTN","PXRMTAX",99,0)
 S NP=0
"RTN","PXRMTAX",100,0)
 F IND=1:1:NFOUND Q:NP=NOCC  D
"RTN","PXRMTAX",101,0)
 . S DAS=$P(FLIST(IND),U,1)
"RTN","PXRMTAX",102,0)
 . S FILENUM=$P(FLIST(IND),U,3)
"RTN","PXRMTAX",103,0)
 . D GETDATA^PXRMDATA(FILENUM,DAS,.FIEVT)
"RTN","PXRMTAX",104,0)
 . I $D(FIEVT("VISIT")) D GETDATA^PXRMVSIT(FIEVT("VISIT"),.FIEVT,0)
"RTN","PXRMTAX",105,0)
 . S FIEVT("DATE")=$P(FLIST(IND),U,2)
"RTN","PXRMTAX",106,0)
 . S CODEP=$P(FLIST(IND),U,4)
"RTN","PXRMTAX",107,0)
 . S FIEVT("CODEP")=CODEP
"RTN","PXRMTAX",108,0)
 . S CFILE=$S(FILENUM=9000011:80,FILENUM=9000010.07:80,FILENUM=9000010.18:81,1:"")
"RTN","PXRMTAX",109,0)
 . I FILENUM=45 S CFILE=$S($P(FLIST(IND),U,6)="ICD0":80.1,1:80)
"RTN","PXRMTAX",110,0)
 .;DBIA# 1995,3990
"RTN","PXRMTAX",111,0)
 . S CODE=$S(CFILE=80:$$ICDDX^ICDCODE(CODEP),CFILE=80.1:$$ICDOP^ICDCODE(CODEP),CFILE=81:$$CPT^ICPTCOD(CODEP),1:"")
"RTN","PXRMTAX",112,0)
 . I CODE'="" S FIEVT("CODE")=$P(CODE,U,2)
"RTN","PXRMTAX",113,0)
 . S CONVAL=$S(COND'="":$$COND^PXRMCOND(CASESEN,ICOND,VSLIST,.FIEVT),1:1)
"RTN","PXRMTAX",114,0)
 . S SAVE=$S('UCIFS:1,(UCIFS&CONVAL):1,1:0)
"RTN","PXRMTAX",115,0)
 . I SAVE D
"RTN","PXRMTAX",116,0)
 .. S NP=NP+1
"RTN","PXRMTAX",117,0)
 .. S FIEVAL(NP)=CONVAL
"RTN","PXRMTAX",118,0)
 .. I COND'="" S FIEVAL(NP,"CONDITION")=CONVAL
"RTN","PXRMTAX",119,0)
 .. S FIEVAL(NP,"DAS")=DAS
"RTN","PXRMTAX",120,0)
 .. S FIEVAL(NP,"DATE")=FIEVT("DATE")
"RTN","PXRMTAX",121,0)
 .. S FIEVAL(NP,"FILE NUMBER")=FILENUM
"RTN","PXRMTAX",122,0)
 .. S FIEVAL(NP,"FILE SPECIFIC")=$P(FLIST(IND),U,5,10)
"RTN","PXRMTAX",123,0)
 .. S FIEVAL(NP,"FINDING")=TAXIEN_";PXD(811.2,"
"RTN","PXRMTAX",124,0)
 .. M FIEVAL(NP)=FIEVT
"RTN","PXRMTAX",125,0)
 .. I $G(PXRMDEBG) M FIEVAL(NP,"CSUB")=FIEVT
"RTN","PXRMTAX",126,0)
 ;Save the finding result.
"RTN","PXRMTAX",127,0)
 D SFRES^PXRMUTIL(SDIR,NP,.FIEVAL)
"RTN","PXRMTAX",128,0)
 Q
"RTN","PXRMTAX",129,0)
 ;
"RTN","PXRMTAX",130,0)
 ;==================================================
"RTN","PXRMTAX",131,0)
GPLIST(TAXIEN,FINDPA,PLIST) ;Get the list of patients with
"RTN","PXRMTAX",132,0)
 ;taxonomy TAXIEN. Return the list as:
"RTN","PXRMTAX",133,0)
 ; ^TMP($J,PLIST,T/F,DFN,TAXIEN,COUNT,FILE NUMBER)
"RTN","PXRMTAX",134,0)
 ; =DAS^DATE^CODE^TYPE^file specific. TAXIEN is like the item for
"RTN","PXRMTAX",135,0)
 ;non-taxonomy findings.
"RTN","PXRMTAX",136,0)
 N BDT,COND,DATE,DFN,DLIST,EDT,ENS,FILENUM
"RTN","PXRMTAX",137,0)
 N ICOND,IND,INS,IPLIST
"RTN","PXRMTAX",138,0)
 N NF,NFOUND,NICD0,NICD9,NCPT,NF,NGET,NOCC,NRCPT
"RTN","PXRMTAX",139,0)
 N PLS,RAS,STATUSA,UCIFS,USEINP,TAXARR,TF,TLIST,VSLIST
"RTN","PXRMTAX",140,0)
 ;Set the finding search parameters.
"RTN","PXRMTAX",141,0)
 S TLIST="GPLIST_PXRMTAX"
"RTN","PXRMTAX",142,0)
 K ^TMP($J,TLIST)
"RTN","PXRMTAX",143,0)
 D SSPAR^PXRMUTIL(FINDPA(0),.NOCC,.BDT,.EDT)
"RTN","PXRMTAX",144,0)
 D TAX^PXRMLDR(TAXIEN,.TAXARR)
"RTN","PXRMTAX",145,0)
 D SETVAR^PXRMTAXS(.TAXARR,.ENS,.INS,.NICD0,.NICD9,.NCPT,.NRCPT,.PLS,.RAS)
"RTN","PXRMTAX",146,0)
 D SCPAR^PXRMCOND(.FINDPA,.COND,.UCIFS,.ICOND,.VSLIST)
"RTN","PXRMTAX",147,0)
 ;
"RTN","PXRMTAX",148,0)
 I (NICD0>0),INS D GPLIST^PXRMDGPT(.TAXARR,NOCC,BDT,EDT,"ICD0",TLIST)
"RTN","PXRMTAX",149,0)
 ;
"RTN","PXRMTAX",150,0)
 I (NICD9>0),INS D GPLIST^PXRMDGPT(.TAXARR,NOCC,BDT,EDT,"ICD9",TLIST)
"RTN","PXRMTAX",151,0)
 I (NICD9>0),PLS D 
"RTN","PXRMTAX",152,0)
 . K STATUSA
"RTN","PXRMTAX",153,0)
 . D GETSTATI^PXRMSTAT(9000011,.FINDPA,.STATUSA)
"RTN","PXRMTAX",154,0)
 . D GPLIST^PXRMPROB(.TAXARR,NOCC,BDT,EDT,.STATUSA,TLIST)
"RTN","PXRMTAX",155,0)
 I (NICD9>0),ENS D GPLIST^PXRMVPOV(.TAXARR,NOCC,BDT,EDT,TLIST)
"RTN","PXRMTAX",156,0)
 ;
"RTN","PXRMTAX",157,0)
 I (NCPT>0),ENS D GPLIST^PXRMVCPT(.TAXARR,NOCC,BDT,EDT,TLIST)
"RTN","PXRMTAX",158,0)
 ;
"RTN","PXRMTAX",159,0)
 I (NRCPT>0),RAS D GPLIST^PXRMRCPT(.TAXARR,.FINDPA,TLIST)
"RTN","PXRMTAX",160,0)
 ;Conditions for taxonomies only apply to radiology findings, this
"RTN","PXRMTAX",161,0)
 ;is taken care of in PXRMRCPT.
"RTN","PXRMTAX",162,0)
 ;Process the found list, return up to NOCC of the most recent entries.
"RTN","PXRMTAX",163,0)
 F TF=0,1 D
"RTN","PXRMTAX",164,0)
 . I '$D(^TMP($J,TLIST,TF)) Q
"RTN","PXRMTAX",165,0)
 . S DFN=""
"RTN","PXRMTAX",166,0)
 . F  S DFN=$O(^TMP($J,TLIST,TF,DFN)) Q:DFN=""  D
"RTN","PXRMTAX",167,0)
 .. K DLIST,IPLIST
"RTN","PXRMTAX",168,0)
 .. S NFOUND=0
"RTN","PXRMTAX",169,0)
 .. S NF=""
"RTN","PXRMTAX",170,0)
 .. F  S NF=$O(^TMP($J,TLIST,TF,DFN,NF),-1) Q:NF=""  D
"RTN","PXRMTAX",171,0)
 ... S FILENUM=0
"RTN","PXRMTAX",172,0)
 ... F  S FILENUM=$O(^TMP($J,TLIST,TF,DFN,NF,FILENUM)) Q:FILENUM=""  D
"RTN","PXRMTAX",173,0)
 .... S NFOUND=NFOUND+1
"RTN","PXRMTAX",174,0)
 .... S DATE=$P(^TMP($J,TLIST,TF,DFN,NF,FILENUM),U,2)
"RTN","PXRMTAX",175,0)
 .... S DLIST(DATE,NFOUND)=NF_U_FILENUM
"RTN","PXRMTAX",176,0)
 ..;
"RTN","PXRMTAX",177,0)
 .. S DATE="",NFOUND=0
"RTN","PXRMTAX",178,0)
 .. F  S DATE=$O(DLIST(DATE),-1) Q:(DATE="")!(NFOUND=NOCC)  D
"RTN","PXRMTAX",179,0)
 ... S NF=0
"RTN","PXRMTAX",180,0)
 ... F  S NF=$O(DLIST(DATE,NF)) Q:(NF="")!(NFOUND=NOCC)  D
"RTN","PXRMTAX",181,0)
 .... S NFOUND=NFOUND+1
"RTN","PXRMTAX",182,0)
 .... S IND=$P(DLIST(DATE,NF),U,1)
"RTN","PXRMTAX",183,0)
 .... S FILENUM=$P(DLIST(DATE,NF),U,2)
"RTN","PXRMTAX",184,0)
 .... S IPLIST(TF,DFN,TAXIEN,NFOUND,FILENUM)=^TMP($J,TLIST,TF,DFN,IND,FILENUM)
"RTN","PXRMTAX",185,0)
 .. M ^TMP($J,PLIST)=IPLIST
"RTN","PXRMTAX",186,0)
 K ^TMP($J,TLIST)
"RTN","PXRMTAX",187,0)
 Q
"RTN","PXRMTAX",188,0)
 ;
"RTN","PXRMTAX",189,0)
 ;==================================================
"RTN","PXRMTAX",190,0)
MHVOUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the MHV output.
"RTN","PXRMTAX",191,0)
 N IND,FILENUM,FNA,OCCLIST,TIFIEVAL
"RTN","PXRMTAX",192,0)
 S IND=0
"RTN","PXRMTAX",193,0)
 F  S IND=+$O(IFIEVAL(IND)) Q:IND=0  S FILENUM=IFIEVAL(IND,"FILE NUMBER"),FNA(FILENUM,IND)=""
"RTN","PXRMTAX",194,0)
 S FILENUM=""
"RTN","PXRMTAX",195,0)
 F  S FILENUM=$O(FNA(FILENUM)) Q:FILENUM=""  D
"RTN","PXRMTAX",196,0)
 . K OCCLIST
"RTN","PXRMTAX",197,0)
 . M OCCLIST=FNA(FILENUM)
"RTN","PXRMTAX",198,0)
 . I FILENUM=45 D MHVOUT^PXRMDGPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",199,0)
 . I FILENUM=70 D MHVOUT^PXRMRCPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",200,0)
 . I FILENUM=9000010.07 D MHVOUT^PXRMVPOV(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",201,0)
 . I FILENUM=9000010.18 D MHVOUT^PXRMVCPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",202,0)
 . I FILENUM=9000011 D MHVOUT^PXRMPROB(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT)
"RTN","PXRMTAX",203,0)
 Q
"RTN","PXRMTAX",204,0)
 ;
"RTN","PXRMTAX",205,0)
 ;==================================================
"RTN","PXRMTAX",206,0)
OUTPUT(INDENT,IFIEVAL,NLINES,TEXT) ;Produce the clinical
"RTN","PXRMTAX",207,0)
 ;maintenance output.
"RTN","PXRMTAX",208,0)
 N IND,FILENUM,FNA,OCCLIST,TIFIEVAL
"RTN","PXRMTAX",209,0)
 S IND=0
"RTN","PXRMTAX",210,0)
 F  S IND=+$O(IFIEVAL(IND)) Q:IND=0  S FILENUM=IFIEVAL(IND,"FILE NUMBER"),FNA(FILENUM,IND)=""
"RTN","PXRMTAX",211,0)
 S FILENUM=""
"RTN","PXRMTAX",212,0)
 F  S FILENUM=$O(FNA(FILENUM)) Q:FILENUM=""  D
"RTN","PXRMTAX",213,0)
 . K OCCLIST
"RTN","PXRMTAX",214,0)
 . M OCCLIST=FNA(FILENUM)
"RTN","PXRMTAX",215,0)
 . I FILENUM=45 D OUTPUT^PXRMDGPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",216,0)
 . I FILENUM=70 D OUTPUT^PXRMRCPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",217,0)
 . I FILENUM=9000010.07 D OUTPUT^PXRMVPOV(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",218,0)
 . I FILENUM=9000010.18 D OUTPUT^PXRMVCPT(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT) Q
"RTN","PXRMTAX",219,0)
 . I FILENUM=9000011 D OUTPUT^PXRMPROB(INDENT,.OCCLIST,.IFIEVAL,.NLINES,.TEXT)
"RTN","PXRMTAX",220,0)
 Q
"RTN","PXRMTAX",221,0)
 ;
"RTN","PXRMUTIL")
0^26^B113964494
"RTN","PXRMUTIL",1,0)
PXRMUTIL ;SLC/PKR/PJH - Utility routines for use by PXRM. ;11/29/2012
"RTN","PXRMUTIL",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,11,12,17,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMUTIL",3,0)
 ;
"RTN","PXRMUTIL",4,0)
 ;=================================
"RTN","PXRMUTIL",5,0)
ATTVALUE(STRING,ATTR,SEP,AVSEP) ;STRING contains a list of attribute value
"RTN","PXRMUTIL",6,0)
 ;pairs. Each pair is separated by SEP and the attribute value pair
"RTN","PXRMUTIL",7,0)
 ;is separated by AVSEP. Return the value for the attribute ATTR.
"RTN","PXRMUTIL",8,0)
 N AVPAIR,IND,NUMAVP,VALUE
"RTN","PXRMUTIL",9,0)
 S NUMAVP=$L(STRING,SEP)
"RTN","PXRMUTIL",10,0)
 S VALUE=""
"RTN","PXRMUTIL",11,0)
 F IND=1:1:NUMAVP Q:VALUE'=""  D
"RTN","PXRMUTIL",12,0)
 . S AVPAIR=$P(STRING,SEP,IND)
"RTN","PXRMUTIL",13,0)
 . I AVPAIR[ATTR S VALUE=$P(AVPAIR,AVSEP,2)
"RTN","PXRMUTIL",14,0)
 Q VALUE
"RTN","PXRMUTIL",15,0)
 ;
"RTN","PXRMUTIL",16,0)
 ;=================================
"RTN","PXRMUTIL",17,0)
ACOPY(REF,OUTPUT) ;Copy all the descendants of the array reference into a linear
"RTN","PXRMUTIL",18,0)
 ;array. REF is the starting array reference, for example A or
"RTN","PXRMUTIL",19,0)
 ;^TMP("PXRM",$J). OUTPUT is the linear array for the output. It
"RTN","PXRMUTIL",20,0)
 ;should be in the form of a closed root, i.e., A() or ^TMP($J,).
"RTN","PXRMUTIL",21,0)
 ;Note OUTPUT cannot be used as the name of the output array.
"RTN","PXRMUTIL",22,0)
 N DONE,IND,LEN,NL,OROOT,OUT,PROOT,ROOT,START,TEMP
"RTN","PXRMUTIL",23,0)
 I REF="" Q
"RTN","PXRMUTIL",24,0)
 S NL=0
"RTN","PXRMUTIL",25,0)
 S OROOT=$P(OUTPUT,")",1)
"RTN","PXRMUTIL",26,0)
 S PROOT=$P(REF,")",1)
"RTN","PXRMUTIL",27,0)
 ;Build the root so we can tell when we are done.
"RTN","PXRMUTIL",28,0)
 S TEMP=$NA(@REF)
"RTN","PXRMUTIL",29,0)
 S ROOT=$P(TEMP,")",1)
"RTN","PXRMUTIL",30,0)
 S REF=$Q(@REF)
"RTN","PXRMUTIL",31,0)
 I REF'[ROOT Q
"RTN","PXRMUTIL",32,0)
 S DONE=0
"RTN","PXRMUTIL",33,0)
 F  Q:(REF="")!(DONE)  D
"RTN","PXRMUTIL",34,0)
 . S START=$F(REF,ROOT)
"RTN","PXRMUTIL",35,0)
 . S LEN=$L(REF)
"RTN","PXRMUTIL",36,0)
 . S IND=$E(REF,START,LEN)
"RTN","PXRMUTIL",37,0)
 . S NL=NL+1
"RTN","PXRMUTIL",38,0)
 . S OUT=OROOT_NL_")"
"RTN","PXRMUTIL",39,0)
 . S @OUT=PROOT_IND_"="_@REF
"RTN","PXRMUTIL",40,0)
 . S REF=$Q(@REF)
"RTN","PXRMUTIL",41,0)
 . I REF'[ROOT S DONE=1
"RTN","PXRMUTIL",42,0)
 Q
"RTN","PXRMUTIL",43,0)
 ;
"RTN","PXRMUTIL",44,0)
 ;=================================
"RTN","PXRMUTIL",45,0)
APRINT(REF) ;Write all the descendants of the array reference.
"RTN","PXRMUTIL",46,0)
 ;REF is the starting array reference, for example A or
"RTN","PXRMUTIL",47,0)
 ;^TMP("PXRM",$J).
"RTN","PXRMUTIL",48,0)
 N DONE,IND,LEN,LN,PROOT,ROOT,START,TEMP,TEXT
"RTN","PXRMUTIL",49,0)
 I REF="" Q
"RTN","PXRMUTIL",50,0)
 S LN=0
"RTN","PXRMUTIL",51,0)
 S PROOT=$P(REF,")",1)
"RTN","PXRMUTIL",52,0)
 ;Build the root so we can tell when we are done.
"RTN","PXRMUTIL",53,0)
 S TEMP=$NA(@REF)
"RTN","PXRMUTIL",54,0)
 S ROOT=$P(TEMP,")",1)
"RTN","PXRMUTIL",55,0)
 S REF=$Q(@REF)
"RTN","PXRMUTIL",56,0)
 I REF'[ROOT Q
"RTN","PXRMUTIL",57,0)
 S DONE=0
"RTN","PXRMUTIL",58,0)
 F  Q:(REF="")!(DONE)  D
"RTN","PXRMUTIL",59,0)
 . S START=$F(REF,ROOT)
"RTN","PXRMUTIL",60,0)
 . S LEN=$L(REF)
"RTN","PXRMUTIL",61,0)
 . S IND=$E(REF,START,LEN)
"RTN","PXRMUTIL",62,0)
 . S LN=LN+1,TEXT(LN)=@REF
"RTN","PXRMUTIL",63,0)
 . S REF=$Q(@REF)
"RTN","PXRMUTIL",64,0)
 . I REF'[ROOT S DONE=1
"RTN","PXRMUTIL",65,0)
 D MES^XPDUTL(.TEXT)
"RTN","PXRMUTIL",66,0)
 Q
"RTN","PXRMUTIL",67,0)
 ;
"RTN","PXRMUTIL",68,0)
 ;=================================
"RTN","PXRMUTIL",69,0)
AWRITE(REF) ;Write all the descendants of the array reference, including the
"RTN","PXRMUTIL",70,0)
 ;array. REF is the starting array reference, for example A or
"RTN","PXRMUTIL",71,0)
 ;^TMP("PXRM",$J).
"RTN","PXRMUTIL",72,0)
 N DONE,IND,LEN,LN,PROOT,ROOT,START,TEMP,TEXT
"RTN","PXRMUTIL",73,0)
 I REF="" Q
"RTN","PXRMUTIL",74,0)
 S LN=0
"RTN","PXRMUTIL",75,0)
 S PROOT=$P(REF,")",1)
"RTN","PXRMUTIL",76,0)
 ;Build the root so we can tell when we are done.
"RTN","PXRMUTIL",77,0)
 S TEMP=$NA(@REF)
"RTN","PXRMUTIL",78,0)
 S ROOT=$P(TEMP,")",1)
"RTN","PXRMUTIL",79,0)
 S REF=$Q(@REF)
"RTN","PXRMUTIL",80,0)
 I REF'[ROOT Q
"RTN","PXRMUTIL",81,0)
 S DONE=0
"RTN","PXRMUTIL",82,0)
 F  Q:(REF="")!(DONE)  D
"RTN","PXRMUTIL",83,0)
 . S START=$F(REF,ROOT)
"RTN","PXRMUTIL",84,0)
 . S LEN=$L(REF)
"RTN","PXRMUTIL",85,0)
 . S IND=$E(REF,START,LEN)
"RTN","PXRMUTIL",86,0)
 . S LN=LN+1,TEXT(LN)=PROOT_IND_"="_@REF
"RTN","PXRMUTIL",87,0)
 . S REF=$Q(@REF)
"RTN","PXRMUTIL",88,0)
 . I REF'[ROOT S DONE=1
"RTN","PXRMUTIL",89,0)
 D MES^XPDUTL(.TEXT)
"RTN","PXRMUTIL",90,0)
 Q
"RTN","PXRMUTIL",91,0)
 ;
"RTN","PXRMUTIL",92,0)
 ;=================================
"RTN","PXRMUTIL",93,0)
BORP(DEFAULT) ;Ask the user if they want to browse or print.
"RTN","PXRMUTIL",94,0)
 N DIR,POP,X,Y
"RTN","PXRMUTIL",95,0)
 S DIR(0)="SA"_U_"B:Browse;P:Print"
"RTN","PXRMUTIL",96,0)
 S DIR("A")="Browse or Print? "
"RTN","PXRMUTIL",97,0)
 S DIR("B")=DEFAULT
"RTN","PXRMUTIL",98,0)
 D ^DIR
"RTN","PXRMUTIL",99,0)
 I $D(DIROUT) S DTOUT=1
"RTN","PXRMUTIL",100,0)
 I $D(DTOUT)!($D(DUOUT)) Q ""
"RTN","PXRMUTIL",101,0)
 Q Y
"RTN","PXRMUTIL",102,0)
 ;
"RTN","PXRMUTIL",103,0)
 ;=================================
"RTN","PXRMUTIL",104,0)
DELTLFE(FILENUM,NAME) ;Delete top level entries from a file.
"RTN","PXRMUTIL",105,0)
 N FDA,IENS,MSG
"RTN","PXRMUTIL",106,0)
 S IENS=+$$FIND1^DIC(FILENUM,"","BXU",NAME)
"RTN","PXRMUTIL",107,0)
 I IENS=0 Q
"RTN","PXRMUTIL",108,0)
 S IENS=IENS_","
"RTN","PXRMUTIL",109,0)
 S FDA(FILENUM,IENS,.01)="@"
"RTN","PXRMUTIL",110,0)
 D FILE^DIE("","FDA","MSG")
"RTN","PXRMUTIL",111,0)
 Q
"RTN","PXRMUTIL",112,0)
 ;
"RTN","PXRMUTIL",113,0)
 ;=================================
"RTN","PXRMUTIL",114,0)
DIP(VAR,IEN,PXRMROOT,FLDS) ;Do general inquiry for IEN return formatted
"RTN","PXRMUTIL",115,0)
 ;output in VAR. VAR can be either a local variable or a global.
"RTN","PXRMUTIL",116,0)
 ;If it is a local it is indexed for the broker. If it is a global
"RTN","PXRMUTIL",117,0)
 ;it should be passed in closed form i.e., ^TMP("PXRMTEST",$J).
"RTN","PXRMUTIL",118,0)
 ;It will be returned formatted for ListMan i.e.,
"RTN","PXRMUTIL",119,0)
 ;^TMP("PXRMTEST",$J,N,0).
"RTN","PXRMUTIL",120,0)
 N %ZIS,ARRAY,BY,DC,DHD,DIC,DONE,FF,FILENAME,FILESPEC,FR,GBL,HFNAME
"RTN","PXRMUTIL",121,0)
 N IND,IOP,L,NOW,PATH,SUCCESS,TO,UNIQN
"RTN","PXRMUTIL",122,0)
 S BY="NUMBER",(FR,TO)=+$P(IEN,U,1),DHD="@@"
"RTN","PXRMUTIL",123,0)
 ;Make sure the PXRM WORKSTATION device exists.
"RTN","PXRMUTIL",124,0)
 D MKWSDEV^PXRMHOST
"RTN","PXRMUTIL",125,0)
 ;Set up the output file before DIP is called.
"RTN","PXRMUTIL",126,0)
 S PATH=$$PWD^%ZISH
"RTN","PXRMUTIL",127,0)
 S NOW=$$NOW^XLFDT
"RTN","PXRMUTIL",128,0)
 S NOW=$TR(NOW,".","")
"RTN","PXRMUTIL",129,0)
 S UNIQN=$J_NOW
"RTN","PXRMUTIL",130,0)
 S FILENAME="PXRMWSD"_UNIQN_".DAT"
"RTN","PXRMUTIL",131,0)
 S HFNAME=PATH_FILENAME
"RTN","PXRMUTIL",132,0)
 S IOP="PXRM WORKSTATION;80"
"RTN","PXRMUTIL",133,0)
 S %ZIS("HFSMODE")="W"
"RTN","PXRMUTIL",134,0)
 S %ZIS("HFSNAME")=HFNAME
"RTN","PXRMUTIL",135,0)
 S L=0,DIC=PXRMROOT
"RTN","PXRMUTIL",136,0)
 D EN1^DIP
"RTN","PXRMUTIL",137,0)
 ;Move the host file into a global.
"RTN","PXRMUTIL",138,0)
 S GBL="^TMP(""PXRMUTIL"",$J,1,0)"
"RTN","PXRMUTIL",139,0)
 S GBL=$NA(@GBL)
"RTN","PXRMUTIL",140,0)
 K ^TMP("PXRMUTIL",$J)
"RTN","PXRMUTIL",141,0)
 S SUCCESS=$$FTG^%ZISH(PATH,FILENAME,GBL,3)
"RTN","PXRMUTIL",142,0)
 ;Look for a form feed, remove it and all subsequent lines.
"RTN","PXRMUTIL",143,0)
 S FF=$C(12)
"RTN","PXRMUTIL",144,0)
 I $G(VAR)["^" D
"RTN","PXRMUTIL",145,0)
 . S VAR=$NA(@VAR)
"RTN","PXRMUTIL",146,0)
 . S VAR=$P(VAR,")",1)
"RTN","PXRMUTIL",147,0)
 . S VAR=VAR_",IND,0)"
"RTN","PXRMUTIL",148,0)
 . S (DONE,IND)=0
"RTN","PXRMUTIL",149,0)
 . F  Q:DONE  S IND=$O(^TMP("PXRMUTIL",$J,IND)) Q:+IND=0  D
"RTN","PXRMUTIL",150,0)
 .. I ^TMP("PXRMUTIL",$J,IND,0)=FF S DONE=1 Q
"RTN","PXRMUTIL",151,0)
 .. S @VAR=^TMP("PXRMUTIL",$J,IND,0)
"RTN","PXRMUTIL",152,0)
 E  D
"RTN","PXRMUTIL",153,0)
 . S (DONE,IND)=0
"RTN","PXRMUTIL",154,0)
 . F  Q:DONE  S IND=$O(^TMP("PXRMUTIL",$J,IND)) Q:+IND=0  D
"RTN","PXRMUTIL",155,0)
 .. S VAR(IND)=^TMP("PXRMUTIL",$J,IND,0)
"RTN","PXRMUTIL",156,0)
 .. I VAR(IND)=FF K ARRAY(IND) S DONE=1
"RTN","PXRMUTIL",157,0)
 K ^TMP("PXRMUTIL",$J)
"RTN","PXRMUTIL",158,0)
 ;Delete the host file.
"RTN","PXRMUTIL",159,0)
 S FILESPEC(FILENAME)=""
"RTN","PXRMUTIL",160,0)
 S SUCCESS=$$DEL^%ZISH(PATH,$NA(FILESPEC))
"RTN","PXRMUTIL",161,0)
 Q
"RTN","PXRMUTIL",162,0)
 ;
"RTN","PXRMUTIL",163,0)
 ;=================================
"RTN","PXRMUTIL",164,0)
FNFR(ROOT) ;Given the root of a file return the file number.
"RTN","PXRMUTIL",165,0)
 Q +$P(@(ROOT_"0)"),U,2)
"RTN","PXRMUTIL",166,0)
 ;
"RTN","PXRMUTIL",167,0)
 ;=================================
"RTN","PXRMUTIL",168,0)
GPRINT(REF) ;General printing.
"RTN","PXRMUTIL",169,0)
 N DIR,IOTP,POP
"RTN","PXRMUTIL",170,0)
 D ^%ZIS
"RTN","PXRMUTIL",171,0)
 I POP Q
"RTN","PXRMUTIL",172,0)
 U IO
"RTN","PXRMUTIL",173,0)
 S IOTP=IOT
"RTN","PXRMUTIL",174,0)
 D APRINT^PXRMUTIL(REF)
"RTN","PXRMUTIL",175,0)
 D ^%ZISC
"RTN","PXRMUTIL",176,0)
 I IOTP["TRM" S DIR(0)="E",DIR("A")="Press ENTER to continue" D ^DIR
"RTN","PXRMUTIL",177,0)
 Q
"RTN","PXRMUTIL",178,0)
 ;
"RTN","PXRMUTIL",179,0)
 ;=================================
"RTN","PXRMUTIL",180,0)
NTOAN(NUMBER) ;Given an integer N return an alphabetic string that can be
"RTN","PXRMUTIL",181,0)
 ;used for sorting. This will be modulus 26. For example N=0 returns
"RTN","PXRMUTIL",182,0)
 ;A, N=26 returns BA etc.
"RTN","PXRMUTIL",183,0)
 N ALPH
"RTN","PXRMUTIL",184,0)
 S ALPH(0)="A",ALPH(1)="B",ALPH(2)="C",ALPH(3)="D",ALPH(4)="E"
"RTN","PXRMUTIL",185,0)
 S ALPH(5)="F",ALPH(6)="G",ALPH(7)="H",ALPH(8)="I",ALPH(9)="J"
"RTN","PXRMUTIL",186,0)
 S ALPH(10)="K",ALPH(11)="L",ALPH(12)="M",ALPH(13)="N",ALPH(14)="O"
"RTN","PXRMUTIL",187,0)
 S ALPH(15)="P",ALPH(16)="Q",ALPH(17)="R",ALPH(18)="S",ALPH(19)="T"
"RTN","PXRMUTIL",188,0)
 S ALPH(20)="U",ALPH(21)="V",ALPH(22)="W",ALPH(23)="X",ALPH(24)="Y"
"RTN","PXRMUTIL",189,0)
 S ALPH(25)="Z"
"RTN","PXRMUTIL",190,0)
 ;
"RTN","PXRMUTIL",191,0)
 N ANUM,DIGIT,NUM,P26,PC,PWR
"RTN","PXRMUTIL",192,0)
 S ANUM="",NUM=NUMBER,PWR=0
"RTN","PXRMUTIL",193,0)
 S P26(PWR)=1
"RTN","PXRMUTIL",194,0)
 F PWR=1:1 S P26(PWR)=26*P26(PWR-1) I P26(PWR)>NUMBER Q
"RTN","PXRMUTIL",195,0)
 S PWR=PWR-1
"RTN","PXRMUTIL",196,0)
 F PC=PWR:-1:0 D
"RTN","PXRMUTIL",197,0)
 . S DIGIT=NUM\P26(PC)
"RTN","PXRMUTIL",198,0)
 . S ANUM=ANUM_ALPH(DIGIT)
"RTN","PXRMUTIL",199,0)
 . S NUM=NUM-(DIGIT*P26(PC))
"RTN","PXRMUTIL",200,0)
 Q ANUM
"RTN","PXRMUTIL",201,0)
 ;
"RTN","PXRMUTIL",202,0)
 ;=================================
"RTN","PXRMUTIL",203,0)
OPTION(ACT) ;Disable/enable options.
"RTN","PXRMUTIL",204,0)
 N ACTION,IND,OPT,LIST,RESULT
"RTN","PXRMUTIL",205,0)
 S ACTION=$S(ACT="DISABLE":2,ACT="ENABLE":1,1:1)
"RTN","PXRMUTIL",206,0)
 D BMES^XPDUTL(ACT_" options.")
"RTN","PXRMUTIL",207,0)
 ;
"RTN","PXRMUTIL",208,0)
 D FIND^DIC(19,"","@;.01","","GMTS","*","B","","","LIST")
"RTN","PXRMUTIL",209,0)
 F IND=1:1:+LIST("DILIST",0) S OPT=LIST("DILIST","ID",IND,.01)
"RTN","PXRMUTIL",210,0)
 S RESULT=$$OPTDE^XPDUTL(OPT,ACTION)
"RTN","PXRMUTIL",211,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" option "_OPT)
"RTN","PXRMUTIL",212,0)
 ;
"RTN","PXRMUTIL",213,0)
 K LIST
"RTN","PXRMUTIL",214,0)
 D FIND^DIC(19,"","@;.01","","IBDF PRINT","*","B","","","LIST")
"RTN","PXRMUTIL",215,0)
 F IND=1:1:+LIST("DILIST",0) D
"RTN","PXRMUTIL",216,0)
 . S OPT=LIST("DILIST","ID",IND,.01)
"RTN","PXRMUTIL",217,0)
 . S RESULT=$$OPTDE^XPDUTL(OPT,ACTION)
"RTN","PXRMUTIL",218,0)
 . I RESULT=0 D MES^XPDUTL("Could not "_ACT_" option "_OPT)
"RTN","PXRMUTIL",219,0)
 ;
"RTN","PXRMUTIL",220,0)
 S OPT="OR CPRS GUI CHART"
"RTN","PXRMUTIL",221,0)
 S RESULT=$$OPTDE^XPDUTL(OPT,ACTION)
"RTN","PXRMUTIL",222,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" option "_OPT)
"RTN","PXRMUTIL",223,0)
 ;
"RTN","PXRMUTIL",224,0)
 S OPT="ORS HEALTH SUMMARY"
"RTN","PXRMUTIL",225,0)
 S RESULT=$$OPTDE^XPDUTL(OPT,ACTION)
"RTN","PXRMUTIL",226,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" option "_OPT)
"RTN","PXRMUTIL",227,0)
 ;
"RTN","PXRMUTIL",228,0)
 K LIST
"RTN","PXRMUTIL",229,0)
 D FIND^DIC(19,"","@;.01","","PXRM","*","B","","","LIST")
"RTN","PXRMUTIL",230,0)
 F IND=1:1:+LIST("DILIST",0) D
"RTN","PXRMUTIL",231,0)
 . S OPT=LIST("DILIST","ID",IND,.01)
"RTN","PXRMUTIL",232,0)
 . S RESULT=$$OPTDE^XPDUTL(OPT,ACTION)
"RTN","PXRMUTIL",233,0)
 . I RESULT=0 W !,"Could not ",ACTION," option ",OPT
"RTN","PXRMUTIL",234,0)
 Q
"RTN","PXRMUTIL",235,0)
 ;
"RTN","PXRMUTIL",236,0)
 ;=================================
"RTN","PXRMUTIL",237,0)
PROTOCOL(ACT) ;Disable/enable protocols.
"RTN","PXRMUTIL",238,0)
 N ACTION,PROT,RESULT
"RTN","PXRMUTIL",239,0)
 S ACTION=$S(ACT="DISABLE":2,ACT="ENABLE":1,1:1)
"RTN","PXRMUTIL",240,0)
 D BMES^XPDUTL(ACT_" protocols.")
"RTN","PXRMUTIL",241,0)
 ;
"RTN","PXRMUTIL",242,0)
 S PROT="ORS HEALTH SUMMARY"
"RTN","PXRMUTIL",243,0)
 S RESULT=$$PRODE^XPDUTL(PROT,ACTION)
"RTN","PXRMUTIL",244,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" protocol "_PROT)
"RTN","PXRMUTIL",245,0)
 ;
"RTN","PXRMUTIL",246,0)
 S PROT="ORS AD HOC HEALTH SUMMARY"
"RTN","PXRMUTIL",247,0)
 S RESULT=$$PRODE^XPDUTL(PROT,ACTION)
"RTN","PXRMUTIL",248,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" protocol "_PROT)
"RTN","PXRMUTIL",249,0)
 ;
"RTN","PXRMUTIL",250,0)
 S PROT="PXRM PATIENT DATA CHANGE"
"RTN","PXRMUTIL",251,0)
 S RESULT=$$PRODE^XPDUTL(PROT,ACTION)
"RTN","PXRMUTIL",252,0)
 I RESULT=0 D MES^XPDUTL("Could not "_ACT_" protocol "_PROT)
"RTN","PXRMUTIL",253,0)
 Q
"RTN","PXRMUTIL",254,0)
 ;
"RTN","PXRMUTIL",255,0)
 ;=================================
"RTN","PXRMUTIL",256,0)
RENAME(FILENUM,OLDNAME,NEWNAME) ;Rename entry OLDNAME to NEWNAME in
"RTN","PXRMUTIL",257,0)
 ;file number FILENUM.
"RTN","PXRMUTIL",258,0)
 N DA,DIE,DR,NIEN,PXRMINST
"RTN","PXRMUTIL",259,0)
 S DA=$$FIND1^DIC(FILENUM,"","BXU",OLDNAME)
"RTN","PXRMUTIL",260,0)
 I DA=0 Q
"RTN","PXRMUTIL",261,0)
 S PXRMINST=1
"RTN","PXRMUTIL",262,0)
 S NIEN=$$FIND1^DIC(FILENUM,"","BXU",NEWNAME) I NIEN>0 Q
"RTN","PXRMUTIL",263,0)
 S DIE=FILENUM
"RTN","PXRMUTIL",264,0)
 S DR=".01///^S X=NEWNAME"
"RTN","PXRMUTIL",265,0)
 D ^DIE
"RTN","PXRMUTIL",266,0)
 Q
"RTN","PXRMUTIL",267,0)
 ;
"RTN","PXRMUTIL",268,0)
 ;=================================
"RTN","PXRMUTIL",269,0)
RMEHIST(FILENUM,IEN) ;Remove the edit history for a reminder file.
"RTN","PXRMUTIL",270,0)
 I (FILENUM<800)!(FILENUM>811.9)!(FILENUM=811.8) Q
"RTN","PXRMUTIL",271,0)
 N DA,DIK,GLOBAL,ROOT
"RTN","PXRMUTIL",272,0)
 S GLOBAL=$$GET1^DID(FILENUM,"","","GLOBAL NAME")
"RTN","PXRMUTIL",273,0)
 ;Edit History is stored in node 110 for all files.
"RTN","PXRMUTIL",274,0)
 S DA(1)=IEN
"RTN","PXRMUTIL",275,0)
 S DIK=GLOBAL_IEN_",110,"
"RTN","PXRMUTIL",276,0)
 S ROOT=GLOBAL_IEN_",110,DA)"
"RTN","PXRMUTIL",277,0)
 S DA=0
"RTN","PXRMUTIL",278,0)
 F  S DA=+$O(@ROOT) Q:DA=0  D ^DIK
"RTN","PXRMUTIL",279,0)
 Q
"RTN","PXRMUTIL",280,0)
 ;
"RTN","PXRMUTIL",281,0)
 ;=================================
"RTN","PXRMUTIL",282,0)
SEHIST(FILENUM,ROOT,IEN) ;Set the edit date and edit by and prompt the
"RTN","PXRMUTIL",283,0)
 ;user for the edit comment.
"RTN","PXRMUTIL",284,0)
 N DIC,DIR,DWLW,DWPK,ENTRY,FDA,FDAIEN,IENS,IND,MSG,SFN,TARGET,X,Y
"RTN","PXRMUTIL",285,0)
 K ^TMP("PXRMWP",$J)
"RTN","PXRMUTIL",286,0)
 D FIELD^DID(FILENUM,"EDIT HISTORY","","SPECIFIER","TARGET")
"RTN","PXRMUTIL",287,0)
 S SFN=+$G(TARGET("SPECIFIER"))
"RTN","PXRMUTIL",288,0)
 I SFN=0 Q
"RTN","PXRMUTIL",289,0)
 S ENTRY=ROOT_IEN_",110)"
"RTN","PXRMUTIL",290,0)
 S IND=$O(@ENTRY@("B"),-1)
"RTN","PXRMUTIL",291,0)
 S IND=IND+1
"RTN","PXRMUTIL",292,0)
 S IENS="+"_IND_","_IEN_","
"RTN","PXRMUTIL",293,0)
 S FDAIEN(IEN)=IEN
"RTN","PXRMUTIL",294,0)
 S FDA(SFN,IENS,.01)=$$FMTE^XLFDT($$NOW^XLFDT,"5Z")
"RTN","PXRMUTIL",295,0)
 S FDA(SFN,IENS,1)="`"_DUZ
"RTN","PXRMUTIL",296,0)
 ;Prompt the user for edit comments.
"RTN","PXRMUTIL",297,0)
 S DIC="^TMP(""PXRMWP"",$J,"
"RTN","PXRMUTIL",298,0)
 S DWLW=72
"RTN","PXRMUTIL",299,0)
 S DWPK=1
"RTN","PXRMUTIL",300,0)
 W !,"Input your edit comments."
"RTN","PXRMUTIL",301,0)
 S DIR(0)="Y"_U_"AO"
"RTN","PXRMUTIL",302,0)
 S DIR("A")="Edit"
"RTN","PXRMUTIL",303,0)
 S DIR("B")="NO"
"RTN","PXRMUTIL",304,0)
 D ^DIR
"RTN","PXRMUTIL",305,0)
 I Y D
"RTN","PXRMUTIL",306,0)
 . D EN^DIWE
"RTN","PXRMUTIL",307,0)
 . K ^TMP("PXRMWP",$J,0)
"RTN","PXRMUTIL",308,0)
 . I $D(^TMP("PXRMWP",$J)) S FDA(SFN,IENS,2)="^TMP(""PXRMWP"",$J)"
"RTN","PXRMUTIL",309,0)
 D UPDATE^DIE("E","FDA","FDAIEN","MSG")
"RTN","PXRMUTIL",310,0)
 I $D(MSG) D AWRITE^PXRMUTIL("MSG")
"RTN","PXRMUTIL",311,0)
 K ^TMP("PXRMWP",$J)
"RTN","PXRMUTIL",312,0)
 Q
"RTN","PXRMUTIL",313,0)
 ;
"RTN","PXRMUTIL",314,0)
 ;=================================
"RTN","PXRMUTIL",315,0)
SETPVER(VERSION) ;Set the package version
"RTN","PXRMUTIL",316,0)
 N DA,DIE,DR
"RTN","PXRMUTIL",317,0)
 S DIE="^PXRM(800,",DA=1,DR="5////"_VERSION
"RTN","PXRMUTIL",318,0)
 D ^DIE
"RTN","PXRMUTIL",319,0)
 Q
"RTN","PXRMUTIL",320,0)
 ;
"RTN","PXRMUTIL",321,0)
 ;=================================
"RTN","PXRMUTIL",322,0)
SFRES(SDIR,NRES,FIEVAL) ;Save the finding result.
"RTN","PXRMUTIL",323,0)
 I NRES=0 S FIEVAL=0 Q
"RTN","PXRMUTIL",324,0)
 N DATE,IND,OA,SUB,TF
"RTN","PXRMUTIL",325,0)
 F IND=1:1:NRES S OA(FIEVAL(IND,"DATE"),FIEVAL(IND),IND)=""
"RTN","PXRMUTIL",326,0)
 ;If SDIR is positive get the oldest date otherwise get the most
"RTN","PXRMUTIL",327,0)
 ;recent date.
"RTN","PXRMUTIL",328,0)
 S DATE=$S(SDIR>0:$O(OA("")),1:$O(OA(""),-1))
"RTN","PXRMUTIL",329,0)
 ;If there is a true finding on DATE get it.
"RTN","PXRMUTIL",330,0)
 S TF=$O(OA(DATE,""),-1)
"RTN","PXRMUTIL",331,0)
 S IND=$O(OA(DATE,TF,""))
"RTN","PXRMUTIL",332,0)
 S FIEVAL=TF
"RTN","PXRMUTIL",333,0)
 S SUB=""
"RTN","PXRMUTIL",334,0)
 F  S SUB=$O(FIEVAL(IND,SUB)) Q:SUB=""  M FIEVAL(SUB)=FIEVAL(IND,SUB)
"RTN","PXRMUTIL",335,0)
 Q
"RTN","PXRMUTIL",336,0)
 ;
"RTN","PXRMUTIL",337,0)
 ;=================================
"RTN","PXRMUTIL",338,0)
SSPAR(FIND0,NOCC,BDT,EDT) ;Set the finding search parameters.
"RTN","PXRMUTIL",339,0)
 S BDT=$P(FIND0,U,8),EDT=$P(FIND0,U,11),NOCC=$P(FIND0,U,14)
"RTN","PXRMUTIL",340,0)
 I +NOCC=0 S NOCC=1
"RTN","PXRMUTIL",341,0)
 ;Convert the dates to FileMan dates.
"RTN","PXRMUTIL",342,0)
 S BDT=$S(BDT="":0,BDT=0:0,1:$$CTFMD^PXRMDATE(BDT))
"RTN","PXRMUTIL",343,0)
 I EDT="" S EDT="T"
"RTN","PXRMUTIL",344,0)
 S EDT=$$CTFMD^PXRMDATE(EDT)
"RTN","PXRMUTIL",345,0)
 ;If EDT does not contain a time set it to the end of the day.
"RTN","PXRMUTIL",346,0)
 I (EDT'=-1),EDT'["." S EDT=EDT_".235959"
"RTN","PXRMUTIL",347,0)
 I $G(PXRMDDOC)'=1 Q
"RTN","PXRMUTIL",348,0)
 S ^TMP("PXRMDDOC",$J,$P(FIND0,U,1,11))=BDT_U_EDT
"RTN","PXRMUTIL",349,0)
 Q
"RTN","PXRMUTIL",350,0)
 ;
"RTN","PXRMUTIL",351,0)
 ;=================================
"RTN","PXRMUTIL",352,0)
STRREP(STRING,TS,RS) ;Replace every occurrence of the target string (TS)
"RTN","PXRMUTIL",353,0)
 ;in STRING with the replacement string (RS).
"RTN","PXRMUTIL",354,0)
 ;Example 9.19 (page 220) in "The Complete Mumps" by John Lewkowicz:
"RTN","PXRMUTIL",355,0)
 ;  F  Q:STRING'[TS  S STRING=$P(STRING,TS)_RS_$P(STRING,TS,2,999)
"RTN","PXRMUTIL",356,0)
 ;fails if any portion of the target string is contained in the with
"RTN","PXRMUTIL",357,0)
 ;string. Therefore a more elaborate version is required.
"RTN","PXRMUTIL",358,0)
 ;
"RTN","PXRMUTIL",359,0)
 N IND,NPCS,STR
"RTN","PXRMUTIL",360,0)
 I STRING'[TS Q STRING
"RTN","PXRMUTIL",361,0)
 ;Count the number of pieces using the target string as the delimiter.
"RTN","PXRMUTIL",362,0)
 S NPCS=$L(STRING,TS)
"RTN","PXRMUTIL",363,0)
 ;Extract the pieces and concatenate RS
"RTN","PXRMUTIL",364,0)
 S STR=""
"RTN","PXRMUTIL",365,0)
 F IND=1:1:NPCS-1 S STR=STR_$P(STRING,TS,IND)_RS
"RTN","PXRMUTIL",366,0)
 S STR=STR_$P(STRING,TS,NPCS)
"RTN","PXRMUTIL",367,0)
 Q STR
"RTN","PXRMUTIL",368,0)
 ;
"RTN","PXRMUTIL",369,0)
 ;=================================
"RTN","PXRMUTIL",370,0)
UPEHIST(FILENUM,IEN,TEXT,MSG) ;Update the edit history.
"RTN","PXRMUTIL",371,0)
 N FDA,GBL,IENS,IND,LN,NEXT,SUBFN,TARGET,WPTMP
"RTN","PXRMUTIL",372,0)
 D FIELD^DID(FILENUM,"EDIT HISTORY","","SPECIFIER","TARGET")
"RTN","PXRMUTIL",373,0)
 S SUBFN=+$G(TARGET("SPECIFIER"))
"RTN","PXRMUTIL",374,0)
 I SUBFN=0 Q
"RTN","PXRMUTIL",375,0)
 S GBL=$$GET1^DID(FILENUM,"","","GLOBAL NAME")_IEN_",110)"
"RTN","PXRMUTIL",376,0)
 S NEXT=$O(@GBL@("B"),-1)+1
"RTN","PXRMUTIL",377,0)
 S (IND,LN)=0
"RTN","PXRMUTIL",378,0)
 F  S IND=$O(TEXT(IND)) Q:IND=""  D
"RTN","PXRMUTIL",379,0)
 . S LN=LN+1
"RTN","PXRMUTIL",380,0)
 . S WPTMP(1,2,LN)=TEXT(IND)
"RTN","PXRMUTIL",381,0)
 S IENS="+"_NEXT_","_IEN_","
"RTN","PXRMUTIL",382,0)
 S FDA(SUBFN,IENS,.01)=$$NOW^XLFDT
"RTN","PXRMUTIL",383,0)
 S FDA(SUBFN,IENS,1)=$G(DUZ)
"RTN","PXRMUTIL",384,0)
 S FDA(SUBFN,IENS,2)="WPTMP(1,2)"
"RTN","PXRMUTIL",385,0)
 D UPDATE^DIE("","FDA","","MSG")
"RTN","PXRMUTIL",386,0)
 Q
"RTN","PXRMUTIL",387,0)
 ;
"RTN","PXRMUTIL",388,0)
 ;=================================
"RTN","PXRMUTIL",389,0)
VEDIT(ROOT,IEN) ;This is used as a DIC("S") screen to select which entries
"RTN","PXRMUTIL",390,0)
 ;a user can edit.
"RTN","PXRMUTIL",391,0)
 N CLASS,ENTRY,VALID
"RTN","PXRMUTIL",392,0)
 S ENTRY=ROOT_IEN_")"
"RTN","PXRMUTIL",393,0)
 S CLASS=$P($G(@ENTRY@(100)),U,1)
"RTN","PXRMUTIL",394,0)
 I CLASS="N" D
"RTN","PXRMUTIL",395,0)
 . I ($G(PXRMINST)=1),(DUZ(0)="@") S VALID=1
"RTN","PXRMUTIL",396,0)
 . E  S VALID=0
"RTN","PXRMUTIL",397,0)
 E  S VALID=1
"RTN","PXRMUTIL",398,0)
 Q VALID
"RTN","PXRMUTIL",399,0)
 ;
"RTN","PXRMVSIT")
0^2^B10650656
"RTN","PXRMVSIT",1,0)
PXRMVSIT ;SLC/PKR - Visit related info for reminders. ;03/02/2012
"RTN","PXRMVSIT",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,18,24**;Feb 04, 2005;Build 193
"RTN","PXRMVSIT",3,0)
 ;
"RTN","PXRMVSIT",4,0)
 ;======================================================
"RTN","PXRMVSIT",5,0)
GETDATA(DA,DATA,SVALUE) ;Return data for a specific Visit file entry.
"RTN","PXRMVSIT",6,0)
 ;DBIA #2028 for Visit file.
"RTN","PXRMVSIT",7,0)
 N DONE,IEN,HLOCIEN,HTEMP,LOE,TEMP
"RTN","PXRMVSIT",8,0)
 S TEMP=^AUPNVSIT(DA,0)
"RTN","PXRMVSIT",9,0)
 S DATA("VISIT")=DA
"RTN","PXRMVSIT",10,0)
 S DATA("DATE VISIT CREATED")=$P(TEMP,U,2)
"RTN","PXRMVSIT",11,0)
 S DATA("DFN")=$P(TEMP,U,5)
"RTN","PXRMVSIT",12,0)
 S (DATA("LOC. OF ENCOUNTER"),LOE)=$P(TEMP,U,6)
"RTN","PXRMVSIT",13,0)
 ;DBIA #10090
"RTN","PXRMVSIT",14,0)
 S DATA("STATION NUMBER")=$$GET1^DIQ(4,LOE,99)
"RTN","PXRMVSIT",15,0)
 S DATA("OFFICAL VA NAME")=$$GET1^DIQ(4,LOE,100)
"RTN","PXRMVSIT",16,0)
 S DATA("SERVICE CATEGORY")=$P(TEMP,U,7)
"RTN","PXRMVSIT",17,0)
 I $G(SVALUE) S DATA("VALUE")=$P(TEMP,U,7)
"RTN","PXRMVSIT",18,0)
 S (DATA("HOSPITAL LOCATION"),HLOCIEN)=$P(TEMP,U,22)
"RTN","PXRMVSIT",19,0)
 ;DBIA #10040, #2804
"RTN","PXRMVSIT",20,0)
 S HTEMP=$S(HLOCIEN="":"",1:^SC(HLOCIEN,0))
"RTN","PXRMVSIT",21,0)
 S DATA("HLOC")=$P(HTEMP,U,1)
"RTN","PXRMVSIT",22,0)
 S DATA("DSS ID")=$P(TEMP,U,8)
"RTN","PXRMVSIT",23,0)
 I DATA("DSS ID")="" S DATA("DSS ID")=$P(HTEMP,U,7)
"RTN","PXRMVSIT",24,0)
 S DATA("DIVISION IEN")=$P(HTEMP,U,15)
"RTN","PXRMVSIT",25,0)
 I HLOCIEN'="" S DATA("DIVISION")=$$GET1^DIQ(44,HLOCIEN,3.5)
"RTN","PXRMVSIT",26,0)
 ;DBIA #557
"RTN","PXRMVSIT",27,0)
 I DATA("DSS ID")'="" S DATA("STOP CODE")=$P(^DIC(40.7,DATA("DSS ID"),0),U,2)
"RTN","PXRMVSIT",28,0)
 S DATA("OUTSIDE LOCATION")=$G(^AUPNVSIT(DA,21))
"RTN","PXRMVSIT",29,0)
 S DATA("VISIT COMMENTS")=$G(^AUPNVSIT(DA,811))
"RTN","PXRMVSIT",30,0)
 ;DBIA #4850
"RTN","PXRMVSIT",31,0)
 S DATA("STATUS")=$$STATUS^SDPCE(DA)
"RTN","PXRMVSIT",32,0)
 ;Get the primary provider.
"RTN","PXRMVSIT",33,0)
 ;DBIA #3455 for V PROVIDER
"RTN","PXRMVSIT",34,0)
 S DATA("PRIMARY PROVIDER")="",IEN="",DONE=0
"RTN","PXRMVSIT",35,0)
 F  S IEN=$O(^AUPNVPRV("AD",DA,IEN)) Q:(DONE)!(IEN="")  D
"RTN","PXRMVSIT",36,0)
 . S TEMP=^AUPNVPRV(IEN,0)
"RTN","PXRMVSIT",37,0)
 . I $P(TEMP,U,4)="P" S DATA("PRIMARY PROVIDER")=$P(TEMP,U,1),DONE=1
"RTN","PXRMVSIT",38,0)
 Q
"RTN","PXRMVSIT",39,0)
 ;
"RTN","PXRMVSIT",40,0)
 ;======================================================
"RTN","PXRMVSIT",41,0)
GAPSTAT(VIEN) ;Return the status of the appointment associated with the
"RTN","PXRMVSIT",42,0)
 ;visit.
"RTN","PXRMVSIT",43,0)
 ;DBIA #4850
"RTN","PXRMVSIT",44,0)
 Q $$STATUS^SDPCE(VIEN)
"RTN","PXRMVSIT",45,0)
 ;
"RTN","PXRMVSIT",46,0)
 ;======================================================
"RTN","PXRMVSIT",47,0)
HENC(VIEN,INDENT,NLINES,TEXT) ;Display location and comment for historical
"RTN","PXRMVSIT",48,0)
 ;encounters associated with the V files.
"RTN","PXRMVSIT",49,0)
 N COMMENT,HLOC,LOCATION,OLOC,NIN,TEXTIN,VDATA
"RTN","PXRMVSIT",50,0)
 D GETDATA(VIEN,.VDATA) I VDATA("SERVICE CATEGORY")'="E" Q
"RTN","PXRMVSIT",51,0)
 S NIN=0
"RTN","PXRMVSIT",52,0)
 S LOCATION=VDATA("LOC. OF ENCOUNTER")
"RTN","PXRMVSIT",53,0)
 I LOCATION'="" D
"RTN","PXRMVSIT",54,0)
 . S LOCATION=$$GET1^DIQ(4,LOCATION,.01)_" "_$$GET1^DIQ(4,LOCATION,99)
"RTN","PXRMVSIT",55,0)
 . S NIN=NIN+1,TEXTIN(NIN)="Location of Encounter: "_LOCATION_"\\"
"RTN","PXRMVSIT",56,0)
 S HLOC=VDATA("HOSPITAL LOCATION")
"RTN","PXRMVSIT",57,0)
 I HLOC'="" D
"RTN","PXRMVSIT",58,0)
 . S HLOC=$$GET1^DIQ(44,HLOC,.01)
"RTN","PXRMVSIT",59,0)
 . S NIN=NIN+1,TEXTIN(NIN)="Hospital Location: "_HLOC_"\\"
"RTN","PXRMVSIT",60,0)
 S OLOC=VDATA("OUTSIDE LOCATION")
"RTN","PXRMVSIT",61,0)
 I OLOC'="" D
"RTN","PXRMVSIT",62,0)
 . S NIN=NIN+1,TEXTIN(NIN)="Outside Location: "_OLOC_"\\"
"RTN","PXRMVSIT",63,0)
 S COMMENT=VDATA("COMMENT")
"RTN","PXRMVSIT",64,0)
 I COMMENT'="" D
"RTN","PXRMVSIT",65,0)
 . S NIN=NIN+1,TEXTIN(NIN)="Comment: "_COMMENT
"RTN","PXRMVSIT",66,0)
 I NIN>0 D
"RTN","PXRMVSIT",67,0)
 . N JND,NOUT,TEXTOUT
"RTN","PXRMVSIT",68,0)
 . S NLINES=NLINES+1
"RTN","PXRMVSIT",69,0)
 . S TEXT(NLINES)=$$INSCHR^PXRMEXLC(INDENT," ")_"Historical Encounter Information:"
"RTN","PXRMVSIT",70,0)
 . D FORMAT^PXRMTEXT(INDENT+2,PXRMRM,NIN,.TEXTIN,.NOUT,.TEXTOUT)
"RTN","PXRMVSIT",71,0)
 . F JND=1:1:NOUT S NLINES=NLINES+1,TEXT(NLINES)=TEXTOUT(JND)
"RTN","PXRMVSIT",72,0)
 Q
"RTN","PXRMVSIT",73,0)
 ;
"RTN","PXRMVSIT",74,0)
 ;======================================================
"RTN","PXRMVSIT",75,0)
ISHIST(VIEN) ;Return true if the encounter was historical.
"RTN","PXRMVSIT",76,0)
 ;DBIA #2028
"RTN","PXRMVSIT",77,0)
 I $P($G(^AUPNVSIT(VIEN,0)),U,7)="E" Q 1
"RTN","PXRMVSIT",78,0)
 Q 0
"RTN","PXRMVSIT",79,0)
 ;
"RTN","PXRMVSIT",80,0)
 ;======================================================
"RTN","PXRMVSIT",81,0)
VAPSTAT(VIEN) ;Return true if the appointment associated with
"RTN","PXRMVSIT",82,0)
 ;the visit has a valid appointment status.
"RTN","PXRMVSIT",83,0)
 ;Return false if the status is one of the following:
"RTN","PXRMVSIT",84,0)
 ;CANCELLED BY CLINIC
"RTN","PXRMVSIT",85,0)
 ;CANCELLED BY CLINIC & AUTO RE-BOOK
"RTN","PXRMVSIT",86,0)
 ;CANCELLED BY PATIENT
"RTN","PXRMVSIT",87,0)
 ;CANCELLED BY PATIENT & AUTO-REBOOK
"RTN","PXRMVSIT",88,0)
 ;DELETED
"RTN","PXRMVSIT",89,0)
 ;NO ACTION TAKEN
"RTN","PXRMVSIT",90,0)
 ;NO-SHOW
"RTN","PXRMVSIT",91,0)
 ;NO-SHOW & AUTO RE-BOOK
"RTN","PXRMVSIT",92,0)
 ;NULL
"RTN","PXRMVSIT",93,0)
 N STATUS,VALID
"RTN","PXRMVSIT",94,0)
 ;DBIA #4850
"RTN","PXRMVSIT",95,0)
 S STATUS=$P($$STATUS^SDPCE(VIEN),U,2)
"RTN","PXRMVSIT",96,0)
 S VALID=$S(STATUS["CANCELLED":0,STATUS["DELETED":0,STATUS["NO ACTION":0,STATUS["NO-SHOW":0,STATUS="":0,1:1)
"RTN","PXRMVSIT",97,0)
 Q VALID
"RTN","PXRMVSIT",98,0)
 ;
"RTN","PXRMXQUE")
0^27^B12328074
"RTN","PXRMXQUE",1,0)
PXRMXQUE ;SLC/PJH - Reminder reports general queuing routine. ;09/12/2012
"RTN","PXRMXQUE",2,0)
 ;;2.0;CLINICAL REMINDERS;**4,6,12,17,24**;Feb 04, 2005;Build 193
"RTN","PXRMXQUE",3,0)
 ;
"RTN","PXRMXQUE",4,0)
 ;===============================
"RTN","PXRMXQUE",5,0)
DEVICE(RTN,DESC,SAVE,%ZIS,RETZTSK) ;
"RTN","PXRMXQUE",6,0)
 ;Pass RETZTSK as number such as 1 if you want to get ZTSK.
"RTN","PXRMXQUE",7,0)
 N ZTSK
"RTN","PXRMXQUE",8,0)
 W !
"RTN","PXRMXQUE",9,0)
 D EN^XUTMDEVQ(RTN,DESC,.SAVE,.%ZIS,RETZTSK)
"RTN","PXRMXQUE",10,0)
 I $D(ZTSK) W !!,DESC," has been queued, task number "_ZTSK H 2
"RTN","PXRMXQUE",11,0)
 Q $G(ZTSK)
"RTN","PXRMXQUE",12,0)
 ;
"RTN","PXRMXQUE",13,0)
 ;===============================
"RTN","PXRMXQUE",14,0)
JOB ;Get the output device.
"RTN","PXRMXQUE",15,0)
 N POP,%ZIS
"RTN","PXRMXQUE",16,0)
 S %ZIS="NQ"
"RTN","PXRMXQUE",17,0)
 W !
"RTN","PXRMXQUE",18,0)
 D ^%ZIS
"RTN","PXRMXQUE",19,0)
 I POP G EXIT^PXRMXD
"RTN","PXRMXQUE",20,0)
 I IOT="HFS" S PXRMHFIO=IO
"RTN","PXRMXQUE",21,0)
 S PXRMQUE=$G(IO("Q"))
"RTN","PXRMXQUE",22,0)
 S PXRMIOP=ION_";"_$G(IOST)_";"_$G(IO("DOC"))_";"_$G(IOM)_";"_$G(IOSL)
"RTN","PXRMXQUE",23,0)
 ;
"RTN","PXRMXQUE",24,0)
 I PXRMQUE D  Q
"RTN","PXRMXQUE",25,0)
 .;Queue the report.
"RTN","PXRMXQUE",26,0)
 . N DESC,ROUTINE,TASK
"RTN","PXRMXQUE",27,0)
 . S DESC="Reminder Due Report"
"RTN","PXRMXQUE",28,0)
 . S ROUTINE="START^PXRMXSE1"
"RTN","PXRMXQUE",29,0)
 . S TASK=$$QUE^PXRMXQUE(DESC,ROUTINE,"","SAVE^PXRMXQUE")
"RTN","PXRMXQUE",30,0)
 . Q:TASK=""
"RTN","PXRMXQUE",31,0)
 . W !,"Report queued, task number is ",TASK
"RTN","PXRMXQUE",32,0)
 I 'PXRMQUE D ^PXRMXSE1
"RTN","PXRMXQUE",33,0)
 Q
"RTN","PXRMXQUE",34,0)
 ;
"RTN","PXRMXQUE",35,0)
 ;===============================
"RTN","PXRMXQUE",36,0)
QUE(ZTDESC,ZTRTN,ZTDTH,SAVERTN) ;Queue a task.
"RTN","PXRMXQUE",37,0)
 N ZTSK
"RTN","PXRMXQUE",38,0)
 ;If ZTIO is not explicitly set to null then %ZTLOAD will open
"RTN","PXRMXQUE",39,0)
 ;the device.
"RTN","PXRMXQUE",40,0)
 S ZTIO=""
"RTN","PXRMXQUE",41,0)
 D @SAVERTN
"RTN","PXRMXQUE",42,0)
 D ^%ZTLOAD
"RTN","PXRMXQUE",43,0)
 I $D(ZTSK)=0 W !!,DESC," cancelled." Q ""
"RTN","PXRMXQUE",44,0)
 Q ZTSK
"RTN","PXRMXQUE",45,0)
 ;
"RTN","PXRMXQUE",46,0)
 ;===============================
"RTN","PXRMXQUE",47,0)
SAVE ;Save the variables for queing.
"RTN","PXRMXQUE",48,0)
 S ZTSAVE("PXRMBDT")="",ZTSAVE("PXRMEDT")="",ZTSAVE("PXRMSDT")=""
"RTN","PXRMXQUE",49,0)
 S ZTSAVE("PXRMCS(")="",ZTSAVE("NCS")=""
"RTN","PXRMXQUE",50,0)
 S ZTSAVE("PXRMCGRP(")="",ZTSAVE("NCGRP")=""
"RTN","PXRMXQUE",51,0)
 S ZTSAVE("PXRMFAC(")="",ZTSAVE("NFAC")=""
"RTN","PXRMXQUE",52,0)
 S ZTSAVE("PXRMFACN(")=""
"RTN","PXRMXQUE",53,0)
 S ZTSAVE("PXRMFCMB")=""
"RTN","PXRMXQUE",54,0)
 S ZTSAVE("PXRMFUT")="",ZTSAVE("PXRMDLOC")=""
"RTN","PXRMXQUE",55,0)
 S ZTSAVE("PXRMFD")=""
"RTN","PXRMXQUE",56,0)
 S ZTSAVE("PXRMHFIO")=""
"RTN","PXRMXQUE",57,0)
 S ZTSAVE("PXRMINP")=""
"RTN","PXRMXQUE",58,0)
 S ZTSAVE("PXRMIO")=""
"RTN","PXRMXQUE",59,0)
 S ZTSAVE("PXRMIOP")=""
"RTN","PXRMXQUE",60,0)
 S ZTSAVE("PXRMLCHL(")="",ZTSAVE("NHL")=""
"RTN","PXRMXQUE",61,0)
 S ZTSAVE("PXRMLCMB")=""
"RTN","PXRMXQUE",62,0)
 S ZTSAVE("PXRMLCSC")=""
"RTN","PXRMXQUE",63,0)
 S ZTSAVE("PXRMPRIM")=""
"RTN","PXRMXQUE",64,0)
 S ZTSAVE("PXRMQUE")=""
"RTN","PXRMXQUE",65,0)
 S ZTSAVE("PXRMREP")=""
"RTN","PXRMXQUE",66,0)
 S ZTSAVE("PXRMRT")=""
"RTN","PXRMXQUE",67,0)
 S ZTSAVE("PXRMSCAT")="",ZTSAVE("PXRMSCAT(")=""
"RTN","PXRMXQUE",68,0)
 S ZTSAVE("PXRMSEL")=""
"RTN","PXRMXQUE",69,0)
 S ZTSAVE("PXRMSRT")=""
"RTN","PXRMXQUE",70,0)
 S ZTSAVE("PXRMSSN")=""
"RTN","PXRMXQUE",71,0)
 S ZTSAVE("PXRMTABC")=""
"RTN","PXRMXQUE",72,0)
 S ZTSAVE("PXRMTABS")=""
"RTN","PXRMXQUE",73,0)
 S ZTSAVE("PXRMTCMB")=""
"RTN","PXRMXQUE",74,0)
 S ZTSAVE("PXRMTMP")=""
"RTN","PXRMXQUE",75,0)
 S ZTSAVE("PXRMTOT")=""
"RTN","PXRMXQUE",76,0)
 S ZTSAVE("PXRMXTMP")=""
"RTN","PXRMXQUE",77,0)
 ; Time initiated
"RTN","PXRMXQUE",78,0)
 S ZTSAVE("PXRMXST")=""
"RTN","PXRMXQUE",79,0)
 ; New selection criteria
"RTN","PXRMXQUE",80,0)
 S ZTSAVE("PXRMOTM(")="",ZTSAVE("NOTM")=""
"RTN","PXRMXQUE",81,0)
 S ZTSAVE("PXRMPRV(")="",ZTSAVE("NPRV")=""
"RTN","PXRMXQUE",82,0)
 S ZTSAVE("PXRMPAT(")="",ZTSAVE("NPAT")=""
"RTN","PXRMXQUE",83,0)
 S ZTSAVE("PXRMPCM(")="",ZTSAVE("NPCM")=""
"RTN","PXRMXQUE",84,0)
 S ZTSAVE("PXRMREM(")="",ZTSAVE("NREM")=""
"RTN","PXRMXQUE",85,0)
 S ZTSAVE("PXRMRCAT(")="",ZTSAVE("NCAT")=""
"RTN","PXRMXQUE",86,0)
 S ZTSAVE("PXRMUSER")=""
"RTN","PXRMXQUE",87,0)
 ;Reminder list
"RTN","PXRMXQUE",88,0)
 S ZTSAVE("REMINDER(")=""
"RTN","PXRMXQUE",89,0)
 ; Arrays by IEN
"RTN","PXRMXQUE",90,0)
 S ZTSAVE("PXRMLOCN(")=""
"RTN","PXRMXQUE",91,0)
 S ZTSAVE("PXRMCSN(")=""
"RTN","PXRMXQUE",92,0)
 S ZTSAVE("PXRMCGRN(")=""
"RTN","PXRMXQUE",93,0)
 ;Patient List
"RTN","PXRMXQUE",94,0)
 S ZTSAVE("PATCREAT")=""
"RTN","PXRMXQUE",95,0)
 S ZTSAVE("PATLST")=""
"RTN","PXRMXQUE",96,0)
 S ZTSAVE("PXRMLIST(")=""
"RTN","PXRMXQUE",97,0)
 S ZTSAVE("PXRMLIS1")=""
"RTN","PXRMXQUE",98,0)
 S ZTSAVE("PLISTPUG")=""
"RTN","PXRMXQUE",99,0)
 ;User DUZ
"RTN","PXRMXQUE",100,0)
 S ZTSAVE("DBDUZ")=""
"RTN","PXRMXQUE",101,0)
 S ZTSAVE("DBERR")=""
"RTN","PXRMXQUE",102,0)
 S ZTSAVE("PXRMRERR(")=""
"RTN","PXRMXQUE",103,0)
 ;Dubug information
"RTN","PXRMXQUE",104,0)
 S ZTSAVE("PXRMDBUG")=""
"RTN","PXRMXQUE",105,0)
 S ZTSAVE("PXRMDBUS")=""
"RTN","PXRMXQUE",106,0)
 ;Patient Information
"RTN","PXRMXQUE",107,0)
 S ZTSAVE("PXRMTPAT")=""
"RTN","PXRMXQUE",108,0)
 S ZTSAVE("PXRMDPAT")=""
"RTN","PXRMXQUE",109,0)
 I +$G(PXRMIDOD)>0 S ZTSAVE("PXRMIDOD")=""
"RTN","PXRMXQUE",110,0)
 S ZTSAVE("PXRMPML")=""
"RTN","PXRMXQUE",111,0)
 S ZTSAVE("PXRMPER")=""
"RTN","PXRMXQUE",112,0)
 S ZTSAVE("PXRMCCS")=""
"RTN","PXRMXQUE",113,0)
 S ZTSAVE("PXRMXCCS")=""
"RTN","PXRMXQUE",114,0)
 I $D(^TMP("XM-MESS",$J)) S ZTSAVE("^TMP(""XM-MESS"",$J,")=""
"RTN","PXRMXQUE",115,0)
 Q
"RTN","PXRMXQUE",116,0)
 ;
"VER")
8.0^22.0
"^DD",811.4,811.4,0)
FIELD^^6^11
"^DD",811.4,811.4,0,"DDA")
N
"^DD",811.4,811.4,0,"DT")
3110614
"^DD",811.4,811.4,0,"ID",100)
W:$D(^(100)) "   ",@("$P($P($C(59)_$S($D(^DD(811.4,100,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(100),U,1)_"":"",2),$C(59),1)")
"^DD",811.4,811.4,0,"NM","REMINDER COMPUTED FINDINGS")

"^DD",811.4,811.4,0,"PT",810.31,.04)

"^DD",811.4,811.4,0,"PT",810.32,.01)

"^DD",811.4,811.4,0,"PT",811.52,.01)

"^DD",811.4,811.4,0,"PT",811.902,.01)

"^DD",811.4,811.4,0,"VRPK")
PXRM
"^DD",811.4,811.4,.01,0)
NAME^RFX^^0;1^K:$L(X)>64!($L(X)<3)!'(X'?1P.E)!('$$VNAME^PXRMINTR(.X)) X
"^DD",811.4,811.4,.01,.1)

"^DD",811.4,811.4,.01,1,0)
^.1^^0
"^DD",811.4,811.4,.01,3)
Answer must be 3-64 characters in length.
"^DD",811.4,811.4,.01,21,0)
^.001^2^2^3050117^^^^
"^DD",811.4,811.4,.01,21,1,0)
This is the name of the computed finding and is the name the User will
"^DD",811.4,811.4,.01,21,2,0)
use when adding a computed finding to a reminder definition or a term.
"^DD",811.4,811.4,.01,"DT")
3090529
"^DD",811.4,811.4,.02,0)
ROUTINE^F^^0;2^K:$L(X)>8!($L(X)<3) X
"^DD",811.4,811.4,.02,3)
Enter the M routine name.
"^DD",811.4,811.4,.02,8.5)
@
"^DD",811.4,811.4,.02,9)
@
"^DD",811.4,811.4,.02,21,0)
^.001^3^3^3050117^^^^
"^DD",811.4,811.4,.02,21,1,0)
This is the name of an M routine that contains the code for the
"^DD",811.4,811.4,.02,21,2,0)
computed finding. The entry point to use is specified in the ENTRY
"^DD",811.4,811.4,.02,21,3,0)
POINT field.
"^DD",811.4,811.4,.02,"DT")
2990526
"^DD",811.4,811.4,.03,0)
ENTRY POINT^F^^0;3^K:$L(X)>8!($L(X)<2) X
"^DD",811.4,811.4,.03,3)
Enter the entry point, must be 2-8 characters in length.
"^DD",811.4,811.4,.03,8.5)
@
"^DD",811.4,811.4,.03,9)
@
"^DD",811.4,811.4,.03,21,0)
^.001^2^2^3050117^^^^
"^DD",811.4,811.4,.03,21,1,0)
This is the entry point in the routine specified in the ROUTINE
"^DD",811.4,811.4,.03,21,2,0)
field.
"^DD",811.4,811.4,.03,"DT")
2990527
"^DD",811.4,811.4,.04,0)
PRINT NAME^F^^0;4^K:$L(X)>64!($L(X)<1) X
"^DD",811.4,811.4,.04,3)
Answer must be 1-64 characters in length.
"^DD",811.4,811.4,.04,21,0)
^.001^2^2^3100820^^^^
"^DD",811.4,811.4,.04,21,1,0)
The PRINT NAME will be displayed in the Clinical Maintenance output for
"^DD",811.4,811.4,.04,21,2,0)
computed findings.
"^DD",811.4,811.4,.04,"DT")
3100820
"^DD",811.4,811.4,1,0)
DESCRIPTION^811.41^^1;0
"^DD",811.4,811.4,1,21,0)
^.001^3^3^3110624^^^^
"^DD",811.4,811.4,1,21,1,0)
This is the description of the computed finding. It should explain its
"^DD",811.4,811.4,1,21,2,0)
purpose and how it is to be used including what data is returned for
"^DD",811.4,811.4,1,21,3,0)
use in a Condition.
"^DD",811.4,811.4,5,0)
TYPE^S^M:MULTIPLE;L:LIST;S:SINGLE;^0;5^Q
"^DD",811.4,811.4,5,21,0)
^^4^4^3050117^
"^DD",811.4,811.4,5,21,1,0)
This is the type of computed finding; the possible values are "S" for
"^DD",811.4,811.4,5,21,2,0)
single, "M" for multiple, and "L" for list. The default value is "S".
"^DD",811.4,811.4,5,21,3,0)
For a detailed explanation of the computed finding types see the
"^DD",811.4,811.4,5,21,4,0)
Clinical Reminder Manager manual.
"^DD",811.4,811.4,5,"DT")
3030129
"^DD",811.4,811.4,6,0)
CF PARAMETER REQUIRED^S^0:NO;1:YES;^0;6^Q
"^DD",811.4,811.4,6,3)
Enter 'YES' if the computed finding parameter must be defined for this computed finding to work.
"^DD",811.4,811.4,6,21,0)
^.001^9^9^3110620^^^
"^DD",811.4,811.4,6,21,1,0)
This field should be set to "YES" if the computed finding requires a
"^DD",811.4,811.4,6,21,2,0)
value in the COMPUTED FINDING PARAMETER (#6) field of the definition
"^DD",811.4,811.4,6,21,3,0)
or term in order to function properly. It is used by the integrity
"^DD",811.4,811.4,6,21,4,0)
checker to determine whether or not to issue an error if the
"^DD",811.4,811.4,6,21,5,0)
COMPUTED FINDING PARAMETER is not defined.
"^DD",811.4,811.4,6,21,6,0)

"^DD",811.4,811.4,6,21,7,0)
The default is "NO".
"^DD",811.4,811.4,6,21,8,0)

"^DD",811.4,811.4,6,21,9,0)

"^DD",811.4,811.4,6,"DT")
3110614
"^DD",811.4,811.4,100,0)
CLASS^RSX^N:NATIONAL;V:VISN;L:LOCAL;^100;1^K:'$$VCLASS^PXRMINTR(X) X
"^DD",811.4,811.4,100,3)
Enter the class.
"^DD",811.4,811.4,100,21,0)
^.001^4^4^3050117^^^^
"^DD",811.4,811.4,100,21,1,0)
This is the class of computed finding. Possible values are "N" for
"^DD",811.4,811.4,100,21,2,0)
national, "V" for VISN, and "L" for local. National computed findings
"^DD",811.4,811.4,100,21,3,0)
will be  prefixed with VA- and cannot be edited. Local or VISN entry
"^DD",811.4,811.4,100,21,4,0)
names cannot  start with VA-.
"^DD",811.4,811.4,100,"DT")
3010518
"^DD",811.4,811.4,101,0)
SPONSOR^P811.6^PXRMD(811.6,^100;2^Q
"^DD",811.4,811.4,101,3)
Enter the sponsor.
"^DD",811.4,811.4,101,21,0)
^.001^1^1^3050117^^
"^DD",811.4,811.4,101,21,1,0)
This is the organization or group that sponsors this computed finding.
"^DD",811.4,811.4,101,"DT")
3010419
"^DD",811.4,811.4,102,0)
REVIEW DATE^D^^100;3^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",811.4,811.4,102,3)
Enter the review date.
"^DD",811.4,811.4,102,21,0)
^.001^4^4^3050117^^
"^DD",811.4,811.4,102,21,1,0)
The REVIEW DATE is used to determine when the computed finding should
"^DD",811.4,811.4,102,21,2,0)
be reviewed to verify that it is current with the latest standards and
"^DD",811.4,811.4,102,21,3,0)
guidelines. You can find all computed findings whose review date has
"^DD",811.4,811.4,102,21,4,0)
passed using the Reminder Review Date report.
"^DD",811.4,811.4,102,"DT")
3010419
"^DD",811.4,811.4,110,0)
EDIT HISTORY^811.42D^^110;0
"^DD",811.4,811.4,110,21,0)
^.001^2^2^3050117^^^^
"^DD",811.4,811.4,110,21,1,0)
This multiple is used to record a history of changes made to the
"^DD",811.4,811.4,110,21,2,0)
computed finding.
"^DD",811.4,811.41,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",811.4,811.41,0,"DT")
3000405
"^DD",811.4,811.41,0,"NM","DESCRIPTION")

"^DD",811.4,811.41,0,"UP")
811.4
"^DD",811.4,811.41,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",811.4,811.41,.01,3)
Enter a description for this computed finding.
"^DD",811.4,811.41,.01,"DT")
3000405
"^DD",811.4,811.42,0)
EDIT HISTORY SUB-FIELD^^2^3
"^DD",811.4,811.42,0,"DT")
3010419
"^DD",811.4,811.42,0,"IX","B",811.42,.01)

"^DD",811.4,811.42,0,"NM","EDIT HISTORY")

"^DD",811.4,811.42,0,"UP")
811.4
"^DD",811.4,811.42,.01,0)
EDIT DATE^D^^0;1^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",811.4,811.42,.01,1,0)
^.1
"^DD",811.4,811.42,.01,1,1,0)
811.42^B
"^DD",811.4,811.42,.01,1,1,1)
S ^PXRMD(811.4,DA(1),110,"B",$E(X,1,30),DA)=""
"^DD",811.4,811.42,.01,1,1,2)
K ^PXRMD(811.4,DA(1),110,"B",$E(X,1,30),DA)
"^DD",811.4,811.42,.01,21,0)
^.001^2^2^3050117^^
"^DD",811.4,811.42,.01,21,1,0)
This is the date and time when editing was done. This field is set
"^DD",811.4,811.42,.01,21,2,0)
automatically and should not be changed by the user.
"^DD",811.4,811.42,.01,"DT")
3010419
"^DD",811.4,811.42,1,0)
EDIT BY^P200'^VA(200,^0;2^Q
"^DD",811.4,811.42,1,21,0)
^.001^2^2^3050117^^
"^DD",811.4,811.42,1,21,1,0)
This is the person who did the editing. This field is set automatically
"^DD",811.4,811.42,1,21,2,0)
and should not be changed by the user.
"^DD",811.4,811.42,1,"DT")
3010419
"^DD",811.4,811.42,2,0)
EDIT COMMENTS^811.422^^1;0
"^DD",811.4,811.42,2,21,0)
^.001^2^2^3050117^^^
"^DD",811.4,811.42,2,21,1,0)
This word-processing field can be used to record the changes made
"^DD",811.4,811.42,2,21,2,0)
during the editing session.
"^DD",811.4,811.42,2,"DT")
3010425
"^DD",811.4,811.422,0)
EDIT COMMENTS SUB-FIELD^^.01^1
"^DD",811.4,811.422,0,"DT")
3010419
"^DD",811.4,811.422,0,"NM","EDIT COMMENTS")

"^DD",811.4,811.422,0,"UP")
811.42
"^DD",811.4,811.422,.01,0)
EDIT COMMENTS^W^^0;1^Q
"^DD",811.4,811.422,.01,3)
Enter your edit comments.
"^DD",811.4,811.422,.01,"DT")
3010425
"^DD",811.8,811.8,0)
FIELD^^130^8
"^DD",811.8,811.8,0,"DDA")
N
"^DD",811.8,811.8,0,"DT")
3080125
"^DD",811.8,811.8,0,"NM","REMINDER EXCHANGE")

"^DD",811.8,811.8,0,"SCR")
I 0>1
"^DD",811.8,811.8,0,"VRPK")
PXRM
"^DD",811.8,811.8,.01,0)
NAME^RFX^^0;1^K:$L(X)>64!($L(X)<3)!'(X'?1P.E) X
"^DD",811.8,811.8,.01,.1)

"^DD",811.8,811.8,.01,1,0)
^.1^^0
"^DD",811.8,811.8,.01,3)
Do not edit this field.
"^DD",811.8,811.8,.01,21,0)
^.001^2^2^3050124^^^^
"^DD",811.8,811.8,.01,21,1,0)
This is the name of the entry in the Exchange File. It will be the same
"^DD",811.8,811.8,.01,21,2,0)
as the name of the reminder definition that was packed.
"^DD",811.8,811.8,.01,"DT")
3010601
"^DD",811.8,811.8,.02,0)
SOURCE^F^^0;2^K:$L(X)>64!($L(X)<3) X
"^DD",811.8,811.8,.02,3)
Do not edit this field.
"^DD",811.8,811.8,.02,21,0)
^.001^3^3^3070313^^^
"^DD",811.8,811.8,.02,21,1,0)
This is the source of the packed reminder. It will contain the name of
"^DD",811.8,811.8,.02,21,2,0)
the person who packed it and their site.
"^DD",811.8,811.8,.02,21,3,0)

"^DD",811.8,811.8,.02,"DT")
3000706
"^DD",811.8,811.8,.03,0)
DATE PACKED^D^^0;3^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",811.8,811.8,.03,3)
Do not edit this field.
"^DD",811.8,811.8,.03,21,0)
^.001^3^3^3050124^^^
"^DD",811.8,811.8,.03,21,1,0)
This is the date and time the reminder was originally packed. When a
"^DD",811.8,811.8,.03,21,2,0)
packed reminder is put into the Exchange File from a MailMan message or
"^DD",811.8,811.8,.03,21,3,0)
a host file, this will reflect the original packing date and time.
"^DD",811.8,811.8,.03,"DT")
3000712
"^DD",811.8,811.8,100,0)
PACKED REMINDER^811.801A^^100;0
"^DD",811.8,811.8,100,9)
@
"^DD",811.8,811.8,100,21,0)
^.001^1^1^3050126^^^^
"^DD",811.8,811.8,100,21,1,0)
This multiple stores the packed reminder definition in XML format.
"^DD",811.8,811.8,100,"DT")
3030312
"^DD",811.8,811.8,110,0)
DESCRIPTION^811.804^^110;0
"^DD",811.8,811.8,110,21,0)
^.001^4^4^3050124^^^^
"^DD",811.8,811.8,110,21,1,0)
This contains formatted information about the Exchange File entry. It
"^DD",811.8,811.8,110,21,2,0)
includes source information, a brief description, and keywords. This
"^DD",811.8,811.8,110,21,3,0)
information will be displayed when an entry is selected for possible
"^DD",811.8,811.8,110,21,4,0)
installation.
"^DD",811.8,811.8,119,0)
NUMBER OF UNIQUE COMPONENTS^NJ6,0^^119;1^K:+X'=X!(X>100000)!(X<0)!(X?.E1"."1N.N) X
"^DD",811.8,811.8,119,3)
Do not edit this field.
"^DD",811.8,811.8,119,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8,119,21,1,0)
This is the number of unique components in the packed reminder.
"^DD",811.8,811.8,119,"DT")
3030609
"^DD",811.8,811.8,120,0)
COMPONENT LIST^811.802A^^120;0
"^DD",811.8,811.8,120,21,0)
^.001^1^1^3080206^^^^
"^DD",811.8,811.8,120,21,1,0)
This is a list of components that are included in the packed reminder.
"^DD",811.8,811.8,130,0)
INSTALLATION HISTORY^811.803DA^^130;0
"^DD",811.8,811.8,130,21,0)
^.001^2^2^3070808^^^^
"^DD",811.8,811.8,130,21,1,0)
This multiple is used to record a history of packed reminder
"^DD",811.8,811.8,130,21,2,0)
installations.
"^DD",811.8,811.801,0)
PACKED REMINDER SUB-FIELD^^.01^1
"^DD",811.8,811.801,0,"DT")
3030609
"^DD",811.8,811.801,0,"IX","B",811.801,.01)

"^DD",811.8,811.801,0,"NM","PACKED REMINDER")

"^DD",811.8,811.801,0,"UP")
811.8
"^DD",811.8,811.801,.01,0)
XML DATA^WL^^0;1^Q
"^DD",811.8,811.801,.01,1,0)
^.1
"^DD",811.8,811.801,.01,1,1,0)
811.801^B
"^DD",811.8,811.801,.01,1,1,1)
S ^PXD(811.8,DA(1),100,"B",$E(X,1,30),DA)=""
"^DD",811.8,811.801,.01,1,1,2)
K ^PXD(811.8,DA(1),100,"B",$E(X,1,30),DA)
"^DD",811.8,811.801,.01,1,1,"DT")
3030415
"^DD",811.8,811.801,.01,3)
Do not edit this field.
"^DD",811.8,811.801,.01,9)
@
"^DD",811.8,811.801,.01,21,0)
^.001^1^1^3050126^^^^
"^DD",811.8,811.801,.01,21,1,0)
This is a line of XML data.
"^DD",811.8,811.801,.01,"DT")
3030609
"^DD",811.8,811.802,0)
COMPONENT LIST SUB-FIELD^^1^4
"^DD",811.8,811.802,0,"DT")
3080125
"^DD",811.8,811.802,0,"NM","COMPONENT LIST")

"^DD",811.8,811.802,0,"UP")
811.8
"^DD",811.8,811.802,.01,0)
COMPONENT^F^^0;1^K:$L(X)>64!($L(X)<1) X
"^DD",811.8,811.802,.01,1,0)
^.1^^0
"^DD",811.8,811.802,.01,3)
Do not edit this field.
"^DD",811.8,811.802,.01,21,0)
^.001^1^1^3050124^^^
"^DD",811.8,811.802,.01,21,1,0)
This is the name of the component; for example, ROUTINE or EDUCATION TOPIC.
"^DD",811.8,811.802,.01,"DT")
3050112
"^DD",811.8,811.802,.02,0)
FILE NUMBER^NJ14,4X^^0;2^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."5N.N) X
"^DD",811.8,811.802,.02,3)
Do not edit this field.
"^DD",811.8,811.802,.02,21,0)
^.001^2^2^3050126^^^^
"^DD",811.8,811.802,.02,21,1,0)
This is the file number of the component. If the component is a routine,
"^DD",811.8,811.802,.02,21,2,0)
then the file number will be 0.
"^DD",811.8,811.802,.02,"DT")
3050111
"^DD",811.8,811.802,.03,0)
NUMBER OF ITEMS^NJ4,0^^0;3^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",811.8,811.802,.03,3)
Do not edit this field.
"^DD",811.8,811.802,.03,21,0)
^.001^4^4^3050124^^^
"^DD",811.8,811.802,.03,21,1,0)
This is the number of this type of component that is included in the
"^DD",811.8,811.802,.03,21,2,0)
packed reminder. For example, if this particular component is Health
"^DD",811.8,811.802,.03,21,3,0)
Factors and there are three of them in the packed reminder, the NUMBER
"^DD",811.8,811.802,.03,21,4,0)
OF ITEMS would be 3.
"^DD",811.8,811.802,.03,"DT")
3001101
"^DD",811.8,811.802,1,0)
ITEM LIST^811.8021A^^1;0
"^DD",811.8,811.802,1,21,0)
^.001^3^3^3080206^^^^
"^DD",811.8,811.802,1,21,1,0)
This is the list of items of the component type. For example, if the
"^DD",811.8,811.802,1,21,2,0)
component type is Health Factors and there are three of them, the three
"^DD",811.8,811.802,1,21,3,0)
entries are specified in this list.
"^DD",811.8,811.8021,0)
ITEM LIST SUB-FIELD^^4^7
"^DD",811.8,811.8021,0,"DT")
3080125
"^DD",811.8,811.8021,0,"NM","ITEM LIST")

"^DD",811.8,811.8021,0,"UP")
811.802
"^DD",811.8,811.8021,.01,0)
ITEM^F^^0;1^K:$L(X)>64!($L(X)<1) X
"^DD",811.8,811.8021,.01,1,0)
^.1^^0
"^DD",811.8,811.8021,.01,3)
Do not edit this field.
"^DD",811.8,811.8021,.01,21,0)
^.001^1^1^3050124^^^
"^DD",811.8,811.8021,.01,21,1,0)
This is the name of the item.
"^DD",811.8,811.8021,.01,"DT")
3050112
"^DD",811.8,811.8021,.02,0)
START LINE^NJ6,0^^0;2^K:+X'=X!(X>100000)!(X<1)!(X?.E1"."1N.N) X
"^DD",811.8,811.8021,.02,3)
Do not edit this field.
"^DD",811.8,811.8021,.02,21,0)
^.001^1^1^3050124^^^
"^DD",811.8,811.8021,.02,21,1,0)
This is the line in node 100 where the data for this item starts.
"^DD",811.8,811.8021,.02,"DT")
3050124
"^DD",811.8,811.8021,.03,0)
END LINE^NJ6,0^^0;3^K:+X'=X!(X>100000)!(X<1)!(X?.E1"."1N.N) X
"^DD",811.8,811.8021,.03,3)
Do not edit this field.
"^DD",811.8,811.8021,.03,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8021,.03,21,1,0)
This is the line in node 100 where the data for this item ends.
"^DD",811.8,811.8021,.03,"DT")
3050124
"^DD",811.8,811.8021,1,0)
IEN ROOT START LINE^NJ6,0^^0;4^K:+X'=X!(X>100000)!(X<1)!(X?.E1"."1N.N) X
"^DD",811.8,811.8021,1,3)
Do not edit this field.
"^DD",811.8,811.8021,1,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8021,1,21,1,0)
This is the line in node 100 where the ien root for this item starts.
"^DD",811.8,811.8021,1,"DT")
3050124
"^DD",811.8,811.8021,2,0)
IEN ROOT END LINE^NJ6,0^^0;5^K:+X'=X!(X>100000)!(X<1)!(X?.E1"."1N.N) X
"^DD",811.8,811.8021,2,3)
Do not edit this field.
"^DD",811.8,811.8021,2,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8021,2,21,1,0)
This is the line in node 100 where the ien root ends.
"^DD",811.8,811.8021,2,"DT")
3050124
"^DD",811.8,811.8021,3,0)
OK TO INSTALL^S^0:NO;1:YES;^0;6^Q
"^DD",811.8,811.8021,3,21,0)
^^4^4^3080122^
"^DD",811.8,811.8021,3,21,1,0)
If this field is YES then the item can be installed. The value for
"^DD",811.8,811.8021,3,21,2,0)
this field is determined when the list of components and items in
"^DD",811.8,811.8021,3,21,3,0)
the Exchange File is built.
"^DD",811.8,811.8021,3,21,4,0)

"^DD",811.8,811.8021,3,"DT")
3080122
"^DD",811.8,811.8021,4,0)
SELECTABLE^S^0:NO;1:YES;^0;7^Q
"^DD",811.8,811.8021,4,21,0)
^.001^6^6^3080206^^
"^DD",811.8,811.8021,4,21,1,0)
If this field is marked YES then the item can be selected for
"^DD",811.8,811.8021,4,21,2,0)
installation. This will include all Clinical Reminder items selected
"^DD",811.8,811.8021,4,21,3,0)
for packing by the user, reminder dialogs that are linked to a reminder
"^DD",811.8,811.8021,4,21,4,0)
definition, and entries from files that are exchangeable.
"^DD",811.8,811.8021,4,21,5,0)

"^DD",811.8,811.8021,4,21,6,0)

"^DD",811.8,811.8021,4,"DT")
3080206
"^DD",811.8,811.803,0)
INSTALLATION HISTORY SUB-FIELD^^2^4
"^DD",811.8,811.803,0,"DT")
3070808
"^DD",811.8,811.803,0,"NM","INSTALLATION HISTORY")

"^DD",811.8,811.803,0,"UP")
811.8
"^DD",811.8,811.803,.01,0)
INSTALLATION DATE AND TIME^D^^0;1^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",811.8,811.803,.01,1,0)
^.1^^0
"^DD",811.8,811.803,.01,3)
Do not edit this field.
"^DD",811.8,811.803,.01,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.803,.01,21,1,0)
This is the date and time of the installation.
"^DD",811.8,811.803,.01,"DT")
3001121
"^DD",811.8,811.803,.02,0)
INSTALLED BY^F^^0;2^K:$L(X)>45!($L(X)<1) X
"^DD",811.8,811.803,.02,3)
Do not edit this field.
"^DD",811.8,811.803,.02,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.803,.02,21,1,0)
This is the person who did the installation.
"^DD",811.8,811.803,.02,"DT")
3001116
"^DD",811.8,811.803,1,0)
COMPONENT LIST^811.8031A^^1;0
"^DD",811.8,811.803,1,21,0)
^.001^2^2^3050124^^^
"^DD",811.8,811.803,1,21,1,0)
This multiple contains a list of the packed reminder components that
"^DD",811.8,811.803,1,21,2,0)
were selected as part of this installation.
"^DD",811.8,811.803,2,0)
INSTALLATION TYPE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",811.8,811.803,2,3)
Answer must be 1-30 characters in length.
"^DD",811.8,811.803,2,21,0)
^.001^3^3^3070808^^
"^DD",811.8,811.803,2,21,1,0)
This field is used to store the installation type.
"^DD",811.8,811.803,2,21,2,0)

"^DD",811.8,811.803,2,21,3,0)

"^DD",811.8,811.803,2,"DT")
3070808
"^DD",811.8,811.8031,0)
COMPONENT LIST SUB-FIELD^^5^6
"^DD",811.8,811.8031,0,"DT")
3010313
"^DD",811.8,811.8031,0,"IX","B",811.8031,.01)

"^DD",811.8,811.8031,0,"NM","COMPONENT LIST")

"^DD",811.8,811.8031,0,"UP")
811.803
"^DD",811.8,811.8031,.01,0)
INDEX^NJ6,0^^0;1^K:+X'=X!(X>100000)!(X<0)!(X?.E1"."1N.N) X
"^DD",811.8,811.8031,.01,1,0)
^.1
"^DD",811.8,811.8031,.01,1,1,0)
811.8031^B
"^DD",811.8,811.8031,.01,1,1,1)
S ^PXD(811.8,DA(2),130,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",811.8,811.8031,.01,1,1,2)
K ^PXD(811.8,DA(2),130,DA(1),1,"B",$E(X,1,30),DA)
"^DD",811.8,811.8031,.01,3)
Do not edit this field.
"^DD",811.8,811.8031,.01,21,0)
^.001^2^2^3050124^^^
"^DD",811.8,811.8031,.01,21,1,0)
This number corresponds to the item number in the List Manager display
"^DD",811.8,811.8031,.01,21,2,0)
of the components in the Exchange File entry.
"^DD",811.8,811.8031,.01,"DT")
3001115
"^DD",811.8,811.8031,1,0)
COMPONENT^F^^0;2^K:$L(X)>64!($L(X)<1) X
"^DD",811.8,811.8031,1,3)
Do not edit this field.
"^DD",811.8,811.8031,1,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8031,1,21,1,0)
This is the type of component, Education Topic, Health Factor, etc.
"^DD",811.8,811.8031,1,"DT")
3001115
"^DD",811.8,811.8031,2,0)
ITEM^F^^0;3^K:$L(X)>64!($L(X)<1) X
"^DD",811.8,811.8031,2,3)
Do not edit this field.
"^DD",811.8,811.8031,2,21,0)
^.001^2^2^3050124^^
"^DD",811.8,811.8031,2,21,1,0)
This is the name of the component. For example, if the component is
"^DD",811.8,811.8031,2,21,2,0)
a Health Factor then this is the name of the Health Factor.
"^DD",811.8,811.8031,2,"DT")
3001115
"^DD",811.8,811.8031,3,0)
ACTION^F^^0;4^K:$L(X)>4!($L(X)<1) X
"^DD",811.8,811.8031,3,3)
Do not edit this field.
"^DD",811.8,811.8031,3,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8031,3,21,1,0)
This is the action that was taken with the item.
"^DD",811.8,811.8031,3,"DT")
3001115
"^DD",811.8,811.8031,4,0)
NEWNAME^F^^0;5^K:$L(X)>64!($L(X)<1) X
"^DD",811.8,811.8031,4,3)
Do not edit this field.
"^DD",811.8,811.8031,4,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.8031,4,21,1,0)
If the item was copied to a new name then the new name is stored here.
"^DD",811.8,811.8031,4,"DT")
3001115
"^DD",811.8,811.8031,5,0)
ADDITIONAL DETAILS^811.80315A^^1;0
"^DD",811.8,811.8031,5,21,0)
^.001^3^3^3050124^^^
"^DD",811.8,811.8031,5,21,1,0)
This multiple is used to store additional details about the
"^DD",811.8,811.8031,5,21,2,0)
installation. As an example, if a finding in a reminder definition is
"^DD",811.8,811.8031,5,21,3,0)
replaced with another finding that information is stored here.
"^DD",811.8,811.80315,0)
ADDITIONAL DETAILS SUB-FIELD^^.01^1
"^DD",811.8,811.80315,0,"DT")
3010313
"^DD",811.8,811.80315,0,"IX","B",811.80315,.01)

"^DD",811.8,811.80315,0,"NM","ADDITIONAL DETAILS")

"^DD",811.8,811.80315,0,"UP")
811.8031
"^DD",811.8,811.80315,.01,0)
ADDITIONAL DETAILS^F^^0;1^K:$L(X)>80!($L(X)<1) X
"^DD",811.8,811.80315,.01,1,0)
^.1
"^DD",811.8,811.80315,.01,1,1,0)
811.80315^B
"^DD",811.8,811.80315,.01,1,1,1)
S ^PXD(811.8,DA(3),130,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",811.8,811.80315,.01,1,1,2)
K ^PXD(811.8,DA(3),130,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",811.8,811.80315,.01,3)
Do not edit this field.
"^DD",811.8,811.80315,.01,21,0)
^.001^1^1^3050124^^
"^DD",811.8,811.80315,.01,21,1,0)
This is a line of additional information.
"^DD",811.8,811.80315,.01,"DT")
3010313
"^DD",811.8,811.804,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",811.8,811.804,0,"DT")
3001221
"^DD",811.8,811.804,0,"NM","DESCRIPTION")

"^DD",811.8,811.804,0,"UP")
811.8
"^DD",811.8,811.804,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",811.8,811.804,.01,3)
Do not edit this field.
"^DD",811.8,811.804,.01,"DT")
3001221
"^DIC",811.4,811.4,0)
REMINDER COMPUTED FINDINGS^811.4
"^DIC",811.4,811.4,0,"GL")
^PXRMD(811.4,
"^DIC",811.4,811.4,"%",0)
^1.005^^0
"^DIC",811.4,811.4,"%D",0)
^1.001^28^28^3110614^^^^
"^DIC",811.4,811.4,"%D",1,0)
When none of the standard Clinical Reminder finding types will work, a
"^DIC",811.4,811.4,"%D",2,0)
computed finding can be created. There are two steps in creating a
"^DIC",811.4,811.4,"%D",3,0)
computed finding. First a MUMPS routine must be written. Information
"^DIC",811.4,811.4,"%D",4,0)
about how to do this can be found in the Clinical Reminders Manager
"^DIC",811.4,811.4,"%D",5,0)
Manual. The second step is to make an entry in this file, which
"^DIC",811.4,811.4,"%D",6,0)
contains a list of reminder computed findings. There are four fields
"^DIC",811.4,811.4,"%D",7,0)
for each entry; they are:
"^DIC",811.4,811.4,"%D",8,0)
 
"^DIC",811.4,811.4,"%D",9,0)
NAME - this is the name of the computed finding. When adding a computed
"^DIC",811.4,811.4,"%D",10,0)
finding as finding to a reminder definition or term, it is done using
"^DIC",811.4,811.4,"%D",11,0)
the name. For example, you would type CF.VA-BMI to add the exported
"^DIC",811.4,811.4,"%D",12,0)
VA-BMI computed finding to your reminder definition.
"^DIC",811.4,811.4,"%D",13,0)
 
"^DIC",811.4,811.4,"%D",14,0)
ROUTINE - this is the name of the MUMPS routine.
"^DIC",811.4,811.4,"%D",15,0)
 
"^DIC",811.4,811.4,"%D",16,0)
ENTRY - this is the entry point in the MUMPS routine.
"^DIC",811.4,811.4,"%D",17,0)
 
"^DIC",811.4,811.4,"%D",18,0)
PRINT NAME - this will be displayed on the Clinical Maintenance
"^DIC",811.4,811.4,"%D",19,0)
component as the name of the computed finding. If it is blank, then NAME
"^DIC",811.4,811.4,"%D",20,0)
will be used.
"^DIC",811.4,811.4,"%D",21,0)

"^DIC",811.4,811.4,"%D",22,0)
TYPE - this is a set of codes that specifies what type of computed
"^DIC",811.4,811.4,"%D",23,0)
finding this is. "S" stands for single occurrence, "M" for multiple occurrence,
"^DIC",811.4,811.4,"%D",24,0)
and "L" for list. If it is blank, single will be assumed.
"^DIC",811.4,811.4,"%D",25,0)

"^DIC",811.4,811.4,"%D",26,0)
This file contains a combination of nationally distributed and local
"^DIC",811.4,811.4,"%D",27,0)
entries. Nationally distributed entries have their name prefixed with
"^DIC",811.4,811.4,"%D",28,0)
VA-. Local entry names cannot start with VA-.
"^DIC",811.4,"B","REMINDER COMPUTED FINDINGS",811.4)

"^DIC",811.8,811.8,0)
REMINDER EXCHANGE^811.8
"^DIC",811.8,811.8,0,"GL")
^PXD(811.8,
"^DIC",811.8,811.8,"%",0)
^1.005^^0
"^DIC",811.8,811.8,"%D",0)
^1.001^3^3^3050126^^^^
"^DIC",811.8,811.8,"%D",1,0)
The Reminder Exchange File is used to store packed reminder
"^DIC",811.8,811.8,"%D",2,0)
definitions. All the entries in this file are managed by the
"^DIC",811.8,811.8,"%D",3,0)
Reminder Exchange Utility and should never be edited by hand.
"^DIC",811.8,"B","REMINDER EXCHANGE",811.8)

**END**
**END**
