Released LEX*2*81 SEQ #73
Extracted from mail message
**KIDS**:LEX*2.0*81^

**INSTALL NAME**
LEX*2.0*81
"BLD",8149,0)
LEX*2.0*81^LEXICON UTILITY^0^3110817^y
"BLD",8149,1,0)
^^2^2^3110802^
"BLD",8149,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",8149,1,2,0)
included in this patch.
"BLD",8149,4,0)
^9.64PA^757.02^1
"BLD",8149,4,757.02,0)
757.02
"BLD",8149,4,757.02,2,0)
^9.641^757.02^1
"BLD",8149,4,757.02,2,757.02,0)
CODES  (File-top level)
"BLD",8149,4,757.02,2,757.02,1,0)
^9.6411^2^1
"BLD",8149,4,757.02,2,757.02,1,2,0)
CLASSIFICATION SOURCE
"BLD",8149,4,757.02,222)
y^y^p^^^^n^^n
"BLD",8149,4,757.02,224)

"BLD",8149,4,"APDD",757.02,757.02)

"BLD",8149,4,"APDD",757.02,757.02,2)

"BLD",8149,4,"B",757.02,757.02)

"BLD",8149,6.3)
1
"BLD",8149,"INI")

"BLD",8149,"INIT")
POST^LEX2081P
"BLD",8149,"KRN",0)
^9.67PA^779.2^20
"BLD",8149,"KRN",.4,0)
.4
"BLD",8149,"KRN",.4,"NM",0)
^9.68A^^
"BLD",8149,"KRN",.401,0)
.401
"BLD",8149,"KRN",.401,"NM",0)
^9.68A^^
"BLD",8149,"KRN",.402,0)
.402
"BLD",8149,"KRN",.403,0)
.403
"BLD",8149,"KRN",.5,0)
.5
"BLD",8149,"KRN",.84,0)
.84
"BLD",8149,"KRN",3.6,0)
3.6
"BLD",8149,"KRN",3.8,0)
3.8
"BLD",8149,"KRN",9.2,0)
9.2
"BLD",8149,"KRN",9.8,0)
9.8
"BLD",8149,"KRN",9.8,"NM",0)
^9.68A^30^30
"BLD",8149,"KRN",9.8,"NM",1,0)
LEXRX^^0^B25440682
"BLD",8149,"KRN",9.8,"NM",2,0)
LEXRXA^^0^B14298023
"BLD",8149,"KRN",9.8,"NM",3,0)
LEXRXB^^0^B52650110
"BLD",8149,"KRN",9.8,"NM",4,0)
LEXRXC^^0^B104836918
"BLD",8149,"KRN",9.8,"NM",5,0)
LEXRXC2^^0^B70264191
"BLD",8149,"KRN",9.8,"NM",6,0)
LEXRXC3^^0^B17043792
"BLD",8149,"KRN",9.8,"NM",7,0)
LEXRXD^^0^B72163787
"BLD",8149,"KRN",9.8,"NM",8,0)
LEXRXD2^^0^B31445330
"BLD",8149,"KRN",9.8,"NM",9,0)
LEXRXD3^^0^B23248019
"BLD",8149,"KRN",9.8,"NM",10,0)
LEXRXD4^^0^B78250103
"BLD",8149,"KRN",9.8,"NM",11,0)
LEXRXE^^0^B59805790
"BLD",8149,"KRN",9.8,"NM",12,0)
LEXRXF^^0^B89637737
"BLD",8149,"KRN",9.8,"NM",13,0)
LEXRXG^^0^B75572745
"BLD",8149,"KRN",9.8,"NM",14,0)
LEXRXG2^^0^B52721583
"BLD",8149,"KRN",9.8,"NM",15,0)
LEXRXG3^^0^B26643925
"BLD",8149,"KRN",9.8,"NM",16,0)
LEXRXS^^0^B47423657
"BLD",8149,"KRN",9.8,"NM",17,0)
LEXRXS2^^0^B52432847
"BLD",8149,"KRN",9.8,"NM",18,0)
LEXRXXA^^0^B26020561
"BLD",8149,"KRN",9.8,"NM",19,0)
LEXRXXM^^0^B57887286
"BLD",8149,"KRN",9.8,"NM",20,0)
LEXRXXM2^^0^B20334656
"BLD",8149,"KRN",9.8,"NM",21,0)
LEXRXXP^^0^B22174903
"BLD",8149,"KRN",9.8,"NM",22,0)
LEXRXXS^^0^B124182348
"BLD",8149,"KRN",9.8,"NM",23,0)
LEXRXXT^^0^B66601968
"BLD",8149,"KRN",9.8,"NM",24,0)
LEXRXXT2^^0^B40427433
"BLD",8149,"KRN",9.8,"NM",25,0)
LEXRXXT3^^0^B2392111
"BLD",8149,"KRN",9.8,"NM",26,0)
LEXSRC^^0^B6746638
"BLD",8149,"KRN",9.8,"NM",27,0)
LEX2081^^0^B88540708
"BLD",8149,"KRN",9.8,"NM",28,0)
LEX2081P^^0^B21788237
"BLD",8149,"KRN",9.8,"NM",29,0)
LEXDM^^0^B14264609
"BLD",8149,"KRN",9.8,"NM",30,0)
LEX2081A^^0^B14855038
"BLD",8149,"KRN",9.8,"NM","B","LEX2081",27)

"BLD",8149,"KRN",9.8,"NM","B","LEX2081A",30)

"BLD",8149,"KRN",9.8,"NM","B","LEX2081P",28)

"BLD",8149,"KRN",9.8,"NM","B","LEXDM",29)

"BLD",8149,"KRN",9.8,"NM","B","LEXRX",1)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXA",2)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXB",3)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXC",4)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXC2",5)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXC3",6)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXD",7)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXD2",8)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXD3",9)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXD4",10)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXE",11)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXF",12)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXG",13)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXG2",14)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXG3",15)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXS",16)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXS2",17)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXA",18)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXM",19)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXM2",20)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXP",21)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXS",22)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXT",23)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXT2",24)

"BLD",8149,"KRN",9.8,"NM","B","LEXRXXT3",25)

"BLD",8149,"KRN",9.8,"NM","B","LEXSRC",26)

"BLD",8149,"KRN",19,0)
19
"BLD",8149,"KRN",19.1,0)
19.1
"BLD",8149,"KRN",101,0)
101
"BLD",8149,"KRN",409.61,0)
409.61
"BLD",8149,"KRN",771,0)
771
"BLD",8149,"KRN",779.2,0)
779.2
"BLD",8149,"KRN",870,0)
870
"BLD",8149,"KRN",8989.51,0)
8989.51
"BLD",8149,"KRN",8989.52,0)
8989.52
"BLD",8149,"KRN",8994,0)
8994
"BLD",8149,"KRN","B",.4,.4)

"BLD",8149,"KRN","B",.401,.401)

"BLD",8149,"KRN","B",.402,.402)

"BLD",8149,"KRN","B",.403,.403)

"BLD",8149,"KRN","B",.5,.5)

"BLD",8149,"KRN","B",.84,.84)

"BLD",8149,"KRN","B",3.6,3.6)

"BLD",8149,"KRN","B",3.8,3.8)

"BLD",8149,"KRN","B",9.2,9.2)

"BLD",8149,"KRN","B",9.8,9.8)

"BLD",8149,"KRN","B",19,19)

"BLD",8149,"KRN","B",19.1,19.1)

"BLD",8149,"KRN","B",101,101)

"BLD",8149,"KRN","B",409.61,409.61)

"BLD",8149,"KRN","B",771,771)

"BLD",8149,"KRN","B",779.2,779.2)

"BLD",8149,"KRN","B",870,870)

"BLD",8149,"KRN","B",8989.51,8989.51)

"BLD",8149,"KRN","B",8989.52,8989.52)

"BLD",8149,"KRN","B",8994,8994)

"BLD",8149,"PRE")
LEX2081
"BLD",8149,"QDEF")
^^^^NO^^^^^^NO
"BLD",8149,"QUES",0)
^9.62^^
"BLD",8149,"REQB",0)
^9.611^1^1
"BLD",8149,"REQB",1,0)
LEX*2.0*73^2
"BLD",8149,"REQB","B","LEX*2.0*73",1)

"FIA",757.02)
CODES
"FIA",757.02,0)
^LEX(757.02,
"FIA",757.02,0,0)
757.02IP
"FIA",757.02,0,1)
y^y^p^^^^n^^n
"FIA",757.02,0,10)

"FIA",757.02,0,11)

"FIA",757.02,0,"RLRO")

"FIA",757.02,0,"VR")
2.0^LEX
"FIA",757.02,757.02)
1
"FIA",757.02,757.02,2)

"INIT")
POST^LEX2081P
"MBREQ")
0
"PKG",574,-1)
1^1
"PKG",574,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.
"PKG",574,20,0)
^9.402P^^
"PKG",574,22,0)
^9.49I^1^1
"PKG",574,22,1,0)
2.0^2960915^2970127^1
"PKG",574,22,1,"PAH",1,0)
81^3110817
"PKG",574,22,1,"PAH",1,1,0)
^^2^2^3110817
"PKG",574,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",574,22,1,"PAH",1,1,2,0)
included in this patch.
"PRE")
LEX2081
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
30
"RTN","LEX2081")
0^27^B88540708^n/a
"RTN","LEX2081",1,0)
LEX2081 ;ISL/KER - LEX*2.0*81 Env Check ;08/17/2011
"RTN","LEX2081",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEX2081",3,0)
 ;               
"RTN","LEX2081",4,0)
 ; Global Variables
"RTN","LEX2081",5,0)
 ;    None
"RTN","LEX2081",6,0)
 ;               
"RTN","LEX2081",7,0)
 ; External References
"RTN","LEX2081",8,0)
 ;    DESC^%ZTLOAD        ICR  10063
"RTN","LEX2081",9,0)
 ;    STAT^%ZTLOAD        ICR  10063
"RTN","LEX2081",10,0)
 ;    FIND^DIC            ICR   2051
"RTN","LEX2081",11,0)
 ;    $$IENS^DILF         ICR   2054
"RTN","LEX2081",12,0)
 ;    EN^DIQ1             ICR  10015
"RTN","LEX2081",13,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEX2081",14,0)
 ;    $$PATCH^XPDUTL      ICR  10141
"RTN","LEX2081",15,0)
 ;    $$VERSION^XPDUTL    ICR  10141
"RTN","LEX2081",16,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2081",17,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2081",18,0)
 ;               
"RTN","LEX2081",19,0)
 ; Local Variables Killed by Kernel after Install
"RTN","LEX2081",20,0)
 ;     XPDABORT,XPDDIQ,XPDQUIT
"RTN","LEX2081",21,0)
 ;               
"RTN","LEX2081",22,0)
 ; see Kernel Developer Guide
"RTN","LEX2081",23,0)
 ;     Chapter 14, KIDS Developer Tools
"RTN","LEX2081",24,0)
 ;     Advanced Build Techniques
"RTN","LEX2081",25,0)
 ;               
"RTN","LEX2081",26,0)
ENV ; Environment Check
"RTN","LEX2081",27,0)
 ;                    
"RTN","LEX2081",28,0)
 ;   General
"RTN","LEX2081",29,0)
 ;
"RTN","LEX2081",30,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXG,LEXE,LEXSTR D IMP
"RTN","LEX2081",31,0)
 K XPDDIQ("XPZ1","B"),XPDDIQ("XPI1","B") S XPDDIQ("XPZ1","B")="NO",XPDDIQ("XPI1","B")="NO"
"RTN","LEX2081",32,0)
 S LEXSTR=$G(LEXPTYPE) S:$L($G(LEXFY))&($L($G(LEXQTR))) LEXSTR=LEXSTR_" for "_$G(LEXFY)_" "_$G(LEXQTR)_" Quarter"
"RTN","LEX2081",33,0)
 D BM(LEXSTR),M("")
"RTN","LEX2081",34,0)
 S U="^"
"RTN","LEX2081",35,0)
 ;     No user
"RTN","LEX2081",36,0)
 D:+($$UR)'>0 ET("User not defined (DUZ)")
"RTN","LEX2081",37,0)
 ;     No IO
"RTN","LEX2081",38,0)
 D:+($$SY)'>0 ET("Undefined IO variable(s)")
"RTN","LEX2081",39,0)
 I $D(LEXE) D ABRT Q
"RTN","LEX2081",40,0)
 ;                    
"RTN","LEX2081",41,0)
 ;   Load Distribution
"RTN","LEX2081",42,0)
 ;
"RTN","LEX2081",43,0)
 ;     XPDENV = 0 Environment Check during Load
"RTN","LEX2081",44,0)
 ;
"RTN","LEX2081",45,0)
 ;       Check Version (2.0)
"RTN","LEX2081",46,0)
 I $$VERSION^XPDUTL("LEX")'="2.0" D  D ABRT Q
"RTN","LEX2081",47,0)
 . D ET("Version 2.0 not found.  Please install Lexicon Utility v 2.0")
"RTN","LEX2081",48,0)
 ;       Check Required Patches
"RTN","LEX2081",49,0)
 D:'$L($G(LEXREQP)) IMP I $L(LEXREQP) D
"RTN","LEX2081",50,0)
 . N LEXPAT,LEXI,LEXPN,LEXP,LEXR,LEXC,LEXO,LEXC1,LEXC2,LEXC3 S (LEXR,LEXC)=0 S LEXC1=5,(LEXC2,LEXC3)=20
"RTN","LEX2081",51,0)
 . F LEXI=1:1 Q:'$L($P(LEXREQP,";",LEXI))  S LEXC=LEXC+1,LEXPAT=$P(LEXREQP,";",LEXI) S:$P(LEXPAT,"^",2)?7N LEXR=LEXR+1,LEXC3=LEXC2+13
"RTN","LEX2081",52,0)
 . F LEXI=1:1 Q:'$L($P(LEXREQP,";",LEXI))  S LEXPAT=$P(LEXREQP,";",LEXI) D
"RTN","LEX2081",53,0)
 . . N LEXREL,LEXINS,LEXINE S LEXREL=$P(LEXPAT,"^",2),LEXPAT=$P(LEXPAT,"^",1)
"RTN","LEX2081",54,0)
 . . S LEXPN=$$PATCH^XPDUTL(LEXPAT),LEXINS=$$INS(LEXPAT),LEXINE=$P(LEXINS,"^",2)
"RTN","LEX2081",55,0)
 . . W:LEXI=1 !,?3,"Checking for ",?LEXC2,$S(+($G(LEXR))>0:"Released",1:"")
"RTN","LEX2081",56,0)
 . . W !,?LEXC1,LEXPAT
"RTN","LEX2081",57,0)
 . . I LEXREL?7N W ?LEXC2,$TR($$FMTE^XLFDT(LEXREL,"5DZ"),"@"," ")
"RTN","LEX2081",58,0)
 . . I +LEXPN>0 H 1 S LEXO=+($G(LEXO))+1 W ?LEXC3,"Installed " W:$L($G(LEXINE)) LEXINE
"RTN","LEX2081",59,0)
 . . I +LEXPN'>0 D ET((" "_LEXPAT_" not found, please install "_LEXPAT_" before continuing"))
"RTN","LEX2081",60,0)
 . W:+($G(LEXO))'=LEXC !
"RTN","LEX2081",61,0)
 I $D(LEXE) D ABRT Q
"RTN","LEX2081",62,0)
 S LEXG=$$RGBL
"RTN","LEX2081",63,0)
 I $D(LEXE)&(+LEXG=0) D ABRT Q
"RTN","LEX2081",64,0)
 I $D(LEXE)&(+LEXG<0) D ABRT Q
"RTN","LEX2081",65,0)
 I '$D(LEXFULL)&(+($G(XPDENV))'=1) D QUIT Q
"RTN","LEX2081",66,0)
 ;                    
"RTN","LEX2081",67,0)
 ;   Install Package(s)
"RTN","LEX2081",68,0)
 ;
"RTN","LEX2081",69,0)
 ;     XPDENV = 1 Environment Check during Install
"RTN","LEX2081",70,0)
 ;
"RTN","LEX2081",71,0)
 N LEXIT S LEXIT=0
"RTN","LEX2081",72,0)
 ;       Checking Previous Install Task
"RTN","LEX2081",73,0)
 D:+($G(XPDENV))=1 TASK I $D(LEXE) D ABRT Q
"RTN","LEX2081",74,0)
 ;       Checking Global "Write" Protection 
"RTN","LEX2081",75,0)
 D:+($G(XPDENV))=1 GBLS I $D(LEXE) D ABRT Q
"RTN","LEX2081",76,0)
 ;                    
"RTN","LEX2081",77,0)
 ;   Quit, Exit or Abort
"RTN","LEX2081",78,0)
 ;
"RTN","LEX2081",79,0)
QUIT ;     Quit   Passed Environment Check
"RTN","LEX2081",80,0)
 K LEXFULL D OK
"RTN","LEX2081",81,0)
 Q
"RTN","LEX2081",82,0)
EXIT ;     Exit   Failed Environment Check
"RTN","LEX2081",83,0)
 D:$D(LEXE) ED S XPDQUIT=2 K LEXE,LEXFULL Q
"RTN","LEX2081",84,0)
ABRT ;     Abort  Failed Environment Check, KILL the distribution
"RTN","LEX2081",85,0)
 D:$D(LEXE) ED S XPDABORT=1,XPDQUIT=1 S:$L($G(LEXBUILD)) XPDQUIT(LEXBUILD)=1
"RTN","LEX2081",86,0)
 K LEXE,LEXFULL
"RTN","LEX2081",87,0)
 Q
"RTN","LEX2081",88,0)
 ;
"RTN","LEX2081",89,0)
ENV2 ; Environment Check (for testing only)
"RTN","LEX2081",90,0)
 N XPDENV S XPDENV=1 D ENV
"RTN","LEX2081",91,0)
 Q
"RTN","LEX2081",92,0)
 ;               
"RTN","LEX2081",93,0)
 ; Checks
"RTN","LEX2081",94,0)
 ;
"RTN","LEX2081",95,0)
GBLS ;   Check Write access on globals
"RTN","LEX2081",96,0)
 N LEXB1,LEXB2,LEXE,LEXGBL,LEXRT,LEXT,LEXF,LEXI,LEXX,LEXOK,LEXS,X S LEXOK=1
"RTN","LEX2081",97,0)
 D BM("   I will now check the protection for the Lexicon global ^LEX.  If you")
"RTN","LEX2081",98,0)
 D M("   get an ERROR, you will need to change the protection on this global")
"RTN","LEX2081",99,0)
 D M("   to allow read/write as indicated:")
"RTN","LEX2081",100,0)
 D BM("                        Owner     Group    World   Network")
"RTN","LEX2081",101,0)
 D M("      Cache systems      RWD       RW       RW      RWD")
"RTN","LEX2081",102,0)
 D BM("   Checking:"),M(" ")
"RTN","LEX2081",103,0)
 S LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2081",104,0)
 . S LEXX="" S LEXE="S LEXX=$T(GD+"_LEXI_")" X LEXE S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2081",105,0)
 . S LEXGBL=$P(LEXX,";",3) S LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2081",106,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(19-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2081",107,0)
 . I '$D(@LEXGBL) D RGNF S LEXOK=0 D M(("      <"_LEXRT_" not found>")) Q
"RTN","LEX2081",108,0)
 . D M(("      "_LEXRT_LEXB1_LEXT_LEXB2_LEXF)) S @LEXGBL=$G(@LEXGBL) H 1
"RTN","LEX2081",109,0)
 D:LEXOK M("    --> ok") D:'LEXOK M("    ??") D M(" ")
"RTN","LEX2081",110,0)
 Q
"RTN","LEX2081",111,0)
RGBL(X) ;   Check Write access on globals
"RTN","LEX2081",112,0)
 N LEXS,LEXI,LEXX,LEXEC,LEXGBL,LEXRT,LEXT,LEXF,LEXB1,LEXB2
"RTN","LEX2081",113,0)
 S LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2081",114,0)
 . S LEXX="" S LEXEC="S LEXX=$T(GD+"_LEXI_")" X LEXEC S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2081",115,0)
 . S LEXGBL=$P(LEXX,";",3) S LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2081",116,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(15-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2081",117,0)
 . I '$D(@LEXGBL) S:LEXS'[LEXRT LEXS=LEXS_", "_LEXRT S X=-1
"RTN","LEX2081",118,0)
 I $L(LEXS),X'>0 D
"RTN","LEX2081",119,0)
 . S:LEXS[", " LEXS=$P(LEXS,", ",1,($L(LEXS,", ")-1))_" and "_$P(LEXS,", ",$L(LEXS,", "))
"RTN","LEX2081",120,0)
 . S:$E(LEXS,1,2)=", " LEXS=$E(LEXS,3,$L(LEXS)) S:$E(LEXS,1,7)[" and " LEXS=$P(LEXS," and ",2)
"RTN","LEX2081",121,0)
 . D:X=-1 ET(("Global"_$S(LEXS[", "!(LEXS[" and "):"s",1:"")_" "_LEXS_" either not found or incomplete."))
"RTN","LEX2081",122,0)
 Q X
"RTN","LEX2081",123,0)
RGNF ;   Required global not found
"RTN","LEX2081",124,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP
"RTN","LEX2081",125,0)
 D:$G(LEXGBL)["^LEX" ET(""),ET("Required global "_$P($G(LEXGBL),"(",1)_" not found.")
"RTN","LEX2081",126,0)
 Q
"RTN","LEX2081",127,0)
TASK ;   Check for Task
"RTN","LEX2081",128,0)
 D BM("   Checking to see if a previous post-installation is still running")
"RTN","LEX2081",129,0)
 N LEXLIST,LEXNAM,LEXRUN,LEXSTA1,LEXSTA2,LEXT1,LEXT2,LEXTSK,ZTSK
"RTN","LEX2081",130,0)
 S LEXNAM="Lexicon Rebuild AVA Cross-Reference" K LEXLIST D DESC^%ZTLOAD(LEXNAM,"LEXLIST")
"RTN","LEX2081",131,0)
 S LEXRUN=0,(LEXSTA1,LEXSTA2)="" S LEXTSK=0 F  S LEXTSK=$O(LEXLIST(LEXTSK)) Q:+LEXTSK'>0  D  Q:+LEXRUN>0
"RTN","LEX2081",132,0)
 . N ZTSK S ZTSK=LEXTSK Q:+($G(ZTSK))'>0  D STAT^%ZTLOAD Q:+($G(ZTSK(0)))'>0
"RTN","LEX2081",133,0)
 . I +($G(ZTSK(1)))=1 S LEXRUN=LEXTSK,LEXSTA1="is scheduled",LEXSTA2="Please wait until this task has started and completed"
"RTN","LEX2081",134,0)
 . I +($G(ZTSK(1)))=2 S LEXRUN=LEXTSK,LEXSTA1="is running",LEXSTA2="Please wait until this task has completed"
"RTN","LEX2081",135,0)
 I +LEXRUN>0 D
"RTN","LEX2081",136,0)
 . S:'$L(LEXSTA1) LEXSTA1="is running" S:'$L(LEXSTA2) LEXSTA2="Please wait until this task has completed"
"RTN","LEX2081",137,0)
 . N LEXT1,LEXT2 S LEXT1=" Task #"_LEXRUN_" "_$G(LEXSTA1)
"RTN","LEX2081",138,0)
 . S:$L($G(LEXNAM)) LEXT1=" Task #"_LEXRUN_" """_LEXNAM_""" "_$G(LEXSTA1)
"RTN","LEX2081",139,0)
 . S LEXT2=" "_LEXSTA2 D ET(LEXT1),ET(LEXT2)
"RTN","LEX2081",140,0)
 S LEXNAM="Lexicon Rebuild AWRD Cross-Reference" K LEXLIST D DESC^%ZTLOAD(LEXNAM,"LEXLIST")
"RTN","LEX2081",141,0)
 S LEXRUN=0,(LEXSTA1,LEXSTA2)="" S LEXTSK=0 F  S LEXTSK=$O(LEXLIST(LEXTSK)) Q:+LEXTSK'>0  D  Q:+LEXRUN>0
"RTN","LEX2081",142,0)
 . N ZTSK S ZTSK=LEXTSK Q:+($G(ZTSK))'>0  D STAT^%ZTLOAD Q:+($G(ZTSK(0)))'>0
"RTN","LEX2081",143,0)
 . I +($G(ZTSK(1)))=1 S LEXRUN=LEXTSK,LEXSTA1="is scheduled",LEXSTA2="Please wait until this task has started and completed"
"RTN","LEX2081",144,0)
 . I +($G(ZTSK(1)))=2 S LEXRUN=LEXTSK,LEXSTA1="is running",LEXSTA2="Please wait until this task has completed"
"RTN","LEX2081",145,0)
 I +LEXRUN>0 D
"RTN","LEX2081",146,0)
 . S:'$L(LEXSTA1) LEXSTA1="is running" S:'$L(LEXSTA2) LEXSTA2="Please wait until this task has completed"
"RTN","LEX2081",147,0)
 . N LEXT1,LEXT2 S LEXT1=" Task #"_LEXRUN_" "_$G(LEXSTA1)
"RTN","LEX2081",148,0)
 . S:$L($G(LEXNAM)) LEXT1=" Task #"_LEXRUN_" """_LEXNAM_""" "_$G(LEXSTA1)
"RTN","LEX2081",149,0)
 . S LEXT2=" "_LEXSTA2 D:$D(LEXE) ET(" ") D ET(LEXT1),ET(LEXT2)
"RTN","LEX2081",150,0)
 I '$D(LEXE) W " - OK"
"RTN","LEX2081",151,0)
 Q
"RTN","LEX2081",152,0)
INS(X) ;   Installed on
"RTN","LEX2081",153,0)
 N DA,LEXDA,LEXE,LEXI,LEXMSG,LEXNS,LEXOUT,LEXPI,LEXPN,LEXSCR,LEXVI,LEXVR S LEXNS=$P(X,"*",1),LEXVR=$P(X,"*",2),LEXPN=$P(X,"*",3)
"RTN","LEX2081",154,0)
 Q:'$L(LEXNS) ""  S LEXVR=+LEXVR Q:LEXVR'>0 ""  S LEXPN=+LEXPN Q:+LEXPN'>0 ""  S:LEXVR'["." LEXVR=LEXVR_".0"
"RTN","LEX2081",155,0)
 S LEXSCR="I $G(^DIC(9.4,+($G(Y)),""VERSION""))="""_LEXVR_""""
"RTN","LEX2081",156,0)
 D FIND^DIC(9.4,,.01,"O",LEXNS,10,"C",LEXSCR,,"LEXOUT","LEXMSG")
"RTN","LEX2081",157,0)
 S LEXPI=$G(LEXOUT("DILIST",2,1)) K LEXOUT,LEXMSG Q:+LEXPI'>0 ""  Q:'$D(@("^DIC(9.4,"_LEXPI_",22)")) ""
"RTN","LEX2081",158,0)
 K DA S DA(1)=LEXPI S LEXDA=$$IENS^DILF(.DA)
"RTN","LEX2081",159,0)
 D FIND^DIC(9.49,LEXDA,.01,"O",LEXVR,10,"B",,,"LEXOUT","LEXMSG")
"RTN","LEX2081",160,0)
 S LEXVI=$G(LEXOUT("DILIST",2,1)) K LEXOUT,LEXMSG Q:+LEXVI'>0 ""  Q:'$D(@("^DIC(9.4,"_LEXPI_",22,"_LEXVI_",""PAH"")")) ""
"RTN","LEX2081",161,0)
 K DA S DA(2)=LEXPI,DA(1)=LEXVI S LEXDA=$$IENS^DILF(.DA)
"RTN","LEX2081",162,0)
 S LEXSCR="I $G(^DIC(9.4,"_LEXPI_",22,"_LEXVI_",""PAH"",+($G(Y)),0))[""SEQ #"""
"RTN","LEX2081",163,0)
 D FIND^DIC(9.4901,LEXDA,".01;.02I",,LEXPN,10,"B",LEXSCR,,"LEXOUT","LEXMSG")
"RTN","LEX2081",164,0)
 S LEXI=$G(LEXOUT("DILIST","ID",1,.02)) Q:'$L(LEXI) ""  Q:$P(LEXI,".",1)'?7N ""
"RTN","LEX2081",165,0)
 S LEXE=$TR($$FMTE^XLFDT(LEXI,"5DZ"),"@"," ") Q:'$L(LEXE) ""  S X=LEXI_"^"_LEXE
"RTN","LEX2081",166,0)
 Q X
"RTN","LEX2081",167,0)
SY(X) ;   Check System variables
"RTN","LEX2081",168,0)
 Q:'$D(IO)!('$D(IOF))!('$D(IOM))!('$D(ION))!('$D(IOSL))!('$D(IOST)) 0
"RTN","LEX2081",169,0)
 Q 1
"RTN","LEX2081",170,0)
UR(X) ;   Check User variables
"RTN","LEX2081",171,0)
 Q:'$L($G(DUZ(0))) 0
"RTN","LEX2081",172,0)
 Q:+($G(DUZ))=0!($$NOTDEF(+$G(DUZ))) 0
"RTN","LEX2081",173,0)
 Q 1
"RTN","LEX2081",174,0)
 ;               
"RTN","LEX2081",175,0)
ET(X) ;   Error Text
"RTN","LEX2081",176,0)
 N LEXI S LEXI=+($G(LEXE(0))),LEXI=LEXI+1,LEXE(LEXI)="    "_$G(X),LEXE(0)=LEXI
"RTN","LEX2081",177,0)
 Q
"RTN","LEX2081",178,0)
ED ;   Error Display
"RTN","LEX2081",179,0)
 N LEXI S LEXI=0 F  S LEXI=$O(LEXE(LEXI)) Q:+LEXI=0  D M(LEXE(LEXI))
"RTN","LEX2081",180,0)
 D M(" ") K LEXE Q
"RTN","LEX2081",181,0)
 ;                   
"RTN","LEX2081",182,0)
 ; Miscellaneous
"RTN","LEX2081",183,0)
 ;
"RTN","LEX2081",184,0)
NOTDEF(IEN) ;   Check to see if user is defined
"RTN","LEX2081",185,0)
 N DA,DR,DIQ,LEX,DIC S DA=IEN,DR=.01,DIC=200,DIQ="LEX" D EN^DIQ1 Q '$D(LEX)
"RTN","LEX2081",186,0)
OK ;   Environment is OK
"RTN","LEX2081",187,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXT
"RTN","LEX2081",188,0)
 D IMP S LEXT="  Environment "_$S($L(LEXBUILD):("for Emergency patch "_LEXBUILD_" "),1:"")_"is ok"
"RTN","LEX2081",189,0)
 D BM(LEXT),M(" ")
"RTN","LEX2081",190,0)
 Q
"RTN","LEX2081",191,0)
BM(X) ;   Blank Line with Message
"RTN","LEX2081",192,0)
 S X=$G(X) S:$E(X,1)'=" " X=" "_X D BMES^XPDUTL(X) Q
"RTN","LEX2081",193,0)
M(X) ;   Message
"RTN","LEX2081",194,0)
 S X=$G(X) S:$E(X,1)'=" " X=" "_X D MES^XPDUTL(X) Q
"RTN","LEX2081",195,0)
TRIM(X) ;   Trim Spaces
"RTN","LEX2081",196,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","LEX2081",197,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","LEX2081",198,0)
 Q X
"RTN","LEX2081",199,0)
IMP ;   Import names
"RTN","LEX2081",200,0)
 ;     Patch Type
"RTN","LEX2081",201,0)
 S LEXPTYPE="Code Set Update"
"RTN","LEX2081",202,0)
 S LEXPTYPE="Emergency Patch (fix Lexicon Cross-References)"
"RTN","LEX2081",203,0)
 ;     Revision
"RTN","LEX2081",204,0)
 S LEXLREV=81
"RTN","LEX2081",205,0)
 ;     Required Builds build^released;build^released;build^released
"RTN","LEX2081",206,0)
 S LEXREQP="LEX*2.0*73^3110628"
"RTN","LEX2081",207,0)
 ;     This Build Name
"RTN","LEX2081",208,0)
 S LEXBUILD="LEX*2.0*81"
"RTN","LEX2081",209,0)
 ;     This Build's Export Global Host Filename
"RTN","LEX2081",210,0)
 S LEXIGHF=""
"RTN","LEX2081",211,0)
 ;     Fiscal Year
"RTN","LEX2081",212,0)
 S LEXFY=""
"RTN","LEX2081",213,0)
 ;     Quarter
"RTN","LEX2081",214,0)
 S LEXQTR=""
"RTN","LEX2081",215,0)
 Q
"RTN","LEX2081",216,0)
EF ;   Exported Files
"RTN","LEX2081",217,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2081",218,0)
 ;;^LEXT(757.2);^LEXT(757.2);Lexicon Subsets/Defaults;757.2
"RTN","LEX2081",219,0)
 ;;
"RTN","LEX2081",220,0)
 ;;^ICPT(0);^ICPT(;CPT/HCPCS;81
"RTN","LEX2081",221,0)
 ;;^DIC(81.1,0);^DIC(81.1);CPT Category;81.1
"RTN","LEX2081",222,0)
 ;;^DIC(81.2,0);^DIC(81.2);CPT Copyright;81.2
"RTN","LEX2081",223,0)
 ;;^DIC(81.3,0);^DIC(81.3);CPT Modifier;81.3
"RTN","LEX2081",224,0)
 ;;
"RTN","LEX2081",225,0)
 ;;^ICD9(0);^ICD9(;ICD Diagnosis;80
"RTN","LEX2081",226,0)
 ;;^ICD0(0);^ICD0(;ICD Operation/Procedure;80.1
"RTN","LEX2081",227,0)
 ;;^ICD(0);^ICD(;DRG Grouper;80.2
"RTN","LEX2081",228,0)
 ;;^ICM(0);^ICM(;MAJOR DIAGNOSTIC CATEGORY;80.3
"RTN","LEX2081",229,0)
 ;;^ICPT(0);^ICPT(;CPT/HCPCS;81
"RTN","LEX2081",230,0)
 ;;^DIC(81.1,0);^DIC(81.1);CPT Category;81.1
"RTN","LEX2081",231,0)
 Q
"RTN","LEX2081",232,0)
GD ;   Global Data
"RTN","LEX2081",233,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2081A")
0^30^B14855038^n/a
"RTN","LEX2081A",1,0)
LEX2081A ;ISL/KER - LEX*2.0*81 Pre/Post Install (cont) ;08/17/2011
"RTN","LEX2081A",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEX2081A",3,0)
 ;               
"RTN","LEX2081A",4,0)
 ; Global Variables
"RTN","LEX2081A",5,0)
 ;    ^LEX(757,
"RTN","LEX2081A",6,0)
 ;    ^LEX(757.001
"RTN","LEX2081A",7,0)
 ;    ^LEX(757.01
"RTN","LEX2081A",8,0)
 ;    ^LEX(757.02
"RTN","LEX2081A",9,0)
 ;    ^LEX(757.1
"RTN","LEX2081A",10,0)
 ;               
"RTN","LEX2081A",11,0)
 ; External References
"RTN","LEX2081A",12,0)
 ;    ^%ZTLOAD            ICR  10063
"RTN","LEX2081A",13,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2081A",14,0)
 ;    ENALL^DIK           ICR  10013
"RTN","LEX2081A",15,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2081A",16,0)
 ;    IX2^DIK             ICR  10013
"RTN","LEX2081A",17,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2081A",18,0)
 ;               
"RTN","LEX2081A",19,0)
 Q
"RTN","LEX2081A",20,0)
POST ; Post-Install (Continue)
"RTN","LEX2081A",21,0)
 D AVA,AWRD,CHG
"RTN","LEX2081A",22,0)
 Q
"RTN","LEX2081A",23,0)
CHG ; Changes
"RTN","LEX2081A",24,0)
 D CHG1,CHG2
"RTN","LEX2081A",25,0)
 Q
"RTN","LEX2081A",26,0)
AVA ; AVA Cross-Reference
"RTN","LEX2081A",27,0)
 N Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","LEX2081A",28,0)
 S ZTRTN="AVAT^LEX2081A",ZTIO="",ZTDTH=$H
"RTN","LEX2081A",29,0)
 S ZTDESC="Lexicon Rebuild AVA Cross-Reference" D ^%ZTLOAD
"RTN","LEX2081A",30,0)
 D MES^XPDUTL(" Checking cross-references")
"RTN","LEX2081A",31,0)
 Q
"RTN","LEX2081A",32,0)
AVAT ; AVA Cross-Reference (task)
"RTN","LEX2081A",33,0)
 N DIK S DIK="^LEX(757.02,",DIK(1)="2^AVA" D ENALL^DIK
"RTN","LEX2081A",34,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEX2081A",35,0)
 Q
"RTN","LEX2081A",36,0)
AWRD ; AWRD Cross-Reference
"RTN","LEX2081A",37,0)
 N Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","LEX2081A",38,0)
 S ZTRTN="AWRDT^LEX2081A",ZTIO="",ZTDTH=$H
"RTN","LEX2081A",39,0)
 S ZTDESC="Lexicon Rebuild AWRD Cross-Reference" D ^%ZTLOAD
"RTN","LEX2081A",40,0)
 D:+($G(ZTSK))>0 MES^XPDUTL((" A task has been created to rebuild the AWRD cross-reference (#"_+($G(ZTSK))_")"))
"RTN","LEX2081A",41,0)
 D:+($G(ZTSK))'>0 MES^XPDUTL(" Rebuilding the AWRD cross-reference")
"RTN","LEX2081A",42,0)
 Q
"RTN","LEX2081A",43,0)
AWRDT ; AWRD Cross-Reference (task)
"RTN","LEX2081A",44,0)
 N DIK S DIK="^LEX(757.01,",DIK(1)="2^AWRD" D ENALL^DIK
"RTN","LEX2081A",45,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEX2081A",46,0)
 Q
"RTN","LEX2081A",47,0)
CHG1 ; Change 1 - Sleep Deprivation/Lack of Adequate Sleep
"RTN","LEX2081A",48,0)
 N CODE,DA,DIK,EFF,EX,FQ,MC,OM,SAB,SO
"RTN","LEX2081A",49,0)
 ; Key Words for #331586, "Lack of Adequate Sleep"
"RTN","LEX2081A",50,0)
 S EX=331586
"RTN","LEX2081A",51,0)
 S ^LEX(757.01,EX,5,0)="^757.18^2^2"
"RTN","LEX2081A",52,0)
 S ^LEX(757.01,EX,5,1,0)="SLEEP"
"RTN","LEX2081A",53,0)
 S ^LEX(757.01,EX,5,2,0)="DEPRIVATION"
"RTN","LEX2081A",54,0)
 S DA=EX,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2081A",55,0)
 ; Key Words for #111265, "Sleep Deprivation"
"RTN","LEX2081A",56,0)
 S EX=111265
"RTN","LEX2081A",57,0)
 S ^LEX(757.01,EX,5,0)="^757.18^4^4"
"RTN","LEX2081A",58,0)
 S ^LEX(757.01,EX,5,1,0)="LACK"
"RTN","LEX2081A",59,0)
 S ^LEX(757.01,EX,5,2,0)="OF"
"RTN","LEX2081A",60,0)
 S ^LEX(757.01,EX,5,3,0)="SLEEP"
"RTN","LEX2081A",61,0)
 S ^LEX(757.01,EX,5,4,0)="ADEQUATE"
"RTN","LEX2081A",62,0)
 S DA=EX,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2081A",63,0)
 ; ICD Code for #111265, "Sleep Deprivation"
"RTN","LEX2081A",64,0)
 S MC=22890,FQ=22890,EX=111265,SO=117782,CODE="V69.4",EFF=3041001,SAB=1
"RTN","LEX2081A",65,0)
 S ^LEX(757.02,SO,0)=EX_"^"_CODE_"^"_SAB_"^"_MC_"^0^^1"
"RTN","LEX2081A",66,0)
 S ^LEX(757.02,SO,4,0)="^757.28D^1^1"
"RTN","LEX2081A",67,0)
 S ^LEX(757.02,SO,4,1,0)=EFF_"^1",DA=SO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2081A",68,0)
 ; Move Expression to New Major Concept as a Synonym
"RTN","LEX2081A",69,0)
 S MC=22890,OM=7112472
"RTN","LEX2081A",70,0)
 S DA=7224943,DIK="^LEX(757.01," D IX2^DIK
"RTN","LEX2081A",71,0)
 S ^LEX(757.01,7224943,0)="Sleep Deprivation"
"RTN","LEX2081A",72,0)
 S ^LEX(757.01,7224943,1)=MC_"^2^D^1"
"RTN","LEX2081A",73,0)
 S DA=7224943,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2081A",74,0)
 S DA=7224944,DIK="^LEX(757.01," D IX2^DIK
"RTN","LEX2081A",75,0)
 S ^LEX(757.01,7224944,0)="Sleep Deprivation (finding)"
"RTN","LEX2081A",76,0)
 S ^LEX(757.01,7224944,1)=MC_"^8^D^15"
"RTN","LEX2081A",77,0)
 S DA=7224944,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2081A",78,0)
 ; Move Semantic Map to new Major Concept
"RTN","LEX2081A",79,0)
 S DA=7112472,DIK="^LEX(757.1," D IX2^DIK
"RTN","LEX2081A",80,0)
 S ^LEX(757.1,7112472,0)=MC_"^10^71"
"RTN","LEX2081A",81,0)
 S DA=7112472,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2081A",82,0)
 ; Move Code to new Major Concept
"RTN","LEX2081A",83,0)
 S DA=7112472,DIK="^LEX(757.02," D IX2^DIK
"RTN","LEX2081A",84,0)
 s ^LEX(757.02,7112472,0)="7224943^130989002^56^"_MC_"^1^^1"
"RTN","LEX2081A",85,0)
 S DA=7112472,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2081A",86,0)
 ; Delete old Frequency
"RTN","LEX2081A",87,0)
 I $D(^LEX(757.001,OM,0)) D
"RTN","LEX2081A",88,0)
 . S DA=OM,DIK="^LEX(757.001," D ^DIK
"RTN","LEX2081A",89,0)
 ; Delete old Major Concept Map
"RTN","LEX2081A",90,0)
 I $D(^LEX(757,OM,0)) D
"RTN","LEX2081A",91,0)
 . S DA=OM,DIK="^LEX(757," D ^DIK
"RTN","LEX2081A",92,0)
 Q
"RTN","LEX2081A",93,0)
CHG2 ; Change 2 - Loss of Consciousness
"RTN","LEX2081A",94,0)
 S MC=7367393,EX=7941742,SO=270124,CODE="780.09",EFF=2781001,SAB=1
"RTN","LEX2081A",95,0)
 ; Frequency
"RTN","LEX2081A",96,0)
 S DA=7367393,DIK="^LEX(757.001," D IX2^DIK
"RTN","LEX2081A",97,0)
 S ^LEX(757.001,7367393,0)="7367393^6^6"
"RTN","LEX2081A",98,0)
 S DA=7367393,DIK="^LEX(757.001," D IX1^DIK
"RTN","LEX2081A",99,0)
 ; Expression
"RTN","LEX2081A",100,0)
 S DA=EX,DIK="^LEX(757.01," D IX2^DIK
"RTN","LEX2081A",101,0)
 S ^LEX(757.01,7941742,0)="Loss of Consciousness"
"RTN","LEX2081A",102,0)
 S DA=EX,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2081A",103,0)
 ; Code
"RTN","LEX2081A",104,0)
 S ^LEX(757.02,SO,0)=EX_"^"_CODE_"^"_SAB_"^"_MC_"^0^^1"
"RTN","LEX2081A",105,0)
 S ^LEX(757.02,SO,4,0)="^757.28D^1^1"
"RTN","LEX2081A",106,0)
 S ^LEX(757.02,SO,4,1,0)=EFF_"^1"
"RTN","LEX2081A",107,0)
 S DA=SO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2081A",108,0)
 Q
"RTN","LEX2081P")
0^28^B21788237^n/a
"RTN","LEX2081P",1,0)
LEX2081P ;ISL/KER - LEX*2.0*81 Pre/Post Install ;08/17/2011
"RTN","LEX2081P",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEX2081P",3,0)
 ;               
"RTN","LEX2081P",4,0)
 ; Global Variables
"RTN","LEX2081P",5,0)
 ;    ^%ZOSF("PROD")      ICR  10096
"RTN","LEX2081P",6,0)
 ;    ^%ZOSF("UCI")       ICR  10096
"RTN","LEX2081P",7,0)
 ;    ^TMP("LEXKID",$J)   SACC 2.3.2.5.1
"RTN","LEX2081P",8,0)
 ;    ^TMP("LEXMSG",$J)   SACC 2.3.2.5.1
"RTN","LEX2081P",9,0)
 ;               
"RTN","LEX2081P",10,0)
 ; External References
"RTN","LEX2081P",11,0)
 ;    ^DIC                ICR  10006
"RTN","LEX2081P",12,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEX2081P",13,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEX2081P",14,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEX2081P",15,0)
 ;    ^XMD                ICR  10070
"RTN","LEX2081P",16,0)
 Q
"RTN","LEX2081P",17,0)
PRE ; Pre-Install
"RTN","LEX2081P",18,0)
 Q
"RTN","LEX2081P",19,0)
POST ; Post-Install
"RTN","LEX2081P",20,0)
 ;            
"RTN","LEX2081P",21,0)
 ; From IMP in the Environment Check
"RTN","LEX2081P",22,0)
 ;            
"RTN","LEX2081P",23,0)
 ;      LEXBUILD   Build Name          LEX*2.0*81
"RTN","LEX2081P",24,0)
 ;      LEXPTYPE   Patch Type          Emergency Patch (Remedy Ticket Fixes)
"RTN","LEX2081P",25,0)
 ;      LEXFY      Fiscal Year         N/A
"RTN","LEX2081P",26,0)
 ;      LEXQTR     Quarter             N/A
"RTN","LEX2081P",27,0)
 ;      LEXIGHF    Name of Host File   N/A
"RTN","LEX2081P",28,0)
 ;      LEXLREV    Revision            81
"RTN","LEX2081P",29,0)
 ;      LEXREQP    Required Builds     LEX*2.0*73^3110628
"RTN","LEX2081P",30,0)
 ;            
"RTN","LEX2081P",31,0)
 N LEXEDT,LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXB,LEXCD,LEXSTR,LEXLAST,LEXOK,X,Y S LEXOK=0 D IMP
"RTN","LEX2081P",32,0)
 D:LEXOK>0 POST^LEX2081A,INS
"RTN","LEX2081P",33,0)
 Q
"RTN","LEX2081P",34,0)
INS ; Install Message
"RTN","LEX2081P",35,0)
 K ^TMP("LEXKID",$J),LEXSCHG N LEXA,LEXAC,LEXAO,LEXB,LEXBUILD,LEXH,LEXIN,LEXS,LEXT,LEXU
"RTN","LEX2081P",36,0)
 S LEXBUILD="LEX*2.0*81",LEXS="Emergency Patch LEX*2.0*81 Installation" H 2 D BL,TL((" "_LEXS)),TL(" ======================================="),BL
"RTN","LEX2081P",37,0)
 S LEXAO="   As of:       "_$$ED($$NOW^XLFDT) D TL(LEXAO) S LEXAC=""
"RTN","LEX2081P",38,0)
 S LEXA=$$UCI S:$L($P(LEXA,"^",1)) LEXAC="   In Account:  " S LEXAC=LEXAC_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEX2081P",39,0)
 S:$L($P(LEXA,"^",2)) LEXAC=LEXAC_"  "_$P(LEXA,"^",2) D TL(LEXAC) S LEXU=$$USR
"RTN","LEX2081P",40,0)
 S:$L($P(LEXU,"^",1)) LEXU="   Maint By:    "_$P(LEXU,"^",1)_"   "_$P(LEXU,"^",2) D TL(LEXU)
"RTN","LEX2081P",41,0)
 S LEXB="   Build:       "_LEXBUILD D TL(LEXB)
"RTN","LEX2081P",42,0)
 D:+($G(^TMP("LEXKID",$J,0)))>0 MAIL K ^TMP("LEXKID",$J)
"RTN","LEX2081P",43,0)
 Q
"RTN","LEX2081P",44,0)
MAIL ;   Mail global array in message
"RTN","LEX2081P",45,0)
 N DIFROM,LEXPRI,LEXADR,LEXI,LEXM,LEXSUB,XCNP,XMDUZ,XMSCR,XMSUB,XMTEXT,XMY,XMZ,LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR
"RTN","LEX2081P",46,0)
 D IMP K ^TMP("LEXMSG",$J) S LEXSUB="Lexicon/ICD/CPT Installation" S:$L($G(LEXBUILD)) LEXSUB=$G(LEXBUILD)_" Installation"
"RTN","LEX2081P",47,0)
 S LEXPRI=$$ADR G:'$L(LEXPRI) MAILQ S LEXPRI="G.LEXINS@"_LEXPRI S LEXADR=$$GET1^DIQ(200,+($G(DUZ)),.01) G:'$L(LEXADR) MAILQ
"RTN","LEX2081P",48,0)
 S XMSUB=LEXSUB S LEXI=0 F  S LEXI=$O(^TMP("LEXKID",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEX2081P",49,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1,^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEXKID",$J,LEXI)),1,79),^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEX2081P",50,0)
 K ^TMP("LEXKID",$J) G:'$D(^TMP("LEXMSG",$J)) MAILQ G:+($G(^TMP("LEXMSG",$J,0)))'>0 MAILQ S XMY(LEXPRI)="",XMY(LEXADR)=""
"RTN","LEX2081P",51,0)
 S XMTEXT="^TMP(""LEXMSG"",$J,",XMDUZ=.5 D ^XMD
"RTN","LEX2081P",52,0)
MAILQ ;   Quit Mail
"RTN","LEX2081P",53,0)
 D KILL K XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","LEX2081P",54,0)
 Q
"RTN","LEX2081P",55,0)
 ;            
"RTN","LEX2081P",56,0)
 ; Miscellaneous
"RTN","LEX2081P",57,0)
ADR(LEX) ;   Mailing Address
"RTN","LEX2081P",58,0)
 N DIC,DTOUT,DUOUT,X,Y
"RTN","LEX2081P",59,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEX2081P",60,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEX2081P",61,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEX2081P",62,0)
 Q "ISC-SLC.VA.GOV"
"RTN","LEX2081P",63,0)
ED(X) ;   External Date
"RTN","LEX2081P",64,0)
 N Y S Y=$$FMTE^XLFDT($G(X)) S:Y["@" Y=$P(Y,"@",1)_"  "_$P(Y,"@",2,299) S:$L(Y) X=Y
"RTN","LEX2081P",65,0)
 Q X
"RTN","LEX2081P",66,0)
UCI(X) ;   UCI where Lexicon is installed
"RTN","LEX2081P",67,0)
 N LEXU,LEX1,LEX2,LEX3,LEXP,LEXT,Y X ^%ZOSF("UCI") S LEXU=Y,LEXP="",LEX1=$P(Y,",",1),LEX2=$P(Y,",",2,299),LEX3=$G(^%ZOSF("PROD"))
"RTN","LEX2081P",68,0)
 S:$L(LEX3)&(LEXU=LEX3!(LEX1=LEX3)!(LEX2=LEX3)) LEXP=" (Production)" S:'$L(LEXP) LEXP=" (Test)"
"RTN","LEX2081P",69,0)
 S:$L(LEX1)>5&($L(LEX2)>5)&(LEX1=LEX2) LEXU=LEX1 S X="",$P(X,"^",1)=LEXU,$P(X,"^",2)=LEXP
"RTN","LEX2081P",70,0)
 Q X
"RTN","LEX2081P",71,0)
USR(X) ;   User/Person Installing
"RTN","LEX2081P",72,0)
 N LEXDUZ,LEXUSR,LEXPH,LEXNM S LEXDUZ=+($G(DUZ)) Q:+LEXDUZ'>0 "UNKNOWN^"  S LEXNM=$$GET1^DIQ(200,+LEXDUZ,.01) Q:'$L(LEXNM) "UNKNOWN^"
"RTN","LEX2081P",73,0)
 S LEXUSR=LEXDUZ S LEXPH=$$GET1^DIQ(200,+LEXUSR,.132) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXUSR,.131)
"RTN","LEX2081P",74,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXUSR,.133) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXUSR,.134)
"RTN","LEX2081P",75,0)
 S LEXUSR=$$GET1^DIQ(200,+LEXDUZ,.01),X=LEXUSR_"^"_LEXPH
"RTN","LEX2081P",76,0)
 Q X
"RTN","LEX2081P",77,0)
KILL ;   Kill all ^TMP(
"RTN","LEX2081P",78,0)
 K ^TMP("LEXMSG",$J),^TMP("LEXKID",$J)
"RTN","LEX2081P",79,0)
 Q
"RTN","LEX2081P",80,0)
BL ;   Blank Line
"RTN","LEX2081P",81,0)
 D TL(" ")
"RTN","LEX2081P",82,0)
 Q
"RTN","LEX2081P",83,0)
TL(X) ;   Text Line
"RTN","LEX2081P",84,0)
 N LEXI S LEXI=$O(^TMP("LEXKID",$J," "),-1),LEXI=LEXI+1,^TMP("LEXKID",$J,LEXI)=$G(X),^TMP("LEXKID",$J,0)=LEXI
"RTN","LEX2081P",85,0)
 Q
"RTN","LEX2081P",86,0)
PIEN(X) ;   Package IEN
"RTN","LEX2081P",87,0)
 N DIC,DTOUT,DTOUT,Y S X=$G(X),DIC="^DIC(9.4,",DIC(0)="B" D ^DIC S X=+Y
"RTN","LEX2081P",88,0)
 Q X
"RTN","LEX2081P",89,0)
IMP ;   Call IMP in Environment Check
"RTN","LEX2081P",90,0)
 K LEXBUILD,LEXFY,LEXIGHF,LEXLREV,LEXPTYPE,LEXQTR,LEXREQP N LEXF
"RTN","LEX2081P",91,0)
 S LEXF=$P($T(+1)," ",1) S:$E(LEXF,$L(LEXF))="P" LEXF=$E(LEXF,1,($L(LEXF)-1)) Q:'$L(LEXF)
"RTN","LEX2081P",92,0)
 S LEXF="IMP^"_LEXF Q:'$L($T(@LEXF))  D @LEXF S:$L(LEXBUILD) LEXOK=1
"RTN","LEX2081P",93,0)
 Q
"RTN","LEXDM")
0^29^B14264609^B14239136
"RTN","LEXDM",1,0)
LEXDM ;ISL Default Misc - Mod/Del Sel/Create ;08/17/2011
"RTN","LEXDM",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXDM",3,0)
 ;
"RTN","LEXDM",4,0)
 ; Entry:  S X=$$MOD^LEXDM(X)
"RTN","LEXDM",5,0)
 ; Input   X  1=Filter, 2=Display, 3=Vocabulary or 4=Context
"RTN","LEXDM",6,0)
 ; Returns  "^^" Double up-arrow, 0 no action taken, 1 Modify
"RTN","LEXDM",7,0)
 ;          default entry or "@" delete default entry
"RTN","LEXDM",8,0)
 ;
"RTN","LEXDM",9,0)
MOD(LEXX) ; Modify or Delete
"RTN","LEXDM",10,0)
 ;
"RTN","LEXDM",11,0)
 S LEXX=+($G(LEXX)) Q:LEXX<0 0 S LEXX=LEXX\1  Q:LEXX>4 0
"RTN","LEXDM",12,0)
 N DIR,X,Y,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","LEXDM",13,0)
 S:LEXX=1 DIR("A",1)="search filter" S:LEXX=2 DIR("A",1)="display format"
"RTN","LEXDM",14,0)
 S:LEXX=3 DIR("A",1)="vocabulary" S:LEXX=4 DIR("A",1)="shortcut context"
"RTN","LEXDM",15,0)
 S:$L($G(DIR("A",1))) DIR("A",1)="User default "_DIR("A",1)
"RTN","LEXDM",16,0)
 S DIR("A",3)="  1  Modify",DIR("A",4)="  2  Delete"
"RTN","LEXDM",17,0)
 S (DIR("A",2),DIR("A",5))="  "
"RTN","LEXDM",18,0)
 S:LEXX=1 DIR(0)="SAO^1:Modify Default Filter;2:Delete Default Filter"
"RTN","LEXDM",19,0)
 S:LEXX=2 DIR(0)="SAO^1:Modify Default Display;2:Delete Default Display"
"RTN","LEXDM",20,0)
 S:LEXX=3 DIR(0)="SAO^1:Modify Default Vocabulary;2:Delete Default Vocabulary"
"RTN","LEXDM",21,0)
 S:LEXX=4 DIR(0)="SAO^1:Modify Default Shortcut Context;2:Delete Default Shortcut Context"
"RTN","LEXDM",22,0)
 S DIR("A")="Select:  ",DIR("B")="1"
"RTN","LEXDM",23,0)
 D ^DIR S LEXX=$S(X=1:1,X=2:"@",X="@":"@",1:0) S:Y="^^" LEXX=Y Q LEXX
"RTN","LEXDM",24,0)
 ;
"RTN","LEXDM",25,0)
 ;-----------------------------------------------------------------
"RTN","LEXDM",26,0)
 ; Entry:  S X=$$MTH^LEXDM(X)
"RTN","LEXDM",27,0)
 ; Input   X  1=Filter, 2=Display
"RTN","LEXDM",28,0)
 ; Returns "^^" Timeout or Double-uparrow, "^" Method not
"RTN","LEXDM",29,0)
 ;         selected, 1 Select default from a predefined list
"RTN","LEXDM",30,0)
 ;         or 2 Create a user defined default
"RTN","LEXDM",31,0)
 ;
"RTN","LEXDM",32,0)
 ; LEXM   Method of building string
"RTN","LEXDM",33,0)
 ; LEXF   Flag, indicates the default type
"RTN","LEXDM",34,0)
 ;
"RTN","LEXDM",35,0)
MTH(LEXX) ; Method - Select a predefined or Create new
"RTN","LEXDM",36,0)
 Q:'$L($G(LEXX)) "" Q:+LEXX'>0 "" Q:+LEXX'<3 ""
"RTN","LEXDM",37,0)
 N LEXF,LEXM S LEXF=+LEXX,LEXM=$$METH W:+LEXM=1!(+LEXM=2) !!
"RTN","LEXDM",38,0)
 S LEXX=LEXM S:"12"[LEXM LEXX=LEXM
"RTN","LEXDM",39,0)
 S:'$L($G(LEXM))!(LEXM="^") LEXX="^" S:LEXM="^^" LEXX="^^"
"RTN","LEXDM",40,0)
 Q LEXX
"RTN","LEXDM",41,0)
METH(LEXX) ; Select method
"RTN","LEXDM",42,0)
 N DIR,X,Y,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","LEXDM",43,0)
 I +LEXF=1 D
"RTN","LEXDM",44,0)
 . S DIR("A",1)="Search filters (screens) to limit the response"
"RTN","LEXDM",45,0)
 . S DIR("A",3)="  1  Select from predefined filters"
"RTN","LEXDM",46,0)
 . S DIR("A",4)="  2  Create your own filter"
"RTN","LEXDM",47,0)
 . S DIR("??")="^D HF^LEXDM"
"RTN","LEXDM",48,0)
 I +LEXF=2 D
"RTN","LEXDM",49,0)
 . S DIR("A",1)="Display format to be used during look-up"
"RTN","LEXDM",50,0)
 . S DIR("A",3)="  1  Select from predefined display formats"
"RTN","LEXDM",51,0)
 . S DIR("A",4)="  2  Create your own display format"
"RTN","LEXDM",52,0)
 . S DIR("??")="^D HD^LEXDM"
"RTN","LEXDM",53,0)
 S (DIR("A",2),DIR("A",5))="  "
"RTN","LEXDM",54,0)
 S DIR(0)="SAO^1:Predefined Set;2:Create your own set"
"RTN","LEXDM",55,0)
 S DIR("A")="Select:  ",DIR("B")="1"
"RTN","LEXDM",56,0)
 D ^DIR S LEXX=$S(+Y>0:+Y,1:Y) S:$D(DTOUT) LEXX="^^" Q LEXX
"RTN","LEXDM",57,0)
HF ; Help for filters - DIC("S")
"RTN","LEXDM",58,0)
 W !!,"When conducting searches in the Lexicon, you may find that many of the"
"RTN","LEXDM",59,0)
 W !,"expressions found are not reasonable in the context of intended use."
"RTN","LEXDM",60,0)
 W !,"Many of these ""unreasonable"" expressions can be filtered out during the"
"RTN","LEXDM",61,0)
 W !,"search, providing a much smaller and more meaningful list of expressions"
"RTN","LEXDM",62,0)
 W !,"to select from.  Several of these filters have been predefined and made "
"RTN","LEXDM",63,0)
 W !,"available.  You may select from this list of predefined filters or create"
"RTN","LEXDM",64,0)
 W !,"your own." Q
"RTN","LEXDM",65,0)
HD ; Help for display - LEXSHOW
"RTN","LEXDM",66,0)
 W !!,"When conducting searches in the Lexicon, you may alter the display format"
"RTN","LEXDM",67,0)
 W !,"of the selection list.  There are several commonly used displays which"
"RTN","LEXDM",68,0)
 W !,"have been predefined and made available.  You may select from this list or"
"RTN","LEXDM",69,0)
 W !,"create your own." Q
"RTN","LEXRX")
0^1^B25440682^n/a
"RTN","LEXRX",1,0)
LEXRX ;ISL/KER - Re-Index Lexicon ;08/17/2011
"RTN","LEXRX",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRX",3,0)
 ;               
"RTN","LEXRX",4,0)
 ; Global Variables
"RTN","LEXRX",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRX",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRX",7,0)
 ;               
"RTN","LEXRX",8,0)
 ; External References
"RTN","LEXRX",9,0)
 ;    ^DIC                ICR  10006
"RTN","LEXRX",10,0)
 ;    ^DIR                ICR  10026
"RTN","LEXRX",11,0)
 ;               
"RTN","LEXRX",12,0)
 ; Callable Entry Points in this Routine
"RTN","LEXRX",13,0)
 ;               
"RTN","LEXRX",14,0)
 ;   EN^LEXRX     Task the Repair/Re-Index of one or more Files
"RTN","LEXRX",15,0)
 ;   CHECK^LEXRX  Check if a Repair/Re-Index Task is Running
"RTN","LEXRX",16,0)
 ;   MON^LEXRX    Monitor Progress of a Running Task
"RTN","LEXRX",17,0)
 ;               
"RTN","LEXRX",18,0)
EN ; Main Entry Point
"RTN","LEXRX",19,0)
 N DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,LEX,LEXAC,LEXAMSO,LEXENV
"RTN","LEXRX",20,0)
 N LEXFI,LEXFN,LEXMON,LEXOK,LEXRUN,LEXSTA,LEXT,LEXTY,X,Y
"RTN","LEXRX",21,0)
 K LEXMON S LEXENV=$$ENV^LEXRXXM Q:'LEXENV
"RTN","LEXRX",22,0)
 W !," Repair/Re-Index Lexicon cross-references"
"RTN","LEXRX",23,0)
 S LEXRUN=$$CHECK^LEXRXXM2 I +LEXRUN>0 D  Q
"RTN","LEXRX",24,0)
 . W "     Try again later",!
"RTN","LEXRX",25,0)
 N LEXAMSO,LEXFI,LEXOK S LEXOK=0,LEXAMSO=$$AMSO^LEXRXXA
"RTN","LEXRX",26,0)
 I "^A^M^S^O^"'[("^"_LEXAMSO_"^") D  Q
"RTN","LEXRX",27,0)
 . W !!,?3,"Lexicon index Repair/Re-Index method not selected, aborting"
"RTN","LEXRX",28,0)
 D:"^A^"[("^"_LEXAMSO_"^") ALL D:"^M^"[("^"_LEXAMSO_"^") MAJ
"RTN","LEXRX",29,0)
 D:"^S^"[("^"_LEXAMSO_"^") SUP  D:"^O^"[("^"_LEXAMSO_"^") ONE
"RTN","LEXRX",30,0)
 Q
"RTN","LEXRX",31,0)
 ;               
"RTN","LEXRX",32,0)
ALL ;   All Files
"RTN","LEXRX",33,0)
 N LEXOK,LEXTY,LEXAMSO K LEXFI S LEXOK=0,LEXAMSO="A"
"RTN","LEXRX",34,0)
 W !!," ",$$BOLD^LEXRXXM,"Repair/Re-Index the Cross-References for all Lexicon Files",$$NORM^LEXRXXM,!
"RTN","LEXRX",35,0)
 W !,"   The cross-references for the larger files will be repaired and the "
"RTN","LEXRX",36,0)
 W !,"   smaller files will be re-indexed.",!
"RTN","LEXRX",37,0)
 W !,"   Users may be on the system since the cross-references of the larger"
"RTN","LEXRX",38,0)
 W !,"   files are not deleted and the re-indexing of the smaller files does"
"RTN","LEXRX",39,0)
 W !,"   not involve the Lexicon look-up."
"RTN","LEXRX",40,0)
 S LEXTY=3 S LEXOK=$$CO^LEXRXXA W ! I +LEXOK>0 K LEXFI D ALL^LEXRXXT
"RTN","LEXRX",41,0)
 Q
"RTN","LEXRX",42,0)
MAJ ;   Major Files
"RTN","LEXRX",43,0)
 N LEXOK,LEXTY,LEXAMSO K LEXFI S LEXOK=0,LEXAMSO="M"
"RTN","LEXRX",44,0)
 W !!," ",$$BOLD^LEXRXXM,"Repair the Cross-References for the Major Lexicon Files",$$NORM^LEXRXXM,!
"RTN","LEXRX",45,0)
 W !,"   The cross-references of the larger files will be repaired by "
"RTN","LEXRX",46,0)
 W !,"   verifying the individual subscripts in the cross-reference.  Only"
"RTN","LEXRX",47,0)
 W !,"   the entries that fail verification will be deleted.",!
"RTN","LEXRX",48,0)
 W !,"   Users may be on the system since the cross-references are not"
"RTN","LEXRX",49,0)
 W !,"   deleted."
"RTN","LEXRX",50,0)
 S LEXTY=1 S LEXOK=$$CO^LEXRXXA W ! I +LEXOK>0 K LEXFI D MAJ^LEXRXXT
"RTN","LEXRX",51,0)
 Q
"RTN","LEXRX",52,0)
SUP ;   Supporting Files
"RTN","LEXRX",53,0)
 N LEXOK,LEXTY,LEXAMSO K LEXFI S LEXOK=0,LEXAMSO="S"
"RTN","LEXRX",54,0)
 W !!," ",$$BOLD^LEXRXXM,"Re-Index the Cross-References for the Supporting Lexicon Files",$$NORM^LEXRXXM,!
"RTN","LEXRX",55,0)
 W !,"   The cross-references for the smaller files will be re-indexed.",!
"RTN","LEXRX",56,0)
 W !,"   Users may be on the system since the cross-references of the smaller"
"RTN","LEXRX",57,0)
 W !,"   files are not involve the Lexicon look-up."
"RTN","LEXRX",58,0)
 S LEXTY=3 S LEXOK=$$CO^LEXRXXA W ! I +LEXOK>0 K LEXFI D SUP^LEXRXXT
"RTN","LEXRX",59,0)
 Q
"RTN","LEXRX",60,0)
ONE ;   One File
"RTN","LEXRX",61,0)
 N LEXOK,LEXFI,LEXFN,LEXT,LEXTY,LEXAMSO S LEXAMSO="O",LEXFI=$$FI^LEXRXXA I '$L(LEXFI)!(LEXFI["^") W !!,"   Lexicon file not selected, aborting" Q
"RTN","LEXRX",62,0)
 I +($$FV^LEXRXXM(($G(LEXFI))))'>0 W !!,"   Invalid file selected, aborting" Q
"RTN","LEXRX",63,0)
 S LEXOK=0,LEXFN=$$FN^LEXRXXM(LEXFI) Q:'$L(LEXFN)
"RTN","LEXRX",64,0)
 S LEXT=LEXFI,LEXT=LEXT_$J(" ",(8-$L(LEXT)))_LEXFN S LEXT=LEXFI_" ("_LEXFN_")" W !
"RTN","LEXRX",65,0)
 I "^757^757.001^757.01^757.02^757.1^757.21^"[("^"_LEXFI_"^") D
"RTN","LEXRX",66,0)
 . S LEXTY=1 W !," ",$$BOLD^LEXRXXM,"Repair Cross-References for file ",LEXT,$$NORM^LEXRXXM,! D
"RTN","LEXRX",67,0)
 . . W !,"   The cross-references of file "_+LEXFI_" will be repaired by verifying"
"RTN","LEXRX",68,0)
 . . W !,"   the individual subscripts in the cross-reference.  Only the entries"
"RTN","LEXRX",69,0)
 . . W !,"   that fail verification will be deleted.  Users may be on the system"
"RTN","LEXRX",70,0)
 . . W !,"   since the cross-references are not deleted."
"RTN","LEXRX",71,0)
 I "^757^757.001^757.01^757.02^757.1^757.21^"'[("^"_LEXFI_"^") D
"RTN","LEXRX",72,0)
 . S LEXTY=2 W !," ",$$BOLD^LEXRXXM,"Re-Index Cross-References for file ",LEXT,$$NORM^LEXRXXM,! D
"RTN","LEXRX",73,0)
 . . W !,"   The cross-references of file "_+LEXFI_" will be re-indexed.  Users may"
"RTN","LEXRX",74,0)
 . . W !,"   be on the system since this file is not involved in the Lexicon "
"RTN","LEXRX",75,0)
 . . W !,"   look-up."
"RTN","LEXRX",76,0)
 S LEXOK=$$CO^LEXRXXA W ! I +LEXOK>0,$L($G(LEXFI)) D ONE^LEXRXXT
"RTN","LEXRX",77,0)
 Q
"RTN","LEXRX",78,0)
 ;
"RTN","LEXRX",79,0)
CHECK ; Check if a Repair/Re-Index Task is Running
"RTN","LEXRX",80,0)
 N LEXSTA K LEXMON S LEXSTA=$$CHECK^LEXRXXM2
"RTN","LEXRX",81,0)
 I +($G(LEXSTA))'>0 W !!,"   Lexicon cross-reference repair is not running",!
"RTN","LEXRX",82,0)
 Q
"RTN","LEXRX",83,0)
 ;
"RTN","LEXRX",84,0)
MON ; Monitor Progress of a Running Task
"RTN","LEXRX",85,0)
 N LEXMON S LEXMON="" D MON^LEXRXXM2
"RTN","LEXRX",86,0)
 Q
"RTN","LEXRX",87,0)
 ;              
"RTN","LEXRX",88,0)
 ; Miscellaneous
"RTN","LEXRX",89,0)
FORCE ;   Forced Repair/Re-Index
"RTN","LEXRX",90,0)
 K ^TMP("LEXRX",$J),^XTMP("LEXRXALL"),^XTMP("LEXRXMAJ"),^XTMP("LEXRXSUP"),^XTMP("LEXRXONE"),^XTMP("LEXRXSET"),^XTMP("LEXRXFIX")
"RTN","LEXRX",91,0)
 D CLR,EN
"RTN","LEXRX",92,0)
 Q
"RTN","LEXRX",93,0)
CLR ;   Clear
"RTN","LEXRX",94,0)
 N LEXID K LEXFIX,LEXSET,LEXTEST
"RTN","LEXRX",95,0)
 Q
"RTN","LEXRXA")
0^2^B14298023^n/a
"RTN","LEXRXA",1,0)
LEXRXA ;ISL/KER - Re-Index 757 B ;08/17/2011
"RTN","LEXRXA",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXA",3,0)
 ;               
"RTN","LEXRXA",4,0)
 ; Global Variables 
"RTN","LEXRXA",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXA",6,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXA",7,0)
 ;    ^LEX(757.001,       SACC 1.3 
"RTN","LEXRXA",8,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXA",9,0)
 ;               
"RTN","LEXRXA",10,0)
 ; External References
"RTN","LEXRXA",11,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXA",12,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXA",13,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXA",14,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXA",15,0)
 ;               
"RTN","LEXRXA",16,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXA",17,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXA",18,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXA",19,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXA",20,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXA",21,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXA",22,0)
 ;               
"RTN","LEXRXA",23,0)
 Q
"RTN","LEXRXA",24,0)
EN ; Main Entry Point
"RTN","LEXRXA",25,0)
R757 ; Repair file 757
"RTN","LEXRXA",26,0)
 D RB,SET Q
"RTN","LEXRXA",27,0)
RB ;   Index    ^LEX(757,"B",EXP,IEN) 
"RTN","LEXRXA",28,0)
 W:'$D(ZTQUEUED) ! N DA,DIK,LEXBEG,LEXDIF,LEXTC,LEXELP,LEXEND,LEXERR,LEXFI,LEXFQ,LEXIDX
"RTN","LEXRXA",29,0)
 N LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR,X S LEXFI=757
"RTN","LEXRXA",30,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757 ""B""") Q:LEXTC=1
"RTN","LEXRXA",31,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXIDX="B",LEXIDXT="^LEX(757,""B"",MC,IEN)"
"RTN","LEXRXA",32,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXA",33,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXA",34,0)
 . . S LEXNDS=LEXNDS+1
"RTN","LEXRXA",35,0)
 . . I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXA",36,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXA",37,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXA",38,0)
 . . N LEXOK,LEXMC S LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXA",39,0)
 . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXA",40,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXMC) ^LEX(LEXFI,LEXIDX,LEXMC,LEXIEN)=""
"RTN","LEXRXA",41,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXA",42,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXA",43,0)
 . N DA,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXA",44,0)
 . I '$D(^LEX(LEXFI,"B",X,DA)) S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXA",45,0)
 . S ^LEX(LEXFI,"B",X,DA)="" I '$D(^LEX(757.001,DA)) D
"RTN","LEXRXA",46,0)
 . . N LEXFQ,DIK S LEXFQ=+($$FREQ^LEXRXXM(DA)) S ^LEX(757.001,DA,0)=DA_"^"_LEXFQ_"^"_LEXFQ
"RTN","LEXRXA",47,0)
 . . S DIK="^LEX(757.001," D IX1^DIK
"RTN","LEXRXA",48,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXA",49,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXA",50,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXA",51,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXA",52,0)
 Q
"RTN","LEXRXA",53,0)
 ;              
"RTN","LEXRXA",54,0)
 ; Miscellaneous
"RTN","LEXRXA",55,0)
SET ;   Re-Index Major Concept Map file 757 (Set logic only)
"RTN","LEXRXA",56,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXA",57,0)
 N LEXOUT,LEXMSG S LEXFI=757
"RTN","LEXRXA",58,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXA",59,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXA",60,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXA",61,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXA",62,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXA",63,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXA",64,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXA",65,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXA",66,0)
 . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXA",67,0)
 . N DA,DIK S DA=+($G(LEXIEN)),DIK=LEXRT D IX1^DIK
"RTN","LEXRXA",68,0)
 S $P(^LEX(LEXFI,0),"^",3)=LEXP3,$P(^LEX(LEXFI,0),"^",4)=LEXP4
"RTN","LEXRXA",69,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXA",70,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXA",71,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXA",72,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXA",73,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXA",74,0)
 Q
"RTN","LEXRXA",75,0)
CLR ;   Clear
"RTN","LEXRXA",76,0)
 K LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXA",77,0)
 Q
"RTN","LEXRXB")
0^3^B52650110^n/a
"RTN","LEXRXB",1,0)
LEXRXB ;ISL/KER - Re-Index 757.001 B/AF ;08/17/2011
"RTN","LEXRXB",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXB",3,0)
 ;               
"RTN","LEXRXB",4,0)
 ; Global Variables
"RTN","LEXRXB",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXB",6,0)
 ;    ^LEX(757.001,       SACC 1.3
"RTN","LEXRXB",7,0)
 ;    ^LEX(757.02,        SACC 1.3
"RTN","LEXRXB",8,0)
 ;    ^LEX(757.1,         SACC 1.3
"RTN","LEXRXB",9,0)
 ;               
"RTN","LEXRXB",10,0)
 ; External References
"RTN","LEXRXB",11,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXB",12,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXB",13,0)
 ;    IX2^DIK             ICR  10013
"RTN","LEXRXB",14,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXB",15,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXB",16,0)
 ;               
"RTN","LEXRXB",17,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXB",18,0)
 ;     LEXFIX     Fix Flag        NEWed/KILLed by LEXRXXT
"RTN","LEXRXB",19,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXB",20,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXB",21,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXB",22,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXB",23,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXB",24,0)
 ;               
"RTN","LEXRXB",25,0)
 Q
"RTN","LEXRXB",26,0)
EN ; Main Entry Point
"RTN","LEXRXB",27,0)
R757001 ; Repair file 757.001
"RTN","LEXRXB",28,0)
 D RB,RAF,SET Q
"RTN","LEXRXB",29,0)
RB ;   Index    ^LEX(757.001,"B",MC,IEN) 
"RTN","LEXRXB",30,0)
 W:'$D(ZTQUEUED) ! N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR,X
"RTN","LEXRXB",31,0)
 S LEXFI="757.001"
"RTN","LEXRXB",32,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.001 ""B""") Q:LEXTC=1
"RTN","LEXRXB",33,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXIDX="B",LEXIDXT="^LEX(757.001,""B"",MC,IEN)"
"RTN","LEXRXB",34,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXB",35,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXB",36,0)
 . . S LEXNDS=LEXNDS+1 I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXB",37,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXB",38,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXB",39,0)
 . . Q:+LEXSTR>0&(LEXSTR=LEXIEN)  N LEXOK,LEXMC S LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXB",40,0)
 . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXB",41,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXMC) ^LEX(LEXFI,LEXIDX,LEXMC,LEXIEN)=""
"RTN","LEXRXB",42,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXB",43,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXB",44,0)
 . N DA,DIK,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXB",45,0)
 . I '$D(^LEX(LEXFI,"B",X,DA)) D
"RTN","LEXRXB",46,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXB",47,0)
 . S:$L(X) ^LEX(LEXFI,"B",X,DA)=""
"RTN","LEXRXB",48,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXB",49,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXB",50,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXB",51,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXB",52,0)
 Q
"RTN","LEXRXB",53,0)
RAF ;   Index    ^LEX(757.001,"AF",FREQ,IEN)
"RTN","LEXRXB",54,0)
 W:'$D(ZTQUEUED) ! N DA,DIK,LEXAF,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXFQ,LEXIEN,LEXNDS,LEXOF,LEXOK,LEXSTR,X
"RTN","LEXRXB",55,0)
 S LEXFI="757.001"
"RTN","LEXRXB",56,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.001 ""AF""") Q:LEXTC=1
"RTN","LEXRXB",57,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXIDX="AF",LEXIDXT="^LEX(757.001,""AF"",FREQ,IEN)"
"RTN","LEXRXB",58,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXB",59,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXB",60,0)
 . . S LEXNDS=LEXNDS+1
"RTN","LEXRXB",61,0)
 . . I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXB",62,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXB",63,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXB",64,0)
 . . N LEXOK,LEXFQ,LEXOF,LEXAF,LEXF S LEXFQ=+($P($G(^LEX(LEXFI,LEXIEN,0)),"^",3))
"RTN","LEXRXB",65,0)
 . . S LEXOF=+($P($G(^LEX(LEXFI,LEXIEN,0)),"^",2)) I LEXOF>LEXFQ D
"RTN","LEXRXB",66,0)
 . . . S LEXF=$$FREQ^LEXRXXM(LEXIEN) S:LEXF'>LEXFQ $P(^LEX(LEXFI,LEXIEN,0),"^",2)=LEXF,LEXOF=LEXF
"RTN","LEXRXB",67,0)
 . . . S:LEXF>LEXFQ $P(^LEX(LEXFI,LEXIEN,0),"^",2)=LEXF,$P(^LEX(LEXFI,LEXIEN,0),"^",3)=LEXF,(LEXOF,LEXFQ)=LEXF
"RTN","LEXRXB",68,0)
 . . S LEXAF=LEXFQ-LEXOF S:LEXAF>0 LEXAF=LEXAF*(-1)
"RTN","LEXRXB",69,0)
 . . S LEXOK=0 S:LEXAF=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXB",70,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXAF) ^LEX(LEXFI,LEXIDX,LEXAF,LEXIEN)=""
"RTN","LEXRXB",71,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXB",72,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXB",73,0)
 . N DA,DIK,X,LEXF S DA=LEXIEN,X=+($P($G(^LEX(LEXFI,DA,0)),"^",3)),LEXF=-(X-(+($P(^LEX(LEXFI,DA,0),"^",2))))
"RTN","LEXRXB",74,0)
 . I '$D(^LEX(LEXFI,"AF",LEXF,DA)) D
"RTN","LEXRXB",75,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXB",76,0)
 . S:$L(LEXF) ^LEX(LEXFI,"AF",LEXF,DA)=""
"RTN","LEXRXB",77,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXB",78,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXB",79,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXB",80,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXB",81,0)
 Q
"RTN","LEXRXB",82,0)
 ;              
"RTN","LEXRXB",83,0)
 ; Miscellaneous
"RTN","LEXRXB",84,0)
SET ;   Re-Index Concept Usage file 757.001 (Set logic only)
"RTN","LEXRXB",85,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXB",86,0)
 N LEXOUT,LEXMSG S LEXFI=757.001
"RTN","LEXRXB",87,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXB",88,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXB",89,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXB",90,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXB",91,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXB",92,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXB",93,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXB",94,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXB",95,0)
 . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXB",96,0)
 . N DA,DIK,LEXCFQ,LEXCMC,LEXCND,LEXCOV,LEXNFQ,LEXNND,LEXNOV
"RTN","LEXRXB",97,0)
 . S LEXCND=$G(^LEX(LEXFI,LEXIEN,0)),LEXCMC=+LEXCND,LEXCOV=$P(LEXCND,"^",2)
"RTN","LEXRXB",98,0)
 . S (LEXCFQ,LEXNFQ)=$P(LEXCND,"^",3),LEXNOV=$$FREQ(LEXIEN)
"RTN","LEXRXB",99,0)
 . S:LEXNOV>LEXNFQ LEXNFQ=LEXNOV S:LEXNOV'=LEXCOV LEXNFQ=LEXNOV
"RTN","LEXRXB",100,0)
 . I $D(LEXFIX) D  Q
"RTN","LEXRXB",101,0)
 . . Q:LEXCOV=LEXNOV&(LEXCFQ=LEXNFQ)
"RTN","LEXRXB",102,0)
 . . S DA=+($G(LEXIEN)),DIK=LEXRT D IX2^DIK
"RTN","LEXRXB",103,0)
 . . S ^LEX(LEXFI,LEXIEN,0)=LEXCMC_"^"_LEXNOV_"^"_LEXNFQ
"RTN","LEXRXB",104,0)
 . . D IX1^DIK
"RTN","LEXRXB",105,0)
 . S DA=+($G(LEXIEN)),DIK=LEXRT D IX1^DIK
"RTN","LEXRXB",106,0)
 S $P(^LEX(LEXFI,0),"^",3)=LEXP3,$P(^LEX(LEXFI,0),"^",4)=LEXP4
"RTN","LEXRXB",107,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXB",108,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXB",109,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXB",110,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXB",111,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXB",112,0)
 Q
"RTN","LEXRXB",113,0)
FREQ(X) ;   Get frequency based on codes and semantics
"RTN","LEXRXB",114,0)
 N LEXMC,LEXMCE,LEXND,LEXOF,LEXNF S LEXMC=+($G(X)),X=0 Q:'$D(^LEX(757,LEXMC,0)) X
"RTN","LEXRXB",115,0)
 S LEXMCE=$P($G(^LEX(757,+LEXMC,0)),"^",1)
"RTN","LEXRXB",116,0)
 S LEXOF=$P($G(^LEX(757.001,LEXMC,0)),"^",2)
"RTN","LEXRXB",117,0)
 N LEXSA,LEXSAB,LEXACT,LEXSMC,LEXNUR,LEXBEH,LEXI10,LEXPRO,LEXDIA
"RTN","LEXRXB",118,0)
 S (LEXSA,LEXNUR,LEXBEH,LEXPRO,LEXDIA,LEXI10,LEXSMC)=0 D SO,SM S X=0
"RTN","LEXRXB",119,0)
 S LEXNF="",X=0
"RTN","LEXRXB",120,0)
 ;     ICD-10-CM                       6
"RTN","LEXRXB",121,0)
 S:+LEXI10=1&(+LEXDIA=1) (LEXNF,X)=6 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",122,0)
 ;     ICD-10-PCS                      5
"RTN","LEXRXB",123,0)
 S:+LEXI10=1&(+LEXDIA'=1) (LEXNF,X)=5 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",124,0)
 ;     ICD-9 coded Diagnosis           4
"RTN","LEXRXB",125,0)
 S:LEXI10=0&(+LEXDIA=1)&(X=0) (LEXNF,X)=4 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",126,0)
 ;     Behavior or non-ICD Diagnosis   3
"RTN","LEXRXB",127,0)
 S:'$L(LEXNF)&(+($G(LEXBEH))=1)&($G(LEXSMC)>0) (LEXNF,X)=3 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",128,0)
 ;     Procedures                      2
"RTN","LEXRXB",129,0)
 S:'$L(LEXNF)&(+($G(LEXPRO))=1) (LEXNF,X)=2 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",130,0)
 ;     Nursing                         1
"RTN","LEXRXB",131,0)
 S:'$L(LEXNF)&(+($G(LEXNUR))=1) (LEXNF,X)=1 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",132,0)
 ;     Diseases                        3
"RTN","LEXRXB",133,0)
 S:'$L(LEXNF)&(+($G(LEXSMC))>1) (LEXNF,X)=3 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXB",134,0)
 ;     Non-Critical                    0
"RTN","LEXRXB",135,0)
 S:'$L(LEXNF) (LEXNF,X)=0
"RTN","LEXRXB",136,0)
 Q X
"RTN","LEXRXB",137,0)
SO ;   Codes
"RTN","LEXRXB",138,0)
 N LEXSA S LEXSA=0 F  S LEXSA=$O(^LEX(757.02,"AMC",LEXMC,LEXSA)) Q:+LEXSA=0  D SOC
"RTN","LEXRXB",139,0)
 Q
"RTN","LEXRXB",140,0)
SOC ;     Code Type
"RTN","LEXRXB",141,0)
 N LEXCOD,LEXEFF,LEXHIS,LEXND,LEXSAB
"RTN","LEXRXB",142,0)
 S LEXEFF=$O(^LEX(757.02,LEXSA,4,"B"," "),-1) Q:LEXEFF'?7N
"RTN","LEXRXB",143,0)
 S LEXHIS=$O(^LEX(757.02,LEXSA,4,"B",LEXEFF," "),-1) Q:+LEXHIS'>0
"RTN","LEXRXB",144,0)
 S LEXND=$G(^LEX(757.02,LEXSA,4,+LEXHIS,0)) Q:+($P(LEXND,"^",2))'>0
"RTN","LEXRXB",145,0)
 S LEXND=$G(^LEX(757.02,LEXSA,0)),LEXSAB=+($P(LEXND,U,3)),LEXCOD=$P(LEXND,U,2)
"RTN","LEXRXB",146,0)
 Q:LEXSAB=0
"RTN","LEXRXB",147,0)
 ;       ICD-10       CM/PCS
"RTN","LEXRXB",148,0)
 S:LEXSAB=30!(LEXSAB=31) LEXI10=1_"^"_LEXCOD
"RTN","LEXRXB",149,0)
 ;       Diagnosis    ICD-9 and ICD-10
"RTN","LEXRXB",150,0)
 S:LEXSAB=1!(LEXSAB=30) LEXDIA=1_"^"_LEXCOD
"RTN","LEXRXB",151,0)
 ;       Procedures   ICD-9, ICD-10, CPT and HCPCS
"RTN","LEXRXB",152,0)
 S:LEXSAB=2!(LEXSAB=31)!(LEXSAB=3)!(LEXSAB=4) LEXPRO=1_"^"_LEXCOD
"RTN","LEXRXB",153,0)
 ;       Behaviors    DSM-III and DSM-IV
"RTN","LEXRXB",154,0)
 S:LEXSAB=5!(LEXSAB=6) LEXBEH=1_"^"_LEXCOD
"RTN","LEXRXB",155,0)
 ;       Nursing      NANDA, NIC, NOC, HHC and Omaha
"RTN","LEXRXB",156,0)
 S:LEXSAB>10&(LEXSAB<16) LEXNUR=1_"^"_LEXCOD
"RTN","LEXRXB",157,0)
 Q
"RTN","LEXRXB",158,0)
SM ;   Semantics - BEH Behavior and DIS Disorders
"RTN","LEXRXB",159,0)
 N LEXBD,LEXCLA,LEXSM S LEXSMC=0,LEXMC=+($G(LEXMC)) Q:'$D(^LEX(757,LEXMC,0))
"RTN","LEXRXB",160,0)
 S (LEXBD,LEXSM)=0 F  S LEXSM=$O(^LEX(757.1,"B",LEXMC,LEXSM)) Q:+LEXSM=0  D SMC
"RTN","LEXRXB",161,0)
 S LEXSMC=LEXBD
"RTN","LEXRXB",162,0)
 Q
"RTN","LEXRXB",163,0)
SMC ;     Semantic Class
"RTN","LEXRXB",164,0)
 S LEXCLA=+($P($G(^LEX(757.1,LEXSM,0)),U,2))
"RTN","LEXRXB",165,0)
 ;       Behavior
"RTN","LEXRXB",166,0)
 S:LEXCLA=3&(LEXBD'>0) LEXBD=1
"RTN","LEXRXB",167,0)
 ;       Disease
"RTN","LEXRXB",168,0)
 S:LEXCLA=6 LEXBD=2
"RTN","LEXRXB",169,0)
 Q
"RTN","LEXRXB",170,0)
CLR ;   Clear
"RTN","LEXRXB",171,0)
 K LEXFIX,LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXB",172,0)
 Q
"RTN","LEXRXC")
0^4^B104836918^n/a
"RTN","LEXRXC",1,0)
LEXRXC ;ISL/KER - Re-Index 757.01 B/ADC/ADTERM ;08/17/2011
"RTN","LEXRXC",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXC",3,0)
 ;               
"RTN","LEXRXC",4,0)
 ; Global Variables
"RTN","LEXRXC",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXC",6,0)
 ;    ^LEX(757.01,        SACC 1.3
"RTN","LEXRXC",7,0)
 ;               
"RTN","LEXRXC",8,0)
 ; External References
"RTN","LEXRXC",9,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXC",10,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXC",11,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXC",12,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXC",13,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXC",14,0)
 ;               
"RTN","LEXRXC",15,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXC",16,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXC",17,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXC",18,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXC",19,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXC",20,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXC",21,0)
 ;     
"RTN","LEXRXC",22,0)
 Q
"RTN","LEXRXC",23,0)
 ; NOTES:
"RTN","LEXRXC",24,0)
 ;               
"RTN","LEXRXC",25,0)
 ;   The Major Concept Map file #757 is used to re-index
"RTN","LEXRXC",26,0)
 ;   the Expression file #757.01. hence file #757 must be 
"RTN","LEXRXC",27,0)
 ;   repaired/re-indexed before file 757.01.
"RTN","LEXRXC",28,0)
 ;                 
"RTN","LEXRXC",29,0)
EN ; Main Entry Point
"RTN","LEXRXC",30,0)
R75701 ; Repair file 757.01
"RTN","LEXRXC",31,0)
 D MC,RB,RADC,RADTERM,R75701^LEXRXC2,R75701^LEXRXC3,SET Q
"RTN","LEXRXC",32,0)
RB ;   Index    ^LEX(757.01,"B",TXT,IEN) 
"RTN","LEXRXC",33,0)
 ;            ^LEX(757.01,IEN,4,"B",NEG,IEN2)
"RTN","LEXRXC",34,0)
 ;            ^LEX(757.01,IEN,5,"B",WORD,IEN2)
"RTN","LEXRXC",35,0)
 W:'$D(ZTQUEUED) ! N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXEXP,LEXFI,LEXIDX,LEXIDXT,LEXIDNT,LEXIDST,LEXIEN,LEXMC,LEXNDS,LEXNDSN,LEXNDSS,LEXNER,LEXOK,LEXS,LEXSER,LEXSTR
"RTN","LEXRXC",36,0)
 S LEXFI="757.01"
"RTN","LEXRXC",37,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""B""") Q:LEXTC=1
"RTN","LEXRXC",38,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXNDSN,LEXNDSS,LEXERR,LEXSER,LEXNER)=0,LEXSTR="",LEXFI="757.01",LEXIDX="B"
"RTN","LEXRXC",39,0)
 S LEXIDXT="^LEX(757.01,""B"",TXT,IEN)",LEXIDNT="^LEX(757.01,IEN,4,""B"",NEG,IEN2)",LEXIDST="^LEX(757.01,IEN,5,""B"",WORD,IEN2)"
"RTN","LEXRXC",40,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",41,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",42,0)
 . . S LEXNDS=LEXNDS+1 I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXC",43,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXC",44,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC",45,0)
 . . N LEXOK,LEXEXP S LEXEXP=$$UP^XLFSTR($G(^LEX(LEXFI,LEXIEN,0)))
"RTN","LEXRXC",46,0)
 . . S LEXOK=0 S:$E(LEXEXP,1,63)=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC",47,0)
 . . . S LEXERR=LEXERR+1
"RTN","LEXRXC",48,0)
 . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXEXP) ^LEX(LEXFI,LEXIDX,$E(LEXEXP,1,63),LEXIEN)=""
"RTN","LEXRXC",49,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,$E(LEXSTR,1,26),?58,"  ",LEXIEN
"RTN","LEXRXC",50,0)
 . . I $D(^LEX(LEXFI,LEXIEN,4)) D
"RTN","LEXRXC",51,0)
 . . . N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",52,0)
 . . . . N LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXC",53,0)
 . . . . . S LEXNDSN=LEXNDSN+1 N LEXOK,LEXMC S LEXMC=$G(^LEX(LEXFI,LEXIEN,4,LEXS,0))
"RTN","LEXRXC",54,0)
 . . . . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC",55,0)
 . . . . . . S LEXNER=LEXNER+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR,LEXS)
"RTN","LEXRXC",56,0)
 . . . . . . S:$L(LEXMC) ^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXMC,LEXS)=""
"RTN","LEXRXC",57,0)
 . . . . . . I '$D(ZTQUEUED) W !,?10,757.17,?19,LEXIDX,?30,$E(LEXSTR,1,26),?58,"  ",LEXIEN,"/",LEXS
"RTN","LEXRXC",58,0)
 . . . S LEXSTR=0 F  S LEXSTR=$O(^LEX(LEXFI,LEXIEN,4,LEXSTR)) Q:+LEXSTR'>0  D
"RTN","LEXRXC",59,0)
 . . . . N DA,X S X=$P($G(^LEX(LEXFI,LEXIEN,4,LEXSTR,0)),"^",1),DA(1)=LEXIEN,DA=LEXSTR
"RTN","LEXRXC",60,0)
 . . . . I $L(X) I '$D(^LEX(LEXFI,DA(1),4,LEXIDX,X,DA)) D  Q
"RTN","LEXRXC",61,0)
 . . . . . S LEXNER=LEXNER+1,^LEX(LEXFI,DA(1),4,LEXIDX,X,DA)=""
"RTN","LEXRXC",62,0)
 . . . . . I '$D(ZTQUEUED) W !,?10,757.17,?19,LEXIDX,?30,"Missing",?58,"  ",DA(1),"/",DA
"RTN","LEXRXC",63,0)
 . . I $D(^LEX(LEXFI,LEXIEN,5)) D
"RTN","LEXRXC",64,0)
 . . . N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIEN,5,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",65,0)
 . . . . N LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,5,LEXIDX,LEXSTR,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXC",66,0)
 . . . . . S LEXNDSS=LEXNDSS+1 N LEXOK,LEXMC S LEXMC=$G(^LEX(LEXFI,LEXIEN,5,LEXS,0))
"RTN","LEXRXC",67,0)
 . . . . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC",68,0)
 . . . . . . S LEXSER=LEXSER+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIEN,5,LEXIDX,LEXSTR,LEXS) S:$L(LEXMC) ^LEX(LEXFI,LEXIEN,5,LEXIDX,LEXMC,LEXS)=""
"RTN","LEXRXC",69,0)
 . . . . . . I '$D(ZTQUEUED) W !,?10,757.18,?19,LEXIDX,?30,$E(LEXSTR,1,26),?58,"  ",LEXIEN,"/",LEXS
"RTN","LEXRXC",70,0)
 . . . S LEXSTR=0 F  S LEXSTR=$O(^LEX(LEXFI,LEXIEN,5,LEXSTR)) Q:+LEXSTR'>0  D
"RTN","LEXRXC",71,0)
 . . . . N DA,X S X=$P($G(^LEX(LEXFI,LEXIEN,5,LEXSTR,0)),"^",1),DA(1)=LEXIEN,DA=LEXSTR
"RTN","LEXRXC",72,0)
 . . . . I $L(X) I '$D(^LEX(LEXFI,DA(1),5,LEXIDX,X,DA)) D  Q
"RTN","LEXRXC",73,0)
 . . . . . S LEXSER=LEXSER+1,^LEX(LEXFI,DA(1),5,LEXIDX,X,DA)=""
"RTN","LEXRXC",74,0)
 . . . . . I '$D(ZTQUEUED) W !,?10,757.18,?19,LEXIDX,?30,"Missing",?58,"  ",DA(1),"/",DA
"RTN","LEXRXC",75,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",76,0)
 . N DA,DIK,X S DA=LEXIEN,X=$$UP^XLFSTR($G(^LEX(LEXFI,LEXIEN,0))) Q:'$L(X)
"RTN","LEXRXC",77,0)
 . I '$D(^LEX(LEXFI,"B",$E(X,1,63),DA)) D
"RTN","LEXRXC",78,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXC",79,0)
 . S:$L(X) ^LEX(LEXFI,"B",$E(X,1,63),DA)=""
"RTN","LEXRXC",80,0)
 . N LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,4,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXC",81,0)
 . . N DA,DIK,X S DA(1)=LEXIEN,DA=LEXS,X=$P($G(^LEX(LEXFI,DA(1),4,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXC",82,0)
 . . I '$D(^LEX(LEXFI,DA(1),4,"B",X,DA)) D
"RTN","LEXRXC",83,0)
 . . . S LEXNER=LEXNER+1 I '$D(ZTQUEUED) W !,?10,757.17,?19,LEXIDX,?30,"Missing",?58,"  ",DA(1),"/",DA
"RTN","LEXRXC",84,0)
 . . S:$L(X) ^LEX(LEXFI,DA(1),4,"B",X,DA)=""
"RTN","LEXRXC",85,0)
 . S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,5,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXC",86,0)
 . . N DA,DIK,X S DA(1)=LEXIEN,DA=LEXS,X=$P($G(^LEX(LEXFI,DA(1),5,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXC",87,0)
 . . I '$D(^LEX(LEXFI,DA(1),5,"B",X,DA)) D
"RTN","LEXRXC",88,0)
 . . . S LEXSER=LEXSER+1 I '$D(ZTQUEUED) W !,?10,757.18,?19,LEXIDX,?30,"Missing",?58,"  ",DA(1),"/",DA
"RTN","LEXRXC",89,0)
 . . S:$L(X) ^LEX(LEXFI,DA(1),5,"B",X,DA)=""
"RTN","LEXRXC",90,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC",91,0)
 S LEXNER=$S(+LEXNER>0:LEXNER,1:"") I '$D(ZTQUEUED) W !,$J(LEXNER,5),?10,757.17,?19,LEXIDX,?30,LEXIDNT
"RTN","LEXRXC",92,0)
 S LEXSER=$S(+LEXSER>0:LEXSER,1:"") I '$D(ZTQUEUED) W !,$J(LEXSER,5),?10,757.18,?19,LEXIDX,?30,LEXIDST
"RTN","LEXRXC",93,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC",94,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC",95,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC",96,0)
 D REP^LEXRXXS(LEXFI,757.17,LEXIDX,LEXNDSN,LEXNER,LEXIDNT)
"RTN","LEXRXC",97,0)
 D REP^LEXRXXS(LEXFI,757.18,LEXIDX,LEXNDSS,LEXSER,LEXIDST)
"RTN","LEXRXC",98,0)
 Q
"RTN","LEXRXC",99,0)
RADC ;   Index    ^LEX(757.01,"ADC",1,IEN)
"RTN","LEXRXC",100,0)
 W:'$D(ZTQUEUED) ! N DA,DIK,LEXBEG,LEXDF,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXC",101,0)
 S LEXFI="757.01"
"RTN","LEXRXC",102,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""ADC""") Q:LEXTC=1
"RTN","LEXRXC",103,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.01,LEXIDX="ADC",LEXIDXT="^LEX(757.01,""ADC"",1,IEN)"
"RTN","LEXRXC",104,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",105,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",106,0)
 . . S LEXNDS=LEXNDS+1 I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXC",107,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXC",108,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC",109,0)
 . . N LEXOK,LEXDF S LEXDF=+($P($G(^LEX(LEXFI,LEXIEN,1)),"^",5))
"RTN","LEXRXC",110,0)
 . . S LEXOK=0 S:LEXDF=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC",111,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXDF) ^LEX(LEXFI,LEXIDX,LEXDF,LEXIEN)=""
"RTN","LEXRXC",112,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC",113,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",114,0)
 . N DA,DIK,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,+DA,1)),"^",5)
"RTN","LEXRXC",115,0)
 . I +X'>0,$D(^LEX(LEXFI,"ADC",+X,+DA)) D  Q
"RTN","LEXRXC",116,0)
 . . S LEXERR=LEXERR+1
"RTN","LEXRXC",117,0)
 . . K:'$D(LEXTEST) ^LEX(LEXFI,"ADC",+X,+DA),^LEX(LEXFI,"ADC",1,+DA)
"RTN","LEXRXC",118,0)
 . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (0)",?58,"  ",DA
"RTN","LEXRXC",119,0)
 . I +X>0,'$D(^LEX(LEXFI,"ADC",+X,+DA)) D  Q
"RTN","LEXRXC",120,0)
 . . Q:+X'=1  S LEXERR=LEXERR+1
"RTN","LEXRXC",121,0)
 . . S:'$D(LEXTEST) ^LEX(LEXFI,"ADC",+X,+DA)=""
"RTN","LEXRXC",122,0)
 . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXC",123,0)
 . S:+X>0 ^LEX(LEXFI,"ADC",+X,+DA)=""
"RTN","LEXRXC",124,0)
 . I +X>0,+X'=1 D  Q
"RTN","LEXRXC",125,0)
 . . S LEXERR=LEXERR+1
"RTN","LEXRXC",126,0)
 . . K:'$D(LEXTEST) ^LEX(LEXFI,"ADC",+X,+DA)
"RTN","LEXRXC",127,0)
 . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (>1)",?58,"  ",DA
"RTN","LEXRXC",128,0)
 . K:'$D(LEXTEST)&(+X'=1) ^LEX(LEXFI,"ADC",+X,+DA),^LEX(LEXFI,"ADC",1,+DA)
"RTN","LEXRXC",129,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC",130,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC",131,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC",132,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC",133,0)
 Q
"RTN","LEXRXC",134,0)
RADTERM ;   Index    ^LEX(757.01,"ADTERM",DT,IEN) 
"RTN","LEXRXC",135,0)
 N DA,DIK,LEXBEG,LEXDE,LEXDF,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXC",136,0)
 S LEXFI="757.01"
"RTN","LEXRXC",137,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""ADTERM""") Q:LEXTC=1
"RTN","LEXRXC",138,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.01,LEXIDX="ADTERM",LEXIDXT="^LEX(757.01,""ADTERM"",EXP,IEN)"
"RTN","LEXRXC",139,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",140,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",141,0)
 . . S LEXNDS=LEXNDS+1 I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXC",142,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXC",143,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC",144,0)
 . . N LEXOK,LEXDF,LEXDE S LEXDF=+($P($G(^LEX(LEXFI,LEXIEN,1)),"^",5))
"RTN","LEXRXC",145,0)
 . . S LEXDE=$E($P($G(^LEX(LEXFI,LEXIEN,0)),U,1),1,63)
"RTN","LEXRXC",146,0)
 . . S LEXOK=0 S:LEXDE=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC",147,0)
 . . . S LEXERR=LEXERR+1
"RTN","LEXRXC",148,0)
 . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:+LEXDF>0&($L(LEXDE)) ^LEX(LEXFI,LEXIDX,LEXDE,LEXIEN)=""
"RTN","LEXRXC",149,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,$E(LEXSTR,1,20),$S($L(LEXSTR)>20:"...",1:""),?58,"  ",LEXIEN
"RTN","LEXRXC",150,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",151,0)
 . N DA,DIK,LEXDF,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXC",152,0)
 . S LEXDF=+($P($G(^LEX(LEXFI,DA,1)),"^",5))
"RTN","LEXRXC",153,0)
 . I +LEXDF>0,'$D(^LEX(LEXFI,LEXIDX,$E(X,1,63),DA)) D
"RTN","LEXRXC",154,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXC",155,0)
 . I +LEXDF'>0,$D(^LEX(LEXFI,LEXIDX,$E(X,1,63),DA)) D
"RTN","LEXRXC",156,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (deleted)",?58,"  ",DA
"RTN","LEXRXC",157,0)
 . S:$L(X)&(+LEXDF>0) ^LEX(LEXFI,LEXIDX,$E(X,1,63),DA)=""
"RTN","LEXRXC",158,0)
 . K:$L(X)&(+LEXDF'>0) ^LEX(LEXFI,LEXIDX,$E(X,1,63),DA)
"RTN","LEXRXC",159,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC",160,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC",161,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC",162,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC",163,0)
 Q
"RTN","LEXRXC",164,0)
 ;              
"RTN","LEXRXC",165,0)
 ; Miscellaneous
"RTN","LEXRXC",166,0)
SET ;   Re-Index Expression file 757.01 (Set logic only)
"RTN","LEXRXC",167,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXC",168,0)
 N LEXOUT,LEXMSG S LEXFI=757.01
"RTN","LEXRXC",169,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXC",170,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXC",171,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXC",172,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXC",173,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXC",174,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXC",175,0)
 D DL,MC
"RTN","LEXRXC",176,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXC",177,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",178,0)
 . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXC",179,0)
 . N DA,DIK S DA=LEXIEN,DIK=LEXRT D IX1^DIK
"RTN","LEXRXC",180,0)
 D RL,SL S $P(^LEX(LEXFI,0),"^",3)=LEXP3,$P(^LEX(LEXFI,0),"^",4)=LEXP4
"RTN","LEXRXC",181,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC",182,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC",183,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXC",184,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXC",185,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXC",186,0)
 Q
"RTN","LEXRXC",187,0)
DL ;     De-Link AWRD
"RTN","LEXRXC",188,0)
 N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(757.05,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",189,0)
 . N LEXNC,LEXND,LEXNN,LEXWRD S LEXND=$G(^LEX(757.05,+LEXIEN,0)) Q:$P(LEXND,"^",3)'="L"  S LEXWRD=$P(LEXND,"^",1)
"RTN","LEXRXC",190,0)
 . S LEXNN="^LEX(757.01,""AWRD"","""_LEXWRD_""")",LEXNC="^LEX(757.01,""AWRD"","""_LEXWRD_""","
"RTN","LEXRXC",191,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  K:LEXNN[",""LINKED"")" @LEXNN
"RTN","LEXRXC",192,0)
 Q
"RTN","LEXRXC",193,0)
MC ;     Major Concept Map File
"RTN","LEXRXC",194,0)
 N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(757,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",195,0)
 . N DA,DIK S DA=LEXIEN,DIK="^LEX(757," D IX1^DIK
"RTN","LEXRXC",196,0)
 Q
"RTN","LEXRXC",197,0)
RL ;     Re-Link 757.05
"RTN","LEXRXC",198,0)
 N LEXIEN S LEXIEN=" " F  S LEXIEN=$O(^LEX(757.05,LEXIEN)) Q:'$L(LEXIEN)  K:LEXIEN?1U.U ^LEX(757.05,LEXIEN)
"RTN","LEXRXC",199,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(757.05,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC",200,0)
 . N DA,DIK S DA=LEXIEN K ^LEX(757.05,DA,1,"B") S DA=LEXIEN,DIK="^LEX(757.05," D IX1^DIK
"RTN","LEXRXC",201,0)
 Q
"RTN","LEXRXC",202,0)
SL ;     String Length ASL
"RTN","LEXRXC",203,0)
 N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(757.01,"ASL",LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC",204,0)
 . N LEXSCT,LEXPSCT S LEXSCT=$$SCT^LEXRXC3(LEXSTR)
"RTN","LEXRXC",205,0)
 . S LEXPSCT=$O(^LEX(757.01,"ASL",LEXSTR,0))
"RTN","LEXRXC",206,0)
 . I +LEXPSCT>0,+LEXSCT'>0 K ^LEX(757.01,"ASL",LEXSTR,+LEXPSCT)
"RTN","LEXRXC",207,0)
 . I +LEXPSCT>0,+LEXSCT>0,+LEXPSCT'=LEXSCT D
"RTN","LEXRXC",208,0)
 . . K ^LEX(757.01,"ASL",LEXSTR,+LEXPSCT) S ^LEX(757.01,"ASL",LEXSTR,+LEXSCT)=""
"RTN","LEXRXC",209,0)
 Q
"RTN","LEXRXC",210,0)
CLR ;   Clear
"RTN","LEXRXC",211,0)
 K LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXC",212,0)
 Q
"RTN","LEXRXC2")
0^5^B70264191^n/a
"RTN","LEXRXC2",1,0)
LEXRXC2 ;ISL/KER - Re-Index 757.01 AMC/AWRD ;08/17/2011
"RTN","LEXRXC2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXC2",3,0)
 ;               
"RTN","LEXRXC2",4,0)
 ; Global Variables
"RTN","LEXRXC2",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXC2",6,0)
 ;    ^LEX(757.01,        SACC 1.3
"RTN","LEXRXC2",7,0)
 ;    ^LEX(757.04,        SACC 1.3
"RTN","LEXRXC2",8,0)
 ;    ^LEX(757.05,        SACC 1.3
"RTN","LEXRXC2",9,0)
 ;               
"RTN","LEXRXC2",10,0)
 ; External References
"RTN","LEXRXC2",11,0)
 ;    ^DIK                ICR  10013
"RTN","LEXRXC2",12,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXC2",13,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXC2",14,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXC2",15,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXC2",16,0)
 ;               
"RTN","LEXRXC2",17,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXC2",18,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXC2",19,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXC2",20,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXC2",21,0)
 ;               
"RTN","LEXRXC2",22,0)
 Q
"RTN","LEXRXC2",23,0)
 ; NOTES:
"RTN","LEXRXC2",24,0)
 ;               
"RTN","LEXRXC2",25,0)
 ;   The AMC cross-references is used to create the AWRD 
"RTN","LEXRXC2",26,0)
 ;   cross-reference, hence the AMC cross-reference must
"RTN","LEXRXC2",27,0)
 ;   be repaired/re-indexed before AWRD.
"RTN","LEXRXC2",28,0)
 ;               
"RTN","LEXRXC2",29,0)
 ;   The AWRD cross-references is used to create the ASL
"RTN","LEXRXC2",30,0)
 ;   cross-reference, hence the AWRD cross-reference must
"RTN","LEXRXC2",31,0)
 ;   be repaired/re-indexed before ASL.
"RTN","LEXRXC2",32,0)
 ;               
"RTN","LEXRXC2",33,0)
 ;   Re-indexing file 757.01 will Kill off all Linked Words 
"RTN","LEXRXC2",34,0)
 ;   from the Replacement Word file #757.05, hence after 
"RTN","LEXRXC2",35,0)
 ;   repairing/re-indexing file 757.01 you should immediatley
"RTN","LEXRXC2",36,0)
 ;   re-index file 757.05.
"RTN","LEXRXC2",37,0)
 ;               
"RTN","LEXRXC2",38,0)
EN ; Main Entry Point
"RTN","LEXRXC2",39,0)
R75701 ; Repair file 757.01
"RTN","LEXRXC2",40,0)
 D RAMC,RAWRD Q
"RTN","LEXRXC2",41,0)
RAMC ;   Index    ^LEX(757.01,"AMC",MC,IEN) 
"RTN","LEXRXC2",42,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXC2",43,0)
 S LEXFI="757.01"
"RTN","LEXRXC2",44,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""AMC""") Q:LEXTC=1
"RTN","LEXRXC2",45,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.01,LEXIDX="AMC",LEXIDXT="^LEX(757.01,""AMC"",MC,IEN)"
"RTN","LEXRXC2",46,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC2",47,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC2",48,0)
 . . S LEXNDS=LEXNDS+1
"RTN","LEXRXC2",49,0)
 . . I '$D(^LEX(LEXFI,LEXIEN,0)) D  Q
"RTN","LEXRXC2",50,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXC2",51,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC2",52,0)
 . . N LEXOK,LEXMC S LEXMC=+($P($G(^LEX(LEXFI,LEXIEN,1)),"^",1))
"RTN","LEXRXC2",53,0)
 . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC2",54,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:+LEXMC>0 ^LEX(LEXFI,LEXIDX,+LEXMC,LEXIEN)=""
"RTN","LEXRXC2",55,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC2",56,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC2",57,0)
 . N DA,DIK,X S DA=LEXIEN,X=+($G(^LEX(LEXFI,DA,1))) Q:'$L(X)
"RTN","LEXRXC2",58,0)
 . I '$D(^LEX(LEXFI,LEXIDX,X,DA)) D
"RTN","LEXRXC2",59,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXC2",60,0)
 . S:$L(X) ^LEX(LEXFI,LEXIDX,X,DA)=""
"RTN","LEXRXC2",61,0)
 . S ^LEX(LEXFI,LEXIDX,X,DA)=""
"RTN","LEXRXC2",62,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC2",63,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC2",64,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC2",65,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC2",66,0)
 Q
"RTN","LEXRXC2",67,0)
RAWRD ;   Index    ^LEX(757.01,"AWRD",WORD,MC,EXP)
"RTN","LEXRXC2",68,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXE,LEXELP,LEXEND,LEXERR,LEXEXCL,LEXEXP,LEXFI,LEXHI,LEXI,LEXIDX,LEXIDXT,LEXL,LEXLO,LEXM
"RTN","LEXRXC2",69,0)
 N LEXMCE,LEXNDS,LEXS,LEXS1,LEXS2,LEXS3,LEXS4,LEXSTR,LEXT,LEXTC,LEXTK,LEXTKN,LEXTNG,LEXW,LEXWDS,X
"RTN","LEXRXC2",70,0)
 S LEXFI="757.01"
"RTN","LEXRXC2",71,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""AWRD""") Q:LEXTC=1
"RTN","LEXRXC2",72,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXFI=757.01,LEXIDX="AWRD",LEXIDXT="^LEX(757.01,""AWRD"",WORD,MC,EXP)"
"RTN","LEXRXC2",73,0)
 S LEXTKN="" F  S LEXTKN=$O(^LEX(LEXFI,LEXIDX,LEXTKN)) Q:'$L(LEXTKN)  D
"RTN","LEXRXC2",74,0)
 . S LEXEXCL=0 I $O(^LEX(757.04,"B",LEXTKN,0))>0 D
"RTN","LEXRXC2",75,0)
 . . S LEXEXCL=$P($G(^LEX(757.04,+($O(^LEX(757.04,"B",LEXTKN,0))),0)),"^",2),LEXEXCL=$S(LEXEXCL="B":1,LEXEXCL="I":1,1:0)
"RTN","LEXRXC2",76,0)
 . S LEXS1="" F  S LEXS1=$O(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1)) Q:'$L(LEXS1)  D
"RTN","LEXRXC2",77,0)
 . . S LEXS2="" F  S LEXS2=$O(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2)) Q:'$L(LEXS2)  D
"RTN","LEXRXC2",78,0)
 . . . ;     Supplemental   ^LEX(757.01,"AWRD",WORD,IEN,MC,SUP)
"RTN","LEXRXC2",79,0)
 . . . ;       Duplicates
"RTN","LEXRXC2",80,0)
 . . . N LEXLO,LEXHI F  D  Q:+($G(LEXHI))'>+($G(LEXLO))
"RTN","LEXRXC2",81,0)
 . . . . N DA,DIK S LEXLO=$O(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2,"")),LEXHI=$O(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2," "),-1) Q:(+LEXLO+LEXHI)'>0
"RTN","LEXRXC2",82,0)
 . . . . I LEXLO>0,LEXHI>0,LEXHI>LEXLO S DA(1)=LEXS1,DA=LEXHI S DIK="^LEX(757.01,"_DA(1)_",5," D:$D(@(DIK_DA_",0)")) ^DIK
"RTN","LEXRXC2",83,0)
 . . . I $D(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2))=10!($D(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2))=11) D
"RTN","LEXRXC2",84,0)
 . . . . N LEXS3 S LEXS3="" F  S LEXS3=$O(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2,LEXS3)) Q:'$L(LEXS3)  D
"RTN","LEXRXC2",85,0)
 . . . . . N LEXEXP,LEXMCE,LEXSTR S LEXNDS=+($G(LEXNDS))+1
"RTN","LEXRXC2",86,0)
 . . . . . S LEXEXP=LEXS1,LEXMCE=+($$MCE^LEXRXXM(LEXEXP))
"RTN","LEXRXC2",87,0)
 . . . . . S LEXSTR=$P($G(^LEX(LEXFI,+LEXEXP,5,+LEXS3,0)),"^",1)
"RTN","LEXRXC2",88,0)
 . . . . . ;       Redundant
"RTN","LEXRXC2",89,0)
 . . . . . I $D(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2))=11 D
"RTN","LEXRXC2",90,0)
 . . . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"1",?8,LEXFI,?19,LEXIDX,?30,LEXTKN,?58,"  ",LEXS1,"/",LEXS2,"/",LEXS3
"RTN","LEXRXC2",91,0)
 . . . . . . I '$D(LEXTEST) D
"RTN","LEXRXC2",92,0)
 . . . . . . . N DA,DIK,LEXI,LEXIDX,LEXT,LEXWDS
"RTN","LEXRXC2",93,0)
 . . . . . . . S LEXT=$P($G(^LEX(757.01,+LEXEXP,0)),"^",1),LEXI=0 D WORDS^LEXRXXP(LEXT,.LEXWDS) S LEXIDX="AWRD"
"RTN","LEXRXC2",94,0)
 . . . . . . . Q:'$D(LEXWDS(LEXTKN))  S DA(1)=LEXEXP,DA=LEXS3,DIK="^LEX(757.01,"_DA(1)_",5," I $D(@(DIK_DA_",0)")) D
"RTN","LEXRXC2",95,0)
 . . . . . . . . D ^DIK K ^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2,LEXS3)
"RTN","LEXRXC2",96,0)
 . . . . . ;       Verify
"RTN","LEXRXC2",97,0)
 . . . . . N LEXS D SUP^LEXRXXP(LEXEXP,.LEXS) I '$D(LEXS("S",LEXTKN,LEXS1,LEXS2,LEXS3)) D
"RTN","LEXRXC2",98,0)
 . . . . . . Q:+LEXS3'>0  S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"2",?8,LEXFI,?19,LEXIDX,?30,LEXTKN,?58,"  ",LEXS1,"/",LEXS2,"/",LEXS3
"RTN","LEXRXC2",99,0)
 . . . . . . I '$D(LEXTEST) K ^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2,LEXS3)
"RTN","LEXRXC2",100,0)
 . . . ;     Linked         ^LEX(757.01,"AWRD",WORD,IEN,"LINKED")
"RTN","LEXRXC2",101,0)
 . . . I $D(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2))=1,LEXS2="LINKED" D  Q
"RTN","LEXRXC2",102,0)
 . . . . N LEXEXP,LEXL S LEXEXP=LEXS1,LEXNDS=+($G(LEXNDS))+1 D LINK^LEXRXXP(LEXEXP,.LEXL)
"RTN","LEXRXC2",103,0)
 . . . . Q:$D(LEXL("R",LEXTKN,+LEXEXP,"LINKED"))!($D(LEXL("L",LEXTKN,+LEXEXP,"LINKED")))
"RTN","LEXRXC2",104,0)
 . . . . I '$D(LEXL("R",LEXTKN,+LEXEXP,"LINKED"))&($D(LEXL("L",LEXTKN,+LEXEXP,"LINKED"))) D
"RTN","LEXRXC2",105,0)
 . . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"3",?8,LEXFI,?19,LEXIDX,?30,LEXTKN,?58,"  ",LEXS1,"/",LEXS2
"RTN","LEXRXC2",106,0)
 . . . . . I '$D(LEXTEST) K ^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2)
"RTN","LEXRXC2",107,0)
 . . . ;     Words          ^LEX(757.01,"AWRD",WORD,MC,IEN)
"RTN","LEXRXC2",108,0)
 . . . I $D(^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2))=1,+LEXS2>0,$D(^LEX(757.01,+LEXS2,0)) D  Q
"RTN","LEXRXC2",109,0)
 . . . . N LEXW,LEXIDX D AWRD^LEXRXXP(+LEXS2,.LEXW,1) S LEXIDX="AWRD" S LEXNDS=+($G(LEXNDS))+1
"RTN","LEXRXC2",110,0)
 . . . . I '$D(LEXW("W",LEXTKN,LEXS1,LEXS2)) D  Q
"RTN","LEXRXC2",111,0)
 . . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"4",?8,LEXFI,?19,LEXIDX,?30,LEXTKN,?58,"  ",LEXS2
"RTN","LEXRXC2",112,0)
 . . . . . I '$D(LEXTEST) K ^LEX(LEXFI,LEXIDX,LEXTKN,LEXS1,LEXS2)
"RTN","LEXRXC2",113,0)
 S LEXEXP=0 F  S LEXEXP=$O(^LEX(LEXFI,LEXEXP)) Q:+LEXEXP'>0  D
"RTN","LEXRXC2",114,0)
 . N DA,DIK,LEXS,LEXS1,LEXS1,LEXS3,LEXS4,X S DA=$G(LEXEXP),X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXC2",115,0)
 . I $L(X),$D(^LEX(LEXFI,+($G(DA)),0)),$D(^LEX(LEXFI,+($G(DA)),1)) D
"RTN","LEXRXC2",116,0)
 . . N LEXW,LEXTK,LEXM,LEXE S ^LEX(LEXFI,"B",$$UP^XLFSTR($E(X,1,63)),DA)=""
"RTN","LEXRXC2",117,0)
 . . D AWRD^LEXRXXP(+DA,.LEXW,1) S LEXTK="" F  S LEXTK=$O(LEXW("W",LEXTK)) Q:'$L(LEXTK)  D
"RTN","LEXRXC2",118,0)
 . . . S LEXM=0 F  S LEXM=$O(LEXW("W",LEXTK,LEXM)) Q:+LEXM'>0  D
"RTN","LEXRXC2",119,0)
 . . . . S LEXE=0 F  S LEXE=$O(LEXW("W",LEXTK,LEXM,LEXE)) Q:+LEXE'>0  D
"RTN","LEXRXC2",120,0)
 . . . . . Q:$D(^LEX(757.01,"AWRD",LEXTK,LEXM))
"RTN","LEXRXC2",121,0)
 . . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"5",?8,LEXFI,?19,LEXIDX,?30,"Missing ",$E(LEXTK,1,18),?58,"  ",LEXM,"/",LEXE
"RTN","LEXRXC2",122,0)
 . . . . . S ^LEX(757.01,"AWRD",LEXTK,LEXM,LEXE)=""
"RTN","LEXRXC2",123,0)
 . K LEXS D SUP^LEXRXXP(LEXEXP,.LEXS)
"RTN","LEXRXC2",124,0)
 . S LEXS1="" F  S LEXS1=$O(LEXS("S",LEXS1)) Q:'$L(LEXS1)  S LEXS2="" F  S LEXS2=$O(LEXS("S",LEXS1,LEXS2)) Q:'$L(LEXS2)  D
"RTN","LEXRXC2",125,0)
 . . S LEXS3="" F  S LEXS3=$O(LEXS("S",LEXS1,LEXS2,LEXS3)) Q:'$L(LEXS3)  S LEXS4="" F  S LEXS4=$O(LEXS("S",LEXS1,LEXS2,LEXS3,LEXS4)) Q:'$L(LEXS4)  D
"RTN","LEXRXC2",126,0)
 . . . I '$D(^LEX(757.01,"AWRD",LEXS1,LEXS2,LEXS3,LEXS4)) D
"RTN","LEXRXC2",127,0)
 . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"6",?8,LEXFI,?19,LEXIDX,?30,"Missing ",$E(LEXS1,1,18),?58,"  ",LEXS2,"/",LEXS3,"/",LEXS4
"RTN","LEXRXC2",128,0)
 . . . . S ^LEX(757.01,"AWRD",LEXS1,LEXS2,LEXS3,LEXS4)=""
"RTN","LEXRXC2",129,0)
 . K LEXS D LINK^LEXRXXP(LEXEXP,.LEXS)
"RTN","LEXRXC2",130,0)
 . S LEXS1="" F  S LEXS1=$O(LEXS("L",LEXS1)) Q:'$L(LEXS1)  S LEXS2="" F  S LEXS2=$O(LEXS("L",LEXS1,LEXS2)) Q:'$L(LEXS2)  D
"RTN","LEXRXC2",131,0)
 . . S LEXS3="" F  S LEXS3=$O(LEXS("L",LEXS1,LEXS2,LEXS3)) Q:'$L(LEXS3)  D
"RTN","LEXRXC2",132,0)
 . . . I '$D(^LEX(757.01,"AWRD",LEXS1,LEXS2,LEXS3)) D
"RTN","LEXRXC2",133,0)
 . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"7",?8,LEXFI,?19,LEXIDX,?30,"Missing ",$E(LEXS1,1,18),?58,"  ",LEXS2,"/",LEXS3
"RTN","LEXRXC2",134,0)
 . . . . S ^LEX(757.01,"AWRD",LEXS1,LEXS2,LEXS3)=""
"RTN","LEXRXC2",135,0)
 . S LEXS1="" F  S LEXS1=$O(LEXS("R",LEXS1)) Q:'$L(LEXS1)  S LEXS2="" F  S LEXS2=$O(LEXS("R",LEXS1,LEXS2)) Q:'$L(LEXS2)  D
"RTN","LEXRXC2",136,0)
 . . S LEXS3="" F  S LEXS3=$O(LEXS("R",LEXS1,LEXS2,LEXS3)) Q:'$L(LEXS3)  D
"RTN","LEXRXC2",137,0)
 . . . I '$D(^LEX(757.01,"AWRD",LEXS1,LEXS2)) D
"RTN","LEXRXC2",138,0)
 . . . . Q:$D(^LEX(757.04,"ACTION",LEXS1,"B"))!($D(^LEX(757.04,"ACTION",LEXS1,"I")))
"RTN","LEXRXC2",139,0)
 . . . . S LEXERR=+($G(LEXERR))+1 I '$D(ZTQUEUED) W !,"8",?8,LEXFI,?19,LEXIDX,?30,"Missing ",$E(LEXS1,1,18),?58,"  ",LEXS2,"/",LEXS3
"RTN","LEXRXC2",140,0)
 . . . . S ^LEX(757.01,"AWRD",LEXS1,LEXS2,LEXS3)=""
"RTN","LEXRXC2",141,0)
 . K LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXEXP,5,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXC2",142,0)
 . . N DA,DIK S DA(1)=LEXEXP,DA=LEXS,DIK="^LEX(757.01,"_DA(1)_",5," D IX1^DIK
"RTN","LEXRXC2",143,0)
 S LEXEXP=0 F  S LEXEXP=$O(^LEX(757.05,LEXEXP)) Q:+LEXEXP'>0  D
"RTN","LEXRXC2",144,0)
 . N DA,DIK S DA=LEXEXP,DIK="^LEX(757.05," D IX1^DIK
"RTN","LEXRXC2",145,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC2",146,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC2",147,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC2",148,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC2",149,0)
 Q
"RTN","LEXRXC2",150,0)
 ;              
"RTN","LEXRXC2",151,0)
 ; Miscellaneous
"RTN","LEXRXC2",152,0)
CLR ;   Clear
"RTN","LEXRXC2",153,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXC2",154,0)
 Q
"RTN","LEXRXC3")
0^6^B17043792^n/a
"RTN","LEXRXC3",1,0)
LEXRXC3 ;ISL/KER - Re-Index 757.01 ASL/APAR ;08/17/2011
"RTN","LEXRXC3",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXC3",3,0)
 ;               
"RTN","LEXRXC3",4,0)
 ; Global Variables
"RTN","LEXRXC3",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXC3",6,0)
 ;    ^LEX(757.01,        SACC 1.3
"RTN","LEXRXC3",7,0)
 ;               
"RTN","LEXRXC3",8,0)
 ; External References
"RTN","LEXRXC3",9,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXC3",10,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXC3",11,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXC3",12,0)
 ;           
"RTN","LEXRXC3",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXC3",14,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXC3",15,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXC3",16,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXC3",17,0)
 ;               
"RTN","LEXRXC3",18,0)
 Q
"RTN","LEXRXC3",19,0)
EN ; Main Entry Point
"RTN","LEXRXC3",20,0)
R75701 ; Repair file 757.01
"RTN","LEXRXC3",21,0)
 D RASL,RAPAR Q
"RTN","LEXRXC3",22,0)
RASL ;   Index    ^LEX(757.01,"ASL",STR,FREQ) 
"RTN","LEXRXC3",23,0)
 N LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXNDS,LEXPSCT,LEXSCT,LEXSTR,LEXTC,LEXTNG
"RTN","LEXRXC3",24,0)
 S LEXFI="757.01"
"RTN","LEXRXC3",25,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""ASL""") Q:LEXTC=1
"RTN","LEXRXC3",26,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.01,LEXIDX="ASL",LEXIDXT="^LEX(757.01,""ASL"",STR,FREQ)"
"RTN","LEXRXC3",27,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC3",28,0)
 . S LEXNDS=LEXNDS+1
"RTN","LEXRXC3",29,0)
 . S LEXSCT=$$SCT^LEXRXC3(LEXSTR)
"RTN","LEXRXC3",30,0)
 . S LEXPSCT=$O(^LEX(LEXFI,LEXIDX,LEXSTR,0))
"RTN","LEXRXC3",31,0)
 . I +LEXPSCT>0,+LEXSCT'>0 D
"RTN","LEXRXC3",32,0)
 . . K ^LEX(LEXFI,LEXIDX,LEXSTR,+LEXPSCT)
"RTN","LEXRXC3",33,0)
 . . I $D(LEXTEST),'$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (deleted) ",LEXSTR
"RTN","LEXRXC3",34,0)
 . I +LEXPSCT>0,+LEXSCT>0,+LEXPSCT'=LEXSCT D
"RTN","LEXRXC3",35,0)
 . . K ^LEX(LEXFI,LEXIDX,LEXSTR,+LEXPSCT) S ^LEX(LEXFI,LEXIDX,LEXSTR,+LEXSCT)=""
"RTN","LEXRXC3",36,0)
 . . I $D(LEXTEST),'$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Re-Calculated ",LEXSTR
"RTN","LEXRXC3",37,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"")
"RTN","LEXRXC3",38,0)
 I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC3",39,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC3",40,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC3",41,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC3",42,0)
 Q
"RTN","LEXRXC3",43,0)
RAPAR ;   Index    ^LEX(757.01,"APAR",MC,IEN) 
"RTN","LEXRXC3",44,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXPAR,LEXPR,LEXSTR
"RTN","LEXRXC3",45,0)
 S LEXFI="757.01"
"RTN","LEXRXC3",46,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.01 ""APAR""") Q:LEXTC=1
"RTN","LEXRXC3",47,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.01,LEXIDX="APAR",LEXIDXT="^LEX(757.01,""APAR"",PARENT,IEN)"
"RTN","LEXRXC3",48,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXC3",49,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC3",50,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXPR S LEXPR=+($P($G(^LEX(LEXFI,LEXIEN,1)),"^",9))
"RTN","LEXRXC3",51,0)
 . . S LEXOK=0 S:LEXPR=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXC3",52,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:+LEXPR>0 ^LEX(LEXFI,LEXIDX,+LEXPR,LEXIEN)=""
"RTN","LEXRXC3",53,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXC3",54,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXC3",55,0)
 . N DA,LEXPAR S DA=LEXIEN S LEXPAR=$P($G(^LEX(757.01,DA,1)),"^",9) Q:'$L(LEXPAR)
"RTN","LEXRXC3",56,0)
 . I '$D(^LEX(757.01,LEXIDX,$E(LEXPAR,1,30),DA)) D
"RTN","LEXRXC3",57,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing",?58,"  ",DA
"RTN","LEXRXC3",58,0)
 . S:$L(LEXPAR) ^LEX(757.01,LEXIDX,$E(LEXPAR,1,30),DA)=""
"RTN","LEXRXC3",59,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXC3",60,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXC3",61,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXC3",62,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXC3",63,0)
 Q
"RTN","LEXRXC3",64,0)
 ;              
"RTN","LEXRXC3",65,0)
 ; Miscellaneous
"RTN","LEXRXC3",66,0)
SCT(X) ;  String Counter
"RTN","LEXRXC3",67,0)
 N LEXC,LEXW,LEXO,LEXT
"RTN","LEXRXC3",68,0)
 S (LEXC,LEXW)=$$UP^XLFSTR($G(X)),LEXT=0  Q:'$L(LEXW) 0
"RTN","LEXRXC3",69,0)
 S:$L(LEXW)>1 LEXO=$E(LEXW,1,($L(LEXW)-1))_$C(($A($E(LEXW,$L(LEXW)))-1))_"~"
"RTN","LEXRXC3",70,0)
 S:$L(LEXW)=1 LEXO=$C(($A(LEXW)-1))_"~"
"RTN","LEXRXC3",71,0)
 F  S LEXO=$O(^LEX(757.01,"AWRD",LEXO)) Q:'$L(LEXO)  Q:$E(LEXO,1,$L(LEXC))'=LEXC  D
"RTN","LEXRXC3",72,0)
 . N LEXM S LEXM=0 F  S LEXM=$O(^LEX(757.01,"AWRD",LEXO,LEXM)) Q:+LEXM'>0  D
"RTN","LEXRXC3",73,0)
 . . N LEXE S LEXE=0 F  S LEXE=$O(^LEX(757.01,"AWRD",LEXO,LEXM,LEXE)) Q:+LEXE'>0  D
"RTN","LEXRXC3",74,0)
 . . . S LEXT=LEXT+1
"RTN","LEXRXC3",75,0)
 S X=LEXT
"RTN","LEXRXC3",76,0)
 Q X
"RTN","LEXRXC3",77,0)
CLR ;   Clear
"RTN","LEXRXC3",78,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXC3",79,0)
 Q
"RTN","LEXRXD")
0^7^B72163787^n/a
"RTN","LEXRXD",1,0)
LEXRXD ;ISL/KER - Re-Index 757.02 B/ACODE/ACT ;08/17/2011
"RTN","LEXRXD",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXD",3,0)
 ;               
"RTN","LEXRXD",4,0)
 ; Global Variables
"RTN","LEXRXD",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXD",6,0)
 ;    ^LEX(757.02,        SACC 1.3
"RTN","LEXRXD",7,0)
 ;               
"RTN","LEXRXD",8,0)
 ; External References
"RTN","LEXRXD",9,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXD",10,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXD",11,0)
 ;    ^DIM                ICR  10016
"RTN","LEXRXD",12,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXD",13,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXD",14,0)
 ;               
"RTN","LEXRXD",15,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXD",16,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXD",17,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXD",18,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXD",19,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXD",20,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXD",21,0)
 ;               
"RTN","LEXRXD",22,0)
 Q
"RTN","LEXRXD",23,0)
EN ; Main Entry Point
"RTN","LEXRXD",24,0)
R75702 ; Repair file 757.02
"RTN","LEXRXD",25,0)
 D RB,RACODE,RACT,R75702^LEXRXD2,R75702^LEXRXD3,R75702^LEXRXD4,SET
"RTN","LEXRXD",26,0)
 Q
"RTN","LEXRXD",27,0)
RB ;   Index    ^LEX(757.02,"B",EXP,IEN) 
"RTN","LEXRXD",28,0)
 ;            ^LEX(757.02,IEN,4,"B",EFF,IEN2)
"RTN","LEXRXD",29,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXED,LEXELP,LEXEND,LEXERR,LEXEXP,LEXFI,LEXIDX,LEXIDXT,LEXIDST,LEXIEN,LEXMC,LEXNDS,LEXNDSS,LEXOK,LEXS,LEXSER,LEXSTR
"RTN","LEXRXD",30,0)
 S LEXFI="757.02"
"RTN","LEXRXD",31,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""B""") Q:LEXTC=1
"RTN","LEXRXD",32,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXNDSS,LEXERR,LEXSER)=0,LEXSTR="",LEXFI="757.02",LEXIDX="B",LEXIDXT="^LEX(757.02,""B"",EXP,IEN)"
"RTN","LEXRXD",33,0)
 S LEXIDST="^LEX(757.02,IEN,4,""B"",EFF,IEN2)" F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD",34,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",35,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXEXP S LEXEXP=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXD",36,0)
 . . S LEXOK=0 S:LEXEXP=LEXSTR LEXOK=1
"RTN","LEXRXD",37,0)
 . . I 'LEXOK  D
"RTN","LEXRXD",38,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXD",39,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD",40,0)
 . . S:$L(LEXEXP) ^LEX(LEXFI,LEXIDX,LEXEXP,LEXIEN)=""
"RTN","LEXRXD",41,0)
 . . I $D(^LEX(LEXFI,LEXIEN,4)) D
"RTN","LEXRXD",42,0)
 . . . N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD",43,0)
 . . . . N LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXD",44,0)
 . . . . . S LEXNDSS=+($G(LEXNDSS))+1 N LEXOK,LEXED S LEXED=$P($G(^LEX(LEXFI,LEXIEN,4,LEXS,0)),"^",1)
"RTN","LEXRXD",45,0)
 . . . . . S LEXOK=0 S:LEXED=LEXSTR LEXOK=1
"RTN","LEXRXD",46,0)
 . . . . . I 'LEXOK D
"RTN","LEXRXD",47,0)
 . . . . . . S LEXSER=LEXSER+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXSTR,LEXS)
"RTN","LEXRXD",48,0)
 . . . . . . I '$D(ZTQUEUED) W !,?10,757.28,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN,"/",LEXS
"RTN","LEXRXD",49,0)
 . . . . . S:$L(LEXED) ^LEX(LEXFI,LEXIEN,4,LEXIDX,LEXED,LEXS)=""
"RTN","LEXRXD",50,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",51,0)
 . N DA,X S X=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1) I $L(X) D
"RTN","LEXRXD",52,0)
 . . S DA=LEXIEN
"RTN","LEXRXD",53,0)
 . . I '$D(^LEX(LEXFI,LEXIDX,X,DA)) D
"RTN","LEXRXD",54,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",X,?58,"  ",DA
"RTN","LEXRXD",55,0)
 . . S:$L(X) ^LEX(LEXFI,LEXIDX,X,DA)=""
"RTN","LEXRXD",56,0)
 . I $D(^LEX(LEXFI,LEXIEN,4)) D
"RTN","LEXRXD",57,0)
 . . N LEXS S LEXS=0 F  S LEXS=$O(^LEX(LEXFI,LEXIEN,4,LEXS)) Q:+LEXS'>0  D
"RTN","LEXRXD",58,0)
 . . . N DA,X S DA(1)=LEXIEN,DA=LEXS,X=$P($G(^LEX(LEXFI,DA(1),4,DA,0)),"^",1) I $L(X) D
"RTN","LEXRXD",59,0)
 . . . . I '$D(^LEX(LEXFI,DA(1),4,LEXIDX,X,DA)) D
"RTN","LEXRXD",60,0)
 . . . . . S LEXSER=LEXSER+1 I '$D(ZTQUEUED) W !,?10,757.28,?19,LEXIDX,?30,"Missing ",X,?58,"  ",DA(1),"/",DA
"RTN","LEXRXD",61,0)
 . . . . S:$L(X) ^LEX(LEXFI,DA(1),4,LEXIDX,X,DA)=""
"RTN","LEXRXD",62,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD",63,0)
 S LEXSER=$S(+LEXSER>0:LEXSER,1:"") I '$D(ZTQUEUED) W !,$J(LEXSER,5),?10,757.28,?19,LEXIDX,?30,LEXIDST
"RTN","LEXRXD",64,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD",65,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD",66,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD",67,0)
 D REP^LEXRXXS(LEXFI,757.28,LEXIDX,LEXNDSS,LEXSER,LEXIDST)
"RTN","LEXRXD",68,0)
 Q
"RTN","LEXRXD",69,0)
RACODE ;   Index    ^LEX(757.02,"ACODE",CODE,IEN) 
"RTN","LEXRXD",70,0)
 N DA,DIK,LEXBEG,LEXDF,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXD",71,0)
 S LEXFI="757.02"
"RTN","LEXRXD",72,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ACODE""") Q:LEXTC=1
"RTN","LEXRXD",73,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.02,LEXIDX="ACODE",LEXIDXT="^LEX(757.02,""ACODE"",CODE,IEN)"
"RTN","LEXRXD",74,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD",75,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",76,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXDF,LEXSO S LEXDF=+$P($G(^LEX(757.02,LEXIEN,0)),U,6)
"RTN","LEXRXD",77,0)
 . . S LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2)
"RTN","LEXRXD",78,0)
 . . K:'$D(LEXTEST)&(+LEXDF>0) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) Q:+LEXDF>0
"RTN","LEXRXD",79,0)
 . . S LEXOK=0 S:(LEXSO_" ")=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXD",80,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:+LEXDF'>0&($L(LEXSO)) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD",81,0)
 . . . I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD",82,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",83,0)
 . Q:+($P($G(^LEX(LEXFI,LEXIEN,0)),"^",6))>0
"RTN","LEXRXD",84,0)
 . N DA,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",2) Q:'$L(X)
"RTN","LEXRXD",85,0)
 . I '$D(^LEX(LEXFI,LEXIDX,(X_" "),DA)) D
"RTN","LEXRXD",86,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",X,?58,"  ",DA
"RTN","LEXRXD",87,0)
 . S ^LEX(LEXFI,LEXIDX,(X_" "),DA)=""
"RTN","LEXRXD",88,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD",89,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD",90,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD",91,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD",92,0)
 Q
"RTN","LEXRXD",93,0)
RACT ;   Index    ^LEX(757.02,"ACT",CODE,STA,DATE,IEN,HIS)
"RTN","LEXRXD",94,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXDT,LEXEF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDT,LEXIDX,LEXIDXT,LEXIEN,LEXIHS,LEXISO,LEXIST,LEXN0,LEXN1
"RTN","LEXRXD",95,0)
 N LEXN1X,LEXN2,LEXN2X,LEXNDS,LEXNH,LEXNI,LEXNIX,LEXPF,LEXSO,LEXST,LEXTS,X
"RTN","LEXRXD",96,0)
 S LEXFI="757.02"
"RTN","LEXRXD",97,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ACT""") Q:LEXTC=1
"RTN","LEXRXD",98,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXFI=757.02,LEXIDX="ACT",LEXISO="",LEXIDXT="^LEX(757.02,""ACT"",CODE,ST,DT,IEN,HIS)"
"RTN","LEXRXD",99,0)
 F  S LEXISO=$O(^LEX(LEXFI,LEXIDX,LEXISO)) Q:'$L(LEXISO)  D
"RTN","LEXRXD",100,0)
 . N LEXIST S LEXIST="" F  S LEXIST=$O(^LEX(LEXFI,LEXIDX,LEXISO,LEXIST)) Q:'$L(LEXIST)  D
"RTN","LEXRXD",101,0)
 . . N LEXIDT S LEXIDT=0 F  S LEXIDT=$O(^LEX(LEXFI,LEXIDX,LEXISO,LEXIST,LEXIDT)) Q:+LEXIDT'>0  D
"RTN","LEXRXD",102,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXISO,LEXIST,LEXIDT,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",103,0)
 . . . . N LEXIHS S LEXIHS=0 F  S LEXIHS=$O(^LEX(LEXFI,LEXIDX,LEXISO,LEXIST,LEXIDT,LEXIEN,LEXIHS)) Q:+LEXIHS'>0  D
"RTN","LEXRXD",104,0)
 . . . . . S LEXNDS=LEXNDS+1 N LEXSO,LEXST,LEXTS,LEXDT,LEXPF,LEXN0,LEXNH,LEXEF,LEXNI,LEXNIX,LEXN1,LEXN1X,LEXN2,LEXN2X S LEXEF=0
"RTN","LEXRXD",105,0)
 . . . . . S LEXN0=$G(^LEX(757.02,LEXIEN,0)),LEXNH=$G(^LEX(757.02,LEXIEN,4,LEXIHS,0))
"RTN","LEXRXD",106,0)
 . . . . . S LEXSO=$P(LEXN0,U,2),LEXPF=$P(LEXN0,U,5),LEXDT=$P(LEXNH,U,1),LEXST=$P(LEXNH,U,2)
"RTN","LEXRXD",107,0)
 . . . . . S LEXTS=LEXST S:+LEXPF>0 LEXTS=LEXTS+2
"RTN","LEXRXD",108,0)
 . . . . . S LEXNI="^LEX("_LEXFI_","""_LEXIDX_""","""_LEXISO_""","_LEXIST_","_LEXIDT_","_LEXIEN_","_LEXIHS_")"
"RTN","LEXRXD",109,0)
 . . . . . S LEXN1="^LEX("_LEXFI_","""_LEXIDX_""","""_LEXSO_" "","_LEXST_","_LEXDT_","_LEXIEN_","_LEXIHS_")"
"RTN","LEXRXD",110,0)
 . . . . . S LEXN2="^LEX("_LEXFI_","""_LEXIDX_""","""_LEXSO_" "","_LEXTS_","_LEXDT_","_LEXIEN_","_LEXIHS_")"
"RTN","LEXRXD",111,0)
 . . . . . S X="K "_LEXNI D ^DIM Q:'$L($G(X))  S LEXNIX=$G(X)
"RTN","LEXRXD",112,0)
 . . . . . S X="S "_LEXN1_"=""""" D ^DIM Q:'$L($G(X))  S LEXN1X=$G(X)
"RTN","LEXRXD",113,0)
 . . . . . S X="S "_LEXN2_"=""""" D ^DIM Q:'$L($G(X))  S LEXN2X=$G(X)
"RTN","LEXRXD",114,0)
 . . . . . X:'$D(LEXTEST)&(LEXNI'=LEXN1)&(LEXNI'=LEXN2) LEXNIX
"RTN","LEXRXD",115,0)
 . . . . . I LEXNI'=LEXN1,LEXNI'=LEXN2 D
"RTN","LEXRXD",116,0)
 . . . . . . S LEXERR=LEXERR+1
"RTN","LEXRXD",117,0)
 . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSO,?58,"  ",LEXIEN W:+LEXIHS>0 "/",+LEXIHS
"RTN","LEXRXD",118,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",119,0)
 . N LEXIHS S LEXIHS=0 F  S LEXIHS=$O(^LEX(LEXFI,LEXIEN,4,LEXIHS)) Q:+LEXIHS'>0  D
"RTN","LEXRXD",120,0)
 . . N DA,DIK,LEXSO,LEXPF,LEXDT,LEXST,LEXTS S DA(1)=LEXIEN,DA=LEXIHS
"RTN","LEXRXD",121,0)
 . . S LEXSO=$P($G(^LEX(LEXFI,DA(1),0)),U,2),LEXPF=$P($G(^LEX(LEXFI,DA(1),0)),U,5)
"RTN","LEXRXD",122,0)
 . . S LEXDT=$P($G(^LEX(LEXFI,DA(1),4,DA,0)),U,1) Q:LEXDT'?7N  S LEXST=$P($G(^LEX(LEXFI,DA(1),4,DA,0)),U,2) Q:LEXST'?1N
"RTN","LEXRXD",123,0)
 . . S LEXTS=LEXST S:+LEXPF>0 LEXTS=LEXTS+2
"RTN","LEXRXD",124,0)
 . . I '$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),+LEXST,+LEXDT,DA(1),DA)) D
"RTN","LEXRXD",125,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXST,"/",LEXDT,?58,"  ",DA(1),"/",DA
"RTN","LEXRXD",126,0)
 . . I LEXTS>LEXST,'$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),+LEXTS,+LEXDT,DA(1),DA)) D
"RTN","LEXRXD",127,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXTS,"/",LEXDT,?58,"  ",DA(1),"/",DA
"RTN","LEXRXD",128,0)
 . . S:$L(LEXSO)&($L(LEXST))&($L(LEXDT)) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),+LEXST,+LEXDT,DA(1),DA)=""
"RTN","LEXRXD",129,0)
 . . I LEXTS>LEXST S:$L(LEXSO)&($L(LEXTS))&($L(LEXDT)) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),+LEXTS,+LEXDT,DA(1),DA)=""
"RTN","LEXRXD",130,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD",131,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD",132,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD",133,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD",134,0)
 Q
"RTN","LEXRXD",135,0)
 ;              
"RTN","LEXRXD",136,0)
 ; Miscellaneous
"RTN","LEXRXD",137,0)
SET ;   Re-Index (Set logic only)
"RTN","LEXRXD",138,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXD",139,0)
 N LEXOUT,LEXMSG S LEXFI=757.02
"RTN","LEXRXD",140,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXD",141,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXD",142,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXD",143,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXD",144,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXD",145,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXD",146,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXD",147,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD",148,0)
 . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXD",149,0)
 . N DA,DIK S DA=LEXIEN,DIK=LEXRT D IX1^DIK
"RTN","LEXRXD",150,0)
 S $P(^LEX(LEXFI,0),"^",3)=LEXP3,$P(^LEX(LEXFI,0),"^",4)=LEXP4
"RTN","LEXRXD",151,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD",152,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD",153,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXD",154,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXD",155,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXD",156,0)
 Q
"RTN","LEXRXD",157,0)
CLR ;   Clear
"RTN","LEXRXD",158,0)
 K LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXD",159,0)
 Q
"RTN","LEXRXD2")
0^8^B31445330^n/a
"RTN","LEXRXD2",1,0)
LEXRXD2 ;ISL/KER - Re-Index 757.02 ADC/AMC/ASRC ;08/17/2011
"RTN","LEXRXD2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXD2",3,0)
 ;               
"RTN","LEXRXD2",4,0)
 ; Global Variables
"RTN","LEXRXD2",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXD2",6,0)
 ;    ^LEX(757.02,        SACC 1.3
"RTN","LEXRXD2",7,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXD2",8,0)
 ;    ^LEX(757.03,        SACC 1.3
"RTN","LEXRXD2",9,0)
 ;               
"RTN","LEXRXD2",10,0)
 ; External References
"RTN","LEXRXD2",11,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXD2",12,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXD2",13,0)
 ;               
"RTN","LEXRXD2",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXD2",15,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXD2",16,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXD2",17,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXD2",18,0)
 ;               
"RTN","LEXRXD2",19,0)
 Q
"RTN","LEXRXD2",20,0)
EN ; Main Entry Point
"RTN","LEXRXD2",21,0)
R75702 ; Repair file 757.02
"RTN","LEXRXD2",22,0)
 D RADC,RAMC,RASRC Q
"RTN","LEXRXD2",23,0)
RADC ;   Index    ^LEX(757.02,"ADC",1,IEN) 
"RTN","LEXRXD2",24,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXST
"RTN","LEXRXD2",25,0)
 S LEXFI="757.02"
"RTN","LEXRXD2",26,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ADC""") Q:LEXTC=1
"RTN","LEXRXD2",27,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXST="1",LEXFI=757.02,LEXIDX="ADC",LEXIDXT="^LEX(757.02,""ADC"",1,IEN)"
"RTN","LEXRXD2",28,0)
 N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",29,0)
 . S LEXNDS=LEXNDS+1 N LEXOK,LEXDF,LEXSO S LEXDF=$P($G(^LEX(757.02,LEXIEN,0)),U,6),LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2)
"RTN","LEXRXD2",30,0)
 . S LEXOK=0 S:LEXDF=LEXST LEXOK=1 I 'LEXOK D
"RTN","LEXRXD2",31,0)
 . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN) S:$L(LEXDF)&(+LEXDF=1) ^LEX(LEXFI,LEXIDX,LEXDF,LEXIEN)=""
"RTN","LEXRXD2",32,0)
 . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST," ",LEXSO,?58,"  ",LEXIEN
"RTN","LEXRXD2",33,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",34,0)
 . N DA,X,DIK,LEXDF,LEXSO S DA=LEXIEN,(X,LEXDF)=$P($G(^LEX(LEXFI,DA,0)),U,6),LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2)
"RTN","LEXRXD2",35,0)
 . I X=1,'$D(^LEX(LEXFI,LEXIDX,X,DA)) D
"RTN","LEXRXD2",36,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing 1 ",LEXSO,X,?58,"  ",DA
"RTN","LEXRXD2",37,0)
 . I X'=1,$D(^LEX(LEXFI,LEXIDX,1,DA)) D
"RTN","LEXRXD2",38,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXSO," (deleted)",?58,"  ",DA
"RTN","LEXRXD2",39,0)
 . S:X=1 ^LEX(LEXFI,LEXIDX,1,DA)="" K:X'=1&('$D(LEXTEST)) ^LEX(LEXFI,LEXIDX,1,DA)
"RTN","LEXRXD2",40,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD2",41,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD2",42,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD2",43,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD2",44,0)
 Q
"RTN","LEXRXD2",45,0)
RAMC ;   Index    ^LEX(757.02,"AMC",MC,IEN)
"RTN","LEXRXD2",46,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXST
"RTN","LEXRXD2",47,0)
 S LEXFI="757.02"
"RTN","LEXRXD2",48,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""AMC""") Q:LEXTC=1
"RTN","LEXRXD2",49,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXST="",LEXFI=757.01,LEXIDX="AMC",LEXIDXT="^LEX(757.02,""AMC"",MC,IEN)"
"RTN","LEXRXD2",50,0)
 S LEXERR=0,LEXST="",LEXFI=757.02,LEXIDX="AMC"
"RTN","LEXRXD2",51,0)
 F  S LEXST=$O(^LEX(LEXFI,LEXIDX,LEXST)) Q:'$L(LEXST)  D
"RTN","LEXRXD2",52,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",53,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXMC S LEXMC=+($P($G(^LEX(LEXFI,LEXIEN,0)),"^",4))
"RTN","LEXRXD2",54,0)
 . . S LEXOK=0 S:LEXMC=LEXST LEXOK=1 I 'LEXOK D
"RTN","LEXRXD2",55,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN) S:+LEXMC>0 ^LEX(LEXFI,LEXIDX,+LEXMC,LEXIEN)=""
"RTN","LEXRXD2",56,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD2",57,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",58,0)
 . N DA,DIK,LEXMC S DA=LEXIEN,LEXMC=+($P($G(^LEX(LEXFI,DA,0)),"^",4)) Q:LEXMC'>0  Q:'$D(^LEX(757,+LEXMC,0))
"RTN","LEXRXD2",59,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXMC,DA)) D
"RTN","LEXRXD2",60,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXMC,?58,"  ",DA
"RTN","LEXRXD2",61,0)
 . S:$L(LEXMC) ^LEX(LEXFI,LEXIDX,LEXMC,DA)=""
"RTN","LEXRXD2",62,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD2",63,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD2",64,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD2",65,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD2",66,0)
 Q
"RTN","LEXRXD2",67,0)
RASRC ;   Index    ^LEX(757.02,"ASRC",SAB,IEN) 
"RTN","LEXRXD2",68,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXST
"RTN","LEXRXD2",69,0)
 S LEXFI="757.02"
"RTN","LEXRXD2",70,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ASRC""") Q:LEXTC=1
"RTN","LEXRXD2",71,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXST="",LEXFI=757.02,LEXIDX="ASRC",LEXIDXT="^LEX(757.02,""ASRC"",SAB,IEN)"
"RTN","LEXRXD2",72,0)
 F  S LEXST=$O(^LEX(LEXFI,LEXIDX,LEXST)) Q:'$L(LEXST)  D
"RTN","LEXRXD2",73,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",74,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXSO,LEXSR,LEXSB S LEXSO=$P($G(^LEX(757.02,+LEXIEN,0)),"^",2)
"RTN","LEXRXD2",75,0)
 . . S LEXSR=$P($G(^LEX(757.02,+LEXIEN,0)),"^",3),LEXSB=$E($P($G(^LEX(757.03,+LEXSR,0)),"^",1),1,3)
"RTN","LEXRXD2",76,0)
 . . I '$L(LEXSO)!($L(LEXSB)'=3) D  Q
"RTN","LEXRXD2",77,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)
"RTN","LEXRXD2",78,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD2",79,0)
 . . S LEXOK=0 S:LEXSB=LEXST LEXOK=1 I 'LEXOK D
"RTN","LEXRXD2",80,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)
"RTN","LEXRXD2",81,0)
 . . . S:$L(LEXSB) ^LEX(LEXFI,LEXIDX,LEXSB,LEXIEN)=""
"RTN","LEXRXD2",82,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST," ",$G(LEXSO),?58,"  ",LEXIEN
"RTN","LEXRXD2",83,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD2",84,0)
 . N DA,DIK,LEXSO,LEXSR,LEXSB S DA=LEXIEN,LEXSR=$P($G(^LEX(LEXFI,+DA,0)),"^",3),LEXSO=$P($G(^LEX(757.02,DA,0)),U,2)
"RTN","LEXRXD2",85,0)
 . S LEXSB=$E($P($G(^LEX(757.03,+LEXSR,0)),"^",1),1,3) Q:$L(LEXSB)'=3  Q:'$L(LEXSO)
"RTN","LEXRXD2",86,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXSB,DA)) D
"RTN","LEXRXD2",87,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSB,"/",LEXSO,?58,"  ",DA
"RTN","LEXRXD2",88,0)
 . S:$L(LEXSB) ^LEX(LEXFI,LEXIDX,LEXSB,DA)=""
"RTN","LEXRXD2",89,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD2",90,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD2",91,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD2",92,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD2",93,0)
 Q
"RTN","LEXRXD2",94,0)
 ;              
"RTN","LEXRXD2",95,0)
 ; Miscellaneous
"RTN","LEXRXD2",96,0)
CLR ;   Clear
"RTN","LEXRXD2",97,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXD2",98,0)
 Q
"RTN","LEXRXD3")
0^9^B23248019^n/a
"RTN","LEXRXD3",1,0)
LEXRXD3 ;ISL/KER - Re-Index 757.02 ADCODE/APCODE ;08/17/2011
"RTN","LEXRXD3",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXD3",3,0)
 ;               
"RTN","LEXRXD3",4,0)
 ; Global Variables
"RTN","LEXRXD3",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXD3",6,0)
 ;    ^LEX(757.02,        SACC 1.3
"RTN","LEXRXD3",7,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXD3",8,0)
 ;    ^LEX(757.03,        SACC 1.3
"RTN","LEXRXD3",9,0)
 ;               
"RTN","LEXRXD3",10,0)
 ; External References
"RTN","LEXRXD3",11,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXD3",12,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXD3",13,0)
 ;               
"RTN","LEXRXD3",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXD3",15,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXD3",16,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXD3",17,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXD3",18,0)
 ;               
"RTN","LEXRXD3",19,0)
 Q
"RTN","LEXRXD3",20,0)
EN ; Main Entry Point
"RTN","LEXRXD3",21,0)
R75702 ; Repair file 757.02
"RTN","LEXRXD3",22,0)
 D RADCODE,RAPCODE Q
"RTN","LEXRXD3",23,0)
RADCODE ;   Index    ^LEX(757.02,"ADCODE",CODE,IEN) 
"RTN","LEXRXD3",24,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXST
"RTN","LEXRXD3",25,0)
 S LEXFI="757.02"
"RTN","LEXRXD3",26,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ADCODE""") Q:LEXTC=1
"RTN","LEXRXD3",27,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXST="",LEXFI=757.02,LEXIDX="ADCODE",LEXIDXT="^LEX(757.02,""ADCODE"",CODE,IEN)"
"RTN","LEXRXD3",28,0)
 F  S LEXST=$O(^LEX(LEXFI,LEXIDX,LEXST)) Q:'$L(LEXST)  D
"RTN","LEXRXD3",29,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD3",30,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXDF,LEXSO S LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2) I '$L(LEXSO) D  Q
"RTN","LEXRXD3",31,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)
"RTN","LEXRXD3",32,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD3",33,0)
 . . S LEXDF=$P($G(^LEX(757.02,LEXIEN,0)),U,6) I +LEXDF'>0 D  Q
"RTN","LEXRXD3",34,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)
"RTN","LEXRXD3",35,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD3",36,0)
 . . S LEXOK=0 S:(LEXSO_" ")=LEXST LEXOK=1 I 'LEXOK D
"RTN","LEXRXD3",37,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)
"RTN","LEXRXD3",38,0)
 . . . S:$L(LEXSO)&(+LEXDF=1) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD3",39,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD3",40,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD3",41,0)
 . N DA,X,DIK,LEXDF,LEXSO S DA=LEXIEN,LEXSO=$P($G(^LEX(LEXFI,DA,0)),U,2),(X,LEXDF)=$P($G(^LEX(LEXFI,DA,0)),U,6) Q:'$L(LEXSO)
"RTN","LEXRXD3",42,0)
 . I X=1,'$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)) D
"RTN","LEXRXD3",43,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,?58,"  ",DA
"RTN","LEXRXD3",44,0)
 . I X'=1,$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)) D
"RTN","LEXRXD3",45,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (deleted)",?58,"  ",DA
"RTN","LEXRXD3",46,0)
 . S:X=1 ^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)="" K:X'=1&('$D(LEXTEST)) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)
"RTN","LEXRXD3",47,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD3",48,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD3",49,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD3",50,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD3",51,0)
 Q
"RTN","LEXRXD3",52,0)
RAPCODE ;   Index    ^LEX(757.02,"APCODE",CODE,IEN) 
"RTN","LEXRXD3",53,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXPF,LEXSO,LEXST
"RTN","LEXRXD3",54,0)
 S LEXFI="757.02"
"RTN","LEXRXD3",55,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""APCODE""") Q:LEXTC=1
"RTN","LEXRXD3",56,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXST="",LEXFI=757.02,LEXIDX="APCODE",LEXIDXT="^LEX(757.02,""APCODE"",CODE,IEN) "
"RTN","LEXRXD3",57,0)
 F  S LEXST=$O(^LEX(LEXFI,LEXIDX,LEXST)) Q:'$L(LEXST)  D
"RTN","LEXRXD3",58,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXST,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD3",59,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXSO,LEXPF S LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2),LEXPF=$P($G(^LEX(757.02,LEXIEN,0)),U,5)
"RTN","LEXRXD3",60,0)
 . . K:'$D(LEXTEST)&(+LEXPF'>0) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN) Q:+LEXPF'>0
"RTN","LEXRXD3",61,0)
 . . S LEXOK=0 S:(LEXSO_" ")=LEXST LEXOK=1 I 'LEXOK D
"RTN","LEXRXD3",62,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXST,LEXIEN) S:$L(LEXSO) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD3",63,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXST,?58,"  ",LEXIEN
"RTN","LEXRXD3",64,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD3",65,0)
 . N DA,DIK,LEXSO,LEXPF S DA=LEXIEN,LEXSO=$P($G(^LEX(757.02,DA,0)),U,2),LEXPF=$P($G(^LEX(757.02,DA,0)),U,5) Q:'$L(LEXSO)
"RTN","LEXRXD3",66,0)
 . I LEXPF>0,'$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)) D
"RTN","LEXRXD3",67,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,?58,"  ",DA
"RTN","LEXRXD3",68,0)
 . I LEXPF'>0,$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)) D
"RTN","LEXRXD3",69,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (deleted) ",LEXSO,?58,"  ",DA
"RTN","LEXRXD3",70,0)
 . S:LEXPF>0 ^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)="" K:LEXPF'>0&('$D(LEXTEST)) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)
"RTN","LEXRXD3",71,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD3",72,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD3",73,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD3",74,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD3",75,0)
 Q
"RTN","LEXRXD3",76,0)
 ;              
"RTN","LEXRXD3",77,0)
 ; Miscellaneous
"RTN","LEXRXD3",78,0)
CLR ;   Clear
"RTN","LEXRXD3",79,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXD3",80,0)
 Q
"RTN","LEXRXD4")
0^10^B78250103^n/a
"RTN","LEXRXD4",1,0)
LEXRXD4 ;ISL/KER - Re-Index 757.02 AVA/CODE/ADX/APR ;08/17/2011
"RTN","LEXRXD4",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXD4",3,0)
 ;               
"RTN","LEXRXD4",4,0)
 ; Global Variables
"RTN","LEXRXD4",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXD4",6,0)
 ;    ^LEX(757.02,        SACC 1.3
"RTN","LEXRXD4",7,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXD4",8,0)
 ;    ^LEX(757.03,        SACC 1.3
"RTN","LEXRXD4",9,0)
 ;               
"RTN","LEXRXD4",10,0)
 ; External References
"RTN","LEXRXD4",11,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXD4",12,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXD4",13,0)
 ;               
"RTN","LEXRXD4",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXD4",15,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXD4",16,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXD4",17,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXD4",18,0)
 ;               
"RTN","LEXRXD4",19,0)
 Q
"RTN","LEXRXD4",20,0)
EN ; Main Entry Point
"RTN","LEXRXD4",21,0)
R75702 ; Repair file 757.02
"RTN","LEXRXD4",22,0)
 D RAVA,RCODE,RI10 Q
"RTN","LEXRXD4",23,0)
RAVA ;   Index    ^LEX(757.02,"AVA",CODE,EXP,SAB,IEN) 
"RTN","LEXRXD4",24,0)
 N DA,DIK,LEXBEG,LEXCK,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXD4",25,0)
 S LEXFI="757.02"
"RTN","LEXRXD4",26,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""AVA""") Q:LEXTC=1
"RTN","LEXRXD4",27,0)
 S LEXCK=$$SABS^LEXRXXM S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0
"RTN","LEXRXD4",28,0)
 S LEXSTR="",LEXFI=757.02,LEXIDX="AVA",LEXIDXT="^LEX(757.02,""AVA"",CODE,EXP,SAB,IEN)"
"RTN","LEXRXD4",29,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD4",30,0)
 . N LEXEXP S LEXEXP=0  F  S LEXEXP=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP)) Q:+LEXEXP'>0  D
"RTN","LEXRXD4",31,0)
 . . N LEXSAB S LEXSAB="" F  S LEXSAB=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP,LEXSAB)) Q:'$L(LEXSAB)  D
"RTN","LEXRXD4",32,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP,LEXSAB,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",33,0)
 . . . . N LEXOK,LEXSO,LEXEX,LEXSR,LEXSB S LEXNDS=LEXNDS+1
"RTN","LEXRXD4",34,0)
 . . . . S LEXEX=$P($G(^LEX(757.02,+LEXIEN,0)),"^",1),LEXSO=$P($G(^LEX(757.02,+LEXIEN,0)),"^",2)
"RTN","LEXRXD4",35,0)
 . . . . S LEXSR=$P($G(^LEX(757.02,+LEXIEN,0)),"^",3),LEXSB=$E($P($G(^LEX(757.03,+LEXSR,0)),"^",1),1,3)
"RTN","LEXRXD4",36,0)
 . . . . I $L(LEXSAB)'=3!(LEXCK'[LEXSAB) D  Q
"RTN","LEXRXD4",37,0)
 . . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP,LEXSAB,LEXIEN)
"RTN","LEXRXD4",38,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid SAB ",LEXSAB,?58,"  ",LEXIEN,!,?30,LEXCK
"RTN","LEXRXD4",39,0)
 . . . . I '$L(LEXEX)!('$L(LEXSO))!($L(LEXSB)'=3) D  Q
"RTN","LEXRXD4",40,0)
 . . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP,LEXSAB,LEXIEN)
"RTN","LEXRXD4",41,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD4",42,0)
 . . . . S LEXOK=1 S:LEXSTR='(LEXSO_" ") LEXOK=0 S:LEXEXP'=LEXEX LEXOK=0 S:LEXSAB'=LEXSB LEXOK=0 I 'LEXOK D
"RTN","LEXRXD4",43,0)
 . . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXEXP,LEXSAB,LEXIEN)
"RTN","LEXRXD4",44,0)
 . . . . . S:$L(LEXSO)&($L(LEXEX))&($L(LEXSB))&(LEXCK[("^"_LEXSB_"^")) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXEX,LEXSB,LEXIEN)=""
"RTN","LEXRXD4",45,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD4",46,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",47,0)
 . N DA,DIK,LEXEX,LEXSO,LEXSR,LEXSB S DA=LEXIEN,LEXSR=$P($G(^LEX(LEXFI,+DA,0)),"^",3),LEXSO=$P($G(^LEX(LEXFI,DA,0)),U,2)
"RTN","LEXRXD4",48,0)
 . S LEXEX=$P($G(^LEX(LEXFI,DA,0)),U,1),LEXSB=$E($P($G(^LEX(757.03,+LEXSR,0)),"^",1),1,3) Q:$L(LEXSB)'=3  Q:'$L(LEXSO)  Q:+LEXEX'>0
"RTN","LEXRXD4",49,0)
 . I LEXCK[("^"_LEXSB_"^"),'$D(^LEX(757.02,"AVA",(LEXSO_" "),LEXEX,LEXSB,DA)) D
"RTN","LEXRXD4",50,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,"/",LEXSB,?58,"  ",DA
"RTN","LEXRXD4",51,0)
 . I LEXCK'[("^"_LEXSB_"^"),$D(^LEX(757.02,"AVA",(LEXSO_" "),LEXEX,LEXSB,DA)) D
"RTN","LEXRXD4",52,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid (deleted) ",LEXSO,"/",LEXSB,?58,"  ",DA
"RTN","LEXRXD4",53,0)
 . . K:'$D(LEXTEST) ^LEX(757.02,"AVA",(LEXSO_" "),LEXEX,LEXSB,DA)
"RTN","LEXRXD4",54,0)
 . S:LEXCK[("^"_LEXSB_"^")&($L(LEXSO))&($L(LEXEX)) ^LEX(757.02,"AVA",(LEXSO_" "),LEXEX,LEXSB,DA)=""
"RTN","LEXRXD4",55,0)
 . K:LEXCK'[("^"_LEXSB_"^")&('$D(LEXTEST))&($L(LEXSO))&($L(LEXEX)) ^LEX(757.02,"AVA",(LEXSO_" "),LEXEX,LEXSB,DA)
"RTN","LEXRXD4",56,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD4",57,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD4",58,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD4",59,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD4",60,0)
 Q
"RTN","LEXRXD4",61,0)
RCODE ;   Index    ^LEX(757.02,"CODE",CODE,IEN) 
"RTN","LEXRXD4",62,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXD4",63,0)
 S LEXFI="757.02"
"RTN","LEXRXD4",64,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""CODE""") Q:LEXTC=1
"RTN","LEXRXD4",65,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.02,LEXIDX="CODE",LEXIDXT="^LEX(757.02,""CODE"",CODE,IEN)"
"RTN","LEXRXD4",66,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD4",67,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",68,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXSO S LEXSO=$P($G(^LEX(757.02,LEXIEN,0)),U,2)
"RTN","LEXRXD4",69,0)
 . . S LEXOK=0 S:(LEXSO_" ")=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXD4",70,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXSO) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD4",71,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD4",72,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",73,0)
 . N DA,DIK,LEXSO S DA=LEXIEN,LEXSO=$P($G(^LEX(LEXFI,DA,0)),U,2) Q:'$L(LEXSO)
"RTN","LEXRXD4",74,0)
 . I '$D(^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)) D
"RTN","LEXRXD4",75,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,?58,"  ",DA
"RTN","LEXRXD4",76,0)
 . S:$L(LEXSO) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),DA)=""
"RTN","LEXRXD4",77,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD4",78,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD4",79,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD4",80,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD4",81,0)
 Q
"RTN","LEXRXD4",82,0)
RI10 ;   Index    ^LEX(757.02,ICD10) 
"RTN","LEXRXD4",83,0)
 D:$D(^LEX(757.02,"ADX")) RADX D:$D(^LEX(757.02,"APR")) RAPR
"RTN","LEXRXD4",84,0)
 Q
"RTN","LEXRXD4",85,0)
RADX ;   Index    ^LEX(757.02,"ADX",CODE,DATE,STA,IEN,HIS)
"RTN","LEXRXD4",86,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXD4",87,0)
 S LEXFI="757.02"
"RTN","LEXRXD4",88,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""ADX""") Q:LEXTC=1
"RTN","LEXRXD4",89,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.02,LEXIDX="ADX",LEXIDXT="^LEX(757.02,""ADX"",CODE,DT,STA,IEN,HIS)"
"RTN","LEXRXD4",90,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD4",91,0)
 . N LEXEFF S LEXEFF=0 F  S LEXEFF=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF)) Q:+LEXEFF'>0  D
"RTN","LEXRXD4",92,0)
 . . N LEXSTA S LEXSTA="" F  S LEXSTA=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA)) Q:'$L(LEXSTA)  D
"RTN","LEXRXD4",93,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",94,0)
 . . . . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXD4",95,0)
 . . . . . S LEXNDS=LEXNDS+1 N LEXOK,LEX0,LEXH,LEXSO,LEXSR,LEXST,LEXEF
"RTN","LEXRXD4",96,0)
 . . . . . S LEX0=$G(^LEX(757.02,LEXIEN,0)),LEXH=$G(^LEX(757.02,LEXIEN,4,LEXHIS,0)),LEXSO=$P(LEX0,"^",2)
"RTN","LEXRXD4",97,0)
 . . . . . S LEXSR=$P(LEX0,"^",3),LEXST=$P(LEXH,"^",2),LEXEF=$P(LEXH,"^",1)
"RTN","LEXRXD4",98,0)
 . . . . . S LEXOK=1 S:(LEXSO_" ")'=LEXSTR LEXOK=0 S:LEXSR'=30 LEXOK=0
"RTN","LEXRXD4",99,0)
 . . . . . S:LEXEFF'=LEXEF LEXOK=0 S:LEXSTA'=LEXST LEXOK=0 I 'LEXOK D
"RTN","LEXRXD4",100,0)
 . . . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN,LEXHIS)
"RTN","LEXRXD4",101,0)
 . . . . . . S:$L(LEXSO) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD4",102,0)
 . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD4",103,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",104,0)
 . N DA,DIK,LEX0,LEXHI,LEXSO,LEXSR
"RTN","LEXRXD4",105,0)
 . S LEX0=$G(^LEX(LEXFI,LEXIEN,0)) S LEXSO=$P(LEX0,U,2) Q:'$L(LEXSO)  S LEXSR=$P(LEX0,U,3) Q:+LEXSR'=30
"RTN","LEXRXD4",106,0)
 . S LEXHI=0 F  S LEXHI=$O(^LEX(757.02,LEXIEN,4,LEXHI)) Q:+LEXHI'>0  D
"RTN","LEXRXD4",107,0)
 . . N LEXH,LEXEF,LEXST S LEXH=$G(^LEX(LEXFI,LEXIEN,4,LEXHI,0))
"RTN","LEXRXD4",108,0)
 . . S LEXEF=$P(LEXH,U,1) Q:'$L(LEXEF)
"RTN","LEXRXD4",109,0)
 . . S LEXST=$P(LEXH,U,2) Q:'$L(LEXST)
"RTN","LEXRXD4",110,0)
 . . S DA(1)=LEXIEN,DA=LEXHI
"RTN","LEXRXD4",111,0)
 . . I '$D(^LEX(757.02,"ADX",(LEXSO_" "),LEXEF,LEXST,DA(1),DA)) D
"RTN","LEXRXD4",112,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,?58,"  ",DA(1),", ",DA
"RTN","LEXRXD4",113,0)
 . . . S:$L(LEXSO)&($L(LEXEF))&($L(LEXST))&(+($G(DA(1)))>0)&(+($G(DA))>0) ^LEX(757.02,"ADX",(LEXSO_" "),LEXEF,LEXST,DA(1),DA)=""
"RTN","LEXRXD4",114,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD4",115,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD4",116,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD4",117,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD4",118,0)
 Q
"RTN","LEXRXD4",119,0)
RAPR ;   Index    ^LEX(757.02,"APR",CODE,DATE,STA,IEN,HIS)
"RTN","LEXRXD4",120,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXD4",121,0)
 S LEXFI="757.02"
"RTN","LEXRXD4",122,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.02 ""APR""") Q:LEXTC=1
"RTN","LEXRXD4",123,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.02,LEXIDX="APR",LEXIDXT="^LEX(757.02,""APR"",CODE,DT,STA,IEN,HIS)"
"RTN","LEXRXD4",124,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXD4",125,0)
 . N LEXEFF S LEXEFF=0 F  S LEXEFF=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF)) Q:+LEXEFF'>0  D
"RTN","LEXRXD4",126,0)
 . . N LEXSTA S LEXSTA="" F  S LEXSTA=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA)) Q:'$L(LEXSTA)  D
"RTN","LEXRXD4",127,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",128,0)
 . . . . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXD4",129,0)
 . . . . . S LEXNDS=LEXNDS+1 N LEXOK,LEX0,LEXH,LEXSO,LEXSR,LEXST,LEXEF
"RTN","LEXRXD4",130,0)
 . . . . . S LEX0=$G(^LEX(757.02,LEXIEN,0)),LEXH=$G(^LEX(757.02,LEXIEN,4,LEXHIS,0)),LEXSO=$P(LEX0,"^",2)
"RTN","LEXRXD4",131,0)
 . . . . . S LEXSR=$P(LEX0,"^",3),LEXST=$P(LEXH,"^",2),LEXEF=$P(LEXH,"^",1)
"RTN","LEXRXD4",132,0)
 . . . . . S LEXOK=1 S:(LEXSO_" ")'=LEXSTR LEXOK=0 S:LEXSR'=31 LEXOK=0
"RTN","LEXRXD4",133,0)
 . . . . . S:LEXEFF'=LEXEF LEXOK=0 S:LEXSTA'=LEXST LEXOK=0 I 'LEXOK D
"RTN","LEXRXD4",134,0)
 . . . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXEFF,LEXSTA,LEXIEN,LEXHIS)
"RTN","LEXRXD4",135,0)
 . . . . . . S:$L(LEXSO) ^LEX(LEXFI,LEXIDX,(LEXSO_" "),LEXIEN)=""
"RTN","LEXRXD4",136,0)
 . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXD4",137,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXD4",138,0)
 . N DA,DIK,LEX0,LEXHI,LEXSO,LEXSR
"RTN","LEXRXD4",139,0)
 . S LEX0=$G(^LEX(LEXFI,LEXIEN,0)) S LEXSO=$P(LEX0,U,2) Q:'$L(LEXSO)  S LEXSR=$P(LEX0,U,3) Q:+LEXSR'=30
"RTN","LEXRXD4",140,0)
 . S LEXHI=0 F  S LEXHI=$O(^LEX(757.02,LEXIEN,4,LEXHI)) Q:+LEXHI'>0  D
"RTN","LEXRXD4",141,0)
 . . N LEXH,LEXEF,LEXST S LEXH=$G(^LEX(LEXFI,LEXIEN,4,LEXHI,0))
"RTN","LEXRXD4",142,0)
 . . S LEXEF=$P(LEXH,U,1) Q:'$L(LEXEF)
"RTN","LEXRXD4",143,0)
 . . S LEXST=$P(LEXH,U,2) Q:'$L(LEXST)
"RTN","LEXRXD4",144,0)
 . . S DA(1)=LEXIEN,DA=LEXHI
"RTN","LEXRXD4",145,0)
 . . I '$D(^LEX(757.02,LEXIDX,(LEXSO_" "),LEXEF,LEXST,DA(1),DA)) D
"RTN","LEXRXD4",146,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXSO,?58,"  ",DA(1),", ",DA
"RTN","LEXRXD4",147,0)
 . . . S:$L(LEXSO)&($L(LEXEF))&($L(LEXST))&(+($G(DA(1)))>0)&(+($G(DA))>0) ^LEX(757.02,LEXIDX,(LEXSO_" "),LEXEF,LEXST,DA(1),DA)=""
"RTN","LEXRXD4",148,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXD4",149,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXD4",150,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXD4",151,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXD4",152,0)
 Q
"RTN","LEXRXD4",153,0)
 ;              
"RTN","LEXRXD4",154,0)
 ; Miscellaneous
"RTN","LEXRXD4",155,0)
CLR ;   Clear
"RTN","LEXRXD4",156,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXD4",157,0)
 Q
"RTN","LEXRXE")
0^11^B59805790^n/a
"RTN","LEXRXE",1,0)
LEXRXE ;ISL/KER - Re-Index 757.1 B/AMCC/AMCT/ASTT ;08/17/2011
"RTN","LEXRXE",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXE",3,0)
 ;               
"RTN","LEXRXE",4,0)
 ; Global Variables
"RTN","LEXRXE",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXE",6,0)
 ;    ^LEX(757.1,         SACC 1.3
"RTN","LEXRXE",7,0)
 ;    ^LEX(757,           SACC 1.3 
"RTN","LEXRXE",8,0)
 ;    ^LEX(757.11,        SACC 1.3 
"RTN","LEXRXE",9,0)
 ;    ^LEX(757.12,        SACC 1.3 
"RTN","LEXRXE",10,0)
 ;               
"RTN","LEXRXE",11,0)
 ; External References
"RTN","LEXRXE",12,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXE",13,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXE",14,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXE",15,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXE",16,0)
 ;               
"RTN","LEXRXE",17,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXE",18,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXE",19,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXE",20,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXE",21,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXE",22,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXE",23,0)
 ;               
"RTN","LEXRXE",24,0)
 Q
"RTN","LEXRXE",25,0)
EN ; Main Entry Point
"RTN","LEXRXE",26,0)
R7571 ; Repair file 757.1
"RTN","LEXRXE",27,0)
 D RB,RAMCC,RAMCT,RASTT,SET
"RTN","LEXRXE",28,0)
 Q
"RTN","LEXRXE",29,0)
RB ;   Index    ^LEX(757.1,"B",MC,IEN) 
"RTN","LEXRXE",30,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXE",31,0)
 S LEXFI="757.1"
"RTN","LEXRXE",32,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.1 ""B""") Q:LEXTC=1
"RTN","LEXRXE",33,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI="757.1",LEXIDX="B",LEXIDXT="^LEX(757.1,""B"",MC,IEN)"
"RTN","LEXRXE",34,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXE",35,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",36,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXMC S LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXE",37,0)
 . . S LEXOK=0 S:LEXMC=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXE",38,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXMC) ^LEX(LEXFI,LEXIDX,LEXMC,LEXIEN)=""
"RTN","LEXRXE",39,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXE",40,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",41,0)
 . N DA,DIK,LEXMC S DA=LEXIEN,LEXMC=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:+LEXMC'>0  Q:'$D(^LEX(757,+LEXMC,0))
"RTN","LEXRXE",42,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXMC,DA)) D
"RTN","LEXRXE",43,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXMC,?58,"  ",DA
"RTN","LEXRXE",44,0)
 . S:$L(LEXMC) ^LEX(LEXFI,LEXIDX,LEXMC,DA)=""
"RTN","LEXRXE",45,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXE",46,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXE",47,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXE",48,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXE",49,0)
 Q
"RTN","LEXRXE",50,0)
RAMCC ;   Index    ^LEX(757.1,"AMCC",MC,SC,IEN) 
"RTN","LEXRXE",51,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMAJ,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXE",52,0)
 S LEXFI="757.1"
"RTN","LEXRXE",53,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.1 ""AMCC""") Q:LEXTC=1
"RTN","LEXRXE",54,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR=0,LEXFI=757.1,LEXIDX="AMCC",LEXIDXT="^LEX(757.1,""AMCC"",MC,SC,IEN) "
"RTN","LEXRXE",55,0)
 S LEXMAJ=0 F  S LEXMAJ=$O(^LEX(LEXFI,LEXIDX,LEXMAJ)) Q:+LEXMAJ'>0  D
"RTN","LEXRXE",56,0)
 . N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXE",57,0)
 . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",58,0)
 . . . S LEXNDS=LEXNDS+1 N LEXOK,LEXMC,LEXSC S LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),U,1)
"RTN","LEXRXE",59,0)
 . . . S LEXSC=$P($G(^LEX(LEXFI,LEXIEN,0)),U,2),LEXSC=$P($G(^LEX(757.11,+LEXSC,0)),U,1)
"RTN","LEXRXE",60,0)
 . . . S LEXOK=1 S:LEXMC'=LEXMAJ LEXOK=0 S:LEXSTR'=LEXSC LEXOK=0 I 'LEXOK D
"RTN","LEXRXE",61,0)
 . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR,LEXIEN)
"RTN","LEXRXE",62,0)
 . . . . S:$L(LEXSC)&(+LEXMC>0) ^LEX(LEXFI,LEXIDX,LEXMC,LEXSC,LEXIEN)=""
"RTN","LEXRXE",63,0)
 . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXMC,"/",LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXE",64,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",65,0)
 . N DA,LEXMC,LEXSC,DIK S DA=LEXIEN,LEXMC=$P($G(^LEX(LEXFI,DA,0)),U,1) Q:+LEXMC'>0
"RTN","LEXRXE",66,0)
 . S LEXSC=$P($G(^LEX(LEXFI,DA,0)),U,2),LEXSC=$E($P($G(^LEX(757.11,+LEXSC,0)),U,1),1,3) Q:$L(LEXSC)'=3
"RTN","LEXRXE",67,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXMC,LEXSC,DA)) D
"RTN","LEXRXE",68,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXMC,"/",LEXSC,?58,"  ",DA
"RTN","LEXRXE",69,0)
 . S:$L(LEXMC)&($L(LEXSC)) ^LEX(LEXFI,LEXIDX,LEXMC,LEXSC,DA)=""
"RTN","LEXRXE",70,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXE",71,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXE",72,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXE",73,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXE",74,0)
 Q
"RTN","LEXRXE",75,0)
RAMCT ;   Index    ^LEX(757.1,"AMCT",MC,ST,IEN) 
"RTN","LEXRXE",76,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMAJ,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXE",77,0)
 S LEXFI="757.1"
"RTN","LEXRXE",78,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.1 ""AMCT""") Q:LEXTC=1
"RTN","LEXRXE",79,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR=0,LEXFI=757.1,LEXIDX="AMCT",LEXIDXT="^LEX(757.1,""AMCT"",MC,ST,IEN)"
"RTN","LEXRXE",80,0)
 S LEXMAJ=0 F  S LEXMAJ=$O(^LEX(LEXFI,LEXIDX,LEXMAJ)) Q:+LEXMAJ'>0  D
"RTN","LEXRXE",81,0)
 . N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXE",82,0)
 . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",83,0)
 . . . S LEXNDS=LEXNDS+1 N LEXOK,LEXMC,LEXST S LEXOK=1,LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),U,1)
"RTN","LEXRXE",84,0)
 . . . S LEXST=$P($G(^LEX(LEXFI,LEXIEN,0)),U,3) S:LEXMC'=LEXMAJ LEXOK=0 S:LEXSTR'=LEXST LEXOK=0 I 'LEXOK D
"RTN","LEXRXE",85,0)
 . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXMAJ,LEXSTR,LEXIEN)
"RTN","LEXRXE",86,0)
 . . . . S:$L(LEXST)&(+LEXMC>0) ^LEX(LEXFI,LEXIDX,LEXMC,LEXST,LEXIEN)=""
"RTN","LEXRXE",87,0)
 . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXMC,"/",LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXE",88,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",89,0)
 . N DA,DIK,LEXMC,LEXTY S DA=LEXIEN,LEXMC=$P($G(^LEX(LEXFI,DA,0)),U,1) Q:+LEXMC'>0
"RTN","LEXRXE",90,0)
 . S LEXTY=$P($G(^LEX(LEXFI,DA,0)),U,3) Q:'$L(LEXTY)
"RTN","LEXRXE",91,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXMC,LEXTY,DA)) D
"RTN","LEXRXE",92,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXMC,"/",LEXTY,?58,"  ",DA
"RTN","LEXRXE",93,0)
 . S:$L(LEXMC)&($L(LEXTY)) ^LEX(LEXFI,LEXIDX,LEXMC,LEXTY,DA)=""
"RTN","LEXRXE",94,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXE",95,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXE",96,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXE",97,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXE",98,0)
 Q
"RTN","LEXRXE",99,0)
RASTT ;   Index    ^LEX(757.1,"ASTT",ST,MC,IEN) 
"RTN","LEXRXE",100,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMAJ,LEXNDS,LEXOK,LEXSO,LEXSTR
"RTN","LEXRXE",101,0)
 S LEXFI="757.1"
"RTN","LEXRXE",102,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.1 ""ASTT""") Q:LEXTC=1
"RTN","LEXRXE",103,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR=0,LEXFI=757.1,LEXIDX="ASTT",LEXIDXT="^LEX(757.1,""ASTT"",ST,MC,IEN)"
"RTN","LEXRXE",104,0)
 N LEXSTR S LEXSTR="" F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXE",105,0)
 . N LEXMAJ S LEXMAJ=0 F  S LEXMAJ=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXMAJ)) Q:+LEXMAJ'>0  D
"RTN","LEXRXE",106,0)
 . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXMAJ,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",107,0)
 . . . S LEXNDS=LEXNDS+1 N LEXOK,LEXMC,LEXST S LEXOK=1,LEXMC=$P($G(^LEX(LEXFI,LEXIEN,0)),U,1)
"RTN","LEXRXE",108,0)
 . . . S LEXST=$P($G(^LEX(LEXFI,LEXIEN,0)),U,3) S:LEXMC'=LEXMAJ LEXOK=0 S:LEXSTR'=LEXST LEXOK=0 I 'LEXOK D
"RTN","LEXRXE",109,0)
 . . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXMAJ,LEXIEN)
"RTN","LEXRXE",110,0)
 . . . . S:$L(LEXST)&(+LEXMC>0) ^LEX(LEXFI,LEXIDX,LEXST,LEXMC,LEXIEN)=""
"RTN","LEXRXE",111,0)
 . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,"/",LEXMC,?58,"  ",LEXIEN
"RTN","LEXRXE",112,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",113,0)
 . N DA,DIK,LEXMC,LEXTY S DA=LEXIEN,LEXMC=$P($G(^LEX(LEXFI,DA,0)),U,1) Q:+LEXMC'>0
"RTN","LEXRXE",114,0)
 . S LEXTY=$P($G(^LEX(LEXFI,DA,0)),U,3) Q:'$L(LEXTY)
"RTN","LEXRXE",115,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXTY,LEXMC,DA)) D
"RTN","LEXRXE",116,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXTY,"/",LEXMC,?58,"  ",DA
"RTN","LEXRXE",117,0)
 . S:$L(LEXTY)&($L(LEXMC)) ^LEX(LEXFI,LEXIDX,LEXTY,LEXMC,DA)=""
"RTN","LEXRXE",118,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXE",119,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXE",120,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXE",121,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXE",122,0)
 Q
"RTN","LEXRXE",123,0)
 ;              
"RTN","LEXRXE",124,0)
 ; Miscellaneous
"RTN","LEXRXE",125,0)
SET ;   Re-Index Semantic Map file 757.1 (Set logic only)
"RTN","LEXRXE",126,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXE",127,0)
 N LEXOUT,LEXMSG S LEXFI=757.1
"RTN","LEXRXE",128,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXE",129,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXE",130,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXE",131,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXE",132,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXE",133,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXE",134,0)
 N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXE",135,0)
 . N DA,DIK S DA=+($G(LEXIEN)),DIK=LEXRT D IX1^DIK
"RTN","LEXRXE",136,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXE",137,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXE",138,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXE",139,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXE",140,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXE",141,0)
 Q
"RTN","LEXRXE",142,0)
CLR ;   Clear
"RTN","LEXRXE",143,0)
 K LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXE",144,0)
 Q
"RTN","LEXRXF")
0^12^B89637737^n/a
"RTN","LEXRXF",1,0)
LEXRXF ;ISL/KER - Re-Index 757.21 B/C/AA ;08/17/2011
"RTN","LEXRXF",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXF",3,0)
 ;               
"RTN","LEXRXF",4,0)
 ; Global Variables
"RTN","LEXRXF",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXF",6,0)
 ;    ^LEX(757.21,        SACC 1.3
"RTN","LEXRXF",7,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXF",8,0)
 ;    ^LEX(757.01,        SACC 1.3
"RTN","LEXRXF",9,0)
 ;    ^LEX(757.011,       SACC 1.3
"RTN","LEXRXF",10,0)
 ;    ^LEXT(757.2,        SACC 1.3
"RTN","LEXRXF",11,0)
 ;    ^TMP("LEXTKN")      SACC 2.3.2.5.1
"RTN","LEXRXF",12,0)
 ;    ^TMP("LEXWRD")      SACC 2.3.2.5.1
"RTN","LEXRXF",13,0)
 ;               
"RTN","LEXRXF",14,0)
 ; External References
"RTN","LEXRXF",15,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXF",16,0)
 ;    ^DIK                ICR  10013
"RTN","LEXRXF",17,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXF",18,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXF",19,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXF",20,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXF",21,0)
 ;               
"RTN","LEXRXF",22,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXF",23,0)
 ;     LEXFIX     Fix Index flag  NEWed/KILLed by LEXRXXT
"RTN","LEXRXF",24,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXF",25,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXF",26,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXF",27,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXF",28,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXF",29,0)
 ;               
"RTN","LEXRXF",30,0)
 Q
"RTN","LEXRXF",31,0)
EN ; Main Entry Point
"RTN","LEXRXF",32,0)
R75721 ; Repair file 757.21
"RTN","LEXRXF",33,0)
 K ^TMP("LEXRXF",$J) D RB,RC,RAA,SET K ^TMP("LEXRXF",$J)
"RTN","LEXRXF",34,0)
 Q
"RTN","LEXRXF",35,0)
RB ;   Index    ^LEX(757.21,"B",EXP,IEN) 
"RTN","LEXRXF",36,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXF",37,0)
 S LEXFI="757.21"
"RTN","LEXRXF",38,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.21 ""B""") Q:LEXTC=1
"RTN","LEXRXF",39,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.21,LEXIDX="B",LEXIDXT="^LEX(757.21,""B"",EXP,IEN)"
"RTN","LEXRXF",40,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXF",41,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",42,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXEX S LEXEX=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXF",43,0)
 . . S LEXOK=0 S:LEXEX=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXF",44,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN) S:$L(LEXEX) ^LEX(LEXFI,LEXIDX,LEXEX,LEXIEN)=""
"RTN","LEXRXF",45,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXF",46,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",47,0)
 . N DA,DIK,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXF",48,0)
 . I '$D(^LEX(LEXFI,LEXIDX,X,DA)) D
"RTN","LEXRXF",49,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",X,?58,"  ",DA
"RTN","LEXRXF",50,0)
 . S:$L(X) ^LEX(LEXFI,LEXIDX,X,DA)=""
"RTN","LEXRXF",51,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXF",52,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXF",53,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXF",54,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXF",55,0)
 Q
"RTN","LEXRXF",56,0)
RC ;   Index    ^LEX(757.21,"C",EXP,IEN) 
"RTN","LEXRXF",57,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXF",58,0)
 S LEXFI="757.21"
"RTN","LEXRXF",59,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.21 ""C""") Q:LEXTC=1
"RTN","LEXRXF",60,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.21,LEXIDX="C",LEXIDXT="^LEX(757.21,""C"",EXP,IEN)"
"RTN","LEXRXF",61,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXF",62,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",63,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXEX,LEXEXP
"RTN","LEXRXF",64,0)
 . . S LEXEX=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXF",65,0)
 . . S LEXEXP=$E($$UP^XLFSTR($G(^LEX(757.01,+($G(LEXEX)),0))),1,63)
"RTN","LEXRXF",66,0)
 . . S LEXOK=0 S:LEXEXP=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXF",67,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,"C",LEXSTR,LEXIEN) S:$L(LEXEXP) ^LEX(LEXFI,"C",LEXEXP,LEXIEN)=""
"RTN","LEXRXF",68,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,$E(LEXSTR,1,28),?58,"  ",LEXIEN
"RTN","LEXRXF",69,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",70,0)
 . N DA,DIK,X,LEXEXP S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1),LEXEXP=$E($$UP^XLFSTR(^LEX(757.01,X,0)),1,63)
"RTN","LEXRXF",71,0)
 . Q:+X'>0  Q:'$L(LEXEXP)
"RTN","LEXRXF",72,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXEXP,DA)) D
"RTN","LEXRXF",73,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",$E(LEXEXP,1,20),?58,"  ",DA
"RTN","LEXRXF",74,0)
 . S ^LEX(LEXFI,LEXIDX,LEXEXP,DA)=""
"RTN","LEXRXF",75,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXF",76,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXF",77,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXF",78,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXF",79,0)
 Q
"RTN","LEXRXF",80,0)
RAA ;   Index    ^LEX(757.21,("A"_SUBSET),WORD,IEN) 
"RTN","LEXRXF",81,0)
 ;            ^LEX(757.21,"ADEN",WORD,IEN)
"RTN","LEXRXF",82,0)
 ;            ^LEX(757.21,"AIMM",WORD,IEN)
"RTN","LEXRXF",83,0)
 ;            ^LEX(757.21,"ANUR",WORD,IEN)
"RTN","LEXRXF",84,0)
 ;            ^LEX(757.21,"ASOC",WORD,IEN)
"RTN","LEXRXF",85,0)
 ;            ^LEX(757.21,[etc],WORD,IEN)
"RTN","LEXRXF",86,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXEX,LEXEXI,LEXELP,LEXEXP,LEXEXPS,LEXFI,LEXI,LEXID,LEXIDX,LEXIDXT,LEXIEN,LEXJ
"RTN","LEXRXF",87,0)
 N LEXMC,LEXNDS,LEXOK,LEXSIDX,LEXSTR,LEXT,LEXTY,LEXW,LEXDENE,LEXIMME,LEXNURE,LEXSOCE,LEXDENN,LEXIMMN,LEXNURN,LEXSOCN,X
"RTN","LEXRXF",88,0)
 S LEXFI="757.21" K ^TMP("LEXRXF",$J)
"RTN","LEXRXF",89,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.21 ""AA""") Q:LEXTC=1
"RTN","LEXRXF",90,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS)=0,LEXSTR="",LEXFI=757.21,LEXIDX=" "
"RTN","LEXRXF",91,0)
 S LEXIDX=" " F  S LEXIDX=$O(^LEX(757.21,LEXIDX)) Q:'$L(LEXIDX)  D
"RTN","LEXRXF",92,0)
 . Q:LEXIDX="B"  Q:LEXIDX="C"  Q:LEXIDX?1N.N
"RTN","LEXRXF",93,0)
 . S LEXIDXT="^LEX(757.21,"""_LEXIDX_""",WORD,IEN)"
"RTN","LEXRXF",94,0)
 . N LEXBEG,LEXEND,LEXTIM,LEXERR,LEXNDS,LEXELP
"RTN","LEXRXF",95,0)
 . S LEXERR=$G(^TMP("LEXRXF",$J,LEXIDX,"E"))
"RTN","LEXRXF",96,0)
 . S LEXNDS=$G(^TMP("LEXRXF",$J,LEXIDX,"N"))
"RTN","LEXRXF",97,0)
 . S LEXELP=$G(^TMP("LEXRXF",$J,LEXIDX,"T"))
"RTN","LEXRXF",98,0)
 . S LEXBEG=$$NOW^XLFDT H 2
"RTN","LEXRXF",99,0)
 . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXF",100,0)
 . N LEXTNG,LEXTC S LEXFI="757.21",LEXTNG="Repairing"
"RTN","LEXRXF",101,0)
 . I +($G(LEXFI))>0,$D(ZTQUEUED) D  Q:LEXTC=1
"RTN","LEXRXF",102,0)
 . . S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Repairing File #757.21 """_LEXIDX_""""))
"RTN","LEXRXF",103,0)
 . F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXF",104,0)
 . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",105,0)
 . . . S LEXNDS=+($G(LEXNDS))+1,^TMP("LEXRXF",$J,LEXIDX,"N")=LEXNDS
"RTN","LEXRXF",106,0)
 . . . I '$D(^LEX(757.21,LEXIEN,0)) D  Q
"RTN","LEXRXF",107,0)
 . . . . S LEXERR=+($G(LEXERR))+1,^TMP("LEXRXF",$J,LEXIDX,"E")=LEXERR
"RTN","LEXRXF",108,0)
 . . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXF",109,0)
 . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXF",110,0)
 . . . N LEXI,LEXIX K LEXEXPS
"RTN","LEXRXF",111,0)
 . . . S LEXEX=+($G(^LEX(757.21,LEXIEN,0)))
"RTN","LEXRXF",112,0)
 . . . S LEXMC=$P(^LEX(757.01,LEXEX,1),U,1)
"RTN","LEXRXF",113,0)
 . . . S LEXID=$P($G(^LEX(757.21,LEXIEN,0)),U,2)
"RTN","LEXRXF",114,0)
 . . . S LEXID=$P(^LEXT(757.2,LEXID,0),U,2) S:$L(LEXID) LEXID="A"_LEXID Q:'$L(LEXID)
"RTN","LEXRXF",115,0)
 . . . S LEXEXI=0 F  S LEXEXI=$O(^LEX(757.01,"AMC",LEXMC,LEXEXI)) Q:+LEXEXI'>0  D
"RTN","LEXRXF",116,0)
 . . . . N LEXTY,LEXT,LEXW,LEXJ,LEXEXP,LEXSIDX S LEXEXP=$G(^LEX(757.01,LEXEXI,0))
"RTN","LEXRXF",117,0)
 . . . . S LEXTY=+($P($G(^LEX(757.01,LEXEXI,1)),U,2)) Q:LEXTY'>0
"RTN","LEXRXF",118,0)
 . . . . S LEXT=+($P($G(^LEX(757.011,LEXTY,0)),"^",2)) Q:LEXT=0
"RTN","LEXRXF",119,0)
 . . . . S LEXSIDX=LEXID K ^TMP("LEXTKN",$J) S X=LEXEXP,LEXIX=LEXIDX,LEXIDX="" D PTX^LEXTOLKN S LEXIDX=LEXIX
"RTN","LEXRXF",120,0)
 . . . . I $D(^TMP("LEXTKN",$J,0)),^TMP("LEXTKN",$J,0)>0 D
"RTN","LEXRXF",121,0)
 . . . . . N LEXI S LEXI=0 F  S LEXI=$O(^TMP("LEXTKN",$J,LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXF",122,0)
 . . . . . . N LEXW S LEXW=$O(^TMP("LEXTKN",$J,LEXI,"")) Q:'$L(LEXW)  S LEXEXPS(LEXID,LEXW,LEXIEN)=""
"RTN","LEXRXF",123,0)
 . . . . K ^TMP("LEXTKN",$J)
"RTN","LEXRXF",124,0)
 . . . I $L(LEXIDX),$L(LEXSTR),$L(LEXIEN) D
"RTN","LEXRXF",125,0)
 . . . . I '$D(LEXEXPS(LEXIDX,LEXSTR,LEXIEN)) D
"RTN","LEXRXF",126,0)
 . . . . . S LEXERR=+($G(LEXERR))+1,^TMP("LEXRXF",$J,LEXIDX,"E")=LEXERR
"RTN","LEXRXF",127,0)
 . . . . . K:'$D(LEXTEST) ^LEX(757.21,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXF",128,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXF",129,0)
 . . . . . N LEXW S LEXW="" F  S LEXW=$O(LEXEXPS(LEXIDX,LEXW)) Q:'$L(LEXW)  D
"RTN","LEXRXF",130,0)
 . . . . . . N LEXI S LEXI=0 F  S LEXI=$O(LEXEXPS(LEXIDX,LEXW,LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXF",131,0)
 . . . . . . . S ^LEX(757.21,LEXID,LEXW,LEXI)=""
"RTN","LEXRXF",132,0)
 . . . K LEXEXPS
"RTN","LEXRXF",133,0)
 . S LEXEND=$$NOW^XLFDT,LEXTIM=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXF",134,0)
 . S:$E(LEXTIM,1)=" "&($E(LEXTIM,3)=":") LEXTIM=$TR(LEXTIM," ","0")
"RTN","LEXRXF",135,0)
 . S ^TMP("LEXRXF",$J,LEXIDX,"T")=LEXTIM
"RTN","LEXRXF",136,0)
 I '$D(ZTQUEUED) W !,?8,"Check for missing records"
"RTN","LEXRXF",137,0)
 N LEXIEN,LEXNDS,LEXBEG,LEXEND,LEXELP,LEXMIS
"RTN","LEXRXF",138,0)
 S LEXBEG=$$NOW^XLFDT,LEXNDS=0,LEXMIS=0
"RTN","LEXRXF",139,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",140,0)
 . N DA,LEXIX,LEXAIX,LEXERR,LEXEXP,LEXMC,LEXTEXP,LEXW S DA=LEXIEN
"RTN","LEXRXF",141,0)
 . S LEXIX=$P($G(^LEX(LEXFI,DA,0)),"^",2),LEXIX=$P($G(^LEXT(757.2,+LEXIX,0)),"^",2)
"RTN","LEXRXF",142,0)
 . S LEXAIX="A"_LEXIX
"RTN","LEXRXF",143,0)
 . S LEXERR=$G(^TMP("LEXRXF",$J,LEXAIX,"E"))
"RTN","LEXRXF",144,0)
 . K ^TMP("LEXWRD",$J)
"RTN","LEXRXF",145,0)
 . S LEXEXP=+(^LEX(757.21,DA,0)),LEXMC=$P(^LEX(757.01,LEXEXP,1),U,1)
"RTN","LEXRXF",146,0)
 . K ^TMP("LEXTKN",$J),^TMP("LEXWRD",$J)
"RTN","LEXRXF",147,0)
 . S LEXNDS=LEXNDS+1
"RTN","LEXRXF",148,0)
 . S LEXTEXP=0 F  S LEXTEXP=$O(^LEX(757.01,"AMC",LEXMC,LEXTEXP)) Q:+LEXTEXP=0  D
"RTN","LEXRXF",149,0)
 . . N X,LEXIDX,LEXYPE,LEXT,LEXJ S X=$G(^LEX(757.01,LEXTEXP,0)),LEXIDX="" Q:'$L(X)
"RTN","LEXRXF",150,0)
 . . S LEXYPE=+($P($G(^LEX(757.01,LEXTEXP,1)),U,2)) Q:LEXYPE'>0
"RTN","LEXRXF",151,0)
 . . S LEXT=+($P($G(^LEX(757.011,LEXYPE,0)),"^",2)) Q:LEXT=0
"RTN","LEXRXF",152,0)
 . . D PTX^LEXTOLKN I $D(^TMP("LEXTKN",$J,0)),^TMP("LEXTKN",$J,0)>0 F LEXJ=1:1:^TMP("LEXTKN",$J,0) D
"RTN","LEXRXF",153,0)
 . . . N LEXW S LEXW=$O(^TMP("LEXTKN",$J,LEXJ,"")) S:$L(LEXW) ^TMP("LEXWRD",$J,LEXW)=""
"RTN","LEXRXF",154,0)
 . . K ^TMP("LEXTKN",$J) Q
"RTN","LEXRXF",155,0)
 . S LEXW="" F  S LEXW=$O(^TMP("LEXWRD",$J,LEXW)) Q:'$L(LEXW)  D
"RTN","LEXRXF",156,0)
 . . I '$D(^LEX(LEXFI,LEXAIX,LEXW,DA)) D
"RTN","LEXRXF",157,0)
 . . . S LEXMIS=LEXMIS+0
"RTN","LEXRXF",158,0)
 . . . S LEXERR=+($G(LEXERR))+1,^TMP("LEXRXF",$J,LEXAIX,"E")=LEXERR
"RTN","LEXRXF",159,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXAIX,?30,"Missing ",$E(LEXW,1,18),?58,"  ",DA
"RTN","LEXRXF",160,0)
 . . S:$L(LEXW)&(+DA>0)&($L(LEXAIX))&($L(LEXFI)) ^LEX(LEXFI,LEXAIX,LEXW,DA)=""
"RTN","LEXRXF",161,0)
 . K ^TMP("LEXWRD",$J),^TMP("LEXTKN",$J)
"RTN","LEXRXF",162,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXF",163,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXF",164,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"AAAA",LEXNDS,LEXMIS,"^LEX(757.21,""ASUB"",WORD,IEN)",LEXELP)
"RTN","LEXRXF",165,0)
 S LEXIDX=" " F  S LEXIDX=$O(^LEX(757.21,LEXIDX)) Q:'$L(LEXIDX)  D
"RTN","LEXRXF",166,0)
 . Q:LEXIDX="B"  Q:LEXIDX="C"
"RTN","LEXRXF",167,0)
 . N LEXFI,LEXERR,LEXELP,LEXNDS,LEXIDXT S LEXFI=757.21
"RTN","LEXRXF",168,0)
 . S LEXERR=$G(^TMP("LEXRXF",$J,LEXIDX,"E"))
"RTN","LEXRXF",169,0)
 . S LEXNDS=$G(^TMP("LEXRXF",$J,LEXIDX,"N"))
"RTN","LEXRXF",170,0)
 . S LEXELP=$G(^TMP("LEXRXF",$J,LEXIDX,"T"))
"RTN","LEXRXF",171,0)
 . S LEXIDXT="^LEX(757.21,"""_LEXIDX_""",WORD,IEN)"
"RTN","LEXRXF",172,0)
 . S LEXERR=$S(+($G(LEXERR))>0:LEXERR,1:"")
"RTN","LEXRXF",173,0)
 . S LEXNDS=$S(+($G(LEXNDS))>0:LEXNDS,1:"")
"RTN","LEXRXF",174,0)
 . S LEXELP=$S($L($G(LEXELP))>0:LEXELP,1:"")
"RTN","LEXRXF",175,0)
 . D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXF",176,0)
 K ^TMP("LEXRXF",$J)
"RTN","LEXRXF",177,0)
 Q
"RTN","LEXRXF",178,0)
 ;              
"RTN","LEXRXF",179,0)
 ; Miscellaneous
"RTN","LEXRXF",180,0)
SET ;   Re-Index Subset file 757.21 (Set logic only)
"RTN","LEXRXF",181,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXF",182,0)
 N LEXOUT,LEXMSG S LEXFI=757.21
"RTN","LEXRXF",183,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXF",184,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXF",185,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXF",186,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXF",187,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXF",188,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXF",189,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXF",190,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXF",191,0)
 . N DA,DIK S DA=+($G(LEXIEN))  D:$D(LEXFIX) FIX(DA)
"RTN","LEXRXF",192,0)
 . I $D(^LEX(LEXFI,+LEXIEN,0)) D
"RTN","LEXRXF",193,0)
 . . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXF",194,0)
 . . S DA=LEXIEN,DIK=LEXRT D IX1^DIK
"RTN","LEXRXF",195,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXF",196,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXF",197,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXF",198,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXF",199,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXF",200,0)
 Q
"RTN","LEXRXF",201,0)
FIX(X) ;   Fix Deactivated Expressions in 757.21
"RTN","LEXRXF",202,0)
 N DA,DIK,LEXEXP,LEXDFL Q:'$D(LEXFIX)  S DA=+($G(X)) Q:+DA'>0  Q:'$D(^LEX(757.21,+DA,0))
"RTN","LEXRXF",203,0)
 S LEXEXP=+$G(^LEX(757.21,+DA,0)) Q:+LEXEXP'>0
"RTN","LEXRXF",204,0)
 S LEXDFL=$P($G(^LEX(757.01,+LEXEXP,1)),"^",5) Q:+LEXDFL'>0
"RTN","LEXRXF",205,0)
 I $D(LEXFIX) S DIK="^LEX(757.21," D ^DIK
"RTN","LEXRXF",206,0)
 Q
"RTN","LEXRXF",207,0)
CLR ;   Clear
"RTN","LEXRXF",208,0)
 N LEXFIX,LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXF",209,0)
 Q
"RTN","LEXRXG")
0^13^B75572745^n/a
"RTN","LEXRXG",1,0)
LEXRXG ;ISL/KER - Re-Index 757.33 B/C/G ;08/17/2011
"RTN","LEXRXG",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXG",3,0)
 ;               
"RTN","LEXRXG",4,0)
 ; Global Variables
"RTN","LEXRXG",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXG",6,0)
 ;    ^LEX(757.33,        SACC 1.3
"RTN","LEXRXG",7,0)
 ;    ^LEX(757.32,        SACC 1.3
"RTN","LEXRXG",8,0)
 ;               
"RTN","LEXRXG",9,0)
 ; External References
"RTN","LEXRXG",10,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXG",11,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXG",12,0)
 ;    IX2^DIK             ICR  10013
"RTN","LEXRXG",13,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXRXG",14,0)
 ;    $$FMADD^XLFDT       ICR  10103
"RTN","LEXRXG",15,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXG",16,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXRXG",17,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXG",18,0)
 ;               
"RTN","LEXRXG",19,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXG",20,0)
 ;     LEXFIX     Fix Index flag  NEWed/KILLed by LEXRXXT
"RTN","LEXRXG",21,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXG",22,0)
 ;     LEXSET     Re-Index flag   NEWed/KILLed by LEXRXXT
"RTN","LEXRXG",23,0)
 ;     LEXQ       Quiet flat      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXG",24,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXG",25,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXG",26,0)
 ;               
"RTN","LEXRXG",27,0)
 Q
"RTN","LEXRXG",28,0)
EN ; Main Entry Point
"RTN","LEXRXG",29,0)
R75733 ; Repair file 757.33
"RTN","LEXRXG",30,0)
 D RB,RC,RG,R75733^LEXRXG2,R75733^LEXRXG3,SET
"RTN","LEXRXG",31,0)
 Q
"RTN","LEXRXG",32,0)
RB ;   Index    ^LEX(757.33,"B",MID,IEN) 
"RTN","LEXRXG",33,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSTR
"RTN","LEXRXG",34,0)
 S LEXFI="757.33"
"RTN","LEXRXG",35,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""B""") Q:LEXTC=1
"RTN","LEXRXG",36,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSTR="",LEXFI=757.33,LEXIDX="B",LEXIDXT="^LEX(757.33,""B"",MID,IEN)"
"RTN","LEXRXG",37,0)
 F  S LEXSTR=$O(^LEX(LEXFI,LEXIDX,LEXSTR)) Q:'$L(LEXSTR)  D
"RTN","LEXRXG",38,0)
 . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",39,0)
 . . S LEXNDS=LEXNDS+1 N LEXOK,LEXID S LEXID=$P($G(^LEX(LEXFI,LEXIEN,0)),"^",1)
"RTN","LEXRXG",40,0)
 . . S LEXOK=0 S:LEXID=LEXSTR LEXOK=1 I 'LEXOK D
"RTN","LEXRXG",41,0)
 . . . S LEXERR=LEXERR+1 K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSTR,LEXIEN)
"RTN","LEXRXG",42,0)
 . . . S:$L(LEXID) ^LEX(LEXFI,LEXIDX,LEXID,LEXIEN)=""
"RTN","LEXRXG",43,0)
 . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,LEXSTR,?58,"  ",LEXIEN
"RTN","LEXRXG",44,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",45,0)
 . N DA,DIK,X S DA=LEXIEN,X=$P($G(^LEX(LEXFI,DA,0)),"^",1) Q:'$L(X)
"RTN","LEXRXG",46,0)
 . I '$D(^LEX(LEXFI,LEXIDX,X,DA)) D
"RTN","LEXRXG",47,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",X,?58,"  ",DA
"RTN","LEXRXG",48,0)
 . S:$L(X) ^LEX(LEXFI,LEXIDX,X,DA)=""
"RTN","LEXRXG",49,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG",50,0)
 H 2 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG",51,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG",52,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG",53,0)
 Q
"RTN","LEXRXG",54,0)
RC ;   Index    ^LEX(757.33,"C",DEF,SRC,ORD,TAR,IEN)
"RTN","LEXRXG",55,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF
"RTN","LEXRXG",56,0)
 S LEXFI="757.33"
"RTN","LEXRXG",57,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""C""") Q:LEXTC=1
"RTN","LEXRXG",58,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXDEF="",LEXFI=757.33,LEXIDX="C",LEXIDXT="^LEX(757.33,""C"",EXP,IEN)"
"RTN","LEXRXG",59,0)
 F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG",60,0)
 . N LEXSRC S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG",61,0)
 . . N LEXORD S LEXORD="" F  S LEXORD=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXORD)) Q:'$L(LEXORD)  D
"RTN","LEXRXG",62,0)
 . . . N LEXTAR S LEXTAR="" F  S LEXTAR=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXORD,LEXTAR)) Q:'$L(LEXTAR)  D
"RTN","LEXRXG",63,0)
 . . . . N LEXIEN S LEXIEN="" F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXORD,LEXTAR,LEXIEN)) Q:'$L(LEXIEN)  D
"RTN","LEXRXG",64,0)
 . . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXN3,LEXD,LEXS,LEXO,LEXT S LEXN0=$G(^LEX(757.33,+LEXIEN,0)),LEXN3=$G(^LEX(757.33,+LEXIEN,3))
"RTN","LEXRXG",65,0)
 . . . . . S LEXD=$P(LEXN0,"^",4),LEXS=$P(LEXN0,"^",2),LEXO=$P(LEXN3,"^",1),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG",66,0)
 . . . . . Q:'$L(LEXD)  Q:'$L(LEXS)  Q:'$L(LEXO)  Q:'$L(LEXT)
"RTN","LEXRXG",67,0)
 . . . . . I LEXDEF'=LEXD!(LEXSRC'=LEXS)!(LEXORD'=LEXO)!(LEXTAR'=LEXT) D
"RTN","LEXRXG",68,0)
 . . . . . . N DA S DA=LEXIEN S LEXERR=LEXERR+1
"RTN","LEXRXG",69,0)
 . . . . . . K ^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXORD,LEXTAR,LEXIEN)
"RTN","LEXRXG",70,0)
 . . . . . . S ^LEX(LEXFI,LEXIDX,LEXD,LEXS,LEXO,LEXT,DA)=""
"RTN","LEXRXG",71,0)
 . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXSRC,"/",LEXTAR,?58,"  ",DA
"RTN","LEXRXG",72,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",73,0)
 . N DA,DIK,X,LEXN0,LEXN3,LEXD,LEXS,LEXO,LEXT S DA=LEXIEN,LEXN0=$G(^LEX(757.33,+LEXIEN,0)),LEXN3=$G(^LEX(757.33,+LEXIEN,3))
"RTN","LEXRXG",74,0)
 . S LEXD=$P(LEXN0,"^",4),LEXS=$P(LEXN0,"^",2),LEXO=$P(LEXN3,"^",1),LEXT=$P(LEXN0,"^",3) Q:'$L(LEXD)  Q:'$L(LEXS)  Q:'$L(LEXO)  Q:'$L(LEXT)
"RTN","LEXRXG",75,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXD,LEXS,LEXO,LEXT,DA)) D
"RTN","LEXRXG",76,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXS,"/",LEXT,?58,"  ",DA
"RTN","LEXRXG",77,0)
 . S ^LEX(LEXFI,LEXIDX,LEXD,LEXS,LEXO,LEXT,DA)=""
"RTN","LEXRXG",78,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG",79,0)
 H 2 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG",80,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG",81,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG",82,0)
 Q
"RTN","LEXRXG",83,0)
RG ;   Index    ^LEX(757.33,"G",MAP,EFF,STA,IEN,HIS)
"RTN","LEXRXG",84,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF
"RTN","LEXRXG",85,0)
 S LEXFI="757.33"
"RTN","LEXRXG",86,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""G""") Q:LEXTC=1
"RTN","LEXRXG",87,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXDEF="",LEXFI=757.33,LEXIDX="G",LEXIDXT="^LEX(757.33,""G"",EXP,IEN)"
"RTN","LEXRXG",88,0)
 F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG",89,0)
 . N LEXEFF S LEXEFF="" F  S LEXEFF=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEXRXG",90,0)
 . . N LEXSTA S LEXSTA="" F  S LEXSTA=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXEFF,LEXSTA)) Q:'$L(LEXSTA)  D
"RTN","LEXRXG",91,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXEFF,LEXSTA,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",92,0)
 . . . . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXEFF,LEXSTA,LEXIEN,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXG",93,0)
 . . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXHN,LEXD,LEXE,LEXS
"RTN","LEXRXG",94,0)
 . . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0)),LEXNH=$G(^LEX(757.33,+LEXIEN,2,+LEXHIS,0))
"RTN","LEXRXG",95,0)
 . . . . . S LEXD=$P(LEXN0,"^",1),LEXE=$P(LEXNH,"^",1),LEXS=$P(LEXNH,"^",2)
"RTN","LEXRXG",96,0)
 . . . . . Q:'$L(LEXD)  Q:'$L(LEXE)  Q:'$L(LEXS)
"RTN","LEXRXG",97,0)
 . . . . . I LEXDEF'=LEXD!(LEXEFF'=LEXE)!(LEXSTA'=LEXS) D
"RTN","LEXRXG",98,0)
 . . . . . . N DA,LEXED,LEXSD S DA(1)=LEXIEN,DA=LEXHIS S LEXERR=LEXERR+1
"RTN","LEXRXG",99,0)
 . . . . . . S LEXED=$TR($$FMTE^XLFDT(LEXEFF,"5DZ"),"@"," ")
"RTN","LEXRXG",100,0)
 . . . . . . S LEXSD=$S(+LEXSTA>0:"Active",1:"Inactive")
"RTN","LEXRXG",101,0)
 . . . . . . K ^LEX(757.33,"G",LEXDEF,LEXEFF,LEXSTA,DA(1))
"RTN","LEXRXG",102,0)
 . . . . . . S ^LEX(757.33,"G",LEXD,LEXE,LEXS,DA(1))=""
"RTN","LEXRXG",103,0)
 . . . . . . S ^LEX(757.33,"G",LEXD,LEXE,LEXS,DA(1),DA)=""
"RTN","LEXRXG",104,0)
 . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXED," ",LEXSD,?58,"  ",DA(1),"/",DA
"RTN","LEXRXG",105,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",106,0)
 . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIEN,2,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXG",107,0)
 . . N DA,DIK,X,LEXN0,LEXHN,LEXD,LEXE,LEXS,LEXED,LEXSD
"RTN","LEXRXG",108,0)
 . . S DA(1)=LEXIEN,DA=LEXHIS
"RTN","LEXRXG",109,0)
 . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG",110,0)
 . . S LEXNH=$G(^LEX(757.33,+LEXIEN,2,+LEXHIS,0))
"RTN","LEXRXG",111,0)
 . . S LEXD=$P(LEXN0,"^",1),LEXE=$P(LEXNH,"^",1),LEXS=$P(LEXNH,"^",2) Q:'$L(LEXD)  Q:'$L(LEXE)  Q:'$L(LEXS)
"RTN","LEXRXG",112,0)
 . . S LEXED=$TR($$FMTE^XLFDT(LEXE,"5DZ"),"@"," ")
"RTN","LEXRXG",113,0)
 . . S LEXSD=$S(+LEXS>0:"Active",1:"Inactive")
"RTN","LEXRXG",114,0)
 . . I $D(^LEX(LEXFI,LEXIDX,LEXD,LEXE,LEXS,DA(1)))<11 D
"RTN","LEXRXG",115,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXED," ",LEXSD,?58,"  ",DA(1),"/",DA
"RTN","LEXRXG",116,0)
 . . S ^LEX(LEXFI,LEXIDX,LEXD,LEXE,LEXS,DA(1))=""
"RTN","LEXRXG",117,0)
 . . S ^LEX(LEXFI,LEXIDX,LEXD,LEXE,LEXS,DA(1),DA)=""
"RTN","LEXRXG",118,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG",119,0)
 H 2 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG",120,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG",121,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG",122,0)
 Q
"RTN","LEXRXG",123,0)
 ;              
"RTN","LEXRXG",124,0)
 ; Miscellaneous
"RTN","LEXRXG",125,0)
SET ;   Re-Index Subset file 757.33 (Set logic only)
"RTN","LEXRXG",126,0)
 Q:'$D(LEXSET)  N LEXTC,LEXPRE,LEXBEG,LEXEND,LEXELP,LEXNM,LEXFI,LEXRT
"RTN","LEXRXG",127,0)
 N LEXOUT,LEXMSG S LEXFI=757.33
"RTN","LEXRXG",128,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXG",129,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX"
"RTN","LEXRXG",130,0)
 S LEXPRE=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXG",131,0)
 S LEXBEG=$$NOW^XLFDT,LEXNM=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXG",132,0)
 S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI))
"RTN","LEXRXG",133,0)
 Q:LEXTC=1  I '$D(ZTQUEUED) W !,?8,"Re-Indexing",!
"RTN","LEXRXG",134,0)
 N LEXIEN,LEXP3,LEXP4 S (LEXP3,LEXP4,LEXIEN)=0
"RTN","LEXRXG",135,0)
 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG",136,0)
 . N DA,DIK S DA=+($G(LEXIEN)) I $D(LEXFIX) D FIX(DA)
"RTN","LEXRXG",137,0)
 . I $D(^LEX(LEXFI,LEXIEN)) D
"RTN","LEXRXG",138,0)
 . . S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXG",139,0)
 . . S DA=LEXIEN,DIK=LEXRT D IX1^DIK
"RTN","LEXRXG",140,0)
 S $P(^LEX(LEXFI,0),"^",3)=LEXP3,$P(^LEX(LEXFI,0),"^",4)=LEXP4
"RTN","LEXRXG",141,0)
 Q:$D(LEXQ)  S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG",142,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG",143,0)
 D REP^LEXRXXS(LEXFI,LEXFI,"ALLIX",,,"Re-Index",LEXELP)
"RTN","LEXRXG",144,0)
 S LEXELP=$$ADDT^LEXRXXM(LEXELP,LEXPRE)
"RTN","LEXRXG",145,0)
 S ^TMP("LEXRX",$J,"T",1,"ELAP")=LEXELP
"RTN","LEXRXG",146,0)
 Q
"RTN","LEXRXG",147,0)
FIX(X) ;   Fix Inactive Mappings 757.33
"RTN","LEXRXG",148,0)
 N DA,DIK,LEXDEF,LEXEF,LEXEF1,LEXHIS,LEXMAP,LEXN0,LEXNC,LEXNE,LEXNEXT
"RTN","LEXRXG",149,0)
 N LEXNH,LEXNS,LEXSCODE,LEXSEFF,LEXSIEN,LEXSNOM,LEXSRC,LEXSSAB,LEXSSTA
"RTN","LEXRXG",150,0)
 N LEXSSYS,LEXST,LEXTCODE,LEXTD,LEXTEFF,LEXTIEN,LEXTNON,LEXTSAB
"RTN","LEXRXG",151,0)
 N LEXTSTA,LEXTSYS S LEXTD=$$DT^XLFDT,DA=+($G(X)) Q:+DA'>0
"RTN","LEXRXG",152,0)
 Q:'$D(^LEX(757.33,DA,0))  Q:'$D(^LEX(757.33,DA,2))
"RTN","LEXRXG",153,0)
 S LEXN0=$G(^LEX(757.33,DA,0))
"RTN","LEXRXG",154,0)
 S LEXEF=$O(^LEX(757.33,+DA,2,"B",(LEXTD+.001)),-1) Q:LEXEF'?7N
"RTN","LEXRXG",155,0)
 S LEXEF1=$$FMADD^XLFDT(LEXEF,1) Q:LEXEF1'?7N  Q:LEXEF1'<LEXTD
"RTN","LEXRXG",156,0)
 S LEXHIS=$O(^LEX(757.33,+DA,2,"B",+LEXEF," "),-1)
"RTN","LEXRXG",157,0)
 S LEXNH=$G(^LEX(757.33,+DA,2,+LEXHIS,0)) S LEXST=$P(LEXNH,"^",2)
"RTN","LEXRXG",158,0)
 Q:LEXST'>0  S LEXSCODE=$P(LEXN0,"^",2) S LEXTCODE=$P(LEXN0,"^",3)
"RTN","LEXRXG",159,0)
 S LEXMAP=$P(LEXN0,"^",4) S LEXDEF=$G(^LEX(757.32,+LEXMAP,2))
"RTN","LEXRXG",160,0)
 S LEXSSYS=$P(LEXDEF,"^",1),LEXTSYS=$P(LEXDEF,"^",2)
"RTN","LEXRXG",161,0)
 S LEXSRC=$G(^LEX(757.03,LEXSSYS,0))
"RTN","LEXRXG",162,0)
 S LEXSSAB=$E(LEXSRC,1,3),LEXSNOM=$P(LEXSRC,"^",2)
"RTN","LEXRXG",163,0)
 S LEXSRC=$G(^LEX(757.03,LEXTSYS,0))
"RTN","LEXRXG",164,0)
 S LEXTSAB=$E(LEXSRC,1,3),LEXTNON=$P(LEXSRC,"^",2)
"RTN","LEXRXG",165,0)
 S LEXSSTA=$$STATCHK^LEXSRC2(LEXSCODE,LEXTD,,LEXSSAB)
"RTN","LEXRXG",166,0)
 S LEXSIEN=$P(LEXSSTA,"^",2),LEXSEFF=$P(LEXSSTA,"^",3)
"RTN","LEXRXG",167,0)
 S LEXTSTA=$$STATCHK^LEXSRC2(LEXTCODE,LEXTD,,LEXTSAB)
"RTN","LEXRXG",168,0)
 S LEXTIEN=$P(LEXTSTA,"^",2),LEXTEFF=$P(LEXSSTA,"^",3)
"RTN","LEXRXG",169,0)
 Q:+LEXSSTA>0&(+LEXTSTA>0)  S LEXNEXT=$O(^LEX(757.33,+DA,2," "),-1)+1
"RTN","LEXRXG",170,0)
 S LEXNS=0,LEXNE=LEXEF1,LEXNC=$$NOW^XLFDT I $D(LEXFIX) D
"RTN","LEXRXG",171,0)
 . N DIK S DIK="^LEX(757.33," D IX2^DIK
"RTN","LEXRXG",172,0)
 . S ^LEX(757.33,+DA,2,0)="^757.333D^"_LEXNEXT_"^"_LEXNEXT
"RTN","LEXRXG",173,0)
 . S ^LEX(757.33,+DA,2,+LEXNEXT,0)=LEXNE_"^"_LEXNS_"^"_LEXNC
"RTN","LEXRXG",174,0)
 . W "."
"RTN","LEXRXG",175,0)
 . S DIK="^LEX(757.33," D IX1^DIK
"RTN","LEXRXG",176,0)
 Q
"RTN","LEXRXG",177,0)
CLR ;   Clear
"RTN","LEXRXG",178,0)
 K LEXFIX,LEXNAM,LEXSET,LEXTEST,ZTQUEUED,LEXQ
"RTN","LEXRXG",179,0)
 Q
"RTN","LEXRXG2")
0^14^B52721583^n/a
"RTN","LEXRXG2",1,0)
LEXRXG2 ;ISL/KER - Re-Index 757.33 ACT/AMAP/AREV ;08/17/2011
"RTN","LEXRXG2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXG2",3,0)
 ;               
"RTN","LEXRXG2",4,0)
 ; Global Variables
"RTN","LEXRXG2",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXG2",6,0)
 ;    ^LEX(757.33,        SACC 1.3
"RTN","LEXRXG2",7,0)
 ;    ^LEX(757.32,        SACC 1.3
"RTN","LEXRXG2",8,0)
 ;               
"RTN","LEXRXG2",9,0)
 ; External References
"RTN","LEXRXG2",10,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXG2",11,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXRXG2",12,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXG2",13,0)
 ;               
"RTN","LEXRXG2",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXG2",15,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXG2",16,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXG2",17,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXG2",18,0)
 ;               
"RTN","LEXRXG2",19,0)
 Q
"RTN","LEXRXG2",20,0)
EN ; Main Entry Point
"RTN","LEXRXG2",21,0)
R75733 ; Repair file 757.33
"RTN","LEXRXG2",22,0)
 D RACT,RAMAP,RAREV
"RTN","LEXRXG2",23,0)
 Q
"RTN","LEXRXG2",24,0)
RACT ;   Index    ^LEX(757.33,"ACT",SRC,TGT,EFF,STA,IEN,HIS)
"RTN","LEXRXG2",25,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXEFF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXSRC,LEXSTA,LEXTGT
"RTN","LEXRXG2",26,0)
 S LEXFI="757.33"
"RTN","LEXRXG2",27,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""ACT""") Q:LEXTC=1
"RTN","LEXRXG2",28,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXSRC="",LEXFI=757.33,LEXIDX="ACT",LEXIDXT="^LEX(757.33,""ACT"",SR,TG,EF,ST,IEN,HIS)"
"RTN","LEXRXG2",29,0)
 S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG2",30,0)
 . N LEXTGT S LEXTGT="" F  S LEXTGT=$O(^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT)) Q:'$L(LEXTGT)  D
"RTN","LEXRXG2",31,0)
 . . N LEXEFF S LEXEFF="" F  S LEXEFF=$O(^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT,LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEXRXG2",32,0)
 . . . N LEXSTA S LEXSTA="" F  S LEXSTA=$O(^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT,LEXEFF,LEXSTA)) Q:'$L(LEXSTA)  D
"RTN","LEXRXG2",33,0)
 . . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT,LEXEFF,LEXSTA,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",34,0)
 . . . . . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT,LEXEFF,LEXSTA,LEXIEN,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXG2",35,0)
 . . . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXNH,LEXR,LEXT,LEXE,LEXS,LEXED,LEXSD
"RTN","LEXRXG2",36,0)
 . . . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0)),LEXNH=$G(^LEX(757.33,+LEXIEN,2,+LEXHIS,0))
"RTN","LEXRXG2",37,0)
 . . . . . . S LEXR=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3),LEXE=$P(LEXNH,"^",1),LEXS=$P(LEXNH,"^",2)
"RTN","LEXRXG2",38,0)
 . . . . . . Q:'$L(LEXR)  Q:'$L(LEXT)  Q:'$L(LEXE)  Q:'$L(LEXS)
"RTN","LEXRXG2",39,0)
 . . . . . . S LEXED=$TR($$FMTE^XLFDT(LEXEFF,"5DZ"),"@"," ")
"RTN","LEXRXG2",40,0)
 . . . . . . S LEXSD=$S(+LEXSTA>0:"Active",1:"Inactive")
"RTN","LEXRXG2",41,0)
 . . . . . . I $TR(LEXSRC," ","")'=LEXR!($TR(LEXTGT," ","")'=LEXT)!(LEXEFF'=LEXE)!(LEXSTA'=LEXS) D
"RTN","LEXRXG2",42,0)
 . . . . . . . N DA S DA(1)=LEXIEN,DA=LEXHIS S LEXERR=LEXERR+1
"RTN","LEXRXG2",43,0)
 . . . . . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXSRC,LEXTGT,LEXEFF,LEXSTA,LEXIEN,LEXHIS)
"RTN","LEXRXG2",44,0)
 . . . . . . . S:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,(LEXR_" "),(LEXT_" "),LEXE,LEXS,DA(1),DA)=""
"RTN","LEXRXG2",45,0)
 . . . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXED," ",LEXSD,?58,"  ",DA(1),"/",DA
"RTN","LEXRXG2",46,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",47,0)
 . N LEXHIS S LEXHIS=0 F  S LEXHIS=$O(^LEX(LEXFI,LEXIEN,2,LEXHIS)) Q:+LEXHIS'>0  D
"RTN","LEXRXG2",48,0)
 . . N DA,DIK,X,LEXN0,LEXHN,LEXR,LEXT,LEXE,LEXS,LEXED,LEXSD
"RTN","LEXRXG2",49,0)
 . . S DA(1)=LEXIEN,DA=LEXHIS,LEXN0=$G(^LEX(757.33,+LEXIEN,0)),LEXNH=$G(^LEX(757.33,+LEXIEN,2,+LEXHIS,0))
"RTN","LEXRXG2",50,0)
 . . S LEXR=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3),LEXE=$P(LEXNH,"^",1),LEXS=$P(LEXNH,"^",2)
"RTN","LEXRXG2",51,0)
 . . Q:'$L(LEXR)  Q:'$L(LEXT)  Q:'$L(LEXE)  Q:'$L(LEXS)  S LEXED=$TR($$FMTE^XLFDT(LEXE,"5DZ"),"@"," ")
"RTN","LEXRXG2",52,0)
 . . S LEXSD=$S(+LEXS>0:"Active",1:"Inactive") I '$D(^LEX(LEXFI,LEXIDX,(LEXR_" "),(LEXT_" "),LEXE,LEXS,DA(1),DA)) D
"RTN","LEXRXG2",53,0)
 . . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXED," ",LEXSD,?58,"  ",DA(1),"/",DA
"RTN","LEXRXG2",54,0)
 . . S ^LEX(LEXFI,LEXIDX,(LEXR_" "),(LEXT_" "),LEXE,LEXS,DA(1),DA)=""
"RTN","LEXRXG2",55,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG2",56,0)
 H 5 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG2",57,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG2",58,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG2",59,0)
 Q
"RTN","LEXRXG2",60,0)
RAMAP ;   Index    ^LEX(757.33,"AMAP",DEF,SRC,TGT,IEN)
"RTN","LEXRXG2",61,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF,LEXTGT
"RTN","LEXRXG2",62,0)
 S LEXFI="757.33"
"RTN","LEXRXG2",63,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""AMAP""") Q:LEXTC=1
"RTN","LEXRXG2",64,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXDEF="",LEXFI=757.33,LEXIDX="AMAP",LEXIDXT="^LEX(757.33,""AMAP"",DEF,SRC,TGT,IEN)"
"RTN","LEXRXG2",65,0)
 S LEXDEF="" F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG2",66,0)
 . S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG2",67,0)
 . . S LEXTGT="" F  S LEXTGT=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXTGT)) Q:'$L(LEXTGT)  D
"RTN","LEXRXG2",68,0)
 . . . S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXTGT,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",69,0)
 . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXNH,LEXD,LEXN,LEXT,LEXE,LEXS
"RTN","LEXRXG2",70,0)
 . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",71,0)
 . . . . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG2",72,0)
 . . . . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG2",73,0)
 . . . . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG2",74,0)
 . . . . I LEXDEF'=LEXN!($TR(LEXSRC," ","")'=LEXS)!($TR(LEXTGT," ","")'=LEXT) D
"RTN","LEXRXG2",75,0)
 . . . . . N DA S DA=LEXIEN S LEXERR=LEXERR+1
"RTN","LEXRXG2",76,0)
 . . . . . K:'$D(LEXTEST) ^LEX(757.33,LEXIDX,LEXDEF,LEXSRC,LEXTGT,DA)
"RTN","LEXRXG2",77,0)
 . . . . . S:'$D(LEXTEST) ^LEX(757.33,LEXIDX,LEXN,LEXS,LEXT,DA)=""
"RTN","LEXRXG2",78,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXN," Map ",LEXS,?58,"  ",DA
"RTN","LEXRXG2",79,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",80,0)
 . N DA,DIK,X,LEXN0,LEXD,LEXN,LEXS,LEXT
"RTN","LEXRXG2",81,0)
 . S DA=LEXIEN,LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",82,0)
 . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",83,0)
 . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG2",84,0)
 . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG2",85,0)
 . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG2",86,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXN,(LEXS_" "),(LEXT_" "),DA)) D
"RTN","LEXRXG2",87,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXN," Map ",LEXS,?58,"  ",DA
"RTN","LEXRXG2",88,0)
 . S ^LEX(LEXFI,LEXIDX,LEXN,(LEXS_" "),(LEXT_" "),DA)=""
"RTN","LEXRXG2",89,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG2",90,0)
 H 3 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG2",91,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG2",92,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG2",93,0)
 Q
"RTN","LEXRXG2",94,0)
RAREV ;   Index    ^LEX(757.33,"AREV",DEF,TGT,SRC,IEN)
"RTN","LEXRXG2",95,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF,LEXTGT
"RTN","LEXRXG2",96,0)
 S LEXFI="757.33"
"RTN","LEXRXG2",97,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""AREV""") Q:LEXTC=1
"RTN","LEXRXG2",98,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXDEF="",LEXFI=757.33,LEXIDX="AREV",LEXIDXT="^LEX(757.33,""AREV"",DEF,TGT,SRC,IEN)"
"RTN","LEXRXG2",99,0)
 S LEXDEF="" F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG2",100,0)
 . S LEXTGT="" F  S LEXTGT=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT)) Q:'$L(LEXTGT)  D
"RTN","LEXRXG2",101,0)
 . . S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG2",102,0)
 . . . S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",103,0)
 . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXNH,LEXD,LEXN,LEXT,LEXE,LEXS
"RTN","LEXRXG2",104,0)
 . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",105,0)
 . . . . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG2",106,0)
 . . . . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG2",107,0)
 . . . . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG2",108,0)
 . . . . I LEXDEF'=LEXN!($TR(LEXSRC," ","")'=LEXS)!($TR(LEXTGT," ","")'=LEXT) D
"RTN","LEXRXG2",109,0)
 . . . . . N DA S DA=LEXIEN S LEXERR=LEXERR+1
"RTN","LEXRXG2",110,0)
 . . . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC,LEXIEN)
"RTN","LEXRXG2",111,0)
 . . . . . S:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),LEXIEN)=""
"RTN","LEXRXG2",112,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG2",113,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG2",114,0)
 . N DA,DIK,X,LEXN0,LEXD,LEXN,LEXS,LEXT
"RTN","LEXRXG2",115,0)
 . S DA=LEXIEN,LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",116,0)
 . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG2",117,0)
 . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG2",118,0)
 . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG2",119,0)
 . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG2",120,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),DA)) D
"RTN","LEXRXG2",121,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG2",122,0)
 . S ^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),DA)=""
"RTN","LEXRXG2",123,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG2",124,0)
 H 3 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG2",125,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG2",126,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG2",127,0)
 Q
"RTN","LEXRXG2",128,0)
 ;              
"RTN","LEXRXG2",129,0)
 ; Miscellaneous
"RTN","LEXRXG2",130,0)
CLR ;   Clear
"RTN","LEXRXG2",131,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXG2",132,0)
 Q
"RTN","LEXRXG3")
0^15^B26643925^n/a
"RTN","LEXRXG3",1,0)
LEXRXG3 ;ISL/KER - Re-Index 757.33 ASRC/ATAR ;08/17/2011
"RTN","LEXRXG3",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXG3",3,0)
 ;               
"RTN","LEXRXG3",4,0)
 ; Global Variables
"RTN","LEXRXG3",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXG3",6,0)
 ;    ^LEX(757.33,        SACC 1.3
"RTN","LEXRXG3",7,0)
 ;    ^LEX(757.32,        SACC 1.3
"RTN","LEXRXG3",8,0)
 ;               
"RTN","LEXRXG3",9,0)
 ; External References
"RTN","LEXRXG3",10,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXG3",11,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXG3",12,0)
 ;               
"RTN","LEXRXG3",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXG3",14,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXG3",15,0)
 ;     LEXTEST    Test variable   NEWed/KILLed by Developer
"RTN","LEXRXG3",16,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXG3",17,0)
 ;               
"RTN","LEXRXG3",18,0)
 Q
"RTN","LEXRXG3",19,0)
EN ; Main Entry Point
"RTN","LEXRXG3",20,0)
R75733 ; Repair file 757.33
"RTN","LEXRXG3",21,0)
 D RASRC,RATAR
"RTN","LEXRXG3",22,0)
 Q
"RTN","LEXRXG3",23,0)
RASRC ;   Index    ^LEX(757.33,"ASRC",DEF,SRC,TGT,IEN)
"RTN","LEXRXG3",24,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF
"RTN","LEXRXG3",25,0)
 S LEXFI="757.33"
"RTN","LEXRXG3",26,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""ASRC""") Q:LEXTC=1
"RTN","LEXRXG3",27,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXFI=757.33,LEXIDX="ASRC",LEXIDXT="^LEX(757.33,""ASRC"",DEF,SRC,TGT,IEN)"
"RTN","LEXRXG3",28,0)
 N LEXDEF S LEXDEF="" F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG3",29,0)
 . N LEXSRC S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG3",30,0)
 . . N LEXTGT S LEXTGT="" F  S LEXTGT=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXTGT)) Q:'$L(LEXTGT)  D
"RTN","LEXRXG3",31,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXTGT,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG3",32,0)
 . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXNH,LEXD,LEXN,LEXT,LEXE,LEXS
"RTN","LEXRXG3",33,0)
 . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",34,0)
 . . . . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG3",35,0)
 . . . . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG3",36,0)
 . . . . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG3",37,0)
 . . . . I LEXDEF'=LEXN!($TR(LEXSRC," ","")'=LEXS)!($TR(LEXTGT," ","")'=LEXT) D
"RTN","LEXRXG3",38,0)
 . . . . . N DA S DA=LEXIEN S LEXERR=LEXERR+1
"RTN","LEXRXG3",39,0)
 . . . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXDEF,LEXSRC,LEXTGT,LEXIEN)
"RTN","LEXRXG3",40,0)
 . . . . . S:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXN,(LEXS_" "),(LEXT_" "),LEXIEN)=""
"RTN","LEXRXG3",41,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG3",42,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG3",43,0)
 . N DA,DIK,X,LEXN0,LEXD,LEXN,LEXS,LEXT
"RTN","LEXRXG3",44,0)
 . S DA=LEXIEN,LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",45,0)
 . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",46,0)
 . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG3",47,0)
 . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG3",48,0)
 . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG3",49,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXN,(LEXS_" "),(LEXT_" "),DA)) D
"RTN","LEXRXG3",50,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG3",51,0)
 . S ^LEX(LEXFI,LEXIDX,LEXN,(LEXS_" "),(LEXT_" "),DA)=""
"RTN","LEXRXG3",52,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG3",53,0)
 H 2 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG3",54,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG3",55,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG3",56,0)
 Q
"RTN","LEXRXG3",57,0)
RATAR ;   Index    ^LEX(757.33,"ATAR",DEF,TAR,SRC,IEN)
"RTN","LEXRXG3",58,0)
 N DA,DIK,LEXBEG,LEXDIF,LEXELP,LEXEND,LEXERR,LEXFI,LEXIDX,LEXIDXT,LEXIEN,LEXMC,LEXNDS,LEXOK,LEXDEF
"RTN","LEXRXG3",59,0)
 S LEXFI="757.33"
"RTN","LEXRXG3",60,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,"Repairing File #757.33 ""ATAR""") Q:LEXTC=1
"RTN","LEXRXG3",61,0)
 S LEXBEG=$$NOW^XLFDT,(LEXNDS,LEXERR)=0,LEXFI=757.33,LEXIDX="ATAR",LEXIDXT="^LEX(757.33,""ATAR"",DEF,SRC,TGT,IEN)"
"RTN","LEXRXG3",62,0)
 N LEXDEF S LEXDEF="" F  S LEXDEF=$O(^LEX(LEXFI,LEXIDX,LEXDEF)) Q:'$L(LEXDEF)  D
"RTN","LEXRXG3",63,0)
 . N LEXTGT S LEXTGT="" F  S LEXTGT=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT)) Q:'$L(LEXTGT)  D
"RTN","LEXRXG3",64,0)
 . . N LEXSRC S LEXSRC="" F  S LEXSRC=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC)) Q:'$L(LEXSRC)  D
"RTN","LEXRXG3",65,0)
 . . . N LEXIEN S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG3",66,0)
 . . . . S LEXNDS=LEXNDS+1 N LEXN0,LEXNH,LEXD,LEXN,LEXT,LEXE,LEXS
"RTN","LEXRXG3",67,0)
 . . . . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",68,0)
 . . . . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG3",69,0)
 . . . . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG3",70,0)
 . . . . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG3",71,0)
 . . . . I LEXDEF'=LEXN!($TR(LEXSRC," ","")'=LEXS)!($TR(LEXTGT," ","")'=LEXT) D
"RTN","LEXRXG3",72,0)
 . . . . . N DA S DA=LEXIEN S LEXERR=LEXERR+1
"RTN","LEXRXG3",73,0)
 . . . . . K:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXDEF,LEXTGT,LEXSRC,LEXIEN)
"RTN","LEXRXG3",74,0)
 . . . . . S:'$D(LEXTEST) ^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),LEXIEN)=""
"RTN","LEXRXG3",75,0)
 . . . . . I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Invalid ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG3",76,0)
 S LEXIEN=0 F  S LEXIEN=$O(^LEX(LEXFI,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXG3",77,0)
 . N DA,DIK,X,LEXN0,LEXD,LEXN,LEXS,LEXT
"RTN","LEXRXG3",78,0)
 . S DA=LEXIEN,LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",79,0)
 . S LEXN0=$G(^LEX(757.33,+LEXIEN,0))
"RTN","LEXRXG3",80,0)
 . S LEXD=$P(LEXN0,"^",4),LEXN=$P($G(^LEX(757.32,+LEXD,0)),"^",1)
"RTN","LEXRXG3",81,0)
 . S LEXS=$P(LEXN0,"^",2),LEXT=$P(LEXN0,"^",3)
"RTN","LEXRXG3",82,0)
 . Q:'$L(LEXD)  Q:'$L(LEXN)  Q:'$L(LEXS)  Q:'$L(LEXT)
"RTN","LEXRXG3",83,0)
 . I '$D(^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),DA)) D
"RTN","LEXRXG3",84,0)
 . . S LEXERR=LEXERR+1 I '$D(ZTQUEUED) W !,?8,LEXFI,?19,LEXIDX,?30,"Missing ",LEXN," Rev ",LEXS,?58,"  ",DA
"RTN","LEXRXG3",85,0)
 . S ^LEX(LEXFI,LEXIDX,LEXN,(LEXT_" "),(LEXS_" "),DA)=""
"RTN","LEXRXG3",86,0)
 S LEXERR=$S(+LEXERR>0:LEXERR,1:"") I '$D(ZTQUEUED) W !,$J(LEXERR,5),?8,LEXFI,?19,LEXIDX,?30,LEXIDXT
"RTN","LEXRXG3",87,0)
 H 2 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXG3",88,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXG3",89,0)
 D REP^LEXRXXS(LEXFI,LEXFI,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP)
"RTN","LEXRXG3",90,0)
 Q
"RTN","LEXRXG3",91,0)
 ;              
"RTN","LEXRXG3",92,0)
 ; Miscellaneous
"RTN","LEXRXG3",93,0)
CLR ;   Clear
"RTN","LEXRXG3",94,0)
 K LEXNAM,LEXTEST,ZTQUEUED
"RTN","LEXRXG3",95,0)
 Q
"RTN","LEXRXS")
0^16^B47423657^n/a
"RTN","LEXRXS",1,0)
LEXRXS ;ISL/KER - Re-Index - Small Files ;08/17/2011
"RTN","LEXRXS",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXS",3,0)
 ;               
"RTN","LEXRXS",4,0)
 ; Global Variables
"RTN","LEXRXS",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXS",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXS",7,0)
 ;    ^LEX(757.011,       SACC 1.3
"RTN","LEXRXS",8,0)
 ;    ^LEX(757.014,       SACC 1.3
"RTN","LEXRXS",9,0)
 ;    ^LEX(757.03,        SACC 1.3
"RTN","LEXRXS",10,0)
 ;    ^LEX(757.04,        SACC 1.3
"RTN","LEXRXS",11,0)
 ;    ^LEX(757.05,        SACC 1.3
"RTN","LEXRXS",12,0)
 ;    ^LEX(757.06,        SACC 1.3
"RTN","LEXRXS",13,0)
 ;    ^LEX(757.11,        SACC 1.3
"RTN","LEXRXS",14,0)
 ;    ^LEX(757.12,        SACC 1.3
"RTN","LEXRXS",15,0)
 ;    ^LEX(757.01,        SACC 1.3
"RTN","LEXRXS",16,0)
 ;    ^LEXT(757.2,        SACC 1.3
"RTN","LEXRXS",17,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXS",18,0)
 ;               
"RTN","LEXRXS",19,0)
 ; External References
"RTN","LEXRXS",20,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXS",21,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXS",22,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXS",23,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXS",24,0)
 ;               
"RTN","LEXRXS",25,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXS",26,0)
 ;     LEXLONG    Format flag     NEWed/KILLed by Developer
"RTN","LEXRXS",27,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXS",28,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXS",29,0)
 ;               
"RTN","LEXRXS",30,0)
EN ; Main Entry Point
"RTN","LEXRXS",31,0)
 D R757011,R757014,R75703,R75704,R75705,R75706,R75711,R75712,EN^LEXRXS2
"RTN","LEXRXS",32,0)
 Q
"RTN","LEXRXS",33,0)
R757011 ;   Expression Type file 757.011
"RTN","LEXRXS",34,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXNM
"RTN","LEXRXS",35,0)
 S LEXFI="757.011" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",36,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",37,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",38,0)
 S LEXIX(1)="B and C",LEXNM="Expression Type" I $D(LEXLONG) S LEXIX(1)="^LEX(757.011,""B"",TYPE,IEN)",LEXIX(2)="^LEX(757.011,""C"",UPPER,IEN)"
"RTN","LEXRXS",39,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",40,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",41,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS",42,0)
 Q
"RTN","LEXRXS",43,0)
R757014 ;   Expression Form file 757.014
"RTN","LEXRXS",44,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXNM
"RTN","LEXRXS",45,0)
 S LEXFI="757.014" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",46,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",47,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",48,0)
 S LEXIX(1)="B",LEXNM="Expression Form" I $D(LEXLONG) S LEXIX(1)="^LEX(757.014,""B"",MNEM,IEN)"
"RTN","LEXRXS",49,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",50,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",51,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS",52,0)
 Q
"RTN","LEXRXS",53,0)
R75703 ;   Coding System file 757.03
"RTN","LEXRXS",54,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS",55,0)
 S LEXFI="757.03" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",56,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",57,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",58,0)
 S LEXIX(1)="B, ASAB, C and D",LEXNM="Coding Systems" I $D(LEXLONG) D
"RTN","LEXRXS",59,0)
 . S LEXIX(1)="^LEX(757.03,""B"",SAB,IEN)",LEXIX(2)="^LEX(757.03,""ASAB"",SAB,IEN)"
"RTN","LEXRXS",60,0)
 . S LEXIX(3)="^LEX(757.03,""C"",NOM,IEN)",LEXIX(4)="^LEX(757.03,""D"",HL7,IEN)"
"RTN","LEXRXS",61,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",62,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",63,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS",64,0)
 Q
"RTN","LEXRXS",65,0)
R75704 ;   Excluded Word file 757.04
"RTN","LEXRXS",66,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS",67,0)
 S LEXFI="757.04" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",68,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",69,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",70,0)
 S LEXIX(1)="B, AB, ACTION",LEXNM="Excluded Words" I $D(LEXLONG) D
"RTN","LEXRXS",71,0)
 . S LEXIX(1)="^LEX(757.04,""B"",WORD,IEN)",LEXIX(2)="^LEX(757.04,""AB"",WORD,IEN)",LEXIX(3)="^LEX(757.04,""ACTION"",WORD,EXC,IEN)"
"RTN","LEXRXS",72,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",73,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",74,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:03",.LEXIX)
"RTN","LEXRXS",75,0)
 Q
"RTN","LEXRXS",76,0)
R75705 ;   Replacement Word file 757.05
"RTN","LEXRXS",77,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXIEN,LEXP3,LEXP4
"RTN","LEXRXS",78,0)
 S LEXFI="757.05" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",79,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",80,0)
 S LEXBEG=$$NOW^XLFDT N DA,DIK,LEXEX,LEXEXP,LEXIEN,LEXWRD H 1
"RTN","LEXRXS",81,0)
 D RM(LEXFI) S (LEXP3,LEXP4,LEXIEN)=0 F  S LEXIEN=$O(^LEX(757.05,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXRXS",82,0)
 . N DA,DIK S LEXP3=LEXIEN,LEXP4=LEXP4+1
"RTN","LEXRXS",83,0)
 . K ^LEX(757.05,LEXIEN,1,"B") S DA=LEXIEN,DIK="^LEX(757.05," D IX1^DIK
"RTN","LEXRXS",84,0)
 S $P(^LEX(757.05,0),"^",3)=LEXP3,$P(^LEX(757.05,0),"^",4)=LEXP4
"RTN","LEXRXS",85,0)
 S LEXIX(1)="B, AB, AEXP, ALINK, AWRD, and C",LEXNM="Replacement Words" I $D(LEXLONG) D
"RTN","LEXRXS",86,0)
 . S LEXIX(1)="^LEX(757.05,""B"",WORD,IEN)",LEXIX(2)="^LEX(757.05,""AB"",WORD,IEN)",LEXIX(3)="^LEX(757.05,""C"",REP,IEN)"
"RTN","LEXRXS",87,0)
 . S LEXIX(4)="^LEX(757.05,""AEXP"",EXP,IEN)",LEXIX(5)="^LEX(757.05,""ALINK"",WORD,EXP)",LEXIX(6)="^LEX(757.01,""AWRD"",WORD,EXP,""LINKED"")"
"RTN","LEXRXS",88,0)
 . S LEXIX(7)="^LEX(757.05,IEN,1,""B"",EXP,IEN2)"
"RTN","LEXRXS",89,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",90,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",91,0)
 D REX^LEXRXXS(757.05,LEXNM,LEXELP,.LEXIX)
"RTN","LEXRXS",92,0)
 Q
"RTN","LEXRXS",93,0)
R75706 ;   Unresolved Narrative file 757.06
"RTN","LEXRXS",94,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS",95,0)
 S LEXFI="757.06" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",96,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",97,0)
 S LEXBEG=$$NOW^XLFDT K ^LEX(757.06) S ^LEX(757.06,0)="UNRESOLVED NARRATIVES^757.06^^0"
"RTN","LEXRXS",98,0)
 S LEXIX(1)="B",LEXNM="Unresolved Narratives" I $D(LEXLONG) S LEXIX(1)="^LEX(757.06,""B"",NAR,IEN)"
"RTN","LEXRXS",99,0)
 D REX^LEXRXXS(757.06,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS",100,0)
 Q
"RTN","LEXRXS",101,0)
R75711 ;   Semantic Class file 757.11
"RTN","LEXRXS",102,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS",103,0)
 S LEXFI="757.11" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",104,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",105,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",106,0)
 S LEXIX(1)="B",LEXNM="Semantic Class" I $D(LEXLONG) S LEXIX(1)="^LEX(757.11,""B"",SC,IEN)",LEXIX(2)="^LEX(757.11,IEN,2,""B"",SYS,IEN2)"
"RTN","LEXRXS",107,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",108,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",109,0)
 D REX^LEXRXXS(757.11,LEXNM,"00:00:02",.LEXIX)
"RTN","LEXRXS",110,0)
 Q
"RTN","LEXRXS",111,0)
R75712 ;   Semantic Type file 757.12
"RTN","LEXRXS",112,0)
 N LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS",113,0)
 S LEXFI="757.12" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS",114,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS",115,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS",116,0)
 S LEXIX(1)="B, C, D and E",LEXNM="Semantic Type" I $D(LEXLONG) D
"RTN","LEXRXS",117,0)
 . S LEXIX(1)="^LEX(757.12,""B"",TUI,IEN)",LEXIX(2)="^LEX(757.12,""D"",DT,IEN)",LEXIX(3)="^LEX(757.12,""E"",UDT,IEN)",LEXIX(4)="^LEX(757.12,""C"",SC,IEN)",LEXIX(5)="^LEX(757.12,IEN,1,""B"",SYS,IEN2)"
"RTN","LEXRXS",118,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS",119,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS",120,0)
 D REX^LEXRXXS(757.12,LEXNM,"00:00:02",.LEXIX)
"RTN","LEXRXS",121,0)
 Q
"RTN","LEXRXS",122,0)
 ;              
"RTN","LEXRXS",123,0)
 ; Miscellaneous
"RTN","LEXRXS",124,0)
RM(X) ;   Remove Main
"RTN","LEXRXS",125,0)
 N LEXFI,LEXIX,LEXRT,LEXOUT,LEXMSG
"RTN","LEXRXS",126,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0  Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXS",127,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXS",128,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX("&(LEXRT'["^LEXT(")
"RTN","LEXRXS",129,0)
 S LEXIX=""" """  Q:'$L($O(@(LEXRT_LEXIX_")")))
"RTN","LEXRXS",130,0)
 F  S LEXIX=$O(@(LEXRT_LEXIX_")")) Q:'$L(LEXIX)  D
"RTN","LEXRXS",131,0)
 . S:+LEXIX'=LEXIX LEXIX=""""_LEXIX_""""
"RTN","LEXRXS",132,0)
 . N LEXREF S LEXREF=LEXRT_LEXIX_")" Q:'$D(@LEXREF)  K @LEXREF
"RTN","LEXRXS",133,0)
 Q
"RTN","LEXRXS",134,0)
RX(X) ;   Re-Index File X
"RTN","LEXRXS",135,0)
 N DA,DIK,LEXFI,LEXOUT,LEXMSG,LEXRT,LEXP3,LEXP4 H 2
"RTN","LEXRXS",136,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0  Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXS",137,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXS",138,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX("&(LEXRT'["^LEXT(")
"RTN","LEXRXS",139,0)
 S (LEXP3,LEXP4,DA)=0 F  S DA=$O(@(LEXRT_DA_")")) Q:+DA'>0  D
"RTN","LEXRXS",140,0)
 . S LEXP3=DA,LEXP4=LEXP4+1,DIK=LEXRT D IX1^DIK
"RTN","LEXRXS",141,0)
 S $P(@(LEXRT_"0)"),"^",3)=LEXP3,$P(@(LEXRT_"0)"),"^",4)=LEXP4
"RTN","LEXRXS",142,0)
 Q
"RTN","LEXRXS",143,0)
CLR ;   Clear
"RTN","LEXRXS",144,0)
 K LEXLONG,LEXNAM,ZTQUEUED
"RTN","LEXRXS",145,0)
 Q
"RTN","LEXRXS2")
0^17^B52432847^n/a
"RTN","LEXRXS2",1,0)
LEXRXS2 ;ISL/KER - Re-Index - Small Files ;08/17/2011
"RTN","LEXRXS2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXS2",3,0)
 ;               
"RTN","LEXRXS2",4,0)
 ; Global Variables
"RTN","LEXRXS2",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXS2",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXS2",7,0)
 ;    ^LEX(757.014,       SACC 1.3
"RTN","LEXRXS2",8,0)
 ;    ^LEX(757.13,        SACC 1.3
"RTN","LEXRXS2",9,0)
 ;    ^LEX(757.14,        SACC 1.3
"RTN","LEXRXS2",10,0)
 ;    ^LEX(757.3,         SACC 1.3
"RTN","LEXRXS2",11,0)
 ;    ^LEX(757.31,        SACC 1.3
"RTN","LEXRXS2",12,0)
 ;    ^LEX(757.32,        SACC 1.3
"RTN","LEXRXS2",13,0)
 ;    ^LEX(757.4,         SACC 1.3
"RTN","LEXRXS2",14,0)
 ;    ^LEX(757.41,        SACC 1.3
"RTN","LEXRXS2",15,0)
 ;    ^LEX(757.2,         SACC 1.3
"RTN","LEXRXS2",16,0)
 ;    ^LEX(757.2,         SACC 1.3
"RTN","LEXRXS2",17,0)
 ;               
"RTN","LEXRXS2",18,0)
 ; External References
"RTN","LEXRXS2",19,0)
 ;    FILE^DID            ICR  2052
"RTN","LEXRXS2",20,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEXRXS2",21,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXS2",22,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXS2",23,0)
 ;               
"RTN","LEXRXS2",24,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXS2",25,0)
 ;     LEXLONG    Format flag     NEWed/KILLed by Developer
"RTN","LEXRXS2",26,0)
 ;     LEXNAM     Task name       NEWed/KILLed by LEXRXXT
"RTN","LEXRXS2",27,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXS2",28,0)
 ;               
"RTN","LEXRXS2",29,0)
EN ; Main Entry Point
"RTN","LEXRXS2",30,0)
 D R75713,R75714,R7572,R7573,R75731,R75732,R7574,R75741
"RTN","LEXRXS2",31,0)
 Q
"RTN","LEXRXS2",32,0)
R75713 ;   Source Category file 757.13/757.14
"RTN","LEXRXS2",33,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXNM
"RTN","LEXRXS2",34,0)
 S LEXFI="757.13" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",35,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",36,0)
 S LEXBEG=$$NOW^XLFDT D RM(757.14),RX(757.14),RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",37,0)
 S LEXIX(1)="AAID, ACID, ACP, APC, APID, B, C and D",LEXNM="Source Category" I $D(LEXLONG) D
"RTN","LEXRXS2",38,0)
 . S LEXIX(1)="^LEX(757.13,""AAID"",ID,IEN)",LEXIX(2)="^LEX(757.13,""ACID"",ID,IEN)"
"RTN","LEXRXS2",39,0)
 . S LEXIX(3)="^LEX(757.13,""ACP"",CHD,PAR,IEN)",LEXIX(4)="^LEX(757.13,""APC"",PAR,CHD,IEN)"
"RTN","LEXRXS2",40,0)
 . S LEXIX(5)="^LEX(757.13,""APID"",ID,IEN)",LEXIX(6)="^LEX(757.13,""B"",CAT,IEN)"
"RTN","LEXRXS2",41,0)
 . S LEXIX(7)="^LEX(757.13,""C"",UPPER,IEN)",LEXIX(8)="^LEX(757.13,""D"",WORD,IEN)"
"RTN","LEXRXS2",42,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",43,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",44,0)
 D REX^LEXRXXS(LEXFI,LEXNM,LEXELP,.LEXIX)
"RTN","LEXRXS2",45,0)
 Q
"RTN","LEXRXS2",46,0)
R75714 ;   Source file 757.14
"RTN","LEXRXS2",47,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXNM
"RTN","LEXRXS2",48,0)
 S LEXFI="757.14"  W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",49,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",50,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",51,0)
 S LEXIX(1)="B",LEXNM="Source" I $D(LEXLONG) S LEXIX(1)="^LEX(757.14,""B"",NAME,IEN)"
"RTN","LEXRXS2",52,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",53,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",54,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS2",55,0)
 Q
"RTN","LEXRXS2",56,0)
R7573 ;   Look-up Screens file 757.3
"RTN","LEXRXS2",57,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS2",58,0)
 S LEXFI="757.3"  W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",59,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",60,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",61,0)
 S LEXIX(1)="APPS, AS, B, C and D",LEXNM="Look-up Screens" I $D(LEXLONG) D
"RTN","LEXRXS2",62,0)
 . S LEXIX(1)="^LEX(757.3,""APPS"",AP,IEN)",LEXIX(2)="^LEX(757.3,""AS"",SCR,IEN)"
"RTN","LEXRXS2",63,0)
 . S LEXIX(3)="^LEX(757.3,""B"",DT,IEN)",LEXIX(4)="^LEX(757.3,""C"",DT,IEN)",LEXIX(5)="^LEX(757.3,""D"",DT,IEN)"
"RTN","LEXRXS2",64,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",65,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",66,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS2",67,0)
 Q
"RTN","LEXRXS2",68,0)
R75731 ;   Displays file 757.31
"RTN","LEXRXS2",69,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS2",70,0)
 S LEXFI="757.31" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",71,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",72,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",73,0)
 S LEXIX(1)="ADSP, B and C",LEXNM="Displays" I $D(LEXLONG) D
"RTN","LEXRXS2",74,0)
 . S LEXIX(1)="^LEX(757.31,""ADSP"",DSP,IEN)",LEXIX(2)="^LEX(757.31,""B"",DES,IEN)",LEXIX(3)="^LEX(757.31,""C"",UPPER,IEN)"
"RTN","LEXRXS2",75,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",76,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",77,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS2",78,0)
 Q
"RTN","LEXRXS2",79,0)
R75732 ;   Mapping Definitions file 757.32
"RTN","LEXRXS2",80,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS2",81,0)
 S LEXFI="757.32" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",82,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",83,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",84,0)
 S LEXIX(1)="B",LEXNM="Mapping Definitions" I $D(LEXLONG) S LEXIX(1)="^LEX(757.32,""B"",MMN,IEN)"
"RTN","LEXRXS2",85,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",86,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",87,0)
 D REX^LEXRXXS(LEXFI,LEXNM,"00:00:01",.LEXIX)
"RTN","LEXRXS2",88,0)
 Q
"RTN","LEXRXS2",89,0)
R7574 ;   Shortcuts file 757.4/757.41
"RTN","LEXRXS2",90,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS2",91,0)
 S LEXFI="757.4" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",92,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",93,0)
 S LEXBEG=$$NOW^XLFDT D RM(757.41),RX(757.41),RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",94,0)
 S LEXIX(1)="AB, ARA and B",LEXNM="Shortcuts" I $D(LEXLONG) D
"RTN","LEXRXS2",95,0)
 . S LEXIX(1)="^LEX(757.4,""AB"",SC,SHCT,IEN)",LEXIX(2)="^LEX(757.4,""ARA"",SC,CXT,SHCT,IEN)",LEXIX(3)="^LEX(757.4,""B"",EXP,IEN)"
"RTN","LEXRXS2",96,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",97,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",98,0)
 D REX^LEXRXXS(LEXFI,LEXNM,LEXELP,.LEXIX)
"RTN","LEXRXS2",99,0)
 Q
"RTN","LEXRXS2",100,0)
R75741 ;   Shortcut Context file 757.41
"RTN","LEXRXS2",101,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP
"RTN","LEXRXS2",102,0)
 S LEXFI="757.41" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",103,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",104,0)
 S LEXBEG=$$NOW^XLFDT D RM(LEXFI),RX(LEXFI)
"RTN","LEXRXS2",105,0)
 S LEXIX(1)="B, C and D",LEXNM="Shortcuts" I $D(LEXLONG) D
"RTN","LEXRXS2",106,0)
 . S LEXIX(1)="^LEX(757.41,""B"",CON,IEN)",LEXIX(2)="^LEX(757.41,""C"",WRD,IEN)",LEXIX(3)="^LEX(757.41,""D"",WRD,IEN)"
"RTN","LEXRXS2",107,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",108,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",109,0)
 D REX^LEXRXXS(757.41,LEXNM,LEXELP,.LEXIX)
"RTN","LEXRXS2",110,0)
 Q
"RTN","LEXRXS2",111,0)
R7572 ;   Subset Definition file 757.2
"RTN","LEXRXS2",112,0)
 N LEXFI,LEXBEG,LEXEND,LEXDIF,LEXIX,LEXELP,LEXNM,LEXP3,LEXP4,LEXOUT,LEXMSG,LEXRT
"RTN","LEXRXS2",113,0)
 S LEXFI="757.2" W:'$D(ZTQUEUED) !,?8,"Re-Indexing file #",LEXFI
"RTN","LEXRXS2",114,0)
 N LEXTC S LEXTC=$$UPD^LEXRXXT3($G(LEXNAM),,("Re-Indexing File #"_LEXFI)) Q:LEXTC=1
"RTN","LEXRXS2",115,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXS2",116,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX("&(LEXRT'["^LEXT(")
"RTN","LEXRXS2",117,0)
 S LEXBEG=$$NOW^XLFDT D RM(757.2) N DA,DIK S (LEXP3,LEXP4,DA)=0,DIK="^LEXT(757.2,"
"RTN","LEXRXS2",118,0)
 F  S DA=$O(^LEXT(757.2,DA)) Q:+DA'>0  D
"RTN","LEXRXS2",119,0)
 . S LEXP3=DA,LEXP4=LEXP4+1,DIK=LEXRT
"RTN","LEXRXS2",120,0)
 . K ^LEXT(757.2,DA,200,"B") D IX1^DIK
"RTN","LEXRXS2",121,0)
 S $P(^LEXT(757.2,0),"^",3)=LEXP3,$P(^LEXT(757.2,0),"^",4)=LEXP4
"RTN","LEXRXS2",122,0)
 S LEXIX(1)="B, AA, AB, ADEF, AN, APPS, AUD, C and D",LEXNM="Subset Definitions" I $D(LEXLONG) D
"RTN","LEXRXS2",123,0)
 . S LEXIX(1)="^LEXT(757.2,""B"",NAME,IEN)",LEXIX(2)="^LEXT(757.2,""C"",NAME,IEN)",LEXIX(3)="^LEXT(757.2,""D"",WORD,IEN)"
"RTN","LEXRXS2",124,0)
 . S LEXIX(4)="^LEXT(757.2,""AA"",ST,IEN)",LEXIX(5)="^LEXT(757.2,""AB"",AN,IEN)",LEXIX(6)="^LEXT(757.2,""ADEF"",FI,IEN)"
"RTN","LEXRXS2",125,0)
 . S LEXIX(7)="^LEXT(757.2,""APPS"",FI,IEN)",LEXIX(8)="^LEXT(757.2,""AN"",AN,IEN)",LEXIX(9)="^LEXT(757.2,""AUD"",NAME,USER,SD,IEN)"
"RTN","LEXRXS2",126,0)
 . S LEXIX(10)="^LEX(757.1,IEN,200,""B"",USER,IEN2)"
"RTN","LEXRXS2",127,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEXRXS2",128,0)
 S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXS2",129,0)
 D REX^LEXRXXS(757.2,LEXNM,LEXELP,.LEXIX)
"RTN","LEXRXS2",130,0)
 Q
"RTN","LEXRXS2",131,0)
 ;              
"RTN","LEXRXS2",132,0)
 ; Miscellaneous
"RTN","LEXRXS2",133,0)
RM(X) ;   Remove Main
"RTN","LEXRXS2",134,0)
 N LEXFI,LEXIX,LEXRT,LEXDIC S LEXFI=+($G(X)) Q:$E(LEXFI,1,3)'="757"  Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXS2",135,0)
 S LEXRT=$S($D(^LEX(LEXFI)):"^LEX(",1:"^LEXT("),LEXIX=""" """,LEXDIC=LEXRT_LEXFI_"," Q:'$L($O(@(LEXDIC_LEXIX_")")))
"RTN","LEXRXS2",136,0)
 F  S LEXIX=$O(@(LEXDIC_LEXIX_")")) Q:'$L(LEXIX)  D
"RTN","LEXRXS2",137,0)
 . S:+LEXIX'=LEXIX LEXIX=""""_LEXIX_""""
"RTN","LEXRXS2",138,0)
 . N LEXREF S LEXREF=LEXDIC_LEXIX_")" Q:'$D(@LEXREF)  K @LEXREF
"RTN","LEXRXS2",139,0)
 Q
"RTN","LEXRXS2",140,0)
RX(X) ;   Re-Index File X
"RTN","LEXRXS2",141,0)
 N DA,DIK,LEXFI,LEXOUT,LEXMSG,LEXRT,LEXP3,LEXP4
"RTN","LEXRXS2",142,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0  Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXS2",143,0)
 D FILE^DID(LEXFI,"N","GLOBAL NAME","LEXOUT","LEXMSG")
"RTN","LEXRXS2",144,0)
 S LEXRT=$G(LEXOUT("GLOBAL NAME")) Q:LEXRT'["^LEX("&(LEXRT'["^LEXT(")
"RTN","LEXRXS2",145,0)
 S (LEXP3,LEXP4,DA)=0 F  S DA=$O(@(LEXRT_DA_")")) Q:+DA'>0  D
"RTN","LEXRXS2",146,0)
 . S LEXP3=DA,LEXP4=LEXP4+1,DIK=LEXRT D IX1^DIK
"RTN","LEXRXS2",147,0)
 S $P(@(LEXRT_"0)"),"^",3)=LEXP3,$P(@(LEXRT_"0)"),"^",4)=LEXP4
"RTN","LEXRXS2",148,0)
 Q
"RTN","LEXRXS2",149,0)
CLR ;   Clear
"RTN","LEXRXS2",150,0)
 K LEXLONG,LEXNAM,ZTQUEUED
"RTN","LEXRXS2",151,0)
 Q
"RTN","LEXRXXA")
0^18^B26020561^n/a
"RTN","LEXRXXA",1,0)
LEXRXXA ;ISL/KER - Re-Index Ask ;08/17/2011
"RTN","LEXRXXA",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXA",3,0)
 ;               
"RTN","LEXRXXA",4,0)
 ; Global Variables
"RTN","LEXRXXA",5,0)
 ;    ^LEX(               SACC 1.3 
"RTN","LEXRXXA",6,0)
 ;    ^LEXT(              SACC 1.3 
"RTN","LEXRXXA",7,0)
 ;               
"RTN","LEXRXXA",8,0)
 ; External References
"RTN","LEXRXXA",9,0)
 ;    ^DIC                ICR  10006
"RTN","LEXRXXA",10,0)
 ;    ^DIR                ICR  10026
"RTN","LEXRXXA",11,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXXA",12,0)
 ;               
"RTN","LEXRXXA",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXA",14,0)
 ;     LEXFI      File Number     NEWed/KILLed by ONE^LEXRX
"RTN","LEXRXXA",15,0)
 ;               
"RTN","LEXRXXA",16,0)
 Q
"RTN","LEXRXXA",17,0)
AMSO(X) ; All, Major, Supporting or One File
"RTN","LEXRXXA",18,0)
 N LEX,DIR,DTOUT,DUOUT,DIRUT,DIROUT,LEXB,LEXN,Y K LEX
"RTN","LEXRXXA",19,0)
 D AMSOF S LEX="" S LEXB=$$BOLD^LEXRXXM,LEXN=$$NORM^LEXRXXM
"RTN","LEXRXXA",20,0)
 S DIR(0)="SAO^A:All Lexicon Files;M:Major Lexicon Files"
"RTN","LEXRXXA",21,0)
 S DIR(0)=DIR(0)_";S:Supporting Lexicon Files;O:One Lexicon File"
"RTN","LEXRXXA",22,0)
 S (DIR("?"),DIR("??"))="^D AMSOH^LEXRXXA"
"RTN","LEXRXXA",23,0)
 S DIR("PRE")="S X=$$AMSOP^LEXRXXA($G(X))"
"RTN","LEXRXXA",24,0)
 S DIR("A")=" Select "_LEXB_"A"_LEXN_"ll, "_LEXB_"M"_LEXN_"ajor, "
"RTN","LEXRXXA",25,0)
 S DIR("A")=DIR("A")_LEXB_"S"_LEXN_"upporting or "_LEXB_"O"_LEXN
"RTN","LEXRXXA",26,0)
 S DIR("A")=DIR("A")_"ne Lexicon file(s):  (A/M/S/O)  "
"RTN","LEXRXXA",27,0)
 W ! D ^DIR S X=Y
"RTN","LEXRXXA",28,0)
 Q X
"RTN","LEXRXXA",29,0)
AMSOP(X) ;   All, Major, Supporting or One File - Pre-process
"RTN","LEXRXXA",30,0)
 N Y Q:'$L($G(X)) ""  Q:$G(X)["^" "^"  S X=$G(X)
"RTN","LEXRXXA",31,0)
 S Y=$$UP^XLFSTR($E(X,1)) S:"^A^M^S^O^?^"'[("^"_Y_"^") X="??"
"RTN","LEXRXXA",32,0)
 Q X
"RTN","LEXRXXA",33,0)
AMSOH ;   All, Major, Supporting or One File - Help
"RTN","LEXRXXA",34,0)
 W:$L($G(IOF))&($D(LEX)) @IOF D:$D(LEX) AMSOH2
"RTN","LEXRXXA",35,0)
AMSOF ;   All, Major, Supporting or One File - List Files
"RTN","LEXRXXA",36,0)
 W:$L($G(IOF))&('$D(LEX)) @IOF
"RTN","LEXRXXA",37,0)
 N LEXB,LEXN,LEXC,LEXT,LEXF,LEX1,LEX2,LEX3
"RTN","LEXRXXA",38,0)
 S LEXB=$$BOLD^LEXRXXM,LEXN=$$NORM^LEXRXXM
"RTN","LEXRXXA",39,0)
 S:'$D(LEX) (LEXB,LEXN)=""
"RTN","LEXRXXA",40,0)
 S LEX1=3,LEX2=6,LEX3=24 S:$D(LEX) LEX2=LEX2-1,LEX3=LEX3-1
"RTN","LEXRXXA",41,0)
 W !," Repair/Re-Index Lexicon Cross-References",!
"RTN","LEXRXXA",42,0)
 S LEXC="",LEXT="",LEXF=""
"RTN","LEXRXXA",43,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",44,0)
 S LEXC=LEXB_"A"_LEXN
"RTN","LEXRXXA",45,0)
 S LEXT="All files"
"RTN","LEXRXXA",46,0)
 S LEXF="757*"
"RTN","LEXRXXA",47,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",48,0)
 S LEXC="",LEXT="",LEXF=""
"RTN","LEXRXXA",49,0)
 S LEXC=LEXB_"M"_LEXN
"RTN","LEXRXXA",50,0)
 S LEXT="Major files"
"RTN","LEXRXXA",51,0)
 S LEXF="757, 757.001, 757.01, 757.02, 757.1, 757.21 and 757.33"
"RTN","LEXRXXA",52,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",53,0)
 S LEXC="",LEXT="",LEXF=""
"RTN","LEXRXXA",54,0)
 S LEXC=LEXB_"S"_LEXN
"RTN","LEXRXXA",55,0)
 S LEXT="Supporting files"
"RTN","LEXRXXA",56,0)
 S LEXF="757.011, 757.014, 757.03, 757.04, 757.05, 757.06,"
"RTN","LEXRXXA",57,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",58,0)
 S LEXC=LEXB_" "_LEXN
"RTN","LEXRXXA",59,0)
 S LEXT=""
"RTN","LEXRXXA",60,0)
 S LEXF="757.11, 757.12, 757.13, 757.14, 757.2, 757.3,"
"RTN","LEXRXXA",61,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",62,0)
 S LEXC=LEXB_" "_LEXN
"RTN","LEXRXXA",63,0)
 S LEXT=""
"RTN","LEXRXXA",64,0)
 S LEXF="757.31, 757.4 and 757.41"
"RTN","LEXRXXA",65,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",66,0)
 S LEXC="",LEXT="",LEXF=""
"RTN","LEXRXXA",67,0)
 S LEXC=LEXB_"O"_LEXN
"RTN","LEXRXXA",68,0)
 S LEXT="One file"
"RTN","LEXRXXA",69,0)
 S LEXF="Select a single Lexicon file"
"RTN","LEXRXXA",70,0)
 W !,?LEX1,LEXC,?LEX2,LEXT,?LEX3,LEXF
"RTN","LEXRXXA",71,0)
 Q
"RTN","LEXRXXA",72,0)
AMSOH2 ;   All, Major, Supporting or One File - Help
"RTN","LEXRXXA",73,0)
 N LEXB,LEXN S LEXB=$$BOLD^LEXRXXM,LEXN=$$NORM^LEXRXXM
"RTN","LEXRXXA",74,0)
 W !," The cross-references of the Major (larger) files"
"RTN","LEXRXXA",75,0)
 W " involved with the"
"RTN","LEXRXXA",76,0)
 W !," Lexicon Lookup will be repaired.  During the repair"
"RTN","LEXRXXA",77,0)
 W " process the "
"RTN","LEXRXXA",78,0)
 W !," cross-references are not deleted.  Only those cross-"
"RTN","LEXRXXA",79,0)
 W "reference nodes "
"RTN","LEXRXXA",80,0)
 W !," that fail verification will be deleted.  The Supporting"
"RTN","LEXRXXA",81,0)
 W " (smaller) files",!," will be re-indexed.",!,?1,"  "
"RTN","LEXRXXA",82,0)
 W !,?1,LEXB,"Users may remain on the system.",LEXN
"RTN","LEXRXXA",83,0)
 W !,?1,"  "
"RTN","LEXRXXA",84,0)
 Q
"RTN","LEXRXXA",85,0)
 ;                 
"RTN","LEXRXXA",86,0)
CO(X) ; Ask to Continue
"RTN","LEXRXXA",87,0)
 S LEXTY=$G(LEXTY) N DIR,DTOUT,DUOUT,DIRUT,DIROUT,Y
"RTN","LEXRXXA",88,0)
 S DIR(0)="YAO",(DIR("?"),DIR("??"))="^D COH^LEXRXXA"
"RTN","LEXRXXA",89,0)
 S DIR("A")=" Do you wish to continue?  (Y/N)  "
"RTN","LEXRXXA",90,0)
 S DIR("PRE")="S:X[""?"" X=""??""" W ! D ^DIR
"RTN","LEXRXXA",91,0)
 S X=+Y S:$D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) X="^"
"RTN","LEXRXXA",92,0)
 N LEXTY
"RTN","LEXRXXA",93,0)
 Q X
"RTN","LEXRXXA",94,0)
COH ;   Continue Help
"RTN","LEXRXXA",95,0)
 N LEXFN,LEXAC S LEXAC="repair/re-index"
"RTN","LEXRXXA",96,0)
 S:+($G(LEXTY))=1 LEXAC="repair" S:+($G(LEXTY))=2 LEXAC="re-index"
"RTN","LEXRXXA",97,0)
 I +($G(LEXTY))'>0 D
"RTN","LEXRXXA",98,0)
 . W !,"   Answer 'Yes' to ",LEXAC," the Lexicon's cross-references"
"RTN","LEXRXXA",99,0)
 I +($G(LEXTY))=1&(+($G(LEXFI))'>0) D
"RTN","LEXRXXA",100,0)
 . W !,"   Answer 'Yes' to ",LEXAC," the Lexicon's cross-references"
"RTN","LEXRXXA",101,0)
 . W " of the",!,"   larger files"
"RTN","LEXRXXA",102,0)
 I +($G(LEXTY))=2&(+($G(LEXFI))'>0) D
"RTN","LEXRXXA",103,0)
 . W !,"   Answer 'Yes' to ",LEXAC," the Lexicon's cross-references"
"RTN","LEXRXXA",104,0)
 . W " of the",!,"   smaller files"
"RTN","LEXRXXA",105,0)
 I +($G(LEXTY))=3&(+($G(LEXFI))'>0) D
"RTN","LEXRXXA",106,0)
 . W !,"   Answer 'Yes' to ",LEXAC," the cross-references of all"
"RTN","LEXRXXA",107,0)
 . W !,"   of the Lexicon's files"
"RTN","LEXRXXA",108,0)
 I +($G(LEXTY))>0&(+($G(LEXFI))>0) D
"RTN","LEXRXXA",109,0)
 . I $D(^LEX(+($G(LEXFI))))!($D(^LEXT(+($G(LEXFI))))) D  Q
"RTN","LEXRXXA",110,0)
 . . N LEXFN S LEXFN=$$FN^LEXRXXM(+($G(LEXFI)))
"RTN","LEXRXXA",111,0)
 . . I $L($G(LEXFN))&(+($G(LEXFI))>0) D
"RTN","LEXRXXA",112,0)
 . . . W !,"   Answer 'Yes' to ",LEXAC," the cross-references of "
"RTN","LEXRXXA",113,0)
 . . . W "the ",LEXFN,!,"   file #",$G(LEXFI)
"RTN","LEXRXXA",114,0)
 . . I '$L($G(LEXFN))&(+($G(LEXFI))>0) D
"RTN","LEXRXXA",115,0)
 . . . W !,"   Answer 'Yes' to ",LEXAC," the cross-references of "
"RTN","LEXRXXA",116,0)
 . . . W "file #",$G(LEXFI)
"RTN","LEXRXXA",117,0)
 . W !,"   Answer 'Yes' to ",LEXAC," the cross-references of "
"RTN","LEXRXXA",118,0)
 . W "the file(s)"
"RTN","LEXRXXA",119,0)
 Q
"RTN","LEXRXXA",120,0)
 ;              
"RTN","LEXRXXA",121,0)
FI(X) ; Select File
"RTN","LEXRXXA",122,0)
 N DIC,DTOUT,DUOUT,Y,LEX S DIC="^DIC(",DIC(0)="AEMQ"
"RTN","LEXRXXA",123,0)
 S DIC("A")=" Select Lexicon File:  "
"RTN","LEXRXXA",124,0)
 S DIC("S")="I +($$FV^LEXRXXM(+Y))>0"
"RTN","LEXRXXA",125,0)
 W ! D ^DIC K DIC("S") S LEX=+($$FV^LEXRXXM(+Y))
"RTN","LEXRXXA",126,0)
 Q:$D(DTOUT)!($D(DUOUT)) "^"  S X=+Y Q:LEX>0 X
"RTN","LEXRXXA",127,0)
 Q "^"
"RTN","LEXRXXA",128,0)
 ;              
"RTN","LEXRXXA",129,0)
 ; Miscellaneous
"RTN","LEXRXXA",130,0)
CLR ;   Clear
"RTN","LEXRXXA",131,0)
 K LEXFI
"RTN","LEXRXXA",132,0)
 Q
"RTN","LEXRXXM")
0^19^B57887286^n/a
"RTN","LEXRXXM",1,0)
LEXRXXM ;ISL/KER - Re-Index Miscellaneous ;08/17/2011
"RTN","LEXRXXM",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXM",3,0)
 ;               
"RTN","LEXRXXM",4,0)
 ; Global Variables
"RTN","LEXRXXM",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXXM",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXXM",7,0)
 ;    ^LEX(757,           SACC 1.3 
"RTN","LEXRXXM",8,0)
 ;    ^LEX(757.001,       SACC 1.3 
"RTN","LEXRXXM",9,0)
 ;    ^LEX(757.01,        SACC 1.3 
"RTN","LEXRXXM",10,0)
 ;    ^LEX(757.011,       SACC 1.3 
"RTN","LEXRXXM",11,0)
 ;    ^LEX(757.02,        SACC 1.3 
"RTN","LEXRXXM",12,0)
 ;    ^LEX(757.03,        SACC 1.3 
"RTN","LEXRXXM",13,0)
 ;    ^LEX(757.1,         SACC 1.3 
"RTN","LEXRXXM",14,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXXM",15,0)
 ;               
"RTN","LEXRXXM",16,0)
 ; External References
"RTN","LEXRXXM",17,0)
 ;    %XY^%RCR            ICR  10022
"RTN","LEXRXXM",18,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXRXXM",19,0)
 ;    ENDR^%ZISS          ICR  10088
"RTN","LEXRXXM",20,0)
 ;    KILL^%ZISS          ICR  10088
"RTN","LEXRXXM",21,0)
 ;    ^DIC                ICR  10006
"RTN","LEXRXXM",22,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXRXXM",23,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXRXXM",24,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXXM",25,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXRXXM",26,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXXM",27,0)
 ;    $$TITLE^XLFSTR      ICR  10104
"RTN","LEXRXXM",28,0)
 ;               
"RTN","LEXRXXM",29,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXM",30,0)
 ;     LEXQ       Quiet flag      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXXM",31,0)
 ;               
"RTN","LEXRXXM",32,0)
 Q
"RTN","LEXRXXM",33,0)
 ; Miscellaneous
"RTN","LEXRXXM",34,0)
FREQ(X) ;   Get frequency based on codes and semantics
"RTN","LEXRXXM",35,0)
 N LEXMC,LEXMCE,LEXND,LEXOF,LEXNF,LEXSA,LEXSAB,LEXACT,LEXSMC,LEXNUR
"RTN","LEXRXXM",36,0)
 N LEXBEH,LEXI10,LEXPRO,LEXDIA S LEXMC=+($G(X)),X=0
"RTN","LEXRXXM",37,0)
 Q:'$D(^LEX(757,LEXMC,0)) X  S LEXMCE=$P($G(^LEX(757,+LEXMC,0)),"^",1)
"RTN","LEXRXXM",38,0)
 S LEXOF=$P($G(^LEX(757.001,LEXMC,0)),"^",2)
"RTN","LEXRXXM",39,0)
 S (LEXSA,LEXNUR,LEXBEH,LEXPRO,LEXDIA,LEXI10,LEXSMC)=0
"RTN","LEXRXXM",40,0)
 D SO,SM S X=0 S LEXNF="",X=0
"RTN","LEXRXXM",41,0)
 S:+LEXI10=1&(+LEXDIA=1) (LEXNF,X)=6
"RTN","LEXRXXM",42,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",43,0)
 S:+LEXI10=1&(+LEXDIA'=1) (LEXNF,X)=5
"RTN","LEXRXXM",44,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",45,0)
 S:LEXI10=0&(+LEXDIA=1)&(X=0) (LEXNF,X)=4
"RTN","LEXRXXM",46,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",47,0)
 S:'$L(LEXNF)&(+($G(LEXBEH))=1)&($G(LEXSMC)>0) (LEXNF,X)=3
"RTN","LEXRXXM",48,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",49,0)
 S:'$L(LEXNF)&(+($G(LEXPRO))=1) (LEXNF,X)=2
"RTN","LEXRXXM",50,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",51,0)
 S:'$L(LEXNF)&(+($G(LEXNUR))=1) (LEXNF,X)=1
"RTN","LEXRXXM",52,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",53,0)
 S:'$L(LEXNF)&(+($G(LEXSMC))>1) (LEXNF,X)=3
"RTN","LEXRXXM",54,0)
 Q:$L(LEXNF)&(LEXNF'=LEXOF)&(X>0) X
"RTN","LEXRXXM",55,0)
 S:'$L(LEXNF) (LEXNF,X)=0
"RTN","LEXRXXM",56,0)
 Q X
"RTN","LEXRXXM",57,0)
SO ;     Codes
"RTN","LEXRXXM",58,0)
 N LEXSA S LEXSA=0
"RTN","LEXRXXM",59,0)
 F  S LEXSA=$O(^LEX(757.02,"AMC",LEXMC,LEXSA)) Q:+LEXSA=0  D SOC
"RTN","LEXRXXM",60,0)
 Q
"RTN","LEXRXXM",61,0)
SOC ;     Code Type
"RTN","LEXRXXM",62,0)
 N LEXCOD,LEXEFF,LEXHIS,LEXND,LEXSAB
"RTN","LEXRXXM",63,0)
 S LEXEFF=$O(^LEX(757.02,LEXSA,4,"B"," "),-1) Q:LEXEFF'?7N
"RTN","LEXRXXM",64,0)
 S LEXHIS=$O(^LEX(757.02,LEXSA,4,"B",LEXEFF," "),-1) Q:+LEXHIS'>0
"RTN","LEXRXXM",65,0)
 S LEXND=$G(^LEX(757.02,LEXSA,4,+LEXHIS,0)) Q:+($P(LEXND,"^",2))'>0
"RTN","LEXRXXM",66,0)
 S LEXND=$G(^LEX(757.02,LEXSA,0)),LEXSAB=+($P(LEXND,U,3))
"RTN","LEXRXXM",67,0)
 S LEXCOD=$P(LEXND,U,2) Q:LEXSAB=0
"RTN","LEXRXXM",68,0)
 S:LEXSAB=30!(LEXSAB=31) LEXI10=1_"^"_LEXCOD
"RTN","LEXRXXM",69,0)
 S:LEXSAB=1!(LEXSAB=30) LEXDIA=1_"^"_LEXCOD
"RTN","LEXRXXM",70,0)
 S:LEXSAB=2!(LEXSAB=31)!(LEXSAB=3)!(LEXSAB=4) LEXPRO=1_"^"_LEXCOD
"RTN","LEXRXXM",71,0)
 S:LEXSAB=5!(LEXSAB=6) LEXBEH=1_"^"_LEXCOD
"RTN","LEXRXXM",72,0)
 S:LEXSAB>10&(LEXSAB<16) LEXNUR=1_"^"_LEXCOD
"RTN","LEXRXXM",73,0)
 Q
"RTN","LEXRXXM",74,0)
SM ;     Semantics - BEH Behavior and DIS Disorders
"RTN","LEXRXXM",75,0)
 N LEXBD,LEXCLA,LEXSM S LEXSMC=0,LEXMC=+($G(LEXMC))
"RTN","LEXRXXM",76,0)
 Q:'$D(^LEX(757,LEXMC,0))  S (LEXBD,LEXSM)=0
"RTN","LEXRXXM",77,0)
 F  S LEXSM=$O(^LEX(757.1,"B",LEXMC,LEXSM)) Q:+LEXSM=0  D SMC
"RTN","LEXRXXM",78,0)
 S LEXSMC=LEXBD
"RTN","LEXRXXM",79,0)
 Q
"RTN","LEXRXXM",80,0)
SMC ;     Semantic Class
"RTN","LEXRXXM",81,0)
 S LEXCLA=+($P($G(^LEX(757.1,LEXSM,0)),U,2))
"RTN","LEXRXXM",82,0)
 S:LEXCLA=3&(LEXBD'>0) LEXBD=1
"RTN","LEXRXXM",83,0)
 S:LEXCLA=6 LEXBD=2
"RTN","LEXRXXM",84,0)
 Q
"RTN","LEXRXXM",85,0)
SABS(X) ;   AVA Source Abbreviations
"RTN","LEXRXXM",86,0)
 N LEXOUT,LEXSABS,%Y,%X K LEXOUT,LEXSABS
"RTN","LEXRXXM",87,0)
 S %Y="LEXOUT(" S %X="^DD(757.02,2,1,2," D %XY^%RCR
"RTN","LEXRXXM",88,0)
 S LEXSABS=LEXOUT(1),LEXSABS=$P(LEXSABS," S:""",2)
"RTN","LEXRXXM",89,0)
 S LEXSABS=$P(LEXSABS,"""[SAB ^LEX",1),X=LEXSABS
"RTN","LEXRXXM",90,0)
 S:'$L(X) X="^ICD^10D^ICP^10P^CPT^CPC^BIR^DS4^NAN^HHC^NIC^SNM^OMA^SCC^SCT^"
"RTN","LEXRXXM",91,0)
 Q X
"RTN","LEXRXXM",92,0)
XREF(X) ;   Set Expression Indexes
"RTN","LEXRXXM",93,0)
 N LEXEX,LEXT S LEXEX=+($G(X)) Q:+LEXEX'>0 0  Q:'$D(^LEX(757.01,LEXEX,0)) 0
"RTN","LEXRXXM",94,0)
 S LEXT=+($P($G(^LEX(757.01,LEXEX,1)),U,2)) Q:LEXT'>0 0
"RTN","LEXRXXM",95,0)
 S LEXT=+($P($G(^LEX(757.011,LEXT,0)),"^",2)) Q:+LEXT=0 0  S X=LEXT
"RTN","LEXRXXM",96,0)
 Q X
"RTN","LEXRXXM",97,0)
MCE(X) ;   Major Concept Expression
"RTN","LEXRXXM",98,0)
 S X=+($G(^LEX(757,+($G(^LEX(757.01,+($G(X)),1))),0)))
"RTN","LEXRXXM",99,0)
 Q X
"RTN","LEXRXXM",100,0)
TIME(X) ;   Time
"RTN","LEXRXXM",101,0)
 N LEXDIF,LEXD,LEXH,LEXM,LEXS,LEXT S LEXDIF=$G(X) S LEXD=LEXDIF\86400 S:+LEXD'>0 LEXD="" S LEXDIF=LEXDIF-(86400*LEXD)
"RTN","LEXRXXM",102,0)
 S LEXH=LEXDIF\3600 S:+LEXH'>0 LEXH="00" S LEXDIF=LEXDIF-(3600*LEXH) S:$L(LEXH)=1 LEXH="0"_LEXH
"RTN","LEXRXXM",103,0)
 S LEXM=LEXDIF\60 S:+LEXM'>0 LEXM="00" S LEXDIF=LEXDIF-(60*LEXM) S:$L(LEXM)=1 LEXM="0"_LEXM
"RTN","LEXRXXM",104,0)
 S LEXS=LEXDIF S:+LEXS'>0 LEXS="00" S:$L(LEXS)=1 LEXS="0"_LEXS
"RTN","LEXRXXM",105,0)
 S LEXT=LEXH_":"_LEXM_":"_LEXS S X=LEXT
"RTN","LEXRXXM",106,0)
 Q X
"RTN","LEXRXXM",107,0)
AND(X) ;   Substitute 'and'
"RTN","LEXRXXM",108,0)
 S X=$G(X) Q:$L(X,", ")'>1 X
"RTN","LEXRXXM",109,0)
 S X=$P(X,", ",1,($L(X,", ")-1))_" and "_$P(X,", ",$L(X,", "))
"RTN","LEXRXXM",110,0)
 Q X
"RTN","LEXRXXM",111,0)
CS(X) ;   Trim Comma/Space
"RTN","LEXRXXM",112,0)
 S X=$$TM($G(X),","),X=$$TM($G(X)," "),X=$$TM($G(X),","),X=$$TM($G(X)," ")
"RTN","LEXRXXM",113,0)
 Q X
"RTN","LEXRXXM",114,0)
TM(X,Y) ;   Trim Character Y - Default " "
"RTN","LEXRXXM",115,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LEXRXXM",116,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXRXXM",117,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXRXXM",118,0)
 Q X
"RTN","LEXRXXM",119,0)
ML(X) ;   Maximum Length of Counter
"RTN","LEXRXXM",120,0)
 N LEX,LEXM,LEXL S (LEX,LEXM)=0 F  S LEX=$O(^LEX(LEX)) Q:+LEX'>0  D
"RTN","LEXRXXM",121,0)
 . S LEXL=$O(^LEX(LEX," "),-1) S:$L(LEXL)>LEXM LEXM=$L(LEXL)
"RTN","LEXRXXM",122,0)
 S X=LEXM
"RTN","LEXRXXM",123,0)
 Q X
"RTN","LEXRXXM",124,0)
ADDT(X,Y) ;   Add Time X to Time Y
"RTN","LEXRXXM",125,0)
 N LEXT,LEXT1,LEXT2,LEXH,LEXM,LEXS S LEXT1=$G(X),LEXT2=$G(Y),LEXH=+($P(LEXT1,":",1)),LEXM=+($P(LEXT1,":",2)),LEXS=+($P(LEXT1,":",3))
"RTN","LEXRXXM",126,0)
 S LEXH=LEXH+($P(LEXT2,":",1)),LEXM=LEXM+($P(LEXT2,":",2)),LEXS=LEXS+($P(LEXT2,":",3)) S LEXT=LEXS\60 S:LEXT>0 LEXM=LEXM+LEXT,LEXS=LEXS-(LEXT*60)
"RTN","LEXRXXM",127,0)
 S LEXT=LEXM\60 S:LEXT>0 LEXH=LEXH+LEXT,LEXM=LEXM-(LEXT*60) S:+LEXS'>0 LEXS="00" S:$L(LEXS)=1 LEXS="0"_LEXS S:+LEXM'>0 LEXM="00" S:$L(LEXM)=1 LEXM="0"_LEXM
"RTN","LEXRXXM",128,0)
 S:+LEXH'>0 LEXH="00" S:$L(LEXH)=1 LEXH="0"_LEXH S X=LEXH_":"_LEXM_":"_LEXS
"RTN","LEXRXXM",129,0)
 Q X
"RTN","LEXRXXM",130,0)
ADD(X,Y) ;   Increment Time X by Y
"RTN","LEXRXXM",131,0)
 N LEX,LEXA,LEXE,LEXH,LEXM,LEXS S LEX=$G(X),LEXA=+($G(Y)),LEXE="" S:+LEXA'>0 LEXA=1 I $L(LEX),$L(LEX,":")=3 D
"RTN","LEXRXXM",132,0)
 . S LEXH=+($P(LEX,":",1)),LEXM=+($P(LEX,":",2)),LEXS=+($P(LEX,":",3))+LEXA S:LEXS>60 LEXM=LEXM+1,LEXS=LEXS-60 S:LEXM>60 LEXH=LEXH+1,LEXM=LEXM-60
"RTN","LEXRXXM",133,0)
 . S:$L(LEXH)=1 LEXH="0"_LEXH S:$L(LEXH)=1 LEXH="0"_LEXH S:$L(LEXM)=1 LEXM="0"_LEXM S:$L(LEXM)=1 LEXM="0"_LEXM S:$L(LEXS)=1 LEXS="0"_LEXS S:$L(LEXS)=1 LEXS="0"_LEXS
"RTN","LEXRXXM",134,0)
 . S LEXE=LEXH_":"_LEXM_":"_LEXS
"RTN","LEXRXXM",135,0)
 S:$L(LEXE) LEX=LEXE Q:'$L(LEX)!($L(LEX,":")'=3) "00:00:00"
"RTN","LEXRXXM",136,0)
 S X=LEX
"RTN","LEXRXXM",137,0)
 Q X
"RTN","LEXRXXM",138,0)
TOT(X) ;   Total Time
"RTN","LEXRXXM",139,0)
 N LEXE1,LEXE2,LEXE,LEXP S LEXE1=$G(^TMP("LEXRX",$J,"T",2,"ELAP")),LEXE2=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXXM",140,0)
 I $L(LEXE1),$L(LEXE1,":")=3,LEXE1'="00:00:00" S LEXE1=$$ADD(LEXE1,1)
"RTN","LEXRXXM",141,0)
 I $L(LEXE2),$L(LEXE2,":")=3,LEXE2'="00:00:00" S LEXE2=$$ADD(LEXE2,1)
"RTN","LEXRXXM",142,0)
 S:'$L(LEXE1)&('$L(LEXE2)) LEXE="00:00:00"
"RTN","LEXRXXM",143,0)
 S:$L(LEXE1)&('$L(LEXE2)) LEXE=LEXE1 S:'$L(LEXE1)&($L(LEXE2)) LEXE=LEXE2
"RTN","LEXRXXM",144,0)
 S:$L(LEXE1)&($L(LEXE2)) LEXE=$$ADD($$ADDT^LEXRXXM(LEXE1,LEXE2),2)
"RTN","LEXRXXM",145,0)
 S X=LEXE
"RTN","LEXRXXM",146,0)
 Q X
"RTN","LEXRXXM",147,0)
ADR(LEX) ;   Mailing Address
"RTN","LEXRXXM",148,0)
 N DIC,DTOUT,DUOUT,X,Y
"RTN","LEXRXXM",149,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXM",150,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXM",151,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXM",152,0)
 Q "ISC-SLC.VA.GOV"
"RTN","LEXRXXM",153,0)
BEG ;   Begin
"RTN","LEXRXXM",154,0)
 Q:$D(LEXQ)  K ^TMP("LEXRX",$J,"P")
"RTN","LEXRXXM",155,0)
 S ^TMP("LEXRX",$J,"P",1)=$$NOW^XLFDT
"RTN","LEXRXXM",156,0)
 Q
"RTN","LEXRXXM",157,0)
END ;   End
"RTN","LEXRXXM",158,0)
 Q:$D(LEXQ)  N LEXB,LEXE,LEXL S LEXB=$G(^TMP("LEXRX",$J,"P",1)) Q:+LEXB'>0
"RTN","LEXRXXM",159,0)
 S LEXE=$$NOW^XLFDT Q:+LEXE'>0  S ^TMP("LEXRX",$J,"P",2)=LEXE
"RTN","LEXRXXM",160,0)
 S LEXL=$$FMDIFF^XLFDT(LEXE,LEXB,3) Q:LEXL'[":"
"RTN","LEXRXXM",161,0)
 S:$E(LEXL,1)=" "&($E(LEXL,3)=":") LEXL=$TR(LEXL," ","0")
"RTN","LEXRXXM",162,0)
 S ^TMP("LEXRX",$J,"P",3)=LEXL
"RTN","LEXRXXM",163,0)
 Q
"RTN","LEXRXXM",164,0)
FV(X) ;   File Number is Valid
"RTN","LEXRXXM",165,0)
 N LEXFI S LEXFI=+($G(X)) Q:+LEXFI'>0 0  Q:$E(LEXFI,1,3)'="757" 0
"RTN","LEXRXXM",166,0)
 Q:'$D(^LEX(+LEXFI))&('$D(^LEXT(+LEXFI))) 0
"RTN","LEXRXXM",167,0)
 Q 1
"RTN","LEXRXXM",168,0)
FN(X) ;   Filename
"RTN","LEXRXXM",169,0)
 S X=+($G(X)) Q:$D(^LEX(X,0)) $$TITLE^XLFSTR($P($G(^LEX(X,0)),"^",1))
"RTN","LEXRXXM",170,0)
 Q:$D(^LEXT(X,0)) $$TITLE^XLFSTR($P($G(^LEXT(X,0)),"^",1))
"RTN","LEXRXXM",171,0)
 Q ""
"RTN","LEXRXXM",172,0)
ED(X) ;   External Date
"RTN","LEXRXXM",173,0)
 N LEXI,LEXO S LEXI=$G(X),LEXO="" Q:$E(X,1,7)'?7N ""
"RTN","LEXRXXM",174,0)
 S:$L($P(LEXI,".",2)) LEXO=$TR($$FMTE^XLFDT(LEXI,"5Z"),"@"," ")
"RTN","LEXRXXM",175,0)
 S:'$L($P(LEXI,".",2)) LEXO=$TR($$FMTE^XLFDT(LEXI,"5DZ"),"@"," ")
"RTN","LEXRXXM",176,0)
 S X=LEXO
"RTN","LEXRXXM",177,0)
 Q X
"RTN","LEXRXXM",178,0)
ENV(X) ;   Check environment
"RTN","LEXRXXM",179,0)
 N LEXNM S DT=$$DT^XLFDT D HOME^%ZIS S U="^"
"RTN","LEXRXXM",180,0)
 I +($G(DUZ))=0 W !!,?5,"DUZ not defined" Q 0
"RTN","LEXRXXM",181,0)
 S LEXNM=$$GET1^DIQ(200,(DUZ_","),.01)
"RTN","LEXRXXM",182,0)
 I '$L(LEXNM) W !!,?5,"DUZ not valid" Q 0
"RTN","LEXRXXM",183,0)
 S:$G(DUZ(0))'["@" DUZ(0)=$G(DUZ(0))_"@"
"RTN","LEXRXXM",184,0)
 Q 1
"RTN","LEXRXXM",185,0)
BOLD(X) ;   Bold
"RTN","LEXRXXM",186,0)
 N LEXNRM,LEXBLD D ATTR S X="" S:$L($G(LEXBLD)) X=LEXBLD D KATTR Q X
"RTN","LEXRXXM",187,0)
NORM(X) ;   Norm
"RTN","LEXRXXM",188,0)
 N LEXNRM,LEXBLD D ATTR S X="" S:$L($G(LEXNRM)) X=LEXNRM D KATTR Q X
"RTN","LEXRXXM",189,0)
ATTR ;   Screen Attributes
"RTN","LEXRXXM",190,0)
 K LEXNRM,LEXBLD,IOINHI,IOINORM N X S X="IOINHI;IOINORM" D ENDR^%ZISS S LEXNRM=$G(IOINORM),LEXBLD=$G(IOINHI) Q
"RTN","LEXRXXM",191,0)
KATTR ;   Kill Screen Attributes
"RTN","LEXRXXM",192,0)
 D KILL^%ZISS K LEXNRM,LEXBLD,IOINHI,IOINORM Q
"RTN","LEXRXXM",193,0)
CLR ;   Clear
"RTN","LEXRXXM",194,0)
 K LEXQ
"RTN","LEXRXXM",195,0)
 Q
"RTN","LEXRXXM2")
0^20^B20334656^n/a
"RTN","LEXRXXM2",1,0)
LEXRXXM2 ;ISL/KER - Re-Index Miscellaneous (cont) ;08/17/2011
"RTN","LEXRXXM2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXM2",3,0)
 ;               
"RTN","LEXRXXM2",4,0)
 ; Global Variables
"RTN","LEXRXXM2",5,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXXM2",6,0)
 ;    ^XTMP("LEXRX")      SACC 2.3.2.5.2 
"RTN","LEXRXXM2",7,0)
 ;               
"RTN","LEXRXXM2",8,0)
 ; Special Variables
"RTN","LEXRXXM2",9,0)
 ;    DTIME               SACC 2.3.1.5.3
"RTN","LEXRXXM2",10,0)
 ;               
"RTN","LEXRXXM2",11,0)
 ; External References
"RTN","LEXRXXM2",12,0)
 ;    KILL^%ZTLOAD        ICR  10063
"RTN","LEXRXXM2",13,0)
 ;    STAT^%ZTLOAD        ICR  10063
"RTN","LEXRXXM2",14,0)
 ;    ^DIR                ICR  10026
"RTN","LEXRXXM2",15,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXXM2",16,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXXM2",17,0)
 ;               
"RTN","LEXRXXM2",18,0)
 Q
"RTN","LEXRXXM2",19,0)
 ; Miscellaneous
"RTN","LEXRXXM2",20,0)
CHECK(X) ; Check for Running
"RTN","LEXRXXM2",21,0)
 ; Input
"RTN","LEXRXXM2",22,0)
 ;    None
"RTN","LEXRXXM2",23,0)
 ; Output
"RTN","LEXRXXM2",24,0)
 ;    0  Task is not Running
"RTN","LEXRXXM2",25,0)
 ;    1  Task is Running
"RTN","LEXRXXM2",26,0)
 N LEXIS,LEXII,LEXC,LEXCHK S LEXCHK="",LEXIS=$$IS,LEXII=$$II
"RTN","LEXRXXM2",27,0)
 I +LEXIS>0,+LEXII>0 D  Q
"RTN","LEXRXXM2",28,0)
 . N LEXMSG S LEXMSG=$P(LEXII,"^",2)
"RTN","LEXRXXM2",29,0)
 . W:$L(LEXMSG) !,"   ",LEXMSG
"RTN","LEXRXXM2",30,0)
 Q:+LEXIS'>0 0  S LEXC=$$PROG^LEXRXXM2 W !
"RTN","LEXRXXM2",31,0)
 Q 1
"RTN","LEXRXXM2",32,0)
MON ;   Monitor Status of Re-Index
"RTN","LEXRXXM2",33,0)
 N LEXC,LEXMON,LEXEXIT,LEXHT,LEXIS,LEXII,LEXNOW S LEXMON=0
"RTN","LEXRXXM2",34,0)
 S LEXIS=$$IS,LEXII=$$II I +LEXIS'>0 D  Q
"RTN","LEXRXXM2",35,0)
 . W !,"   Lexicon cross-reference repair is not running"
"RTN","LEXRXXM2",36,0)
 I +LEXIS>0,+LEXII>0 D  Q
"RTN","LEXRXXM2",37,0)
 . N LEXMSG S LEXMSG=$P(LEXII,"^",2)
"RTN","LEXRXXM2",38,0)
 . W:$L(LEXMSG) !,"   ",LEXMSG
"RTN","LEXRXXM2",39,0)
 W !!," Entering an Up-Arrow ""^"" to exit"
"RTN","LEXRXXM2",40,0)
 S (LEXMON,LEXEXIT)=0
"RTN","LEXRXXM2",41,0)
 F  D  Q:+LEXEXIT>0
"RTN","LEXRXXM2",42,0)
 . N LEXC S LEXEXIT=$$PA(5) S LEXMON=LEXMON+1
"RTN","LEXRXXM2",43,0)
 . S LEXC=$$PROG^LEXRXXM2 S:LEXC'>0 LEXEXIT=1
"RTN","LEXRXXM2",44,0)
 S LEXNOW=$$IS I +($G(LEXIS))>0,+($G(LEXNOW))'>0 D
"RTN","LEXRXXM2",45,0)
 . W !!,"   Lexicon cross-reference repair/re-index completed",!
"RTN","LEXRXXM2",46,0)
 . S LEXEXIT=$$PA(1)
"RTN","LEXRXXM2",47,0)
 Q
"RTN","LEXRXXM2",48,0)
PA(X) ;   Pause
"RTN","LEXRXXM2",49,0)
 N DTIME,DIR,DTOUT,DUOUT,DIRUT,DIROUT,LEXHT,Y S LEXHT=+($G(X))
"RTN","LEXRXXM2",50,0)
 S:+LEXHT'>0 LEXHT=2 S DTIME=LEXHT
"RTN","LEXRXXM2",51,0)
 S DIR(0)="FAO",(DIR("?"),DIR("??"))="",DIR("A")=""
"RTN","LEXRXXM2",52,0)
 S DIR("PRE")="S:X[""?"" X=""^""" D ^DIR
"RTN","LEXRXXM2",53,0)
 S:$D(DUOUT)!($D(DIROUT)) X="^" S:X'["^" X=0 S:X["^" X=1
"RTN","LEXRXXM2",54,0)
 Q X
"RTN","LEXRXXM2",55,0)
IS(X) ;   Task is Running
"RTN","LEXRXXM2",56,0)
 N LEXO,LEXTSK,ZTSK,LEXMSG S LEXO="LEXRW~",LEXMSG=""
"RTN","LEXRXXM2",57,0)
 F  S LEXO=$O(^XTMP(LEXO)) Q:'$L(LEXO)!($E(LEXO,1,5)'="LEXRX")  D
"RTN","LEXRXXM2",58,0)
 . S LEXTSK=$G(^XTMP(LEXO,1)) Q:+LEXTSK'>0  N ZTSK S ZTSK=+LEXTSK
"RTN","LEXRXXM2",59,0)
 . D STAT^%ZTLOAD Q:+($G(ZTSK(0)))'>0
"RTN","LEXRXXM2",60,0)
 . I +($G(ZTSK(1)))>2,+($G(ZTSK(1)))'=5 D  Q
"RTN","LEXRXXM2",61,0)
 . . N ZTSK S ZTSK=+LEXTSK
"RTN","LEXRXXM2",62,0)
 . . D:+($G(ZTSK(1)))'=5 KILL^%ZTLOAD
"RTN","LEXRXXM2",63,0)
 . . K ^XTMP(LEXO)
"RTN","LEXRXXM2",64,0)
 . S X=+($G(X))+1
"RTN","LEXRXXM2",65,0)
 S X=+($G(X))
"RTN","LEXRXXM2",66,0)
 Q X
"RTN","LEXRXXM2",67,0)
II(X) ;   Inactive and Interrupted
"RTN","LEXRXXM2",68,0)
 N LEXO,LEXTSK,ZTSK,LEXMSG S LEXO="LEXRW~",LEXMSG=""
"RTN","LEXRXXM2",69,0)
 F  S LEXO=$O(^XTMP(LEXO)) Q:'$L(LEXO)!($E(LEXO,1,5)'="LEXRX")  D  Q:$L(LEXMSG)
"RTN","LEXRXXM2",70,0)
 . S LEXTSK=$G(^XTMP(LEXO,1)) Q:+LEXTSK'>0
"RTN","LEXRXXM2",71,0)
 . N ZTSK S ZTSK=+LEXTSK
"RTN","LEXRXXM2",72,0)
 . D STAT^%ZTLOAD Q:+($G(ZTSK(0)))'>0
"RTN","LEXRXXM2",73,0)
 . S:+($G(ZTSK(1)))=5 LEXMSG="1^Task "_ZTSK_" was interrupted and is inactive"
"RTN","LEXRXXM2",74,0)
 S X=$G(LEXMSG) S:'$L(X) X=0
"RTN","LEXRXXM2",75,0)
 Q X
"RTN","LEXRXXM2",76,0)
PROG(X) ;   Progress
"RTN","LEXRXXM2",77,0)
 N LEXBEG,LEXBEGE,LEXBEGD,LEXUPD,LEXNAM,LEXO,LEXUPDE,LEXUPDD,LEXDES
"RTN","LEXRXXM2",78,0)
 N LEXACT,LEXCUR,LEXTASK,LEXTSK,LEXNOW,LEXND S X=0
"RTN","LEXRXXM2",79,0)
 S LEXO="LEXRW~" K LEXTASK
"RTN","LEXRXXM2",80,0)
 F  S LEXO=$O(^XTMP(LEXO)) Q:'$L(LEXO)!($E(LEXO,1,5)'="LEXRX")  D
"RTN","LEXRXXM2",81,0)
 . S LEXNAM=LEXO,LEXTSK=$G(^XTMP(LEXNAM,1))
"RTN","LEXRXXM2",82,0)
 . Q:+LEXTSK'>0  N ZTSK S ZTSK=+LEXTSK
"RTN","LEXRXXM2",83,0)
 . D STAT^%ZTLOAD Q:+($G(ZTSK(0)))'>0
"RTN","LEXRXXM2",84,0)
 . I +($G(ZTSK(1)))>2 D  Q
"RTN","LEXRXXM2",85,0)
 . . N ZTSK S ZTSK=+LEXTSK
"RTN","LEXRXXM2",86,0)
 . . D KILL^%ZTLOAD K ^XTMP(LEXNAM)
"RTN","LEXRXXM2",87,0)
 . S LEXNOW=$$NOW^XLFDT,LEXND=$G(^XTMP(LEXNAM,0))
"RTN","LEXRXXM2",88,0)
 . S LEXBEG=$P(LEXND,"^",3),LEXDES=$P(LEXND,"^",4)
"RTN","LEXRXXM2",89,0)
 . Q:'$L(LEXDES)
"RTN","LEXRXXM2",90,0)
 . S LEXTSK=$G(^XTMP(LEXNAM,1)),LEXND=$G(^XTMP(LEXNAM,2))
"RTN","LEXRXXM2",91,0)
 . S LEXUPD=$P(LEXND,"^",1),LEXACT=$P(LEXND,"^",2)
"RTN","LEXRXXM2",92,0)
 . S LEXBEGE=$$ED^LEXRXXM(LEXBEG),LEXUPDE=$$ED^LEXRXXM(LEXUPD)
"RTN","LEXRXXM2",93,0)
 . S LEXBEGD=$$FMDIFF^XLFDT(LEXNOW,LEXBEG,3)
"RTN","LEXRXXM2",94,0)
 . S LEXUPDD=$$FMDIFF^XLFDT(LEXNOW,LEXBEG,3)
"RTN","LEXRXXM2",95,0)
 . S:$E(LEXBEGD,1)=" "&($E(LEXBEGD,3)=":") LEXBEGD=$TR(LEXBEGD," ","0")
"RTN","LEXRXXM2",96,0)
 . S:$E(LEXUPDD,1)=" "&($E(LEXUPDD,3)=":") LEXUPDD=$TR(LEXUPDD," ","0")
"RTN","LEXRXXM2",97,0)
 . W:$L($G(IOF))&('$D(LEXCHK)) @IOF I +($G(ZTSK(1)))=1 D  Q
"RTN","LEXRXXM2",98,0)
 . . W !!," ",LEXDES
"RTN","LEXRXXM2",99,0)
 . . W !," The task is scheduled, waiting for an I/O device, a volume"
"RTN","LEXRXXM2",100,0)
 . . W !," set link, or a partition in memory" S X=+($G(X))+1
"RTN","LEXRXXM2",101,0)
 . I +($G(ZTSK(1)))=2 D  Q
"RTN","LEXRXXM2",102,0)
 . . W !!," Repair/Re-Index is in progress" S X=+($G(X))+1
"RTN","LEXRXXM2",103,0)
 . . W !,?3,LEXDES W:$L(LEXBEGE) ?49,"Started:  ",LEXBEGE
"RTN","LEXRXXM2",104,0)
 . . I $L(LEXACT) D
"RTN","LEXRXXM2",105,0)
 . . . W !,?5,LEXACT
"RTN","LEXRXXM2",106,0)
 . . . W:$L(LEXUPDE) ?49,"Current:  ",LEXUPDE
"RTN","LEXRXXM2",107,0)
 . . W:$L(LEXBEGD)&(+($G(LEXMON))'>0) !,?49,"Running:  ",LEXBEGD
"RTN","LEXRXXM2",108,0)
 . . W:$L(LEXBEGD)&(+($G(LEXMON))>0) !,?7,"#",+($G(LEXMON)),?49,"Running:  ",LEXBEGD
"RTN","LEXRXXM2",109,0)
 S X=+($G(X))
"RTN","LEXRXXM2",110,0)
 Q X
"RTN","LEXRXXM2",111,0)
CLR ;   Clear
"RTN","LEXRXXM2",112,0)
 Q
"RTN","LEXRXXP")
0^21^B22174903^n/a
"RTN","LEXRXXP",1,0)
LEXRXXP ;ISL/KER - Re-Index Parse ;08/17/2011
"RTN","LEXRXXP",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXP",3,0)
 ;               
"RTN","LEXRXXP",4,0)
 ; Global Variables
"RTN","LEXRXXP",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXXP",6,0)
 ;    ^LEX(757,           SACC 1.3
"RTN","LEXRXXP",7,0)
 ;    ^LEX(757.01,        SACC 1.3 
"RTN","LEXRXXP",8,0)
 ;    ^LEX(757.05,        SACC 1.3 
"RTN","LEXRXXP",9,0)
 ;    ^TMP("LEXTKN")      SACC 2.3.2.5.1
"RTN","LEXRXXP",10,0)
 ;    ^UTILITY($J         ICR  10011
"RTN","LEXRXXP",11,0)
 ;               
"RTN","LEXRXXP",12,0)
 ; External References
"RTN","LEXRXXP",13,0)
 ;    ^DIWP               ICR  10011
"RTN","LEXRXXP",14,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXRXXP",15,0)
 ;               
"RTN","LEXRXXP",16,0)
 Q
"RTN","LEXRXXP",17,0)
AWRD(X,LEX1,LEXI) ;   Get Words
"RTN","LEXRXXP",18,0)
 N LEXEX,LEXE,LEXT,LEXMC,LEXMCE,LEXW K LEX1 S LEX1(0)=0 S LEXEX=+($G(X)) Q:+LEXEX'>0!('$D(^LEX(757.01,+LEXEX,0)))
"RTN","LEXRXXP",19,0)
 S LEXMC=+($G(^LEX(757.01,+LEXEX,1))),LEXMCE=$$MCE(LEXEX) Q:'$D(^LEX(757,+LEXMC,0))  Q:'$D(^LEX(757.01,+LEXMCE,0))
"RTN","LEXRXXP",20,0)
 S LEXE=0 F  S LEXE=$O(^LEX(757.01,"AMC",LEXMC,LEXE)) Q:+LEXE'>0  D
"RTN","LEXRXXP",21,0)
 . N LEX2,LEXT S LEXT=$P($G(^LEX(757.01,+LEXE,0)),"^",1)
"RTN","LEXRXXP",22,0)
 . D WORDS(LEXT,.LEX2) S LEXT="" F  S LEXT=$O(LEX2(LEXT)) Q:'$L(LEXT)  D
"RTN","LEXRXXP",23,0)
 . . S LEX1("W",LEXT,LEXMCE,LEXE)=""
"RTN","LEXRXXP",24,0)
 S LEX1(0)="Word^Major Concept Expression IEN^Expression IEN"
"RTN","LEXRXXP",25,0)
 Q
"RTN","LEXRXXP",26,0)
WORDS(X,LEXA) ;
"RTN","LEXRXXP",27,0)
 K LEXA N LEXIDX,LEXI1,LEXI2,LEX1,LEXW S X=$$UP^XLFSTR(X) S:+($G(LEXI))>0 LEXIDX="" K ^TMP("LEXTKN",$J) D PTX^LEXTOLKN
"RTN","LEXRXXP",28,0)
 I $D(^TMP("LEXTKN",$J,0)),^TMP("LEXTKN",$J,0)>0 S LEXI1=0 F  S LEXI1=$O(^TMP("LEXTKN",$J,LEXI1)) Q:+LEXI1'>0  D
"RTN","LEXRXXP",29,0)
 . S LEXI2="" F LEXI2=$O(^TMP("LEXTKN",$J,LEXI1,LEXI2)) Q:'$L(LEXI2)  S LEXA(LEXI2)=""
"RTN","LEXRXXP",30,0)
 K ^TMP("LEXTKN",$J)
"RTN","LEXRXXP",31,0)
 Q 
"RTN","LEXRXXP",32,0)
SUP(X,LEX1,LEXI) ;   Get Supplemental Words
"RTN","LEXRXXP",33,0)
 N LEXEX,LEXE,LEXT,LEXMC,LEXMCE,LEXW K LEX1 S LEX1(0)=0 S LEXEX=+($G(X)) Q:+LEXEX'>0!('$D(^LEX(757.01,+LEXEX,0)))
"RTN","LEXRXXP",34,0)
 S LEXMC=+($G(^LEX(757.01,+LEXEX,1))),LEXMCE=$$MCE(LEXEX) Q:'$D(^LEX(757,+LEXMC,0))  Q:'$D(^LEX(757.01,+LEXMCE,0))
"RTN","LEXRXXP",35,0)
 S LEXE=0 F  S LEXE=$O(^LEX(757.01,LEXEX,5,LEXE)) Q:+LEXE'>0  D
"RTN","LEXRXXP",36,0)
 . N LEX2,LEXT S LEXT=$P($G(^LEX(757.01,LEXEX,5,+LEXE,0)),"^",1)
"RTN","LEXRXXP",37,0)
 . S:$L(LEXT) LEX1("S",LEXT,LEXEX,LEXMCE,+LEXE)=""
"RTN","LEXRXXP",38,0)
 S LEX1(0)="Word^Expression IEN^Major Concept Expression IEN"
"RTN","LEXRXXP",39,0)
 Q
"RTN","LEXRXXP",40,0)
LINK(X,LEX1) ;   Get Linked Words
"RTN","LEXRXXP",41,0)
 K LEX1 N LEXE,LEXEX,LEXMC,LEXMCE,LEXW,LEXTK,LEXB,LEXC,LEXI,LEXIEN S LEXEX=$G(X) Q:'$D(^LEX(757.01,+LEXEX,0))
"RTN","LEXRXXP",42,0)
 S LEXMC=+($P($G(^LEX(757.01,+LEXEX,1)),"^",1)) Q:'$D(^LEX(757,+LEXMC,0))  S LEXMCE=$$MCE(LEXEX) Q:'$D(^LEX(757.01,+LEXMCE,0))
"RTN","LEXRXXP",43,0)
 ;       Physical
"RTN","LEXRXXP",44,0)
 D AWRD(LEXEX,.LEXW,0) S LEXE=0 F  S LEXE=$O(^LEX(757.01,LEXEX,5,LEXE)) Q:+LEXE'>0  D
"RTN","LEXRXXP",45,0)
 . N LEXT S LEXT=$P($G(^LEX(757.01,LEXEX,5,+LEXE,0)),"^",1) S:$L(LEXT) LEXW("W",LEXT,LEXEX,LEXMCE,+LEXE)=""
"RTN","LEXRXXP",46,0)
 S LEXB=$E($$UP^XLFSTR($P($G(^LEX(757.01,+LEXEX,0)),"^",1)),1,63)
"RTN","LEXRXXP",47,0)
 S LEXI=0 S:$L(LEXB) LEXI=$O(^LEX(757.05,"C",LEXB,0))
"RTN","LEXRXXP",48,0)
 S:+LEXI>0&($L(LEXB)) LEXW("W",LEXB,LEXEX,LEXMCE)=LEXI
"RTN","LEXRXXP",49,0)
 S LEXTK="" F  S LEXTK=$O(LEXW("W",LEXTK)) Q:'$L(LEXTK)  D
"RTN","LEXRXXP",50,0)
 . N LEXI,LEXIEN,LEXPH S LEXPH=$$UP^XLFSTR($E(LEXTK,1,40)),LEXIEN=+($G(LEXW("W",LEXTK,LEXEX,LEXMCE)))
"RTN","LEXRXXP",51,0)
 . S LEXI=0 F  S LEXI=$O(^LEX(757.05,"B",LEXPH,LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXP",52,0)
 . . N LEXT S LEXT="" S:+LEXI>0 LEXT=$P($G(^LEX(757.05,+LEXI,0)),"^",3)
"RTN","LEXRXXP",53,0)
 . . S:$L(LEXPH)&(+LEXI>0) LEX1("TXT",LEXPH)=LEXI,LEX1("IEN",+LEXI,LEXPH)=LEXT
"RTN","LEXRXXP",54,0)
 . . I $D(^LEX(757.05,+LEXI,1,"B",+LEXEX)),$L(LEXT) D
"RTN","LEXRXXP",55,0)
 . . . S LEX1(LEXT,LEXPH,LEXEX,"LINKED")=LEXI_"^"_$G(^LEX(757.05,+LEXI,0))
"RTN","LEXRXXP",56,0)
 . . . K:$L(LEXT) LEX1("IEN"),LEX1("TXT")
"RTN","LEXRXXP",57,0)
 . I LEXIEN>0 S LEXT=$P($G(^LEX(757.05,+LEXIEN,0)),"^",3) S:$L(LEXT) LEX1("TXT",$$UP^XLFSTR(LEXTK))=LEXIEN,LEX1("IEN",+LEXIEN,$$UP^XLFSTR(LEXTK))=LEXT
"RTN","LEXRXXP",58,0)
 ;       Replacement
"RTN","LEXRXXP",59,0)
 S LEXI=0 F  S LEXI=$O(LEX1("IEN",LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXP",60,0)
 . N LEXPH S LEXPH="" F  S LEXPH=$O(LEX1("IEN",LEXI,LEXPH)) Q:'$L(LEXPH)  D
"RTN","LEXRXXP",61,0)
 . . N LEXT S LEXT=$G(LEX1("IEN",LEXI,LEXPH)) D:LEXT="R"
"RTN","LEXRXXP",62,0)
 . . . N LEXA,LEXB S X=LEXPH N LEXIDX D PTX^LEXTOLKN
"RTN","LEXRXXP",63,0)
 . . . I $D(^TMP("LEXTKN",$J,0)),^TMP("LEXTKN",$J,0)>0 S LEXA=0 F  S LEXA=$O(^TMP("LEXTKN",$J,LEXA)) Q:+LEXA'>0  D
"RTN","LEXRXXP",64,0)
 . . . . N LEXB S LEXB="" F  S LEXB=$O(^TMP("LEXTKN",$J,LEXA,LEXB)) Q:'$L(LEXB)  D
"RTN","LEXRXXP",65,0)
 . . . . . N LEXMCE S LEXMCE=$$MCE(LEXEX)
"RTN","LEXRXXP",66,0)
 . . . . . S LEX1("IEN",LEXI,LEXPH,"W",LEXB)="",LEX1(LEXT,LEXB,LEXMCE,"LINKED")=LEXI_"^"_$G(^LEX(757.05,+LEXI,0))
"RTN","LEXRXXP",67,0)
 . . K:$L(LEXT) LEX1("IEN"),LEX1("TXT")
"RTN","LEXRXXP",68,0)
 Q
"RTN","LEXRXXP",69,0)
PR(LEX,X) ; Parse Array LEX in X Length Strings (default 79)
"RTN","LEXRXXP",70,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,LEXI,LEXLEN,LEXC K ^UTILITY($J,"W") Q:'$D(LEX)
"RTN","LEXRXXP",71,0)
 S LEXLEN=+($G(X)) S:+LEXLEN'>0 LEXLEN=79 S LEXC=+($G(LEX)) S:+($G(LEXC))'>0 LEXC=$O(LEX(" "),-1) Q:+LEXC'>0
"RTN","LEXRXXP",72,0)
 S DIWL=1,DIWF="C"_+LEXLEN S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI=0  S X=$G(LEX(LEXI)) D ^DIWP
"RTN","LEXRXXP",73,0)
 K LEX S (LEXC,LEXI)=0 F  S LEXI=$O(^UTILITY($J,"W",1,LEXI)) Q:+LEXI=0  D
"RTN","LEXRXXP",74,0)
 . S LEX(LEXI)=$$TM($G(^UTILITY($J,"W",1,LEXI,0))," "),LEXC=LEXC+1
"RTN","LEXRXXP",75,0)
 S:$L(LEXC) LEX=LEXC K ^UTILITY($J,"W")
"RTN","LEXRXXP",76,0)
 Q
"RTN","LEXRXXP",77,0)
MCE(X) ; Major Concept Expression
"RTN","LEXRXXP",78,0)
 S X=+($G(^LEX(757,+($G(^LEX(757.01,+($G(X)),1))),0)))
"RTN","LEXRXXP",79,0)
 Q X
"RTN","LEXRXXP",80,0)
TM(X,Y) ; Trim Character Y - Default " "
"RTN","LEXRXXP",81,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LEXRXXP",82,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXRXXP",83,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXRXXP",84,0)
 Q X
"RTN","LEXRXXS")
0^22^B124182348^n/a
"RTN","LEXRXXS",1,0)
LEXRXXS ;ISL/KER - Re-Index Save/Send ;08/17/2011
"RTN","LEXRXXS",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXS",3,0)
 ;               
"RTN","LEXRXXS",4,0)
 ; Global Variables
"RTN","LEXRXXS",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXXS",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXXS",7,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXXS",8,0)
 ;               
"RTN","LEXRXXS",9,0)
 ; External References
"RTN","LEXRXXS",10,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXRXXS",11,0)
 ;    $$TITLE^XLFSTR      ICR  10104
"RTN","LEXRXXS",12,0)
 ;    ^XMD                ICR  10070
"RTN","LEXRXXS",13,0)
 ;               
"RTN","LEXRXXS",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXS",15,0)
 ;     LEXAMSO    User Selection  NEWed/KILLed by LEXRX
"RTN","LEXRXXS",16,0)
 ;     LEXSUBJ    Msg Subject     NEWed/KILLed by LEXRXXT
"RTN","LEXRXXS",17,0)
 ;     LEXTITL    Msg Title       NEWed/KILLed by LEXRXXT
"RTN","LEXRXXS",18,0)
 ;     LEXFMT     Display format  NEWed/KILLed by LEXRXXT2
"RTN","LEXRXXS",19,0)
 ;     LEXQ       Quiet flag      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXXS",20,0)
 ;     LEXNAM     Task Name       NEWed/KILLed by LEXRXXT2
"RTN","LEXRXXS",21,0)
 ;     LEXINS     Install Flag    NEWed/KILLed by Post-Install
"RTN","LEXRXXS",22,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXXS",23,0)
 ;
"RTN","LEXRXXS",24,0)
 Q
"RTN","LEXRXXS",25,0)
 ; Repair Index Report
"RTN","LEXRXXS",26,0)
REP(LEXFI,LEXFS,LEXIDX,LEXNDS,LEXERR,LEXIDXT,LEXELP) ;   Build
"RTN","LEXRXXS",27,0)
 S LEXFI=$G(LEXFI),LEXFS=$G(LEXFS),LEXIDX=$G(LEXIDX),LEXNDS=+($G(LEXNDS))
"RTN","LEXRXXS",28,0)
 S LEXERR=+($G(LEXERR)),LEXIDXT=$G(LEXIDXT),LEXELP=$G(LEXELP) H 1
"RTN","LEXRXXS",29,0)
 S:+($G(LEXFI))>0&('$L($G(LEXELP))) LEXELP="00:00:01"
"RTN","LEXRXXS",30,0)
 N LEXT,LEXNM,LEXTELP,LEXTERR,LEXTFI,LEXTFS,LEXTIDT,LEXTIDX,LEXTNDS,LEXIDXN
"RTN","LEXRXXS",31,0)
 S LEXTFI=+LEXFI Q:+LEXTFI'>0  Q:$P(LEXTFI,".",1)'="757"  S LEXNM=$$FN(+LEXFI)
"RTN","LEXRXXS",32,0)
 S:'$L(LEXNM) LEXTFI="  "_LEXTFI
"RTN","LEXRXXS",33,0)
 S LEXTFS=+($G(LEXFS))
"RTN","LEXRXXS",34,0)
 Q:+LEXTFS'>0  Q:$P(LEXTFS,".",1)'="757"
"RTN","LEXRXXS",35,0)
 S:'$L(LEXNM) LEXTFS="  "_LEXTFS
"RTN","LEXRXXS",36,0)
 S LEXTIDX=$G(LEXIDX)  Q:'$L(LEXTIDX)
"RTN","LEXRXXS",37,0)
 S LEXTNDS=LEXNDS S:+LEXTNDS'>0 LEXTNDS=""
"RTN","LEXRXXS",38,0)
 I +LEXNDS'>0,+LEXFI>0,+LEXFS>0,$L(LEXIDX),LEXIDX'="ALLIX" D  Q
"RTN","LEXRXXS",39,0)
 . K ^TMP("LEXRX",$J,"D",1,+LEXFI,+LEXFS,LEXIDX)
"RTN","LEXRXXS",40,0)
 . D REPS
"RTN","LEXRXXS",41,0)
 S LEXTERR=+($G(LEXERR)) S:+LEXTERR'>0 LEXTERR=""
"RTN","LEXRXXS",42,0)
 S:+($G(LEXERR))>0 LEXTERR=$J(LEXTERR,7)_" "
"RTN","LEXRXXS",43,0)
 S:+($G(LEXERR))'>0 LEXTERR=" ------ "
"RTN","LEXRXXS",44,0)
 S:+($G(LEXERR))'>0&(LEXIDX="ALLIX") LEXTERR="        "
"RTN","LEXRXXS",45,0)
 S:LEXIDX="ALLIX" LEXTNDS=""
"RTN","LEXRXXS",46,0)
 S LEXTNDS=$J(LEXTNDS,8)_" "
"RTN","LEXRXXS",47,0)
 S LEXTIDT=$G(LEXIDXT)
"RTN","LEXRXXS",48,0)
 S:LEXIDX="ALLIX" LEXIDXT="All Cross-References"
"RTN","LEXRXXS",49,0)
 S LEXIDXT=$E(LEXIDXT,1,35)
"RTN","LEXRXXS",50,0)
 Q:'$L(LEXTIDT)
"RTN","LEXRXXS",51,0)
 S LEXTELP=LEXELP
"RTN","LEXRXXS",52,0)
 S LEXTELP=LEXTELP_$J(" ",(9-$L(LEXTELP)))
"RTN","LEXRXXS",53,0)
 S LEXTFI=LEXTFI_$J(" ",(9-$L(LEXTFI)))
"RTN","LEXRXXS",54,0)
 S LEXTFS=LEXTFS_$J(" ",(9-$L(LEXTFS)))
"RTN","LEXRXXS",55,0)
 S:LEXIDX="ALLIX" LEXTIDX="Re-Index"
"RTN","LEXRXXS",56,0)
 S LEXTIDX=LEXTIDX_$J(" ",(9-$L(LEXTIDX)))
"RTN","LEXRXXS",57,0)
 S:LEXTFI=LEXTFS LEXT=LEXTFI_LEXTIDX_LEXTNDS_LEXTERR_LEXTELP_LEXIDXT
"RTN","LEXRXXS",58,0)
 S:LEXTFI'=LEXTFS LEXT=LEXTFS_LEXTIDX_LEXTNDS_LEXTERR_LEXTELP_LEXIDXT
"RTN","LEXRXXS",59,0)
 S:+($G(LEXERR)) ^TMP("LEXRX",$J,"ERR")=+($G(^TMP("LEXRX",$J,"ERR")))+($G(LEXERR))
"RTN","LEXRXXS",60,0)
 I $L($G(LEXELP)) D
"RTN","LEXRXXS",61,0)
 . N LEXT S LEXT=$G(^TMP("LEXRX",$J,"T",1,"ELAP"))
"RTN","LEXRXXS",62,0)
 . S ^TMP("LEXRX",$J,"T",1,"ELAP")=$$ADDT^LEXRXXM(LEXT,$G(LEXELP))
"RTN","LEXRXXS",63,0)
 S LEXIDXN=LEXIDX S:LEXIDX="ALLIX" LEXIDXN="~"
"RTN","LEXRXXS",64,0)
 I LEXT["Re-Index"&(LEXT["All Cross-References") D
"RTN","LEXRXXS",65,0)
 . S ^TMP("LEXRX",$J,"D",1,+LEXFI,"~",LEXIDXN)=LEXT
"RTN","LEXRXXS",66,0)
 I LEXT'["Re-Index"!(LEXT'["All Cross-References") D
"RTN","LEXRXXS",67,0)
 . S ^TMP("LEXRX",$J,"D",1,+LEXFI,+LEXFS,LEXIDXN)=LEXT
"RTN","LEXRXXS",68,0)
 D REPS
"RTN","LEXRXXS",69,0)
 Q
"RTN","LEXRXXS",70,0)
REPS ;   Save
"RTN","LEXRXXS",71,0)
 K ^TMP("LEXRX",$J,"R",1)
"RTN","LEXRXXS",72,0)
 N LEXALL,LEXTFI,LEXTFS,LEXTIX,LEXC,LEXT K LEXALL S LEXC=0,LEXTFI="" F  S LEXTFI=$O(^TMP("LEXRX",$J,"D",1,LEXTFI)) Q:'$L(LEXTFI)  D
"RTN","LEXRXXS",73,0)
 . S LEXTFS="" F  S LEXTFS=$O(^TMP("LEXRX",$J,"D",1,LEXTFI,LEXTFS)) Q:'$L(LEXTFS)  D
"RTN","LEXRXXS",74,0)
 . . K LEXALL S LEXTIX="" F  S LEXTIX=$O(^TMP("LEXRX",$J,"D",1,LEXTFI,LEXTFS,LEXTIX)) Q:'$L(LEXTIX)  D
"RTN","LEXRXXS",75,0)
 . . . S LEXT=$G(^TMP("LEXRX",$J,"D",1,LEXTFI,LEXTFS,LEXTIX)) Q:'$L(LEXT)  S LEXC=LEXC+1
"RTN","LEXRXXS",76,0)
 . . . I LEXT["Re-Index"&(LEXT["All Cross-References") S LEXALL=LEXT Q
"RTN","LEXRXXS",77,0)
 . . . I LEXC=1 D
"RTN","LEXRXXS",78,0)
 . . . . S ^TMP("LEXRX",$J,"R",1,1)="Repair Summary (large files only)"
"RTN","LEXRXXS",79,0)
 . . . . S:$G(LEXNAM)="LEXRXONE" ^TMP("LEXRX",$J,"R",1,1)="Repair File"
"RTN","LEXRXXS",80,0)
 . . . . S ^TMP("LEXRX",$J,"R",1,2)="   "
"RTN","LEXRXXS",81,0)
 . . . . S ^TMP("LEXRX",$J,"R",1,3)="File     Index    Nodes    Errors    Time   Index Format"
"RTN","LEXRXXS",82,0)
 . . . . S ^TMP("LEXRX",$J,"R",1,4)="-------- ------   -------- ------- -------- -----------------------------------"
"RTN","LEXRXXS",83,0)
 . . . . S ^TMP("LEXRX",$J,"R",1,0)=4,LEXC=5
"RTN","LEXRXXS",84,0)
 . . . S ^TMP("LEXRX",$J,"R",1,LEXC)=LEXT,^TMP("LEXRX",$J,"R",1,0)=LEXC
"RTN","LEXRXXS",85,0)
 . . I $L($G(LEXALL)) D
"RTN","LEXRXXS",86,0)
 . . . N LEXC S LEXC=$O(^TMP("LEXRX",$J,"R",1," "),-1)+1
"RTN","LEXRXXS",87,0)
 . . . S ^TMP("LEXRX",$J,"R",1,LEXC)=LEXALL,^TMP("LEXRX",$J,"R",1,0)=LEXC
"RTN","LEXRXXS",88,0)
 D RCMP
"RTN","LEXRXXS",89,0)
 Q
"RTN","LEXRXXS",90,0)
REPD ;   Display
"RTN","LEXRXXS",91,0)
 N LEXC W ! S LEXC=0 F  S LEXC=$O(^TMP("LEXRX",$J,"R",1,LEXC)) Q:+LEXC'>0  W !,$G(^TMP("LEXRX",$J,"R",1,LEXC))
"RTN","LEXRXXS",92,0)
 W !
"RTN","LEXRXXS",93,0)
 Q
"RTN","LEXRXXS",94,0)
 ;               
"RTN","LEXRXXS",95,0)
 ; Re-Index Report
"RTN","LEXRXXS",96,0)
REX(LEXFI,LEXNM,LEXELP,LEXIX) ;    Build
"RTN","LEXRXXS",97,0)
 K ^TMP("LEXRX",$J,"R",2)
"RTN","LEXRXXS",98,0)
 N LEXI,LEXSP,LEXTFI,LEXTNM,LEXTELP,LEXC S $P(LEXSP," ",40)=" ",LEXFI=+($G(LEXFI))
"RTN","LEXRXXS",99,0)
 S:+($G(LEXFI))>0&($L($G(LEXNM)))&('$L($G(LEXELP))) LEXELP="00:00:01"
"RTN","LEXRXXS",100,0)
 K:+LEXFI>0 ^TMP("LEXRX",$J,"D",2,+LEXFI)
"RTN","LEXRXXS",101,0)
 S LEXTFI=+($G(LEXFI)) Q:+LEXTFI'>0  Q:$P(LEXTFI,".",1)'="757"
"RTN","LEXRXXS",102,0)
 S LEXTFI=LEXTFI_$J(" ",(8-$L(LEXTFI))) S LEXTNM=$G(LEXNM) S LEXTNM=LEXTNM_$J(" ",(22-$L(LEXTNM)))
"RTN","LEXRXXS",103,0)
 S LEXTELP=$G(LEXELP) S LEXTELP=LEXTELP_$J(" ",(10-$L(LEXTELP)))
"RTN","LEXRXXS",104,0)
 S LEXT=LEXTFI_LEXTNM_LEXTELP_$G(LEXIX(1))
"RTN","LEXRXXS",105,0)
 I $L($G(LEXELP)) D
"RTN","LEXRXXS",106,0)
 . S ^TMP("LEXRX",$J,"T",2,"ELAP")=$$ADDT^LEXRXXM($G(^TMP("LEXRX",$J,"T",2,"ELAP")),$G(LEXELP))
"RTN","LEXRXXS",107,0)
 S ^TMP("LEXRX",$J,"D",2,LEXFI,1)=LEXT
"RTN","LEXRXXS",108,0)
 S LEXC=1 I $O(LEXIX(1))>0 D
"RTN","LEXRXXS",109,0)
 . S LEXI=1 F  S LEXI=$O(LEXIX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXS",110,0)
 . . N LEX S LEX=$G(LEXIX(LEXI)) Q:'$L(LEX)
"RTN","LEXRXXS",111,0)
 . . S LEXT=LEXSP_LEX,LEXC=LEXC+1
"RTN","LEXRXXS",112,0)
 . . W !,LEXT S ^TMP("LEXRX",$J,"D",2,+LEXFI,LEXC)=LEXT
"RTN","LEXRXXS",113,0)
 D REXS
"RTN","LEXRXXS",114,0)
 Q
"RTN","LEXRXXS",115,0)
REXS ;   Save
"RTN","LEXRXXS",116,0)
 K ^TMP("LEXRX",$J,"R",2)
"RTN","LEXRXXS",117,0)
 N LEXFIT,LEXI,LEXC,LEXT,LEXE S LEXC=0,LEXFIT="" F  S LEXFIT=$O(^TMP("LEXRX",$J,"D",2,LEXFIT)) Q:'$L(LEXFIT)  D
"RTN","LEXRXXS",118,0)
 . S LEXI=0 F  S LEXI=$O(^TMP("LEXRX",$J,"D",2,LEXFIT,LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXS",119,0)
 . . S LEXT=$G(^TMP("LEXRX",$J,"D",2,LEXFIT,LEXI)) Q:'$L(LEXT)  S LEXC=LEXC+1 I LEXC=1 D
"RTN","LEXRXXS",120,0)
 . . . S ^TMP("LEXRX",$J,"R",2,1)="Re-Index Summary (small files only)"
"RTN","LEXRXXS",121,0)
 . . . S:$G(LEXNAM)="LEXRXONE" ^TMP("LEXRX",$J,"R",2,1)="Re-Index File"
"RTN","LEXRXXS",122,0)
 . . . S ^TMP("LEXRX",$J,"R",2,2)=" "
"RTN","LEXRXXS",123,0)
 . . . S ^TMP("LEXRX",$J,"R",2,3)="File    File Name               Time    Cross-References"
"RTN","LEXRXXS",124,0)
 . . . S ^TMP("LEXRX",$J,"R",2,4)="------- --------------------- --------  -------------------------------------"
"RTN","LEXRXXS",125,0)
 . . . S ^TMP("LEXRX",$J,"R",2,0)=4,LEXC=5
"RTN","LEXRXXS",126,0)
 . . S ^TMP("LEXRX",$J,"R",2,LEXC)=LEXT,^TMP("LEXRX",$J,"R",2,0)=LEXC
"RTN","LEXRXXS",127,0)
 D RCMP
"RTN","LEXRXXS",128,0)
 Q
"RTN","LEXRXXS",129,0)
REXD ;   Display
"RTN","LEXRXXS",130,0)
 N LEXC W ! S LEXC=0 F  S LEXC=$O(^TMP("LEXRX",$J,"R",2,LEXC)) Q:+LEXC'>0  W !,$G(^TMP("LEXRX",$J,"R",2,LEXC))
"RTN","LEXRXXS",131,0)
 W !
"RTN","LEXRXXS",132,0)
 Q
"RTN","LEXRXXS",133,0)
 ;               
"RTN","LEXRXXS",134,0)
 ; Compile Report (Repair/Re-Index)
"RTN","LEXRXXS",135,0)
RCMP ;   Compile
"RTN","LEXRXXS",136,0)
 K ^TMP("LEXRX",$J,"R",3)
"RTN","LEXRXXS",137,0)
 N LEXI,LEXC,LEXE,LEXN1,LEXN2,LEXTT,LEXT1,LEXT2,LEXLEN
"RTN","LEXRXXS",138,0)
 S LEXLEN=33 S:$G(LEXFMT)=2!($G(LEXFMT)=0) LEXLEN=30
"RTN","LEXRXXS",139,0)
 S (LEXI,LEXC)=0 F  S LEXI=$O(^TMP("LEXRX",$J,"R",1,LEXI))  Q:+LEXI'>0  D
"RTN","LEXRXXS",140,0)
 . N LEXT S LEXC=LEXC+1,LEXT=$G(^TMP("LEXRX",$J,"R",1,LEXI)),^TMP("LEXRX",$J,"R",3,LEXC)=LEXT
"RTN","LEXRXXS",141,0)
 I $O(^TMP("LEXRX",$J,"R",1,0))>0,$O(^TMP("LEXRX",$J,"R",2,0))>0 D
"RTN","LEXRXXS",142,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1,^TMP("LEXRX",$J,"R",3,LEXC)=" "
"RTN","LEXRXXS",143,0)
 S LEXI=0 F  S LEXI=$O(^TMP("LEXRX",$J,"R",2,LEXI))  Q:+LEXI'>0  D
"RTN","LEXRXXS",144,0)
 . N LEXT S LEXC=LEXC+1,LEXT=$G(^TMP("LEXRX",$J,"R",2,LEXI)),^TMP("LEXRX",$J,"R",3,LEXC)=LEXT
"RTN","LEXRXXS",145,0)
 S LEXTT=$$TOT^LEXRXXM
"RTN","LEXRXXS",146,0)
 S LEXT1=$G(^TMP("LEXRX",$J,"T",1,"ELAP")),LEXT2=$G(^TMP("LEXRX",$J,"T",2,"ELAP"))
"RTN","LEXRXXS",147,0)
 S LEXN1=+($P(LEXT1,":",1))+($P(LEXT1,":",2))+($P(LEXT1,":",3))
"RTN","LEXRXXS",148,0)
 S LEXN2=+($P(LEXT2,":",1))+($P(LEXT2,":",2))+($P(LEXT2,":",3))
"RTN","LEXRXXS",149,0)
 S:LEXN1'>0&($G(LEXAMSO)="O")&(+($G(LEXFI))>0) LEXTT=$$ADD^LEXRXXM(LEXT1,1)
"RTN","LEXRXXS",150,0)
 S:LEXN2'>0&($G(LEXAMSO)="O")&(+($G(LEXFI))>0) LEXTT=$$ADD^LEXRXXM(LEXT2,1)
"RTN","LEXRXXS",151,0)
 S:LEXN1>0&(LEXN2'>0) LEXTT=$$ADD^LEXRXXM(LEXT1,1)
"RTN","LEXRXXS",152,0)
 S:LEXN1'>0&(LEXN2>0) LEXTT=$$ADD^LEXRXXM(LEXT2,1)
"RTN","LEXRXXS",153,0)
 S:LEXN1>0&(LEXN2>0) LEXTT=$$ADDT^LEXRXXM(LEXT1,LEXT2)
"RTN","LEXRXXS",154,0)
 S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1,^TMP("LEXRX",$J,"R",3,LEXC)=" "
"RTN","LEXRXXS",155,0)
 I $G(LEXFMT)=3 D
"RTN","LEXRXXS",156,0)
 . Q  S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1,^TMP("LEXRX",$J,"R",3,LEXC)=" Elapsed Time"
"RTN","LEXRXXS",157,0)
 . I +($G(LEXN1))>0 D
"RTN","LEXRXXS",158,0)
 . . N LEXT S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1,LEXT="     Repair Large Files:",LEXT=LEXT_$J(" ",(LEXLEN-$L(LEXT)))
"RTN","LEXRXXS",159,0)
 . . S ^TMP("LEXRX",$J,"R",3,LEXC)=LEXT_$G(LEXT1)
"RTN","LEXRXXS",160,0)
 . I +($G(LEXN2))>0 D
"RTN","LEXRXXS",161,0)
 . . N LEXT S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1
"RTN","LEXRXXS",162,0)
 . . S LEXT="     Re-Index Small Files:",LEXT=LEXT_$J(" ",(LEXLEN-$L(LEXT)))
"RTN","LEXRXXS",163,0)
 . . S ^TMP("LEXRX",$J,"R",3,LEXC)=LEXT_$G(LEXT2)
"RTN","LEXRXXS",164,0)
 . I +LEXN1>0!(LEXN2>0) D
"RTN","LEXRXXS",165,0)
 . . N LEXT S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1,LEXT="     Total All Files:",LEXT=LEXT_$J(" ",(LEXLEN-$L(LEXT)))
"RTN","LEXRXXS",166,0)
 . . S ^TMP("LEXRX",$J,"R",3,LEXC)=LEXT_$G(LEXTT)
"RTN","LEXRXXS",167,0)
 I $G(LEXFMT)=1 D
"RTN","LEXRXXS",168,0)
 . Q  N LEXE,LEXT S LEXT=" Repair Large Files:"
"RTN","LEXRXXS",169,0)
 . S:$G(LEXAMSO)="O"&(+($G(LEXFI))>0) LEXT=" Repair File "_+($G(LEXFI))_":"
"RTN","LEXRXXS",170,0)
 . S LEXT=LEXT_$J(" ",(LEXLEN-$L(LEXT)))
"RTN","LEXRXXS",171,0)
 . S LEXE=$$ADD^LEXRXXM($G(LEXT1),1) I +($G(LEXN1))>0!(LEXAMSO="O") D
"RTN","LEXRXXS",172,0)
 . . S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1
"RTN","LEXRXXS",173,0)
 . . S ^TMP("LEXRX",$J,"R",3,LEXC)=LEXT_$G(LEXE)
"RTN","LEXRXXS",174,0)
 I $G(LEXFMT)=2 D
"RTN","LEXRXXS",175,0)
 . Q  N LEXE,LEXT S LEXT=" Re-Index Small Files:"
"RTN","LEXRXXS",176,0)
 . S:$G(LEXAMSO)="O"&(+($G(LEXFI))>0) LEXT=" Re-Index File "_+($G(LEXFI))_":"
"RTN","LEXRXXS",177,0)
 . S:$G(LEXTITL)["Kill" LEXT=" Kill/Re-Index All Files:"
"RTN","LEXRXXS",178,0)
 . S LEXT=LEXT_$J(" ",(LEXLEN-$L(LEXT)))
"RTN","LEXRXXS",179,0)
 . N LEXE S LEXE=$$ADD^LEXRXXM(LEXT2,1) I +LEXN2>0!($G(LEXAMSO)="O") D
"RTN","LEXRXXS",180,0)
 . . S LEXC=$O(^TMP("LEXRX",$J,"R",3," "),-1)+1
"RTN","LEXRXXS",181,0)
 . . S ^TMP("LEXRX",$J,"R",3,LEXC)=LEXT_$G(LEXE)
"RTN","LEXRXXS",182,0)
 Q
"RTN","LEXRXXS",183,0)
RCMD ;   Display
"RTN","LEXRXXS",184,0)
 N LEXC W ! S LEXC=0 F  S LEXC=$O(^TMP("LEXRX",$J,"R",3,LEXC)) Q:+LEXC'>0  W !,$G(^TMP("LEXRX",$J,"R",3,LEXC))
"RTN","LEXRXXS",185,0)
 W !
"RTN","LEXRXXS",186,0)
 Q
"RTN","LEXRXXS",187,0)
 ;                
"RTN","LEXRXXS",188,0)
SEND ; Task MAILMAN to Send Message
"RTN","LEXRXXS",189,0)
 G:$D(LEXQ) MAILQ N LEX,LEXC,LEXI,LEXS,LEXT
"RTN","LEXRXXS",190,0)
 K ^TMP("LEXRX",$J,"MSG")
"RTN","LEXRXXS",191,0)
 S LEXC=1,LEXI=0 F  S LEXI=$O(^TMP("LEXRX",$J,"R",3,LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXS",192,0)
 . S LEXT=$E($G(^TMP("LEXRX",$J,"R",3,LEXI)),1,79)
"RTN","LEXRXXS",193,0)
 . I LEXT[" (large files only)"!(LEXT[" (small files only)") D  Q
"RTN","LEXRXXS",194,0)
 . . S LEXC=LEXC+1,^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",195,0)
 . S LEXC=LEXC+1,^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",196,0)
 D ERR,SUM S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)
"RTN","LEXRXXS",197,0)
 I +LEXC>1 S ^TMP("LEXRX",$J,"MSG",1,0)=" ",^TMP("LEXRX",$J,"MSG",(LEXC+1),0)=" "
"RTN","LEXRXXS",198,0)
 S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1),^TMP("LEXRX",$J,"MSG",0)=+LEXC
"RTN","LEXRXXS",199,0)
 S LEXS="Lexicon Index Repair/Re-Index Report" S:$L($G(LEXSUBJ)) LEXS=$G(LEXSUBJ)
"RTN","LEXRXXS",200,0)
 D PRG,MAIL,HOME^%ZIS
"RTN","LEXRXXS",201,0)
 Q
"RTN","LEXRXXS",202,0)
MAIL ;   MAILMAN
"RTN","LEXRXXS",203,0)
 N DIFROM,XCNP,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","LEXRXXS",204,0)
 G:'$D(^TMP("LEXRX",$J,"MSG")) MAILQ G:+($G(^TMP("LEXRX",$J,"MSG",0)))=0 MAILQ
"RTN","LEXRXXS",205,0)
 K XMZ N DIFROM S XMSUB="Lexicon Cross-Reference Repair/Re-Index"
"RTN","LEXRXXS",206,0)
 S:$L($G(LEXSUBJ)) XMSUB=$G(LEXSUBJ)
"RTN","LEXRXXS",207,0)
 K XMY S:+($G(DUZ))>0 XMY(+($G(DUZ)))=""
"RTN","LEXRXXS",208,0)
 I $D(LEXINS) D
"RTN","LEXRXXS",209,0)
 . K XMY N LEXADR S LEXADR=$$ADR Q:'$L(LEXADR)
"RTN","LEXRXXS",210,0)
 . S LEXADR="G.LEXINS@"_LEXADR S XMY(LEXADR)=""
"RTN","LEXRXXS",211,0)
 G:'$D(XMY) MAILQ
"RTN","LEXRXXS",212,0)
 S XMTEXT="^TMP(""LEXRX"",$J,""MSG"",",XMDUZ=.5 D ^XMD
"RTN","LEXRXXS",213,0)
 I '$D(ZTQUEUED),+($G(XMZ))>0,'$D(LEXINS) D
"RTN","LEXRXXS",214,0)
 . W !!," Lexicon Cross-Reference Repair/Re-Index message (#",+($G(XMZ)),") sent"
"RTN","LEXRXXS",215,0)
MAILQ ;   End of MAILMAN
"RTN","LEXRXXS",216,0)
 K ^TMP("LEXRX",$J) K DIFROM,XCNP,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","LEXRXXS",217,0)
 Q
"RTN","LEXRXXS",218,0)
 ;
"RTN","LEXRXXS",219,0)
 ; Miscellaneous
"RTN","LEXRXXS",220,0)
SUM ;   Timing Summary 
"RTN","LEXRXXS",221,0)
 I $O(^TMP("LEXRX",$J,"MSG",0))>0 D
"RTN","LEXRXXS",222,0)
 . N LEXBEG,LEXEND,LEXELP,LEXC
"RTN","LEXRXXS",223,0)
 . S LEXBEG=+($G(^TMP("LEXRX",$J,"P",1))) Q:$P(LEXBEG,".",1)'?7N
"RTN","LEXRXXS",224,0)
 . S LEXEND=+($G(^TMP("LEXRX",$J,"P",2))) Q:$P(LEXEND,".",1)'?7N
"RTN","LEXRXXS",225,0)
 . Q:LEXBEG=LEXEND  S LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3) Q:$L(LEXELP,":")'=3
"RTN","LEXRXXS",226,0)
 . S:$E(LEXELP,1)=" "&($E(LEXELP,3)=":") LEXELP=$TR(LEXELP," ","0")
"RTN","LEXRXXS",227,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)
"RTN","LEXRXXS",228,0)
 . S LEXT=$$TM^LEXRXXM($G(^TMP("LEXRX",$J,"MSG",LEXC,0)))
"RTN","LEXRXXS",229,0)
 . I $L(LEXT) D
"RTN","LEXRXXS",230,0)
 . . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",231,0)
 . . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=" "
"RTN","LEXRXXS",232,0)
 . S LEXT="Re-Index Started:   "_$$ED^LEXRXXM(LEXBEG)
"RTN","LEXRXXS",233,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",234,0)
 . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",235,0)
 . S LEXT="Re-Index Finished:  "_$$ED^LEXRXXM(LEXEND)
"RTN","LEXRXXS",236,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",237,0)
 . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",238,0)
 . S LEXT="Elapsed Time:       "_LEXELP
"RTN","LEXRXXS",239,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",240,0)
 . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",241,0)
 Q
"RTN","LEXRXXS",242,0)
ERR ;   Error Summary 
"RTN","LEXRXXS",243,0)
 I $O(^TMP("LEXRX",$J,"MSG",0))>0 D
"RTN","LEXRXXS",244,0)
 . N LEXE,LEXT,LEXC
"RTN","LEXRXXS",245,0)
 . S LEXE=+($G(^TMP("LEXRX",$J,"ERR"))) Q:LEXE'>0
"RTN","LEXRXXS",246,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)
"RTN","LEXRXXS",247,0)
 . S LEXT=$$TM^LEXRXXM($G(^TMP("LEXRX",$J,"MSG",LEXC,0)))
"RTN","LEXRXXS",248,0)
 . I $L(LEXT) D
"RTN","LEXRXXS",249,0)
 . . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",250,0)
 . . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=" "
"RTN","LEXRXXS",251,0)
 . S LEXT="Errors Repaired:    "
"RTN","LEXRXXS",252,0)
 . S LEXT=LEXT_LEXE
"RTN","LEXRXXS",253,0)
 . S LEXC=$O(^TMP("LEXRX",$J,"MSG"," "),-1)+1
"RTN","LEXRXXS",254,0)
 . S ^TMP("LEXRX",$J,"MSG",LEXC,0)=LEXT
"RTN","LEXRXXS",255,0)
 Q
"RTN","LEXRXXS",256,0)
ADR(LEX) ; Mailing Address -G.LEXINS@FO-SLC.MED.VA.GOV,
"RTN","LEXRXXS",257,0)
 N DIC,DTOUT,DUOUT,X,Y
"RTN","LEXRXXS",258,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXS",259,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXS",260,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXRXXS",261,0)
 Q "ISC-SLC.VA.GOV"
"RTN","LEXRXXS",262,0)
FN(X) ;   Filename
"RTN","LEXRXXS",263,0)
 Q:$D(^LEX(+($G(X)),0)) $$TITLE^XLFSTR($P($G(^LEX(+($G(X)),0)),"^",1))
"RTN","LEXRXXS",264,0)
 Q:$D(^LEXT(+($G(X)),0)) $$TITLE^XLFSTR($P($G(^LEXT(+($G(X)),0)),"^",1))
"RTN","LEXRXXS",265,0)
 Q ""
"RTN","LEXRXXS",266,0)
PRG ;   Purge ^TMP("LEXRX"
"RTN","LEXRXXS",267,0)
 N LEX S LEX="" F  S LEX=$O(^TMP("LEXRX",$J,LEX)) Q:'$L(LEX)  K:LEX'="MSG" ^TMP("LEXRX",$J,LEX)
"RTN","LEXRXXS",268,0)
 Q
"RTN","LEXRXXS",269,0)
ST ;   Show ^TMP
"RTN","LEXRXXS",270,0)
 N LEXNN,LEXNC S LEXNN="^TMP(""LEXRX"","_$J_")",LEXNC="^TMP(""LEXRX"","_$J_","
"RTN","LEXRXXS",271,0)
 W !! F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN
"RTN","LEXRXXS",272,0)
 W !!
"RTN","LEXRXXS",273,0)
 Q
"RTN","LEXRXXS",274,0)
CLR ;   Clear
"RTN","LEXRXXS",275,0)
 K LEXAMSO,LEXFMT,LEXQ,LEXSUBJ,LEXTITL,LEXINS,ZTQUEUED,LEXNAM
"RTN","LEXRXXS",276,0)
 Q
"RTN","LEXRXXT")
0^23^B66601968^n/a
"RTN","LEXRXXT",1,0)
LEXRXXT ;ISL/KER - Repair/Re-Index - Task ;08/17/2011
"RTN","LEXRXXT",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXT",3,0)
 ;               
"RTN","LEXRXXT",4,0)
 ; Global Variables
"RTN","LEXRXXT",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXXT",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXXT",7,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXXT",8,0)
 ;    ^XTMP("LEXRX")      SACC 2.3.2.5.2 
"RTN","LEXRXXT",9,0)
 ;               
"RTN","LEXRXXT",10,0)
 ; External References
"RTN","LEXRXXT",11,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXRXXT",12,0)
 ;    ^%ZTLOAD            ICR  10063
"RTN","LEXRXXT",13,0)
 ;    $$FMDIFF^XLFDT      ICR  10103
"RTN","LEXRXXT",14,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXXT",15,0)
 ;               
"RTN","LEXRXXT",16,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXT",17,0)
 ;     LEXAMSO    User Selection  NEWed/KILLed by LEXRX
"RTN","LEXRXXT",18,0)
 ;     LEXFI      File number     NEWed/KILLed by LEXRX
"RTN","LEXRXXT",19,0)
 ;     LEXINS     Install Flag    NEWed/KILLed by Post-Install
"RTN","LEXRXXT",20,0)
 ;     LEXOK      Continue flag   NEWed/KILLed by LEXRX
"RTN","LEXRXXT",21,0)
 ;               
"RTN","LEXRXXT",22,0)
 Q
"RTN","LEXRXXT",23,0)
ALL ; Repair/Re-Index all Lexicon Files
"RTN","LEXRXXT",24,0)
 Q:+($G(LEXOK))'>0  Q:$G(LEXAMSO)'="A"  N X,Y,ZTQUEUED,ZTREQ,ZTSK
"RTN","LEXRXXT",25,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI,LEXU,LEXNAM
"RTN","LEXRXXT",26,0)
 N LEXC,LEXL,LEXENV,LEXTSK,LEXMSG,LEXSUBJ
"RTN","LEXRXXT",27,0)
 S LEXNAM="LEXRXALL" I $D(^XTMP(LEXNAM,0)) D PROG(LEXNAM) Q
"RTN","LEXRXXT",28,0)
 K ^TMP("LEXRX",$J) S LEXENV=$$ENV^LEXRXXM Q:+LEXENV'>0
"RTN","LEXRXXT",29,0)
 S LEXSUBJ="Lexicon - Repair/Re-Index All Files"
"RTN","LEXRXXT",30,0)
 S ZTRTN="ALLT^LEXRXXT2",ZTDESC="Lexicon Index Repair/Re-Index"
"RTN","LEXRXXT",31,0)
 S ZTIO="",ZTDTH=$H S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",32,0)
 S ZTSAVE("DUZ")="",ZTSAVE("LEXAMSO")="",ZTSAVE("LEXSUBJ")=""
"RTN","LEXRXXT",33,0)
 S LEXMSG="When the task completes a message will be sent"
"RTN","LEXRXXT",34,0)
 S LEXMSG=LEXMSG_" to you reporting the results."
"RTN","LEXRXXT",35,0)
 D ^%ZTLOAD K LEXTSK I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",36,0)
 . S LEXTSK(1)="A task has been created to repair the cross-references"
"RTN","LEXRXXT",37,0)
 . S LEXTSK(2)="in the major Lexicon files and to re-index the cross-"
"RTN","LEXRXXT",38,0)
 . S LEXTSK(3)="references of the supporting Lexicon files.  This "
"RTN","LEXRXXT",39,0)
 . S LEXTSK(4)="will take several hours, however, users may be on the "
"RTN","LEXRXXT",40,0)
 . S LEXTSK(5)="system during this time. (Task #"_+($G(ZTSK))_"). "
"RTN","LEXRXXT",41,0)
 . S:$L($G(LEXMSG)) LEXTSK(6)=LEXMSG
"RTN","LEXRXXT",42,0)
 I $O(LEXTSK(0))>0&('$D(LEXINS)) D PR^LEXRXXP(.LEXTSK,70)
"RTN","LEXRXXT",43,0)
 I '$D(LEXINS) S LEXI=0 F  S LEXI=$O(LEXTSK(LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXT",44,0)
 . S LEXC=$$TM^LEXRXXM($G(LEXTSK(LEXI))) W:'$D(LEXINS) !,"  ",LEXC
"RTN","LEXRXXT",45,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN S LEXI=0
"RTN","LEXRXXT",46,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",47,0)
 Q
"RTN","LEXRXXT",48,0)
MAJ ; Repair/Re-Index all Lookup Related Lexicon Files
"RTN","LEXRXXT",49,0)
 Q:+($G(LEXOK))'>0  Q:$G(LEXAMSO)'="M"
"RTN","LEXRXXT",50,0)
 N X,Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI
"RTN","LEXRXXT",51,0)
 N LEXU,LEXC,LEXL,LEXENV,LEXTSK,LEXMSG,LEXSUBJ,LEXNAM
"RTN","LEXRXXT",52,0)
 S LEXNAM="LEXRXMAJ" I $D(^XTMP(LEXNAM,0)) D PROG(LEXNAM) Q
"RTN","LEXRXXT",53,0)
 S LEXSUBJ="Lexicon - Repair Major Files (larger files)"
"RTN","LEXRXXT",54,0)
 K ^TMP("LEXRX",$J) S LEXENV=$$ENV^LEXRXXM Q:+LEXENV'>0
"RTN","LEXRXXT",55,0)
 S ZTRTN="MAJT^LEXRXXT2",ZTDESC="Lexicon Look-up Index Repair"
"RTN","LEXRXXT",56,0)
 S ZTIO="",ZTDTH=$H,ZTSAVE("DUZ")="",ZTSAVE("LEXAMSO")=""
"RTN","LEXRXXT",57,0)
 S ZTSAVE("LEXSUBJ")="" S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",58,0)
 S LEXMSG="When the task completes a message will be sent"
"RTN","LEXRXXT",59,0)
 S LEXMSG=LEXMSG_" to you reporting the results."
"RTN","LEXRXXT",60,0)
 D ^%ZTLOAD K LEXTSK I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",61,0)
 . S LEXTSK(1)="A task has been created to repair the "
"RTN","LEXRXXT",62,0)
 . S LEXTSK(2)="cross-references of the major files in the Lexicon "
"RTN","LEXRXXT",63,0)
 . S LEXTSK(3)="(Task #"_+($G(ZTSK))_")."
"RTN","LEXRXXT",64,0)
 . S:$L($G(LEXMSG)) LEXTSK(4)=LEXMSG
"RTN","LEXRXXT",65,0)
 I $O(LEXTSK(0))>0&('$D(LEXINS)) D PR^LEXRXXP(.LEXTSK,70)
"RTN","LEXRXXT",66,0)
 I '$D(LEXINS) S LEXI=0 F  S LEXI=$O(LEXTSK(LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXT",67,0)
 . S LEXC=$$TM^LEXRXXM($G(LEXTSK(LEXI))) W:'$D(LEXINS) !,"  ",LEXC
"RTN","LEXRXXT",68,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN S LEXI=0
"RTN","LEXRXXT",69,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",70,0)
 Q
"RTN","LEXRXXT",71,0)
SUP ; Re-Index all Supporting Lexicon Files (non-Lookup Related)
"RTN","LEXRXXT",72,0)
 Q:+($G(LEXOK))'>0  Q:$G(LEXAMSO)'="S"  N X,Y,ZTQUEUED,ZTREQ,ZTSK
"RTN","LEXRXXT",73,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI,LEXU,LEXC,LEXL,LEXENV
"RTN","LEXRXXT",74,0)
 N LEXTSK,LEXMSG,LEXSUBJ,LEXNAM
"RTN","LEXRXXT",75,0)
 S LEXNAM="LEXRXSUP" I $D(^XTMP(LEXNAM,0)) D PROG(LEXNAM) Q
"RTN","LEXRXXT",76,0)
 S LEXSUBJ="Lexicon - Re-Index Supporting Files (smaller files)"
"RTN","LEXRXXT",77,0)
 K ^TMP("LEXRX",$J) S LEXENV=$$ENV^LEXRXXM Q:+LEXENV'>0
"RTN","LEXRXXT",78,0)
 S ZTRTN="SUPT^LEXRXXT2",ZTDESC="Lexicon Look-up Index Repair"
"RTN","LEXRXXT",79,0)
 S ZTIO="",ZTDTH=$H,ZTSAVE("DUZ")="",ZTSAVE("LEXAMSO")=""
"RTN","LEXRXXT",80,0)
 S ZTSAVE("LEXSUBJ")="" S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",81,0)
 S LEXMSG="When the task completes a message will be sent"
"RTN","LEXRXXT",82,0)
 S LEXMSG=LEXMSG_" to you reporting the results."
"RTN","LEXRXXT",83,0)
 D ^%ZTLOAD K LEXTSK I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",84,0)
 . S LEXTSK(1)="A task has been created to re-index the "
"RTN","LEXRXXT",85,0)
 . S LEXTSK(2)="cross-references of the supporting files in the "
"RTN","LEXRXXT",86,0)
 . S LEXTSK(3)="Lexicon (Task #"_+($G(ZTSK))_")."
"RTN","LEXRXXT",87,0)
 . S:$L($G(LEXMSG)) LEXTSK(4)=LEXMSG
"RTN","LEXRXXT",88,0)
 I $O(LEXTSK(0))>0&('$D(LEXINS)) D PR^LEXRXXP(.LEXTSK,70)
"RTN","LEXRXXT",89,0)
 I '$D(LEXINS) S LEXI=0 F  S LEXI=$O(LEXTSK(LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXT",90,0)
 . S LEXC=$$TM^LEXRXXM($G(LEXTSK(LEXI))) W:'$D(LEXINS) !,"  ",LEXC
"RTN","LEXRXXT",91,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN S LEXI=0
"RTN","LEXRXXT",92,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",93,0)
 Q
"RTN","LEXRXXT",94,0)
ONE ; Repair/Re-Index one file X
"RTN","LEXRXXT",95,0)
 Q:+($G(LEXOK))'>0  Q:$G(LEXAMSO)'="O"  Q:'$L($G(LEXFI))
"RTN","LEXRXXT",96,0)
 S LEXFI=$G(LEXFI) Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXXT",97,0)
 N Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI,LEXU
"RTN","LEXRXXT",98,0)
 N LEXC,LEXL,LEXENV,LEXTY,LEXUTY,LEXTSK,LEXMSG,LEXFN,LEXSUBJ,LEXNAM
"RTN","LEXRXXT",99,0)
 S LEXNAM="LEXRXONE" I $D(^XTMP(LEXNAM,0)) D PROG(LEXNAM) Q
"RTN","LEXRXXT",100,0)
 S LEXENV=$$ENV^LEXRXXM Q:+LEXENV'>0  S LEXTY=""
"RTN","LEXRXXT",101,0)
 I "^757^757.001^757.01^757.02^757.1^757.21^757.33^"[("^"_LEXFI_"^") D
"RTN","LEXRXXT",102,0)
 . S LEXTY="repair",LEXUTY="Repair"
"RTN","LEXRXXT",103,0)
 S:'$L(LEXTY) LEXTY="re-index",LEXUTY="Re-Index"
"RTN","LEXRXXT",104,0)
 S LEXFN=$$FN^LEXRXXM(LEXFI)
"RTN","LEXRXXT",105,0)
 S LEXSUBJ="Lexicon - "_LEXUTY_" the "_LEXFN_" file #"_LEXFI
"RTN","LEXRXXT",106,0)
 S ZTRTN="ONET^LEXRXXT2",ZTIO="",ZTDTH=$H
"RTN","LEXRXXT",107,0)
 S ZTDESC="Lexicon Index Repair/Re-Index file "_LEXFI
"RTN","LEXRXXT",108,0)
 S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",109,0)
 S ZTSAVE("DUZ")="",ZTSAVE("LEXFI")="",ZTSAVE("LEXAMSO")=""
"RTN","LEXRXXT",110,0)
 S ZTSAVE("LEXSUBJ")="",ZTSAVE("LEXTY")="",ZTSAVE("LEXFN")=""
"RTN","LEXRXXT",111,0)
 S LEXMSG="When the task completes a message will be sent"
"RTN","LEXRXXT",112,0)
 S LEXMSG=LEXMSG_" to you reporting the results."
"RTN","LEXRXXT",113,0)
 D ^%ZTLOAD I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",114,0)
 . S LEXTSK(1)="A task has been created to "_LEXTY_" the "
"RTN","LEXRXXT",115,0)
 . S LEXTSK(2)="cross-references in "_$S($L(LEXFN):"the ",1:"Lexicon ")
"RTN","LEXRXXT",116,0)
 . S LEXTSK(3)=$S($L(LEXFN):LEXFN,1:"")_" file #"_LEXFI_" "
"RTN","LEXRXXT",117,0)
 . S LEXTSK(4)="(Task #"_+($G(ZTSK))_")."
"RTN","LEXRXXT",118,0)
 . S:$L($G(LEXMSG)) LEXTSK(5)=LEXMSG
"RTN","LEXRXXT",119,0)
 I $O(LEXTSK(0))>0&('$D(LEXINS)) D PR^LEXRXXP(.LEXTSK,70)
"RTN","LEXRXXT",120,0)
 I '$D(LEXINS) S LEXI=0 F  S LEXI=$O(LEXTSK(LEXI)) Q:+LEXI'>0  D
"RTN","LEXRXXT",121,0)
 . S LEXC=$$TM^LEXRXXM($G(LEXTSK(LEXI))) W:'$D(LEXINS) !,"  ",LEXC
"RTN","LEXRXXT",122,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN S LEXI=0
"RTN","LEXRXXT",123,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",124,0)
 Q
"RTN","LEXRXXT",125,0)
SET ; Set Logic Only
"RTN","LEXRXXT",126,0)
 Q:+($G(LEXFI))'>0  S LEXFI=+($G(LEXFI))
"RTN","LEXRXXT",127,0)
 Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXXT",128,0)
 N Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI,LEXU
"RTN","LEXRXXT",129,0)
 N LEXC,LEXL,LEXENV,LEXTY,LEXUTY,LEXTSK,LEXMSG,LEXFN,LEXSUBJ,LEXNAM
"RTN","LEXRXXT",130,0)
 N LEXQ,LEXSET S LEXNAM="LEXRXSET" S LEXENV=$$ENV^LEXRXXM Q:+LEXENV'>0
"RTN","LEXRXXT",131,0)
 S LEXQ="",ZTRTN="SET^LEXRXXT2",ZTIO="",ZTDTH=$H,LEXSET=""
"RTN","LEXRXXT",132,0)
 S ZTDESC="Re-Index file "_LEXFI_", Set Logic Only"
"RTN","LEXRXXT",133,0)
 S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",134,0)
 S ZTSAVE("DUZ")="",ZTSAVE("LEXFI")="",ZTSAVE("LEXQ")=""
"RTN","LEXRXXT",135,0)
 S ZTSAVE("LEXSET")="" D ^%ZTLOAD I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",136,0)
 . W !," Re-Index file "_LEXFI_", Set Logic Only (Task #"
"RTN","LEXRXXT",137,0)
 . W +($G(ZTSK)),")"
"RTN","LEXRXXT",138,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN
"RTN","LEXRXXT",139,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",140,0)
 Q
"RTN","LEXRXXT",141,0)
FIX ; Fix File and Execure Set Logic Only
"RTN","LEXRXXT",142,0)
 Q:+($G(LEXFI))'>0  S LEXFI=+($G(LEXFI))
"RTN","LEXRXXT",143,0)
 Q:'$D(^LEX(LEXFI))&('$D(^LEXT(LEXFI)))
"RTN","LEXRXXT",144,0)
 Q:"^757.001^757.21^757.33^"'[("^"_LEXFI_"^")
"RTN","LEXRXXT",145,0)
 N Y,ZTQUEUED,ZTREQ,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,LEXI,LEXU
"RTN","LEXRXXT",146,0)
 N LEXC,LEXL,LEXENV,LEXTY,LEXUTY,LEXTSK,LEXMSG,LEXFN,LEXSUBJ,LEXNAM
"RTN","LEXRXXT",147,0)
 N LEXQ,LEXSET,LEXFIX S LEXNAM="LEXRXFIX" S LEXENV=$$ENV^LEXRXXM
"RTN","LEXRXXT",148,0)
 Q:+LEXENV'>0  S LEXQ="",ZTRTN="FIX^LEXRXXT2",ZTIO="",ZTDTH=$H
"RTN","LEXRXXT",149,0)
 S ZTDESC="Re-Index file "_LEXFI_", Set Logic Only"
"RTN","LEXRXXT",150,0)
 S (LEXSET,LEXFIX)="" S:$D(LEXINS) ZTSAVE("LEXINS")=""
"RTN","LEXRXXT",151,0)
 S ZTSAVE("DUZ")="",ZTSAVE("LEXFI")="",ZTSAVE("LEXQ")=""
"RTN","LEXRXXT",152,0)
 S ZTSAVE("LEXNAM")="",ZTSAVE("LEXSET")="",ZTSAVE("LEXFIX")=""
"RTN","LEXRXXT",153,0)
 D ^%ZTLOAD I +($G(ZTSK))>0&('$D(LEXINS)) D
"RTN","LEXRXXT",154,0)
 . W !," Fix/Re-Index file "_LEXFI_", Set Logic Only (Task #"
"RTN","LEXRXXT",155,0)
 . W +($G(ZTSK)),")"
"RTN","LEXRXXT",156,0)
 D HOME^%ZIS K ZTDESC,ZTDTH,ZTIO,ZTRTN
"RTN","LEXRXXT",157,0)
 W:+($G(ZTSK))>0&('$D(LEXINS)) ! H:+($G(ZTSK))>0&('$D(LEXINS)) 1 K ZTSK
"RTN","LEXRXXT",158,0)
 Q
"RTN","LEXRXXT",159,0)
 ;              
"RTN","LEXRXXT",160,0)
 ; Miscellaneous
"RTN","LEXRXXT",161,0)
PROG(X) ;   Progress
"RTN","LEXRXXT",162,0)
 N LEXNAME S LEXNAM=$G(X)  Q:'$L(LEXNAM)  Q:'$D(^XTMP(LEXNAM,0))
"RTN","LEXRXXT",163,0)
 N LEXBEG,LEXBEGE,LEXBEGD,LEXUPD,LEXUPDE,LEXUPDD,LEXDES,LEXACT,LEXCUR
"RTN","LEXRXXT",164,0)
 N LEXTSK,LEXNOW,LEXND S LEXNOW=$$NOW^XLFDT,LEXND=$G(^XTMP(LEXNAM,0))
"RTN","LEXRXXT",165,0)
 S LEXBEG=$P(LEXND,"^",3),LEXDES=$P(LEXND,"^",4)
"RTN","LEXRXXT",166,0)
 S LEXTSK=$G(^XTMP(LEXNAM,1)),LEXND=$G(^XTMP(LEXNAM,2))
"RTN","LEXRXXT",167,0)
 S LEXUPD=$P(LEXND,"^",1),LEXACT=$P(LEXND,"^",2)
"RTN","LEXRXXT",168,0)
 S LEXBEGE=$$ED^LEXRXXM(LEXBEG),LEXUPDE=$$ED^LEXRXXM(LEXUPD)
"RTN","LEXRXXT",169,0)
 S LEXBEGD=$$FMDIFF^XLFDT(LEXNOW,LEXBEG,3)
"RTN","LEXRXXT",170,0)
 S LEXUPDD=$$FMDIFF^XLFDT(LEXNOW,LEXBEG,3)
"RTN","LEXRXXT",171,0)
 S:$E(LEXBEGD,1)=" "&($E(LEXBEGD,3)=":") LEXBEGD=$TR(LEXBEGD," ","0")
"RTN","LEXRXXT",172,0)
 S:$E(LEXUPDD,1)=" "&($E(LEXUPDD,3)=":") LEXUPDD=$TR(LEXUPDD," ","0")
"RTN","LEXRXXT",173,0)
 W !!," Repair/Re-Index is in progress "
"RTN","LEXRXXT",174,0)
 I $L(LEXBEGE),$L(LEXDES) W !,?4,LEXDES,?49,"Started:  ",LEXBEGE
"RTN","LEXRXXT",175,0)
 I $L(LEXUPDE),$L(LEXACT) W !,?5,LEXACT,?49,"Current:  ",LEXUPDE
"RTN","LEXRXXT",176,0)
 I $L(LEXBEGD) W !,?49,"Running:  ",LEXBEGD
"RTN","LEXRXXT",177,0)
 Q
"RTN","LEXRXXT",178,0)
CLR ;   Clear
"RTN","LEXRXXT",179,0)
 K LEXAMSO,LEXFI,LEXINS,LEXOK
"RTN","LEXRXXT",180,0)
 Q
"RTN","LEXRXXT2")
0^24^B40427433^n/a
"RTN","LEXRXXT2",1,0)
LEXRXXT2 ;ISL/KER - Repair/Re-Index - Task (cont) ;08/17/2011
"RTN","LEXRXXT2",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXT2",3,0)
 ;               
"RTN","LEXRXXT2",4,0)
 ; Global Variables
"RTN","LEXRXXT2",5,0)
 ;    ^LEX(               SACC 1.3
"RTN","LEXRXXT2",6,0)
 ;    ^LEXT(              SACC 1.3
"RTN","LEXRXXT2",7,0)
 ;    ^TMP("LEXRX")       SACC 2.3.2.5.1
"RTN","LEXRXXT2",8,0)
 ;    ^XTMP("LEXRX")      SACC 2.3.2.5.2
"RTN","LEXRXXT2",9,0)
 ;               
"RTN","LEXRXXT2",10,0)
 ; External References
"RTN","LEXRXXT2",11,0)
 ;    None
"RTN","LEXRXXT2",12,0)
 ;               
"RTN","LEXRXXT2",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXT2",14,0)
 ;     LEXFI      File number     NEWed/KILLed by LEXRX
"RTN","LEXRXXT2",15,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXXT2",16,0)
 ;     ZTREQ      Task Request    NEWed/KILLed by Taskman
"RTN","LEXRXXT2",17,0)
 ;     ZTSK       Task Number     NEWed/KILLed by Taskman
"RTN","LEXRXXT2",18,0)
 ;               
"RTN","LEXRXXT2",19,0)
 Q
"RTN","LEXRXXT2",20,0)
ALLT ; - Tasked Repair/Re-Index all Lexicon Files
"RTN","LEXRXXT2",21,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",22,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTSK,LEXSUBJ,LEXSET
"RTN","LEXRXXT2",23,0)
 S (LEXSUBJ,LEXT)="Repair/re-index all of the Lexicon files"
"RTN","LEXRXXT2",24,0)
 S LEXSET="",LEXNAM="LEXRXALL"
"RTN","LEXRXXT2",25,0)
 S LEXTC=$$UPD^LEXRXXT3(LEXNAM,LEXT) G:+LEXTC=1 ET
"RTN","LEXRXXT2",26,0)
 S LEXFMT=3,LEXTSK=0
"RTN","LEXRXXT2",27,0)
 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",28,0)
 D BEG^LEXRXXM,EN^LEXRXA,EN^LEXRXB,EN^LEXRXC,EN^LEXRXD
"RTN","LEXRXXT2",29,0)
 D EN^LEXRXE,EN^LEXRXF,EN^LEXRXG,EN^LEXRXS,END^LEXRXXM
"RTN","LEXRXXT2",30,0)
 D SEND^LEXRXXS,PRG
"RTN","LEXRXXT2",31,0)
 G ET
"RTN","LEXRXXT2",32,0)
 Q
"RTN","LEXRXXT2",33,0)
MAJT ; - Tasked Repair all Lookup Related Lexicon Files
"RTN","LEXRXXT2",34,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",35,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTSK,LEXSUBJ,LEXSET
"RTN","LEXRXXT2",36,0)
 S (LEXSUBJ,LEXT)="Repair the major Lexicon files"
"RTN","LEXRXXT2",37,0)
 S LEXSET="",LEXNAM="LEXRXMAJ"
"RTN","LEXRXXT2",38,0)
 S LEXTC=$$UPD^LEXRXXT3(LEXNAM,LEXT) G:+LEXTC=1 ET
"RTN","LEXRXXT2",39,0)
 S LEXFMT=1,LEXTSK=0
"RTN","LEXRXXT2",40,0)
 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",41,0)
 D BEG^LEXRXXM,EN^LEXRXA,EN^LEXRXB,EN^LEXRXC,EN^LEXRXD
"RTN","LEXRXXT2",42,0)
 D EN^LEXRXE,EN^LEXRXF,EN^LEXRXG,END^LEXRXXM
"RTN","LEXRXXT2",43,0)
 D SEND^LEXRXXS,PRG S LEXTC=$$UPD^LEXRXXT3(LEXNAM)
"RTN","LEXRXXT2",44,0)
 G ET
"RTN","LEXRXXT2",45,0)
 Q
"RTN","LEXRXXT2",46,0)
SUPT ; - Tasked Re-Index all Supporting Lexicon Files
"RTN","LEXRXXT2",47,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",48,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTSK,LEXSUBJ,LEXSET
"RTN","LEXRXXT2",49,0)
 S (LEXSUBJ,LEXT)="Re-indexing the supporting Lexicon files"
"RTN","LEXRXXT2",50,0)
 S LEXSET="",LEXNAM="LEXRXSUP"
"RTN","LEXRXXT2",51,0)
 S LEXTC=$$UPD^LEXRXXT3(LEXNAM,LEXT) G:+LEXTC=1 ET
"RTN","LEXRXXT2",52,0)
 S LEXFMT=2,LEXTSK=0
"RTN","LEXRXXT2",53,0)
 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",54,0)
 D BEG^LEXRXXM,EN^LEXRXS,END^LEXRXXM
"RTN","LEXRXXT2",55,0)
 D SEND^LEXRXXS,PRG S LEXTC=$$UPD^LEXRXXT3(LEXNAM)
"RTN","LEXRXXT2",56,0)
 G ET
"RTN","LEXRXXT2",57,0)
 Q
"RTN","LEXRXXT2",58,0)
ONET ; - Tasked Repair/Re-Index one file
"RTN","LEXRXXT2",59,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",60,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTY,LEXTSK,LEXFN
"RTN","LEXRXXT2",61,0)
 N LEXSUBJ,LEXSET S LEXFI=+($G(LEXFI)) G:LEXFI'>0 ET
"RTN","LEXRXXT2",62,0)
 G:$E(LEXFI,1,3)'=757 ET G:'$D(^LEX(+LEXFI))&('$D(^LEXT(+LEXFI))) ET
"RTN","LEXRXXT2",63,0)
 S LEXFN=$$FN^LEXRXXM(LEXFI) G:'$L(LEXFN) ET S LEXTY=""
"RTN","LEXRXXT2",64,0)
 S:"^757^757.001^757.01^757.02^757.1^757.21^757.33^"[("^"_LEXFI_"^") LEXTY="Repair",LEXFMT=1
"RTN","LEXRXXT2",65,0)
 S:'$L(LEXTY) LEXTY="Re-Index",LEXFMT=2
"RTN","LEXRXXT2",66,0)
 S LEXT=LEXTY,LEXT=LEXT_" the "_LEXFN_" file #"_LEXFI
"RTN","LEXRXXT2",67,0)
 S LEXSET="",LEXSUBJ=LEXT,LEXNAM="LEXRXONE"
"RTN","LEXRXXT2",68,0)
 S LEXTC=$$UPD^LEXRXXT3(LEXNAM,LEXT) G:+LEXTC=1 ET
"RTN","LEXRXXT2",69,0)
 S LEXFMT=2,LEXTSK=0 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",70,0)
 I LEXFI>0 D
"RTN","LEXRXXT2",71,0)
 . N LEXTAG,LEXENT S LEXTAG="R"_$TR(LEXFI,".","")
"RTN","LEXRXXT2",72,0)
 . S LEXENT=$T(@LEXTAG) Q:'$L(LEXENT)
"RTN","LEXRXXT2",73,0)
 . K LEXQ D BEG^LEXRXXM,@LEXTAG,END^LEXRXXM,SEND^LEXRXXS
"RTN","LEXRXXT2",74,0)
 D PRG S LEXTC=$$UPD^LEXRXXT3(LEXNAM)
"RTN","LEXRXXT2",75,0)
 G ET
"RTN","LEXRXXT2",76,0)
 Q
"RTN","LEXRXXT2",77,0)
SET ; - Tasked Set Logic Only
"RTN","LEXRXXT2",78,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",79,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTY,LEXTSK,LEXFN
"RTN","LEXRXXT2",80,0)
 N LEXSUBJ,LEXSET,LEXFIX,LEXQ S LEXQ="" S LEXFI=+($G(LEXFI)) G:LEXFI'>0 ET
"RTN","LEXRXXT2",81,0)
 G:$E(LEXFI,1,3)'=757 ET G:'$D(^LEX(+LEXFI))&('$D(^LEXT(+LEXFI))) ET
"RTN","LEXRXXT2",82,0)
 S LEXFN=$$FN^LEXRXXM(LEXFI) G:'$L(LEXFN) ET
"RTN","LEXRXXT2",83,0)
 S LEXT="Re-Index file #"_LEXFI_", Set Logic Only"
"RTN","LEXRXXT2",84,0)
 S LEXSET="",LEXSUBJ=LEXT,LEXNAM="LEXRXSET"
"RTN","LEXRXXT2",85,0)
 S LEXTSK=0 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",86,0)
 I LEXFI>0 D
"RTN","LEXRXXT2",87,0)
 . N LEXTAG,LEXENT,LEXSET
"RTN","LEXRXXT2",88,0)
 . S LEXTAG="S"_$TR(LEXFI,".",""),LEXENT=$T(@LEXTAG)
"RTN","LEXRXXT2",89,0)
 . I '$L(LEXENT) S LEXTAG="R"_$TR(LEXFI,".",""),LEXENT=$T(@LEXTAG)
"RTN","LEXRXXT2",90,0)
 . Q:'$L(LEXENT)  K LEXFIX S LEXSET="",LEXQ="" D @LEXTAG
"RTN","LEXRXXT2",91,0)
 K ^TMP("LEXRX",$J),^XTMP(LEXNAM)
"RTN","LEXRXXT2",92,0)
 G ET
"RTN","LEXRXXT2",93,0)
 Q
"RTN","LEXRXXT2",94,0)
FIX ; - Tasked Set Logic Only with Fix
"RTN","LEXRXXT2",95,0)
 K ^TMP("LEXRX",$J)
"RTN","LEXRXXT2",96,0)
 N LEXDES,LEXNAM,LEXFMT,LEXS,LEXT,LEXTC,LEXTY,LEXTSK,LEXFN
"RTN","LEXRXXT2",97,0)
 N LEXSUBJ,LEXSET,LEXFIX,LEXQ S LEXQ="" S LEXFI=+($G(LEXFI)) G:LEXFI'>0 ET
"RTN","LEXRXXT2",98,0)
 G:$E(LEXFI,1,3)'=757 ET G:'$D(^LEX(+LEXFI))&('$D(^LEXT(+LEXFI))) ET
"RTN","LEXRXXT2",99,0)
 Q:"^757.001^757.21^757.33^"'[("^"_LEXFI_"^")
"RTN","LEXRXXT2",100,0)
 S LEXFN=$$FN^LEXRXXM(LEXFI) G:'$L(LEXFN) ET
"RTN","LEXRXXT2",101,0)
 S LEXT="Fix/Re-Index file #"_LEXFI_", Set Logic Only"
"RTN","LEXRXXT2",102,0)
 S LEXSET="",LEXSUBJ=LEXT,LEXNAM="LEXRXFIX"
"RTN","LEXRXXT2",103,0)
 S LEXTSK=0 S:+($G(ZTSK))>0 LEXTSK=+ZTSK
"RTN","LEXRXXT2",104,0)
 I LEXFI>0 D
"RTN","LEXRXXT2",105,0)
 . N LEXTAG,LEXENT
"RTN","LEXRXXT2",106,0)
 . S LEXTAG="F"_$TR(LEXFI,".",""),LEXENT=$T(@LEXTAG)
"RTN","LEXRXXT2",107,0)
 . Q:'$L(LEXENT)  K LEXFIX S LEXSET="",LEXQ="" D @LEXTAG
"RTN","LEXRXXT2",108,0)
 K ^TMP("LEXRX",$J),^XTMP(LEXNAM)
"RTN","LEXRXXT2",109,0)
 G ET
"RTN","LEXRXXT2",110,0)
 Q
"RTN","LEXRXXT2",111,0)
 ;
"RTN","LEXRXXT2",112,0)
R ; Repair/Re-index
"RTN","LEXRXXT2",113,0)
R757 ;   File #757
"RTN","LEXRXXT2",114,0)
 N LEXSET S LEXSET="" K LEXQ D R757^LEXRXA Q
"RTN","LEXRXXT2",115,0)
R757001 ;   File #757.001
"RTN","LEXRXXT2",116,0)
 N LEXSET S LEXSET="" K LEXQ D R757001^LEXRXB Q
"RTN","LEXRXXT2",117,0)
R75701 ;   File #757.01
"RTN","LEXRXXT2",118,0)
 N LEXSET S LEXSET="" K LEXQ D R75701^LEXRXC Q
"RTN","LEXRXXT2",119,0)
R75702 ;   File #757.02
"RTN","LEXRXXT2",120,0)
 N LEXSET S LEXSET="" K LEXQ D R75702^LEXRXD Q
"RTN","LEXRXXT2",121,0)
R7571 ;   File #757.1
"RTN","LEXRXXT2",122,0)
 N LEXSET S LEXSET="" K LEXQ D R7571^LEXRXE Q
"RTN","LEXRXXT2",123,0)
R75721 ;   File #757.21
"RTN","LEXRXXT2",124,0)
 N LEXSET S LEXSET="" K LEXQ D R75721^LEXRXF Q
"RTN","LEXRXXT2",125,0)
R75733 ;   File #757.33
"RTN","LEXRXXT2",126,0)
 N LEXSET S LEXSET="" K LEXQ D R75733^LEXRXG Q
"RTN","LEXRXXT2",127,0)
R757011 ;   File #757.011
"RTN","LEXRXXT2",128,0)
 D R757011^LEXRXS Q
"RTN","LEXRXXT2",129,0)
R757014 ;   File #757.014
"RTN","LEXRXXT2",130,0)
 D R757014^LEXRXS Q
"RTN","LEXRXXT2",131,0)
R75703 ;   File #757.03
"RTN","LEXRXXT2",132,0)
 D R75703^LEXRXS Q
"RTN","LEXRXXT2",133,0)
R75704 ;   File #757.04
"RTN","LEXRXXT2",134,0)
 D R75704^LEXRXS Q
"RTN","LEXRXXT2",135,0)
R75705 ;   File #757.05
"RTN","LEXRXXT2",136,0)
 D R75705^LEXRXS Q
"RTN","LEXRXXT2",137,0)
R75706 ;   File #757.06
"RTN","LEXRXXT2",138,0)
 D R75706^LEXRXS Q
"RTN","LEXRXXT2",139,0)
R75711 ;   File #757.11
"RTN","LEXRXXT2",140,0)
 D R75711^LEXRXS Q
"RTN","LEXRXXT2",141,0)
R75712 ;   File #757.12
"RTN","LEXRXXT2",142,0)
 D R75712^LEXRXS Q
"RTN","LEXRXXT2",143,0)
R75713 ;   File #757.13
"RTN","LEXRXXT2",144,0)
 D R75713^LEXRXS2 Q
"RTN","LEXRXXT2",145,0)
R75714 ;   File #757.14
"RTN","LEXRXXT2",146,0)
 D R75714^LEXRXS2 Q
"RTN","LEXRXXT2",147,0)
R7573 ;   File #757.3
"RTN","LEXRXXT2",148,0)
 D R7573^LEXRXS2 Q
"RTN","LEXRXXT2",149,0)
R75731 ;   File #757.31
"RTN","LEXRXXT2",150,0)
 D R75731^LEXRXS2 Q
"RTN","LEXRXXT2",151,0)
R75732 ;   File #757.32
"RTN","LEXRXXT2",152,0)
 D R75732^LEXRXS2 Q
"RTN","LEXRXXT2",153,0)
R7574 ;   File #757.4
"RTN","LEXRXXT2",154,0)
 D R7574^LEXRXS2 Q
"RTN","LEXRXXT2",155,0)
R75741 ;   File #757.41
"RTN","LEXRXXT2",156,0)
 D R75741^LEXRXS2 Q
"RTN","LEXRXXT2",157,0)
R7572 ;   File #757.2
"RTN","LEXRXXT2",158,0)
 D R7572^LEXRXS2 Q
"RTN","LEXRXXT2",159,0)
 ;
"RTN","LEXRXXT2",160,0)
S ; Set Logic Only
"RTN","LEXRXXT2",161,0)
S757 ;   File #757
"RTN","LEXRXXT2",162,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXA Q
"RTN","LEXRXXT2",163,0)
S757001 ;   File #757.001
"RTN","LEXRXXT2",164,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXB Q
"RTN","LEXRXXT2",165,0)
S75701 ;   File #757.01
"RTN","LEXRXXT2",166,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXC Q
"RTN","LEXRXXT2",167,0)
S75702 ;   File #757.02
"RTN","LEXRXXT2",168,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXD Q
"RTN","LEXRXXT2",169,0)
S7571 ;   File #757.1
"RTN","LEXRXXT2",170,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXE Q
"RTN","LEXRXXT2",171,0)
S75721 ;   File #757.21
"RTN","LEXRXXT2",172,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXF Q
"RTN","LEXRXXT2",173,0)
S75733 ;   File #757.33
"RTN","LEXRXXT2",174,0)
 N LEXSET,LEXQ S (LEXSET,LEXQ)="" D SET^LEXRXG Q
"RTN","LEXRXXT2",175,0)
 ;
"RTN","LEXRXXT2",176,0)
F ; Repair/Re-index/Fixi
"RTN","LEXRXXT2",177,0)
F757001 ;   File #757.001
"RTN","LEXRXXT2",178,0)
 N LEXSET,LEXFIX,LEXQ S (LEXSET,LEXFIX,LEXQ)="" D SET^LEXRXB Q
"RTN","LEXRXXT2",179,0)
F75721 ;   File #757.21
"RTN","LEXRXXT2",180,0)
 N LEXSET,LEXFIX,LEXQ S (LEXSET,LEXFIX,LEXQ)="" D SET^LEXRXF Q
"RTN","LEXRXXT2",181,0)
F75733 ;   File #757.33
"RTN","LEXRXXT2",182,0)
 N LEXSET,LEXFIX,LEXQ S (LEXSET,LEXFIX,LEXQ)="" D SET^LEXRXG Q
"RTN","LEXRXXT2",183,0)
 ;              
"RTN","LEXRXXT2",184,0)
 ; Miscellaneous
"RTN","LEXRXXT2",185,0)
ET ;   End Task
"RTN","LEXRXXT2",186,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXRXXT2",187,0)
 Q
"RTN","LEXRXXT2",188,0)
PRG ;   Purge
"RTN","LEXRXXT2",189,0)
 K ^TMP("LEXRX",$J,"D"),^TMP("LEXRX",$J,"E"),^TMP("LEXRX",$J,"R",1),^TMP("LEXRX",$J,"R",2)
"RTN","LEXRXXT2",190,0)
 K ^TMP("LEXRX",$J,"T"),^TMP("LEXRX",$J,"P") K ^XTMP(LEXNAM)
"RTN","LEXRXXT2",191,0)
 Q
"RTN","LEXRXXT2",192,0)
SX(LEXNAM) ;   Show XTMP
"RTN","LEXRXXT2",193,0)
 S LEXNAM=$G(LEXNAM) Q:'$L(LEXNAM)
"RTN","LEXRXXT2",194,0)
 N LEXNN,LEXNC S LEXNN="^XTMP("""_LEXNAM_""")",LEXNC="^XTMP("""_LEXNAM_""","
"RTN","LEXRXXT2",195,0)
 F  S LEXNN=$Q(@LEXNN)  Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN
"RTN","LEXRXXT2",196,0)
 Q
"RTN","LEXRXXT2",197,0)
CLR ;   Clear
"RTN","LEXRXXT2",198,0)
 K LEXFI,ZTQUEUED,ZTREQ,ZTSK
"RTN","LEXRXXT2",199,0)
 Q
"RTN","LEXRXXT3")
0^25^B2392111^n/a
"RTN","LEXRXXT3",1,0)
LEXRXXT3 ;ISL/KER - Repair/Re-Index - Task (cont) ;08/17/2011
"RTN","LEXRXXT3",2,0)
 ;;2.0;LEXICON UTILITY;**81**;Sep 23, 1996;Build 1
"RTN","LEXRXXT3",3,0)
 ;               
"RTN","LEXRXXT3",4,0)
 ; Global Variables
"RTN","LEXRXXT3",5,0)
 ;    ^XTMP("LEXRX")      SACC 2.3.2.5.2
"RTN","LEXRXXT3",6,0)
 ;               
"RTN","LEXRXXT3",7,0)
 ; External References
"RTN","LEXRXXT3",8,0)
 ;    $$S^%ZTLOAD         ICR  10063
"RTN","LEXRXXT3",9,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXRXXT3",10,0)
 ;    $$FMADD^XLFDT       ICR  10103
"RTN","LEXRXXT3",11,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEXRXXT3",12,0)
 ;               
"RTN","LEXRXXT3",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXRXXT3",14,0)
 ;     LEXQ       Quiet flag      NEWed/KILLed by LEXRXXT2
"RTN","LEXRXXT3",15,0)
 ;     ZTQUEUED   Task flag       NEWed/KILLed by Taskman
"RTN","LEXRXXT3",16,0)
 ;     ZTSK       Task Number     NEWed/KILLed by Taskman
"RTN","LEXRXXT3",17,0)
 ;
"RTN","LEXRXXT3",18,0)
 Q
"RTN","LEXRXXT3",19,0)
UPD(X,LEXDES,LEXUPD) ; Update Task ^XTMP and ^%ZTSK
"RTN","LEXRXXT3",20,0)
 Q:$D(LEXQ) 0  N LEXNAM,LEXCRE,LEXPRG,LEXTC S LEXTC=0
"RTN","LEXRXXT3",21,0)
 S LEXNAM=$G(X),LEXDES=$G(LEXDES),LEXUPD=$G(LEXUPD)
"RTN","LEXRXXT3",22,0)
 S LEXCRE=$$DT^XLFDT,LEXPRG=$$FMADD^XLFDT(LEXCRE,1)
"RTN","LEXRXXT3",23,0)
 I $L(LEXNAM),'$L(LEXDES),'$L(LEXUPD) K ^XTMP(LEXNAM) Q 0
"RTN","LEXRXXT3",24,0)
 I $L(LEXNAM) I '$D(^XTMP(LEXNAM,0)) D
"RTN","LEXRXXT3",25,0)
 . S ^XTMP(LEXNAM,0)=LEXPRG_"^"_LEXCRE I $L(LEXDES) D
"RTN","LEXRXXT3",26,0)
 . S $P(^XTMP(LEXNAM,0),"^",3)=$$NOW^XLFDT
"RTN","LEXRXXT3",27,0)
 . S $P(^XTMP(LEXNAM,0),"^",4)=LEXDES
"RTN","LEXRXXT3",28,0)
 . S:+($G(ZTSK))>0 ^XTMP(LEXNAM,1)=+($G(ZTSK))
"RTN","LEXRXXT3",29,0)
 I $L(LEXNAM),$L(LEXUPD) I $D(^XTMP(LEXNAM,0)) D
"RTN","LEXRXXT3",30,0)
 . S ^XTMP(LEXNAM,2)=$$NOW^XLFDT_"^"_LEXUPD
"RTN","LEXRXXT3",31,0)
 I $D(ZTQUEUED) D
"RTN","LEXRXXT3",32,0)
 . S:$L(LEXDES)&('$L(LEXUPD)) LEXTC=$$S^%ZTLOAD(LEXDES)
"RTN","LEXRXXT3",33,0)
 . S:$L(LEXUPD) LEXTC=$$S^%ZTLOAD(LEXUPD)
"RTN","LEXRXXT3",34,0)
 . S:+($G(ZTSK))>0 ^XTMP(LEXNAM,1)=+($G(ZTSK))
"RTN","LEXRXXT3",35,0)
 S X=LEXTC
"RTN","LEXRXXT3",36,0)
 Q X
"RTN","LEXRXXT3",37,0)
 ;              
"RTN","LEXRXXT3",38,0)
 ; Miscellaneous
"RTN","LEXRXXT3",39,0)
CLR ;   Clear
"RTN","LEXRXXT3",40,0)
 K LEXQ,ZTQUEUED,ZTSK
"RTN","LEXRXXT3",41,0)
 Q
"RTN","LEXSRC")
0^26^B6746638^B5815442
"RTN","LEXSRC",1,0)
LEXSRC ;ISL/KER - Classification Code Source ;08/17/2011
"RTN","LEXSRC",2,0)
 ;;2.0;LEXICON UTILITY;**7,25,26,38,73,81**;Sep 23, 1996;Build 1
"RTN","LEXSRC",3,0)
 ;
"RTN","LEXSRC",4,0)
 ; External References
"RTN","LEXSRC",5,0)
 ;   None
"RTN","LEXSRC",6,0)
 ;                     
"RTN","LEXSRC",7,0)
ONE(LEXI,LEXS,LEXVDT) ; Return a single primary code of a source
"RTN","LEXSRC",8,0)
 S LEXI=+($G(LEXI)),LEXS=$G(LEXS) S LEXI=$$CODE(LEXI,LEXS,$G(LEXVDT)) Q LEXI
"RTN","LEXSRC",9,0)
ALL(LEXI,LEXS,LEXVDT) ; Return all codes of a source
"RTN","LEXSRC",10,0)
 S LEXI=+($G(LEXI)),LEXS=$G(LEXS)
"RTN","LEXSRC",11,0)
 D CODES(LEXI,LEXS,$G(LEXVDT))
"RTN","LEXSRC",12,0)
 Q
"RTN","LEXSRC",13,0)
CODE(LEXI,LEXS,LEXVDT) ; Return a single primary code
"RTN","LEXSRC",14,0)
 N LEXSRC D CODES(LEXI,LEXS,$G(LEXVDT))
"RTN","LEXSRC",15,0)
 S LEXI=$G(LEXSRC(1)) Q LEXI
"RTN","LEXSRC",16,0)
CODES(LEXI,LEXS,LEXVDT) ; Build an array LEXSRC of codes
"RTN","LEXSRC",17,0)
 S LEXI=+($G(LEXI)) Q:LEXI=0  Q:'$D(^LEX(757.01,LEXI))
"RTN","LEXSRC",18,0)
 S LEXS=$G(LEXS) Q:'$D(^LEX(757.03,"ASAB",LEXS))
"RTN","LEXSRC",19,0)
 N LEXMC S LEXMC=+($G(^LEX(757.01,LEXI,1))) Q:'$D(^LEX(757,LEXMC,0))
"RTN","LEXSRC",20,0)
 N LEXMCE S LEXMCE=+($G(^LEX(757,LEXMC,0))) Q:'$D(^LEX(757.01,LEXMCE,0))
"RTN","LEXSRC",21,0)
 N LEXUNI,LEXSA,LEXN,LEXSAB,LEXSTA,LEXPRI,LEXNOM,LEXCC,LEXX S LEXSA=0
"RTN","LEXSRC",22,0)
 F  S LEXSA=$O(^LEX(757.02,"AMC",LEXMC,LEXSA)) Q:+LEXSA=0  D
"RTN","LEXSRC",23,0)
 . N LEXLD,LEXLS,LEXSR,LEXHC,LEXHE,LEXHI,LEXHN,LEXHS,LEXN
"RTN","LEXSRC",24,0)
 . S LEXN=$G(^LEX(757.02,LEXSA,0))
"RTN","LEXSRC",25,0)
 . S LEXHC=$S(+LEXVDT>0:(LEXVDT_".99999"),1:" ")
"RTN","LEXSRC",26,0)
 . S LEXHE=$O(^LEX(757.02,+LEXSA,4,"B",LEXHC),-1) Q:+LEXHE'>0
"RTN","LEXSRC",27,0)
 . S LEXHI=$O(^LEX(757.02,+LEXSA,4,"B",+LEXHE," "),-1)
"RTN","LEXSRC",28,0)
 . S LEXHN=$G(^LEX(757.02,+LEXSA,4,+LEXHI,0)),LEXHS=$P(LEXHN,"^",2) Q:+($G(LEXHS))'>0
"RTN","LEXSRC",29,0)
 . S LEXCC=$P(LEXN,"^",2) Q:LEXCC=""  S LEXSR=$P(LEXN,"^",3) Q:+LEXSR'>0
"RTN","LEXSRC",30,0)
 . S LEXSAB=+($P(LEXN,"^",3)),LEXSAB=$E($G(^LEX(757.03,LEXSAB,0)),1,3) Q:LEXSAB'=LEXS
"RTN","LEXSRC",31,0)
 . S LEXPRI=+($P(LEXN,"^",7)),LEXCC=$P(LEXN,"^",2) Q:LEXCC=""
"RTN","LEXSRC",32,0)
 . D:LEXPRI>0 PRI(LEXCC) D:LEXPRI=0 NOM(LEXCC)
"RTN","LEXSRC",33,0)
 D COMP
"RTN","LEXSRC",34,0)
 Q
"RTN","LEXSRC",35,0)
PRI(LEXX) ; Primary Code
"RTN","LEXSRC",36,0)
 N LEXCC S LEXCC=$G(LEXX) Q:LEXCC=""  S LEXX=+($G(LEXPRI(0))),LEXX=LEXX+1
"RTN","LEXSRC",37,0)
 S LEXPRI(LEXX)=LEXCC,LEXPRI(0)=LEXX Q
"RTN","LEXSRC",38,0)
NOM(LEXX) ; Normal Code
"RTN","LEXSRC",39,0)
 N LEXCC S LEXCC=$G(LEXX) Q:LEXCC=""  S LEXX=+($G(LEXNOM(0))),LEXX=LEXX+1
"RTN","LEXSRC",40,0)
 S LEXNOM(LEXX)=LEXCC,LEXNOM(0)=LEXX Q
"RTN","LEXSRC",41,0)
COMP ; Compile array from Primary and Normal Codes
"RTN","LEXSRC",42,0)
 N LEXUNI,LEXCT,LEXNT S (LEXCT,LEXNT)=0
"RTN","LEXSRC",43,0)
 I $L($G(LEXPRI(1))) D
"RTN","LEXSRC",44,0)
 . S LEXCT=LEXCT+1,LEXSRC(LEXCT)=LEXPRI(1)
"RTN","LEXSRC",45,0)
 . S LEXSRC(0)=LEXCT,LEXUNI(LEXPRI(1))=""
"RTN","LEXSRC",46,0)
 F  S LEXNT=$O(LEXNOM(LEXNT)) Q:+LEXNT=0  D
"RTN","LEXSRC",47,0)
 . Q:$D(LEXUNI(LEXNOM(LEXNT)))
"RTN","LEXSRC",48,0)
 . I $L($G(LEXNOM(LEXNT))) D
"RTN","LEXSRC",49,0)
 . . S LEXCT=LEXCT+1,LEXSRC(LEXCT)=LEXNOM(LEXNT),LEXSRC(0)=LEXCT,LEXUNI(LEXNOM(LEXNT))=""
"RTN","LEXSRC",50,0)
 K LEXPRI,LEXNOM,LEXUNI Q
"VER")
8.0^22.0
"^DD",757.02,757.02,2,0)
CLASSIFICATION SOURCE^RP757.03'^LEX(757.03,^0;3^Q
"^DD",757.02,757.02,2,1,0)
^.1
"^DD",757.02,757.02,2,1,1,0)
757.02^ASRC^MUMPS
"^DD",757.02,757.02,2,1,1,1)
S ^LEX(757.02,"ASRC",$E(^LEX(757.03,X,0),1,3),DA)=""
"^DD",757.02,757.02,2,1,1,2)
K ^LEX(757.02,"ASRC",$E(^LEX(757.03,X,0),1,3),DA)
"^DD",757.02,757.02,2,1,1,"%D",0)
2^^5^5^2940902^
"^DD",757.02,757.02,2,1,1,"%D",1,0)
^LEX(757.02,"ASRC",SAB,IEN) - where SAB is the three chracter mnemonic of the 
"^DD",757.02,757.02,2,1,1,"%D",2,0)
Source Abbreviation (i.e., ICD, CPT, etc) from the Coding Systems file #757.03
"^DD",757.02,757.02,2,1,1,"%D",3,0)
and IEN is the Internal Entry Number where this type of code can be located.
"^DD",757.02,757.02,2,1,1,"%D",4,0)
This index is used extensively in filtering searches by type of code and used
"^DD",757.02,757.02,2,1,1,"%D",5,0)
to determin the type of code selected.
"^DD",757.02,757.02,2,1,1,"DT")
2930325
"^DD",757.02,757.02,2,1,2,0)
757.02^AVA^MUMPS
"^DD",757.02,757.02,2,1,2,1)
N SAB S SAB=$E(^LEX(757.03,X,0),1,3) S:"^ICD^10D^ICP^10P^CPT^CPC^BIR^DS4^NAN^HHC^NIC^SNM^OMA^SCC^SCT^"[SAB ^LEX(757.02,"AVA",($P(^LEX(757.02,DA,0),U,2)_" "),$P(^LEX(757.02,DA,0),U),SAB,DA)=""
"^DD",757.02,757.02,2,1,2,2)
S SAB=$E(^LEX(757.03,X,0),1,3) K ^LEX(757.02,"AVA",($P(^LEX(757.02,DA,0),U,2)_" "),$P(^LEX(757.02,DA,0),U),SAB,DA),SAB
"^DD",757.02,757.02,2,1,2,"%D",0)
^.101^6^6^3031015^^^^
"^DD",757.02,757.02,2,1,2,"%D",1,0)
^LEX(757.02,"AVA",CODE,SAB,IEN) - where CODE is the Classification Code from
"^DD",757.02,757.02,2,1,2,"%D",2,0)
field 1, SAB is the three character mnemonic for the source abbreviation in the
"^DD",757.02,757.02,2,1,2,"%D",3,0)
Coding Systems file #757.03 (i.e., ICD, CPT, etc) and IEN is the Internal Entry
"^DD",757.02,757.02,2,1,2,"%D",4,0)
Number in the Codes file #757.02 where the code is located.  This is an index
"^DD",757.02,757.02,2,1,2,"%D",5,0)
of only those codes frequently used by the VA (Source Abbreviation SAB is ICD, 
"^DD",757.02,757.02,2,1,2,"%D",6,0)
CPT, DSM, NAN, NIC, OMA, or SNM).
"^DD",757.02,757.02,2,1,2,"DT")
3031015
"^DD",757.02,757.02,2,21,0)
^^2^2^2940902^^
"^DD",757.02,757.02,2,21,1,0)
Pointer to the classification system (ICD/CPT/DSM etc) described in the
"^DD",757.02,757.02,2,21,2,0)
Coding Systems file (#757.03) from which the code (field 1) is derived.
"^DD",757.02,757.02,2,"DT")
3031015
"BLD",8149,6)
^73
**END**
**END**
