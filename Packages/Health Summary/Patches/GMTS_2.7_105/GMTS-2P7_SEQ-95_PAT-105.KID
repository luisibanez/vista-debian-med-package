Released GMTS*2.7*105 SEQ #95
Extracted from mail message
**KIDS**:GMTS*2.7*105^

**INSTALL NAME**
GMTS*2.7*105
"BLD",9117,0)
GMTS*2.7*105^HEALTH SUMMARY^0^3120710^y
"BLD",9117,1,0)
^^4^4^3120626^
"BLD",9117,1,1,0)
A subscript error occurs when editing an AD HOC report.
"BLD",9117,1,2,0)
The descriptions of two heath summary components contain spelling errors.
"BLD",9117,1,3,0)
CPRS is not displaying the correct name for nationally released health 
"BLD",9117,1,4,0)
summary reports
"BLD",9117,4,0)
^9.64PA^^
"BLD",9117,6.3)
5
"BLD",9117,"INI")
EN^GMTSP105
"BLD",9117,"INID")
^^y
"BLD",9117,"KRN",0)
^9.67PA^779.2^20
"BLD",9117,"KRN",.4,0)
.4
"BLD",9117,"KRN",.401,0)
.401
"BLD",9117,"KRN",.402,0)
.402
"BLD",9117,"KRN",.403,0)
.403
"BLD",9117,"KRN",.5,0)
.5
"BLD",9117,"KRN",.84,0)
.84
"BLD",9117,"KRN",3.6,0)
3.6
"BLD",9117,"KRN",3.8,0)
3.8
"BLD",9117,"KRN",9.2,0)
9.2
"BLD",9117,"KRN",9.8,0)
9.8
"BLD",9117,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",9117,"KRN",9.8,"NM",1,0)
GMTSADH2^^0^B26060019
"BLD",9117,"KRN",9.8,"NM",2,0)
GMTSXAB^^0^B13314711
"BLD",9117,"KRN",9.8,"NM",3,0)
GMTSP105^^0^B12584034
"BLD",9117,"KRN",9.8,"NM","B","GMTSADH2",1)

"BLD",9117,"KRN",9.8,"NM","B","GMTSP105",3)

"BLD",9117,"KRN",9.8,"NM","B","GMTSXAB",2)

"BLD",9117,"KRN",19,0)
19
"BLD",9117,"KRN",19.1,0)
19.1
"BLD",9117,"KRN",101,0)
101
"BLD",9117,"KRN",409.61,0)
409.61
"BLD",9117,"KRN",771,0)
771
"BLD",9117,"KRN",779.2,0)
779.2
"BLD",9117,"KRN",870,0)
870
"BLD",9117,"KRN",8989.51,0)
8989.51
"BLD",9117,"KRN",8989.52,0)
8989.52
"BLD",9117,"KRN",8994,0)
8994
"BLD",9117,"KRN","B",.4,.4)

"BLD",9117,"KRN","B",.401,.401)

"BLD",9117,"KRN","B",.402,.402)

"BLD",9117,"KRN","B",.403,.403)

"BLD",9117,"KRN","B",.5,.5)

"BLD",9117,"KRN","B",.84,.84)

"BLD",9117,"KRN","B",3.6,3.6)

"BLD",9117,"KRN","B",3.8,3.8)

"BLD",9117,"KRN","B",9.2,9.2)

"BLD",9117,"KRN","B",9.8,9.8)

"BLD",9117,"KRN","B",19,19)

"BLD",9117,"KRN","B",19.1,19.1)

"BLD",9117,"KRN","B",101,101)

"BLD",9117,"KRN","B",409.61,409.61)

"BLD",9117,"KRN","B",771,771)

"BLD",9117,"KRN","B",779.2,779.2)

"BLD",9117,"KRN","B",870,870)

"BLD",9117,"KRN","B",8989.51,8989.51)

"BLD",9117,"KRN","B",8989.52,8989.52)

"BLD",9117,"KRN","B",8994,8994)

"BLD",9117,"QDEF")
^^^^NO^^^^^^NO
"BLD",9117,"QUES",0)
^9.62^^
"BLD",9117,"REQB",0)
^9.611^2^2
"BLD",9117,"REQB",1,0)
GMTS*2.7*63^2
"BLD",9117,"REQB",2,0)
GMTS*2.7*66^2
"BLD",9117,"REQB","B","GMTS*2.7*63",1)

"BLD",9117,"REQB","B","GMTS*2.7*66",2)

"INI")
EN^GMTSP105
"MBREQ")
0
"PKG",229,-1)
1^1
"PKG",229,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
"PKG",229,20,0)
^9.402P^^
"PKG",229,22,0)
^9.49I^1^1
"PKG",229,22,1,0)
2.7^2951020^2960805
"PKG",229,22,1,"PAH",1,0)
105^3120710
"PKG",229,22,1,"PAH",1,1,0)
^^4^4^3120710
"PKG",229,22,1,"PAH",1,1,1,0)
A subscript error occurs when editing an AD HOC report.
"PKG",229,22,1,"PAH",1,1,2,0)
The descriptions of two heath summary components contain spelling errors.
"PKG",229,22,1,"PAH",1,1,3,0)
CPRS is not displaying the correct name for nationally released health 
"PKG",229,22,1,"PAH",1,1,4,0)
summary reports
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","GMTSADH2")
0^1^B26060019^B25995101
"RTN","GMTSADH2",1,0)
GMTSADH2 ; SLC/JER,KER - Ad Hoc Summary Driver ; 02/27/2002
"RTN","GMTSADH2",2,0)
 ;;2.7;Health Summary;**12,37,49,63,105**;Oct 20, 1995;Build 5
"RTN","GMTSADH2",3,0)
 ;                
"RTN","GMTSADH2",4,0)
 ; External Reference
"RTN","GMTSADH2",5,0)
 ;   DBIA    67  ^LAB(60,
"RTN","GMTSADH2",6,0)
 ;   DBIA  2160  ^XUTL("OR"
"RTN","GMTSADH2",7,0)
 ;   DBIA 10006  ^DIC
"RTN","GMTSADH2",8,0)
 ;   DBIA  3137  EN^ORUS
"RTN","GMTSADH2",9,0)
 ;   DBIA    67  ^LAB(60,
"RTN","GMTSADH2",10,0)
 ;   DBIA   502  ^RAMIS(71,
"RTN","GMTSADH2",11,0)
 ;   DBIA  2815  ^ICPT(
"RTN","GMTSADH2",12,0)
 ;   DBIA  3450  ^GMRD(120.51,
"RTN","GMTSADH2",13,0)
 ;   DBIA 10060  ^VA(200,
"RTN","GMTSADH2",14,0)
 ;   DBIA  3148  ^PXD(811.9,
"RTN","GMTSADH2",15,0)
 ;   DBIA  3451  ^TIU(8925.1,
"RTN","GMTSADH2",16,0)
 ;   DBIA  1268  ^AUTTHF(
"RTN","GMTSADH2",17,0)
 ;                
"RTN","GMTSADH2",18,0)
CMPLIM ; Get Limits and Selection Items
"RTN","GMTSADH2",19,0)
 N GMTSFUNC
"RTN","GMTSADH2",20,0)
 I $P(CREC,U,5)="Y" D GETOCC^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",21,0)
 I $P(CREC,U,3)="Y" D GETIME^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",22,0)
 I $P(CREC,U,10)="Y" D GETHOSP^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",23,0)
 I $P(CREC,U,11)="Y" D GETICD^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",24,0)
 I $P(CREC,U,12)="Y" D GETPROV^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",25,0)
 I $P(CREC,U,14)="Y" D GETCPTM^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",26,0)
 D GETNAME^GMTSADH4 I $D(DIROUT)!$D(DUOUT) Q
"RTN","GMTSADH2",27,0)
 N SEL I $D(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0)) S SEL=$P(^(0),U,1) I SEL D SELECT
"RTN","GMTSADH2",28,0)
 Q
"RTN","GMTSADH2",29,0)
SELECT ; Get Selection Items
"RTN","GMTSADH2",30,0)
 N GMTSF,GMTSJ,GETSLQIT,GMI,DIC,X,Y,TEMP,SELCNT
"RTN","GMTSADH2",31,0)
 S GMTSJ=$O(GMTSEG(SBS,0)),GMTSF=1
"RTN","GMTSADH2",32,0)
 I GMTSJ W !,"Default selection items are   " D SHOWDEF
"RTN","GMTSADH2",33,0)
 S SELCNT=$P(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0),U,2)
"RTN","GMTSADH2",34,0)
 W ! W:GMTSJ "Push Return at the first prompt to select default items.",!
"RTN","GMTSADH2",35,0)
 W "Select new "_$$FNAM^GMTSU(+SEL)_" items one at a time in the sequence",!,"you want them displayed. "
"RTN","GMTSADH2",36,0)
 W "You may select " I SELCNT="" W "any number of items.",!
"RTN","GMTSADH2",37,0)
 E  W "up to ",SELCNT," items.",!
"RTN","GMTSADH2",38,0)
 F GMI=1:1 D GETSEL Q:$D(DIROUT)!(Y=-1)!$S(+SELCNT:(GMI'<+SELCNT),1:0)
"RTN","GMTSADH2",39,0)
 I +SELCNT,(GMI'<+SELCNT) W !?2,$C(7),"MAXIMUM # OF ITEMS SELECTED.",!
"RTN","GMTSADH2",40,0)
 Q
"RTN","GMTSADH2",41,0)
GETSEL ; Updates GMTSEG array with Selections
"RTN","GMTSADH2",42,0)
 ;
"RTN","GMTSADH2",43,0)
 ; Using read for special processing when entering a "?".
"RTN","GMTSADH2",44,0)
 ;
"RTN","GMTSADH2",45,0)
 ; Get items from Selection Files #60, 71, 81, 120.51,
"RTN","GMTSADH2",46,0)
 ; 200, 811.9, 8925.1 and 9999999.6,
"RTN","GMTSADH2",47,0)
 ;
"RTN","GMTSADH2",48,0)
 I SEL=8925.1 W !,"Select TITLE: "
"RTN","GMTSADH2",49,0)
 E  W !,"Select "_$$FNAM^GMTSU(+SEL)_" Selection Item: "
"RTN","GMTSADH2",50,0)
 R X:DTIME
"RTN","GMTSADH2",51,0)
 I X="^^" S Y=0,DIROUT=1 Q
"RTN","GMTSADH2",52,0)
 I X="^" S Y=-1,(GETSLQIT,ASKCPQIT)="" Q
"RTN","GMTSADH2",53,0)
 I X["?" W:$O(GMTSEG(SBS,0)) !!,"Current Selection items are   " D SHOWDEF
"RTN","GMTSADH2",54,0)
 S DIC(0)="EMQ",DIC=$$FLOC^GMTSU(+SEL)
"RTN","GMTSADH2",55,0)
 I SEL=60 S DIC("S")="I $P(^(0),U,4)=""CH"",""BO""[$P(^(0),U,3)"
"RTN","GMTSADH2",56,0)
 I SEL=9999999.64 D
"RTN","GMTSADH2",57,0)
 . I $P($G(^GMT(142.1,+$P($G(GMTSEG(SBS)),U,2),0)),U,4)="GECH" D
"RTN","GMTSADH2",58,0)
 . .S DIC("S")="I (($P(^(0),U,10)=""C"")&(+$P(^(0),U,11)'=1))&($P(^(0),"" "",1)=""GEC"")"
"RTN","GMTSADH2",59,0)
 . E  D
"RTN","GMTSADH2",60,0)
 ..S DIC("S")="I +$P(^(0),U,11)'=1"
"RTN","GMTSADH2",61,0)
 ..I SEL=9999999.64 S DIC("W")="W ?47,$S($P(^(0),U,10)=""F"":""FACTOR"",$P(^(0),U,10)=""C"":""CATEGORY"")"
"RTN","GMTSADH2",62,0)
 ;I SEL=9999999.64 S DIC("S")="I +$P(^(0),U,11)'=1"
"RTN","GMTSADH2",63,0)
 ;I SEL=9999999.64 S DIC("W")="W ?47,$S($P(^(0),U,10)=""F"":""FACTOR"",$P(^(0),U,10)=""C"":""CATEGORY"")"
"RTN","GMTSADH2",64,0)
 I SEL=811.9 S DIC("S")="I +$P(^(0),U,6)'=1"
"RTN","GMTSADH2",65,0)
 I SEL=8925.1 S DIC("S")="I $P(^TIU(8925.1,+Y,0),U,4)=""DOC"",+$$ISA^TIULX(+Y,3)"
"RTN","GMTSADH2",66,0)
 D ^DIC
"RTN","GMTSADH2",67,0)
 I $D(DTOUT) S DIROUT=1
"RTN","GMTSADH2",68,0)
 I $D(DIROUT) Q
"RTN","GMTSADH2",69,0)
 I $D(DUOUT) S (GETSLQIT,ASKCPQIT)="" Q
"RTN","GMTSADH2",70,0)
 I X["?" S Y="",GMI=GMI-1 Q
"RTN","GMTSADH2",71,0)
 I X]"",Y=-1 S Y=0,GMI=GMI-1 Q  ;Continue selecting items when incorrect item entered
"RTN","GMTSADH2",72,0)
 Q:Y=-1
"RTN","GMTSADH2",73,0)
 I GMTSF&(X'="") K GMTSEG(SBS,SEL) S GMTSF=0,GMTSEG(SBS,SEL,0)=DIC
"RTN","GMTSADH2",74,0)
 I DIC="^LAB(60,",'$L($P(^LAB(60,+Y,0),U,5)) D RESOLVE(+Y,.GMTSEG,.GMI) Q
"RTN","GMTSADH2",75,0)
 S GMTSEG(SBS,SEL,GMI)=+Y
"RTN","GMTSADH2",76,0)
 Q
"RTN","GMTSADH2",77,0)
SHOWDEF ; Writes out loaded (default) selection items
"RTN","GMTSADH2",78,0)
 N GMTSN,GMTSWHL
"RTN","GMTSADH2",79,0)
 I $G(GMTSJ)']"" S GMTSJ=$O(GMTSEG(SBS,0)) I GMTSJ']"" W !!,"No SELECTION ITEMS chosen.",! Q
"RTN","GMTSADH2",80,0)
 S GMTSN=0 F GMTSWHL=1:1 S GMTSN=$O(GMTSEG(SBS,+GMTSJ,GMTSN)) Q:GMTSN=""  W:GMTSWHL>1 ! W ?30,$P(@(GMTSEG(SBS,GMTSJ,0)_GMTSEG(SBS,GMTSJ,GMTSN)_",0)"),U)
"RTN","GMTSADH2",81,0)
 Q
"RTN","GMTSADH2",82,0)
RESOLVE(GMREF,GMTSEG,GMI) ; Call ORUS to resolve compound items
"RTN","GMTSADH2",83,0)
 N SELCT,GMJ,GMHEAD,X,Y
"RTN","GMTSADH2",84,0)
 K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW")
"RTN","GMTSADH2",85,0)
 ;   This subroutine will increment the variable GMI
"RTN","GMTSADH2",86,0)
 ;   if any item are picked.  Need to decrement GMI 
"RTN","GMTSADH2",87,0)
 ;   by one (1) so it works right
"RTN","GMTSADH2",88,0)
 S GMI=GMI-1
"RTN","GMTSADH2",89,0)
 ;   Don't exceed allowed # of selection
"RTN","GMTSADH2",90,0)
 I +$G(SELCNT) S SELCT=SELCNT-GMI
"RTN","GMTSADH2",91,0)
 S GMHEAD="-- "_$P($G(^LAB(60,+GMREF,.1)),U)_" --"
"RTN","GMTSADH2",92,0)
 S ^XUTL("OR",$J,"GMTS",0)="LAB TEST^1^^0" D COMPILE(+GMREF)
"RTN","GMTSADH2",93,0)
 I $P(^XUTL("OR",$J,"GMTS",0),U,4)'>0 D  Q
"RTN","GMTSADH2",94,0)
 . K ^XUTL("OR",$J,"GMTS") W $C(7),"  INVALID TEST...Please choose another."
"RTN","GMTSADH2",95,0)
 S ORUS="^XUTL(""OR"","_$J_",""GMTS"",",ORUS(0)="40MN"_$S(+$G(SELCT):U_$S($P(^XUTL("OR",$J,"GMTS",0),U,4)'<SELCT:SELCT,1:$P(^XUTL("OR",$J,"GMTS",0),U,4)),1:""),ORUS("T")="D HEADER^GMTSADH2"
"RTN","GMTSADH2",96,0)
 S ORUS("A")="Select"_$S(+$P(ORUS(0),U,2):" 1 - "_+$P(ORUS(0),U,2),1:"")_" LAB TEST(s): "
"RTN","GMTSADH2",97,0)
 S ORUS("B")=$S(+$P(ORUS(0),U,2):"1-"_+$P(ORUS(0),U,2),1:"ALL")
"RTN","GMTSADH2",98,0)
 D EN^ORUS K ^XUTL("OR",$J,"GMTS"),^("ORU"),^("ORV"),^("ORW")
"RTN","GMTSADH2",99,0)
 Q:+Y'>0  S GMJ=0 F  S GMJ=$O(Y(GMJ)) Q:GMJ'>0  D
"RTN","GMTSADH2",100,0)
 . S GMI=GMI+1,GMTSEG(SBS,SEL,GMI)=+Y(GMJ)
"RTN","GMTSADH2",101,0)
 Q
"RTN","GMTSADH2",102,0)
COMPILE(GMTEST) ; Compile menu for ORUS call
"RTN","GMTSADH2",103,0)
 N GMC,GMI,GMJ,GMROOT
"RTN","GMTSADH2",104,0)
 S GMI=0 F  S GMI=$O(^LAB(60,GMTEST,2,GMI)) Q:GMI'>0  D
"RTN","GMTSADH2",105,0)
 . S GMJ=+$G(^LAB(60,GMTEST,2,+GMI,0))
"RTN","GMTSADH2",106,0)
 . S GMROOT=$G(^LAB(60,+GMJ,0))
"RTN","GMTSADH2",107,0)
 . I $L($P(GMROOT,U,5)),("BO"[$P(GMROOT,U,3)) D
"RTN","GMTSADH2",108,0)
 . . S GMC=+$P($G(^XUTL("OR",$J,"GMTS",0)),U,4)+1
"RTN","GMTSADH2",109,0)
 . . S ^XUTL("OR",$J,"GMTS",GMJ,0)=$P(GMROOT,U),$P(^XUTL("OR",$J,"GMTS",0),U,4)=GMC
"RTN","GMTSADH2",110,0)
 . E  D
"RTN","GMTSADH2",111,0)
 . . D COMPILE(+$G(^LAB(60,GMTEST,2,GMI,0)))
"RTN","GMTSADH2",112,0)
 Q
"RTN","GMTSADH2",113,0)
HEADER ; Write Header
"RTN","GMTSADH2",114,0)
 W !!?15,"Select the tests which you wish to include, in the",!?19,"sequence in which you wish them to appear."
"RTN","GMTSADH2",115,0)
 W !!?((80-$L(GMHEAD))\2),GMHEAD,!
"RTN","GMTSADH2",116,0)
 Q
"RTN","GMTSP105")
0^3^B12584034^n/a
"RTN","GMTSP105",1,0)
GMTSP105 ; MWA/VMP - Pre install GMTS*2.7*105 ; 6/26/12 10:09am
"RTN","GMTSP105",2,0)
 ;;2.7;Health Summary;**105**;;Build 5
"RTN","GMTSP105",3,0)
 ;
"RTN","GMTSP105",4,0)
 ;
"RTN","GMTSP105",5,0)
 Q
"RTN","GMTSP105",6,0)
EN ; main entry point
"RTN","GMTSP105",7,0)
 D BMES^XPDUTL("Starting Pre-install Routine...")
"RTN","GMTSP105",8,0)
 D CHANGE
"RTN","GMTSP105",9,0)
 D BMES^XPDUTL("Pre-install Routine Finished")
"RTN","GMTSP105",10,0)
 Q
"RTN","GMTSP105",11,0)
CHANGE ; changes descriptions
"RTN","GMTSP105",12,0)
 N CPNM,CPIEN
"RTN","GMTSP105",13,0)
 K ^TMP("GMTSP105",$J)
"RTN","GMTSP105",14,0)
 F CPNM="MHA Administration List","MHA Score" I $D(^GMT(142.1,"B",CPNM)) S CPIEN=$O(^GMT(142.1,"B",CPNM,0)) D
"RTN","GMTSP105",15,0)
 .I CPNM="MHA Administration List" D  Q
"RTN","GMTSP105",16,0)
 ..I $G(^GMT(142.1,CPIEN,3.5,1,0))="This component displays all administrations of intruments in"!($G(^GMT(142.1,CPIEN,3.5,5,0))="Date ranges and maximum occurances apply. ") D
"RTN","GMTSP105",17,0)
 ...M ^TMP("GMTSP105",$J,"WP")=^GMT(142.1,CPIEN,3.5)
"RTN","GMTSP105",18,0)
 ...S:$G(^TMP("GMTSP105",$J,"WP",1,0))="This component displays all administrations of intruments in" ^TMP("GMTSP105",$J,"WP",1,0)="This component displays all administrations of instruments in"
"RTN","GMTSP105",19,0)
 ...S:$G(^TMP("GMTSP105",$J,"WP",5,0))="Date ranges and maximum occurances apply. " ^TMP("GMTSP105",$J,"WP",5,0)="Date ranges and maximum occurrences apply."
"RTN","GMTSP105",20,0)
 ...D DIECALL(142.1,CPIEN_",",3.5,"","^TMP(""GMTSP105"",$J,""WP"")")
"RTN","GMTSP105",21,0)
 .I CPNM="MHA Score" D
"RTN","GMTSP105",22,0)
 ..I $G(^GMT(142.1,CPIEN,3.5,2,0))="intruments in the mental health package. Tests, interviews and surveys from MH"!($G(^GMT(142.1,CPIEN,3.5,5,0))="Date ranges and maximum occurances apply.") D
"RTN","GMTSP105",23,0)
 ...M ^TMP("GMTSP105",$J,"WP")=^GMT(142.1,CPIEN,3.5)
"RTN","GMTSP105",24,0)
 ...S:$G(^TMP("GMTSP105",$J,"WP",2,0))="intruments in the mental health package. Tests, interviews and surveys from MH" ^TMP("GMTSP105",$J,"WP",2,0)="instruments in the mental health package. Tests, interviews and surveys from MH"
"RTN","GMTSP105",25,0)
 ...S:$G(^TMP("GMTSP105",$J,"WP",5,0))="Date ranges and maximum occurances apply." ^TMP("GMTSP105",$J,"WP",5,0)="Date ranges and maximum occurrences apply."
"RTN","GMTSP105",26,0)
 ...D DIECALL(142.1,CPIEN_",",3.5,"","^TMP(""GMTSP105"",$J,""WP"")")
"RTN","GMTSP105",27,0)
 Q
"RTN","GMTSP105",28,0)
DIECALL(FILE,IENS,FIELD,FLAGS,ROOT) ; FILEMAN CALL
"RTN","GMTSP105",29,0)
 D WP^DIE(FILE,IENS,FIELD,FLAGS,ROOT)
"RTN","GMTSP105",30,0)
 K ^TMP("GMTSP105",$J)
"RTN","GMTSP105",31,0)
 Q
"RTN","GMTSXAB")
0^2^B13314711^B13076076
"RTN","GMTSXAB",1,0)
GMTSXAB ; SLC/KER - List Parameters/Build List            ; 01/06/2003
"RTN","GMTSXAB",2,0)
 ;;2.7;Health Summary;**47,49,58,66,105**;Oct 20, 1995;Build 5
"RTN","GMTSXAB",3,0)
 Q
"RTN","GMTSXAB",4,0)
 ;                                 
"RTN","GMTSXAB",5,0)
 ; External References
"RTN","GMTSXAB",6,0)
 ;                                 
"RTN","GMTSXAB",7,0)
 ;   None
"RTN","GMTSXAB",8,0)
 ;                                    
"RTN","GMTSXAB",9,0)
 ; This routine expects:
"RTN","GMTSXAB",10,0)
 ;                                 
"RTN","GMTSXAB",11,0)
 ;   GMTSCPL    Compile Method   1 = Append  0 = Overwrite
"RTN","GMTSXAB",12,0)
 ;   GMTSPRE    Precedence       i.e., USR;SYS;NAT
"RTN","GMTSXAB",13,0)
 ;   ^TMP($J,"GMTSTYP",   List             Input Array
"RTN","GMTSXAB",14,0)
 ;   ROOT(     List             Output Array
"RTN","GMTSXAB",15,0)
 ;                            
"RTN","GMTSXAB",16,0)
BUILD ; Build list of User/System Parameters and National Types
"RTN","GMTSXAB",17,0)
 N GMTSC,GMTSOK,GMTSI,GMTSID,GMTSE,GMTSEI,GMTSV,GMTSVI,GMTSVN,GMTSAT,GMTSOVR
"RTN","GMTSXAB",18,0)
 S GMTSOVR=$S(+($G(GMTSCPL))'>0:1,1:0),GMTSOK=0
"RTN","GMTSXAB",19,0)
 S GMTSC=+($O(@ROOT@(" "),-1))
"RTN","GMTSXAB",20,0)
 F GMTSEI=1:1 Q:$P($G(GMTSPRE),";",GMTSEI)=""  S GMTSE=$P($G(GMTSPRE),";",GMTSEI) D
"RTN","GMTSXAB",21,0)
 . Q:'$L(GMTSE)  I GMTSE="NAT" D NAT Q
"RTN","GMTSXAB",22,0)
 . Q:+GMTSOK>0  S GMTSID="" D ADH,ENT
"RTN","GMTSXAB",23,0)
 Q
"RTN","GMTSXAB",24,0)
NAT ;   Add National Health Summary Types to the List
"RTN","GMTSXAB",25,0)
 Q:+($G(GMTSCPL))>1  N GMTSC,GMTSI,GMTSID,GMTSVI,GMTSVN,GMTSV
"RTN","GMTSXAB",26,0)
 S GMTSI=0,GMTSID=""
"RTN","GMTSXAB",27,0)
 S GMTSC=+($O(@ROOT@(" "),-1))
"RTN","GMTSXAB",28,0)
 F  S GMTSID=$O(^TMP($J,"GMTSTYP","NAT","B",GMTSID)) Q:GMTSID=""  D
"RTN","GMTSXAB",29,0)
 . S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSTYP","NAT","B",GMTSID,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",30,0)
 . . S GMTSV=$$VAL($G(^TMP($J,"GMTSTYP","NAT",GMTSI)))
"RTN","GMTSXAB",31,0)
 . . Q:'$L(GMTSV)  Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",32,0)
 . . Q:$D(@ROOT@("B",GMTSV))
"RTN","GMTSXAB",33,0)
 . . S GMTSC=GMTSC+1
"RTN","GMTSXAB",34,0)
 . . S @ROOT@(GMTSC)=GMTSV,@ROOT@("B",GMTSV,GMTSC)=""
"RTN","GMTSXAB",35,0)
 . . S @ROOT@("C",GMTSC)="NAT"
"RTN","GMTSXAB",36,0)
 K ^TMP($J,"GMTSTYP","NAT")
"RTN","GMTSXAB",37,0)
 Q
"RTN","GMTSXAB",38,0)
ADH ;   Add Adhoc Health Summary Types to the List
"RTN","GMTSXAB",39,0)
 N GMTSC S GMTSC=+($O(@ROOT@(" "),-1)) F GMTSAT="ADH","RAD" S GMTSI=0 D
"RTN","GMTSXAB",40,0)
 . F  S GMTSI=$O(^TMP($J,"GMTSTYP",GMTSE,GMTSAT,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",41,0)
 . . S GMTSV=$$VAL($G(^TMP($J,"GMTSTYP",GMTSE,GMTSAT,GMTSI))) Q:'$L(GMTSV)
"RTN","GMTSXAB",42,0)
 . . Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",43,0)
 . . Q:$D(@ROOT@("B",GMTSV))  S GMTSC=GMTSC+1,@ROOT@(GMTSC)=GMTSV,@ROOT@("B",GMTSV,GMTSC)="",@ROOT@("C",GMTSC)=$G(GMTSE)
"RTN","GMTSXAB",44,0)
 Q
"RTN","GMTSXAB",45,0)
ENT ;   Add Entity Parameters (System/User) to the List
"RTN","GMTSXAB",46,0)
 N GMTSC S GMTSC=+($O(@ROOT@(" "),-1)) F  S GMTSID=$O(^TMP($J,"GMTSTYP",GMTSE,"B",GMTSID)) Q:GMTSID=""  D
"RTN","GMTSXAB",47,0)
 . Q:'$L(GMTSID)  S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSTYP",GMTSE,"B",GMTSID,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",48,0)
 . . S GMTSV=$$VAL($G(^TMP($J,"GMTSTYP",GMTSE,GMTSI))) Q:'$L(GMTSV)  Q:+GMTSV=0
"RTN","GMTSXAB",49,0)
 . . Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))  K:$D(@ROOT@("B",GMTSV)) ^TMP($J,"GMTSTYP",GMTSE,GMTSI)
"RTN","GMTSXAB",50,0)
 S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSTYP",GMTSE,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXAB",51,0)
 . S GMTSV=$$VAL($G(^TMP($J,"GMTSTYP",GMTSE,GMTSI))) Q:'$L(GMTSV)
"RTN","GMTSXAB",52,0)
 . Q:+GMTSV=0  Q:'$L($$TRIM^GMTSXA($P(GMTSV,"^",2)," "))
"RTN","GMTSXAB",53,0)
 . Q:$D(@ROOT@("B",GMTSV))
"RTN","GMTSXAB",54,0)
 . S GMTSC=GMTSC+1,@ROOT@(GMTSC)=GMTSV,@ROOT@("B",GMTSV,GMTSC)="",@ROOT@("C",GMTSC)=$G(GMTSE)
"RTN","GMTSXAB",55,0)
 . S:+($G(GMTSOVR))>0 GMTSOK=1
"RTN","GMTSXAB",56,0)
 S:+($G(GMTSOVR))>0&($D(@ROOT@("B"))) GMTSOK=1
"RTN","GMTSXAB",57,0)
 K ^TMP($J,"GMTSTYP",GMTSE)
"RTN","GMTSXAB",58,0)
 Q
"RTN","GMTSXAB",59,0)
VAL(GMTSV) ; Value
"RTN","GMTSXAB",60,0)
 S GMTSV=$G(GMTSV) N GMTST,GMTSI,GMTSVA,GMTSN,GMTSAD,GMTSNM S GMTSI=+GMTSV Q:+GMTSI=0 GMTSV
"RTN","GMTSXAB",61,0)
 S GMTST=$G(^GMT(142,+GMTSI,"T")),GMTSNM=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSXAB",62,0)
 S GMTSVA=+($G(^GMT(142,+GMTSI,"VA"))) I +GMTSVA>0,$L(GMTSNM) S GMTSV=+GMTSI_"^"_$S($L(GMTST):GMTST,1:GMTSNM) Q GMTSV
"RTN","GMTSXAB",63,0)
 S GMTSN=$P(GMTSV,"^",2) S:$L(GMTST) GMTSN=GMTST
"RTN","GMTSXAB",64,0)
 S GMTSV=+GMTSI_"^"_GMTSN,GMTSAD=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSXAB",65,0)
 S:GMTSAD="GMTS HS ADHOC OPTION" GMTSV=+GMTSI_"^"_GMTSAD
"RTN","GMTSXAB",66,0)
 Q GMTSV
"RTN","GMTSXAB",67,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"VER")
8.0^22.0
"BLD",9117,6)
^95
**END**
**END**
