Released EN*7*92 SEQ #88
Extracted from mail message
**KIDS**:EN*7.0*92^

**INSTALL NAME**
EN*7.0*92
"BLD",9223,0)
EN*7.0*92^ENGINEERING^0^3130415^y
"BLD",9223,1,0)
^^3^3^3130415^
"BLD",9223,1,1,0)
Patch EN*7.0*92 adds 1 new code to the NON-EXPENDABLE EQUIPMENT BUDGET 
"BLD",9223,1,2,0)
OBJECT CODES (NX BOC) (#6914.4) file and and re-names code 1524 to 1995 
"BLD",9223,1,3,0)
in the NON-EXPENDABLE STANDARD GENERAL LEDGER (NX SGL)(#6914.3).
"BLD",9223,4,0)
^9.64PA^6915.5^1
"BLD",9223,4,6915.5,0)
6915.5
"BLD",9223,4,6915.5,2,0)
^9.641^6915.5^1
"BLD",9223,4,6915.5,2,6915.5,0)
FD DOCUMENT LOG  (File-top level)
"BLD",9223,4,6915.5,2,6915.5,1,0)
^9.6411^104^1
"BLD",9223,4,6915.5,2,6915.5,1,104,0)
FAIR MARKET VALUE
"BLD",9223,4,6915.5,222)
y^y^p^^^^n^^n
"BLD",9223,4,6915.5,224)

"BLD",9223,4,"APDD",6915.5,6915.5)

"BLD",9223,4,"APDD",6915.5,6915.5,104)

"BLD",9223,4,"B",6915.5,6915.5)

"BLD",9223,6.3)
10
"BLD",9223,"ABPKG")
n
"BLD",9223,"INID")
^n
"BLD",9223,"INIT")
START^ENX1P92
"BLD",9223,"KRN",0)
^9.67PA^779.2^20
"BLD",9223,"KRN",.4,0)
.4
"BLD",9223,"KRN",.401,0)
.401
"BLD",9223,"KRN",.402,0)
.402
"BLD",9223,"KRN",.403,0)
.403
"BLD",9223,"KRN",.5,0)
.5
"BLD",9223,"KRN",.84,0)
.84
"BLD",9223,"KRN",3.6,0)
3.6
"BLD",9223,"KRN",3.8,0)
3.8
"BLD",9223,"KRN",9.2,0)
9.2
"BLD",9223,"KRN",9.8,0)
9.8
"BLD",9223,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",9223,"KRN",9.8,"NM",1,0)
ENX1P92^^0^B5277574
"BLD",9223,"KRN",9.8,"NM",2,0)
ENFAR7^^0^B11449754
"BLD",9223,"KRN",9.8,"NM",3,0)
ENFADEL^^0^B33426149
"BLD",9223,"KRN",9.8,"NM","B","ENFADEL",3)

"BLD",9223,"KRN",9.8,"NM","B","ENFAR7",2)

"BLD",9223,"KRN",9.8,"NM","B","ENX1P92",1)

"BLD",9223,"KRN",19,0)
19
"BLD",9223,"KRN",19.1,0)
19.1
"BLD",9223,"KRN",101,0)
101
"BLD",9223,"KRN",409.61,0)
409.61
"BLD",9223,"KRN",771,0)
771
"BLD",9223,"KRN",779.2,0)
779.2
"BLD",9223,"KRN",870,0)
870
"BLD",9223,"KRN",8989.51,0)
8989.51
"BLD",9223,"KRN",8989.52,0)
8989.52
"BLD",9223,"KRN",8994,0)
8994
"BLD",9223,"KRN","B",.4,.4)

"BLD",9223,"KRN","B",.401,.401)

"BLD",9223,"KRN","B",.402,.402)

"BLD",9223,"KRN","B",.403,.403)

"BLD",9223,"KRN","B",.5,.5)

"BLD",9223,"KRN","B",.84,.84)

"BLD",9223,"KRN","B",3.6,3.6)

"BLD",9223,"KRN","B",3.8,3.8)

"BLD",9223,"KRN","B",9.2,9.2)

"BLD",9223,"KRN","B",9.8,9.8)

"BLD",9223,"KRN","B",19,19)

"BLD",9223,"KRN","B",19.1,19.1)

"BLD",9223,"KRN","B",101,101)

"BLD",9223,"KRN","B",409.61,409.61)

"BLD",9223,"KRN","B",771,771)

"BLD",9223,"KRN","B",779.2,779.2)

"BLD",9223,"KRN","B",870,870)

"BLD",9223,"KRN","B",8989.51,8989.51)

"BLD",9223,"KRN","B",8989.52,8989.52)

"BLD",9223,"KRN","B",8994,8994)

"BLD",9223,"QDEF")
^^^^NO^^^^^^YES
"BLD",9223,"QUES",0)
^9.62^^
"BLD",9223,"REQB",0)
^9.611^1^1
"BLD",9223,"REQB",1,0)
EN*7.0*48^2
"BLD",9223,"REQB","B","EN*7.0*48",1)

"FIA",6915.5)
FD DOCUMENT LOG
"FIA",6915.5,0)
^ENG(6915.5,
"FIA",6915.5,0,0)
6915.5PI
"FIA",6915.5,0,1)
y^y^p^^^^n^^n
"FIA",6915.5,0,10)

"FIA",6915.5,0,11)

"FIA",6915.5,0,"RLRO")

"FIA",6915.5,0,"VR")
7.0^EN
"FIA",6915.5,6915.5)
1
"FIA",6915.5,6915.5,104)

"INIT")
START^ENX1P92
"MBREQ")
0
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
92^3130415
"PKG",33,22,1,"PAH",1,1,0)
^^3^3^3130415
"PKG",33,22,1,"PAH",1,1,1,0)
Patch EN*7.0*92 adds 1 new code to the NON-EXPENDABLE EQUIPMENT BUDGET 
"PKG",33,22,1,"PAH",1,1,2,0)
OBJECT CODES (NX BOC) (#6914.4) file and and re-names code 1524 to 1995 
"PKG",33,22,1,"PAH",1,1,3,0)
in the NON-EXPENDABLE STANDARD GENERAL LEDGER (NX SGL)(#6914.3).
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ENFADEL")
0^3^B33426149^B33058574
"RTN","ENFADEL",1,0)
ENFADEL ;WASHINGTON IRMFO/KLD/DH/SAB; Equipment Disposition ; 4/15/13 11:52am
"RTN","ENFADEL",2,0)
 ;;7.0;ENGINEERING;**29,33,38,39,46,92**;Aug 17, 1993;Build 10
"RTN","ENFADEL",3,0)
 ;This routine should not be modified.
"RTN","ENFADEL",4,0)
 ;patch 92 renamed gl 1524 to 1995
"RTN","ENFADEL",5,0)
ST D GETEQ^ENUTL G K:Y'>0
"RTN","ENFADEL",6,0)
 S (DA,ENEQ("DA"))=+Y
"RTN","ENFADEL",7,0)
 L +^ENG(6914,DA):5 I '$T W !!,$C(7),"Another user is editing this Equipment Record. Please try again later." G K
"RTN","ENFADEL",8,0)
 I '$D(^ENG(6915.2,"B",DA)) D  G K
"RTN","ENFADEL",9,0)
 . W $C(7),!,"There is no FA document on file for this asset. No action taken."
"RTN","ENFADEL",10,0)
 I $D(^ENG(6915.5,"B",DA)) S X=$$CHKFA^ENFAUTL(DA) I +X=0 D  G K
"RTN","ENFADEL",11,0)
 . S Y=$P(X,U,3) D DD^%DT
"RTN","ENFADEL",12,0)
 . W $C(7),!,"An FD document for ENTRY #",DA," was processed on ",Y,"."
"RTN","ENFADEL",13,0)
 . W !,"No action taken."
"RTN","ENFADEL",14,0)
 F I=2,8,9 S ENEQ(I)=$G(^ENG(6914,ENEQ("DA"),I))
"RTN","ENFADEL",15,0)
 S DIC="^ENG(6915.5,",DIC(0)="L",DLAYGO=6915.5
"RTN","ENFADEL",16,0)
 S X=ENEQ("DA"),DIC("DR")="1///NOW;1.5////^S X=DUZ"
"RTN","ENFADEL",17,0)
 K DD,DO D FILE^DICN K DLAYGO
"RTN","ENFADEL",18,0)
 S ENFD("DA")=+Y
"RTN","ENFADEL",19,0)
 L +^ENG(6915.5,ENFD("DA")):0 I '$T W !!,$C(7),"Another user is editing the FD document that you just created.",!,"Please notify your ADPAC." L -^ENG(6914,ENEQ("DA")) G K
"RTN","ENFADEL",20,0)
 ; ask type of FD
"RTN","ENFADEL",21,0)
 S DIE="^ENG(6915.5,",DA=ENFD("DA"),DR="100"
"RTN","ENFADEL",22,0)
 D ^DIE I $D(Y)!$D(DTOUT) D  G EXIT
"RTN","ENFADEL",23,0)
 . W !!,$C(7),"The type of FD Document is required. No action taken."
"RTN","ENFADEL",24,0)
 . S DIK=DIE D ^DIK K DIK
"RTN","ENFADEL",25,0)
 S ENFD("TYPE")=$P($G(^ENG(6915.5,ENFD("DA"),100)),U)
"RTN","ENFADEL",26,0)
 I ENFD("TYPE")="T",$$GET1^DIQ(6914,ENEQ("DA"),38)="1995" D  I 'Y W !!,"No action taken." S DIK=DIE D ^DIK K DIK G EXIT
"RTN","ENFADEL",27,0)
 . W !,"This equipment item is already on SGL 1995 (Excess)."
"RTN","ENFADEL",28,0)
 . S DIR(0)="Y",DIR("A")="Are you sure you want to process a Turn-In"
"RTN","ENFADEL",29,0)
 . S DIR("B")="NO" D ^DIR K DIR
"RTN","ENFADEL",30,0)
DIE ;Enter data for FD DOC
"RTN","ENFADEL",31,0)
 S DIE="^ENG(6915.5,",DIE("NO^")="BACKOUTOK"
"RTN","ENFADEL",32,0)
 S DA=ENFD("DA"),DR="[ENFA DELETE-"_ENFD("TYPE")_"]"
"RTN","ENFADEL",33,0)
 W ! D ^DIE I $D(Y)!($D(DTOUT)) D  G EXIT
"RTN","ENFADEL",34,0)
 . W !!,$C(7),"This FD document is incomplete and is being deleted..."
"RTN","ENFADEL",35,0)
 . S DIK=DIE D ^DIK K DIK
"RTN","ENFADEL",36,0)
 I ENFD("TYPE")="T" D  I $D(Y)!($D(DTOUT)) G EXIT
"RTN","ENFADEL",37,0)
 . ; ask fair market value at turn-in
"RTN","ENFADEL",38,0)
 . W !!,"When equipment is turned-in, its TOTAL ASSET VALUE must be"
"RTN","ENFADEL",39,0)
 . W !,"changed to the fair market value per VA Accounting Standards."
"RTN","ENFADEL",40,0)
 . W !,"NOTE: The current TOTAL ASSET VALUE will automatically be saved"
"RTN","ENFADEL",41,0)
 . W !,"in the ORIGINAL ASSET VALUE field."
"RTN","ENFADEL",42,0)
 . ; compute repair costs (exclude PM)
"RTN","ENFADEL",43,0)
 . S (ENT,ENT("L"),ENT("M"),ENT("V"))=0
"RTN","ENFADEL",44,0)
 . S ENI=0 F  S ENI=$O(^ENG(6914,ENEQ("DA"),6,ENI)) Q:'ENI  D
"RTN","ENFADEL",45,0)
 . . S ENY=$G(^ENG(6914,ENEQ("DA"),6,ENI,0))
"RTN","ENFADEL",46,0)
 . . Q:$E($P(ENY,U,2),1,3)="PM-"  ; exclude PM
"RTN","ENFADEL",47,0)
 . . S ENT("L")=ENT("L")+$P(ENY,U,5)
"RTN","ENFADEL",48,0)
 . . S ENT("M")=ENT("M")+$P(ENY,U,6)
"RTN","ENFADEL",49,0)
 . . S ENT("V")=ENT("V")+$P(ENY,U,7)
"RTN","ENFADEL",50,0)
 . S ENT=ENT("L")+ENT("M")+ENT("V")
"RTN","ENFADEL",51,0)
 . ; display info to assist determination of fair market value
"RTN","ENFADEL",52,0)
 . W !!,"Current TOTAL ASSET VALUE: ",$FN($P(ENEQ(2),U,3),",",2)
"RTN","ENFADEL",53,0)
 . W !,"Acquisition Date: ",$$FMTE^XLFDT($P(ENEQ(2),U,4)),"   Life Expectancy: ",$P(ENEQ(2),U,6)
"RTN","ENFADEL",54,0)
 . W !,"Replacement Date: ",$$FMTE^XLFDT($P(ENEQ(2),U,10))
"RTN","ENFADEL",55,0)
 . W "   Condition: ",$$GET1^DIQ(6914,ENEQ("DA"),53)
"RTN","ENFADEL",56,0)
 . W !,"Repair Costs (excluding preventive maintenance)"
"RTN","ENFADEL",57,0)
 . W !,"   Labor$ :",$FN(ENT("L"),",",0),"   Material$: ",$FN(ENT("M"),",",0),"   Vendor$: ",$FN(ENT("V"),",",0),"   Total$: ",$FN(ENT,",",0),!
"RTN","ENFADEL",58,0)
 . K ENT
"RTN","ENFADEL",59,0)
 . S DIE="^ENG(6915.5,",DA=ENFD("DA"),DR="104R"
"RTN","ENFADEL",60,0)
 . D ^DIE I $D(Y)!($D(DTOUT)) D
"RTN","ENFADEL",61,0)
 . . W !!,$C(7),"Fair Market Value unspecified. This FD document is being deleted..."
"RTN","ENFADEL",62,0)
 . . S DIK=DIE D ^DIK K DIK
"RTN","ENFADEL",63,0)
 S ENFAP("DOC")="FD"
"RTN","ENFADEL",64,0)
 S ENFAP(0)=$G(^ENG(6915.5,DA,0)),ENFAP(5)=$G(^(5)),ENFAP(100)=$G(^(100))
"RTN","ENFADEL",65,0)
 I $P(ENFAP(5),U,8)="" S $P(ENFAP(5),U,8)="0.00"
"RTN","ENFADEL",66,0)
 I $P(ENFAP(100),U,4)="" S $P(ENFAP(100),U,4)=7
"RTN","ENFADEL",67,0)
 S $P(^ENG(6915.5,ENFD("DA"),100),U,2)=$$GET1^DIQ(6914,ENEQ("DA"),12)
"RTN","ENFADEL",68,0)
 S X=$P(ENFAP(100),U,3) I X]"" S $P(ENFAP(5),U,5)=$E(X,1,3)+1700,$P(ENFAP(5),U,6)=$E(X,4,5),$P(ENFAP(5),U,7)=$E(X,6,7)
"RTN","ENFADEL",69,0)
 S X=$P(ENFAP(100),U,4) S:X $P(ENFAP(5),U,4)=$$GET1^DIQ(6914.8,X,.01)
"RTN","ENFADEL",70,0)
 S ^ENG(6915.5,ENFD("DA"),5)=ENFAP(5)
"RTN","ENFADEL",71,0)
 K ^TMP($J) D ^ENFAVAL
"RTN","ENFADEL",72,0)
 I $D(^TMP($J)) D LISTP^ENFAXMTM D  G DIE:"Yy"[X,EXIT
"RTN","ENFADEL",73,0)
 .R !!,"Re-edit this disposition?  Y// ",X:DTIME S:'$T X=U Q:"Yy"[X
"RTN","ENFADEL",74,0)
 .W !,"Sorry, I must then delete this FD document!"
"RTN","ENFADEL",75,0)
 .S DIK=DIE,DA=ENFD("DA") D ^DIK W " ...deleted" S X=U
"RTN","ENFADEL",76,0)
 S ENAV=$$AVP^ENFAAV("6915.5",ENFD("DA"))
"RTN","ENFADEL",77,0)
 I 'ENAV W !,"Adjustment voucher was NOT created." I $G(ENUT) S DIK=DIE D ^DIK W !,"No action taken. Database unchanged." K DIR G EXIT
"RTN","ENFADEL",78,0)
 S DIR(0)="Y",DIR("A")="Sure you want to process this disposition",DIR("B")="YES"
"RTN","ENFADEL",79,0)
 D ^DIR I 'Y!($D(DIRUT)) S DIK=DIE D ^DIK W "...data base unchanged." K DIR G EXIT
"RTN","ENFADEL",80,0)
EQ ; update
"RTN","ENFADEL",81,0)
 ;update FAP Balance
"RTN","ENFADEL",82,0)
 D ADJBAL^ENFABAL($P(ENEQ(9),U,5),$P(ENEQ(9),U,7),$P(ENEQ(8),U,6),$P($P(ENFAP(0),U,2),"."),-$P(ENEQ(2),U,3))
"RTN","ENFADEL",83,0)
 W !!,"Updating the Equipment File..."
"RTN","ENFADEL",84,0)
 S DA=ENEQ("DA"),DIE="^ENG(6914," K DIC
"RTN","ENFADEL",85,0)
 S DR="31////"_$P(ENFAP(100),U,4)_";32////"_$P(ENFAP(5),U,8) D ^DIE
"RTN","ENFADEL",86,0)
 S DR="20////4;19////@;38////@" D ^DIE
"RTN","ENFADEL",87,0)
 I ENFD("TYPE")="T" D
"RTN","ENFADEL",88,0)
 . I $P(^ENG(6914,DA,3),U,15)'>0 S $P(^(3),U,15)=$P(ENEQ(2),U,3) ; orig.$
"RTN","ENFADEL",89,0)
 . S DR="20.5////"_$P(ENFAP(100),U,3)
"RTN","ENFADEL",90,0)
 . S DR=DR_";12////"_$$DEC^ENFAUTL($P(ENFAP(100),U,5))
"RTN","ENFADEL",91,0)
 . D ^DIE
"RTN","ENFADEL",92,0)
 I ENFD("TYPE")="D" S DR="22////"_$P(ENFAP(100),U,3) D ^DIE
"RTN","ENFADEL",93,0)
 W !!,"Sending FD document to FAP." D ^ENFAXMT
"RTN","ENFADEL",94,0)
 I $G(ENAV) D
"RTN","ENFADEL",95,0)
 . S DIE="^ENG(6915.5,",DR="301///NOW",DA=ENFD("DA") D ^DIE
"RTN","ENFADEL",96,0)
 . W !,"Adjustment Voucher was created.",!
"RTN","ENFADEL",97,0)
 I ENFD("TYPE")="T" D
"RTN","ENFADEL",98,0)
 . W !!,"Editing Equipment Data"
"RTN","ENFADEL",99,0)
 . S DA=ENEQ("DA"),DIE="^ENG(6914,"
"RTN","ENFADEL",100,0)
 . S DR="20;19//996;38//1995"
"RTN","ENFADEL",101,0)
 . D ^DIE Q:$D(DTOUT)
"RTN","ENFADEL",102,0)
 . Q:$$GET1^DIQ(6914,ENEQ("DA"),38)'=1995
"RTN","ENFADEL",103,0)
 . S DIR(0)="Y",DIR("A")="Should a FA Document also be sent"
"RTN","ENFADEL",104,0)
 . S DIR("?",1)="The FD Document removed the asset from Fixed Assets."
"RTN","ENFADEL",105,0)
 . S DIR("?",2)="Since the asset was placed in the Excess (1995) account"
"RTN","ENFADEL",106,0)
 . S DIR("?",3)="a FA Document should be sent adding it to Fixed Assets"
"RTN","ENFADEL",107,0)
 . S DIR("?",4)="as excess equipment."
"RTN","ENFADEL",108,0)
 . S DIR("?")="Enter YES to send a FA Document"
"RTN","ENFADEL",109,0)
 . W ! D ^DIR K DIR Q:$D(DIRUT)!'Y
"RTN","ENFADEL",110,0)
 . D ^ENFAACQ
"RTN","ENFADEL",111,0)
EXIT L -^ENG(6915.5,ENFD("DA")),-^ENG(6914,ENEQ("DA"))
"RTN","ENFADEL",112,0)
 ;
"RTN","ENFADEL",113,0)
K K DA,DIC,DIE,DR,ENAV,ENEQ,ENFA,ENFAP,ENFD,I,X,Y Q
"RTN","ENFADEL",114,0)
 ;
"RTN","ENFADEL",115,0)
 ;ENFADEL
"RTN","ENFAR7")
0^2^B11449754^B11283524
"RTN","ENFAR7",1,0)
ENFAR7 ;WIRMFO/SAB-FIXED ASSET RPT, FA DOCUMENTS FOR EXCESS EQUIP; 1.12.98 ; 4/15/13 11:51am
"RTN","ENFAR7",2,0)
 ;;7.0;ENGINEERING;**29,33,46,48,92**;Aug 17, 1993;Build 10
"RTN","ENFAR7",3,0)
 ; FA Documents for Excess Equipment (SGL 1995) during Accounting Period
"RTN","ENFAR7",4,0)
 ;patch 92 renamed sgl 1524 to 1995
"RTN","ENFAR7",5,0)
EN ;
"RTN","ENFAR7",6,0)
 ; compute default start date (day of previous month)
"RTN","ENFAR7",7,0)
 S ENDT("Y")=$E(DT,1,3),ENDT("M")=$E(DT,4,5),ENDT("D")=$E(DT,6,7)
"RTN","ENFAR7",8,0)
 S ENDTS=$S(ENDT("M")="01":(ENDT("Y")-1)_"12",1:ENDT("Y")_$E("00",1,2-$L(ENDT("M")-1))_(ENDT("M")-1))_ENDT("D")
"RTN","ENFAR7",9,0)
 I ENDTS>$$EOM^ENUTL(ENDTS) S ENDTS=$$EOM^ENUTL(ENDTS)
"RTN","ENFAR7",10,0)
 ; ask start date when interactive
"RTN","ENFAR7",11,0)
 I '$D(ZTQUEUED) D  G:$D(DIRUT) EXIT
"RTN","ENFAR7",12,0)
 . S DIR(0)="D^::EX",DIR("A")="Start Date"
"RTN","ENFAR7",13,0)
 . S DIR("B")=$$FMTE^XLFDT(ENDTS,"2D")
"RTN","ENFAR7",14,0)
 . D ^DIR K DIR S ENDTS=Y
"RTN","ENFAR7",15,0)
ASKDTE ; compute default end date (Today)
"RTN","ENFAR7",16,0)
 S ENDTE=$P(DT,".")
"RTN","ENFAR7",17,0)
 ; ask end date when interactive
"RTN","ENFAR7",18,0)
 I '$D(ZTQUEUED) D  G:$D(DIRUT) EXIT
"RTN","ENFAR7",19,0)
 . S DIR(0)="D^::EX",DIR("A")="End Date"
"RTN","ENFAR7",20,0)
 . S DIR("B")=$$FMTE^XLFDT(ENDTE,"2D")
"RTN","ENFAR7",21,0)
 . D ^DIR K DIR S ENDTE=Y
"RTN","ENFAR7",22,0)
 I ENDTE<ENDTS W $C(7),!,"End date must be after start date!",! G ASKDTE
"RTN","ENFAR7",23,0)
 ; ask device when interactive
"RTN","ENFAR7",24,0)
 I '$D(ZTQUEUED) S %ZIS="QM" D ^%ZIS G:POP EXIT I $D(IO("Q")) D  G EXIT
"RTN","ENFAR7",25,0)
 . S ZTRTN="QEN^ENFAR7",ZTDESC="FA Documents for Excess Equipment"
"RTN","ENFAR7",26,0)
 . F X="ENDTS","ENDTE" S ZTSAVE(X)=""
"RTN","ENFAR7",27,0)
 . D ^%ZTLOAD,HOME^%ZIS K ZTSK
"RTN","ENFAR7",28,0)
QEN ; queued entry
"RTN","ENFAR7",29,0)
 U IO
"RTN","ENFAR7",30,0)
 K ^TMP($J)
"RTN","ENFAR7",31,0)
 ; get/sort FA Documents for excess within date range
"RTN","ENFAR7",32,0)
 ; loop thru FA DOCUMENT LOG by created date/time
"RTN","ENFAR7",33,0)
 S ENDT=ENDTS
"RTN","ENFAR7",34,0)
 F  S ENDT=$O(^ENG(6915.2,"D",ENDT)) Q:ENDT=""!($P(ENDT,".")>ENDTE)  D
"RTN","ENFAR7",35,0)
 . S ENDA=0 F  S ENDA=$O(^ENG(6915.2,"D",ENDT,ENDA)) Q:'ENDA  D
"RTN","ENFAR7",36,0)
 . . S ENY3=$G(^ENG(6915.2,ENDA,3))
"RTN","ENFAR7",37,0)
 . . Q:$P(ENY3,U,6)'="X"  ; FA TYPE not X (SGL 1995 excess)
"RTN","ENFAR7",38,0)
 . . S ENSN=$TR($E($P(ENY3,U,5),1,5)," ","") ; station
"RTN","ENFAR7",39,0)
 . . S ENFUND=$P(ENY3,U,10) ; fund
"RTN","ENFAR7",40,0)
 . . S ^TMP($J,ENSN,ENFUND,ENDA)=""
"RTN","ENFAR7",41,0)
 ; print output
"RTN","ENFAR7",42,0)
 S (END,ENPG)=0 D NOW^%DTC S Y=% D DD^%DT S ENDTR=Y
"RTN","ENFAR7",43,0)
 S ENL="",$P(ENL,"-",IOM)=""
"RTN","ENFAR7",44,0)
 D HD
"RTN","ENFAR7",45,0)
 I '$D(^TMP($J)) W !!,"No FA Documents for SGL 1995 in selected period",!
"RTN","ENFAR7",46,0)
 S ENSN="" F  S ENSN=$O(^TMP($J,ENSN)) Q:ENSN=""  D  Q:END
"RTN","ENFAR7",47,0)
 . W !
"RTN","ENFAR7",48,0)
 . S ENFUND="" F  S ENFUND=$O(^TMP($J,ENSN,ENFUND)) Q:ENFUND=""  D  Q:END
"RTN","ENFAR7",49,0)
 . . S ENDA=0 F  S ENDA=$O(^TMP($J,ENSN,ENFUND,ENDA)) Q:'ENDA  D  Q:END
"RTN","ENFAR7",50,0)
 . . . S ENY0=$G(^ENG(6915.2,ENDA,0))
"RTN","ENFAR7",51,0)
 . . . S ENY1=$G(^ENG(6915.2,ENDA,1))
"RTN","ENFAR7",52,0)
 . . . S ENY3=$G(^ENG(6915.2,ENDA,3))
"RTN","ENFAR7",53,0)
 . . . I $Y+4>IOSL D HD Q:END
"RTN","ENFAR7",54,0)
 . . . W !,?3,ENSN,?11,ENFUND,?18,$P(ENY1,U,6)
"RTN","ENFAR7",55,0)
 . . . W ?23,$P(ENY1,U,9),?35,$$FMTE^XLFDT($P(ENY0,U,2),"2D")
"RTN","ENFAR7",56,0)
 . . . W ?45,$P(ENY0,U),?57,$J($FN($P(ENY3,U,27),",",2),14)
"RTN","ENFAR7",57,0)
 I END W !!,"REPORT STOPPED AT USER REQUEST"
"RTN","ENFAR7",58,0)
 E  I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR
"RTN","ENFAR7",59,0)
 D ^%ZISC
"RTN","ENFAR7",60,0)
EXIT I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENFAR7",61,0)
 K ^TMP($J)
"RTN","ENFAR7",62,0)
 K DIR,DIROUT,DIRUT,DIWF,DIWL,DTOUT,DUOUT,X,Y
"RTN","ENFAR7",63,0)
 K END,ENDA,ENDT,ENDTE,ENDTR,ENDTS,ENFUND,ENL,ENPG,ENSN,ENY0,ENY1,ENY3
"RTN","ENFAR7",64,0)
 Q
"RTN","ENFAR7",65,0)
HD ; page header
"RTN","ENFAR7",66,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD S ZTSTOP=1,END=1 Q
"RTN","ENFAR7",67,0)
 I $E(IOST,1,2)="C-",ENPG S DIR(0)="E" D ^DIR K DIR I 'Y S END=1 Q
"RTN","ENFAR7",68,0)
 I $E(IOST,1,2)="C-"!ENPG W @IOF
"RTN","ENFAR7",69,0)
 S ENPG=ENPG+1
"RTN","ENFAR7",70,0)
 W !,"FA DOCUMENTS FOR EXCESS EQUIP. (SGL 1995)"
"RTN","ENFAR7",71,0)
 W ?49,ENDTR,?72,"page ",ENPG
"RTN","ENFAR7",72,0)
 W !,"  ACCOUNTING PERIOD FROM ",$$FMTE^XLFDT(ENDTS,"2D")
"RTN","ENFAR7",73,0)
 W " TO ",$$FMTE^XLFDT(ENDTE,"2D")
"RTN","ENFAR7",74,0)
 W !!,?3,"STATION",?11,"FUND",?18,"TRANSACTION"
"RTN","ENFAR7",75,0)
 W ?45,"EQUIPMENT",?57,"ASSET VALUE"
"RTN","ENFAR7",76,0)
 W !,?18,"CODE NUMBER      DATE",?45,"ENTRY #"
"RTN","ENFAR7",77,0)
 W !,?3,"-------",?11,"------",?18,"---- ----------- --------"
"RTN","ENFAR7",78,0)
 W ?45,"----------",?57,"--------------"
"RTN","ENFAR7",79,0)
 Q
"RTN","ENX1P92")
0^1^B5277574^n/a
"RTN","ENX1P92",1,0)
ENX1P92 ;ALB/BR - ENG National Update ; 4/15/13 1:03pm
"RTN","ENX1P92",2,0)
 ;;7.0;ENGINEERING;**92**;Aug 17, 1993;Build 10
"RTN","ENX1P92",3,0)
 ;
"RTN","ENX1P92",4,0)
 ;this routine is used as a post-init in a KIDS build
"RTN","ENX1P92",5,0)
 ;to modify the NX SGL (#6914.3) file
"RTN","ENX1P92",6,0)
 ;and the NX BOC (#6914.4) file
"RTN","ENX1P92",7,0)
 ;
"RTN","ENX1P92",8,0)
 Q
"RTN","ENX1P92",9,0)
 ;
"RTN","ENX1P92",10,0)
START ; entry point for post-init
"RTN","ENX1P92",11,0)
 ;
"RTN","ENX1P92",12,0)
 D ADDBOC
"RTN","ENX1P92",13,0)
 D CHNGSGL
"RTN","ENX1P92",14,0)
 Q
"RTN","ENX1P92",15,0)
 ;
"RTN","ENX1P92",16,0)
ADDBOC ;* add new entry to the NX BOC (#6914.4) file
"RTN","ENX1P92",17,0)
 ;
"RTN","ENX1P92",18,0)
 ;
"RTN","ENX1P92",19,0)
 ;  ENGBOC is in format:
"RTN","ENX1P92",20,0)
 ;   CODE^TITLE^CORRESPONDING SGL
"RTN","ENX1P92",21,0)
 ;
"RTN","ENX1P92",22,0)
 N ENGBOC,ENGDINUM,ENGNX,ENGCBOC,ENGBOCT,ENGCSGL
"RTN","ENX1P92",23,0)
 D MES^XPDUTL(" ")
"RTN","ENX1P92",24,0)
 D BMES^XPDUTL("Adding new entries to the NX BOC #6914.4 File...")
"RTN","ENX1P92",25,0)
 D MES^XPDUTL(" ")
"RTN","ENX1P92",26,0)
 F ENGNX=1:1 S ENGBOC=$P($T(NXBOC+ENGNX),";;",2) Q:ENGBOC="QUIT"  D
"RTN","ENX1P92",27,0)
 .S ENGCBOC=$P(ENGBOC,U,1),ENGBOCT=$P(ENGBOC,U,2),ENGCSGL=$P(ENGBOC,U,3)
"RTN","ENX1P92",28,0)
 .D FILBOC
"RTN","ENX1P92",29,0)
 Q
"RTN","ENX1P92",30,0)
FILBOC ;file boc
"RTN","ENX1P92",31,0)
 N X,Y,ENGSTR
"RTN","ENX1P92",32,0)
 I $D(^ENG(6914.4,"B",ENGCBOC)) D
"RTN","ENX1P92",33,0)
 .D MES^XPDUTL(" ")
"RTN","ENX1P92",34,0)
 .D BMES^XPDUTL("Entry # "_ENGCBOC_" already added")
"RTN","ENX1P92",35,0)
 .D MES^XPDUTL(" ")
"RTN","ENX1P92",36,0)
 I '$D(^ENG(6914.4,"B",ENGCBOC)) D
"RTN","ENX1P92",37,0)
 .S X=ENGCBOC,DIC="^ENG(6914.4,",DIC(0)="",DIC("DR")="1///^S X=ENGBOCT;2///^S X=ENGCSGL"
"RTN","ENX1P92",38,0)
 .D FILE^DICN
"RTN","ENX1P92",39,0)
 .I +Y>0 D
"RTN","ENX1P92",40,0)
 ..D MES^XPDUTL(" ")
"RTN","ENX1P92",41,0)
 ..S ENGSTR="   Entry #"_+Y_" for "_$P(Y,U,2)
"RTN","ENX1P92",42,0)
 ..D BMES^XPDUTL(ENGSTR_"  ...successfully added.")
"RTN","ENX1P92",43,0)
 .I Y=-1 D
"RTN","ENX1P92",44,0)
 ..D MES^XPDUTL(" ")
"RTN","ENX1P92",45,0)
 ..D BMES^XPDUTL("ERROR when attempting to add "_ENGCBOC)
"RTN","ENX1P92",46,0)
 Q
"RTN","ENX1P92",47,0)
NXBOC ;CAPITALIZED BUDGET OBJECT CODE^BOC TITLE^CORRESPONDING SGL
"RTN","ENX1P92",48,0)
 ;;2335^SOFTWARE^1830
"RTN","ENX1P92",49,0)
 ;;QUIT
"RTN","ENX1P92",50,0)
 ;
"RTN","ENX1P92",51,0)
 Q
"RTN","ENX1P92",52,0)
CHNGSGL ;Change 1524 SGL to 1995 in 6914.4 file  
"RTN","ENX1P92",53,0)
 N ENDA,ENFDA
"RTN","ENX1P92",54,0)
 ;
"RTN","ENX1P92",55,0)
 ;update fields .01,1, and 3.  prevent adding entry during install
"RTN","ENX1P92",56,0)
 S ENDA=$$FIND1^DIC(6914.3,"","X","1524","B")
"RTN","ENX1P92",57,0)
 I ENDA D
"RTN","ENX1P92",58,0)
 .D BMES^XPDUTL(" Renaming the Excess SGL from 1524 to 1995. ")
"RTN","ENX1P92",59,0)
 .K ENFDA S ENFDA(6914.3,ENDA_",",.01)="1995"
"RTN","ENX1P92",60,0)
 .S ENFDA(6914.3,ENDA_",",1)="PP&E REMOVED FROM SERVICE BUT NOT DISPOSED"
"RTN","ENX1P92",61,0)
 .S ENFDA(6914.3,ENDA_",",3)="EQ PEND DISP"
"RTN","ENX1P92",62,0)
 .D FILE^DIE("","ENFDA") D MSG^DIALOG()
"RTN","ENX1P92",63,0)
 .D BMES^XPDUTL("Renaming completed")
"RTN","ENX1P92",64,0)
 Q
"VER")
8.0^22.0
"^DD",6915.5,6915.5,104,0)
FAIR MARKET VALUE^NJ11,2^^100;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>99999999)!(X<1) X
"^DD",6915.5,6915.5,104,.1)

"^DD",6915.5,6915.5,104,3)
Type a Dollar Amount between 1 and 99999999, 2 Decimal Digits
"^DD",6915.5,6915.5,104,21,0)
^^8^8^3130415^
"^DD",6915.5,6915.5,104,21,1,0)
The estimated, realistic dollar value of an asset when categorized as "VA
"^DD",6915.5,6915.5,104,21,2,0)
Excess" personal property. This value will replace the current TOTAL ASSET
"^DD",6915.5,6915.5,104,21,3,0)
VALUE in the Equipment Inv. file. Note that the current TOTAL ASSET VALUE
"^DD",6915.5,6915.5,104,21,4,0)
will automatically be saved as the ORIGINAL ASSET VALUE.
"^DD",6915.5,6915.5,104,21,5,0)
 
"^DD",6915.5,6915.5,104,21,6,0)
VA Accounting Standards require capitalized nonexpendable property to be
"^DD",6915.5,6915.5,104,21,7,0)
recorded in the "Excess" Standard General Ledger (SGL) 1995 at its
"^DD",6915.5,6915.5,104,21,8,0)
"Expected Net Realizable Value".
"^DD",6915.5,6915.5,104,"DT")
3130415
"BLD",9223,6)
^88
**END**
**END**
