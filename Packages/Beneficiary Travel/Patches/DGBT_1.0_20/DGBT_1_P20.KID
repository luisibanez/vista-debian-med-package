KIDS Distribution saved on Feb 03, 2013@23:48:57
Version 20 fixes problem with prior claims
**KIDS**:DGBT*1.0*20^

**INSTALL NAME**
DGBT*1.0*20
"BLD",8676,0)
DGBT*1.0*20^BENEFICIARY TRAVEL^0^3130203^y
"BLD",8676,1,0)
^^2^2^3120913^
"BLD",8676,1,1,0)
Contains enhancements for Beneficiary Travel Package and 
"BLD",8676,1,2,0)
Mileage Reporting System.
"BLD",8676,4,0)
^9.64PA^392.43^9
"BLD",8676,4,392,0)
392
"BLD",8676,4,392,222)
y^y^f^^^^n^^n
"BLD",8676,4,392,224)

"BLD",8676,4,392.3,0)
392.3
"BLD",8676,4,392.3,222)
y^y^f^^^^n
"BLD",8676,4,392.41,0)
392.41
"BLD",8676,4,392.41,222)
y^y^f^^n^^y^o^n
"BLD",8676,4,392.42,0)
392.42
"BLD",8676,4,392.42,222)
y^n^f^^n^^y^o^n
"BLD",8676,4,392.43,0)
392.43
"BLD",8676,4,392.43,222)
y^y^f^^n^^y^o^n
"BLD",8676,4,392.6,0)
392.6
"BLD",8676,4,392.6,222)
y^y^f^^n^^y^o^n
"BLD",8676,4,392.7,0)
392.7
"BLD",8676,4,392.7,222)
y^y^f^^^^n
"BLD",8676,4,392.8,0)
392.8
"BLD",8676,4,392.8,222)
y^y^f^^n^^y^o^n
"BLD",8676,4,392.9,0)
392.9
"BLD",8676,4,392.9,222)
y^y^f^^^^n
"BLD",8676,4,"B",392,392)

"BLD",8676,4,"B",392.3,392.3)

"BLD",8676,4,"B",392.41,392.41)

"BLD",8676,4,"B",392.42,392.42)

"BLD",8676,4,"B",392.43,392.43)

"BLD",8676,4,"B",392.6,392.6)

"BLD",8676,4,"B",392.7,392.7)

"BLD",8676,4,"B",392.8,392.8)

"BLD",8676,4,"B",392.9,392.9)

"BLD",8676,6.3)
185
"BLD",8676,"ABNS",0)
^9.66A^^
"BLD",8676,"ABPKG")
y^n
"BLD",8676,"INI")

"BLD",8676,"INID")
n^n^n
"BLD",8676,"INIT")

"BLD",8676,"KRN",0)
^9.67PA^779.2^20
"BLD",8676,"KRN",.4,0)
.4
"BLD",8676,"KRN",.4,"NM",0)
^9.68A^^
"BLD",8676,"KRN",.401,0)
.401
"BLD",8676,"KRN",.402,0)
.402
"BLD",8676,"KRN",.403,0)
.403
"BLD",8676,"KRN",.5,0)
.5
"BLD",8676,"KRN",.84,0)
.84
"BLD",8676,"KRN",3.6,0)
3.6
"BLD",8676,"KRN",3.8,0)
3.8
"BLD",8676,"KRN",9.2,0)
9.2
"BLD",8676,"KRN",9.8,0)
9.8
"BLD",8676,"KRN",9.8,"NM",0)
^9.68A^41^35
"BLD",8676,"KRN",9.8,"NM",1,0)
DGBT1^^0^B120702431
"BLD",8676,"KRN",9.8,"NM",2,0)
DGBTUTL^^0^B98577404
"BLD",8676,"KRN",9.8,"NM",3,0)
DGBTE^^0^B44311699
"BLD",8676,"KRN",9.8,"NM",4,0)
DGBTEE^^0^B60372352
"BLD",8676,"KRN",9.8,"NM",5,0)
DGBTEE1^^0^B20015303
"BLD",8676,"KRN",9.8,"NM",6,0)
DGBTEE2^^0^B23632699
"BLD",8676,"KRN",9.8,"NM",7,0)
DGBTCE^^0^B36783566
"BLD",8676,"KRN",9.8,"NM",8,0)
DGBT2^^0^B17619778
"BLD",8676,"KRN",9.8,"NM",9,0)
DGBTEND^^0^B26000162
"BLD",8676,"KRN",9.8,"NM",10,0)
DGBTSP^^0^B183996110
"BLD",8676,"KRN",9.8,"NM",13,0)
DGBTSP1^^0^B78025858
"BLD",8676,"KRN",9.8,"NM",14,0)
DGBTR^^0^B18418330
"BLD",8676,"KRN",9.8,"NM",15,0)
DGBTUTL1^^0^B40695224
"BLD",8676,"KRN",9.8,"NM",16,0)
DGBTDW^^0^B153522800
"BLD",8676,"KRN",9.8,"NM",19,0)
DGBTE1^^0^B29349842
"BLD",8676,"KRN",9.8,"NM",20,0)
DGBTE1A^^0^B10407793
"BLD",8676,"KRN",9.8,"NM",21,0)
DGBTDLT^^0^B117344435
"BLD",8676,"KRN",9.8,"NM",22,0)
DGBTDLT1^^0^B74264382
"BLD",8676,"KRN",9.8,"NM",23,0)
DGBTALTI^^0^B50552972
"BLD",8676,"KRN",9.8,"NM",24,0)
DGBTCR^^0^B25363129
"BLD",8676,"KRN",9.8,"NM",25,0)
DGBTCR1^^0^B10630325
"BLD",8676,"KRN",9.8,"NM",26,0)
DGBTCR2^^0^B16305371
"BLD",8676,"KRN",9.8,"NM",28,0)
DGBTR121^^0^B74474591
"BLD",8676,"KRN",9.8,"NM",29,0)
DGBTR122^^0^B36391990
"BLD",8676,"KRN",9.8,"NM",30,0)
DGBTR123^^0^B179962898
"BLD",8676,"KRN",9.8,"NM",31,0)
DGBTR124^^0^B36833401
"BLD",8676,"KRN",9.8,"NM",32,0)
DGBTR125^^0^B94720260
"BLD",8676,"KRN",9.8,"NM",33,0)
DGBTR17^^0^B130956711
"BLD",8676,"KRN",9.8,"NM",34,0)
DGBTRDV^^0^B21663244
"BLD",8676,"KRN",9.8,"NM",36,0)
DGBTRDVW^^0^B8811174
"BLD",8676,"KRN",9.8,"NM",37,0)
DGBTR3A^^0^B18478741
"BLD",8676,"KRN",9.8,"NM",38,0)
DGBTCE1^^0^B12864135
"BLD",8676,"KRN",9.8,"NM",39,0)
DGBTCD^^0^B27058166
"BLD",8676,"KRN",9.8,"NM",40,0)
DGBTCDSP^^0^B34785132
"BLD",8676,"KRN",9.8,"NM",41,0)
DGBTMTTH^^0^B797719
"BLD",8676,"KRN",9.8,"NM","B","DGBT1",1)

"BLD",8676,"KRN",9.8,"NM","B","DGBT2",8)

"BLD",8676,"KRN",9.8,"NM","B","DGBTALTI",23)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCD",39)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCDSP",40)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCE",7)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCE1",38)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCR",24)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCR1",25)

"BLD",8676,"KRN",9.8,"NM","B","DGBTCR2",26)

"BLD",8676,"KRN",9.8,"NM","B","DGBTDLT",21)

"BLD",8676,"KRN",9.8,"NM","B","DGBTDLT1",22)

"BLD",8676,"KRN",9.8,"NM","B","DGBTDW",16)

"BLD",8676,"KRN",9.8,"NM","B","DGBTE",3)

"BLD",8676,"KRN",9.8,"NM","B","DGBTE1",19)

"BLD",8676,"KRN",9.8,"NM","B","DGBTE1A",20)

"BLD",8676,"KRN",9.8,"NM","B","DGBTEE",4)

"BLD",8676,"KRN",9.8,"NM","B","DGBTEE1",5)

"BLD",8676,"KRN",9.8,"NM","B","DGBTEE2",6)

"BLD",8676,"KRN",9.8,"NM","B","DGBTEND",9)

"BLD",8676,"KRN",9.8,"NM","B","DGBTMTTH",41)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR",14)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR121",28)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR122",29)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR123",30)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR124",31)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR125",32)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR17",33)

"BLD",8676,"KRN",9.8,"NM","B","DGBTR3A",37)

"BLD",8676,"KRN",9.8,"NM","B","DGBTRDV",34)

"BLD",8676,"KRN",9.8,"NM","B","DGBTRDVW",36)

"BLD",8676,"KRN",9.8,"NM","B","DGBTSP",10)

"BLD",8676,"KRN",9.8,"NM","B","DGBTSP1",13)

"BLD",8676,"KRN",9.8,"NM","B","DGBTUTL",2)

"BLD",8676,"KRN",9.8,"NM","B","DGBTUTL1",15)

"BLD",8676,"KRN",19,0)
19
"BLD",8676,"KRN",19,"NM",0)
^9.68A^16^14
"BLD",8676,"KRN",19,"NM",2,0)
DGBT ALTERNATE INCOME^^0^
"BLD",8676,"KRN",19,"NM",3,0)
DGBT EDIT DENIAL LETTERS^^0^
"BLD",8676,"KRN",19,"NM",4,0)
DGBT MANUAL DEDUCTIBLE WAIVER^^0^
"BLD",8676,"KRN",19,"NM",5,0)
DGBT REPRINT DENIAL LETTERS^^0^
"BLD",8676,"KRN",19,"NM",6,0)
DGBT CLAIM DEDUCTIBLE PAID^^0
"BLD",8676,"KRN",19,"NM",7,0)
DGBT BENE TRAVEL CLAIM AMT RPT^^4^
"BLD",8676,"KRN",19,"NM",8,0)
DGBT CLERK REPORT^^0^
"BLD",8676,"KRN",19,"NM",9,0)
DGBT FISCAL REPORT^^0^
"BLD",8676,"KRN",19,"NM",10,0)
DGBT SPECIAL MODE REPORT^^0^
"BLD",8676,"KRN",19,"NM",11,0)
DGBT SUMMARY REPORT^^0^
"BLD",8676,"KRN",19,"NM",12,0)
DGBT TRAVEL PATTERN REPORT^^0^
"BLD",8676,"KRN",19,"NM",14,0)
DGBT AUDIT REPORT^^0^
"BLD",8676,"KRN",19,"NM",15,0)
DGBT BENE TRAVEL MENU^^2
"BLD",8676,"KRN",19,"NM",16,0)
DGBT TRAVEL REPORTS MENU^^3
"BLD",8676,"KRN",19,"NM","B","DGBT ALTERNATE INCOME",2)

"BLD",8676,"KRN",19,"NM","B","DGBT AUDIT REPORT",14)

"BLD",8676,"KRN",19,"NM","B","DGBT BENE TRAVEL CLAIM AMT RPT",7)

"BLD",8676,"KRN",19,"NM","B","DGBT BENE TRAVEL MENU",15)

"BLD",8676,"KRN",19,"NM","B","DGBT CLAIM DEDUCTIBLE PAID",6)

"BLD",8676,"KRN",19,"NM","B","DGBT CLERK REPORT",8)

"BLD",8676,"KRN",19,"NM","B","DGBT EDIT DENIAL LETTERS",3)

"BLD",8676,"KRN",19,"NM","B","DGBT FISCAL REPORT",9)

"BLD",8676,"KRN",19,"NM","B","DGBT MANUAL DEDUCTIBLE WAIVER",4)

"BLD",8676,"KRN",19,"NM","B","DGBT REPRINT DENIAL LETTERS",5)

"BLD",8676,"KRN",19,"NM","B","DGBT SPECIAL MODE REPORT",10)

"BLD",8676,"KRN",19,"NM","B","DGBT SUMMARY REPORT",11)

"BLD",8676,"KRN",19,"NM","B","DGBT TRAVEL PATTERN REPORT",12)

"BLD",8676,"KRN",19,"NM","B","DGBT TRAVEL REPORTS MENU",16)

"BLD",8676,"KRN",19.1,0)
19.1
"BLD",8676,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",8676,"KRN",19.1,"NM",1,0)
DGBT EDIT DENIAL LTRS^^0
"BLD",8676,"KRN",19.1,"NM","B","DGBT EDIT DENIAL LTRS",1)

"BLD",8676,"KRN",101,0)
101
"BLD",8676,"KRN",409.61,0)
409.61
"BLD",8676,"KRN",771,0)
771
"BLD",8676,"KRN",779.2,0)
779.2
"BLD",8676,"KRN",870,0)
870
"BLD",8676,"KRN",8989.51,0)
8989.51
"BLD",8676,"KRN",8989.52,0)
8989.52
"BLD",8676,"KRN",8994,0)
8994
"BLD",8676,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",8676,"KRN",8994,"NM",1,0)
DGBT CLAIM DEDUCTIBLE PAID^^0
"BLD",8676,"KRN",8994,"NM","B","DGBT CLAIM DEDUCTIBLE PAID",1)

"BLD",8676,"KRN","B",.4,.4)

"BLD",8676,"KRN","B",.401,.401)

"BLD",8676,"KRN","B",.402,.402)

"BLD",8676,"KRN","B",.403,.403)

"BLD",8676,"KRN","B",.5,.5)

"BLD",8676,"KRN","B",.84,.84)

"BLD",8676,"KRN","B",3.6,3.6)

"BLD",8676,"KRN","B",3.8,3.8)

"BLD",8676,"KRN","B",9.2,9.2)

"BLD",8676,"KRN","B",9.8,9.8)

"BLD",8676,"KRN","B",19,19)

"BLD",8676,"KRN","B",19.1,19.1)

"BLD",8676,"KRN","B",101,101)

"BLD",8676,"KRN","B",409.61,409.61)

"BLD",8676,"KRN","B",771,771)

"BLD",8676,"KRN","B",779.2,779.2)

"BLD",8676,"KRN","B",870,870)

"BLD",8676,"KRN","B",8989.51,8989.51)

"BLD",8676,"KRN","B",8989.52,8989.52)

"BLD",8676,"KRN","B",8994,8994)

"BLD",8676,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8676,"QUES",0)
^9.62^^
"BLD",8676,"REQB",0)
^9.611^2^2
"BLD",8676,"REQB",1,0)
DGBT*1.0*18^1
"BLD",8676,"REQB",2,0)
DGBT*1.0*19^1
"BLD",8676,"REQB","B","DGBT*1.0*18",1)

"BLD",8676,"REQB","B","DGBT*1.0*19",2)

"DATA",392.41,1,0)
1^SC >30%
"DATA",392.41,2,0)
2^Recipient of VA Pension
"DATA",392.41,3,0)
3^Low Income Copay
"DATA",392.41,4,0)
4^Low Income M Test
"DATA",392.41,5,0)
5^Alt. Income POW
"DATA",392.41,6,0)
6^Alt.Income Hardship
"DATA",392.41,7,0)
7^Service connected appointment on the file
"DATA",392.41,8,0)
8^Compensation & Pension appointment on the file
"DATA",392.41,9,0)
9^Patient stated SERVICE CONNECTED APPOINTMENT
"DATA",392.41,10,0)
10^Patient stated COMP AND PENSION APPOINTMENT
"DATA",392.41,11,0)
11^PATIENT STATED ELIGIBILITY REASON Caregiver
"DATA",392.41,12,0)
12^PATIENT STATED ELIGIBILITY REASON Transplant
"DATA",392.41,13,0)
13^PATIENT STATED OTHER REASON FOR ELIGIBILITY 
"DATA",392.41,14,0)
14^Patient Exits Claim
"DATA",392.41,15,0)
15^PATIENT AGREES WITH DENIAL OF CLAIM
"DATA",392.41,16,0)
16^NSC Low Income
"DATA",392.41,17,0)
17^SC Under 30% and Low Income
"DATA",392.41,18,0)
18^Alternative Income Hardship
"DATA",392.41,19,0)
19^Alternate Income POW
"DATA",392.41,20,0)
20^Patient stated QUALIFIED SC APPOINTMENT
"DATA",392.41,21,0)
21^Patient refuse to provide financial information
"DATA",392.42,1,0)
AIR AMBULANCE FIXED
"DATA",392.42,2,0)
AIR AMBULANCE ROTARY
"DATA",392.42,3,0)
ALS AMBULANCE
"DATA",392.42,4,0)
BLS AMBULANCE
"DATA",392.42,5,0)
STRETCHER (AMBULETTE)
"DATA",392.42,6,0)
WHEELCHAIR VAN
"DATA",392.42,7,0)
OTHER
"DATA",392.43,1,0)
AIRCRAFT
"DATA",392.43,2,0)
BUS
"DATA",392.43,3,0)
HIRED CAR/VAN
"DATA",392.43,4,0)
METRO TRANSIT
"DATA",392.43,5,0)
NON-PROFIT/VOLUNTEER
"DATA",392.43,6,0)
TAXI
"DATA",392.43,7,0)
TRAIN
"DATA",392.43,8,0)
BOAT/FERRY
"DATA",392.43,9,0)
OTHER
"DATA",392.6,1,0)
MILEAGE DENIAL LETTER 1^^1^1^3120312^^^
"DATA",392.6,1,1,0)
^392.61^16^16^3121114^^
"DATA",392.6,1,1,1,0)
 
"DATA",392.6,1,1,2,0)
Beneficiary Travel Payment Decision
"DATA",392.6,1,1,3,0)
 
"DATA",392.6,1,1,4,0)
 Dear Veteran,
"DATA",392.6,1,1,5,0)
 
"DATA",392.6,1,1,6,0)
 We regret to inform you that your request for the VA to reimburse the
"DATA",392.6,1,1,7,0)
 cost of your transportation to and from your medical appointment on
"DATA",392.6,1,1,8,0)
 |VAR("DGBTCDT(1)")| is denied.
"DATA",392.6,1,1,9,0)
 
"DATA",392.6,1,1,10,0)
 For our office to authorize reimbursement of your transportation
"DATA",392.6,1,1,11,0)
 costs you must meet administrative eligibility and application rules
"DATA",392.6,1,1,12,0)
 found within the Beneficiary Travel regulations at 38 Code of Federal
"DATA",392.6,1,1,13,0)
 Regulations Part 70, " Beneficiary Travel under 38 U.S.C. 111 within
"DATA",392.6,1,1,14,0)
 the United States.
"DATA",392.6,1,1,15,0)
 
"DATA",392.6,1,1,16,0)
 Your bill has been denied for the following reason:
"DATA",392.6,2,0)
MILEAGE LETTER TEXT PART 2
"DATA",392.6,2,1,0)
^^19^19^3121019^
"DATA",392.6,2,1,1,0)
 
"DATA",392.6,2,1,2,0)
 If you disagree with this decision follow the instructions on the
"DATA",392.6,2,1,3,0)
 enclosed VA Form 4107VHA, "Your Rights to Appeal Our Decision."  The
"DATA",392.6,2,1,4,0)
 Notice of Disagreement should be delivered to the Beneficiary Travel
"DATA",392.6,2,1,5,0)
 Supervisor at your local facility.  A second review of your case will
"DATA",392.6,2,1,6,0)
 be conducted at that time to ensure all facts surrounding the
"DATA",392.6,2,1,7,0)
 decision were considered to determine if the denial met all 
"DATA",392.6,2,1,8,0)
 regulatory guidelines or to reverse the original decision.  If we do
"DATA",392.6,2,1,9,0)
 not rule in your favor, you will be provided a Statement of Case,
"DATA",392.6,2,1,10,0)
 which describes the facts, laws, regulations, and reasons for our
"DATA",392.6,2,1,11,0)
 decision.
"DATA",392.6,2,1,12,0)
 
"DATA",392.6,2,1,13,0)
 
"DATA",392.6,2,1,14,0)
 Sincerely,
"DATA",392.6,2,1,15,0)
 
"DATA",392.6,2,1,16,0)
 
"DATA",392.6,2,1,17,0)
 |VAR("DGBTCDT(2)")|
"DATA",392.6,2,1,18,0)
 
"DATA",392.6,2,1,19,0)
 |VAR("DGBTCDT(3)")|
"DATA",392.6,3,0)
SP MODE DENIAL LETTER PART 1
"DATA",392.6,3,3,0)
^^23^23^3121019^
"DATA",392.6,3,3,1,0)
 
"DATA",392.6,3,3,2,0)
Beneficiary Travel Special Mode Payment Decision
"DATA",392.6,3,3,3,0)
 
"DATA",392.6,3,3,4,0)
 Dear Veteran,
"DATA",392.6,3,3,5,0)
 
"DATA",392.6,3,3,6,0)
 We regret to inform you that your request for the VA to provide
"DATA",392.6,3,3,7,0)
 payment for the cost of the special mode transportation you received
"DATA",392.6,3,3,8,0)
 on |VAR("DGBTCDT(1)")| is denied.
"DATA",392.6,3,3,9,0)
 
"DATA",392.6,3,3,10,0)
 Special mode of transportation includes ambulance, stretcher van, 
"DATA",392.6,3,3,11,0)
 wheelchair van or any mode of transportation specially designed to 
"DATA",392.6,3,3,12,0)
 transport a disabled person.  In order for the VA to reimburse for a 
"DATA",392.6,3,3,13,0)
 special mode of transportation; you must meet the administrative 
"DATA",392.6,3,3,14,0)
 eligibility criteria of 38 Code of Federal Regulations Part 
"DATA",392.6,3,3,15,0)
 70,"Beneficiary Travel under 38 U.S.C. 111 within the United States,
"DATA",392.6,3,3,16,0)
 and VA must determine that your medical condition required the type
"DATA",392.6,3,3,17,0)
 of special mode transport. In addition the travel must be
"DATA",392.6,3,3,18,0)
 pre-authorized except in emergencies where a delay would be hazardous
"DATA",392.6,3,3,19,0)
 to life or health. Finally the application for payment must be 
"DATA",392.6,3,3,20,0)
 submitted to our office within thirty calendar days of the date of
"DATA",392.6,3,3,21,0)
 service to be eligible for consideration.
"DATA",392.6,3,3,22,0)
 
"DATA",392.6,3,3,23,0)
 Your bill has been denied for the following reason:
"DATA",392.6,4,0)
SP MODE DENIAL LETTER PART 2
"DATA",392.6,4,3,0)
^^21^21^3121019^
"DATA",392.6,4,3,1,0)
 
"DATA",392.6,4,3,2,0)
 If you disagree with this decision follow the instructions on the 
"DATA",392.6,4,3,3,0)
 enclosed VA Form 4107VHA, "Your Rights to Appeal Our Decision." The
"DATA",392.6,4,3,4,0)
 Notice of Disagreement should be delivered to the Beneficiary Travel 
"DATA",392.6,4,3,5,0)
 Supervisor at your local facility. A second review of your case will
"DATA",392.6,4,3,6,0)
 be conducted at that time to ensure all facts surrounding the 
"DATA",392.6,4,3,7,0)
 decision were considered to determine if the denial met all
"DATA",392.6,4,3,8,0)
 regulatory guidelines or to reverse the original decision. If we do
"DATA",392.6,4,3,9,0)
 not rule in your favor, you will be provided a Statement of Case, 
"DATA",392.6,4,3,10,0)
 which describes the facts, laws, regulations, and reasons for our
"DATA",392.6,4,3,11,0)
 decision.
"DATA",392.6,4,3,12,0)
 
"DATA",392.6,4,3,13,0)
 
"DATA",392.6,4,3,14,0)
 Sincerely,
"DATA",392.6,4,3,15,0)
 
"DATA",392.6,4,3,16,0)
 
"DATA",392.6,4,3,17,0)
 
"DATA",392.6,4,3,18,0)
 
"DATA",392.6,4,3,19,0)
|VAR("DGBTCDT(2)")|
"DATA",392.6,4,3,20,0)
 
"DATA",392.6,4,3,21,0)
|VAR("DGBTCDT(3)")|
"DATA",392.8,1,0)
30 DAY APPLICATION REQUIREMENT
"DATA",392.8,1,1,0)
^^6^6^3121019^
"DATA",392.8,1,1,1,0)
 
"DATA",392.8,1,1,2,0)
 Your request for payment consideration was received greater than 30
"DATA",392.8,1,1,3,0)
 calendar days from the date you completed travel associated with your
"DATA",392.8,1,1,4,0)
 date you completed travel associated with your appointment or the
"DATA",392.8,1,1,5,0)
 date you became administratively eligible for payment of Beneficiary
"DATA",392.8,1,1,6,0)
 Travel benefits.
"DATA",392.8,2,0)
NSC HIGH INCOME
"DATA",392.8,2,1,0)
^^4^4^3121019^
"DATA",392.8,2,1,1,0)
 
"DATA",392.8,2,1,2,0)
 You are a Non-Service Connected Veteran with income above the
"DATA",392.8,2,1,3,0)
 established low-income threshold or your income is not on file to
"DATA",392.8,2,1,4,0)
 determine a low-income status exists for consideration of payment.
"DATA",392.8,3,0)
SC<30% NON-SC APPOINTMENT
"DATA",392.8,3,1,0)
^^6^6^3121019^
"DATA",392.8,3,1,1,0)
 
"DATA",392.8,3,1,2,0)
 You are a Service Connected Veteran with a rating of less than 30%,
"DATA",392.8,3,1,3,0)
 with income above the established low-income threshold or not on file
"DATA",392.8,3,1,4,0)
 to determine if a low-income status exists, and your medical
"DATA",392.8,3,1,5,0)
 appointment was not coded as treating your service connected
"DATA",392.8,3,1,6,0)
 condition(s).
"DATA",392.8,4,0)
NON-QUALIFIED APPOINTMENT
"DATA",392.8,4,1,0)
^^6^6^3121019^
"DATA",392.8,4,1,1,0)
 
"DATA",392.8,4,1,2,0)
 The appointment(s) associated with your date of travel does not
"DATA",392.8,4,1,3,0)
 qualify for payment.  For payment, an appointment must be in 
"DATA",392.8,4,1,4,0)
 relation to care or services that you are eligible for, must be 
"DATA",392.8,4,1,5,0)
 authorized in advance for a non-VA care appointment; and it must
"DATA",392.8,4,1,6,0)
 be completed unless due to actions other than yourself.
"DATA",392.8,5,0)
NON-VETERAN
"DATA",392.8,5,1,0)
^^9^9^3121019^
"DATA",392.8,5,1,1,0)
 
"DATA",392.8,5,1,2,0)
 Our records list your enrollment category as a Non-Veteran.  In
"DATA",392.8,5,1,3,0)
 this category you are not eligible for Beneficiary Travel payments
"DATA",392.8,5,1,4,0)
 unless it is in relation to VA transplant care; as a medically
"DATA",392.8,5,1,5,0)
 required attendant; under the provisions of the Caregiver program;
"DATA",392.8,5,1,6,0)
 as an Allied Beneficiary with travel approved by the appropriate 
"DATA",392.8,5,1,7,0)
 foreign government; or as a beneficiary of another Federal Agency 
"DATA",392.8,5,1,8,0)
 and with travel approved by that agency. There is no documentation
"DATA",392.8,5,1,9,0)
 on file verifying you meet one of these criteria.
"DATA",392.8,6,0)
MEDICAL REVIEW 
"DATA",392.8,6,1,0)
^^5^5^3121019^
"DATA",392.8,6,1,1,0)
 
"DATA",392.8,6,1,2,0)
 Pre-authorization was not obtained before using special mode
"DATA",392.8,6,1,3,0)
 transport, and our medical review team determined your condition
"DATA",392.8,6,1,4,0)
 at the time of transport failed to qualify as an emergency to
"DATA",392.8,6,1,5,0)
 authorize payment.
"FIA",392)
BENEFICIARY TRAVEL CLAIM
"FIA",392,0)
^DGBT(392,
"FIA",392,0,0)
392ID
"FIA",392,0,1)
y^y^f^^^^n^^n
"FIA",392,0,10)

"FIA",392,0,11)

"FIA",392,0,"RLRO")

"FIA",392,0,"VR")
1.0^DGBT
"FIA",392,392)
0
"FIA",392.3)
BENEFICIARY TRAVEL ACCOUNT
"FIA",392.3,0)
^DGBT(392.3,
"FIA",392.3,0,0)
392.3I
"FIA",392.3,0,1)
y^y^f^^^^n
"FIA",392.3,0,10)

"FIA",392.3,0,11)

"FIA",392.3,0,"RLRO")

"FIA",392.3,0,"VR")
1.0^DGBT
"FIA",392.3,392.3)
0
"FIA",392.41)
BT CLAIM ELIGIBILITY CODE
"FIA",392.41,0)
^DGBT(392.41,
"FIA",392.41,0,0)
392.41I
"FIA",392.41,0,1)
y^y^f^^n^^y^o^n
"FIA",392.41,0,10)

"FIA",392.41,0,11)

"FIA",392.41,0,"RLRO")

"FIA",392.41,0,"VR")
1.0^DGBT
"FIA",392.41,392.41)
0
"FIA",392.42)
BT SPECIAL MODE OF TRANSPORTATION
"FIA",392.42,0)
^DGBT(392.42,
"FIA",392.42,0,0)
392.42
"FIA",392.42,0,1)
y^n^f^^n^^y^o^n
"FIA",392.42,0,10)

"FIA",392.42,0,11)

"FIA",392.42,0,"RLRO")

"FIA",392.42,0,"VR")
1.0^DGBT
"FIA",392.42,392.42)
0
"FIA",392.43)
BT COMMON CARRIER MODE OF TRANSPORTATION
"FIA",392.43,0)
^DGBT(392.43,
"FIA",392.43,0,0)
392.43
"FIA",392.43,0,1)
y^y^f^^n^^y^o^n
"FIA",392.43,0,10)

"FIA",392.43,0,11)

"FIA",392.43,0,"RLRO")

"FIA",392.43,0,"VR")
1.0^DGBT
"FIA",392.43,392.43)
0
"FIA",392.6)
BENEFICIARY TRAVEL DENIAL LETTERS
"FIA",392.6,0)
^DGBT(392.6,
"FIA",392.6,0,0)
392.6
"FIA",392.6,0,1)
y^y^f^^n^^y^o^n
"FIA",392.6,0,10)

"FIA",392.6,0,11)

"FIA",392.6,0,"RLRO")

"FIA",392.6,0,"VR")
1.0^DGBT
"FIA",392.6,392.6)
0
"FIA",392.6,392.61)
0
"FIA",392.6,392.62)
0
"FIA",392.6,392.63)
0
"FIA",392.6,392.64)
0
"FIA",392.7)
BENEFICIARY TRAVEL MANUAL DEDUCTIBLE WAIVER
"FIA",392.7,0)
^DGBT(392.7,
"FIA",392.7,0,0)
392.7D
"FIA",392.7,0,1)
y^y^f^^^^n
"FIA",392.7,0,10)

"FIA",392.7,0,11)

"FIA",392.7,0,"RLRO")

"FIA",392.7,0,"VR")
1.0^DGBT
"FIA",392.7,392.7)
0
"FIA",392.8)
BENEFICIARY TRAVEL DENIAL REASONS
"FIA",392.8,0)
^DGBT(392.8,
"FIA",392.8,0,0)
392.8
"FIA",392.8,0,1)
y^y^f^^n^^y^o^n
"FIA",392.8,0,10)

"FIA",392.8,0,11)

"FIA",392.8,0,"RLRO")

"FIA",392.8,0,"VR")
1.0^DGBT
"FIA",392.8,392.8)
0
"FIA",392.8,392.81)
0
"FIA",392.9)
BT PATIENT ALTERNATE INCOME
"FIA",392.9,0)
^DGBT(392.9,
"FIA",392.9,0,0)
392.9P
"FIA",392.9,0,1)
y^y^f^^^^n
"FIA",392.9,0,10)

"FIA",392.9,0,11)

"FIA",392.9,0,"RLRO")

"FIA",392.9,0,"VR")
1.0^DGBT
"FIA",392.9,392.9)
0
"FIA",392.9,392.91)
0
"IX",392,392,"AF",0)
392^AF^CROSS REFERENCE OF CURRENT MONTH AND DFN^MU^^R^IR^I^392^^^^^A
"IX",392,392,"AF",.1,0)
^^2^2^3120629^
"IX",392,392,"AF",.1,1,0)
THIS CROSS REFERENCE WILL CROSS REFERENCE THE WHOLE FILE USING THE 
"IX",392,392,"AF",.1,2,0)
CURRENT MONTH AND THE PATIENT'S DFN AND CLAIM DATE.
"IX",392,392,"AF",1)
S ^DGBT(392,"AF",X2(1),X2(2),X2(3))=""
"IX",392,392,"AF",2)
K ^DGBT(392,"AF",X1(1),X1(2),X1(3))
"IX",392,392,"AF",11.1,0)
^.114IA^3^3
"IX",392,392,"AF",11.1,1,0)
1^F^392^.01^5^1^F
"IX",392,392,"AF",11.1,1,2)
S X=$E(X,1,5)
"IX",392,392,"AF",11.1,2,0)
2^F^392^2^30^2^F
"IX",392,392,"AF",11.1,3,0)
3^F^392^.01^15^3^F
"KRN",19,2068,-1)
2^15
"KRN",19,2068,0)
DGBT BENE TRAVEL MENU^Beneficiary Travel Menu^^M^1^^^^^^^190
"KRN",19,2068,10,0)
^19.01IP^15^15
"KRN",19,2068,10,9,0)
11273^EDL^8
"KRN",19,2068,10,9,"^")
DGBT EDIT DENIAL LETTERS
"KRN",19,2068,10,10,0)
11272^MAN^9
"KRN",19,2068,10,10,"^")
DGBT MANUAL DEDUCTIBLE WAIVER
"KRN",19,2068,10,11,0)
11274^ALT^10
"KRN",19,2068,10,11,"^")
DGBT ALTERNATE INCOME
"KRN",19,2068,10,12,0)
11275^RDL^11
"KRN",19,2068,10,12,"^")
DGBT REPRINT DENIAL LETTERS
"KRN",19,2068,10,13,0)
11282^RPTS^12
"KRN",19,2068,10,13,"^")
DGBT TRAVEL REPORTS MENU
"KRN",19,2068,10,14,0)
11283
"KRN",19,2068,10,14,"^")
DGBT CLAIM DEDUCTIBLE PAID
"KRN",19,2068,"U")
BENEFICIARY TRAVEL MENU
"KRN",19,2070,-1)
4^7
"KRN",19,2070,0)
DGBT BENE TRAVEL CLAIM AMT RPT
"KRN",19,11272,-1)
0^4
"KRN",19,11272,0)
DGBT MANUAL DEDUCTIBLE WAIVER^Manual Deductible Waiver^^R^^^^^^^^BENEFICIARY TRAVEL^^
"KRN",19,11272,1,0)
^19.06^1^1^3120902^^^^
"KRN",19,11272,1,1,0)
This option is used to enter/edit/view manual deductible waiver requests.
"KRN",19,11272,20)

"KRN",19,11272,25)
EN^DGBTDW
"KRN",19,11272,99)
62493,58250
"KRN",19,11272,"U")
MANUAL DEDUCTIBLE WAIVER
"KRN",19,11273,-1)
0^3
"KRN",19,11273,0)
DGBT EDIT DENIAL LETTERS^Edit Denial Letters Template^^R^^DGBT EDIT DENIAL LTRS^^^^^y^BENEFICIARY TRAVEL
"KRN",19,11273,1,0)
^19.06^1^1^3120627^^^^
"KRN",19,11273,1,1,0)
OPTION WILL ALLOW A USER THE ABILITY TO EDIT THE EXISTING DENIAL LETTERS FOR EITHER A MILEAGE CLAIM DENIAL OR A SPECIAL MODE CLAIM DENIAL.
"KRN",19,11273,25)
EN^DGBTDLT
"KRN",19,11273,"U")
EDIT DENIAL LETTERS TEMPLATE
"KRN",19,11274,-1)
0^2
"KRN",19,11274,0)
DGBT ALTERNATE INCOME^BT Alternate Income Enter/Edit^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11274,1,0)
^19.06^2^2^3120830^^^^
"KRN",19,11274,1,1,0)
Manually enter income information for former POW and Veteran 
"KRN",19,11274,1,2,0)
width Hardship.
"KRN",19,11274,25)
DGBTALTI
"KRN",19,11274,"U")
BT ALTERNATE INCOME ENTER/EDIT
"KRN",19,11275,-1)
0^5
"KRN",19,11275,0)
DGBT REPRINT DENIAL LETTERS^Reprint Denial of Benefits Letters^^R^^^^^^^y^BENEFICIARY TRAVEL
"KRN",19,11275,1,0)
^19.06^1^1^3120604^^^^
"KRN",19,11275,1,1,0)
THIS WILL ALLOW THE USER TO REPRINT THE BT DENIAL OF BENEFITS LETTERS.
"KRN",19,11275,25)
REPRINT^DGBTDLT1
"KRN",19,11275,"U")
REPRINT DENIAL OF BENEFITS LET
"KRN",19,11276,-1)
0^11
"KRN",19,11276,0)
DGBT SUMMARY REPORT^Summary Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11276,1,0)
^19.06^1^1^3120713^^^^
"KRN",19,11276,1,1,0)
Report of statistical totals during a specified timeframe.
"KRN",19,11276,25)
EN^DGBTR121
"KRN",19,11276,"U")
SUMMARY REPORT
"KRN",19,11277,-1)
0^10
"KRN",19,11277,0)
DGBT SPECIAL MODE REPORT^Special Mode Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11277,1,0)
^19.06^1^1^3120627^^^
"KRN",19,11277,1,1,0)
Report on Special Mode Claims
"KRN",19,11277,25)
EN^DGBTR125
"KRN",19,11277,"U")
SPECIAL MODE REPORT
"KRN",19,11278,-1)
0^8
"KRN",19,11278,0)
DGBT CLERK REPORT^Clerk Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11278,1,0)
^19.06^1^1^3120703^^
"KRN",19,11278,1,1,0)
Run report on claims by clerk.
"KRN",19,11278,25)
EN^DGBTR123
"KRN",19,11278,"U")
CLERK REPORT
"KRN",19,11279,-1)
0^14
"KRN",19,11279,0)
DGBT AUDIT REPORT^Audit Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11279,1,0)
^19.06^1^1^3120713^^^^
"KRN",19,11279,1,1,0)
Audit of beneficiary travel vouchers
"KRN",19,11279,25)
EN^DGBTR122
"KRN",19,11279,"U")
AUDIT REPORT
"KRN",19,11280,-1)
0^12
"KRN",19,11280,0)
DGBT TRAVEL PATTERN REPORT^Travel Pattern Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11280,1,0)
^^1^1^3120627^
"KRN",19,11280,1,1,0)
Analyze distance/location to veteran claims for unique travel patterns.
"KRN",19,11280,25)
EN^DGBTR124
"KRN",19,11280,"U")
TRAVEL PATTERN REPORT
"KRN",19,11281,-1)
0^9
"KRN",19,11281,0)
DGBT FISCAL REPORT^Fiscal Report^^R^^^^^^^^BENEFICIARY TRAVEL
"KRN",19,11281,1,0)
^19.06^1^1^3120703^^^^
"KRN",19,11281,1,1,0)
Report of all voucher information.
"KRN",19,11281,25)
EN^DGBTR17
"KRN",19,11281,"U")
FISCAL REPORT
"KRN",19,11282,-1)
3^16
"KRN",19,11282,0)
DGBT TRAVEL REPORTS MENU^Beneficiary Travel Reports^^M^^^^^^^y^BENEFICIARY TRAVEL
"KRN",19,11282,1,0)
^19.06^1^1^3121211^^^^
"KRN",19,11282,1,1,0)
Menu for Beneficiary Travel Reports.
"KRN",19,11282,10,0)
^19.01IP^7^7
"KRN",19,11282,10,1,0)
11276^SUM^1
"KRN",19,11282,10,1,"^")
DGBT SUMMARY REPORT
"KRN",19,11282,10,2,0)
11279^AUD^2
"KRN",19,11282,10,2,"^")
DGBT AUDIT REPORT
"KRN",19,11282,10,3,0)
11278^CL^3
"KRN",19,11282,10,3,"^")
DGBT CLERK REPORT
"KRN",19,11282,10,4,0)
11280^PAT^4
"KRN",19,11282,10,4,"^")
DGBT TRAVEL PATTERN REPORT
"KRN",19,11282,10,5,0)
11277^SP^5
"KRN",19,11282,10,5,"^")
DGBT SPECIAL MODE REPORT
"KRN",19,11282,10,6,0)
11281^FISC^6
"KRN",19,11282,10,6,"^")
DGBT FISCAL REPORT
"KRN",19,11282,10,7,0)
2070^AMT^7
"KRN",19,11282,10,7,"^")
DGBT BENE TRAVEL CLAIM AMT RPT
"KRN",19,11282,99)
62838,67850
"KRN",19,11282,"U")
BENEFICIARY TRAVEL REPORTS
"KRN",19,11283,-1)
0^6
"KRN",19,11283,0)
DGBT CLAIM DEDUCTIBLE PAID^REMOTE CLAIM QUERY^^B^^^^^^^n^BENEFICIARY TRAVEL
"KRN",19,11283,1,0)
^19.06^1^1^3120830^^^
"KRN",19,11283,1,1,0)
OPTION IS FOR AN RPC CALL IN ^DGBTRDV.
"KRN",19,11283,25)
OPT^DGBTRDV
"KRN",19,11283,"U")
REMOTE CLAIM QUERY
"KRN",19.1,549,-1)
0^1
"KRN",19.1,549,0)
DGBT EDIT DENIAL LTRS^NEEDED TO EDIT DENIAL LETTERS^l
"KRN",19.1,549,1,0)
^^2^2^3120308^
"KRN",19.1,549,1,1,0)
THE HOLDER OF THIS KEY WILL BE ALLOWED TO EDIT THE DENIAL LETTER 
"KRN",19.1,549,1,2,0)
TEMPLATES.
"KRN",8994,2131,-1)
0^1
"KRN",8994,2131,0)
DGBT CLAIM DEDUCTIBLE PAID^RPC^DGBTRDV^2^P^^^0
"KRN",8994,2131,1,0)
^8994.01^2^2^3130117^^^^
"KRN",8994,2131,1,1,0)
THIS RPC IS USED BY BENEFICIARY TRAVEL PACKAGE TO RETRIEVE TRAVEL CLAIM 
"KRN",8994,2131,1,2,0)
INFORMATION ABOUT ANY TRAVEL CLAIMS FOR PATIENT.
"KRN",8994,2131,2,0)
^8994.02A^3^3
"KRN",8994,2131,2,1,0)
PATIENT ICN^1^30^1^2
"KRN",8994,2131,2,1,1,0)
^8994.021^1^1^3120717^^^^
"KRN",8994,2131,2,1,1,1,0)
PATIENTS ICN NUMBER FROM ^DPT(DFN).
"KRN",8994,2131,2,2,0)
CLAIM DATE^1^15^1^3
"KRN",8994,2131,2,2,1,0)
^8994.021^1^1^3120717^^^^
"KRN",8994,2131,2,2,1,1,0)
BENEFICIARY TRAVEL CLAIM DATE (NOT THE CURRENT DATE).
"KRN",8994,2131,2,3,0)
DGBTRET^4^^1^1
"KRN",8994,2131,2,3,1,0)
^8994.021^1^1^3130117^^^^
"KRN",8994,2131,2,3,1,1,0)
THE ARRAY THE DATA WILL BE RETURNED IN.
"KRN",8994,2131,2,"B","CLAIM DATE",2)

"KRN",8994,2131,2,"B","DGBTRET",3)

"KRN",8994,2131,2,"B","PATIENT ICN",1)

"KRN",8994,2131,2,"PARAMSEQ",1,3)

"KRN",8994,2131,2,"PARAMSEQ",2,1)

"KRN",8994,2131,2,"PARAMSEQ",3,2)

"KRN",8994,2131,3,0)
^8994.03^2^2^3130117^^^^
"KRN",8994,2131,3,1,0)
THE RPC WILL RETURN THE NUMBER OF CLAIMS AND AMOUNT OF DEDUCTIBLE PAID BY 
"KRN",8994,2131,3,2,0)
A PATIENT DURING THE CURRENT MONTH.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",190,-1)
1^1
"PKG",190,0)
BENEFICIARY TRAVEL^DGBT^Beneficiary Travel
"PKG",190,20,0)
^9.402P^^
"PKG",190,22,0)
^9.49I^1^1
"PKG",190,22,1,0)
1.0^3020319^3030325^66481
"PKG",190,22,1,"PAH",1,0)
20^3130203^123457000
"PKG",190,22,1,"PAH",1,1,0)
^^2^2^3130203
"PKG",190,22,1,"PAH",1,1,1,0)
Contains enhancements for Beneficiary Travel Package and 
"PKG",190,22,1,"PAH",1,1,2,0)
Mileage Reporting System.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
35
"RTN","DGBT1")
0^1^B120702431
"RTN","DGBT1",1,0)
DGBT1 ;ALB/SCK/BLD - BENEFICIARY TRAVEL DISPLAY SCREEN 1; 12/15/92  1/8/93 4/1/93 ; 10/31/05 1:11pm
"RTN","DGBT1",2,0)
 ;;1.0;Beneficiary Travel;**11,20**;September 25, 2001;Build 185
"RTN","DGBT1",3,0)
 Q
"RTN","DGBT1",4,0)
SCREEN ;  clear screen and write headers
"RTN","DGBT1",5,0)
 N TOTRIPS,ONEWAY,RT,MONTHDED,WAIVER,WTYPE,TTRIPS,TDED,TFIEN,DGBTOTHER
"RTN","DGBT1",6,0)
 D MONTOT(.TOTRIPS,.ONEWAY,.RT,.MONTHDED,.WAIVER,.WTYPE,.TTRIPS,.TDED) Q:$G(DGBTQUIT)
"RTN","DGBT1",7,0)
 S DGBTOTHER=0
"RTN","DGBT1",8,0)
 W @IOF
"RTN","DGBT1",9,0)
 W !?18,"Beneficiary Travel Claim Information <Screen 1>"
"RTN","DGBT1",10,0)
 W !!?2,"Claim Date: ",DGBTDTE
"RTN","DGBT1",11,0)
 D PID^VADPT6 W !!?8,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),"^",2)
"RTN","DGBT1",12,0)
 I '$G(CHZFLG)!('$D(^DGBT(392,DGBTDT,"D"))) W !!?5,"Address: ",VAPA(1) W:VAPA(2)]"" !?14,VAPA(2) W:VAPA(3)]"" !?14,VAPA(3) W !?14,VAPA(4),$S(VAPA(4)]"":", "_$P(VAPA(5),"^",2)_"  "_$P(VAPA(11),U,2),1:"UNSPECIFIED")
"RTN","DGBT1",13,0)
 I $G(CHZFLG),$D(^DGBT(392,DGBTDT,"D")) D
"RTN","DGBT1",14,0)
 .N CLMADD,CLMST
"RTN","DGBT1",15,0)
 .S CLMADD=^DGBT(392,DGBTDT,"D")
"RTN","DGBT1",16,0)
 .S CLMST=$P(CLMADD,"^",5) S:$G(CLMST)'="" CLMST=$P(^DIC(5,CLMST,0),"^",2)
"RTN","DGBT1",17,0)
 .W !!?5,"Address: ",$P(CLMADD,"^",1) W:$P(CLMADD,"^",2)]"" !?14,$P(CLMADD,"^",2) W:$P(CLMADD,"^",3)]"" !?14,$P(CLMADD,"^",3) W !?14,$P(CLMADD,"^",4),$S($P(CLMADD,"^",4)]"":", "_CLMST_"  "_$P(CLMADD,"^",6),1:"UNSPECIFIED")
"RTN","DGBT1",18,0)
 W !!?5,$$ADDCHG(DFN)
"RTN","DGBT1",19,0)
 ;
"RTN","DGBT1",20,0)
SETVAR  ;  if new claim, move in current info for elig, sc%
"RTN","DGBT1",21,0)
 I 'CHZFLG S DGBTELG=VAEL(1),DGBTCSC=VAEL(3)
"RTN","DGBT1",22,0)
 I +DGBTELG=3,'$E(DGBTCSC)=1 S DGBTCSC=1
"RTN","DGBT1",23,0)
 I ($P(DGBTELG,U,2)["NSC")&(DGBTDYFL)&'($G(DGBTREF)) D
"RTN","DGBT1",24,0)
 .I +$TR($P(DGBTINC,U),"$,","")<DGBTRXTH S $P(DGBTELG,U,2)=$P(DGBTELG,U,2)_" LOW INCOME"
"RTN","DGBT1",25,0)
 W !!," Eligibility: ",$P(DGBTELG,"^",2) W:DGBTCSC ?45,"SC%: ",$P(DGBTCSC,"^",2) ;W !
"RTN","DGBT1",26,0)
 I $O(VAEL(1,0))'="" W !," Other Elig.: " F I=0:0 S I=$O(VAEL(1,I)) Q:'I  D
"RTN","DGBT1",27,0)
 .W ?14,$P(VAEL(1,I),"^",2),!
"RTN","DGBT1",28,0)
 .I VAEL(1,I)["HOUSEBOUND" S DGBTOTHER=1
"RTN","DGBT1",29,0)
 .I VAEL(1,I)["AID & ATTENDANCE" S DGBTOTHER=1
"RTN","DGBT1",30,0)
 .I VAEL(1,I)["PENSION" S DGBTOTHER=1
"RTN","DGBT1",31,0)
 ;
"RTN","DGBT1",32,0)
SC ;  service connected status/information
"RTN","DGBT1",33,0)
 I DGBTCSC&($P(DGBTCSC,"^",2)'>29) W !!,"Disabilities:" S I3=""
"RTN","DGBT1",34,0)
 N DGQUIT
"RTN","DGBT1",35,0)
 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGBT1",36,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$P(^(0),"^",1)_" ("_+$P(I1,"^",2)_"%-"_$S($P(I1,"^",3):"SC",1:"NSC")_")",1:""),I3=I1
"RTN","DGBT1",37,0)
 . I $Y>(IOSL-3) D PAUSE I DGQUIT=0 W @IOF
"RTN","DGBT1",38,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGBT1",39,0)
 .D
"RTN","DGBT1",40,0)
 ..I DGBTCSC&($P(DGBTCSC,"^",2)'>29) Q
"RTN","DGBT1",41,0)
 ..I I=$O(^DPT(DFN,.372,0)) W !
"RTN","DGBT1",42,0)
 . W ?16 W I2,!
"RTN","DGBT1",43,0)
 ;
"RTN","DGBT1",44,0)
INCOME ;  income and eligibility information
"RTN","DGBT1",45,0)
 ;DAYFLG = NUMBER OF DAYS SINCE LAST MEANS TEST
"RTN","DGBT1",46,0)
 N DGBTIFL,DGBTDATA,TESTDATE,DGBTDAYS,DGNOTEST,RXCP,RXCPST,DGRXDATA,RXDAYS,RXCPDATA,RXCPTS,DGBTST,BUSEXP,LOWINC,NOTEST
"RTN","DGBT1",47,0)
 ;
"RTN","DGBT1",48,0)
 ;
"RTN","DGBT1",49,0)
 S DGBTIFL=$P(DGBTINC,U,2)
"RTN","DGBT1",50,0)
 S (DAYFLG,RXDAYS,RXCPTS)=""
"RTN","DGBT1",51,0)
 ;CHECK HOW DAYS SINCE LAST MEANS TEST
"RTN","DGBT1",52,0)
 I $$DAYSTEST(DFN,.DAYFLG,.RXDAYS,.RXCPST,.LOWINC,.DGNOTEST)
"RTN","DGBT1",53,0)
 ; 
"RTN","DGBT1",54,0)
 S BUSEXP=$$ABP^DGBTUTL(DFN)
"RTN","DGBT1",55,0)
 ;
"RTN","DGBT1",56,0)
 ;CHANGED FOR DGBT*1*20
"RTN","DGBT1",57,0)
 S ELIGTYP=$$GET1^DIQ(8.1,3_",",.01)
"RTN","DGBT1",58,0)
 I '$G(DGBTOTHER),'$G(LOWINC),($G(VAEL(3))),$P($G(VAEL(3)),"^",2)<30,($P(VAEL(1),"^",2))=ELIGTYP W !?2,"BT Alert: ELIGIBLE FOR SC APPOINTMENTS ONLY"
"RTN","DGBT1",59,0)
 I $G(BUSEXP) D
"RTN","DGBT1",60,0)
 .S Y=BUSEXP X ^DD("DD")
"RTN","DGBT1",61,0)
 .W !!?2,"BT Alert: BUS PASS ISSUED - EXPIRES ",Y
"RTN","DGBT1",62,0)
 ; 
"RTN","DGBT1",63,0)
 I (DAYFLG!DGBTINCA),'$G(RXCPST) D  D QUIT Q    ;valid mt in last 365 days + PAVEL
"RTN","DGBT1",64,0)
 .W !!?2,"Income: ",$P(DGBTINC,U),DGBTDTY,?35,"Source of Income:  ",$S(DGBTIFL="M":"MEANS TEST",DGBTIFL="C":"COPAY TEST",DGBTIFL="P":"Alt.Income POW",DGBTIFL="H":"Alt. Income Hardship",1:"")
"RTN","DGBT1",65,0)
 .W !?2,"No. of Dependents: ",DGBTDEP
"RTN","DGBT1",66,0)
 .;
"RTN","DGBT1",67,0)
 .I DGBTMTS]"" W:$P(DGBTMTS,"^")'="N" ?40,"MT Status: ",$S($P(DGBTMTS,"^")="R":"REQUIRED",$P(DGBTMTS,"^")="P":$P($P(DGBTMTS,"^",2)," "),DGBTMTS=U!($G(RXCPST)):" NOT APPLICABLE",1:$P(DGBTMTS,"^",2))
"RTN","DGBT1",68,0)
 .W:$P(DGBTMTS,"^")="P" !?68,$P($P(DGBTMTS,"^",2)," ",2)
"RTN","DGBT1",69,0)
 .I $P(DGBTMTS,"^")="N" W !!?20,"MEANS TEST ",$P(DGBTMTS,"^",2)
"RTN","DGBT1",70,0)
 .;
"RTN","DGBT1",71,0)
 .W !!?2,"BT Income: ",$S($D(DGBTCA):DGBTCA,1:"NOT RECORDED") W:$D(DGBTCE) ?25,"Certified Eligible: ",$S(DGBTCE:"YES",1:"NO"),?53,"Date Certified: ",$S($D(DGBTCD):DGBTCD,1:"NOT RECORDED")
"RTN","DGBT1",72,0)
 .I $D(DGBTCE) I DGBTCE'=1 W *7,*7,!!?8,"* * * NOTE * * PATIENT HAS BEEN CERTIFIED INELIGIBLE BASED ON INCOME"
"RTN","DGBT1",73,0)
 .S DGBTINFL="" I $D(DGBTINC),$D(DGBTCA),$P(DGBTINC,U)'=DGBTCA,$P(DGBTMTS,"^")'="N" S DGBTINFL=" * * * * Discrepancy exists in incomes reported, please verify * * * *" W !!?5,DGBTINFL
"RTN","DGBT1",74,0)
 .I '$D(DGBTRET(0)) W !,?50,$$WVEXP     ;*DGBT*1.0*20 BLD * E2
"RTN","DGBT1",75,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)'="MAN" W !,?50,$$WVEXP ; /*DGBT*1.0*20 RFE */
"RTN","DGBT1",76,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)="MAN" W !,?52,"WAIVER EXPIRES: ",$P(DGBTRET(0),"^",7)
"RTN","DGBT1",77,0)
 .F I=$Y:1:20 W !
"RTN","DGBT1",78,0)
 ;
"RTN","DGBT1",79,0)
 ;no valid mt test in last 365 days or no test has been done
"RTN","DGBT1",80,0)
 I 'DAYFLG D  D QUIT Q
"RTN","DGBT1",81,0)
  .W !!?2,"Income: ","",?40,"Source of Income:  ",""
"RTN","DGBT1",82,0)
 .W !?2,"No. of Dependents: ",DGBTDEP
"RTN","DGBT1",83,0)
 .I DGBTMTS]"" W ?40,"MT Status: ","EXPIRED"
"RTN","DGBT1",84,0)
 .W !!?2,"BT Income: ",$S($D(DGBTCA):DGBTCA,1:"NOT RECORDED") W:$D(DGBTCE) ?25,"Certified Eligible: ",$S(DGBTCE:"YES",1:"NO"),?53,"Date Certified: ",$S($D(DGBTCD):DGBTCD,1:"NOT RECORDED")
"RTN","DGBT1",85,0)
 .I '$D(DGBTRET(0)) W !,?50,$$WVEXP     ;*DGBT*1.0*20 BLD * E2
"RTN","DGBT1",86,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)'="MAN" W !,?50,$$WVEXP ; /*DGBT*1.0*20 RFE */
"RTN","DGBT1",87,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)="MAN" W !,?52,"WAIVER EXPIRES: ",$P(DGBTRET(0),"^",7)
"RTN","DGBT1",88,0)
 .F I=$Y:1:20 W !
"RTN","DGBT1",89,0)
 ;
"RTN","DGBT1",90,0)
 I DAYFLG,$G(RXCPST) D
"RTN","DGBT1",91,0)
 .I $G(RXCP)'=1,$P($G(DGBTINCA),"^",2)'="" W !!?2,"Income: ",$S($P($G(DGBTINCA),"^",2)'="":$P(DGBTINCA,"^",2),1:""),DGBTDTY,?40,"Source of Income:  ","Alternate Income/"_$S($P(DGBTINCA,"^",4)="H":"Hardship",1:"POW")
"RTN","DGBT1",92,0)
 .I $G(RXCP)'=1,$P($G(DGBTINCA),"^",2)="" W !!?2,"Income: ",DGBTDTY,?40,"Source of Income:  ","COPAY TEST"               ;RXCP'=1 Copy NON-EXEMPT
"RTN","DGBT1",93,0)
 .I $G(RXCP)=1,$P($G(DGBTINCA),"^",2)'="" W !!?2,"Income: ",$S($P($G(DGBTINCA),"^",2)'="":$P(DGBTINCA,"^",2),1:""),DGBTDTY,?40,"Source of Income:  ","Alternate Income/"_$S($P(DGBTINCA,"^",4)="H":"Hardship",1:"POW")
"RTN","DGBT1",94,0)
 .I $G(RXCP)=1,$P($G(DGBTINCA),"^",2)="" W !!?2,"Income: ",$P(DGBTINC,U),DGBTDTY,?40,"Source of Income:  ","COPAY TEST"  ;RXCP=1  Copay EXEMPT
"RTN","DGBT1",95,0)
 .W !?2,"No. of Dependents: ",DGBTDEP
"RTN","DGBT1",96,0)
 .I DGBTMTS]"" W ?40,"MT Status: ","NOT APPLICABLE"
"RTN","DGBT1",97,0)
 .W !!?2,"BT Income: ","INELIGIBLE"
"RTN","DGBT1",98,0)
 .I '$D(DGBTRET(0)) W ?50,$$WVEXP     ;*DGBT*1.0*20 BLD * E2
"RTN","DGBT1",99,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)'="MAN" W ?50,$$WVEXP ; /*DGBT*1.0*20 RFE */
"RTN","DGBT1",100,0)
 .I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)="MAN" W ?52,"WAIVER EXPIRES: ",$P(DGBTRET(0),"^",7)
"RTN","DGBT1",101,0)
 .F I=$Y:1:20 W !
"RTN","DGBT1",102,0)
 ;
"RTN","DGBT1",103,0)
QUIT ;
"RTN","DGBT1",104,0)
 K I1,I2,I3
"RTN","DGBT1",105,0)
 D MONTDISP(TOTRIPS,ONEWAY,RT,MONTHDED,WAIVER,WTYPE)
"RTN","DGBT1",106,0)
 Q
"RTN","DGBT1",107,0)
 ;
"RTN","DGBT1",108,0)
MONTOT(TOTRIPS,ONEWAY,RT,MONTHDED,WAIVER,WTYPE,TTRIPS,TDED) ;
"RTN","DGBT1",109,0)
 ;
"RTN","DGBT1",110,0)
 N RETURN
"RTN","DGBT1",111,0)
 S RETURN=""
"RTN","DGBT1",112,0)
 ;Return values: total number of trips ^ number of one way trips ^ number of round trips ^ deductible (all this for the month) ^ waiver y/n (y will be 1, n will be no) ^
"RTN","DGBT1",113,0)
 ;total number of trips as of this claim date ^ deductible as of this claim date
"RTN","DGBT1",114,0)
 ;from the local data base
"RTN","DGBT1",115,0)
 S RETURN=$$WAIV^DGBTRDVW(DFN,DGBTDTI)
"RTN","DGBT1",116,0)
 S ONEWAY=$S($P($G(RETURN),"^",2):$P($G(RETURN),"^",2),1:0)
"RTN","DGBT1",117,0)
 S RT=$S($P($G(RETURN),"^",3):$P($G(RETURN),"^",3),1:0)
"RTN","DGBT1",118,0)
 S WAIVER=$S($P($G(RETURN),"^",5)=1:"YES",1:"NO")
"RTN","DGBT1",119,0)
 S MONTHDED=$S($P($G(RETURN),"^",4):$P($G(RETURN),"^",4),1:0)
"RTN","DGBT1",120,0)
 S WTYPE=$P(RETURN,"^",5)
"RTN","DGBT1",121,0)
 S TOTRIPS=(RT*2)+ONEWAY
"RTN","DGBT1",122,0)
 S TTRIPS=$S($P($G(RETURN),U,8):$P($G(RETURN),U,8),1:0)
"RTN","DGBT1",123,0)
 S TDED=$S($P($G(RETURN),U,9):$P($G(RETURN),U,9),1:0)
"RTN","DGBT1",124,0)
 S DGBTREF=0
"RTN","DGBT1",125,0)
 S DGBTREF=$$LSTMTRIN(DFN,DGBTDTI)
"RTN","DGBT1",126,0)
 I (WAIVER="NO")&($G(DGBTDYFL)) D
"RTN","DGBT1",127,0)
 .I DGBTNSC D  Q
"RTN","DGBT1",128,0)
 ..N INCOME
"RTN","DGBT1",129,0)
 ..S INCOME=+$TR($P($G(DGBTINC),U),"$,","")
"RTN","DGBT1",130,0)
 ..I INCOME'="",INCOME<DGBTRXTH,'$G(DGBTREF) S WAIVER="YES",$P(RETURN,U,5)=1,$P(RETURN,U,6)="NSC"
"RTN","DGBT1",131,0)
 ..;I ($P($G(DGBTINC),"^",1)'="")&+$TR($P(DGBTINC,U),"$,","")<DGBTRXTH,'$G(DGBTREF) S WAIVER="YES",$P(RETURN,U,5)=1,$P(RETURN,U,6)="NSC"
"RTN","DGBT1",132,0)
 .I '$G(DGBTREF)&(+$G(VAEL(3)))&($P($G(DGBTINC),"^",1)'="")&(+$TR($P(DGBTINC,U),"$,","")<DGBTMTTH) S WAIVER="YES",$P(RETURN,U,5)=1,$P(RETURN,U,6)="LI" Q
"RTN","DGBT1",133,0)
 .I ($P($G(DGBTINC),"^",1)'="")&+$$LI^DGBTUTL(DFN,DGBTDTI,DGBTDEP,,DGBTINCA)'=0 S WAIVER="YES",$P(RETURN,U,5)=1,$P(RETURN,U,6)="LI"
"RTN","DGBT1",134,0)
 .I $P($G(DGBTINC),"^",1)="" S $P(RETURN,"^",6)=""
"RTN","DGBT1",135,0)
 I TOTRIPS<6,MONTHDED<18,$P(RETURN,"^",5)=0 D  Q:$G(DGBTQUIT)      ;if less than 6 trips and no waiver check for remote facility visits
"RTN","DGBT1",136,0)
 .S RETURN=""
"RTN","DGBT1",137,0)
 .D OPT^DGBTRDV(DFN,DGBTDTI) I $G(RDVMSG) W $$PAUSE^DGBTUTL(0) S:$G(Y)="^" DGBTQUIT=1 Q:$G(DGBTQUIT)!($G(DGBTRET(0))="")
"RTN","DGBT1",138,0)
 .I $G(RDVMSG) W $$PAUSE^DGBTUTL(0)
"RTN","DGBT1",139,0)
 .S ONEWAY=$G(ONEWAY)+$P(RETURN,"^",2)
"RTN","DGBT1",140,0)
 .S RT=$G(RT)+$P(RETURN,"^",3)
"RTN","DGBT1",141,0)
 .S MONTHDED=$G(MONTHDED)+$P(RETURN,"^",4)
"RTN","DGBT1",142,0)
 .S TOTRIPS=TOTRIPS+$P(RETURN,"^",1)
"RTN","DGBT1",143,0)
 .S TTRIPS=TTRIPS+$P(RETURN,U,8)
"RTN","DGBT1",144,0)
 .S TDED=TDED+$P(RETURN,U,9)
"RTN","DGBT1",145,0)
 .S $P(RETURN,"^",1)=TOTRIPS
"RTN","DGBT1",146,0)
 .S $P(RETURN,"^",8)=TTRIPS
"RTN","DGBT1",147,0)
 .S $P(RETURN,"^",9)=TDED
"RTN","DGBT1",148,0)
 .I $P(RETURN,"^",5)'=1 S $P(RETURN,"^",5)=$S(TTRIPS>6:1,TDED>18:0,1:$P(RETURN,"^",5))
"RTN","DGBT1",149,0)
 .S WAIVER=$S($P(RETURN,"^",5)=1:"YES",1:"NO")
"RTN","DGBT1",150,0)
 I WAIVER'="YES" S WAIVER=$S($P(RETURN,"^",1)>6:"YES",1:"NO")
"RTN","DGBT1",151,0)
 S MONTOT=$G(TOTRIPS)_"^"_$G(ONEWAY)_"^"_$G(RT)_"^"_$G(MONTHDED)_"^"_$G(WAIVER)_U_$G(TTRIPS)_U_$G(TDED)
"RTN","DGBT1",152,0)
 Q
"RTN","DGBT1",153,0)
 ;
"RTN","DGBT1",154,0)
MONTDISP(TOTRIPS,ONEWAY,RT,MONTHDED,WAIVER,WTYPE) ;
"RTN","DGBT1",155,0)
 ;
"RTN","DGBT1",156,0)
 W !?2,"TOTAL TRIPS THIS MONTH: ",$G(ONEWAY)_" ONE WAY, ",$G(RT)_" RD TRIP"
"RTN","DGBT1",157,0)
 W ?52,"WAIVER GRANTED: ",$G(WAIVER)
"RTN","DGBT1",158,0)
 W !?2,"TOTAL DEDUCTIBLE THIS MONTH: ",MONTHDED
"RTN","DGBT1",159,0)
 ;
"RTN","DGBT1",160,0)
 Q
"RTN","DGBT1",161,0)
 ;
"RTN","DGBT1",162,0)
PAUSE   ;added with DGBT*1*11
"RTN","DGBT1",163,0)
 I $E(IOST,1,2)["C-" N DIR S DIR(0)="E" D ^DIR S DGQUIT='Y
"RTN","DGBT1",164,0)
 Q
"RTN","DGBT1",165,0)
 ;
"RTN","DGBT1",166,0)
DAYSTEST(DFN,DAYFLG,RXDAYS,RXCPST,LOWINC,NOTEST) ;determines whether or not a valid MT in last 365 days.
"RTN","DGBT1",167,0)
 N DGBTDATA,TESTDATA,DGBTDAYS,DGMTSTAT,DGBTST,DGRXDATA,DGTSTTYP,DGMTST,X,DGMTYPT1,THRESHLD,INCOM
"RTN","DGBT1",168,0)
 S DGMTYPT1=3,DAYFLG=0,(DGMTST,RXCPST,THRESHLD,INCOM)=""
"RTN","DGBT1",169,0)
 S DGBTDATA=$$LST^DGMTCOU1(DFN,$P(DGBTDT,".",1),.DGMTYPT1)
"RTN","DGBT1",170,0)
 I DGBTDATA'="" D
"RTN","DGBT1",171,0)
 .S TESTDATE=$$LSTMTDT(DFN)
"RTN","DGBT1",172,0)
 .S DGBTDAYS=$$FMDIFF^XLFDT($P(DGBTDTI,".",1),TESTDATE)            ;get number of days from claim date to last MT
"RTN","DGBT1",173,0)
 .S DAYFLG=$S(DGBTDAYS>365:0,1:1)                   ;if greater than 365 days then no valid MT test
"RTN","DGBT1",174,0)
 .I DGMTYPT1=1 S DGMTST=$P(DGBTDATA,"^",3)="NO LONGER REQUIRED"
"RTN","DGBT1",175,0)
 .I DGMTYPT1=2 S RXCPST=$P(DGBTDATA,"^",3)="NON-EXEMPT"
"RTN","DGBT1",176,0)
 .S:RXCPST'=1 RXCP=1                             ;************************
"RTN","DGBT1",177,0)
 .S DGBTRET=$S(+$$LI^DGBTUTL(DFN,DGBTDTI,DGBTDEP,,DGBTINCA):"1^",1:"0^") ;Get Low Income + count Alternate Income   PAVEL
"RTN","DGBT1",178,0)
 .S LOWINC=$P(DGBTRET,"^",1)
"RTN","DGBT1",179,0)
 I $G(DAYFLG)=0 S DGNOTEST=1
"RTN","DGBT1",180,0)
 Q ""
"RTN","DGBT1",181,0)
 ;
"RTN","DGBT1",182,0)
ADDCHG(DFN) ;this will print the permanet Address last changed date or the Temporary Address last change date
"RTN","DGBT1",183,0)
 ;
"RTN","DGBT1",184,0)
 N DATE,TMPADD
"RTN","DGBT1",185,0)
 S TMPADD=$S($$GET1^DIQ(2,DFN,.12105)="YES":0,1:1)
"RTN","DGBT1",186,0)
 I TMPADD D
"RTN","DGBT1",187,0)
 .S DATE="Date Address Last Changed: "_$P($$GET1^DIQ(2,DFN,.118),"@",1)
"RTN","DGBT1",188,0)
 E  S DATE="Date Address Last Changed: "_$P($$GET1^DIQ(2,DFN,.12113),"@",1)
"RTN","DGBT1",189,0)
 ;
"RTN","DGBT1",190,0)
 Q DATE
"RTN","DGBT1",191,0)
 ; 
"RTN","DGBT1",192,0)
WVEXP() ; Waiver expiration date  ; /* Tagline added DGBT*1.0*20 RFE */
"RTN","DGBT1",193,0)
 N RETURN
"RTN","DGBT1",194,0)
 I $$WVELG Q "WAIVER EXPIRES: PENSION"
"RTN","DGBT1",195,0)
 N WVREQEXP
"RTN","DGBT1",196,0)
 I $D(^DGBT(392.7,"C",DFN)) S WVREQEXP=$$WVREQ("IN")
"RTN","DGBT1",197,0)
 I $G(WVREQEXP)="PENSION" Q "WAIVER EXPIRES: PENSION"
"RTN","DGBT1",198,0)
 N DGMTYPT1,TESTDATEI
"RTN","DGBT1",199,0)
 S TESTDATE=$$TESTDATE
"RTN","DGBT1",200,0)
 S TESTDATEI=$$DTFORMI(TESTDATE)
"RTN","DGBT1",201,0)
 I TESTDATEI<$P(DGBTDTI,".") Q ""
"RTN","DGBT1",202,0)
 I +$G(DGBTINCA) Q "WAIVER EXPIRES: "_TESTDATE
"RTN","DGBT1",203,0)
 I '+$G(LOWINC) Q $$WVREQ("EX")
"RTN","DGBT1",204,0)
 N LABL
"RTN","DGBT1",205,0)
 S LABL=$S($G(DGMTYPT1)=1:"MEANS TEST ",$G(DGMTYPT1)=2:"COPAY TEST ",1:"WAIVER ")_"EXPIRES: "
"RTN","DGBT1",206,0)
 Q LABL_TESTDATE
"RTN","DGBT1",207,0)
 ;
"RTN","DGBT1",208,0)
TESTDATE() ;
"RTN","DGBT1",209,0)
 I (+$G(DGBTINCA)),($G(WVREQEXP)>$P(DGBTINCA,U,5)) Q $$DTFORM(WVREQEXP)
"RTN","DGBT1",210,0)
 I +$G(DGBTINCA) Q $$DTFORM($P(DGBTINCA,U,5))
"RTN","DGBT1",211,0)
 S DGMTYPT1=3
"RTN","DGBT1",212,0)
 S TESTDATE=$P($$LST^DGMTCOU1(DFN,DGBTDTI,.DGMTYPT1),U,2)
"RTN","DGBT1",213,0)
 I 'DAYFLG S (TESTDATE,DGMTYPT1)=0
"RTN","DGBT1",214,0)
 I (+TESTDATE=0),($E($G(WVREQEXP),1,3)>$E(DGBTDTI,1,3)) Q $$DTFORM(WVREQEXP)
"RTN","DGBT1",215,0)
 I +TESTDATE=0 Q "12/31/"_$E(DGBTDTI,2,3)
"RTN","DGBT1",216,0)
 Q $$DTFORM(($E(TESTDATE,1,3)+1)_$E(TESTDATE,4,7))
"RTN","DGBT1",217,0)
 ;
"RTN","DGBT1",218,0)
DTFORM(INTDT) ;
"RTN","DGBT1",219,0)
 Q $E(INTDT,4,5)_"/"_$E(INTDT,6,7)_"/"_$E(INTDT,2,3)
"RTN","DGBT1",220,0)
 ;
"RTN","DGBT1",221,0)
DTFORMI(TESTDATE) ; 
"RTN","DGBT1",222,0)
 Q 3_$P(TESTDATE,"/",3)_$P(TESTDATE,"/",2)_$P(TESTDATE,"/")
"RTN","DGBT1",223,0)
 ;
"RTN","DGBT1",224,0)
WVELG() ; Eligibility for waiver being PENSION DGBT*1.0*20 RFE
"RTN","DGBT1",225,0)
 I VAEL(1)["PENSION" Q 1
"RTN","DGBT1",226,0)
 I $P(VAEL(1),"^",2)="AID & ATTENDANCE" Q 1
"RTN","DGBT1",227,0)
 I $P(VAEL(1),"^",2)="HOUSEBOUND" Q 1
"RTN","DGBT1",228,0)
 N HIT
"RTN","DGBT1",229,0)
 S (HIT,I)=""
"RTN","DGBT1",230,0)
 F  S I=$O(VAEL(1,I)) Q:I=""  D  Q:HIT
"RTN","DGBT1",231,0)
 .I VAEL(1,I)["PENSION" S HIT=1 Q
"RTN","DGBT1",232,0)
 .I $P(VAEL(1,I),"^",2)="AID & ATTENDANCE" S HIT=1 Q
"RTN","DGBT1",233,0)
 .I $P(VAEL(1,I),"^",2)="HOUSEBOUND" S HIT=1 Q
"RTN","DGBT1",234,0)
 Q HIT
"RTN","DGBT1",235,0)
 ;
"RTN","DGBT1",236,0)
YEAR(DT1) ; DT2 will be a year after DT1  ; /*Tagline added DGBT*1.0*20 RFE */
"RTN","DGBT1",237,0)
 N DT2,MO,YR
"RTN","DGBT1",238,0)
 S DT2=$$FMTH^XLFDT(DT1,1)+365
"RTN","DGBT1",239,0)
 S YR=+$E(DT1,2,3),MO=+$E(DT1,4,5)
"RTN","DGBT1",240,0)
 I (YR#4=3),(MO>2) S DT2=DT2+1 ; Leap year
"RTN","DGBT1",241,0)
 I (YR#4=0),(MO<3) S DT2=DT2+1 ; Leap year
"RTN","DGBT1",242,0)
 Q DT2
"RTN","DGBT1",243,0)
 ;
"RTN","DGBT1",244,0)
WVREQ(INEX) ; Manual deductible waiver request DGBT*1.0*20 RFE
"RTN","DGBT1",245,0)
 I '$D(^DGBT(392.7,"C",DFN)) Q ""
"RTN","DGBT1",246,0)
 N DGBTDW,EXPDT
"RTN","DGBT1",247,0)
 S (DGBTDW,I)=""
"RTN","DGBT1",248,0)
 F  S I=$O(^DGBT(392.7,"C",DFN,I),-1) Q:I=""  D  Q:DGBTDW'=""
"RTN","DGBT1",249,0)
 .I $$GET1^DIQ(392.7,I,97,"I") Q
"RTN","DGBT1",250,0)
 . S EXPDT=$$GET1^DIQ(392.7,I,8,"I")
"RTN","DGBT1",251,0)
 . I EXPDT="PENSION" S DGBTDW=1 Q
"RTN","DGBT1",252,0)
 . I $E(I,1,3)=$E(DGBTA,1,3) S DGBTDW=^DGBT(392.7,I,0) Q
"RTN","DGBT1",253,0)
 . I $E(I,1,3)'=($E(DGBTA,1,3)-1) Q
"RTN","DGBT1",254,0)
 . I $$GET1^DIQ(392.7,I,8,"I")<$P(DGBTA,".") Q
"RTN","DGBT1",255,0)
 . S DGBTDW=^DGBT(392.7,I,0)
"RTN","DGBT1",256,0)
 I DGBTDW="" Q ""
"RTN","DGBT1",257,0)
 I $P(DGBTDW,"^",3)=0 Q ""
"RTN","DGBT1",258,0)
 I $P(DGBTA,".")<$P($P(DGBTDW,U),".") Q ""
"RTN","DGBT1",259,0)
 I INEX="IN" Q EXPDT
"RTN","DGBT1",260,0)
 I $G(EXPDT)="PENSION" Q "WAIVER EXPIRES: PENSION"
"RTN","DGBT1",261,0)
 I EXPDT<$P(DGBTDTI,".") Q ""
"RTN","DGBT1",262,0)
 Q "WAIVER EXPIRES: "_$$DTFORM(EXPDT)
"RTN","DGBT1",263,0)
 ;
"RTN","DGBT1",264,0)
LSTMTDT(DFN) ;this will return the last means test date
"RTN","DGBT1",265,0)
 N MTIEN
"RTN","DGBT1",266,0)
 S MTIEN=""
"RTN","DGBT1",267,0)
 S MTIEN=$O(^DGMT(408.31,"C",DFN,MTIEN),-1)
"RTN","DGBT1",268,0)
 S LSTMTDT=$P(^DGMT(408.31,MTIEN,0),"^",1)
"RTN","DGBT1",269,0)
 Q LSTMTDT
"RTN","DGBT1",270,0)
 ;
"RTN","DGBT1",271,0)
LSTMTRIN(DFN,DGBTDTI) ;this willl return whether the patient refused to give income
"RTN","DGBT1",272,0)
 N MTIEN,REFUSED
"RTN","DGBT1",273,0)
 S REFUSED=1
"RTN","DGBT1",274,0)
 S MTIEN=+$$LST^DGMTCOU1(DFN,DGBTDTI,3)
"RTN","DGBT1",275,0)
 I MTIEN'="" S REFUSED=$$GET1^DIQ(408.31,MTIEN,.14,"I")
"RTN","DGBT1",276,0)
 Q REFUSED
"RTN","DGBT2")
0^8^B17619778
"RTN","DGBT2",1,0)
DGBT2 ;ALB/GAH - BENEFICIARY TRAVEL SCREEN 2 ; 10/11/2006
"RTN","DGBT2",2,0)
 ;;1.0;Beneficiary Travel;**7,8,13,20**;September 25, 2001;Build 185
"RTN","DGBT2",3,0)
 Q
"RTN","DGBT2",4,0)
SCREEN ;
"RTN","DGBT2",5,0)
 Q:'$D(VADM)
"RTN","DGBT2",6,0)
 W @IOF
"RTN","DGBT2",7,0)
 W !?18,"Beneficiary Travel Claim Information <Screen 2>"
"RTN","DGBT2",8,0)
 D PID^VADPT6 W !!?8,"Name: ",VADM(1),?42,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),"^",2)
"RTN","DGBT2",9,0)
 D PAST,ADM
"RTN","DGBT2",10,0)
 W !!?2,"Visits For: " W $P(DGBTDTE,"@")
"RTN","DGBT2",11,0)
 S DGBTAS="" S:DGBTAD DGBTAS=$S($P(DGBTDD,".")=$P(DGBTDTI,"."):"D",$P(DGBTAD,".")=$P(DGBTDTI,"."):"A",$P(DGBTAD,".")&'$P(DGBTDD,"."):"I",$P(DGBTAD,".")&($P(DGBTDTI,".")'>$P(DGBTDD,".")):"II",1:"")
"RTN","DGBT2",12,0)
 I DGBTAS]"" W $S(DGBTAS="A":" * * * * ADMITTED ON THIS DATE * * * *",DGBTAS="D":" * * * * DISCHARGED ON THIS DATE * * * *",DGBTAS="I":" * * * * CURRENTLY AN INPATIENT * * * *",DGBTAS="II":" * * * INPATIENT STATUS * * *",1:"")
"RTN","DGBT2",13,0)
 I DGBTAS]"" W !!," Admitted On: " S Y=+DGBTAD X ^DD("DD") W Y K Y W:$D(^DPT(DFN,.1)) ?40,"Ward Location: ",^DPT(DFN,.1) I DGBTDD W ?40,"Discharge Date: " S Y=+DGBTDD X ^DD("DD") W Y K Y
"RTN","DGBT2",14,0)
 W !!,"Appointments: " W:'$D(DGBTCL) "NONE RECORDED FOR THIS DATE"
"RTN","DGBT2",15,0)
 D
"RTN","DGBT2",16,0)
 . I $D(DGBTCL("ERROR")) W ?14,DGBTCL("ERROR") Q
"RTN","DGBT2",17,0)
 . I $D(DGBTCL) F I=0:0 S I=$O(DGBTCL(I)) Q:'I  D APPT
"RTN","DGBT2",18,0)
 N DGVAL,DGCBK,DGDT1
"RTN","DGBT2",19,0)
 ;
"RTN","DGBT2",20,0)
 S DGVAL("DFN")=DFN,DGVAL("BDT")=DGBTDTI\1,DGVAL("EDT")=DGVAL("BDT")_".9999"
"RTN","DGBT2",21,0)
 S DGCBK="I $P(SDOE0,U,8)=2 D WRTVIS^DGBT2(SDOE0) S DGDT1=+SDOE0",DGDT1=""
"RTN","DGBT2",22,0)
 D SCAN^DGSDU("PATIENT/DATE",.DGVAL,"",DGCBK,1,.DGQUERY)
"RTN","DGBT2",23,0)
EXIT ;
"RTN","DGBT2",24,0)
 K VAIP
"RTN","DGBT2",25,0)
 Q
"RTN","DGBT2",26,0)
 ;
"RTN","DGBT2",27,0)
WRTVIS(DGBTCSN) ;
"RTN","DGBT2",28,0)
 S:$S('DGDT1:0,1:+SDOE0'=DGDT1) SDSTOP=1
"RTN","DGBT2",29,0)
 I '$G(DGDT1) W !!?45,"Elig for Visit:",?65,"Appt Type:",!?45,"______________",?65,"_________",!!,"Clinic Stop: "
"RTN","DGBT2",30,0)
 I 'SDSTOP D
"RTN","DGBT2",31,0)
 .N DGBTCS
"RTN","DGBT2",32,0)
 .S:$P(DGBTCSN,U,3) DGBTCS=$P(DGBTCSN,U,3)
"RTN","DGBT2",33,0)
 .W ?14,$E($S($D(^DIC(40.7,+$P($G(DGBTCSN),U,3),0)):$P(^(0),U),1:"Unknown"),1,20),?45,$S($D(^DIC(8,+$P(DGBTCSN,U,13),0)):$E($P(^(0),U),1,18),1:"")
"RTN","DGBT2",34,0)
 .D STOP
"RTN","DGBT2",35,0)
 Q
"RTN","DGBT2",36,0)
 ;
"RTN","DGBT2",37,0)
ADM S DGBTAN=$S($D(^DPT(DFN,.105)):^(.105),1:"")
"RTN","DGBT2",38,0)
 I 'DGBTAN D NOW^%DTC S DGBTDI=+$O(^DGPM("ATID3",DFN,9999999.9999999-%)),DGBTDN=+$O(^(DGBTDI,0)),DGBTAN=$S($D(^DGPM(DGBTDN,0)):$P(^(0),"^",14),1:"")
"RTN","DGBT2",39,0)
 S DGBTAD=$S($D(^DGPM(+DGBTAN,0)):^(0),1:""),DGBTDD=$S($D(^DGPM(+$P(DGBTAD,"^",17),0)):^(0),1:"")
"RTN","DGBT2",40,0)
 K %,DGBTDI,DGBTDN Q
"RTN","DGBT2",41,0)
STOP I $D(DGBTCS) W ?65,$E($S($D(^SD(409.1,+$P(DGBTCSN,"^",10),0)):$P(^(0),"^"),1:"REGULAR"),1,15),!
"RTN","DGBT2",42,0)
 Q
"RTN","DGBT2",43,0)
APPT ;
"RTN","DGBT2",44,0)
 I $D(DGBTCL) D
"RTN","DGBT2",45,0)
 .W ?14,$P(DGBTCL(I),U)," ("_$$FMTE^DILIBF(I,"5U")_")"
"RTN","DGBT2",46,0)
 .S X=$P(DGBTCL(I),U,2)
"RTN","DGBT2",47,0)
 .W ?50,$S(X["NT":"NO ACTION TAKEN",X["N":"NO-SHOW",X["C":"CANCELLED",1:"")
"RTN","DGBT2",48,0)
 .W ?66,$P("C&P^10-10^SCHED.^UNSCHED.",U,+$P(DGBTCL(I),U,3))
"RTN","DGBT2",49,0)
 .W ?73,$S($D(^SD(409.1,+$P(DGBTCL(I),U,4),0)):$P(^SD(409.1,+$P(DGBTCL(I),U,4),0),U),1:"REGULAR"),!
"RTN","DGBT2",50,0)
 Q
"RTN","DGBT2",51,0)
PAST W:'$O(^DGBT(392,"AI",DFN,9999999.99999-DGBTDTI)) !!,"Past Claims: NONE RECORDED" I $O(^DGBT(392,"AI",DFN,9999999.99999-DGBTDTI)) W !!?14,"Date/Time",?35,"Account",?55,"Deductible",?69,"Amt. Paid",!!,"Past Claims: "
"RTN","DGBT2",52,0)
 S J=0 F DGBTP=9999999.99999-DGBTDTI:0 S DGBTP=$O(^DGBT(392,"AI",DFN,DGBTP)) Q:'DGBTP  S DGBTPDT=^DGBT(392,"AI",DFN,DGBTP),VADAT("W")=DGBTPDT D ^VADATE W ?14,VADATE("E") D ACCT S J=J+1 Q:J=5
"RTN","DGBT2",53,0)
 Q
"RTN","DGBT2",54,0)
ACCT W ?35,$S($P(^DGBT(392,DGBTPDT,0),"^",6):$E($P(^DGBT(392.3,$P(^(0),"^",6),0),"^"),1,15),1:"") D AMT
"RTN","DGBT2",55,0)
 Q
"RTN","DGBT2",56,0)
AMT N X3 ;Fresh copy for COMMA^%DTC. Leftovers causing error.
"RTN","DGBT2",57,0)
 S X=$P(^DGBT(392,DGBTPDT,0),"^",9),X2="2$" D COMMA^%DTC W ?54,X S X=$P(^(0),"^",10) D COMMA^%DTC W ?67,X,! K VADAT,VADATE,X,X2
"RTN","DGBT2",58,0)
 Q
"RTN","DGBTALTI")
0^23^B50552972
"RTN","DGBTALTI",1,0)
DGBTALTI ;PAV - BENEFICIARY/TRAVEL Alternate Income Enter/Edit; 4/23/2012@1130 ;11/14/11  09:58
"RTN","DGBTALTI",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTALTI",3,0)
ALT ;BT Alternate Income Enter/Edit
"RTN","DGBTALTI",4,0)
 D KILL S DGBTIME=300 S:'$D(DTIME) DTIME=DGBTIME S:'$D(U) U="^"
"RTN","DGBTALTI",5,0)
 I '$D(DT)#2 S %DT="",S="T" D ^%DT S DT=Y
"RTN","DGBTALTI",6,0)
PATIENT ; patient lookup, quit if patient doesn't exist
"RTN","DGBTALTI",7,0)
 D QUIT1^DGBTEND ; kill local variables except med division vars
"RTN","DGBTALTI",8,0)
 S DGBTDTI=DT
"RTN","DGBTALTI",9,0)
 S DGBTTOUT="",DIC="^DPT(",DIC(0)="AEQMZ",DIC("A")="Select PATIENT: "
"RTN","DGBTALTI",10,0)
 W !!,"BT Alternate Income Enter/Edit" D ^DIC K DIC G:+Y'>0 EXITE
"RTN","DGBTALTI",11,0)
 ; get patient information#
"RTN","DGBTALTI",12,0)
 S DFN=+Y
"RTN","DGBTALTI",13,0)
 L +^DGBT(392.9,DFN):3
"RTN","DGBTALTI",14,0)
 E  W !,*7,"Somebody else is Editing this entry",*7 G EXIT
"RTN","DGBTALTI",15,0)
 D 6^VADPT,KVAR^DGBTEND,PID^VADPT ;
"RTN","DGBTALTI",16,0)
 I '+VAEL(1) W !!,"Eligibility is missing from registration and is required to continue.",*7 G EXIT
"RTN","DGBTALTI",17,0)
 D GA^DGBTUTL(DFN,"XX(3)",DT,"XX(5)") ;W !! ZW XX W !
"RTN","DGBTALTI",18,0)
 I $D(XX(5,1))!(XX(3)) D  W ! G:$G(EXIT) EXIT
"RTN","DGBTALTI",19,0)
 .W ! S DIR("A")="<D>isplay Income History, or <C>ontinue with current Alt. Income: ",DIR(0)="SA^;D:Display;C:Continue",DIR("B")="C" D ^DIR
"RTN","DGBTALTI",20,0)
 .I Y=U!($G(DUOUT)) S EXIT=1 Q
"RTN","DGBTALTI",21,0)
 .Q:Y="C"
"RTN","DGBTALTI",22,0)
 .W !!,"History of Alt. Incomes:" S I=0
"RTN","DGBTALTI",23,0)
 .F  S I=$O(XX(5,I)) Q:'I  W !,I,":  ",$$FMTE^XLFDT($P(XX(5,I),U,3)),?30,"$",$P(XX(5,I),U,2),?40,$S($P(XX(5,I),U,4)="H":"Hardship",1:"POW"),?50,"Ex: ",$$FMTE^XLFDT($P(XX(5,I),U,5))
"RTN","DGBTALTI",24,0)
 .W:XX(3) !,"*",":  ",$$FMTE^XLFDT($P(XX(3),U,3)),?30,"$",$P(XX(3),U,2),?40,$S($P(XX(3),U,4)="H":"Hardship",1:"POW"),?50,"Ex: ",$$FMTE^XLFDT($P(XX(3),U,5))
"RTN","DGBTALTI",25,0)
DATE ;Get the date
"RTN","DGBTALTI",26,0)
 K DIR S DIR("A")="Begin Date",DIR("B")=$$FMTE^XLFDT(DT),DIR(0)="D^"_$$FMADD^XLFDT(DT,-30)_":DT:EA"
"RTN","DGBTALTI",27,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTALTI",28,0)
 S DGBTDTI=Y,DGBTDTY=" (Year: "_$$FMTE^XLFDT($E(DGBTDTI,1,3)_"0000")_")"
"RTN","DGBTALTI",29,0)
 S XXX(3)=XX(3) K XX D PI(DFN,DGBTDTI,.XX) S XX(3)=XXX(3)
"RTN","DGBTALTI",30,0)
 D PD S TXT=""
"RTN","DGBTALTI",31,0)
RD ;Display - Redisplay Alt. Income on File
"RTN","DGBTALTI",32,0)
 I XX(3) W !!,*7 S:'$L(TXT) TXT=$$FMTE^XLFDT($P(XX(3),U,3))_": $"_$P(XX(3),U,2)_" Alternate income is on the File" W TXT D  G:EXIT EXIT G RD
"RTN","DGBTALTI",33,0)
 .I $$FMDIFF^XLFDT(DT,$P(XX(3),U,3))>30 W !!,"No Edit permited for Alt. Income older as 30 days." S EXIT=1 Q
"RTN","DGBTALTI",34,0)
 .S EXIT=0,TXT=""
"RTN","DGBTALTI",35,0)
 .K DIR S DIR("A")="<D>elete Alt. Income, <E>dit Alt. Income, or <Q>uit ",DIR("B")="Quit",DIR(0)="SA^D:Delete;E:Edit;Q:Quit" D ^DIR
"RTN","DGBTALTI",36,0)
 .I Y="Q"!(Y=U) S EXIT=1 Q
"RTN","DGBTALTI",37,0)
 .I Y="E" S X=$$SETINC(DFN,$P(XX(3),U,3),DGBTDTI) D GA^DGBTUTL(DFN,"XX(3)",DGBTDTI),PD S TXT=$$FMTE^XLFDT($P(XX(3),U,3))_": Alt. Income "_$S($P(XX(3),U,4)="H":"Hardship",1:"POW")_": $"_$P(XX(3),U,2)_" has been Saved " Q
"RTN","DGBTALTI",38,0)
 .I Y="D" S DA(1)=DFN,DA=$P(XX(3),U,3),DIK="^DGBT(392.9,DFN,1," D ^DIK W !,"Alternate Income Deleted" S EXIT=1
"RTN","DGBTALTI",39,0)
 I XX(1) W !!,"Patient Already Qualified for Low Income Condition",*7 G EXIT
"RTN","DGBTALTI",40,0)
 W:XX(4) !!,"This is the POW Patient",*7
"RTN","DGBTALTI",41,0)
 W !
"RTN","DGBTALTI",42,0)
RD1 W !,"Continue Processing Alternate Income" S %=1 D YN^DICN
"RTN","DGBTALTI",43,0)
 I %=2!(%=-1) G EXIT
"RTN","DGBTALTI",44,0)
 I '% W !,"    Answer with 'Yes' or 'No'",*7 G RD1
"RTN","DGBTALTI",45,0)
 I $$SETINC(DFN,,DGBTDTI) S DA(1)=DFN,DA=DGBTDTI,DIK="^DGBT(392.9,DFN,1," D ^DIK W !,"Alternate Income Deleted" G EXIT
"RTN","DGBTALTI",46,0)
 D GA^DGBTUTL(DFN,"XX(3)",DGBTDTI),PD
"RTN","DGBTALTI",47,0)
 I XX(3) W !!,$S($P(XX(3),U,4)="H":"Hardship",1:"POW")_": $",$P(XX(3),U,2)," Begin: ",$$FMTE^XLFDT($P(XX(3),U,3))," Expire: ",$$FMTE^XLFDT($P(XX(3),U,5))," has been Saved "
"RTN","DGBTALTI",48,0)
 G EXIT
"RTN","DGBTALTI",49,0)
 Q 
"RTN","DGBTALTI",50,0)
SETINC(DFN,OLDDATE,DGBTDTI) ;Set Alt Income
"RTN","DGBTALTI",51,0)
 N DIE,DR,Y,FDA,DA
"RTN","DGBTALTI",52,0)
 I $G(OLDDATE) S DA(1)=DFN,DA=OLDDATE,DIK="^DGBT(392.9,DFN,1," D ^DIK
"RTN","DGBTALTI",53,0)
 I '$D(^DGBT(392.9,DFN,0)) S IENC(1)=DFN  S FDA(392.9,"+1,",.01)=IENC(1) D UPDATE^DIE(,"FDA","IENC")
"RTN","DGBTALTI",54,0)
 K IENC S IENC(2)=DGBTDTI,FDA(392.91,"+2,"_DFN_",",.01)=IENC(2) D UPDATE^DIE(,"FDA","IENC","DGBTERR")
"RTN","DGBTALTI",55,0)
 W !,"Begin of Alt. Income: ",$$FMTE^XLFDT(DGBTDTI)
"RTN","DGBTALTI",56,0)
 K DIR S DIR("A")="Enter the Alternate Income",DIR(0)="392.91,1"
"RTN","DGBTALTI",57,0)
 I $L($P($G(XX(3)),U,2)) S DIR("B")=$P($G(XX(3)),U,2),DIR(0)="392.91,1"
"RTN","DGBTALTI",58,0)
 E  S DIR(0)="392.91,1A",DIR("A")=DIR("A")_": "
"RTN","DGBTALTI",59,0)
 D ^DIR
"RTN","DGBTALTI",60,0)
 Q:Y=U!$G(DTOUT) 1  ;$S($P($G(XX(3)),U,2):0,1:1)
"RTN","DGBTALTI",61,0)
 S FDA(392.91,DGBTDTI_","_DFN_",",1)=Y
"RTN","DGBTALTI",62,0)
 K DIR S DIR("A")="Enter the Reason for Alternate Income: "
"RTN","DGBTALTI",63,0)
 I XX(4) S DIR("B")="P",DIR(0)="SA^P:POW;H:Hardship"
"RTN","DGBTALTI",64,0)
 E  S DIR("B")="H",DIR(0)="SA^H:Hardship"
"RTN","DGBTALTI",65,0)
 D ^DIR
"RTN","DGBTALTI",66,0)
 I Y=U!$G(DTOUT) Q 1
"RTN","DGBTALTI",67,0)
 S FDA(392.91,DGBTDTI_","_DFN_",",2)=Y
"RTN","DGBTALTI",68,0)
 S FDA(392.91,DGBTDTI_","_DFN_",",3)=$S(Y="H":$E(DGBTDTI,1,3)_1231,1:$E(DGBTDTI,1,3)+1_$E(DGBTDTI,4,7))
"RTN","DGBTALTI",69,0)
 D FILE^DIE(,"FDA")
"RTN","DGBTALTI",70,0)
 Q 0
"RTN","DGBTALTI",71,0)
PI(DFN,DGBTDTI,XX) ;Return Patient info in XX
"RTN","DGBTALTI",72,0)
 ;XX(1)=Already Low Income on Record
"RTN","DGBTALTI",73,0)
 ;XX(2)=Hardship on Record  <== Discontinued
"RTN","DGBTALTI",74,0)
 ;XX(3)=Alt Income is on file   1^$Alt Inc^Date^Reason^Exp Date
"RTN","DGBTALTI",75,0)
 ;XX(4)=POW on file
"RTN","DGBTALTI",76,0)
 ;XX(5)=Expired Alt Income on file (list)  XX(5,I)=Date^income^reason^expiration date
"RTN","DGBTALTI",77,0)
 N X0,X1,FDA K XX
"RTN","DGBTALTI",78,0)
 S DGBTDEP=$$DEP^VAFMON(DFN,DGBTDTI)
"RTN","DGBTALTI",79,0)
 S DGBTMTTH=$$MTTH^DGBTMTTH(DGBTDEP,DGBTDTI) ; Means test threshold
"RTN","DGBTALTI",80,0)
 S DGBTRXTH=+$$THRES^IBARXEU1(DGBTDTI,1,DGBTDEP) ; RX co-pay threshhold
"RTN","DGBTALTI",81,0)
 S X0=+$$LI^DGBTUTL(DFN,DGBTDTI,DGBTDEP,1)
"RTN","DGBTALTI",82,0)
 S XX(1)=$S("1^2"[X0:1,1:0)
"RTN","DGBTALTI",83,0)
 ;S XX(2)=$S(X0=3:1,1:0)
"RTN","DGBTALTI",84,0)
 D GA^DGBTUTL(DFN,"XX(3)",DGBTDTI,"XX(5)")
"RTN","DGBTALTI",85,0)
 D SVC^VADPT
"RTN","DGBTALTI",86,0)
 S XX(4)=+$G(VASV(4))
"RTN","DGBTALTI",87,0)
 Q:XX(4)
"RTN","DGBTALTI",88,0)
 ;VAEL(1)="15^HOUSEBOUND"
"RTN","DGBTALTI",89,0)
 ;VAEL(1,18)="18^PRISONER OF WAR"
"RTN","DGBTALTI",90,0)
 I VAEL(1)["PRISONER OF WAR" S XX(4)=1
"RTN","DGBTALTI",91,0)
 F  S X0=$O(VAEL(1,X0)) Q:'X0  I VAEL(1,X0)["PRISONER OF WAR" S XX(4)=1 Q
"RTN","DGBTALTI",92,0)
 Q
"RTN","DGBTALTI",93,0)
PD ;Display patient information
"RTN","DGBTALTI",94,0)
 W @IOF
"RTN","DGBTALTI",95,0)
 D PID^VADPT6 W !!?8,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),"^",2)
"RTN","DGBTALTI",96,0)
 W !!?5,"Address: ",VAPA(1) W:VAPA(2)]"" !?14,VAPA(2) W:VAPA(3)]"" !?14,VAPA(3) W !?14,VAPA(4),$S(VAPA(4)]"":", "_$P(VAPA(5),"^",2)_"  "_$P(VAPA(11),U,2),1:"UNSPECIFIED")
"RTN","DGBTALTI",97,0)
 ;  if move in current info for elig, sc%
"RTN","DGBTALTI",98,0)
 S DGBTELG=VAEL(1),DGBTCSC=VAEL(3)
"RTN","DGBTALTI",99,0)
 I +DGBTELG=3,'$E(DGBTCSC)=1 S DGBTCSC=1
"RTN","DGBTALTI",100,0)
 W !!," Eligibility: ",$P(DGBTELG,"^",2) W:DGBTCSC ?45,"SC%: ",$P(DGBTCSC,"^",2) W ?65,"POW:",$S(XX(4):"YES",1:"NO") W !
"RTN","DGBTALTI",101,0)
 I $O(VAEL(1,0))'="" W !," Other Elig.: " F I=0:0 S I=$O(VAEL(1,I)) Q:'I  W ?14,$P(VAEL(1,I),"^",2)," "
"RTN","DGBTALTI",102,0)
 ;  service connected status/information
"RTN","DGBTALTI",103,0)
 I DGBTCSC&($P(DGBTCSC,"^",2)'>29) W !!,"Disabilities:" S I3=""
"RTN","DGBTALTI",104,0)
 N DGQUIT,I
"RTN","DGBTALTI",105,0)
 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGBTALTI",106,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$P(^(0),"^",1)_" ("_+$P(I1,"^",2)_"%-"_$S($P(I1,"^",3):"SC",1:"NSC")_")",1:""),I3=I1
"RTN","DGBTALTI",107,0)
 . I $Y>(IOSL-3) D PAUSE I $G(DGQUIT)=0 W @IOF
"RTN","DGBTALTI",108,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGBTALTI",109,0)
 . W ?16 W I2,!
"RTN","DGBTALTI",110,0)
 ;;;
"RTN","DGBTALTI",111,0)
 D:XX(3)
"RTN","DGBTALTI",112,0)
 .N X,X2,X3
"RTN","DGBTALTI",113,0)
 .S X=$P(XX(3),U,2),DGBTIFL=$E($P(XX(3),U,4)) ; returns income & source.
"RTN","DGBTALTI",114,0)
 .I X?1N.E!(X<0) D
"RTN","DGBTALTI",115,0)
 .I X<0 S X=0
"RTN","DGBTALTI",116,0)
 .S X2="0$",X3=8 D COMMA^%DTC
"RTN","DGBTALTI",117,0)
 .S DGBTINC=X_U_$G(DGBTIFL)
"RTN","DGBTALTI",118,0)
 S DGBTDT=DGBTDTI,DGBTINCA=XX(3)
"RTN","DGBTALTI",119,0)
 I $$DAYSTEST^DGBT1(DFN,.DAYFLG,.RXDAYS,.RXCPST,.LOWINC,.DGNOTEST)
"RTN","DGBTALTI",120,0)
 S X=$$LST^DGMTCOU1(DFN,DT,3),DGBTMTS=$P(X,U,4)_U_$P(X,U,3)
"RTN","DGBTALTI",121,0)
 S:XX(3) RXCPST=0,DGBTMTS=U,DAYFLG=1 ; PAVEL
"RTN","DGBTALTI",122,0)
 ;I DAYFLG,$G(RXCPST),$G(RXCP)'=1 S DGBTINC="^",DGBTIFL=""
"RTN","DGBTALTI",123,0)
 I DAYFLG,$G(RXCPST) S DGBTIFL="C" S:DGBTMTS]"" DGBTMTS=U S:$G(RXCP)'=1 DGBTINC="^"
"RTN","DGBTALTI",124,0)
 I 'DAYFLG S DGBTINC="^",DGBTIFL="^",DGBTMTS="EX^"
"RTN","DGBTALTI",125,0)
 W !!?2,"Income: ",$P($G(DGBTINC),U),$G(DGBTDTY),?35,"Source of Income:  "
"RTN","DGBTALTI",126,0)
 W $S($G(DGBTIFL)="M":"MEANS TEST",$G(DGBTIFL)="C":"COPAY TEST",$G(DGBTIFL)="P":"Alt. Income POW",$G(DGBTIFL)="H":"Alt. Income Hardship",1:"")
"RTN","DGBTALTI",127,0)
 I XX(3) W !,?40," (Expire: ",$$FMTE^XLFDT($P(XX(3),U,5)),")"
"RTN","DGBTALTI",128,0)
 W !?2,"No. of Dependents: ",+DGBTDEP
"RTN","DGBTALTI",129,0)
 ;
"RTN","DGBTALTI",130,0)
 I DGBTMTS]"" W:$P(DGBTMTS,"^")'="N" ?35,"MT Status: ",$S($P(DGBTMTS,"^")="EX":"EXPIRED",$P(DGBTMTS,"^")="R":"REQUIRED",$P(DGBTMTS,"^")="P":$P($P(DGBTMTS,"^",2)," "),DGBTMTS=U!($G(RXCPST)):" NOT APPLICABLE",1:$P(DGBTMTS,"^",2))
"RTN","DGBTALTI",131,0)
 ;
"RTN","DGBTALTI",132,0)
 Q
"RTN","DGBTALTI",133,0)
PAUSE   ;added with DGBT*1*11
"RTN","DGBTALTI",134,0)
 I $E(IOST,1,2)["C-" N DIR S DIR(0)="E" D ^DIR S DGQUIT='Y
"RTN","DGBTALTI",135,0)
 Q 
"RTN","DGBTALTI",136,0)
EXIT ;Exit patient
"RTN","DGBTALTI",137,0)
 I $G(DFN) L -^DGBT(392.9,DFN)
"RTN","DGBTALTI",138,0)
 W !!,"EXITING Patient" D KILL G ALT
"RTN","DGBTALTI",139,0)
 Q
"RTN","DGBTALTI",140,0)
EXITE ; Exit Menu
"RTN","DGBTALTI",141,0)
 I $G(DFN) L -^DGBT(392.9,DFN)
"RTN","DGBTALTI",142,0)
 W !!,"EXITING Alternate Income Menu" D KILL
"RTN","DGBTALTI",143,0)
 Q
"RTN","DGBTALTI",144,0)
KILL ;Kill Local variable.. Dont use NEW, because of return to Patient Prompt
"RTN","DGBTALTI",145,0)
 K DGBTTOUT,DGBTAI,DGBTAIE,DGBTR,DGBTHAR,DGBTELG,VAEL,DGBTCSC,VAPA,VASV,DGBTDEP,DGBTIFL,DGBTINC,IENC,DGBTDTI,DGBTERR,DGBTMTS,DGBTDTY,TXT
"RTN","DGBTALTI",146,0)
 K DGBTINCA,DAYFLG,RXDAYS,RXCPST,LOWINC,DGNOTEST,RXCP,DDD
"RTN","DGBTALTI",147,0)
 K X,Y,I,I1,I2,I3,X2,DFN,DIC,Y,EXP,DA,DR,DIE,FDA,XX,XXX,DIR,EXIT,%DT
"RTN","DGBTCD")
0^39^B27058166
"RTN","DGBTCD",1,0)
DGBTCD ;ALB/SCK/BLD - BENEFICIARY TRAVEL CLAIM DISPLAY; 12/15/92 4/14/93
"RTN","DGBTCD",2,0)
 ;;1.0;Beneficiary Travel;**2,7,9,20**;September 25, 2001;Build 185
"RTN","DGBTCD",3,0)
 Q
"RTN","DGBTCD",4,0)
SCREEN ;this will display the information screen at the end of a claim and 
"RTN","DGBTCD",5,0)
 Q:'$D(^DGBT(392,DGBTDT,0))  S U="^" K DGBTVAR F I=0,"A","C","D","M","R","T" S DGBTVAR(I)=$S($D(^DGBT(392,DGBTDT,I)):^(I),1:"")
"RTN","DGBTCD",6,0)
 S DGBTACCT=$S($D(^DGBT(392.3,+$P(DGBTVAR(0),U,6),0)):$P($G(^(0)),U,5),1:0)
"RTN","DGBTCD",7,0)
 I 'DGBTACCT W !!,*7,">> WARNING! No ACCOUNT TYPE for this claim, Please correct through Claim Enter/Edit!" G QUIT
"RTN","DGBTCD",8,0)
 W @IOF
"RTN","DGBTCD",9,0)
 W !?18,"Beneficiary Travel Claim Information <Display>"
"RTN","DGBTCD",10,0)
 W !!,?2,"Claim Date: ",DGBTDTE W:$P(DGBTVAR(0),U,11)'=""&($D(^DG(40.8,$P(DGBTVAR(0),U,11),0))) ?40,"Division: ",$P(^DG(40.8,$P(DGBTVAR(0),U,11),0),U)
"RTN","DGBTCD",11,0)
 D PID^VADPT6 W !!?8,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),U,2)
"RTN","DGBTCD",12,0)
 S (DGBTFCTY,DGBTTCTY)=""
"RTN","DGBTCD",13,0)
 I $P(DGBTVAR("D"),U,4)]"" S DGBTCNA=$P(DGBTVAR("D"),U,4) D CITY^DGBTCR I DGBTCSZ[DGBTCNA D
"RTN","DGBTCD",14,0)
 . S DGBTCSZ=DGBTCNA_", "_$S(+$P(DGBTVAR("D"),U,5)>0:$P(^DIC(5,$P(DGBTVAR("D"),U,5),0),U,2),1:"")_"  "
"RTN","DGBTCD",15,0)
 . S Y=$P(DGBTVAR("D"),U,6),Y=$E(Y,1,5)_$S($E(Y,6,9)]"":"-"_$E(Y,6,9),1:"") S DGBTCSZ=DGBTCSZ_Y,DGBTFCTY=DGBTCSZ
"RTN","DGBTCD",16,0)
 I $P(DGBTVAR("T"),U,4)]"" S DGBTCNA=$P(DGBTVAR("T"),U,4) D CITY^DGBTCR S:DGBTCSZ[DGBTCNA DGBTCSZ=DGBTCNA_", "_$S(+$P(DGBTVAR("T"),U,5)>0:$P(^DIC(5,$P(DGBTVAR("T"),U,5),0),U,2),1:"")_"  "_$P(DGBTVAR("T"),U,6) S DGBTTCTY=DGBTCSZ
"RTN","DGBTCD",17,0)
FROM W !!," Depart From: ",$E($P(DGBTVAR("D"),U),1,30)
"RTN","DGBTCD",18,0)
 W ?46,"To: ",$E($P(DGBTVAR("T"),U),1,30)
"RTN","DGBTCD",19,0)
 W !?14 W:$P(DGBTVAR("D"),U,2)]"" $P(DGBTVAR("D"),U,2) W:$P(DGBTVAR("D"),U,2)="" $P(DGBTVAR("D"),U,3) W:$P($G(DGBTVAR("D")),U,2)=""&($P($G(DGBTVAR("D")),U,3)="") DGBTFCTY
"RTN","DGBTCD",20,0)
 W ?50 W:$P(DGBTVAR("T"),U,2)]"" $P(DGBTVAR("T"),U,2) W:$P(DGBTVAR("T"),U,2)="" $P(DGBTVAR("T"),U,3) W:$P(DGBTVAR("T"),U,2)=""&($P(DGBTVAR("T"),U,3)="") DGBTTCTY
"RTN","DGBTCD",21,0)
 W !?14 W:$P(DGBTVAR("D"),U,3)]"" $P(DGBTVAR("D"),U,3) W:$P(DGBTVAR("D"),U,2)]""&($P(DGBTVAR("D"),U,3)="") DGBTFCTY
"RTN","DGBTCD",22,0)
 W ?50 W:$P(DGBTVAR("T"),U,3)]"" $P(DGBTVAR("T"),U,3) W:$P(DGBTVAR("T"),U,2)]""&($P(DGBTVAR("T"),U,3)="") DGBTTCTY
"RTN","DGBTCD",23,0)
 W !?14 W:$P(DGBTVAR("D"),U,2)]""&($P(DGBTVAR("D"),U,3)]"") DGBTFCTY
"RTN","DGBTCD",24,0)
 W ?50 W:$P(DGBTVAR("T"),U,2)]""&($P(DGBTVAR("T"),U,3)]"") DGBTTCTY
"RTN","DGBTCD",25,0)
ELIG W !!," Eligibility: " W:$P(DGBTVAR(0),U,3) $P(^DIC(8,$P(DGBTVAR(0),U,3),0),U) W:$P(DGBTVAR(0),U,4)]"" ?45,"SC%: ",$P(DGBTVAR(0),U,4)
"RTN","DGBTCD",26,0)
 I $P(DGBTVAR(0),U,5) W ?57,"Cert. Date: " S VADAT("W")=9999999-$P($P(DGBTVAR(0),U,5),".") D ^VADATE W $P(VADATE("E"),"@") K VADAT,VADATE
"RTN","DGBTCD",27,0)
ACCT W !!?5,"Account: ",$S($P(DGBTVAR(0),U,6):$E($P(^DGBT(392.3,$P(DGBTVAR(0),U,6),0),U),1,15),1:"") W:$P(DGBTVAR("A"),U,3) ?31,"REVIEW VISIT"
"RTN","DGBTCD",28,0)
 ;question added for DG*1.0*20 E18
"RTN","DGBTCD",29,0)
 W !!,"Common Carrier Req: ",$S($$GET1^DIQ(392,DGBTDT,55.1)="YES":"YES",1:"NO") W ?48,"COMMON CARRIER FEE: " S X=$P(DGBTVAR("C"),U,2),X2="2$" N X3 D COMMA^%DTC W X ;
"RTN","DGBTCD",30,0)
 W !,?51,"Most Econ. Cost: " S X=$P(DGBTVAR(0),U,8),X2="2$" N X3 D COMMA^%DTC W X
"RTN","DGBTCD",31,0)
ATT I DGBTACCT=4!(DGBTACCT=5) W !,"Attend/Payee: ",$S($D(DGBTVAR("A")):$P(DGBTVAR("A"),U,2),1:"")
"RTN","DGBTCD",32,0)
 I $G(PATCHDT)'<$G(DGBTDT) I $G(DGBTACCT)'=4&($G(DGBTACCT)'=5) W !," Mode/Trans.: ",$S($P($G(DGBTVAR("A")),U,4):$P(^DGBT(392.43,$P($G(DGBTVAR("A")),U,4),0),U),1:"")  ;changed file from 392.4 to 392.43
"RTN","DGBTCD",33,0)
 I $G(PATCHDT)<$G(DGBTDT) I $G(DGBTACCT)'=4&($G(DGBTACCT)'=5) W !," Mode/Trans.: ",$S($P($G(DGBTVAR("A")),U,4):$P(^DGBT(392.4,$P($G(DGBTVAR("A")),U,4),0),U),1:"")  ;use file 392.4 if claim date is before install date
"RTN","DGBTCD",34,0)
 I $D(^DG(43,1,"BT")) I $P(^DG(43,1,"BT"),U,2)=1 W ?51,"Meals & Lodging: " S X=$P($G(DGBTVAR("M")),U,4) N X3 D COMMA^%DTC W X
"RTN","DGBTCD",35,0)
 I $G(DGBTACCT)=4!($G(DGBTACCT)=5) W !,"One Way/"
"RTN","DGBTCD",36,0)
 I $G(DGBTACCT)'=4&($G(DGBTACCT)'=5) D
"RTN","DGBTCD",37,0)
 . S DGX=$S($P($G(DGBTVAR(0)),U,7):"Carrier",$P($G(DGBTVAR(0)),U,14):"CoreFLS",1:"Carrier") W:DGX["FLS" !,"CoreFLS Carrier: " W:DGX["Carrier" !?5,"Carrier: "
"RTN","DGBTCD",38,0)
 . W $E($S((DGX["FLS"&$P($G(DGBTVAR(0)),U,14)):$P(^DGBT(392.31,$P($G(DGBTVAR(0)),U,14),0),U),(DGX["Carrier"&$P(DGBTVAR(0),U,7)):$P(^PRC(440,$P(DGBTVAR(0),U,7),0),U),1:""),1,27) K DGX
"RTN","DGBTCD",39,0)
 I $D(^DG(43,1,"BT")) I $P(^DG(43,1,"BT"),U,2)=1 W ?46,"Ferry, Bridges, Etc.: " S X=$P(DGBTVAR("M"),U,5) N X3 D COMMA^%DTC W X
"RTN","DGBTCD",40,0)
 I $G(DGBTACCT)=4!($G(DGBTACCT)=5) W !?2,"Round Trip: ",$S($P(DGBTVAR("M"),U)=1:"ONE WAY",$P(DGBTVAR("M"),U)=2:"ROUND TRIP",1:"")
"RTN","DGBTCD",41,0)
 I $G(DGBTACCT)'=4&($G(DGBTACCT)'=5) W !,"Auth. Person: " I $P(DGBTVAR("A"),U) W $S($D(DGBTVAR("A"))&($D(^VA(200,$P(DGBTVAR("A"),U),0))):$P(^VA(200,$P(DGBTVAR("A"),U),0),U),1:"")
"RTN","DGBTCD",42,0)
 I $G(DGBTACCT)=4!($G(DGBTACCT)=5) W ?46,"Total Mileage Amount: " D  N X3 D COMMA^%DTC W X
"RTN","DGBTCD",43,0)
 .S X=$P(DGBTVAR("M"),U,3)
"RTN","DGBTCD",44,0)
 I $G(DGBTACCT)=4!($G(DGBTACCT)=5) W !,"Mileage/"
"RTN","DGBTCD",45,0)
DED W ?48,"Applied Deductible: " D  N X3 D COMMA^%DTC W X
"RTN","DGBTCD",46,0)
 .S X=$P($G(DGBTVAR(0)),"^",9)   ;$G(DGBTDCV1)    ;$P(DGBTVAR(0),"^",9)
"RTN","DGBTCD",47,0)
 W ! W:$G(DGBTACCT)=4!($G(DGBTACCT)=5) ?5,"One Way: ",$P($G(DGBTVAR("M")),U,2)_" MILES"
"RTN","DGBTCD",48,0)
 W ?53,"Amount Payable " S X=$$GET1^DIQ(392,DGBTDT,10) N X3 D COMMA^%DTC W X
"RTN","DGBTCD",49,0)
REMARK W !!,"Remarks: ",$S($D(^DGBT(392,DGBTDT,"R")):$P(^DGBT(392,DGBTDT,"R"),U),1:"")
"RTN","DGBTCD",50,0)
QUIT K DGBTCNA,DGBTCSZ,DGBTFCTY,DGBTTCTY,DGBTCNA,DGBTDIV,VADAM,X,X2,I
"RTN","DGBTCD",51,0)
 Q
"RTN","DGBTCDSP")
0^40^B34785132
"RTN","DGBTCDSP",1,0)
DGBTCDSP ;;ALB/BLD-BENEFICIARY TRAVEL CLAIM DISPLAY - SPECIAL MODE;02/03/2012
"RTN","DGBTCDSP",2,0)
 ;;1.0;Beneficiary Travel;**20**;FEBRUARY 4 2012;Build 185
"RTN","DGBTCDSP",3,0)
 Q
"RTN","DGBTCDSP",4,0)
SCREEN ;this will display the information screen at the end of a claim and 
"RTN","DGBTCDSP",5,0)
 N TOSTATE,DPSTATE,Z,INFOLINE
"RTN","DGBTCDSP",6,0)
 S:$G(INFOLINE)="" INFOLINE=1
"RTN","DGBTCDSP",7,0)
 S:$G(DGBTDT)="" DGBTDT=$G(DGBTDTI)
"RTN","DGBTCDSP",8,0)
 I $D(DGBTSP)'>1 D BLDARRY(.DGBTSP)
"RTN","DGBTCDSP",9,0)
 S DGBTVAR(0)=^DGBT(392,DGBTDT,0)
"RTN","DGBTCDSP",10,0)
 S DPSTATE=$O(^DIC(5,"B",DGBTSP("STATE OF DEPARTURE"),"")),DPSTATE=$P(^DIC(5,DPSTATE,0),"^",2)
"RTN","DGBTCDSP",11,0)
 S TOSTATE=$O(^DIC(5,"B",DGBTINST("STATE"),"")),TOSTATE=$P(^DIC(5,TOSTATE,0),"^",2)
"RTN","DGBTCDSP",12,0)
 S DGBTACCT=$S($D(DGBTSP("ACCOUNT")):DGBTSP("ACCOUNT"),1:0)
"RTN","DGBTCDSP",13,0)
 I DGBTACCT=0 W !!,*7,">> WARNING! No ACCOUNT TYPE for this claim, Please correct through Claim Enter/Edit!" G QUIT^DGBTEND
"RTN","DGBTCDSP",14,0)
 W @IOF
"RTN","DGBTCDSP",15,0)
 W !?18,"Beneficiary Travel Claim Information <Display>"
"RTN","DGBTCDSP",16,0)
 W !!,?2,"Claim Date: ",$S($G(DGBTDTE)'="":DGBTDTE,1:VADATE("E")) W:$G(DGBTINST("DIVISION"))'="" ?40,"Division: ",$G(DGBTINST("DIVISION"))
"RTN","DGBTCDSP",17,0)
 D PID^VADPT6
"RTN","DGBTCDSP",18,0)
 W !!,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),U,2)
"RTN","DGBTCDSP",19,0)
 S (DGBTFCTY,DGBTTCTY)=""
"RTN","DGBTCDSP",20,0)
FROM W !!," Depart From: ",$G(DGBTSP("PLACE OF DEPARTURE"))
"RTN","DGBTCDSP",21,0)
 W ?46,"To: ",$G(DGBTINST("INST NAME"))
"RTN","DGBTCDSP",22,0)
 W !?14,DGBTSP("CITY OF DEPARTURE")_", "_DPSTATE_" "_DGBTSP("ZIP CODE/DEPARTURE")
"RTN","DGBTCDSP",23,0)
 I $G(DGBTINST("ADDRESS1"))'="" W ?50,DGBTINST("ADDRESS1")
"RTN","DGBTCDSP",24,0)
 W !,?50,$G(DGBTINST("CITY"))_", "_TOSTATE_"  "_$G(DGBTINST("ZIP CODE"))
"RTN","DGBTCDSP",25,0)
 ;
"RTN","DGBTCDSP",26,0)
ELIG W !!,"Eligibility: " W:$P(DGBTVAR(0),U,3) $P(^DIC(8,$P(DGBTVAR(0),U,3),0),U) W ?45,"SC%: ",$S($P(DGBTVAR(0),U,4)="":0,1:$P(DGBTVAR(0),U,4))
"RTN","DGBTCDSP",27,0)
 ;
"RTN","DGBTCDSP",28,0)
ACCT W !!,"Account: ",$G(DGBTSP("ACCOUNT"))
"RTN","DGBTCDSP",29,0)
 ;question added for DG*1.0*20 E18
"RTN","DGBTCDSP",30,0)
 W !!,"Mode/Trans: ",$G(DGBTSP("MODE OF TRANS"))
"RTN","DGBTCDSP",31,0)
 ;
"RTN","DGBTCDSP",32,0)
 W ?45,"One Way/Round Trip: "
"RTN","DGBTCDSP",33,0)
 S X=$S($G(DGBTSP("RT/ONE WAY"))="R":"ROUND TRIP",1:"ONE WAY") W ?67,$J(X,11)
"RTN","DGBTCDSP",34,0)
 ;
"RTN","DGBTCDSP",35,0)
 W !,"Carrier: ",DGBTSP("VENDOR")
"RTN","DGBTCDSP",36,0)
 ;
"RTN","DGBTCDSP",37,0)
 W ?45,"Total Miles Traveled: "
"RTN","DGBTCDSP",38,0)
 S X=$G(DGBTSP("TOTAL MILES")),X2="2S" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",39,0)
 ;
"RTN","DGBTCDSP",40,0)
 W !,"Invoice: ",$G(DGBTSP("INVOICE NUMBER"))
"RTN","DGBTCDSP",41,0)
 ;
"RTN","DGBTCDSP",42,0)
 W ?45,"Base Rate Fee: "
"RTN","DGBTCDSP",43,0)
 S X=$G(DGBTSP("BASE RATE FEE")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",44,0)
 ;
"RTN","DGBTCDSP",45,0)
 W !,"Date Received: ",$G(DGBTSP("DT INVOICE REC"))
"RTN","DGBTCDSP",46,0)
 ;
"RTN","DGBTCDSP",47,0)
 W ?45,"Mileage Fee: "
"RTN","DGBTCDSP",48,0)
 S X=$G(DGBTSP("MILEAGE FEE")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",49,0)
 ;
"RTN","DGBTCDSP",50,0)
 W !,"Pre-Authorized: ",$G(DGBTSP("PRE-AUTHORIZED"))
"RTN","DGBTCDSP",51,0)
 ;
"RTN","DGBTCDSP",52,0)
 W ?45,"No-Show/No Load Fee: "
"RTN","DGBTCDSP",53,0)
 S X=$G(DGBTSP("NO SHOW")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",54,0)
 ;
"RTN","DGBTCDSP",55,0)
 S PAYMENT=$$GET1^DIQ(392,DGBTDT,85)
"RTN","DGBTCDSP",56,0)
 W !,"Payment: ",$S($G(PAYMENT)="YES":"APPROVED",$G(DGBTSP("AUTHORIZED"))="YES":"APPROVED",1:"DENIED")
"RTN","DGBTCDSP",57,0)
 ;
"RTN","DGBTCDSP",58,0)
 W ?45,"Wait Time Fee: "
"RTN","DGBTCDSP",59,0)
 S X=$G(DGBTSP("WAIT TIME")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",60,0)
 ;
"RTN","DGBTCDSP",61,0)
 W !,"Auth. Person: ",$P(^VA(200,DUZ,0),"^",1)
"RTN","DGBTCDSP",62,0)
 ;
"RTN","DGBTCDSP",63,0)
 W ?45,"Extra Crew Fee: "
"RTN","DGBTCDSP",64,0)
 S X=$G(DGBTSP("EXTRA CREW")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",65,0)
 ;
"RTN","DGBTCDSP",66,0)
 W !  ;,"Reason for Denial: "   ;part of E11 will be added at that time
"RTN","DGBTCDSP",67,0)
 ;
"RTN","DGBTCDSP",68,0)
 W ?45,"Equipment Fee: "
"RTN","DGBTCDSP",69,0)
 S X=$G(DGBTSP("SP EQUIP")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",70,0)
 ;
"RTN","DGBTCDSP",71,0)
 W !,?45,"Total Invoice Amount: "
"RTN","DGBTCDSP",72,0)
 S X=$G(DGBTSP("TOTAL INVOICE")),X2="2$" D COMMA^%DTC W ?67,X
"RTN","DGBTCDSP",73,0)
 ;
"RTN","DGBTCDSP",74,0)
 W !!,"Remarks: ",$G(DGBTSP("SP MODE OTHER REMARKS"))
"RTN","DGBTCDSP",75,0)
 ;
"RTN","DGBTCDSP",76,0)
 I INFOLINE D END Q
"RTN","DGBTCDSP",77,0)
 ;R !!,"PRESS RETURN TO CONTINUE: ",X
"RTN","DGBTCDSP",78,0)
 I 'INFOLINE K DGBTSP,DGBTCMTY ;D QUIT^DGBTEND,DISPLAY^DGBTR Q
"RTN","DGBTCDSP",79,0)
 ;D DISPLAY^DGBTR
"RTN","DGBTCDSP",80,0)
 Q
"RTN","DGBTCDSP",81,0)
 ;
"RTN","DGBTCDSP",82,0)
BLDARRY(DGBTSP) ;
"RTN","DGBTCDSP",83,0)
 K DGBTSP
"RTN","DGBTCDSP",84,0)
 S DGBTSP("ACCOUNT")=$$GET1^DIQ(392,DGBTDT_",",6)
"RTN","DGBTCDSP",85,0)
 ;
"RTN","DGBTCDSP",86,0)
 S DGBTSP("CLAIM TYPE")=$$GET1^DIQ(392,DGBTDT_",",56)
"RTN","DGBTCDSP",87,0)
 S DGBTSP("MODE OF TRANS")=$$GET1^DIQ(392,DGBTDT_",",57)
"RTN","DGBTCDSP",88,0)
 S DGBTSP("INVOICE NUMBER")=$$GET1^DIQ(392,DGBTDT_",",58)
"RTN","DGBTCDSP",89,0)
 S DGBTSP("DT INVOICE REC")=$$GET1^DIQ(392,DGBTDT_",",59)
"RTN","DGBTCDSP",90,0)
 S DGBTSP("TOTAL INVOICE")=$$GET1^DIQ(392,DGBTDT_",",60)
"RTN","DGBTCDSP",91,0)
 S DGBTSP("BASE RATE FEE")=$$GET1^DIQ(392,DGBTDT_",",61)
"RTN","DGBTCDSP",92,0)
 S DGBTSP("MILEAGE FEE")=$$GET1^DIQ(392,DGBTDT_",",62)
"RTN","DGBTCDSP",93,0)
 S DGBTSP("NO SHOW")=$$GET1^DIQ(392,DGBTDT_",",63)
"RTN","DGBTCDSP",94,0)
 S DGBTSP("WAIT TIME")=$$GET1^DIQ(392,DGBTDT_",",64)
"RTN","DGBTCDSP",95,0)
 S DGBTSP("EXTRA CREW")=$$GET1^DIQ(392,DGBTDT_",",65)
"RTN","DGBTCDSP",96,0)
 S DGBTSP("SP EQUIP")=$$GET1^DIQ(392,DGBTDT_",",66)
"RTN","DGBTCDSP",97,0)
 S DGBTSP("RT/ONE WAY")=$$GET1^DIQ(392,DGBTDT_",",67)
"RTN","DGBTCDSP",98,0)
 S DGBTSP("TOTAL MILES")=$$GET1^DIQ(392,DGBTDT_",",68)
"RTN","DGBTCDSP",99,0)
 S DGBTSP("OTHER TRANS REMARKS")=$$GET1^DIQ(392,DGBTDT_",",69)
"RTN","DGBTCDSP",100,0)
 S DGBTSP("PRE-AUTHORIZED")=$$GET1^DIQ(392,DGBTDT_",",70)
"RTN","DGBTCDSP",101,0)
 S DGBTSP("VENDOR")=$$GET1^DIQ(392,DGBTDT_",",71)
"RTN","DGBTCDSP",102,0)
 S DGBTSP("SP MODE OTHER REMARKS")=$$GET1^DIQ(392,DGBTDT_",",72)
"RTN","DGBTCDSP",103,0)
 S DGBTSP("PLACE OF DEPARTURE")=$$GET1^DIQ(392,DGBTDT_",",73)
"RTN","DGBTCDSP",104,0)
 ;
"RTN","DGBTCDSP",105,0)
 S DGBTSP("PLACE OF DEPATURE 2")=$$GET1^DIQ(392,DGBTDT_",",74)
"RTN","DGBTCDSP",106,0)
 S DGBTSP("CITY OF DEPARTURE")=$$GET1^DIQ(392,DGBTDT_",",75)
"RTN","DGBTCDSP",107,0)
 S DGBTSP("STATE OF DEPARTURE")=$$GET1^DIQ(392,DGBTDT_",",76)
"RTN","DGBTCDSP",108,0)
 S DGBTSP("ZIP CODE/DEPARTURE")=$$GET1^DIQ(392,DGBTDT_",",77)
"RTN","DGBTCDSP",109,0)
 ;
"RTN","DGBTCDSP",110,0)
 S DGBTINST("DIVISION")=$$GET1^DIQ(392,DGBTDT_",",78)
"RTN","DGBTCDSP",111,0)
 S DGBTINST("INST NAME")=$$GET1^DIQ(392,DGBTDT_",",79)
"RTN","DGBTCDSP",112,0)
 S DGBTINST("ADDRESS1")=$$GET1^DIQ(392,DGBTDT_",",80)
"RTN","DGBTCDSP",113,0)
 S DGBTINST("CITY")=$$GET1^DIQ(392,DGBTDT_",",81)
"RTN","DGBTCDSP",114,0)
 S DGBTINST("STATE")=$$GET1^DIQ(392,DGBTDT_",",82)
"RTN","DGBTCDSP",115,0)
 S DGBTINST("ZIP CODE")=$$GET1^DIQ(392,DGBTDT_",",83)
"RTN","DGBTCDSP",116,0)
 ;
"RTN","DGBTCDSP",117,0)
 S DGBTSP("SP MODE CLAIM AUTHORIZED")=$$GET1^DIQ(392,DGBTDT_",",85)
"RTN","DGBTCDSP",118,0)
 S DGBTSP("DATE/TIME AUTHORIZED")=$$GET1^DIQ(392,DGBTDT_",",86)
"RTN","DGBTCDSP",119,0)
 ;
"RTN","DGBTCDSP",120,0)
 I $G(DGBTSP("AUTHORIZED"))="Y" D
"RTN","DGBTCDSP",121,0)
 .S DGBTSP("AUTHORIZED PERSON")=$$GET1^DIQ(392,DGBTDT_",",84)
"RTN","DGBTCDSP",122,0)
 S INFOLINE=0
"RTN","DGBTCDSP",123,0)
 Q
"RTN","DGBTCDSP",124,0)
 ;
"RTN","DGBTCDSP",125,0)
END ;display menu prompt at bottom of screen
"RTN","DGBTCDSP",126,0)
 N PROMPT
"RTN","DGBTCDSP",127,0)
 K DGANS
"RTN","DGBTCDSP",128,0)
 S SPCOMPLETE=0
"RTN","DGBTCDSP",129,0)
 F  Q:$G(DGANS)="Q"!($D(DIRUT))  D  Q:$G(DGANS)="Q"!($D(DIRUT))!('$D(DGBTSP)>1)
"RTN","DGBTCDSP",130,0)
 .S Z="^INFORMATION^DISPLAY^EDIT",PROMPT="<I>nformation, <D>isplay claim, <E>dit claim,"
"RTN","DGBTCDSP",131,0)
 .S DIR("A")=PROMPT_" or <Q>uit ",DIR("B")="Quit",DIR("?")="^D HELP^DGBTEND",DIR(0)="SA^Q:Quit;I:Information;D:Display;E:Edit;P:Print"
"RTN","DGBTCDSP",132,0)
 .D ^DIR K DIR S DGANS=Y
"RTN","DGBTCDSP",133,0)
 .S DGBTX1=$S(DGANS="I":"SCREEN^DGBTE",DGANS="D":"SCREEN^DGBTCDSP",DGANS="E":"SPMODE^DGBTE",DGANS="Q":"PATIENT^DGBTE",1:"QUIT^DGBTEND")
"RTN","DGBTCDSP",134,0)
 .I $G(DGBTX1)]"" D @DGBTX1 ;D:DGBTX1="START^DGBTCR" PATIENT^DGBTE
"RTN","DGBTCDSP",135,0)
 Q
"RTN","DGBTCDSP",136,0)
 ;
"RTN","DGBTCE")
0^7^B36783566
"RTN","DGBTCE",1,0)
DGBTCE ;ALB/SCK/BLD - BENEFICIARY TRAVEL CLAIM RE-ENTER/EDIT; 12/15/92  06/04/93 ;12/13/11  12:19
"RTN","DGBTCE",2,0)
 ;;1.0;Beneficiary Travel;**2,14,17,20**;September 25, 2001;Build 185
"RTN","DGBTCE",3,0)
 Q
"RTN","DGBTCE",4,0)
SCREEN ;
"RTN","DGBTCE",5,0)
 D QUIT^DGBTCE1
"RTN","DGBTCE",6,0)
 S DGBTTOUT=""
"RTN","DGBTCE",7,0)
 D SCREEN^DGBTEE1 Q:'$D(^DGBT(392,DGBTDT,0))  I DGBTTOUT=-1 S DGBTTOUT=1 Q
"RTN","DGBTCE",8,0)
 I $D(DGBTOACT) I DGBTOACT'=DGBTACCT S DGBTVAR(0)=^DGBT(392,DGBTDT,0) D FILE
"RTN","DGBTCE",9,0)
 S (DGBTMAL,DGBTFAB,DGBTME,DGBTCP,DGBTFLAG,DGBTDE,DGBTDCV,DGBTDCM,DGBTDPV,DGBTDPM)=0
"RTN","DGBTCE",10,0)
 S:$G(DGBTACCT)'>0 DGBTACCT=$P($G(DGBTVAR(0)),U,6)
"RTN","DGBTCE",11,0)
 I DGBTACCT=4!(DGBTACCT=5) I $$ABP^DGBTUTL(DFN) W !!,"*ALERT: Patient has an active bus pass, which expires on ",$$FMTE^XLFDT($$ABP^DGBTUTL(DFN)),".",! S DIR("A")="Press RETURN to continue",DIR(0)="E" D ^DIR K DIR ;20
"RTN","DGBTCE",12,0)
 S DGBTAP=VADM(1),DIE="^DGBT(392,",DA=DGBTDT,DR=$S(DGBTACCT=4:"42//"_DGBTAP,DGBTACCT=5:"43;S DGBTCP=X;42//"_DGBTAP,1:"44")
"RTN","DGBTCE",13,0)
 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",14,0)
 I DGBTACCT=4!(DGBTACCT=5) S:$D(DGBTVAR("M")) DGBTWAY=$P(DGBTVAR("M"),"^"),DGBTMILE=$P(DGBTVAR("M"),"^",2) S:$D(DGBTVAR("D")) DGBTCITY=$P(DGBTVAR("D"),"^",4),DGBTSTAT=$P(DGBTVAR("D"),"^",5)
"RTN","DGBTCE",15,0)
 S DGBTDIV=$P($G(^DGBT(392,DA,0)),U,11),DGBTRMK=$S($D(DGBTREC):$$DICLKUP^DGBTUTL(DGBTREC,DGBTDIV,4),1:"")
"RTN","DGBTCE",16,0)
 S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",17,0)
 S DR="3////"_DGBTELIG_";6////"_DGBTACTN_";21;I X="""" S Y=24;22;I X="""" S Y=24;23;24;24.1;24.2;25;I X="""" S Y=28;26;I X="""" S Y=28;27;28;28.1;28.2"
"RTN","DGBTCE",18,0)
 D ^DIE K DIE I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",19,0)
 W:DGBTRMK]"" !!,*7,"MILEAGE REMARKS: ",DGBTRMK,!
"RTN","DGBTCE",20,0)
 I DGBTACCT=4!(DGBTACCT=5) D  Q:$G(DGBTTOUT)
"RTN","DGBTCE",21,0)
 .I $G(MONTOT)'="" N OTRIPTYP S OTRIPTYP=$$GET1^DIQ(392,DGBTDT,31,"I")
"RTN","DGBTCE",22,0)
 . S DR="31//;S DGBTOWRT=X;32//;S DGBTML=X"
"RTN","DGBTCE",23,0)
 . I DGBTACCT=5&(DGBTCP=1) S DGBTMR=DGBTMR1
"RTN","DGBTCE",24,0)
 . S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",25,0)
 . D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1
"RTN","DGBTCE",26,0)
 .I ($G(MONTOT)'="")&($G(OTRIPTYP)'=$$GET1^DIQ(392,DGBTDT,31,"I")) D
"RTN","DGBTCE",27,0)
 ..N NTRIPTYP S NTRIPTYP=$$GET1^DIQ(392,DGBTDT,31,"I")
"RTN","DGBTCE",28,0)
 ..I (OTRIPTYP=1)&(NTRIPTYP=2) D  Q
"RTN","DGBTCE",29,0)
 ...S $P(MONTOT,U)=$P(MONTOT,U)+1
"RTN","DGBTCE",30,0)
 ...S $P(MONTOT,U,2)=$P(MONTOT,U,2)-1
"RTN","DGBTCE",31,0)
 ...S $P(MONTOT,U,3)=$P(MONTOT,U,3)+1
"RTN","DGBTCE",32,0)
 ..I (OTRIPTYP=2)&(NTRIPTYP=1) D  Q
"RTN","DGBTCE",33,0)
 ...S $P(MONTOT,U)=$P(MONTOT,U)-1
"RTN","DGBTCE",34,0)
 ...S $P(MONTOT,U,2)=$P(MONTOT,U,2)+1
"RTN","DGBTCE",35,0)
 ...S $P(MONTOT,U,3)=$P(MONTOT,U,3)-1
"RTN","DGBTCE",36,0)
 . N MODE S DIR(0)="Y",DIR("B")=$S($D(^DGBT(392,DGBTDT,"C")):"YES",1:"NO"),DIR("A")="COMMON CARRIER USED" D ^DIR K DIR S MODE=Y I $D(DIRUT),$G(DUOUT) S DGBTTOUT=-1 Q  ;20
"RTN","DGBTCE",37,0)
 . I 'MODE,$D(^DGBT(392,DGBTDT,"C")) S $P(^DGBT(392,DGBTDT,"A"),"^",4)="" F I="B","C"  K ^DGBT(392,DGBTDT,I)
"RTN","DGBTCE",38,0)
 . I $$GET1^DIQ(392,DGBTDT,44)'=""!($G(MODE)) S DIE="^DGBT(392,",DA=DGBTDT,DR="44COMMON CARRIER MODE" D ^DIE  I $D(Y) S DGBTTOUT=1 Q  ;20
"RTN","DGBTCE",39,0)
 . S DIE="^DGBT(392,",DA=DGBTDT I $$UP^XLFSTR($$GET1^DIQ(392,DGBTDT,44))["BUS" S DR="52R;I X'=""P"" S Y="""";53R" D ^DIE I $D(Y) S DGBTTOUT=1 Q  ;20
"RTN","DGBTCE",40,0)
 . I $$GET1^DIQ(392,DGBTDT,44)'="" S DIE="^DGBT(392,",DA=DGBTDT,DR="54;55;55.1" D ^DIE I $D(Y) S DGBTTOUT=1 Q  ;20
"RTN","DGBTCE",41,0)
DIE1 ;
"RTN","DGBTCE",42,0)
 S DGBTMLT=$S($D(DGBTVAR("M"))&((DGBTACCT=4)!(DGBTACCT=5)):$J((DGBTOWRT*DGBTML*DGBTMR),0,2),1:""),$P(^DGBT(392,DGBTDT,"M"),"^",3)=DGBTMLT,$P(DGBTVAR("M"),"^",3)=DGBTMLT
"RTN","DGBTCE",43,0)
 ;
"RTN","DGBTCE",44,0)
 S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",45,0)
 I 'DGBTCORE D
"RTN","DGBTCE",46,0)
 . S DR="I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;7;@1;I DGBTMLFB=0 S Y=""@2"";34//;S DGBTMAL=X;35//;S DGBTFAB=X;@2;8//;S DGBTME=X"
"RTN","DGBTCE",47,0)
 I DGBTCORE S DR="" D
"RTN","DGBTCE",48,0)
 . S DR(1,392,1)="I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;@3;14;S DGBTCSL=$$AFTER^DGBTCSL(392,D0,X,$G(DGBTPRV)) S:DGBTCSL<1 Y=""@3"" W:DGBTCSL<1 ""   Required"" K DGBTPRV,DGBTCSL;"
"RTN","DGBTCE",49,0)
 . S DR(1,392,2)="@1;I DGBTMLFB=0 S Y=""@2"";34//;S DGBTMAL=X;35//;S DGBTFAB=X;@2;8//;S DGBTME=X"
"RTN","DGBTCE",50,0)
DIE3 ;
"RTN","DGBTCE",51,0)
 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",52,0)
 ;
"RTN","DGBTCE",53,0)
TCOST ;CALCULATE TOTAL COST AND MONTHLY CUM. DEDUCTIBLE
"RTN","DGBTCE",54,0)
MLFB ;
"RTN","DGBTCE",55,0)
 S DGBTMAF=$S(DGBTMLFB:DGBTMAL+DGBTFAB,1:0),DGBTMETC=DGBTME+$S($D(DGBTMAL):DGBTMAL,1:0)
"RTN","DGBTCE",56,0)
 I DGBTACCT'=4&(DGBTACCT'=5) S DGBTPA=DGBTMAF+DGBTME G CONT
"RTN","DGBTCE",57,0)
 I $D(DGBTMLT) S DGBTTC=$S(DGBTMLT+DGBTMAF'>DGBTMETC:DGBTMLT+DGBTMAF,DGBTMLT+DGBTMAF>DGBTMETC&(DGBTME>0):DGBTMETC,DGBTME'>0:DGBTMLT+DGBTMAF,1:DGBTMETC)
"RTN","DGBTCE",58,0)
 I DGBTACCT=5 S DGBTDE=0 S DGBTPA=$S((DGBTMLT+DGBTMAF)'=0:DGBTTC,1:DGBTMETC) G CONT
"RTN","DGBTCE",59,0)
DED ;
"RTN","DGBTCE",60,0)
 I $G(MONTOT)'="" N ODED S ODED=$$GET1^DIQ(392,DGBTDT,9)
"RTN","DGBTCE",61,0)
 F I=$E(DGBTDT,1,5)_"00.2399":0 S I=$O(^DGBT(392,"C",DFN,I)) Q:'I!($E(I,1,5)>$E(DGBTDT,1,5))  I I'=DGBTDT S DGBTDCM=DGBTDCM+($P(^DGBT(392,I,0),"^",9))
"RTN","DGBTCE",62,0)
 I $D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")) S DGBTRATE=^("BT"),DGBTDPV=$P(DGBTRATE,"^"),DGBTDPM=$P(DGBTRATE,"^",2),DGBTMR=$P(DGBTRATE,"^",3)
"RTN","DGBTCE",63,0)
 I $D(^DGBT(392,DGBTDT,"M")) S:$P(^("M"),"^")=1 DGBTDPV=DGBTDPV/2 I DGBTWAY'=$P(^("M"),"^")!(DGBTMILE'=$P(^("M"),"^",2)) I $D(^DGBT(392,DGBTDT,0)) S $P(^(0),"^",9)="" K ^DGBT(392,"AD",$P(^(0),"^",2),$E(DGBTDT,2,5),DGBTDT)
"RTN","DGBTCE",64,0)
 S DGBTDRM=DGBTDPM-DGBTDCM
"RTN","DGBTCE",65,0)
 I DGBTDRM<0 S DGBTDRM=0
"RTN","DGBTCE",66,0)
 I DGBTDE<0 S DGBTDE=0
"RTN","DGBTCE",67,0)
 S DGBTDCV=$S(DGBTDCM'<DGBTDPM:0,DGBTDRM'<DGBTDPV&(DGBTTC'<DGBTDPV):DGBTDPV,DGBTDRM'<DGBTDPV&(DGBTTC'>DGBTDPV):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'>DGBTDRM):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'<DGBTDRM):DGBTDRM,1:0)
"RTN","DGBTCE",68,0)
 I $P(MONTOT,"^",5)="YES" S DGBTDCV=0
"RTN","DGBTCE",69,0)
DED1 ;
"RTN","DGBTCE",70,0)
 S DR="I $P(^DGBT(392,DGBTDT,0),""^"",9)]"""" S Y=""@9"";9///"_DGBTDCV_";@9;9;S DGBTDE=X S:DGBTDE>DGBTTC DGBTDE=DGBTTC,DGBTFLAG=2 S:DGBTDE>DGBTDRM DGBTDE=DGBTDRM,DGBTFLAG=1"
"RTN","DGBTCE",71,0)
DIE4 ;
"RTN","DGBTCE",72,0)
 I $G(^DGBT(392,DGBTDT,0))'="" D
"RTN","DGBTCE",73,0)
 .I $P(^DGBT(392,DGBTDT,0),U,9)="" S $P(^DGBT(392,DGBTDT,0),U,9)=+$G(DGBTDCV)
"RTN","DGBTCE",74,0)
 S DIE="^DGBT(392,",DA=DGBTDT D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",75,0)
 I ($G(MONTOT)'="")&($G(ODED)'=DGBTDE) D
"RTN","DGBTCE",76,0)
 .S $P(MONTOT,U,4)=$P(MONTOT,U,4)+DGBTDE
"RTN","DGBTCE",77,0)
 .S $P(MONTOT,U,4)=$P(MONTOT,U,4)-ODED
"RTN","DGBTCE",78,0)
CONT ;
"RTN","DGBTCE",79,0)
 D CONT^DGBTCE1
"RTN","DGBTCE",80,0)
 Q
"RTN","DGBTCE",81,0)
FILE ;      Reset values if account changes
"RTN","DGBTCE",82,0)
 S DGBTVAR(0)=$P(DGBTVAR(0),"^",1,6)_"^^0^^"_$S($L(DGBTVAR(0),"^")>10:$P(DGBTVAR(0),"^",10,$L(DGBTVAR(0),"^")),1:""),DGBTVAR("A")="^"_$P(DGBTVAR("A"),"^",2)_"^^^"_$S($L(DGBTVAR("A"),"^")>4:$P(DGBTVAR("A"),"^",5,$L(DGBTVAR("A"),"^")),1:"")
"RTN","DGBTCE",83,0)
 I DGBTACCT<4 S DGBTVAR("M")="^^^"_$S($L(DGBTVAR("M"),"^")>3:$P(DGBTVAR("M"),"^",4,$L(DGBTVAR("M"),"^")),1:"")
"RTN","DGBTCE",84,0)
 S ^DGBT(392,DGBTDT,0)=DGBTVAR(0),^("A")=DGBTVAR("A") S:DGBTACCT<4 ^("M")=DGBTVAR("M") S DA=DGBTDT,DIK="^DGBT(392," D IX^DIK
"RTN","DGBTCE",85,0)
 Q
"RTN","DGBTCE1")
0^38^B12864135
"RTN","DGBTCE1",1,0)
DGBTCE1 ;ALB/LM - BENEFICIARY TRAVEL CLAIM RE-ENTER/EDIT CONT.; 9/13/89@8:00 ;4/23/91  09:42
"RTN","DGBTCE1",2,0)
 ;;1.0;Beneficiary Travel;**17,20**;September 25, 2001;Build 185
"RTN","DGBTCE1",3,0)
 Q
"RTN","DGBTCE1",4,0)
CONT ; ENTRY POINTS FROM DGBTEE,DGBTCE
"RTN","DGBTCE1",5,0)
 N MOSTENC
"RTN","DGBTCE1",6,0)
 F I=0,"A","C","D","M","R","T" S DGBTVAR(I)=$S($D(^DGBT(392,DGBTDT,I)):^(I),1:"")
"RTN","DGBTCE1",7,0)
 I DGBTDE<0 S DGBTDE=0
"RTN","DGBTCE1",8,0)
 I $G(DGBTCCREQ) S DGBTFLX=" DEDUCTIBLE AMOUNT HAS BEEN CHANGED " I DGBTACCT=4 S DGBTPA=$S(DGBTTC-DGBTDE>0:DGBTTC-DGBTDE,DGBTTC-DGBTDE<0:DGBTTC,1:0)
"RTN","DGBTCE1",9,0)
DIE5 ;S DGBTINFL=$S(DGBTDE=DGBTDCV:$P(DGBTVAR("R"),DGBTFLX)_$P(DGBTVAR("R"),DGBTFLX,2)_" ",DGBTDE'=DGBTDCV&(DGBTVAR("R")'[DGBTFLX):$E(DGBTVAR("R")_DGBTINFL_DGBTFLX,1,79),1:DGBTVAR("R"))
"RTN","DGBTCE1",10,0)
 S MOSTENC=$$GET1^DIQ(392,DGBTDT,8)
"RTN","DGBTCE1",11,0)
 S DGBTPA=$P(DGBTVAR(0),"^",10)
"RTN","DGBTCE1",12,0)
 I $G(DGBTCCREQ) S DGBTPA=$S($G(MOSTENC)>0&(MOSTENC<DGBTPA):MOSTENC,1:DGBTPA),DGBTPA=$S(DGBTPA-$G(DGBTDE)<0:0,1:DGBTPA)   ;$P(DGBTVAR(0),"^",9)
"RTN","DGBTCE1",13,0)
 I '$G(DGBTCCREQ),'$G(MOSTENC) D
"RTN","DGBTCE1",14,0)
 .S DGBTPA=$P(DGBTVAR("C"),"^",2)+$P(DGBTVAR("M"),"^",4)+$P(DGBTVAR("M"),"^",5)
"RTN","DGBTCE1",15,0)
 .I $P(DGBTVAR("M"),"^",3)-$G(DGBTDCV1)>0 S DGBTPA=DGBTPA+(DGBTMLT-$G(DGBTDE))
"RTN","DGBTCE1",16,0)
 .I $P(DGBTVAR("M"),"^",3)-$G(DGBTDCV1)<0 S DGBTPA=DGBTPA
"RTN","DGBTCE1",17,0)
 ;    stuff amount payable
"RTN","DGBTCE1",18,0)
 I DGBTFLAG=2 W !!,"DEDUCTIBLE AMOUNT CAN NOT EXCEED THE TOTAL COSTS FOR THIS CLAIM",! K X S DGBTFLAG=0 G DED1^DGBTCE
"RTN","DGBTCE1",19,0)
 I DGBTFLAG=1 W !!,"DEDUCTIBLE FOR THIS CLAIM CAN NOT EXCEED THE AMOUNT REMAINING FOR THIS MONTH",! K X S DGBTFLAG=0 G DED1^DGBTCE
"RTN","DGBTCE1",20,0)
 ;
"RTN","DGBTCE1",21,0)
 S DIE="^DGBT(392,",DA=DGBTDT,DIE("NO^")="BACK",DR="51"
"RTN","DGBTCE1",22,0)
DIE6 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=-1 Q
"RTN","DGBTCE1",23,0)
 I ($L(DGBTACCT)=1),("45"[DGBTACCT) D
"RTN","DGBTCE1",24,0)
 .N FDA,ERR
"RTN","DGBTCE1",25,0)
 .S DGBTPA=$$PAYABLE
"RTN","DGBTCE1",26,0)
 .S FDA(392,DGBTDT_",",9)=DGBTDE
"RTN","DGBTCE1",27,0)
 .S FDA(392,DGBTDT_",",10)=DGBTPA
"RTN","DGBTCE1",28,0)
 .D FILE^DIE("E","FDA","ERR")
"RTN","DGBTCE1",29,0)
 .I $D(ERR) S DGBTTOUT=-1
"RTN","DGBTCE1",30,0)
 I $G(DGBTTOUT)=-1 Q
"RTN","DGBTCE1",31,0)
 D QUIT
"RTN","DGBTCE1",32,0)
 D SCREEN^DGBTCD
"RTN","DGBTCE1",33,0)
 Q
"RTN","DGBTCE1",34,0)
QUIT ;KILL VARIABLES
"RTN","DGBTCE1",35,0)
 K DGBTCITY,DGBTSTAT,DGBTWAY,DGBTMILE,DIE,DR,DGBTOWRT,DGBTML,DGBTMLFB,DGBTACCT,DGBTAP,DGBTMAL,DGBTFAB,DGBTME,DGBTMAF,DGBTTC,DGBTDCM,DGBTDPV,DGBTDPM,DGBTDRM,DGBTDCV,DGBTDE,DGBTPA,I,DGBTELIG,DGBTFLAG,DGBTMETC,DGBTMLT,DGBTCP,DGBTMR1
"RTN","DGBTCE1",36,0)
 K DGBTFR1,DGBTFR2,DGBTFR3,DGBTFR4,DGBTTO1,DGBTTO2,DGBTTO3,DGBTTO4,DGBTMR,DGBTRATE,DGBTSCP,DGBTFLX Q
"RTN","DGBTCE1",37,0)
PAYABLE() ;
"RTN","DGBTCE1",38,0)
 N DGBTRAY,FERRIES,MEALS,MILEAGE
"RTN","DGBTCE1",39,0)
 D GETS^DIQ(392,DGBTDT_",","8;33;34;35;55;55.1","EI","DGBTRAY")
"RTN","DGBTCE1",40,0)
 S MEALS=+DGBTRAY(392,DGBTDT_",",34,"I")
"RTN","DGBTCE1",41,0)
 S MILEAGE=+DGBTRAY(392,DGBTDT_",",33,"I")
"RTN","DGBTCE1",42,0)
 S FERRIES=+DGBTRAY(392,DGBTDT_",",35,"I")
"RTN","DGBTCE1",43,0)
 I DGBTDE>MILEAGE S DGBTDE=MILEAGE
"RTN","DGBTCE1",44,0)
 I DGBTRAY(392,DGBTDT_",",55.1,"E")="NO" Q $$COMCARN
"RTN","DGBTCE1",45,0)
 I DGBTRAY(392,DGBTDT_",",55.1,"E")="YES" Q $$COMCARY
"RTN","DGBTCE1",46,0)
 S DGBTPA=MILEAGE+MEALS+FERRIES
"RTN","DGBTCE1",47,0)
 I DGBTDE>DGBTPA Q 0
"RTN","DGBTCE1",48,0)
 Q (DGBTPA-DGBTDE)
"RTN","DGBTCE1",49,0)
 ;
"RTN","DGBTCE1",50,0)
COMCARN() ;CC not required
"RTN","DGBTCE1",51,0)
 N CCFEE,MOSTEC,FDA
"RTN","DGBTCE1",52,0)
 S MOSTEC=+DGBTRAY(392,DGBTDT_",",8,"I")
"RTN","DGBTCE1",53,0)
 I DGBTDE>MILEAGE S DGBTDE=MILEAGE
"RTN","DGBTCE1",54,0)
 I (MOSTEC>0)&(MILEAGE'>0) Q (MOSTEC+MEALS+FERRIES)
"RTN","DGBTCE1",55,0)
 I (MOSTEC>0)&(MOSTEC>MILEAGE) S DGBTPA=(MILEAGE+MEALS+FERRIES)
"RTN","DGBTCE1",56,0)
 I (MOSTEC>0)&(MOSTEC'>MILEAGE) D  Q (MOSTEC+MEALS+FERRIES)
"RTN","DGBTCE1",57,0)
 .S FDA(392,DGBTDT_",",9)=0 S DGBTDE=0
"RTN","DGBTCE1",58,0)
 .D FILE^DIE("E","FDA","ERR")
"RTN","DGBTCE1",59,0)
 I (MOSTEC'>0) S DGBTPA=(MILEAGE+MEALS+FERRIES)
"RTN","DGBTCE1",60,0)
 I DGBTDE>DGBTPA Q 0
"RTN","DGBTCE1",61,0)
 Q (DGBTPA-DGBTDE)
"RTN","DGBTCE1",62,0)
 ;
"RTN","DGBTCE1",63,0)
COMCARY() ; CC required
"RTN","DGBTCE1",64,0)
 N CCFEE,MOSTEC
"RTN","DGBTCE1",65,0)
 S CCFEE=+DGBTRAY(392,DGBTDT_",",55,"I")
"RTN","DGBTCE1",66,0)
 I DGBTDE>MILEAGE S DGBTDE=MILEAGE,MILEAGE=DGBTDE
"RTN","DGBTCE1",67,0)
 S DGBTPA=CCFEE+MILEAGE+MEALS+FERRIES
"RTN","DGBTCE1",68,0)
 S DGBTPA=CCFEE+MEALS+FERRIES+MILEAGE
"RTN","DGBTCE1",69,0)
 I DGBTDE>DGBTPA Q 0
"RTN","DGBTCE1",70,0)
 Q (DGBTPA-DGBTDE)
"RTN","DGBTCR")
0^24^B25363129
"RTN","DGBTCR",1,0)
DGBTCR ;ALB/SCK - BENEFICIARY TRAVEL FORM 70-3542d VARIABLES; 2/7/88@08:00 ;6/11/93@09:30
"RTN","DGBTCR",2,0)
 ;;1.0;Beneficiary Travel;**7,14,20**;September 25, 2001;Build 185
"RTN","DGBTCR",3,0)
 ;Modification of AIVBTPRT / pmg / GRAND ISLAND ; 07 Jul 88 12:02 PM
"RTN","DGBTCR",4,0)
START Q:'$D(DGBTDT)
"RTN","DGBTCR",5,0)
 D MILE
"RTN","DGBTCR",6,0)
 S DGBTVAR(0)=$G(^DGBT(392,+DGBTDT,0)),DGBTACCT=$P($G(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0)),"^",5)
"RTN","DGBTCR",7,0)
 Q:DGBTACCT'>3
"RTN","DGBTCR",8,0)
 W !!,*7,"This needs to be printed at 132 columns"
"RTN","DGBTCR",9,0)
 S DGPGM="PRINT^DGBTCR",DGVAR="DGBTDT"
"RTN","DGBTCR",10,0)
 S %ZIS="PMQ" D ^%ZIS G QUIT:POP
"RTN","DGBTCR",11,0)
 I $D(IO("Q")) D QUE G QUIT
"RTN","DGBTCR",12,0)
 D PRINT
"RTN","DGBTCR",13,0)
QUIT ;
"RTN","DGBTCR",14,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","DGBTCR",15,0)
 K DGPGM,DGVAR,VADAT,VADATE,I,X,X2,DGBTVAR,DGBTCC,DGBTDIV,DGBTDOB,DGBTINS,DGBTINS1,DGBTINS2,DGBTCNA,DGBTCSZ,DGBTCNU,DGBTTCTY,DGBTFCTY,DGBTDT,DGBTACCT,DFN,Y
"RTN","DGBTCR",16,0)
 K DGBTM6,DGBTM7,DGBTM8,DGBTM8A,DGBTM9,DGBTM10,DGBTM11,DGBTM12,DGBTM13,DGBTM14,DGBTM15,DGBTM16,DGBTM17,DGBTRATE,DGBTSCP,DGBTSSN,DGBTST,DTOTAL,CDAT,D
"RTN","DGBTCR",17,0)
 Q
"RTN","DGBTCR",18,0)
PRINT ;
"RTN","DGBTCR",19,0)
 U IO D SET,PRINT^DGBTCR1,PRINT^DGBTCR2,KVAR^VADPT
"RTN","DGBTCR",20,0)
 Q
"RTN","DGBTCR",21,0)
SET S DFN=$P(^DGBT(392,DGBTDT,0),"^",2) D 6^VADPT S (DGBTFCTY,DGBTTCTY)=""
"RTN","DGBTCR",22,0)
NODES F I=0,"A","C","D","M","R","T" S DGBTVAR(I)=$S($D(^DGBT(392,DGBTDT,I)):^(I),1:"")
"RTN","DGBTCR",23,0)
 I $D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")) S DGBTRATE=^("BT"),DGBTM7=$S($P(DGBTVAR("A"),"^",3)=1:$P(DGBTRATE,"^",5),1:$P(DGBTRATE,"^",3))
"RTN","DGBTCR",24,0)
 I $P(DGBTVAR("D"),"^",4)]"" S DGBTCNA=$P(DGBTVAR("D"),"^",4) D CITY I DGBTCSZ[DGBTCNA D
"RTN","DGBTCR",25,0)
 . S DGBTCSZ=DGBTCNA_", "_$S(+$P(DGBTVAR("D"),"^",5)>0:$P(^DIC(5,$P(DGBTVAR("D"),"^",5),0),U,2),1:"")_"  "
"RTN","DGBTCR",26,0)
 . S Y=$P(DGBTVAR("D"),U,6),Y=$E(Y,1,5)_$S($E(Y,6,9)]"":"-"_$E(Y,6,9),1:""),DGBTCSZ=DGBTCSZ_Y,DGBTFCTY=DGBTCSZ
"RTN","DGBTCR",27,0)
 I $P(DGBTVAR("T"),"^",4)]"" S DGBTCNA=$P(DGBTVAR("T"),U,4) D CITY^DGBTCR S:DGBTCSZ[DGBTCNA DGBTCSZ=DGBTCNA_", "_$S(+$P(DGBTVAR("T"),"^",5)>0:$P(^DIC(5,$P(DGBTVAR("T"),"^",5),0),U,2),1:"")_"  "_$P(DGBTVAR("T"),U,6) S DGBTTCTY=DGBTCSZ
"RTN","DGBTCR",28,0)
DIV S DGBTDIV=$P(DGBTVAR(0),"^",11) I +DGBTDIV S DGBTDIV=$P(^DG(40.8,DGBTDIV,0),"^",7) S (DGBTCC,DGBTST)=""
"RTN","DGBTCR",29,0)
 I $D(^DIC(4,+DGBTDIV,0)) S DGBTINS=^(0),DGBTINS1=$S($D(^DIC(4,DGBTDIV,1)):^(1),1:""),DGBTINS2=$S(DGBTINS1]"":$P(DGBTINS1,"^",3)_",",1:"UNSPECIFIED")_" "_$S($D(^DIC(5,+$P(DGBTINS,U,2),0)):$P(^(0),U,2),1:"")_"  "_$P(DGBTINS1,"^",4)
"RTN","DGBTCR",30,0)
 I VAPA(5)&(VAPA(7)) S DGBTCC=$S($D(^DIC(5,+VAPA(5),1,+VAPA(7),0)):$P(^(0),"^",3),1:""),DGBTST=$P(^DIC(5,+VAPA(5),0),"^",2)
"RTN","DGBTCR",31,0)
 D PID^VADPT6 S DGBTSSN=VA("PID"),DGBTDOB=$E(VADM(3),4,7)_($E(VADM(3),1,3)+1700)
"RTN","DGBTCR",32,0)
 S DGBTSCP=$S($L($P(VAEL(3),"^",2)<3):"0",1:"")_$P(VAEL(3),"^",2)
"RTN","DGBTCR",33,0)
MILES S DGBTM6=$P(DGBTVAR("M"),"^")*$P(DGBTVAR("M"),"^",2)
"RTN","DGBTCR",34,0)
 N X3
"RTN","DGBTCR",35,0)
 S X2="2$",X=DGBTM6*DGBTM7 D COMMA^%DTC S DGBTM8=X
"RTN","DGBTCR",36,0)
 S X=$P(DGBTVAR("C"),"^",2) D COMMA^%DTC S DGBTM8A=X
"RTN","DGBTCR",37,0)
 S X=$P(DGBTVAR("M"),"^",4) D COMMA^%DTC S DGBTM9=X
"RTN","DGBTCR",38,0)
 S X=$P(DGBTVAR("M"),"^",5) D COMMA^%DTC S DGBTM10=X
"RTN","DGBTCR",39,0)
 S X=DGBTM6*DGBTM7+$P(DGBTM8A,"$",2)+$P(DGBTVAR("M"),"^",4)+$P(DGBTVAR("M"),"^",5) D COMMA^%DTC S DGBTM11=X
"RTN","DGBTCR",40,0)
 S X2="3$",X=DGBTM7 D COMMA^%DTC S DGBTM7=X
"RTN","DGBTCR",41,0)
 S X2="2$"  ;Reset edit mask to 2 decimal positions for rest of report
"RTN","DGBTCR",42,0)
 S X=$P(DGBTVAR(0),"^",8) D COMMA^%DTC S DGBTM12=X
"RTN","DGBTCR",43,0)
 S X=$P(DGBTVAR("M"),"^",4)+$P(DGBTVAR(0),"^",8) D COMMA^%DTC S DGBTM13=X
"RTN","DGBTCR",44,0)
 S X=$P(DGBTVAR(0),"^",10) D COMMA^%DTC S DGBTM14=X
"RTN","DGBTCR",45,0)
 S X=$P(DGBTVAR(0),"^",9) D COMMA^%DTC S $P(DGBTM14,"^",2)=X
"RTN","DGBTCR",46,0)
CERT S VADAT("W")=DGBTDT D ^VADATE S DGBTM15=VADATE("E")
"RTN","DGBTCR",47,0)
 S X=$S($P(^DG(43,1,"BT"),"^")'="":$P(^DG(43,1,"BT"),"^"),1:DUZ),DGBTM16=$P($P(^VA(200,X,0),",",2),"^")_" "_$P(^VA(200,X,0),",")_$S($P(^DG(43,1,"BT"),"^")'="":"",1:", DESIGNEE OF CERTIFYING OFFICIAL") K X
"RTN","DGBTCR",48,0)
 S DGBTM17=$P($P(DGBTVAR("A"),"^",2),",",2)_" "_$P($P(DGBTVAR("A"),"^",2),",")
"RTN","DGBTCR",49,0)
 Q
"RTN","DGBTCR",50,0)
CITY S DGBTCSZ=DGBTCNA
"RTN","DGBTCR",51,0)
 S:VAPA(5)'="" DGBTCNU=$O(^DGBT(392.1,"ACS",DGBTCNA,+VAPA(5),0))
"RTN","DGBTCR",52,0)
 I $D(DGBTCNU),(DGBTCNU'="") S DGBTCSZ=$P(^DGBT(392.1,DGBTCNU,0),"^")_", "_($P(^DIC(5,+VAPA(5),0),"^",2))_"  "_($P(^DGBT(392.1,DGBTCNU,0),"^",4))
"RTN","DGBTCR",53,0)
 Q
"RTN","DGBTCR",54,0)
QUE ;
"RTN","DGBTCR",55,0)
 N I
"RTN","DGBTCR",56,0)
 S ZTRTN="PRINT^DGBTCR",ZTDESC="VA FORM 70-3542d"
"RTN","DGBTCR",57,0)
 F I="DFN","DGBTDT","DGBTFCTY","DGBTTCTY","ONEWAY","RTRIP","DTOTAL" S ZTSAVE(I)=""
"RTN","DGBTCR",58,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"TASK #",ZTSK
"RTN","DGBTCR",59,0)
 D HOME^%ZIS K IO("Q")
"RTN","DGBTCR",60,0)
 Q
"RTN","DGBTCR",61,0)
 ;
"RTN","DGBTCR",62,0)
MILE ; one way, round trip and total amount deductible
"RTN","DGBTCR",63,0)
 I $D(MONTOT) D  Q
"RTN","DGBTCR",64,0)
 .S ONEWAY=$P(MONTOT,U,2),RTRIP=$P(MONTOT,U,3),DTOTAL=$P(MONTOT,U,4)
"RTN","DGBTCR",65,0)
 K CDAT,SDATE,EDATE,PDATA,DEDUCT,EMONTH,MDATA,DGBTRIP
"RTN","DGBTCR",66,0)
 S (DEDUCT,DTOTAL,ONEWAY,RTRIP,CDAT,SDATE,EDATE)=0
"RTN","DGBTCR",67,0)
 S EMONTH=0
"RTN","DGBTCR",68,0)
 ;
"RTN","DGBTCR",69,0)
 S SDATE=$P(DGBTDT,".",1)
"RTN","DGBTCR",70,0)
 S SDATE=$E(SDATE,1,5)_"01"   ;_.0001
"RTN","DGBTCR",71,0)
 S EDATE=$E(DGBTDT,1,5)
"RTN","DGBTCR",72,0)
 S EMONTH=$E(DGBTDT,4,5) S EMONTH=EMONTH+1
"RTN","DGBTCR",73,0)
 S:$L(EMONTH)=1 EMONTH="0"_EMONTH
"RTN","DGBTCR",74,0)
 S EDATE=$E(DGBTDT,1,3)_EMONTH_"00"
"RTN","DGBTCR",75,0)
 ;
"RTN","DGBTCR",76,0)
 F  S CDAT=$O(^DGBT(392,"C",DFN,CDAT)) Q:'CDAT  D
"RTN","DGBTCR",77,0)
 .Q:$$GET1^DIQ(392,CDAT,45.2,"I")   ;DENIED CLAIM, DON'T COUNT
"RTN","DGBTCR",78,0)
 .Q:$P(^DGBT(392,CDAT,0),"^",16)'=""
"RTN","DGBTCR",79,0)
 .Q:$D(^DGBT(392,CDAT,"SP"))
"RTN","DGBTCR",80,0)
 .Q:CDAT<SDATE!(CDAT>EDATE)
"RTN","DGBTCR",81,0)
 .Q:'$D(^DGBT(392,CDAT,0))
"RTN","DGBTCR",82,0)
 .Q:$D(DGBTRIP("ONEWAY",$P(CDAT,".",1)))
"RTN","DGBTCR",83,0)
 .S PDATA=$G(^DGBT(392,CDAT,0))
"RTN","DGBTCR",84,0)
 .S DEDUCT=$P(PDATA,"^",9)
"RTN","DGBTCR",85,0)
 .S DTOTAL=DTOTAL+DEDUCT
"RTN","DGBTCR",86,0)
 .;
"RTN","DGBTCR",87,0)
 .S MDATA=$G(^DGBT(392,CDAT,"M"))
"RTN","DGBTCR",88,0)
 .Q:$P(MDATA,"^",1)=""
"RTN","DGBTCR",89,0)
 .I $P(MDATA,"^",1)=1,'$D(DGBTRIP("ONEWAY",$P(CDAT,".",1))) S ONEWAY=ONEWAY+1
"RTN","DGBTCR",90,0)
 .I $P(MDATA,"^",1)=2,'$D(DGBTRIP("RTRIP",$P(CDAT,".",1))) S RTRIP=RTRIP+1
"RTN","DGBTCR",91,0)
 ;
"RTN","DGBTCR",92,0)
 Q
"RTN","DGBTCR1")
0^25^B10630325
"RTN","DGBTCR1",1,0)
DGBTCR1 ;ALB/SCK - BENEFICIARY TRAVEL FORM 70-3542d; 2/7/88@08:00  6/11/93@09:30
"RTN","DGBTCR1",2,0)
 ;;1.0;Beneficiary Travel;**18,20**;September 25, 2001;Build 185
"RTN","DGBTCR1",3,0)
 ;This routine is a modification of AIVBTPRT / pmg / GRAND ISLAND ;07 Jul 88  12:02 PM
"RTN","DGBTCR1",4,0)
 Q
"RTN","DGBTCR1",5,0)
 ;Called by DGBTCR
"RTN","DGBTCR1",6,0)
PRINT K I S $P(I,"=",65)="" W !?66,"|",I,"|",!?7,VADM(1),?50 I $D(^DIC(13,+VADM(9),0)) W $P(^(0),"^",4)
"RTN","DGBTCR1",7,0)
 W ?66,"|  VOUCHER FOR CASH REIMBURSEMENT OF BENEFICIARY TRAVEL EXPENSES |"
"RTN","DGBTCR1",8,0)
 W !?7,VAPA(1),?50,DGBTCC,?66,"|"
"RTN","DGBTCR1",9,0)
 K I S $P(I,"=",65)="" W ?67,I,"|"
"RTN","DGBTCR1",10,0)
 W !,?7,VAPA(2),?66,"| 2.  Name and Address of Issuing Health Care Facility",?131,"|"
"RTN","DGBTCR1",11,0)
 W !?7,VAPA(4),?40,DGBTST,?50,$P(VAPA(11),U,2),?66,"|",?131,"|"
"RTN","DGBTCR1",12,0)
 W !?66,"|",?131,"|"
"RTN","DGBTCR1",13,0)
 W !?7,DGBTSSN,?21,$E($P(VADM(10),"^",2),1),?22,$P(VADM(5),"^"),?30,DGBTDOB,?50,DGBTDIV,?66,"|",?88,$P($G(DGBTINS),"^"),?131,"|"
"RTN","DGBTCR1",14,0)
 W !?66,"|",?88 W:$P(DGBTINS1,"^")'="" $P(DGBTINS1,"^") W:$P(DGBTINS1,"^")="" $P(DGBTINS1,"^",2) W:$P(DGBTINS1,"^")=""&($P(DGBTINS1,"^",2)="") DGBTINS2 W ?131,"|"
"RTN","DGBTCR1",15,0)
 W !?7,VAEL(7),?19 I $D(^DIC(8,+VAEL(1),0)) W $P(^(0),"^",4)
"RTN","DGBTCR1",16,0)
 W ?21,DGBTSCP,?28 I $D(^DIC(21,+VAEL(2),0)) W $P(^(0),"^",3)
"RTN","DGBTCR1",17,0)
 W ?66,"|",?88 W:$P(DGBTINS1,"^",2)'=""&($P(DGBTINS1,"^")'="") $P(DGBTINS1,"^",2) W:$P(DGBTINS1,"^")'=""&($P(DGBTINS1,"^",2)="") DGBTINS2 W:$P(DGBTINS1,"^")=""&($P(DGBTINS1,"^",2)'="") DGBTINS2 W ?131,"|"
"RTN","DGBTCR1",18,0)
 W !?66,"|",?88 W:$P(DGBTINS1,"^")'=""&($P(DGBTINS1,"^",2)'="")&($P(DGBTINS,"^",2)'="") DGBTINS2 W ?131,"|"
"RTN","DGBTCR1",19,0)
 W !,"  1.  Patient Data Card Information",?66,"|",?131,"|" D LINE
"RTN","DGBTCR1",20,0)
FISCAL W !,"| 3.  Fiscal Symbols"
"RTN","DGBTCR1",21,0)
 W ?30,$P(DGBTRATE,"^",4),?131,"|" D LINE
"RTN","DGBTCR1",22,0)
 W !,"| 4.  From (Place of Departure)",?66,"| 5.  To (Destination)",?131,"|"
"RTN","DGBTCR1",23,0)
RMV ; W !,"|",?66,"|",?131,"|"
"RTN","DGBTCR1",24,0)
 W !,"|",?12,$P(DGBTVAR("D"),"^"),?66,"|",?88,$P(DGBTVAR("T"),"^"),?131,"|"
"RTN","DGBTCR1",25,0)
 W !,"|",?12 W:$P(DGBTVAR("D"),"^",2)'="" $P(DGBTVAR("D"),"^",2) W:$P(DGBTVAR("D"),"^",2)="" $P(DGBTVAR("D"),"^",3) W:$P(DGBTVAR("D"),"^",2)=""&($P(DGBTVAR("D"),"^",3)="") DGBTFCTY
"RTN","DGBTCR1",26,0)
 W ?66,"|",?88 W:$P(DGBTVAR("T"),"^",2)'="" $P(DGBTVAR("T"),"^",2) W:$P(DGBTVAR("T"),"^",2)="" $P(DGBTVAR("T"),"^",3) W:$P(DGBTVAR("T"),"^",2)=""&($P(DGBTVAR("T"),"^",3)="") DGBTTCTY W ?131,"|"
"RTN","DGBTCR1",27,0)
 W !,"|",?12 W:$P(DGBTVAR("D"),"^",3)'="" $P(DGBTVAR("D"),"^",3) W:$P(DGBTVAR("D"),"^",2)'=""&($P(DGBTVAR("D"),"^",3)="") DGBTFCTY
"RTN","DGBTCR1",28,0)
 W ?66,"|",?88 W:$P(DGBTVAR("T"),"^",3)'="" $P(DGBTVAR("T"),"^",3) W:$P(DGBTVAR("T"),"^",2)'=""&($P(DGBTVAR("T"),"^",3)="") DGBTTCTY W ?131,"|"
"RTN","DGBTCR1",29,0)
 W !,"|",?12 W:$P(DGBTVAR("D"),"^",2)'=""&($P(DGBTVAR("D"),"^",3)'="") DGBTFCTY
"RTN","DGBTCR1",30,0)
 W ?66,"|",?88 W:$P(DGBTVAR("T"),"^",2)'=""&($P(DGBTVAR("T"),"^",3)'="") DGBTTCTY W ?131,"|" D LINE
"RTN","DGBTCR1",31,0)
 Q
"RTN","DGBTCR1",32,0)
LINE K I S $P(I,"=",131)="" W !,"|",I,"|"
"RTN","DGBTCR1",33,0)
 Q
"RTN","DGBTCR2")
0^26^B16305371
"RTN","DGBTCR2",1,0)
DGBTCR2 ;ALB/SCK - BENEFICIARY TRAVEL FORM 70-3542d CONTINUE; 2/7/88@08:00  6/11/93@09:30
"RTN","DGBTCR2",2,0)
 ;;1.0;Beneficiary Travel;**7,14,20**;September 25, 2001;Build 185
"RTN","DGBTCR2",3,0)
 ;This routine is a modification of AIVBTPRT / pmg / GRAND ISLAND ;07 Jul 88  12:02 PM
"RTN","DGBTCR2",4,0)
 Q
"RTN","DGBTCR2",5,0)
PRINT ;Continuation of DGBTCR1, called by DGBTCR
"RTN","DGBTCR2",6,0)
MILEAGE W !,"| 6.  Miles Traveled",?30,"| 7.  Authorized Mileage Rate:",?66,"| 8.  MileageAllowance (Item 6 X Item 7) | 8a. CommonCarrier Fee"
"RTN","DGBTCR2",7,0)
 W ?131,"|"
"RTN","DGBTCR2",8,0)
RMV ;W !,"|",?30,"|",?66,"|",?131,"|"
"RTN","DGBTCR2",9,0)
 W !,"|",?10,DGBTM6," miles",?30,"|",?40,DGBTM7," per mile",?66,"|",?80,DGBTM8,?107,"|",$G(DGBTM8A),?131,"|" D LINE
"RTN","DGBTCR2",10,0)
COST1 W !,"| 9.  Meals & Lodging Costs   |",?32,"10.  Ferry, Bridges, Etc.",?66,"| 11.  Total (Sum of 8, 8a, 9, and 10)",?131,"|"
"RTN","DGBTCR2",11,0)
RMV1 ;W !,"|",?30,"|",?66,"|",?131,"|"
"RTN","DGBTCR2",12,0)
 W !,"|",?7,DGBTM9,?30,"|",?40,DGBTM10,?66,"|",?80,DGBTM11,?131,"|" D LINE
"RTN","DGBTCR2",13,0)
COST2 W !,"| 12.  Most Economical",?30,"| 13.  Total (Sum of 9 and 12)",?66,"| 14.  AMOUNT CLAIMED AND PAYABLE *",?131,"|"
"RTN","DGBTCR2",14,0)
 W !,"|      Public Trans. Costs",?30,"|",?66,"|","      MINUS",?80,$P(DGBTM14,"^",2)," APPLIED DEDUCTIBLE",?131,"|"
"RTN","DGBTCR2",15,0)
RMV2 ;W !,"|",?30,"|",?66,"|",?131,"|"
"RTN","DGBTCR2",16,0)
 W !,"|",?7,DGBTM12,?30,"|",?40,DGBTM13,?66,"|",?80,$P(DGBTM14,"^"),?131,"|" D LINE
"RTN","DGBTCR2",17,0)
 W !,"| * The amount payable is the amount entered in Item 14.",?131,"|" D LINE
"RTN","DGBTCR2",18,0)
CERTIFY W !,"|  I CERTIFY THAT THE CLAIMANT REPORTED FOR AN AUTHORIZED SERVICE ON THE DATE SHOWN.  (Authority VA Regulation 6100 & PL 100-322)",?131,"|" D LINE
"RTN","DGBTCR2",19,0)
 W !,"| 15.  Date/Time of Claim",?30,"| 16.  Signature of Certifying Official",?131,"|"  ;,!,"|",?30,"|",?131,"|"
"RTN","DGBTCR2",20,0)
 W !,"|",?8,DGBTM15,?30,"|",?37,DGBTM16,?131,"|" D LINE
"RTN","DGBTCR2",21,0)
PAYEE W !,"|  I have neither obtained transportation at Government expense nor through the use of Government request, tickets, or tokens;",?131,"|"
"RTN","DGBTCR2",22,0)
 W !,"|  and have not used any Government-owned conveyance or incurred any expenses which may be presented as charges against the",?131,"|"
"RTN","DGBTCR2",23,0)
 W !,"|  Dept. of Veterans Affairs for transportation, meals, or lodging in connection with my authorized travel that is not herein",?131,"|"
"RTN","DGBTCR2",24,0)
 W !,"|  claimed.  I hereby claim the amount entered in Item 14 above.  I certify that the claim is correct and just and that payment",?131,"|",!,"|  has not been received.",?131,"|"   ;,!,"|",?131,"|"
"RTN","DGBTCR2",25,0)
 W !,"|  I hereby acknowledge receipt, in  cash  or  check to be mailed, of the amount in Item 14 above, in full payment of this claim.",?131,"|" D LINE
"RTN","DGBTCR2",26,0)
 W !,"| 17.  Signature of Payee",?100,"| 18.  Date",?131,"|"  ;,!,"|",?100,"|",?131,"|"
"RTN","DGBTCR2",27,0)
 W !,"|",?7,DGBTM17,?100,"|",?131,"|" D LINE
"RTN","DGBTCR2",28,0)
REMKS W !,"|",?7,"REMARKS:  ",DGBTVAR("R"),?102,"ACCOUNT: ",$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^",2) W:$P(DGBTVAR("A"),"^",3)=1 "  REVIEW VISIT" W ?131,"|" D LINE
"RTN","DGBTCR2",29,0)
 ;
"RTN","DGBTCR2",30,0)
TRIP ;
"RTN","DGBTCR2",31,0)
 W !,"|",?7,"TOTAL TRIP",?66,"|  TOTAL MONTHLY DEDUCTIBLE",?131,"|"
"RTN","DGBTCR2",32,0)
 W !,"|",?7,"1 WAY = ",$G(ONEWAY),?66,"|  ","$"_$G(DTOTAL),?131,"|"
"RTN","DGBTCR2",33,0)
 W !,"|",?10,"RT = ",$G(RTRIP),?66,"|  ",?131,"|"
"RTN","DGBTCR2",34,0)
 D LINE
"RTN","DGBTCR2",35,0)
 ;
"RTN","DGBTCR2",36,0)
AUDIT W !,"|",?60,"AUDIT BLOCK",?131,"|",!,"|" K I S $P(I,"-",131)="" W I,"|"
"RTN","DGBTCR2",37,0)
 W !,"|",?7,"AMOUNT PAID FOUND CORRECT",?66,"|  Remarks",?131,"|",!,"|" K I S $P(I,"-",65)="" W I
"RTN","DGBTCR2",38,0)
 W ?66,"|",?131,"|",!,"|",?7,"Auditor's Initials",?45,"Date",?66,"|",?131,"|" D LINE W !,"VA Form 70-3542d",!
"RTN","DGBTCR2",39,0)
 Q
"RTN","DGBTCR2",40,0)
LINE K I S $P(I,"=",131)="" W !,"|",I,"|"
"RTN","DGBTCR2",41,0)
 Q
"RTN","DGBTDLT")
0^21^B117344435
"RTN","DGBTDLT",1,0)
DGBTDLT ;BLD-BENEFICIARY TRAVEL DENIAL LETTER TEMPLATES; 03/04/2012@1400; 03/04/2012
"RTN","DGBTDLT",2,0)
 ;;1.0;Beneficiary Travel;**20**;March 4, 2012;Build 185
"RTN","DGBTDLT",3,0)
 ;
"RTN","DGBTDLT",4,0)
EN ;entry point for denial letter templates.
"RTN","DGBTDLT",5,0)
 ;
"RTN","DGBTDLT",6,0)
 N IEN,CNT,TMP,DGBTINST,COUNTER,DGBTDIVI,DGBTDIVN,QUIT,DGIEN,DGIEN2,DGBTLTR
"RTN","DGBTDLT",7,0)
 ;
"RTN","DGBTDLT",8,0)
 K ^TMP("DGBTDLT",$J)
"RTN","DGBTDLT",9,0)
 S QUIT=0
"RTN","DGBTDLT",10,0)
 ;
"RTN","DGBTDLT",11,0)
 W @IOF
"RTN","DGBTDLT",12,0)
 S QUIT=0
"RTN","DGBTDLT",13,0)
 F  D  Q:$G(QUIT)
"RTN","DGBTDLT",14,0)
 .D MENU(.DGIEN) Q:$G(QUIT)                               ;this will allow the user to choose which letter to edit.
"RTN","DGBTDLT",15,0)
 .D EDIT                                ;this will bring of the screen editor for denial letter(s)
"RTN","DGBTDLT",16,0)
 ;
"RTN","DGBTDLT",17,0)
 Q
"RTN","DGBTDLT",18,0)
 ;
"RTN","DGBTDLT",19,0)
MENU(DGIEN) ;allow user to select which letter to edit
"RTN","DGBTDLT",20,0)
 ;
"RTN","DGBTDLT",21,0)
 S DIR("A")="SELECT TEMPLATE TYPE"
"RTN","DGBTDLT",22,0)
 S DIR("L",1)="CHOOSE FROM:"
"RTN","DGBTDLT",23,0)
 S DIR("L",2)="MILEAGE DENIAL TEMPLATE"
"RTN","DGBTDLT",24,0)
 S DIR("L",3)="SPECIAL MODE DENIAL TEMPLATE"
"RTN","DGBTDLT",25,0)
 S DIR("?")="ENTER EITHER 'M' FOR MILEAGE DENIAL TEMPLATE OR 'S' FOR SPECIAL MODE DENIAL TEMPLATE"
"RTN","DGBTDLT",26,0)
 S DIR(0)="S^M:MILEAGE DENIAL TEMPLATE;S:SPECIAL MODE DENIAL TEMPLATE"
"RTN","DGBTDLT",27,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S QUIT=1 Q
"RTN","DGBTDLT",28,0)
 S DGBTLTR("LETTER TYPE")=$P(Y,",",1)
"RTN","DGBTDLT",29,0)
 ;
"RTN","DGBTDLT",30,0)
 I DGBTLTR("LETTER TYPE")="M" D  Q
"RTN","DGBTDLT",31,0)
 .S DIR("A")="SELECT WHICH MILEAGE LETTER"
"RTN","DGBTDLT",32,0)
 .S DIR("L",1)="CHOOSE FROM: "
"RTN","DGBTDLT",33,0)
 .S DIR("L",2)="MILEAGE TEMPLATE PART 1"
"RTN","DGBTDLT",34,0)
 .S DIR("L",3)="MILEAGE TEMPLATE PART 2"
"RTN","DGBTDLT",35,0)
 .S DIR("?")="PART 1 IS THE TOP HALF OF THE LETTER BEFORE DENIAL REASON. AND PART 2 IS THE BOTTOM HALF OF THE LETTER AFTER THE DENIAL REASON"
"RTN","DGBTDLT",36,0)
 .S DIR(0)="S^1:MILEAGE TEMPLATE 1;2:MILEAGE TEMPLATE 2"
"RTN","DGBTDLT",37,0)
 .D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S QUIT=1 Q
"RTN","DGBTDLT",38,0)
 .S DGIEN=+Y
"RTN","DGBTDLT",39,0)
 ;
"RTN","DGBTDLT",40,0)
 I DGBTLTR("LETTER TYPE")="S" D
"RTN","DGBTDLT",41,0)
 .S DIR("A")="SELECT WHICH SPECIAL MODE LETTER"
"RTN","DGBTDLT",42,0)
 .S DIR("L",1)="CHOOSE FROM: "
"RTN","DGBTDLT",43,0)
 .S DIR("L",2)="SPECIAL MODE TEMPLATE PART 1"
"RTN","DGBTDLT",44,0)
 .S DIR("L",3)="SPECIAL MODE TEMPLATE PART 2"
"RTN","DGBTDLT",45,0)
 .S DIR("?")="PART 1 IS THE TOP HALF OF THE LETTER BEFORE DENIAL REASON. AND PART 2 IS THE BOTTOM HALF OF THE LETTER AFTER THE DENIAL REASON"
"RTN","DGBTDLT",46,0)
 .S DIR(0)="S^1:SPECIAL MODE TEMPLATE 1;2:SPECIAL MODE TEMPLATE 2"
"RTN","DGBTDLT",47,0)
 .D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S QUIT=1 Q
"RTN","DGBTDLT",48,0)
 .S DGIEN=$S(+Y=1:3,1:4)
"RTN","DGBTDLT",49,0)
 ;
"RTN","DGBTDLT",50,0)
 Q
"RTN","DGBTDLT",51,0)
 ;
"RTN","DGBTDLT",52,0)
SETUP(DGIEN) ;this will set up ^TMP global for editing
"RTN","DGBTDLT",53,0)
 S CNT=0,COUNTER=0
"RTN","DGBTDLT",54,0)
 F  S CNT=$O(^DGBT(392.6,DGIEN,1,CNT)) Q:'CNT  D
"RTN","DGBTDLT",55,0)
 .S COUNTER=COUNTER+1
"RTN","DGBTDLT",56,0)
 .S ^TMP("DGBTDLT",$J,COUNTER)=^DGBT(392.6,DGIEN,1,CNT,0)
"RTN","DGBTDLT",57,0)
 Q
"RTN","DGBTDLT",58,0)
 ;
"RTN","DGBTDLT",59,0)
EDIT ;this will invoke the screen editor
"RTN","DGBTDLT",60,0)
 ;
"RTN","DGBTDLT",61,0)
 K ^TMP($J,"DGBTDLT"),DWPK,DIC,DIWESUB,DIWETXT
"RTN","DGBTDLT",62,0)
 S DWPK=1
"RTN","DGBTDLT",63,0)
 S DGIEN2=$S(DGIEN=3!(DGIEN=4):3,1:1)
"RTN","DGBTDLT",64,0)
 S DIC="^DGBT(392.6,DGIEN,DGIEN2,"
"RTN","DGBTDLT",65,0)
 S DIWESUB="MILEAGE DENIAL LETTER"
"RTN","DGBTDLT",66,0)
 S DIWETXT="MILEAGE DENIAL LETTER TEMPLATE PART "_DGIEN
"RTN","DGBTDLT",67,0)
 D EN^DIWE
"RTN","DGBTDLT",68,0)
 Q
"RTN","DGBTDLT",69,0)
 ;
"RTN","DGBTDLT",70,0)
 ;************************************************************************************************************
"RTN","DGBTDLT",71,0)
 ;                              THIS WILL PRINT DENIAL LETTERS
"RTN","DGBTDLT",72,0)
 ;************************************************************************************************************
"RTN","DGBTDLT",73,0)
 ;
"RTN","DGBTDLT",74,0)
DGBTDR ;will ask for the denial reason
"RTN","DGBTDLT",75,0)
 ;
"RTN","DGBTDLT",76,0)
 N DRIEN,REASON,LETTERS1,LETTERS2,LINENBR,NBR,DGBTDNLTR,DGBTFDA,DGBTSCR,DGBTDR,DGBTISSUED,VADM,PATSEX,PATADD1,PATADD2,PATCITY,PATST,PATZIP,PATNAME
"RTN","DGBTDLT",77,0)
 W !
"RTN","DGBTDLT",78,0)
 K ^UTILITY($J,"W")
"RTN","DGBTDLT",79,0)
 S QUIT=0
"RTN","DGBTDLT",80,0)
 ;
"RTN","DGBTDLT",81,0)
 S SPCOMPLETE=1
"RTN","DGBTDLT",82,0)
 ;
"RTN","DGBTDLT",83,0)
 S DGBTDL("ISSUED")=$$GET1^DIQ(392,DGBTDTI,45,"I")
"RTN","DGBTDLT",84,0)
 S DGBTDL("ISSUED DATE")=$$GET1^DIQ(392,DGBTDTI,45.1)
"RTN","DGBTDLT",85,0)
 S DGBTDL("CLAIM DENIED")=$$GET1^DIQ(392,DGBTDTI,45.2)
"RTN","DGBTDLT",86,0)
 S DGBTDL("DT DENIED")=$$GET1^DIQ(392,DGBTDTI,45.3)
"RTN","DGBTDLT",87,0)
 S DGBTDL("DENIED REASON")=$$GET1^DIQ(392,DGBTDTI,45.4)
"RTN","DGBTDLT",88,0)
 ;
"RTN","DGBTDLT",89,0)
 K Y
"RTN","DGBTDLT",90,0)
 F  D  Q:+Y>0!($G(DGBTTOUT)=-1)
"RTN","DGBTDLT",91,0)
 .K X,DGBTTOUT S X=""
"RTN","DGBTDLT",92,0)
 .S DIC("B")=$$GET1^DIQ(392,DGBTDT,45.4),DIC("A")="Select Denial Reason: "
"RTN","DGBTDLT",93,0)
 .S DIC="^DGBT(392.8,",DIC(0)="AEQMZ"
"RTN","DGBTDLT",94,0)
 .I DGBTCMTY="M" S DIC("S")="I $P(^(0),1)'[""MEDICAL REVIEW"""
"RTN","DGBTDLT",95,0)
 .D ^DIC K DIC I $D(DTOUT)!($D(DUOUT)) S DGBTTOUT=-1,SPCOMPLETE=0 K DTOUT,DUOUT Q
"RTN","DGBTDLT",96,0)
 .I Y<0 W !!,"Denial Reason Required. '^' to exit.",! Q
"RTN","DGBTDLT",97,0)
 Q:Y<0!($G(DGBTTOUT)=-1)
"RTN","DGBTDLT",98,0)
 S DRIEN=+Y
"RTN","DGBTDLT",99,0)
 S DGBTDL("DENIED REASON")=$$GET1^DIQ(392.8,DRIEN,.01)
"RTN","DGBTDLT",100,0)
 S DGBTDL("CLAIM DENIED")="YES"
"RTN","DGBTDLT",101,0)
 S DGBTDL("DT DENIED")=$S(DGBTDL("DT DENIED")="":$$FMTE^XLFDT(DT),1:DGBTDL("DT DENIED"))
"RTN","DGBTDLT",102,0)
 ;
"RTN","DGBTDLT",103,0)
 ;
"RTN","DGBTDLT",104,0)
 S DIR("B")=$$GET1^DIQ(392,DGBTDT,45)
"RTN","DGBTDLT",105,0)
 S DIR(0)="Y^A",DIR("A")="ISSUE DENIAL OF BENEFITS LETTER"
"RTN","DGBTDLT",106,0)
 S DIR("?")="ENTER 'YES' OR 'NO'"
"RTN","DGBTDLT",107,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S DGBTTOUT=-1,SPCOMPLETE=0 K DTOUT,DUOUT Q
"RTN","DGBTDLT",108,0)
 ; 
"RTN","DGBTDLT",109,0)
 I +Y=1 S DGBTDL("ISSUED DATE")=$S(DGBTDL("ISSUED DATE")="":$$FMTE^XLFDT(DT),1:DGBTDL("ISSUED DATE")),DGBTDL("ISSUED")="YES"
"RTN","DGBTDLT",110,0)
 I +Y'=1 S DGBTDL("ISSUED")="NO" D CLRLTR(1) S QUIT=1 S:$G(DGBTISSUED)=-1 DGBTTOUT=$G(DGBTISSUED),SPCOMPLETE=0 Q
"RTN","DGBTDLT",111,0)
 ;
"RTN","DGBTDLT",112,0)
 S DGBTDNLTR=DGBTDL("ISSUED")
"RTN","DGBTDLT",113,0)
 ;
"RTN","DGBTDLT",114,0)
 W !!
"RTN","DGBTDLT",115,0)
 ;
"RTN","DGBTDLT",116,0)
 W @IOF
"RTN","DGBTDLT",117,0)
 S DGBTFDA(392,DGBTDTI_",",45)=DGBTDNLTR
"RTN","DGBTDLT",118,0)
 S DGBTFDA(392,DGBTDTI_",",45.1)=$S(DGBTDL("ISSUED DATE")'="":DGBTDL("ISSUED DATE"),1:$$FMTE^XLFDT(DT))
"RTN","DGBTDLT",119,0)
 S DGBTFDA(392,DGBTDTI_",",45.2)=1
"RTN","DGBTDLT",120,0)
 S DGBTFDA(392,DGBTDTI_",",45.3)=$S(DGBTDL("DT DENIED")'="":DGBTDL("DT DENIED"),1:$$FMTE^XLFDT(DT))
"RTN","DGBTDLT",121,0)
 S DGBTFDA(392,DGBTDTI_",",45.4)=$S(DGBTDL("DENIED REASON")'="":DGBTDL("DENIED REASON"),1:$$GET1^DIQ(392.8,DRIEN,.01))   ;Y(0)
"RTN","DGBTDLT",122,0)
 K ERRMSG D FILE^DIE("EKTS","DGBTFDA","ERRMSG") K DGBTFDA
"RTN","DGBTDLT",123,0)
 I $$GET1^DIQ(392.8,DRIEN,1,,"REASON")
"RTN","DGBTDLT",124,0)
 D DEVICE("DENIAL LETTER","LTR^DGBTDLT") I $D(DTOUT)!($D(DUOUT))!($G(SPCOMPLETE)=0) S QUIT=1,DGBTTOUT=-1 Q
"RTN","DGBTDLT",125,0)
 I $G(DGBTQ) Q
"RTN","DGBTDLT",126,0)
 D LTR
"RTN","DGBTDLT",127,0)
 Q
"RTN","DGBTDLT",128,0)
 ;
"RTN","DGBTDLT",129,0)
LTR ;
"RTN","DGBTDLT",130,0)
 ;
"RTN","DGBTDLT",131,0)
 N NAME,DGBTCDT,DIWL,DIWR
"RTN","DGBTDLT",132,0)
 K ^UTILITY($J,"W")
"RTN","DGBTDLT",133,0)
 D DIVISN(.DGBTINST)                            ;this will set up the DGBTINST array containing the current VA location address
"RTN","DGBTDLT",134,0)
 D HEADER(.DGBTINST)                            ;this will print the current VA location information
"RTN","DGBTDLT",135,0)
 S QUIT=1
"RTN","DGBTDLT",136,0)
 S DIWL=5   ;left margin
"RTN","DGBTDLT",137,0)
 S DIWR=75   ;right margin
"RTN","DGBTDLT",138,0)
 S DGBTCDT(1)=$P(DGBTDTE,"@",1)               ;date entered into file
"RTN","DGBTDLT",139,0)
 S NAME=$$GET1^DIQ(200,DUZ,.01),DGBTCDT(2)=$P(NAME,",",2)_" "_$P(NAME,",",1)           ;user name
"RTN","DGBTDLT",140,0)
 S DGBTCDT(3)=$$GET1^DIQ(200,DUZ,8)             ;user title
"RTN","DGBTDLT",141,0)
 ;
"RTN","DGBTDLT",142,0)
 I DGBTCMTY="M" D               ;for mileage claims
"RTN","DGBTDLT",143,0)
 .I $$GET1^DIQ(392.6,1,1,,"LETTERS1")
"RTN","DGBTDLT",144,0)
 .S LINENBR=0
"RTN","DGBTDLT",145,0)
 .F  S LINENBR=$O(LETTERS1(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT",146,0)
 ..S X=LETTERS1(LINENBR)
"RTN","DGBTDLT",147,0)
 .S NBR=0
"RTN","DGBTDLT",148,0)
 .F  S NBR=$O(REASON(NBR)) Q:'NBR  D  D ^DIWP
"RTN","DGBTDLT",149,0)
 ..S X=REASON(NBR)
"RTN","DGBTDLT",150,0)
 .I $$GET1^DIQ(392.6,2,1,,"LETTERS2")
"RTN","DGBTDLT",151,0)
 .F  S LINENBR=$O(LETTERS2(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT",152,0)
 ..S X=LETTERS2(LINENBR) Q:X=""
"RTN","DGBTDLT",153,0)
 .D ^DIWW
"RTN","DGBTDLT",154,0)
 ;
"RTN","DGBTDLT",155,0)
 K LETTERS1,LETTERS2
"RTN","DGBTDLT",156,0)
 I DGBTCMTY="S" D                        ;for Special Mode Claims
"RTN","DGBTDLT",157,0)
 .I $$GET1^DIQ(392.6,3,3,,"LETTERS1")
"RTN","DGBTDLT",158,0)
 .S LINENBR=0
"RTN","DGBTDLT",159,0)
 .F  S LINENBR=$O(LETTERS1(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT",160,0)
 ..S X=LETTERS1(LINENBR)
"RTN","DGBTDLT",161,0)
 .S NBR=0
"RTN","DGBTDLT",162,0)
 .F  S NBR=$O(REASON(NBR)) Q:'NBR  D  D ^DIWP
"RTN","DGBTDLT",163,0)
 ..S X=REASON(NBR)
"RTN","DGBTDLT",164,0)
 .I $$GET1^DIQ(392.6,4,3,,"LETTERS2")
"RTN","DGBTDLT",165,0)
 .F  S LINENBR=$O(LETTERS2(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT",166,0)
 ..S X=LETTERS2(LINENBR) Q:X=""
"RTN","DGBTDLT",167,0)
 .D ^DIWW
"RTN","DGBTDLT",168,0)
 .S SPCOMPLETE=1
"RTN","DGBTDLT",169,0)
 D:'IOST'["C-" ^%ZISC
"RTN","DGBTDLT",170,0)
 Q
"RTN","DGBTDLT",171,0)
 ;
"RTN","DGBTDLT",172,0)
HEADER(DGBTINST) ;this will print all of the standard information at the top of the letter. IT WILL NOT PRINT LOGO'S ETC
"RTN","DGBTDLT",173,0)
 ;
"RTN","DGBTDLT",174,0)
 I $G(DGBTINST("ORG NAME"))="" D  Q
"RTN","DGBTDLT",175,0)
 .W !!,"INSTITUTION INFORMATION IS UNAVAILABLE. PLEASE UPDATE USING THE INSTITUTION FILE ENTER/EDIT."
"RTN","DGBTDLT",176,0)
 N ORG,ADD1,ADD2,CITY,STATE,ZIP,INSTNAME,LOC,LOC2,DGBTDTFILED
"RTN","DGBTDLT",177,0)
 ;
"RTN","DGBTDLT",178,0)
 S ORG=DGBTINST("ORG NAME")
"RTN","DGBTDLT",179,0)
 S INSTNAME=DGBTINST("INST NAME")
"RTN","DGBTDLT",180,0)
 S ADD1=DGBTINST("INST ADDRESS 1")
"RTN","DGBTDLT",181,0)
 S ADD2=DGBTINST("INST ADDRESS 2")
"RTN","DGBTDLT",182,0)
 S CITY=DGBTINST("INST CITY")
"RTN","DGBTDLT",183,0)
 S STATE=DGBTINST("INST STATE")
"RTN","DGBTDLT",184,0)
 S ZIP=DGBTINST("INST ZIP CODE")
"RTN","DGBTDLT",185,0)
 ;
"RTN","DGBTDLT",186,0)
 D DEM^VADPT
"RTN","DGBTDLT",187,0)
 S PATSEX=$P(VADM(5),"^",1),PATSEX=$S(PATSEX="M":"Mr",1:"Ms")_". "
"RTN","DGBTDLT",188,0)
 S PATADD1=VAPA(1),PATADD2=VAPA(2)
"RTN","DGBTDLT",189,0)
 S PATCITY=VAPA(4)_", ",PATST=$P(VAPA(5),"^",2)_" ",PATZIP=VAPA(6)
"RTN","DGBTDLT",190,0)
 S PATNAME=VADM(1),PATNAME=$P(PATNAME,",",2)_" "_$P(PATNAME,",",1)
"RTN","DGBTDLT",191,0)
 ;
"RTN","DGBTDLT",192,0)
 S LOC2=5
"RTN","DGBTDLT",193,0)
 S LOC=80-$L(ORG) W !,?LOC/2,ORG
"RTN","DGBTDLT",194,0)
 S LOC=80-$L(INSTNAME) W !,?LOC/2,INSTNAME
"RTN","DGBTDLT",195,0)
 S LOC=80-$L(ADD1) W !,?LOC/2,ADD1
"RTN","DGBTDLT",196,0)
 I $G(ADD2)'="" S LOC=80-$L(ADD2) W !,?LOC/2,ADD2
"RTN","DGBTDLT",197,0)
 S CITYSTZIP=CITY_", "_STATE_" "_ZIP
"RTN","DGBTDLT",198,0)
 S LOC=80-$L(CITYSTZIP) W !,?LOC/2,CITYSTZIP,!
"RTN","DGBTDLT",199,0)
 ;S LOC=80-$L(DGBTDTE) W !?LOC,$P(DGBTDTE,"@",1)
"RTN","DGBTDLT",200,0)
 S DGBTDTFILED=$$GET1^DIQ(392,DGBTDTI,13,"E")
"RTN","DGBTDLT",201,0)
 S DGBTDTFILED=$S(DGBTDTFILED'="":DGBTDTFILED,1:DT)
"RTN","DGBTDLT",202,0)
 S DGBTDTFILED=$$FMTE^XLFDT(DGBTDTFILED)
"RTN","DGBTDLT",203,0)
 S LOC=80-$L(DGBTDTFILED) W !,?LOC,DGBTDTFILED
"RTN","DGBTDLT",204,0)
 W !,?LOC,DGBTINST("FAC NUMBER")
"RTN","DGBTDLT",205,0)
 W ?LOC,"/"_$S(DGBTINST("MAIL CODE")'="":DGBTINST("MAIL CODE"),1:"136B"),!
"RTN","DGBTDLT",206,0)
 W ?LOC,$E(VADM(1),1)_$E($P(VADM(2),"^",1),6,99)
"RTN","DGBTDLT",207,0)
 W !,?LOC2,$G(PATSEX),$G(PATNAME)
"RTN","DGBTDLT",208,0)
 W !,?LOC2,$G(PATADD1)
"RTN","DGBTDLT",209,0)
 W:$G(PATADD2)'="" !,?LOC2,PATADD2
"RTN","DGBTDLT",210,0)
 W !,?LOC2,PATCITY,PATST,PATZIP,!!
"RTN","DGBTDLT",211,0)
 ;
"RTN","DGBTDLT",212,0)
 Q
"RTN","DGBTDLT",213,0)
 ;
"RTN","DGBTDLT",214,0)
PATIENT ; patient lookup, quit if patient doesn't exist
"RTN","DGBTDLT",215,0)
 N VAEL
"RTN","DGBTDLT",216,0)
 S DGBTOLD=0   ;PAVEL DGBT*1*20
"RTN","DGBTDLT",217,0)
 I $D(DGANS) S DGANS="Q" Q   ;bld DGTB*1*20
"RTN","DGBTDLT",218,0)
 S DGBTTOUT="",DIC="^DPT(",DIC(0)="AEQMZ",DIC("A")="Select PATIENT: "
"RTN","DGBTDLT",219,0)
 W !! D ^DIC K DIC I +Y'>0 Q
"RTN","DGBTDLT",220,0)
 ; get patient information#, call return patient return variables routine and set wether new claim or not
"RTN","DGBTDLT",221,0)
 S DFN=+Y D 6^VADPT,PID^VADPT
"RTN","DGBTDLT",222,0)
 S DGBTNEW=$S($D(^DGBT(392,"C",DFN)):0,1:1)
"RTN","DGBTDLT",223,0)
 S SPCOMPLETE=0
"RTN","DGBTDLT",224,0)
 Q
"RTN","DGBTDLT",225,0)
 ;
"RTN","DGBTDLT",226,0)
DIVISN(DGBTINST) ; if MED CTR DIV file set up (first record) and record does not exist, write warning, kill variables, and exit
"RTN","DGBTDLT",227,0)
 I ($G(DGBTDIVI)'="")&($G(DGBTDIV)'="") D INSTIT(.DGBTINST) Q  ; RFE DGBT*1.0*20
"RTN","DGBTDLT",228,0)
 S DGBTDIVI=$O(^DG(40.8,0)),DGBTDIV=$P(^DG(40.8,DGBTDIVI,0),U) D INSTIT(.DGBTINST)
"RTN","DGBTDLT",229,0)
 Q
"RTN","DGBTDLT",230,0)
 ; 
"RTN","DGBTDLT",231,0)
INSTIT(DGBTINST) ;  check for pointer to institution file and for address information on institution
"RTN","DGBTDLT",232,0)
 N MAILCODE,INSTADD,INSTNODE
"RTN","DGBTDLT",233,0)
 S DGBTDIVN=$P(^DG(40.8,DGBTDIVI,0),"^",7)
"RTN","DGBTDLT",234,0)
 I 'DGBTDIVN W !!,"INSTITUTION HAS NOT BEEN DEFINED FOR ",$P(^(0),"^"),!,"USE THE ADT PARAMETER OPTION TO UPDATE",! Q
"RTN","DGBTDLT",235,0)
 I $D(^DIC(4,DGBTDIVN,0)),$S($D(^(1))#10=0:1,$P(^(1),"^",3)']"":1,1:0) W !!,"INSTITUTION ADDRESS NOT ENTERED.  PLEASE UPDATE USING THE INSTITUTION FILE ENTER/EDIT",! Q
"RTN","DGBTDLT",236,0)
 ;
"RTN","DGBTDLT",237,0)
 S INSTNODE=^DIC(4,DGBTDIVN,0)
"RTN","DGBTDLT",238,0)
 S INSTADD=^DIC(4,DGBTDIVN,1)
"RTN","DGBTDLT",239,0)
 ; 
"RTN","DGBTDLT",240,0)
 S DGBTINST("ORG NAME")="DEPARTMENT OF VETERANS AFFAIRS"
"RTN","DGBTDLT",241,0)
 S DGBTINST("INST NAME")=$$GET1^DIQ(4,DGBTDIVN,.01)
"RTN","DGBTDLT",242,0)
 S DGBTINST("INST ADDRESS 1")=$$GET1^DIQ(4,DGBTDIVN,1.01)
"RTN","DGBTDLT",243,0)
 S DGBTINST("INST ADDRESS 2")=$$GET1^DIQ(4,DGBTDIVN,1.02)
"RTN","DGBTDLT",244,0)
 S DGBTINST("INST CITY")=$$GET1^DIQ(4,DGBTDIVN,1.03)
"RTN","DGBTDLT",245,0)
 S DGBTINST("INST STATE")=$$GET1^DIQ(4,DGBTDIVN,.02)
"RTN","DGBTDLT",246,0)
 S DGBTINST("INST ZIP CODE")=$$GET1^DIQ(4,DGBTDIVN,1.04)
"RTN","DGBTDLT",247,0)
 S DGBTINST("FAC NUMBER")=$$GET1^DIQ(40.8,DGBTDIVI,1)
"RTN","DGBTDLT",248,0)
 S MAILCODE=$O(^DIC(49,"B","BENEFICIARY TRAVEL",""))
"RTN","DGBTDLT",249,0)
 S DGBTINST("MAIL CODE")=$$GET1^DIQ(49,MAILCODE,1.5)
"RTN","DGBTDLT",250,0)
 Q
"RTN","DGBTDLT",251,0)
 ;
"RTN","DGBTDLT",252,0)
DEVICE(RPTNAM,ROUTINE) ;common device call for DGBT reports
"RTN","DGBTDLT",253,0)
 ;
"RTN","DGBTDLT",254,0)
 N %ZIS,ZTSK,ZTRTN,ZTIO,ZTDESC,ZTSAVE,POP,ZTQUEUED
"RTN","DGBTDLT",255,0)
 ; RPTNAM = NAME OF DGBT REPORT BEING RUN
"RTN","DGBTDLT",256,0)
 ; ROUTINE = "TAG^ROUTINE"
"RTN","DGBTDLT",257,0)
 ;
"RTN","DGBTDLT",258,0)
 S DGBTQ1=0,DGBTQ=0
"RTN","DGBTDLT",259,0)
 S %ZIS="PQM"
"RTN","DGBTDLT",260,0)
 D ^%ZIS
"RTN","DGBTDLT",261,0)
 I POP S DGBTQ=1,SPCOMPLETE=0 Q
"RTN","DGBTDLT",262,0)
 I IOST["C-" Q  ;
"RTN","DGBTDLT",263,0)
 ;.N X I IOM=255,$D(^%ZOSF("RM")) X ^%ZOSF("RM")
"RTN","DGBTDLT",264,0)
 ;Check for exit
"RTN","DGBTDLT",265,0)
 ;S DGBTQ=1
"RTN","DGBTDLT",266,0)
 I $G(IO("Q"))  D  S DGBTQ=1
"RTN","DGBTDLT",267,0)
 .S ZTRTN=ROUTINE
"RTN","DGBTDLT",268,0)
 .S ZTDESC="BT REPORT: "_RPTNAM
"RTN","DGBTDLT",269,0)
 .S ZTSAVE("*")=""
"RTN","DGBTDLT",270,0)
 .D ^%ZTLOAD
"RTN","DGBTDLT",271,0)
 .W !,$S($D(ZTSK):"REQUEST QUEUED TASK="_ZTSK,1:"REQUEST CANCELLED")
"RTN","DGBTDLT",272,0)
 .D HOME^%ZIS K IO("Q")
"RTN","DGBTDLT",273,0)
 U IO
"RTN","DGBTDLT",274,0)
 Q
"RTN","DGBTDLT",275,0)
 ;
"RTN","DGBTDLT",276,0)
DEVICE1(DGBTRPT) ;
"RTN","DGBTDLT",277,0)
 N %ZIS,ZTSK,ZTRTN,ZTIO,ZTDESC,ZTSAVE,POP
"RTN","DGBTDLT",278,0)
 S %ZIS="QPM"
"RTN","DGBTDLT",279,0)
 D ^%ZIS
"RTN","DGBTDLT",280,0)
 I POP S DGBTQ=1,SPCOMPLETE=0
"RTN","DGBTDLT",281,0)
 I IOST'["C-" S DGBTQ=1 Q
"RTN","DGBTDLT",282,0)
 ;
"RTN","DGBTDLT",283,0)
 ;Check for exit
"RTN","DGBTDLT",284,0)
 I $G(DGBTQ) Q
"RTN","DGBTDLT",285,0)
 ;
"RTN","DGBTDLT",286,0)
 I $D(IO("Q")) D  S DGBTQ=1
"RTN","DGBTDLT",287,0)
 . S ZTRTN="LTR^DGBTDLT"
"RTN","DGBTDLT",288,0)
 . S ZTDESC="DGBT: "_DGBTRPT
"RTN","DGBTDLT",289,0)
 .; S ZTIO=ION
"RTN","DGBTDLT",290,0)
 . S ZTSAVE("*")=""
"RTN","DGBTDLT",291,0)
 . D ^%ZTLOAD
"RTN","DGBTDLT",292,0)
 . W !,$S($D(ZTSK):"REQUEST QUEUED TASK="_ZTSK,1:"REQUEST CANCELLED")
"RTN","DGBTDLT",293,0)
 . D HOME^%ZIS K IO("Q")
"RTN","DGBTDLT",294,0)
 ;U IO
"RTN","DGBTDLT",295,0)
 Q
"RTN","DGBTDLT",296,0)
 ;
"RTN","DGBTDLT",297,0)
CLRLTR(DENIED) ;
"RTN","DGBTDLT",298,0)
 ;
"RTN","DGBTDLT",299,0)
 N Y,DGBTFDA,%
"RTN","DGBTDLT",300,0)
 K ERRMSG
"RTN","DGBTDLT",301,0)
 I $G(DGBTDL("ISSUED"))="" S DGBTDL("ISSUED")=$$GET1^DIQ(392,DGBTDTI,45,"I")
"RTN","DGBTDLT",302,0)
 I $G(DGBTDL("CLAIM DENIED"))="" S DGBTDL("CLAIM DENIED")=DENIED
"RTN","DGBTDLT",303,0)
 I $G(DGBTDL("DT DENIED"))="" S DGBTDL("DT DENIED")=$$GET1^DIQ(392,DGBTDTI,45.3) S:$G(DGBTDL("DT DENIED"))="" DGBTDL("DT DENIED")=$$FMTE^XLFDT(DT)
"RTN","DGBTDLT",304,0)
 I $G(DGBTDL("DENIED REASON"))="" S DGBTDL("DENIED REASON")=$$GET1^DIQ(392,DGBTDTI,45.4)
"RTN","DGBTDLT",305,0)
 ;
"RTN","DGBTDLT",306,0)
 S DGBTFDA(392,DGBTDTI_",",45)=""   ;$G(DGBTDL("ISSUED"))
"RTN","DGBTDLT",307,0)
 S DGBTFDA(392,DGBTDTI_",",45.1)=""
"RTN","DGBTDLT",308,0)
 S DGBTFDA(392,DGBTDTI_",",45.2)=""  ;$G(DGBTDL("CLAIM DENIED"))
"RTN","DGBTDLT",309,0)
 S Y=$$NOW^XLFDT() D DD^%DT
"RTN","DGBTDLT",310,0)
 S DGBTFDA(392,DGBTDTI_",",45.3)=""   ;$G(DGBTDL("DT DENIED"))
"RTN","DGBTDLT",311,0)
 S DGBTFDA(392,DGBTDTI_",",45.4)=""  ;$G(DGBTDL("DENIED REASON"))
"RTN","DGBTDLT",312,0)
 D FILE^DIE("EKTS","DGBTFDA","ERRMSG") K DGBTFDA
"RTN","DGBTDLT",313,0)
 Q
"RTN","DGBTDLT1")
0^22^B74264382
"RTN","DGBTDLT1",1,0)
DGBTDLT1 ;BLD-REPRINT BENEFICIARY TRAVEL DENIAL LETTER; 03/04/2012@1400; 03/04/2012
"RTN","DGBTDLT1",2,0)
 ;;1.0;Beneficiary Travel;**20**;March 4, 2012;Build 185
"RTN","DGBTDLT1",3,0)
 ;
"RTN","DGBTDLT1",4,0)
 Q
"RTN","DGBTDLT1",5,0)
 ;************************************************************************************************************
"RTN","DGBTDLT1",6,0)
 ;                              THIS WILL PRINT DENIAL LETTERS
"RTN","DGBTDLT1",7,0)
 ;************************************************************************************************************
"RTN","DGBTDLT1",8,0)
 ;
"RTN","DGBTDLT1",9,0)
REPRINT ;
"RTN","DGBTDLT1",10,0)
 ;
"RTN","DGBTDLT1",11,0)
 D QUIT
"RTN","DGBTDLT1",12,0)
 W !
"RTN","DGBTDLT1",13,0)
 K ^UTILITY($J,"W"),^TMP("DGBT",$J)
"RTN","DGBTDLT1",14,0)
 S QUIT=0
"RTN","DGBTDLT1",15,0)
 ;
"RTN","DGBTDLT1",16,0)
 ;DIVISN ; if MED CTR DIV file set up (first record) and record does not exist, write warning, kill variables, and exit
"RTN","DGBTDLT1",17,0)
 S X=$G(^DG(40.8,0)) I X="" W !,"WARNING...MEDICAL CENTER DIVISION FILE IS NOT SET UP",!,"USE THE ADT PARAMETER OPTION FILE TO SET UP DIVISION" Q
"RTN","DGBTDLT1",18,0)
 ;  check if multi-divisional center (GL node exists and 2nd piece=1). Do lookup, if it exists-set local variables
"RTN","DGBTDLT1",19,0)
 S DGBTMD=0 I $D(^DG(43,1,"GL")),$P(^("GL"),U,2) D  Q:Y'>0  ;D PATIENT
"RTN","DGBTDLT1",20,0)
 . S DIC="^DG(40.8,",DIC(0)="AEQMNZ",DIC("A")="Select DIVISION: " W !!
"RTN","DGBTDLT1",21,0)
 . D ^DIC K DIC Q:Y'>0
"RTN","DGBTDLT1",22,0)
 . S DGBTDIVI=+Y,DGBTDIV=$P(Y,U,2)
"RTN","DGBTDLT1",23,0)
 . D INSTIT S DGBTMD=1
"RTN","DGBTDLT1",24,0)
 ;  if not a multi-divisional center, default to institution name
"RTN","DGBTDLT1",25,0)
 I 'DGBTMD S DGBTDIVI=$O(^DG(40.8,0)),DGBTDIV=$P(^DG(40.8,DGBTDIVI,0),U) D INSTIT
"RTN","DGBTDLT1",26,0)
 ;
"RTN","DGBTDLT1",27,0)
 D PATIENT Q:$G(DFN)=""  ;I '$D(^DGBT(392,"ADENIED",DFN)) W !!,"THERE ARE NO DENIAL LETTERS TO PRINT FOR: ",VADM(1) K DFN D QUIT Q  ;D REPRINT,QUIT Q
"RTN","DGBTDLT1",28,0)
 D LIST2 I $G(CHZFLG)="" D QUIT Q
"RTN","DGBTDLT1",29,0)
 S DGBTDLTR=$$GET1^DIQ(392,DGBTDTI,45,"I")
"RTN","DGBTDLT1",30,0)
 I 'DGBTDLTR D QUIT Q
"RTN","DGBTDLT1",31,0)
 S DGBTCMTY=$$GET1^DIQ(392,DGBTDTI,56,"I")
"RTN","DGBTDLT1",32,0)
 D DEVICE^DGBTDLT("DENIAL LETTER","LTR^DGBTDLT1") I $D(DTOUT)!($D(DUOUT)) S QUIT=1 D QUIT Q
"RTN","DGBTDLT1",33,0)
 I $G(DGBTQ) D QUIT Q
"RTN","DGBTDLT1",34,0)
 D LTR
"RTN","DGBTDLT1",35,0)
 D QUIT
"RTN","DGBTDLT1",36,0)
 Q
"RTN","DGBTDLT1",37,0)
 ;
"RTN","DGBTDLT1",38,0)
LTR ;
"RTN","DGBTDLT1",39,0)
 ;
"RTN","DGBTDLT1",40,0)
 N NAME,DGBTCDT,DGBTDR,DIWL,DIWR
"RTN","DGBTDLT1",41,0)
 K ^UTILITY($J,"W")
"RTN","DGBTDLT1",42,0)
 S DGBTDR=$$GET1^DIQ(392,DGBTDTI,45.4,"I")
"RTN","DGBTDLT1",43,0)
 I $$GET1^DIQ(392.8,DGBTDR,1,,"REASON")
"RTN","DGBTDLT1",44,0)
 D DIVISN(.DGBTINST)                            ;this will set up the DGBTINST array containing the current VA location address
"RTN","DGBTDLT1",45,0)
 ;D DEVICE("DENIAL LETTER") I $D(DTOUT)!($D(DUOUT)) S QUIT=1 Q
"RTN","DGBTDLT1",46,0)
 D HEADER(.DGBTINST)                            ;this will print the current VA location information
"RTN","DGBTDLT1",47,0)
 S QUIT=1
"RTN","DGBTDLT1",48,0)
 S DIWL=5   ;left margin
"RTN","DGBTDLT1",49,0)
 S DIWR=75   ;right margin
"RTN","DGBTDLT1",50,0)
 S DGBTCDT(1)=$P(DGBTDTE,"@",1)                                                        ;invoice date
"RTN","DGBTDLT1",51,0)
 S NAME=$$GET1^DIQ(200,DUZ,.01),DGBTCDT(2)=$P(NAME,",",2)_" "_$P(NAME,",",1)           ;user name
"RTN","DGBTDLT1",52,0)
 S DGBTCDT(3)=$$GET1^DIQ(200,DUZ,8)             ;user title
"RTN","DGBTDLT1",53,0)
 I DGBTCMTY="M" D               ;for mileage claims
"RTN","DGBTDLT1",54,0)
 .I $$GET1^DIQ(392.6,1,1,,"LETTERS1")
"RTN","DGBTDLT1",55,0)
 .S LINENBR=0
"RTN","DGBTDLT1",56,0)
 .F  S LINENBR=$O(LETTERS1(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT1",57,0)
 ..S X=LETTERS1(LINENBR)
"RTN","DGBTDLT1",58,0)
 .S NBR=0
"RTN","DGBTDLT1",59,0)
 .F  S NBR=$O(REASON(NBR)) Q:'NBR  D  D ^DIWP
"RTN","DGBTDLT1",60,0)
 ..S X=REASON(NBR)
"RTN","DGBTDLT1",61,0)
 .I $$GET1^DIQ(392.6,2,1,,"LETTERS2")
"RTN","DGBTDLT1",62,0)
 .F  S LINENBR=$O(LETTERS2(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT1",63,0)
 ..S X=LETTERS2(LINENBR) Q:X=""
"RTN","DGBTDLT1",64,0)
 .D ^DIWW
"RTN","DGBTDLT1",65,0)
 ;
"RTN","DGBTDLT1",66,0)
 K LETTERS1,KETTERS2
"RTN","DGBTDLT1",67,0)
 I DGBTCMTY="S" D                        ;for Special Mode Claims
"RTN","DGBTDLT1",68,0)
 .I $$GET1^DIQ(392.6,3,3,,"LETTERS1")
"RTN","DGBTDLT1",69,0)
 .S LINENBR=0
"RTN","DGBTDLT1",70,0)
 .F  S LINENBR=$O(LETTERS1(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT1",71,0)
 ..S X=LETTERS1(LINENBR)
"RTN","DGBTDLT1",72,0)
 .S NBR=0
"RTN","DGBTDLT1",73,0)
 .F  S NBR=$O(REASON(NBR)) Q:'NBR  D  D ^DIWP
"RTN","DGBTDLT1",74,0)
 ..S X=REASON(NBR)
"RTN","DGBTDLT1",75,0)
 .I $$GET1^DIQ(392.6,4,3,,"LETTERS2")
"RTN","DGBTDLT1",76,0)
 .F  S LINENBR=$O(LETTERS2(LINENBR)) Q:'LINENBR  D  D ^DIWP
"RTN","DGBTDLT1",77,0)
 ..S X=LETTERS2(LINENBR) Q:X=""
"RTN","DGBTDLT1",78,0)
 .D ^DIWW
"RTN","DGBTDLT1",79,0)
 D:'IOST'["C-" ^%ZISC
"RTN","DGBTDLT1",80,0)
 Q
"RTN","DGBTDLT1",81,0)
 ;
"RTN","DGBTDLT1",82,0)
PATIENT ; patient lookup, quit if patient doesn't exist
"RTN","DGBTDLT1",83,0)
 N VAEL
"RTN","DGBTDLT1",84,0)
 S DGBTTOUT="",DIC="^DPT(",DIC(0)="AEQMZ",DIC("A")="Select PATIENT: "
"RTN","DGBTDLT1",85,0)
 W !! D ^DIC K DIC I +Y'>0 K DFN Q
"RTN","DGBTDLT1",86,0)
 ; get patient information#, call return patient return variables routine and set wether new claim or not
"RTN","DGBTDLT1",87,0)
 S DFN=+Y D 6^VADPT,PID^VADPT
"RTN","DGBTDLT1",88,0)
 S DGBTNEW=$S($D(^DGBT(392,"C",DFN)):0,1:1)
"RTN","DGBTDLT1",89,0)
 Q
"RTN","DGBTDLT1",90,0)
 ;
"RTN","DGBTDLT1",91,0)
LIST2 ;  find all previous claims, get total count in DGBTC and put those claims in utility file
"RTN","DGBTDLT1",92,0)
 N X1,YY,DGBTCDT,DGBTC,CNT
"RTN","DGBTDLT1",93,0)
 S (CNTR,DGBTCH,DGBTCH1,DGBTCDT)=0
"RTN","DGBTDLT1",94,0)
 S DGBTC=""
"RTN","DGBTDLT1",95,0)
 I $D(^DGBT(392,"ADENIED",DFN))'>1 W !!?10,"There are no entries on file for this patient",! S Y1=-1 D QUIT Q
"RTN","DGBTDLT1",96,0)
 ;
"RTN","DGBTDLT1",97,0)
 F I=1:1 S DGBTC=$O(^DGBT(392,"ADENIED",DFN,DGBTC),-1) Q:'DGBTC  D
"RTN","DGBTDLT1",98,0)
 .S Y=DGBTC D DD^%DT
"RTN","DGBTDLT1",99,0)
 .S CNTR=$G(CNTR)+1
"RTN","DGBTDLT1",100,0)
 .S DGBTARY(CNTR,DGBTC)=Y ;K DGBTARY(DGBTC)
"RTN","DGBTDLT1",101,0)
 ;
"RTN","DGBTDLT1",102,0)
LIST3 ;  list claims (in external format) from temporary global, 5 at a time. Loop thru list until selection made.
"RTN","DGBTDLT1",103,0)
 S (CNTR,DGBTCH)=""
"RTN","DGBTDLT1",104,0)
 S DGBTC=""
"RTN","DGBTDLT1",105,0)
 W !
"RTN","DGBTDLT1",106,0)
 F  S CNTR=$O(DGBTARY(CNTR)) Q:'CNTR  D  Q:$G(CHZFLG)!$G(DTOUT)!$G(DUOUT)
"RTN","DGBTDLT1",107,0)
 .F  S DGBTC=$O(DGBTARY(CNTR,DGBTC)) Q:DGBTC=""  D  Q:$G(CHZFLG)
"RTN","DGBTDLT1",108,0)
 ..W !?5,CNTR,".",?10,DGBTARY(CNTR,DGBTC) I CNTR#5=0!($O(DGBTARY(CNTR))="") D CHOZ I $D(DUOUT)!$D(DTOUT)!(Y>0) Q
"RTN","DGBTDLT1",109,0)
 I '$D(DTOUT)&Y="" D LIST3 Q
"RTN","DGBTDLT1",110,0)
 S DGBTDTI=$O(DGBTARY(CNTR,"")),DGBTDTE=DGBTARY(CNTR,DGBTDTI)
"RTN","DGBTDLT1",111,0)
 K DIR
"RTN","DGBTDLT1",112,0)
 Q
"RTN","DGBTDLT1",113,0)
 ;
"RTN","DGBTDLT1",114,0)
CHOZ ;  select from the displayed past claims dates for claim to be edited.
"RTN","DGBTDLT1",115,0)
 N DGBTCH1,CHOICE
"RTN","DGBTDLT1",116,0)
 S CHOICE=1
"RTN","DGBTDLT1",117,0)
 W !! S (Y1,Y)=0,DGBTCH1=I,DIR(0)="FO^1:5",DIR("A")="Select CLAIM"
"RTN","DGBTDLT1",118,0)
 S DIR("A",1)="Type '^' to exit date list, or <RETURN> to display more dates"
"RTN","DGBTDLT1",119,0)
 S DIR("?")="Entering a '^' will exit the Past CLAIM list, entering <RETURN> will continue to scroll through past dates.",DIR("?",1)="Select a Past CLAIM date by number."
"RTN","DGBTDLT1",120,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S Y1=-1 Q
"RTN","DGBTDLT1",121,0)
 I Y="",$O(DGBTARY(CNTR))'="" Q
"RTN","DGBTDLT1",122,0)
 I X<CHOICE!(X>DGBTCH1)!(X'=+X) W !?25,*7,"INVALID ENTRY!" D CHOZ Q  ; value must be between 1 and last displayed number
"RTN","DGBTDLT1",123,0)
 S CHZFLG=Y,DGBTDTI=$O(DGBTARY(Y,""))
"RTN","DGBTDLT1",124,0)
 S CNTR=$G(Y)
"RTN","DGBTDLT1",125,0)
 Q
"RTN","DGBTDLT1",126,0)
 ;
"RTN","DGBTDLT1",127,0)
DIVISN(DGBTINST) ; if MED CTR DIV file set up (first record) and record does not exist, write warning, kill variables, and exit
"RTN","DGBTDLT1",128,0)
 S DGBTDIVI=$$GET1^DIQ(392,DGBTDTI,11,"I"),DGBTDIV=$$GET1^DIQ(40.8,DGBTDIVI,.01) ; RFE DGBT*1.0*20
"RTN","DGBTDLT1",129,0)
 I ($G(DGBTDIVI)'="")&($G(DGBTDIV)'="") D INSTIT(.DGBTINST) Q  ; RFE DGBT*1.0*20
"RTN","DGBTDLT1",130,0)
 S DGBTDIVI=$O(^DG(40.8,0)),DGBTDIV=$P(^DG(40.8,DGBTDIVI,0),U) D INSTIT(.DGBTINST)
"RTN","DGBTDLT1",131,0)
 Q
"RTN","DGBTDLT1",132,0)
 ; 
"RTN","DGBTDLT1",133,0)
INSTIT(DGBTINST) ;  check for pointer to institution file and for address information on institution
"RTN","DGBTDLT1",134,0)
 N MAILCODE,INSTADD,INSTNODE
"RTN","DGBTDLT1",135,0)
 S DGBTDIVN=$P(^DG(40.8,DGBTDIVI,0),"^",7)
"RTN","DGBTDLT1",136,0)
 I 'DGBTDIVN W !!,"INSTITUTION HAS NOT BEEN DEFINED FOR ",$P(^(0),"^"),!,"USE THE ADT PARAMETER OPTION TO UPDATE",! Q
"RTN","DGBTDLT1",137,0)
 I $D(^DIC(4,DGBTDIVN,0)),$S($D(^(1))#10=0:1,$P(^(1),"^",3)']"":1,1:0) W !!,"INSTITUTION ADDRESS NOT ENTERED.  PLEASE UPDATE USING THE INSTITUTION FILE ENTER/EDIT",! Q
"RTN","DGBTDLT1",138,0)
 ;
"RTN","DGBTDLT1",139,0)
 S INSTNODE=^DIC(4,DGBTDIVN,0)
"RTN","DGBTDLT1",140,0)
 S INSTADD=^DIC(4,DGBTDIVN,1)
"RTN","DGBTDLT1",141,0)
 ; 
"RTN","DGBTDLT1",142,0)
 S DGBTINST("ORG NAME")="DEPARTMENT OF VETERANS AFFAIRS"
"RTN","DGBTDLT1",143,0)
 S DGBTINST("INST NAME")=$$GET1^DIQ(4,DGBTDIVN,.01)
"RTN","DGBTDLT1",144,0)
 S DGBTINST("INST ADDRESS 1")=$$GET1^DIQ(4,DGBTDIVN,1.01)
"RTN","DGBTDLT1",145,0)
 S DGBTINST("INST ADDRESS 2")=$$GET1^DIQ(4,DGBTDIVN,1.02)
"RTN","DGBTDLT1",146,0)
 S DGBTINST("INST CITY")=$$GET1^DIQ(4,DGBTDIVN,1.03)
"RTN","DGBTDLT1",147,0)
 S DGBTINST("INST STATE")=$$GET1^DIQ(4,DGBTDIVN,.02)
"RTN","DGBTDLT1",148,0)
 S DGBTINST("INST ZIP CODE")=$$GET1^DIQ(4,DGBTDIVN,1.04)
"RTN","DGBTDLT1",149,0)
 S DGBTINST("FAC NUMBER")=$$GET1^DIQ(40.8,DGBTDIVI,1)
"RTN","DGBTDLT1",150,0)
 S MAILCODE=$O(^DIC(49,"B","BENEFICIARY TRAVEL",""))
"RTN","DGBTDLT1",151,0)
 S DGBTINST("MAIL CODE")=$$GET1^DIQ(49,MAILCODE,1.5)
"RTN","DGBTDLT1",152,0)
 Q
"RTN","DGBTDLT1",153,0)
 ;
"RTN","DGBTDLT1",154,0)
HEADER(DGBTINST) ;this will print all of the standard information at the top of the letter. IT WILL NOT PRINT LOGO'S ETC
"RTN","DGBTDLT1",155,0)
 ;
"RTN","DGBTDLT1",156,0)
 I $G(DGBTINST("ORG NAME"))="" D  Q
"RTN","DGBTDLT1",157,0)
 .W !!,"INSTITUTION INFORMATION IS UNAVAILABLE. PLEASE UPDATE USING THE INSTITUTION FILE ENTER/EDIT."
"RTN","DGBTDLT1",158,0)
 N ORG,ADD1,ADD2,CITY,STATE,ZIP,INSTNAME,LOC,LOC2,DGBTDTFILED
"RTN","DGBTDLT1",159,0)
 ;
"RTN","DGBTDLT1",160,0)
 S ORG=DGBTINST("ORG NAME")
"RTN","DGBTDLT1",161,0)
 S INSTNAME=DGBTINST("INST NAME")
"RTN","DGBTDLT1",162,0)
 S ADD1=DGBTINST("INST ADDRESS 1")
"RTN","DGBTDLT1",163,0)
 S ADD2=DGBTINST("INST ADDRESS 2")
"RTN","DGBTDLT1",164,0)
 S CITY=DGBTINST("INST CITY")
"RTN","DGBTDLT1",165,0)
 S STATE=DGBTINST("INST STATE")
"RTN","DGBTDLT1",166,0)
 S ZIP=DGBTINST("INST ZIP CODE")
"RTN","DGBTDLT1",167,0)
 ;
"RTN","DGBTDLT1",168,0)
 D DEM^VADPT
"RTN","DGBTDLT1",169,0)
 S PATSEX=$P(VADM(5),"^",1),PATSEX=$S(PATSEX="M":"Mr",1:"Ms")_". "
"RTN","DGBTDLT1",170,0)
 S PATADD1=VAPA(1),PATADD2=VAPA(2)
"RTN","DGBTDLT1",171,0)
 S PATCITY=VAPA(4)_", ",PATST=$P(VAPA(5),"^",2)_" ",PATZIP=VAPA(6)
"RTN","DGBTDLT1",172,0)
 S PATNAME=VADM(1),PATNAME=$P(PATNAME,",",2)_" "_$P(PATNAME,",",1)
"RTN","DGBTDLT1",173,0)
 ;
"RTN","DGBTDLT1",174,0)
 S LOC2=5
"RTN","DGBTDLT1",175,0)
 S LOC=80-$L(ORG) W !,?LOC/2,ORG
"RTN","DGBTDLT1",176,0)
 S LOC=80-$L(INSTNAME) W !,?LOC/2,INSTNAME
"RTN","DGBTDLT1",177,0)
 S LOC=80-$L(ADD1) W !,?LOC/2,ADD1
"RTN","DGBTDLT1",178,0)
 I $G(ADD2)'="" S LOC=80-$L(ADD2) W !,?LOC/2,ADD2
"RTN","DGBTDLT1",179,0)
 S CITYSTZIP=CITY_", "_STATE_" "_ZIP
"RTN","DGBTDLT1",180,0)
 S LOC=80-$L(CITYSTZIP) W !,?LOC/2,CITYSTZIP,!
"RTN","DGBTDLT1",181,0)
 ;S LOC=80-$L(DGBTDTE) W !?LOC,$P(DGBTDTE,"@",1)
"RTN","DGBTDLT1",182,0)
 S DGBTDTFILED=$$GET1^DIQ(392,DGBTDTI,13,"E")
"RTN","DGBTDLT1",183,0)
 S DGBTDTFILED=$S(DGBTDTFILED'="":DGBTDTFILED,1:DT)
"RTN","DGBTDLT1",184,0)
 S DGBTDTFILED=$$FMTE^XLFDT(DGBTDTFILED)
"RTN","DGBTDLT1",185,0)
 S LOC=80-$L(DGBTDTFILED) W !,?LOC,DGBTDTFILED
"RTN","DGBTDLT1",186,0)
 W !,?LOC,DGBTINST("FAC NUMBER")
"RTN","DGBTDLT1",187,0)
 W ?LOC,"/"_$S(DGBTINST("MAIL CODE")'="":DGBTINST("MAIL CODE"),1:"136B"),!
"RTN","DGBTDLT1",188,0)
 W ?LOC,$E(VADM(1),1)_$E($P(VADM(2),"^",1),6,99)
"RTN","DGBTDLT1",189,0)
 W !,?LOC2,$G(PATSEX),$G(PATNAME)
"RTN","DGBTDLT1",190,0)
 W !,?LOC2,$G(PATADD1)
"RTN","DGBTDLT1",191,0)
 W:$G(PATADD2)'="" !,?LOC2,PATADD2
"RTN","DGBTDLT1",192,0)
 W !,?LOC2,PATCITY,PATST,PATZIP,!!
"RTN","DGBTDLT1",193,0)
 ;
"RTN","DGBTDLT1",194,0)
 Q
"RTN","DGBTDLT1",195,0)
 ;
"RTN","DGBTDLT1",196,0)
DEVICE(DGBTRPT) N %ZIS,ZTSK,ZTRTN,ZTIO,ZTDESC,ZTSAVE,POP
"RTN","DGBTDLT1",197,0)
 S %ZIS="QM"
"RTN","DGBTDLT1",198,0)
 D ^%ZIS
"RTN","DGBTDLT1",199,0)
 I POP S DGBTQ=1
"RTN","DGBTDLT1",200,0)
 ;
"RTN","DGBTDLT1",201,0)
 ;Check for exit
"RTN","DGBTDLT1",202,0)
 I $G(DGBTQ) Q
"RTN","DGBTDLT1",203,0)
 ;
"RTN","DGBTDLT1",204,0)
 S DGBTSCR=$S($E($G(IOST),1,2)="C-":1,1:0)
"RTN","DGBTDLT1",205,0)
 I $D(IO("Q")) D  S DGBTQ=1
"RTN","DGBTDLT1",206,0)
 . S ZTRTN="RUN^DGBTBORP0(DGBTEXCEL,DGBTRPT,DGBTSMDET)"
"RTN","DGBTDLT1",207,0)
 . S ZTIO=ION
"RTN","DGBTDLT1",208,0)
 . S ZTSAVE("*")=""
"RTN","DGBTDLT1",209,0)
 . S ZTDESC="DGBT REPORT: "_DGBTRPT
"RTN","DGBTDLT1",210,0)
 . D ^%ZTLOAD
"RTN","DGBTDLT1",211,0)
 . W !,$S($D(ZTSK):"REQUEST QUEUED TASK="_ZTSK,1:"REQUEST CANCELLED")
"RTN","DGBTDLT1",212,0)
 . D HOME^%ZIS
"RTN","DGBTDLT1",213,0)
 U IO
"RTN","DGBTDLT1",214,0)
 Q
"RTN","DGBTDLT1",215,0)
 ;
"RTN","DGBTDLT1",216,0)
QUIT ;will kill all local variables used by this routine
"RTN","DGBTDLT1",217,0)
 ;
"RTN","DGBTDLT1",218,0)
 K DFN,DGBTNEW,VACNTRY,VADAT,VADM,VAERR,VAPA,Y,Z,J,DGBTINST,DGBTNEW,DGBTTOUT,DGBTDLTR,DGBTDIVN,DGBTDIVI,DGBTDIV,DGBTCMTY,DGTCH1,DGBTCH,DGBTC,DGBTMD
"RTN","DGBTDLT1",219,0)
 K ^TMP("DGBT",$J),DFN,CITYSTZIP,CHZFLG,C,QUIT
"RTN","DGBTDLT1",220,0)
 K X1,YY,DGBTCHK,^TMP("DGBT",$J),^TMP("DGBTARA",$J)
"RTN","DGBTDLT1",221,0)
 K DRIEN,REASON,LETTERS1,LETTERS2,LINENBR,NBR,DGBTDNLTR,DGBTFDA,DGBTSCR,DGBTDR,DGBTISSUED,VADM,PATSEX,PATADD1,PATADD2,PATCITY,PATST,PATZIP,PATNAME
"RTN","DGBTDLT1",222,0)
 K CNTR,DFN,DGBTARY,DGBTCH,DGBTCH1,DGBTDTE,DGBTDTI,DGBTNEW,DGBTTOUT,DGBTARY,VA,VACNTRY,VAPA,DUOUT,DTOUT,DGBTQ,DGBTQ1
"RTN","DGBTDLT1",223,0)
 Q
"RTN","DGBTDW")
0^16^B153522800
"RTN","DGBTDW",1,0)
DGBTDW ;ALB/RFE - DEDUCTIBLE WAIVER SETUP/MAIN ENTRY CALLUP; 01/19/12
"RTN","DGBTDW",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTDW",3,0)
 Q
"RTN","DGBTDW",4,0)
EN ; Entry point
"RTN","DGBTDW",5,0)
 N %,%H,%I,%Y,ANS,C,DELRAY,DFN,DGBTDTI,DGBTDW,DGBTFDA,DGBTFDA1,DGBTIENS,DGBTNEW,DGBTOK,DGBTTOUT,DGENR,DGRETV,DISPLAY,DTSUB,ERRMSG,PENSION,THISYR,I,X,Y
"RTN","DGBTDW",6,0)
 N VAEL,VAERR,DELETRAY,DGBTERR
"RTN","DGBTDW",7,0)
 D CLEAN^DILF
"RTN","DGBTDW",8,0)
 F  D ENTRQ Q:'$D(DFN)
"RTN","DGBTDW",9,0)
 D QUIT
"RTN","DGBTDW",10,0)
 Q
"RTN","DGBTDW",11,0)
ENTRQ ; Keep prompting until we don't get a DFN
"RTN","DGBTDW",12,0)
 D PATIENT Q:'$D(DFN)
"RTN","DGBTDW",13,0)
 K VAEL D ELIG^VADPT ;
"RTN","DGBTDW",14,0)
 I '+VAEL(1) W !!,"Eligibility is missing from registration and is required to continue.",*7 D QUIT Q
"RTN","DGBTDW",15,0)
 S DGBTNEW='$D(^DGBT(392.7,"C",DFN))
"RTN","DGBTDW",16,0)
 D DATE
"RTN","DGBTDW",17,0)
 I ($D(DIRUT))!($D(DUOUT))!($D(DIROUT))!($D(DTOUT))!(Y=-1)!('$D(DGBTDTI)) D QUIT Q
"RTN","DGBTDW",18,0)
 W !
"RTN","DGBTDW",19,0)
 S DGBTNEW='$D(^DGBT(392.7,"C",DFN,DGBTDTI))
"RTN","DGBTDW",20,0)
 S (DGBTOK,DISPLAY)=0
"RTN","DGBTDW",21,0)
 S DGBTOK=1
"RTN","DGBTDW",22,0)
 I 'DGBTNEW D OLDREQ
"RTN","DGBTDW",23,0)
 I DISPLAY D DISPLAY,QUIT Q
"RTN","DGBTDW",24,0)
 I 'DGBTOK D QUIT Q
"RTN","DGBTDW",25,0)
 I 'DGBTNEW W !,$$GET1^DIQ(2,DFN,.01)," ",DGBTDW("REQDT")
"RTN","DGBTDW",26,0)
 D AUTH
"RTN","DGBTDW",27,0)
 I 'DGBTOK D QUIT Q
"RTN","DGBTDW",28,0)
 D GRANT
"RTN","DGBTDW",29,0)
 I 'DGBTOK D QUIT Q
"RTN","DGBTDW",30,0)
 D APPDT
"RTN","DGBTDW",31,0)
 I 'DGBTOK D QUIT Q
"RTN","DGBTDW",32,0)
 D RMRK
"RTN","DGBTDW",33,0)
 I 'DGBTOK D QUIT Q
"RTN","DGBTDW",34,0)
 W !,"NAME: ",$$GET1^DIQ(2,DFN,.01)," DEDUCTIBLE WAIVER REQUEST DATE: ",DGBTDW("REQDT")
"RTN","DGBTDW",35,0)
 W !,$S(DGBTDW("AUTH")="YES":"GRANT",1:"DENI"),"ED BY: ",$$GET1^DIQ(200,DGBTDW("GRANT"),.01)," ON DATE: ",DGBTDW("APPDT")
"RTN","DGBTDW",36,0)
 ;
"RTN","DGBTDW",37,0)
 I '$$YESNO^DGBTUTL("Complete waiver request") W !,"Not completed" D QUIT Q            ;changed by bld
"RTN","DGBTDW",38,0)
 ;
"RTN","DGBTDW",39,0)
 D UPDATE
"RTN","DGBTDW",40,0)
 D QUIT
"RTN","DGBTDW",41,0)
 Q
"RTN","DGBTDW",42,0)
PATIENT ;
"RTN","DGBTDW",43,0)
 K DIC,DFN
"RTN","DGBTDW",44,0)
 S DGBTTOUT="",DIC="^DPT(",DIC(0)="AEQMZ",DIC("A")="Select PATIENT: "
"RTN","DGBTDW",45,0)
 W !! D ^DIC K DIC Q:Y'>0
"RTN","DGBTDW",46,0)
 S (DFN,DGBTDW("NAME"))=+Y
"RTN","DGBTDW",47,0)
 S PENSION=$$PENSION
"RTN","DGBTDW",48,0)
 Q
"RTN","DGBTDW",49,0)
PENSION() ;
"RTN","DGBTDW",50,0)
 N HIT,VAEL,VAERR
"RTN","DGBTDW",51,0)
 D ELIG^VADPT
"RTN","DGBTDW",52,0)
 I $P(VAEL(1),"^",2)["PENSION" Q 1
"RTN","DGBTDW",53,0)
 I $P(VAEL(1),"^",2)="AID & ATTENDANCE" Q 1
"RTN","DGBTDW",54,0)
 I $P(VAEL(1),"^",2)="HOUSEBOUND" Q 1
"RTN","DGBTDW",55,0)
 S (HIT,I)=""
"RTN","DGBTDW",56,0)
 F  S I=$O(VAEL(1,I)) Q:I=""  D  Q:HIT
"RTN","DGBTDW",57,0)
 .I VAEL(1,I)["PENSION" S HIT=1 Q
"RTN","DGBTDW",58,0)
 .I $P(VAEL(1,I),"^",2)="AID & ATTENDANCE" S HIT=1 Q
"RTN","DGBTDW",59,0)
 .I $P(VAEL(1,I),"^",2)="HOUSEBOUND" S HIT=1
"RTN","DGBTDW",60,0)
 Q HIT
"RTN","DGBTDW",61,0)
UPDATE ;
"RTN","DGBTDW",62,0)
 K ERRMSG
"RTN","DGBTDW",63,0)
 I DGBTNEW D
"RTN","DGBTDW",64,0)
 .S DGBTFDA(392.7,"+1,",.01)=DGBTDW("REQDT")
"RTN","DGBTDW",65,0)
 .S DGBTFDA(392.7,"+1,",3)=DGBTDW("AUTH")
"RTN","DGBTDW",66,0)
 .S DGBTFDA(392.7,"+1,",5)=DGBTDW("APPDT")
"RTN","DGBTDW",67,0)
 .I $G(DGBTDW("REMARK"))'="" S DGBTFDA(392.7,"+1,",7)=DGBTDW("REMARK")
"RTN","DGBTDW",68,0)
 .S DGBTFDA(392.7,"+1,",9)=$$FMTE^XLFDT(DT)
"RTN","DGBTDW",69,0)
 .D UPDATE^DIE("E","DGBTFDA",,"ERRMSG")
"RTN","DGBTDW",70,0)
 .I $D(ERRMSG) Q
"RTN","DGBTDW",71,0)
 .;
"RTN","DGBTDW",72,0)
 .S DGBTFDA1(392.7,DGBTDTI_",",2)=DGBTDW("NAME")
"RTN","DGBTDW",73,0)
 .S DGBTFDA1(392.7,DGBTDTI_",",4)=DGBTDW("GRANT")
"RTN","DGBTDW",74,0)
 .S DGBTFDA1(392.7,DGBTDTI_",",6)=DUZ
"RTN","DGBTDW",75,0)
 .S DGBTFDA1(392.7,DGBTDTI_",",8)=$$EXP
"RTN","DGBTDW",76,0)
 .D FILE^DIE("S","DGBTFDA1","ERRMSG")
"RTN","DGBTDW",77,0)
 ;
"RTN","DGBTDW",78,0)
 I '$G(DGBTNEW) D
"RTN","DGBTDW",79,0)
 .S DGBTFDA(392.7,DGBTDTI_",",3)=DGBTDW("AUTH")
"RTN","DGBTDW",80,0)
 .S DGBTFDA(392.7,DGBTDTI_",",5)=DGBTDW("APPDT")
"RTN","DGBTDW",81,0)
 .I $G(DGBTDW("REMARK"))'="" S DGBTFDA(392.7,DGBTDTI_",",7)=DGBTDW("REMARK")
"RTN","DGBTDW",82,0)
 .S DGBTFDA(392.7,DGBTDTI_",",9)=$$FMTE^XLFDT(DT)
"RTN","DGBTDW",83,0)
 .D FILE^DIE("E","DGBTFDA","ERRMSG")
"RTN","DGBTDW",84,0)
 .I $D(ERRMSG) Q
"RTN","DGBTDW",85,0)
 .S DGBTFDA(392.7,DGBTDTI_",",4)=DGBTDW("GRANT")
"RTN","DGBTDW",86,0)
 .S DGBTFDA(392.7,DGBTDTI_",",6)=DUZ
"RTN","DGBTDW",87,0)
 .S DGBTFDA(392.7,DGBTDTI_",",8)=$$EXP
"RTN","DGBTDW",88,0)
 .D FILE^DIE(,"DGBTFDA","ERRMSG")
"RTN","DGBTDW",89,0)
 I '$D(ERRMSG) D FILDLT Q
"RTN","DGBTDW",90,0)
 F I=1:1 Q:'$D(ERRMSG("DIERR","1","TEXT",I))  W !,ERRMSG("DIERR",1,"TEXT",I)
"RTN","DGBTDW",91,0)
 Q
"RTN","DGBTDW",92,0)
FILDLT ;
"RTN","DGBTDW",93,0)
 Q:'$D(DELETRAY)
"RTN","DGBTDW",94,0)
 S I=$O(DELETRAY("")) Q:I=""
"RTN","DGBTDW",95,0)
 K ERR
"RTN","DGBTDW",96,0)
 S DGBTFDA(392.7,I_",",97)=DELETRAY(I,"DATE")
"RTN","DGBTDW",97,0)
 S DGBTFDA(392.7,I_",",98)=DELETRAY(I,"DUZ")
"RTN","DGBTDW",98,0)
 S DGBTFDA(392.7,I_",",99)=DELETRAY(I,"REMARK")
"RTN","DGBTDW",99,0)
 D FILE^DIE(,"DGBTFDA","ERR")
"RTN","DGBTDW",100,0)
 Q
"RTN","DGBTDW",101,0)
DATE ;
"RTN","DGBTDW",102,0)
 Q:$$PENSDT
"RTN","DGBTDW",103,0)
 K DGBTDTI,DELETRAY
"RTN","DGBTDW",104,0)
 N PASTDT,PASTYR,DEL
"RTN","DGBTDW",105,0)
 D DEL
"RTN","DGBTDW",106,0)
 I 'DGBTNEW N DGBTC D OLD S:'DGBTC DGBTNEW=1
"RTN","DGBTDW",107,0)
 F  D DATE1 Q:DONE
"RTN","DGBTDW",108,0)
 K DONE
"RTN","DGBTDW",109,0)
 Q
"RTN","DGBTDW",110,0)
DATE1 ;
"RTN","DGBTDW",111,0)
 S DONE=1
"RTN","DGBTDW",112,0)
 K DIR
"RTN","DGBTDW",113,0)
 I 'DGBTNEW S DIR("A",2)="Enter 'P' for past requests"
"RTN","DGBTDW",114,0)
 S (DIR("A",1),DIR("A",3))="",DIR("A")="DEDUCTIBLE WAIVER REQUEST DATE AND TIME",DIR("?")="^D DHELP^DGBTDW"
"RTN","DGBTDW",115,0)
 S DIR(0)="F",DIR("B")="NOW" D ^DIR K DIR
"RTN","DGBTDW",116,0)
 I ($D(DIRUT))!($D(DUOUT)) Q
"RTN","DGBTDW",117,0)
 S %DT="EXR",DTSUB=$S($$UP^XLFSTR(Y)="P":"PASTRQ",1:"OTHR") D @DTSUB K DTSUB,%DT
"RTN","DGBTDW",118,0)
 Q
"RTN","DGBTDW",119,0)
 ; Date-requested subroutines
"RTN","DGBTDW",120,0)
OTHR ; date/time entry for manually entered date
"RTN","DGBTDW",121,0)
 S %DT(0)="-NOW" D ^%DT I Y<0 S DONE=0 Q
"RTN","DGBTDW",122,0)
 I Y<$$FMADD^XLFDT(DT,-30) W !,"Date cannot precede ",$$FMTE^XLFDT($$FMADD^XLFDT(DT,-30)) S DONE=0 Q
"RTN","DGBTDW",123,0)
 I $D(DEL($E(Y,1,3))),('$D(PASTYR($E(Y,1,3)))) D  I 'ANS S Y=-1 Q
"RTN","DGBTDW",124,0)
 .S THISYR=DEL($E(Y,1,3))
"RTN","DGBTDW",125,0)
 .W !,"Request already on file and has been deleted on ",$$UP^XLFSTR($$FMTE^XLFDT(THISYR)),!
"RTN","DGBTDW",126,0)
 .N RQDT S RQDT=Y
"RTN","DGBTDW",127,0)
 .S ANS=$$YESNO^DGBTUTL("Do you wish to enter a new manual waiver request")
"RTN","DGBTDW",128,0)
 .S Y=RQDT
"RTN","DGBTDW",129,0)
 .I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) S ANS=0
"RTN","DGBTDW",130,0)
 I $D(PASTYR($E(Y,1,3))),'$D(^DGBT(392.7,"C",DFN,Y)) N RQDT D DELETE S Y=RQDT I 'ANS Q
"RTN","DGBTDW",131,0)
 I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",132,0)
 I $D(^DGBT(392.7,"C",DFN,Y)) S (DGBTDTI,DGBTIENS)=Y,DGBTDW("REQDT")=$$FMTE^XLFDT(DGBTDTI) Q
"RTN","DGBTDW",133,0)
 S DGBTDTI=$$LOCKNEW(Y,0) I DGBTDTI=-1 W !,"Please enter another date/time" K DGBTDTI Q
"RTN","DGBTDW",134,0)
 S DGBTDW("REQDT")=$$FMTE^XLFDT(DGBTDTI)
"RTN","DGBTDW",135,0)
 Q
"RTN","DGBTDW",136,0)
LOCKNEW(DGBTDTI,DONE) ;
"RTN","DGBTDW",137,0)
 F  D  Q:DONE
"RTN","DGBTDW",138,0)
 .L +^DGBT(392.7,DGBTDTI):1
"RTN","DGBTDW",139,0)
 .I ($T),('$D(^DGBT(392.7,DGBTDTI))) S DONE=1 Q
"RTN","DGBTDW",140,0)
 .L  S DGBTDTI=DGBTDTI+.000001
"RTN","DGBTDW",141,0)
 .I ($L(DGBTDTI)=13),$E(DGBTDTI,13)=6 S DONE=1,DGBTDTI=-1 Q
"RTN","DGBTDW",142,0)
 .I $E(DGBTDTI,13,14)>59 S DONE=1,DGBTDTI=-1 Q
"RTN","DGBTDW",143,0)
 Q DGBTDTI
"RTN","DGBTDW",144,0)
PASTRQ ;
"RTN","DGBTDW",145,0)
 I DGBTNEW W !,"No past dates on file, please enter a valid date/time" S DONE=0 Q
"RTN","DGBTDW",146,0)
 N DGBTCH
"RTN","DGBTDW",147,0)
 S DGBTCH=1
"RTN","DGBTDW",148,0)
 F  D LIST Q:DONE1
"RTN","DGBTDW",149,0)
 K DONE1
"RTN","DGBTDW",150,0)
 I ('$D(DTOUT)),(Y'>0) S DONE=0
"RTN","DGBTDW",151,0)
 Q
"RTN","DGBTDW",152,0)
DELETE ;
"RTN","DGBTDW",153,0)
 S RQDT=Y
"RTN","DGBTDW",154,0)
 W !!,"Request already on file for this year: "
"RTN","DGBTDW",155,0)
 S THISYR=PASTYR($E(Y,1,3))
"RTN","DGBTDW",156,0)
 W $$UP^XLFSTR($$FMTE^XLFDT(THISYR)),!
"RTN","DGBTDW",157,0)
 D
"RTN","DGBTDW",158,0)
 .N X,Y
"RTN","DGBTDW",159,0)
 .S ANS=$$YESNO^DGBTUTL("Do you wish to delete the request for "_$$UP^XLFSTR($$FMTE^XLFDT(THISYR)))
"RTN","DGBTDW",160,0)
 I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",161,0)
 I 'ANS S Y=THISYR Q
"RTN","DGBTDW",162,0)
 D
"RTN","DGBTDW",163,0)
 .N X,Y
"RTN","DGBTDW",164,0)
 .S ANS=$$YESNO^DGBTUTL("Are you sure you wish to delete this request?")
"RTN","DGBTDW",165,0)
 I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",166,0)
 I 'ANS S Y=THISYR Q
"RTN","DGBTDW",167,0)
 S DELETRAY(THISYR,"DATE")=DT
"RTN","DGBTDW",168,0)
 S DELETRAY(THISYR,"DUZ")=DUZ
"RTN","DGBTDW",169,0)
 F  D  Q:DONE
"RTN","DGBTDW",170,0)
 .S DONE=1
"RTN","DGBTDW",171,0)
 .N X,Y
"RTN","DGBTDW",172,0)
 .K DIR S DIR("A")="Enter reason for deletion",DIR(0)="FO^1:100" D ^DIR K DIR
"RTN","DGBTDW",173,0)
 .I ($D(DUOUT))!($D(DIROUT))!($D(DTOUT)) Q
"RTN","DGBTDW",174,0)
 .S ANS=$TR(Y,U," ")
"RTN","DGBTDW",175,0)
 .I $L($TR(ANS," ",""))=0 S DONE=0
"RTN","DGBTDW",176,0)
 I ($D(DUOUT))!($D(DIROUT))!($D(DTOUT)) K DELETRAY Q
"RTN","DGBTDW",177,0)
 S DELETRAY(THISYR,"REMARK")=ANS
"RTN","DGBTDW",178,0)
 S ANS=$$YESNO^DGBTUTL("Do you wish to enter a deductible waiver request for "_$$UP^XLFSTR($$FMTE^XLFDT(Y)))
"RTN","DGBTDW",179,0)
 I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",180,0)
 I ANS Q
"RTN","DGBTDW",181,0)
 D FILDLT K DELETRAY
"RTN","DGBTDW",182,0)
 Q
"RTN","DGBTDW",183,0)
OLD ; Previously entered waiver request dates
"RTN","DGBTDW",184,0)
 S DGBTC=0,I=""
"RTN","DGBTDW",185,0)
 F  S I=$O(^DGBT(392.7,"C",DFN,I),-1) Q:'I  D
"RTN","DGBTDW",186,0)
 .Q:$$GET1^DIQ(392.7,I,97,"I")  ;deleted
"RTN","DGBTDW",187,0)
 .S DGBTC=DGBTC+1
"RTN","DGBTDW",188,0)
 .S PASTYR($E(I,1,3))=I
"RTN","DGBTDW",189,0)
 .S PASTDT(DGBTC)=$$FMTE^XLFDT(I)_"^"_I
"RTN","DGBTDW",190,0)
 Q
"RTN","DGBTDW",191,0)
DEL ; Deleted waivers on file
"RTN","DGBTDW",192,0)
 S I=""
"RTN","DGBTDW",193,0)
 F  S I=$O(^DGBT(392.7,"C",DFN,I),-1) Q:'I  D
"RTN","DGBTDW",194,0)
 .Q:'$$GET1^DIQ(392.7,I,97,"I")  ;deleted
"RTN","DGBTDW",195,0)
 .S DEL($E(I,1,3))=I
"RTN","DGBTDW",196,0)
 Q
"RTN","DGBTDW",197,0)
LIST ;
"RTN","DGBTDW",198,0)
 S DONE1=1
"RTN","DGBTDW",199,0)
 F I=DGBTCH:1:DGBTC W !?5,I,". ",$P(PASTDT(I),"^") I (I#5=0)!(I=DGBTC) D  Q:($D(DTOUT))!($D(DIRUT))!(Y>0)
"RTN","DGBTDW",200,0)
 .N DONE
"RTN","DGBTDW",201,0)
 .F  D CHOZ Q:DONE
"RTN","DGBTDW",202,0)
 I ('$D(DTOUT))&(Y="")&(I=DGBTC) S Y=-1 Q
"RTN","DGBTDW",203,0)
 S:('$D(DTOUT))&(Y="") DONE1=0,DGBTCH=I+1 Q
"RTN","DGBTDW",204,0)
 I Y=-1 Q
"RTN","DGBTDW",205,0)
 Q
"RTN","DGBTDW",206,0)
DHELP ;
"RTN","DGBTDW",207,0)
 S %DT="EXR" D ^%DT K %DT
"RTN","DGBTDW",208,0)
 W ! I 'DGBTNEW W !,"If there is more than one waiver request, select by number to edit."
"RTN","DGBTDW",209,0)
 W !,"You cannot enter a future date/time."
"RTN","DGBTDW",210,0)
 W !,"The date you enter cannot precede ",$$FMTE^XLFDT($$FMADD^XLFDT(DT,-30)),"."
"RTN","DGBTDW",211,0)
 Q
"RTN","DGBTDW",212,0)
PENSDT() ;
"RTN","DGBTDW",213,0)
 I 'PENSION Q 0
"RTN","DGBTDW",214,0)
 S DGBTDTI=$O(^DGBT(392.7,"C",DFN,""),-1) I 'DGBTDTI Q 0
"RTN","DGBTDW",215,0)
 I $$GET1^DIQ(392.7,DGBTDTI,8)'="PENSION" Q 0
"RTN","DGBTDW",216,0)
 S (DGBTIENS,Y)=DGBTDTI,DGBTDW("REQDT")=$$FMTE^XLFDT(DGBTDTI)
"RTN","DGBTDW",217,0)
 W !,$$UP^XLFSTR(DGBTDW("REQDT"))
"RTN","DGBTDW",218,0)
 Q 1
"RTN","DGBTDW",219,0)
CHOZ ;  select from the displayed past claims dates for claim to be edited.
"RTN","DGBTDW",220,0)
 S DONE=1
"RTN","DGBTDW",221,0)
 K DIR
"RTN","DGBTDW",222,0)
 W !! S Y=0,DIR(0)="FO^1:5",DIR("A")="Select DEDUCTIBLE WAIVER REQUEST"
"RTN","DGBTDW",223,0)
 I I<DGBTC S DIR("A",1)="Type '^' to exit date list, or <RETURN> to display more dates"
"RTN","DGBTDW",224,0)
 I I=DGBTC S DIR("A",1)="Type <RETURN> or '^' to exit date list"
"RTN","DGBTDW",225,0)
 S DIR("?")="Entering a '^' will exit the Past REQUEST list, entering <RETURN> will continue to scroll through past dates.",DIR("?",1)="Select a Past CLAIM date by number, or enter 'T' for TODAY."
"RTN","DGBTDW",226,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S Y=-1 Q
"RTN","DGBTDW",227,0)
 Q:Y=""
"RTN","DGBTDW",228,0)
 I (X<1)!(X>I)!(X'=+X) W !?25,*7,"INVALID ENTRY" S DONE=0 Q
"RTN","DGBTDW",229,0)
 S (DGBTDTI,DGBTIENS)=$P(PASTDT(Y),"^",2),DGBTDW("REQDT")=$P(PASTDT(Y),"^") W !,$$GET1^DIQ(392.7,DGBTDTI,2)," ",$$GET1^DIQ(392.7,DGBTDTI,.01)
"RTN","DGBTDW",230,0)
 Q
"RTN","DGBTDW",231,0)
AUTH ; Deductible waiver authorized Y/N
"RTN","DGBTDW",232,0)
 I PENSION W !,"DEDUCTIBLE WAIVER AUTHORIZED YES" S DGBTDW("AUTH")="YES" Q
"RTN","DGBTDW",233,0)
 K DIR
"RTN","DGBTDW",234,0)
 S DIR("A")="DEDUCTIBLE WAIVER AUTHORIZED Y/N",DIR(0)="Y"
"RTN","DGBTDW",235,0)
 S DIR("B")=$S(DGBTNEW:"YES",1:$$GET1^DIQ(392.7,DGBTIENS,3))
"RTN","DGBTDW",236,0)
 D ^DIR K DIR
"RTN","DGBTDW",237,0)
 I ($D(DTOUT))!($D(DIRUT)) S DGBTOK=0 Q
"RTN","DGBTDW",238,0)
 S DGBTDW("AUTH")=Y(0)
"RTN","DGBTDW",239,0)
 Q
"RTN","DGBTDW",240,0)
RMRK ; Remarks
"RTN","DGBTDW",241,0)
 K DGBTDW("REMARK"),DIR
"RTN","DGBTDW",242,0)
 S DIR("A")="DEDUCTIBLE WAIVER REMARKS"
"RTN","DGBTDW",243,0)
 I 'DGBTNEW S DIR("B")=$$GET1^DIQ(392.7,DGBTIENS,7)
"RTN","DGBTDW",244,0)
 S DIR(0)="FO^1:235"
"RTN","DGBTDW",245,0)
 D ^DIR K DIR
"RTN","DGBTDW",246,0)
 I (Y=""),('$D(DTOUT)) Q
"RTN","DGBTDW",247,0)
 I ($E(Y,1)="^")!($D(DIRUT))!($D(DTOUT)) S DGBTOK=0 D QUIT Q
"RTN","DGBTDW",248,0)
 S DGBTDW("REMARK")=Y
"RTN","DGBTDW",249,0)
 Q
"RTN","DGBTDW",250,0)
APPDT ; Waiver Approval Date
"RTN","DGBTDW",251,0)
 F  D  Q:DONE
"RTN","DGBTDW",252,0)
 .S DONE=1
"RTN","DGBTDW",253,0)
 .K DIR
"RTN","DGBTDW",254,0)
 .S DIR("A")=$S(DGBTDW("AUTH")="YES":"WAIVER APPROVAL DATE: ",1:"WAIVER DENIAL DATE: ")
"RTN","DGBTDW",255,0)
 .S DIR(0)="DA^2991231:NOW:EX",DIR("B")=$S(DGBTNEW:"TODAY",1:$$GET1^DIQ(392.7,DGBTIENS,5)) D ^DIR K DIR
"RTN","DGBTDW",256,0)
 .I ($D(DIRUT))!($D(DIROUT)) Q
"RTN","DGBTDW",257,0)
 .I Y<$P(DGBTDTI,".") W !,"Cannot be before request date" S DONE=0 Q
"RTN","DGBTDW",258,0)
 K DONE
"RTN","DGBTDW",259,0)
 I ($D(DIRUT))!($D(DIROUT))!(Y=-1) S DGBTOK=0 Q
"RTN","DGBTDW",260,0)
 S DGBTDW("APPDT")=Y(0)
"RTN","DGBTDW",261,0)
 Q
"RTN","DGBTDW",262,0)
GRANT ; Waiver granted by:
"RTN","DGBTDW",263,0)
 K DIC
"RTN","DGBTDW",264,0)
 F  D  Q:DONE
"RTN","DGBTDW",265,0)
 .S DONE=1
"RTN","DGBTDW",266,0)
 .S DIC="^VA(200,",DIC(0)="AEQMZ",DIC("A")=$S(DGBTDW("AUTH")="YES":"DEDUCTIBLE WAIVER GRANTED BY: ",1:"DEDUCTIBLE WAIVER DENIED BY: ")
"RTN","DGBTDW",267,0)
 .I 'DGBTNEW S DIC("B")=$$GET1^DIQ(392.7,DGBTIENS,4)
"RTN","DGBTDW",268,0)
 .D ^DIC K DIC
"RTN","DGBTDW",269,0)
 .I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",270,0)
 .I +Y<0 S DONE=0
"RTN","DGBTDW",271,0)
 K DONE
"RTN","DGBTDW",272,0)
 I ($D(DTOUT))!($D(DUOUT))!(+Y'>0) S DGBTOK=0 Q
"RTN","DGBTDW",273,0)
 S DGBTDW("GRANT")=+Y
"RTN","DGBTDW",274,0)
 Q
"RTN","DGBTDW",275,0)
EXP() ; Expiration date
"RTN","DGBTDW",276,0)
 I PENSION Q "PENSION"
"RTN","DGBTDW",277,0)
 I $G(DGBTDW("AUTH"))'="YES" Q ""
"RTN","DGBTDW",278,0)
 N DGBTINCA,EXPDT
"RTN","DGBTDW",279,0)
 D GA^DGBTUTL(DFN,"DGBTINCA",DGBTDTI)
"RTN","DGBTDW",280,0)
 S EXPDT=$$EXPDT
"RTN","DGBTDW",281,0)
 I EXPDT<DGBTDTI Q $E(DGBTDTI,1,3)_1231            ;BLD changed exp to expdt
"RTN","DGBTDW",282,0)
 N DGARRAY,DGBTDATA,DGBTRET,DGMTST,DGMTYPT1,FIELDS,FILE,FLAGS,INCOM,LOWINC,MTDATA,MTIEN,MTT,NETINC,THRESHLD
"RTN","DGBTDW",283,0)
 I +$$LI^DGBTUTL(DFN,DGBTDTI,$$DEP^VAFMON(DFN,DGBTDTI),,DGBTINCA) Q EXPDT ;
"RTN","DGBTDW",284,0)
 Q $E(DGBTDTI,1,3)_1231      ;BLD add $g around DGBTDW("APPR")
"RTN","DGBTDW",285,0)
EXPDT() ;
"RTN","DGBTDW",286,0)
 I +$G(DGBTINCA) Q $P(DGBTINCA,U,5)
"RTN","DGBTDW",287,0)
 N TESTDATE
"RTN","DGBTDW",288,0)
 S TESTDATE=$P($$LST^DGMTCOU1(DFN,DGBTDTI,3),"^",2)
"RTN","DGBTDW",289,0)
 I +TESTDATE=0 Q 0
"RTN","DGBTDW",290,0)
 Q ($E(TESTDATE,1,3)+1)_$E(TESTDATE,4,7)
"RTN","DGBTDW",291,0)
OLDREQ ;
"RTN","DGBTDW",292,0)
 K DIR
"RTN","DGBTDW",293,0)
 ;I $$EDITOLD S DIR("A")="<E>dit Request, <D>isplay Request, or <Q>uit ",DIR(0)="SA^Q:Quit;E:Edit;D:Display"
"RTN","DGBTDW",294,0)
 ;E  S DIR("A")="<D>isplay Request, or <Q>uit ",DIR(0)="SA^Q:Quit;D:Display"
"RTN","DGBTDW",295,0)
 I $$EDITOLD S DIR("A")="<E>dit Request, <D>isplay Request, <DEL>ete Request, or <Q>uit ",DIR(0)="SA^Q:Quit;E:Edit;D:Display;DEL:Delete"
"RTN","DGBTDW",296,0)
 E  S DIR("A")="<D>isplay Request, <DEL>ete Request, or <Q>uit ",DIR(0)="SA^Q:Quit;D:Display;DEL:Delete"
"RTN","DGBTDW",297,0)
 S DIR("B")="Quit"
"RTN","DGBTDW",298,0)
 D ^DIR K DIR
"RTN","DGBTDW",299,0)
 ;S X=$E($$UP^XLFSTR(X),1)
"RTN","DGBTDW",300,0)
 S X=$$UP^XLFSTR(X)
"RTN","DGBTDW",301,0)
 I ($E(X,1)="Q")!($D(DIRUT))!($D(DUOUT)) S DGBTOK=0 Q
"RTN","DGBTDW",302,0)
 I $E(X,1,3)="DEL" D  Q
"RTN","DGBTDW",303,0)
 .I $G(DGBTIENS)="" S DGBTIENS=$G(PASTYR($E(Y,1,3)))
"RTN","DGBTDW",304,0)
 .I DGBTIENS="" Q
"RTN","DGBTDW",305,0)
 .S DELETRAY(DGBTIENS,"DATE")=DT
"RTN","DGBTDW",306,0)
 .S DELETRAY(DGBTIENS,"DUZ")=DUZ
"RTN","DGBTDW",307,0)
 .F  D  Q:DONE
"RTN","DGBTDW",308,0)
 ..S DONE=1
"RTN","DGBTDW",309,0)
 ..N X,Y
"RTN","DGBTDW",310,0)
 ..K DIR S DIR("A")="Enter reason for deletion",DIR(0)="FO^1:100" D ^DIR K DIR
"RTN","DGBTDW",311,0)
 ..I ($D(DUOUT))!($D(DIROUT))!($D(DTOUT)) Q
"RTN","DGBTDW",312,0)
 ..S ANS=$TR(Y,U," ")
"RTN","DGBTDW",313,0)
 ..I $L($TR(ANS," ",""))=0 S DONE=0
"RTN","DGBTDW",314,0)
 .I ($D(DUOUT))!($D(DIROUT))!($D(DTOUT)) K DELETRAY Q
"RTN","DGBTDW",315,0)
 .S DELETRAY(DGBTIENS,"REMARK")=ANS
"RTN","DGBTDW",316,0)
 .I ($D(DIRUT))!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTDW",317,0)
 .D FILDLT K DELETRAY
"RTN","DGBTDW",318,0)
 .S DGBTOK=0
"RTN","DGBTDW",319,0)
 S DGBTOK=1
"RTN","DGBTDW",320,0)
 I $E(X,1)="D" S DISPLAY=1
"RTN","DGBTDW",321,0)
 Q
"RTN","DGBTDW",322,0)
EDITOLD() ;
"RTN","DGBTDW",323,0)
 N EXPDT
"RTN","DGBTDW",324,0)
 S EXPDT=$$GET1^DIQ(392.7,DGBTIENS_",",8,"I")
"RTN","DGBTDW",325,0)
 I EXPDT="PENSION" Q 1
"RTN","DGBTDW",326,0)
 Q EXPDT'<DT
"RTN","DGBTDW",327,0)
DISPLAY ;
"RTN","DGBTDW",328,0)
 I $G(DGBTIENS)="" S DGBTIENS=$G(PASTYR($E(Y,1,3)))
"RTN","DGBTDW",329,0)
 I DGBTIENS="" Q
"RTN","DGBTDW",330,0)
 N AUTH,DENYDT
"RTN","DGBTDW",331,0)
 S AUTH=$$GET1^DIQ(392.7,DGBTIENS,3)
"RTN","DGBTDW",332,0)
 W !,"PATIENT: ",$$GET1^DIQ(392.7,DGBTIENS,2)
"RTN","DGBTDW",333,0)
 W !,"DEDUCTIBLE WAIVER REQUEST DATE: ",$$GET1^DIQ(392.7,DGBTIENS,.01)
"RTN","DGBTDW",334,0)
 W !,"DEDUCTIBLE WAIVER AUTHORIZED?: ",AUTH
"RTN","DGBTDW",335,0)
 W !,"DEDUCTIBLE WAIVER "
"RTN","DGBTDW",336,0)
 W $S(AUTH="YES":"GRANT",1:"DENI"),"ED BY: ",$$GET1^DIQ(392.7,DGBTIENS,4)
"RTN","DGBTDW",337,0)
 W !,"DEDUCTIBLE WAIVER "
"RTN","DGBTDW",338,0)
 W $S(AUTH="YES":"APPROV",1:"DENI"),"AL DATE: ",$$GET1^DIQ(392.7,DGBTIENS,5)
"RTN","DGBTDW",339,0)
 W !,"DEDUCTIBLE WAIVER ENTERED BY: ",$$GET1^DIQ(392.7,DGBTIENS,6)
"RTN","DGBTDW",340,0)
 W !,"DEDUCTIBLE WAIVER ENTRY DATE: ",$$GET1^DIQ(392.7,DGBTIENS,9)
"RTN","DGBTDW",341,0)
 W !,"DEDUCTIBLE WAIVER EXPIRATION DATE: "
"RTN","DGBTDW",342,0)
 S I=$$GET1^DIQ(392.7,DGBTIENS,8)
"RTN","DGBTDW",343,0)
 W $S(I?7N:$$UP^XLFSTR($$FMTE^XLFDT(I)),1:I)
"RTN","DGBTDW",344,0)
 W !,"DEDUCTIBLE WAIVER REMARKS: ",$$GET1^DIQ(392.7,DGBTIENS,7)
"RTN","DGBTDW",345,0)
 S DENYDT=$$GET1^DIQ(392.7,DGBTIENS,97)
"RTN","DGBTDW",346,0)
 I DENYDT'="" W !,"DEDUCTIBLE WAIVER DELETION DATE: ",DENYDT
"RTN","DGBTDW",347,0)
 D CLEAN^DILF
"RTN","DGBTDW",348,0)
 Q
"RTN","DGBTDW",349,0)
QUIT ;
"RTN","DGBTDW",350,0)
 D CLEAN^DILF
"RTN","DGBTDW",351,0)
 L
"RTN","DGBTDW",352,0)
 Q
"RTN","DGBTE")
0^3^B44311699
"RTN","DGBTE",1,0)
DGBTE ;ALB/SCK/BLD-BENEFICIARY TRAVEL SETUP/MAIN ENTRY CALL UP; 11/20/92@1000; 11/25/92
"RTN","DGBTE",2,0)
 ;;1.0;Beneficiary Travel;**2,19,20**;September 25, 2001;Build 185
"RTN","DGBTE",3,0)
START ;
"RTN","DGBTE",4,0)
 N TRNSMDE,REMARKS,CLMTYPE,INSTIT,SPMODE,DGBTCMTY,DGBTDIVI,DGBTDIV,DGBTDIVN,DGANS,DGBTINCA,DGBTDTY,DGBTAPPTYP,DGBTDCLM,IOM,PATCHDT
"RTN","DGBTE",5,0)
 ;DGBTINCA = Alternate Income
"RTN","DGBTE",6,0)
 K DGBTFDA,ERRMSG,DGBTX1,SGCOMPLETE
"RTN","DGBTE",7,0)
 ;
"RTN","DGBTE",8,0)
 D QUIT^DGBTEND  ; kill all variables
"RTN","DGBTE",9,0)
 D PATCH
"RTN","DGBTE",10,0)
 S PRCABN=1,IOP="HOME" D ^%ZIS K IOP
"RTN","DGBTE",11,0)
 S DGBTIME=300 S:'$D(DTIME) DTIME=DGBTIME S:'$D(U) U="^"
"RTN","DGBTE",12,0)
 ;   if date/time is undefined, set DT value
"RTN","DGBTE",13,0)
 I '$D(DT)#2 S %DT="",S="T" D ^%DT S DT=Y
"RTN","DGBTE",14,0)
DIVISN ; if MED CTR DIV file set up (first record) and record does not exist, write warning, kill variables, and exit
"RTN","DGBTE",15,0)
 S X=$G(^DG(40.8,0)) I X="" W !,"WARNING...MEDICAL CENTER DIVISION FILE IS NOT SET UP",!,"USE THE ADT PARAMETER OPTION FILE TO SET UP DIVISION" G EXIT
"RTN","DGBTE",16,0)
 ;  check if multi-divisional center (GL node exists and 2nd piece=1). Do lookup, if it exists-set local variables
"RTN","DGBTE",17,0)
 I $D(^DG(43,1,"GL")),$P(^("GL"),U,2) D  G:Y'>0 EXIT D PATIENT Q
"RTN","DGBTE",18,0)
 . S DIC="^DG(40.8,",DIC(0)="AEQMNZ",DIC("A")="Select DIVISION: " W !!
"RTN","DGBTE",19,0)
 . D ^DIC K DIC Q:Y'>0
"RTN","DGBTE",20,0)
 . S DGBTDIVI=+Y,DGBTDIV=$P(Y,U,2)
"RTN","DGBTE",21,0)
 . D INSTIT S DGBTMD=1
"RTN","DGBTE",22,0)
 ;  if not a multi-divisional center, default to institution name
"RTN","DGBTE",23,0)
 S DGBTDIVI=$O(^DG(40.8,0)),DGBTDIV=$P(^DG(40.8,DGBTDIVI,0),U) D INSTIT
"RTN","DGBTE",24,0)
 ;
"RTN","DGBTE",25,0)
PATIENT ; patient lookup, quit if patient doesn't exist
"RTN","DGBTE",26,0)
 N VAEL
"RTN","DGBTE",27,0)
 D QUIT^DGBTEND
"RTN","DGBTE",28,0)
 S DGBTOLD=0   ;PAVEL DGBT*1*20
"RTN","DGBTE",29,0)
 D QUIT1^DGBTEND ; kill local variables except med division vars
"RTN","DGBTE",30,0)
 S DGBTTOUT="",DIC="^DPT(",DIC(0)="AEQMZ",DIC("A")="Select PATIENT: "
"RTN","DGBTE",31,0)
 W !! D ^DIC K DIC I +Y'>0 D EXIT S DGANS="Q" Q
"RTN","DGBTE",32,0)
 ; get patient information#, call return patient return variables routine and set wether new claim or not
"RTN","DGBTE",33,0)
 S DFN=+Y D 6^VADPT,KVAR^DGBTEND,PID^VADPT
"RTN","DGBTE",34,0)
 S DGBTNEW=$S($D(^DGBT(392,"C",DFN)):0,1:1)
"RTN","DGBTE",35,0)
 S SPCOMPLETE=0,DGBTAPPTYP=0
"RTN","DGBTE",36,0)
 S DGBTNSC=$$NSC^DGBTUTL
"RTN","DGBTE",37,0)
 ;
"RTN","DGBTE",38,0)
 ;next 2 lines were added by the BT Dashboard project(DGBT*1.0*19) and Integrated into DGBTE by BLD for DGBT*1.0*20
"RTN","DGBTE",39,0)
 S ^XTMP("DGBT BTD",0)=$$DT^XLFDT_"^"_$$DT^XLFDT
"RTN","DGBTE",40,0)
 S ^XTMP("DGBT BTD","CLAIMERS",$G(DUZ,-1))=$G(DFN,-1)
"RTN","DGBTE",41,0)
 ;
"RTN","DGBTE",42,0)
OLDCLAIM ;  find any past claims through DGBTE1 call
"RTN","DGBTE",43,0)
 D ^DGBTE1 I '$D(DGBTA) D PATIENT Q  ; set to call test routine, call old claims
"RTN","DGBTE",44,0)
 I '$D(^DG(43,1,"BT"))!('$D(^DG(43.1,$O(^DG(43.1,(9999999.9999999-DGBTDT))),"BT"))) D  D EXIT2 Q
"RTN","DGBTE",45,0)
 . ;  check for certifying official and that current (or past) FY deductable is set up 
"RTN","DGBTE",46,0)
 . W !!,"***WARNING...BENE TRAVEL PARAMETERS HAVE NOT BEEN SET UP",!,"USE THE BENEFICIARY TRAVEL PARAMETER RATES ENTER/EDIT OPTION TO PROPERLY INITIALIZE"
"RTN","DGBTE",47,0)
 ;
"RTN","DGBTE",48,0)
COREFLS ;  coreFLS vendor interface active/inactive
"RTN","DGBTE",49,0)
 S DGBTCORE=$P($G(^DG(43,1,"BT")),U,4)
"RTN","DGBTE",50,0)
 ;
"RTN","DGBTE",51,0)
SCREEN ;  display B/T claim information through screen1
"RTN","DGBTE",52,0)
 N DGBTQUIT
"RTN","DGBTE",53,0)
 D SCREEN^DGBT1 I $G(DGBTQUIT) D:'$G(CHZFLG) EXIT2,PATIENT D:$G(CHZFLG) EXIT,PATIENT Q
"RTN","DGBTE",54,0)
 Q:$G(ENDMENU)
"RTN","DGBTE",55,0)
 S:$D(^DGBT(392,DGBTDT,"SP")) SPCOMPLETE=1
"RTN","DGBTE",56,0)
 I '+VAEL(1) W !!,"Eligibility is missing from registration and is required to continue.",*7 D EXIT2 Q
"RTN","DGBTE",57,0)
 I $G(DGANS)="I" Q     ;BLD DG*1*20
"RTN","DGBTE",58,0)
 S DIR("A")="Continue processing claim",DIR("?")="Sorry, enter 'Y'es or RETURN to continue procesing claim, 'N'o to exit",DIR(0)="Y",DIR("B")="YES"
"RTN","DGBTE",59,0)
 D ^DIR S ANS=Y K DIR
"RTN","DGBTE",60,0)
 I 'ANS S SPCOMPLETE=0 D EXIT2,CLEANUP^DGBTSP,PATIENT S DGANS="Q" Q    ;BLD DG*1*20
"RTN","DGBTE",61,0)
 N DGBTELL S DGBTELL=$$ELIG^DGBTUTL1(DFN) ;PAVEL DGBT*1.0*20
"RTN","DGBTE",62,0)
 I +$G(DGBTELL)'=14,(+$G(DGBTELL)'=15) W !!," Eligible: ",$P(DGBTELL,U,2),!!
"RTN","DGBTE",63,0)
 I +$G(DGBTELL)=15 W !!,"Not Eligible: ",$P(DGBTELL,U,2),!!
"RTN","DGBTE",64,0)
 I +DGBTELL=14 S:'$G(CHZFLG) DGBTTOUT=-1,DGBTOLD=0 G DELETE1^DGBTEND ;User exit with ^  so delete the claim   !!??
"RTN","DGBTE",65,0)
 D  ;Store Result of E7 in fields 43.1  43.2
"RTN","DGBTE",66,0)
 .K FDA,ERRMSG
"RTN","DGBTE",67,0)
 .S FDA(392,DGBTDTI_",",43)=$G(DGBTCPAP)
"RTN","DGBTE",68,0)
 .S FDA(392,DGBTDTI_",",43.1)=+$G(DGBTELL)
"RTN","DGBTE",69,0)
 .S FDA(392,DGBTDTI_",",43.4)=$G(DGBTSCAP)
"RTN","DGBTE",70,0)
 .S FDA(392,DGBTDTI_",",43.5)=$G(DGBTQAP)
"RTN","DGBTE",71,0)
 .S:$L($P(DGBTELL,": ",2)) FDA(392,DGBTDTI_",",43.2)=$P($G(DGBTELL),": ",2,99)
"RTN","DGBTE",72,0)
 .D FILE^DIE("EKTS","FDA","ERRMSG") ;
"RTN","DGBTE",73,0)
 .I $D(ERRMSG),ERRMSG("DIERR",1,"TEXT",1)["The record is currently locked" W !!,"The patients record is current locked..."
"RTN","DGBTE",74,0)
 I $D(ERRMSG) D EXIT Q
"RTN","DGBTE",75,0)
 ;
"RTN","DGBTE",76,0)
 ;the following question is for E1 in patch DGBT*1.0*20
"RTN","DGBTE",77,0)
 ;
"RTN","DGBTE",78,0)
SPMODE ;BLD DGBT*1*20 - SPMODE line tag will display question whether or special mode claim or mileage claim
"RTN","DGBTE",79,0)
 ; CLMTYP = type of BT claim, Milage or Special Mode
"RTN","DGBTE",80,0)
 ;
"RTN","DGBTE",81,0)
 S (SPCOMPLETE,DGBTSP)=0
"RTN","DGBTE",82,0)
 D EN^DGBTSP(.DGBTSP) I $D(DTOUT)!($D(DUOUT)) K:$G(DGBTTOUT)=-1&($G(CHZFLG)=0) ^DGBT(392,DGBTDTI,"A") D:'$G(SPCOMPLETE) EXIT2 D:$G(SPCOMPLETE) CLEANUP^DGBTSP D PATIENT,EXIT Q 
"RTN","DGBTE",83,0)
 I +DGBTELL=15 D  I $G(DGBTTOUT)=-1  D:$G(DGBTTOUT)=-1&($G(CHZFLG)=0) EXIT2 D:$G(DGBTTOUT)=-1&($G(CHZFLG)) EXIT D PATIENT,EXIT Q
"RTN","DGBTE",84,0)
 .W !!,"CLAIM HAS BEEN DENIED AND DENIAL OF BENEFITS LETTER WILL BE ISSUED"
"RTN","DGBTE",85,0)
 .D DGBTDR^DGBTDLT Q:$G(DGBTTOUT)=-1
"RTN","DGBTE",86,0)
 .W !!,"PLEASE COMPLETE THE INVOICE INFORMATION." H 2
"RTN","DGBTE",87,0)
 S DA=DGBTDT,DIE="^DGBT(392,",DR="11///"_DGBTDIVI S:'$G(CHZFLG) DR=DR_";12////"_DUZ_";13///"_DT D ^DIE
"RTN","DGBTE",88,0)
 I DGBTCMTY="S" D RESTART^DGBTSP(DGBTCMTY) I $D(DTOUT)!($D(DUOUT))!('$G(SPCOMPLETE)) S:'$G(SPCOMPLTE) DGBTTOUT=-1 D:'$G(SPCOMPLETE) EXIT2 D:$G(SPCOMPLETE) CLEANUP^DGBTSP D PATIENT,EXIT Q 
"RTN","DGBTE",89,0)
 ;
"RTN","DGBTE",90,0)
SCREEN2 ;
"RTN","DGBTE",91,0)
 I $G(DGBTSP)=0&('$D(^DGBT(392,"C",DFN,DGBTDTI))) D CLEANUP^DGBTSP,EXIT2 Q
"RTN","DGBTE",92,0)
 I $G(DFN)=""&($G(DGBTSP)=0) D PATIENT Q
"RTN","DGBTE",93,0)
 D SCREEN^DGBT2
"RTN","DGBTE",94,0)
COMPLT ;  complete claims processing
"RTN","DGBTE",95,0)
 ;
"RTN","DGBTE",96,0)
 I DGBTCMTY="M" S SPCOMPLETE=0
"RTN","DGBTE",97,0)
 I $G(SPCOMPLETE)=1 W !!,"Complete claim for ",DGBTDTE_" " S %=1 D YN^DICN S:%=2 SPCOMPLETE=0 K:%=2&(CHZFLG=0) ^DGBT(392,DGBTDTI,"A") I %'=1 D:%<1 HELP1 D:%<1 COMPLT D:(%=2)&($G(SPCOMPLETE)=0) EXIT2,PATIENT Q
"RTN","DGBTE",98,0)
 ;
"RTN","DGBTE",99,0)
 I $G(DGBTCMTY)="M" D  G:(%=2)&($G(DGBTSP)=0) EXIT G:%=2 EXIT3 G:%=-1 EXIT2 D:%<1 HELP1 G:%<1 COMPLT
"RTN","DGBTE",100,0)
 .S DA=DGBTDT,DIE="^DGBT(392,",DR="11///"_DGBTDIVI S:'$G(CHZFLG) DR=DR_";12////"_DUZ_";13///"_DT D ^DIE S %=1
"RTN","DGBTE",101,0)
 .W !!,"Complete claim for ",DGBTDTE D YN^DICN S:%=2 %=-1 S:%=-1&($G(CHZFLG)=0) DGBTTOUT=-1
"RTN","DGBTE",102,0)
 I $D(DGBTSP)>1 D FILE^DGBTSP1(.SPCOMPLETE) S NOLINE=1 D:$G(DGBTSP)=0 PATIENT D:$G(DGBTSP)=1 SCREEN^DGBTCDSP D EXIT D:$G(DGANS) PATIENT Q
"RTN","DGBTE",103,0)
 I $G(DGBTCMTY)="M" F I="SP","SPAD" K ^DGBT(392,DGBTDT,I)  ;clean up special mode if during an edit user switches from special mode to mileage
"RTN","DGBTE",104,0)
 I $G(SPCOMPLETE)=1&(DGBTCMTY'="M") D EXIT Q
"RTN","DGBTE",105,0)
 D SCREEN^DGBTEE
"RTN","DGBTE",106,0)
 I $G(DGBTTOUT)=-1,$G(DGBTCMTY)="M" G DELETE1^DGBTEND ;PAVEL DGBT*1*20
"RTN","DGBTE",107,0)
 G:$G(DGBTTOUT)=-1 EXIT3
"RTN","DGBTE",108,0)
 D ^DGBTEND
"RTN","DGBTE",109,0)
 Q
"RTN","DGBTE",110,0)
HELP1 ; 
"RTN","DGBTE",111,0)
 W !!?10,$S(%=-1:"SORRY, '^' NOT ALLOWED",1:"ENTER 'Y'ES OR 'N'O")
"RTN","DGBTE",112,0)
 Q
"RTN","DGBTE",113,0)
INSTIT ;  check for pointer to institution file and for address information on institution
"RTN","DGBTE",114,0)
 S DGBTDIVN=$P(^DG(40.8,DGBTDIVI,0),"^",7)
"RTN","DGBTE",115,0)
 I 'DGBTDIVN W !!,"INSTITUTION HAS NOT BEEN DEFINED FOR ",$P(^(0),"^"),!,"USE THE ADT PARAMETER OPTION TO UPDATE",! Q
"RTN","DGBTE",116,0)
 I $D(^DIC(4,DGBTDIVN,0)),$S($D(^(1))#10=0:1,$P(^(1),"^",3)']"":1,1:0) W !!,"INSTITUTION ADDRESS NOT ENTERED.  PLEASE UPDATE USING THE INSTITUTION FILE ENTER/EDIT",! Q
"RTN","DGBTE",117,0)
 Q
"RTN","DGBTE",118,0)
EXIT ; kills off all variables before quitting
"RTN","DGBTE",119,0)
 I $D(DGANS) D QUIT^DGBTEND Q
"RTN","DGBTE",120,0)
 I $G(DGBTCMTY)="S" D END^DGBTCDSP Q
"RTN","DGBTE",121,0)
 D QUIT^DGBTEND Q
"RTN","DGBTE",122,0)
 Q
"RTN","DGBTE",123,0)
EXIT2 ; delete claim through DIK call, return to patient label
"RTN","DGBTE",124,0)
 D DELETE1^DGBTEND
"RTN","DGBTE",125,0)
 Q
"RTN","DGBTE",126,0)
EXIT3 ;
"RTN","DGBTE",127,0)
 I $G(DGBTCMTY)="S" S:$D(^DGBT(392,DGBTDT,"SP")) DGBTTOUT="" D DELETE1^DGBTEND Q
"RTN","DGBTE",128,0)
 I $D(^DGBT(392,DGBTDT,"A")) S DGBTTOUT=""
"RTN","DGBTE",129,0)
 D DELETE^DGBTEND
"RTN","DGBTE",130,0)
 Q
"RTN","DGBTE",131,0)
 ;
"RTN","DGBTE",132,0)
PATCH ;this return the date DGBT*1.0*20 was first loaded
"RTN","DGBTE",133,0)
 ;
"RTN","DGBTE",134,0)
 N PATCHNBR
"RTN","DGBTE",135,0)
 S PATCHNBR=$O(^XPD(9.7,"B","DGBT*1.0*20",""))
"RTN","DGBTE",136,0)
 S PATCHDT=$P(^XPD(9.7,PATCHNBR,0),"^",3)
"RTN","DGBTE",137,0)
 Q
"RTN","DGBTE1")
0^19^B29349842
"RTN","DGBTE1",1,0)
DGBTE1 ;ALB/SCK/GAH - BENEFICIARY TRAVEL FIND OLD CLAIM DATES; 10/10/06@11:17am; 10/10/06
"RTN","DGBTE1",2,0)
 ;;1.0;Beneficiary Travel;**8,12,13,20**;September 25, 2001;Build 185
"RTN","DGBTE1",3,0)
DATE ;  get date for claim, either new or past date
"RTN","DGBTE1",4,0)
 N DGBTDCLM
"RTN","DGBTE1",5,0)
 K ^TMP("DGBT",$J),^TMP("DGBTARA",$J),DIR
"RTN","DGBTE1",6,0)
 I 'DGBTNEW S DIR("A",2)="Enter a 'P' to display Past CLAIM dates for editing."
"RTN","DGBTE1",7,0)
 S DIR("A",3)="Time is required when adding a new CLAIM.",DIR("A",4)="",DIR("A",1)="",DIR("A")="Select TRAVEL CLAIM DATE/TIME",DIR("?")="^D HELP^DGBTE1A"
"RTN","DGBTE1",8,0)
 S DIR(0)="F",DIR("B")="NOW" D ^DIR K DIR G ERR1:$D(DIRUT)
"RTN","DGBTE1",9,0)
 S CHZFLG=0,%DT="EXR",DTSUB=$S(Y="N":"NOW",Y="P":"OLD",Y="p":"OLD",1:"OTHR")_"^DGBTE1A" D @DTSUB   ;PAVEL - DGBT*1*20
"RTN","DGBTE1",10,0)
 S:$P(DTSUB,U,1)="OLD"&(Y1>0) DGBTOLD=1 K DTSUB        ;PAVEL DGBT*1*20
"RTN","DGBTE1",11,0)
 G ERR1:$D(DTOUT),DATE:Y1<0 S DGBTA=Y1 G SET:CHZFLG    ;PAVEL DGBT*1*20
"RTN","DGBTE1",12,0)
DATE1 ;  for past claims, set DGBTDT to inverse date of claim date
"RTN","DGBTE1",13,0)
 I $D(^DGBT(392,"C",DFN)) D
"RTN","DGBTE1",14,0)
 . S DGBTC=0,DGBTDT=9999999-$E(DGBTA,1,7) ; set past claims counter=0
"RTN","DGBTE1",15,0)
 . ; for latest date (topmost) search for past claims
"RTN","DGBTE1",16,0)
 . F I=DGBTDT:0 S I=$O(^DGBT(392,"AI",DFN,I)) Q:'I!(I>(DGBTDT_.99999))  S DGBTC=DGBTC+1,DGBT(DGBTC)=9999999.99999-I
"RTN","DGBTE1",17,0)
 I '$D(DGBT) G LOCK
"RTN","DGBTE1",18,0)
 W !!,"There are other claims on this date.",!,"Select by number to edit or <RETURN> to add a new CLAIM.",!
"RTN","DGBTE1",19,0)
 ; convert inverse claim date to external format through VADATE conversion routine
"RTN","DGBTE1",20,0)
 F I=0:0 S I=$O(DGBT(I)) Q:'I  D
"RTN","DGBTE1",21,0)
 .S DGBTDCLM=$$GET1^DIQ(392,DGBT(I),45,"I")
"RTN","DGBTE1",22,0)
 .S VADAT("W")=DGBT(I) D ^VADATE W !?5,I,".",?10,VADATE("E")_$S($G(DGBTDCLM)'="":" (D)",1:"")
"RTN","DGBTE1",23,0)
 K DIR S DIR("A")="Select 1"_$S(DGBTC=1:"",1:"-"_DGBTC)_", or <RETURN> to add a new claim: ",DIR(0)="NOA^1:"_DGBTC,DIR("?")="Select, by number, one of the displayed claim dates: "
"RTN","DGBTE1",24,0)
 D ^DIR K DIR S:$G(Y) CHZFLG=1 G QUIT^DGBTEND:$D(DTOUT)!($D(DUOUT))
"RTN","DGBTE1",25,0)
 G LOCK:Y="" G DATE:'$D(DGBT(Y))
"RTN","DGBTE1",26,0)
 S DGBTA=DGBT(Y),DGBTOLD=1 G SET
"RTN","DGBTE1",27,0)
LOCK ;
"RTN","DGBTE1",28,0)
 L +^DGBT(392,DGBTA):1
"RTN","DGBTE1",29,0)
 I '$T!$D(^DGBT(392,DGBTA)) L  S DGBTA=DGBTA+.00001 G LOCK
"RTN","DGBTE1",30,0)
 S (DGBTDT,VADAT("W"))=DGBTA D ^VADATE W VADATE("E")      ;for CCR235 by RE
"RTN","DGBTE1",31,0)
ASKADD ;
"RTN","DGBTE1",32,0)
 W !!,"Are you sure you want to add a new claim"
"RTN","DGBTE1",33,0)
 S %=1 D YN^DICN G EXIT2^DGBTE:%<0!(%=2)
"RTN","DGBTE1",34,0)
 I '% W !!,"Enter 'YES' to add a new claim, or 'NO' not to add the claim." G ASKADD
"RTN","DGBTE1",35,0)
 K DD,DO
"RTN","DGBTE1",36,0)
 ; create new file entry, stuff patient DFN into name field(pointer)
"RTN","DGBTE1",37,0)
 S (X,DINUM)=DGBTA,DIC="^DGBT(392,",DIC(0)="L",DIC("DR")="2////"_DFN
"RTN","DGBTE1",38,0)
 D FILE^DICN K DIC L
"RTN","DGBTE1",39,0)
 ; go back to patient if no file entry
"RTN","DGBTE1",40,0)
 G:Y'>0 PATIENT^DGBTE
"RTN","DGBTE1",41,0)
SET ; call inhouse generic date routine
"RTN","DGBTE1",42,0)
 S (DA,DGBTDT,VADAT("W"))=DGBTA D ^VADATE
"RTN","DGBTE1",43,0)
 ; get internal and external formats of converted inverse dates
"RTN","DGBTE1",44,0)
 S DGBTDTI=$S($G(VADAT("W"))'="":VADAT("W"),1:VADATE("I")),DGBTDTE=VADATE("E") K VADAT,VADATE,DIC,Y
"RTN","DGBTE1",45,0)
 I $G(DGBTDIVI)'="" S DGBTDIVN=$P(^DG(40.8,DGBTDIVI,0),"^",7)
"RTN","DGBTE1",46,0)
 D GA^DGBTUTL(DFN,"DGBTINCA",DGBTDTI) ;Get Alternate Income PAVEL
"RTN","DGBTE1",47,0)
STUFF ;  stuff departure with address data from patient file, dest from institution file
"RTN","DGBTE1",48,0)
 S DGBTCMTY=$$GET1^DIQ(392,DGBTDT,56)
"RTN","DGBTE1",49,0)
 S:'$L(DGBTCMTY) DGBTCMTY="M"
"RTN","DGBTE1",50,0)
 I '$G(CHZFLG),DGBTCMTY="M" S:'$D(^DGBT(392,DGBTDT,"D")) ^DGBT(392,DGBTDT,"D")=VAPA(1)_"^"_VAPA(2)_"^"_VAPA(3)_"^"_VAPA(4)_"^"_$S(VAPA(5)]"":+VAPA(5),1:"")_"^"_$P(VAPA(11),U,1)
"RTN","DGBTE1",51,0)
 I '$G(CHZFLG),DGBTCMTY="M" I '$D(^DGBT(392,DGBTDT,"T")) D
"RTN","DGBTE1",52,0)
 . S X=$S($D(^DIC(4,DGBTDIVN,1)):^(1),1:"")
"RTN","DGBTE1",53,0)
 . S ^DGBT(392,DGBTDT,"T")=($P(^DG(40.8,DGBTDIVI,0),U)_"^"_$P(X,U)_"^"_$P(X,U,2)_"^"_$P(X,U,3)_"^"_$P(^DIC(4,DGBTDIVN,0),U,2)_"^"_$P(X,U,4))
"RTN","DGBTE1",54,0)
CHKFILES ; section removed, dependents picked up below in MEANS ; abr 10/94
"RTN","DGBTE1",55,0)
MEANS ;  find corres. means test entry, gets MT income, status, no. of dependents
"RTN","DGBTE1",56,0)
 ;DGBTMTS= MT Status;  DGBTCSC= claim Service Connected indicator & %;  DGBTELG=Eligibility status
"RTN","DGBTE1",57,0)
 N X,X2,X3,Y,DGBTIFL
"RTN","DGBTE1",58,0)
 S X=$$LST^DGMTCOU1(DFN,DT,3),DGBTMTS=$P(X,U,4)_U_$P(X,U,3) ; returns corres. MT info,X=IEN of last MT. passing a 3 will check both MT and RX Co-Pays
"RTN","DGBTE1",59,0)
 ; get income, # dependents
"RTN","DGBTE1",60,0)
 S Y=$$INCOME^VAFMON(DFN,DGBTA,1)
"RTN","DGBTE1",61,0)
 S:"I^V"[$P(Y,U,2) Y=U ;If income type is I or V ignore it PAVEL
"RTN","DGBTE1",62,0)
 S:DGBTINCA Y=$P(DGBTINCA,U,2)_U_$E($P(DGBTINCA,U,4)) ;Set Alternate Income
"RTN","DGBTE1",63,0)
 S X=$P(Y,U),DGBTIFL=$P(Y,U,2) ; returns income & source.
"RTN","DGBTE1",64,0)
 I X?1N.E!(X<0) D
"RTN","DGBTE1",65,0)
 .I X<0 S X=0
"RTN","DGBTE1",66,0)
 .S X2="0$",X3=8 D COMMA^%DTC
"RTN","DGBTE1",67,0)
 S DGBTINC=X_U_$G(DGBTIFL) K X,X2
"RTN","DGBTE1",68,0)
 S DGBTDEP=$$DEP^VAFMON(DFN,DGBTA) ; finds depedents Vet, Spouse, Children
"RTN","DGBTE1",69,0)
 S DGBTDTY=" (Year: "_$$FMTE^XLFDT($E(DGBTDTI,1,3)_"0000")_")" ;Year to be displayed with Income
"RTN","DGBTE1",70,0)
 S DGBTMTTH=$$MTTH^DGBTMTTH(DGBTDEP,DGBTDTI) ; Means test threshold
"RTN","DGBTE1",71,0)
 S DGBTRXTH=+$$THRES^IBARXEU1(DGBTDTI,1,DGBTDEP) ; RX co-pay threshhold
"RTN","DGBTE1",72,0)
 S DGBTDYFL=$$DAYFLAG^DGBTUTL ; valid income test y/n
"RTN","DGBTE1",73,0)
 ;
"RTN","DGBTE1",74,0)
PREV ; if past claim get SC%, elig.
"RTN","DGBTE1",75,0)
 I CHZFLG S X=^DGBT(392,DGBTA,0),DGBTELG=$P(X,U,3),DGBTCSC=$P(X,U,4) D
"RTN","DGBTE1",76,0)
 . S:DGBTCSC DGBTCSC=1_U_DGBTCSC S:'DGBTCSC DGBTCSC=0
"RTN","DGBTE1",77,0)
 . S:DGBTELG DGBTELG=DGBTELG_U_$P(^DIC(8,DGBTELG,0),U)
"RTN","DGBTE1",78,0)
CERT ;  get last BT certification,  get date, then get eligibility
"RTN","DGBTE1",79,0)
 I $D(^DGBT(392.2,"C",DFN)) D
"RTN","DGBTE1",80,0)
 .;cd=cert date in inverse then external format, ce= eligibility, ca* = amt certified
"RTN","DGBTE1",81,0)
 . S DGBTCD=$O(^DGBT(392.2,"C",DFN,0)),DGBTCE=$P(^DGBT(392.2,DGBTCD,0),"^",3)
"RTN","DGBTE1",82,0)
 . S DGBTCA=$P(^DGBT(392.2,DGBTCD,0),"^",4),Y=9999999-$P(DGBTCD,".")
"RTN","DGBTE1",83,0)
 . X ^DD("DD") ; date conversion, y=cert date (internal)
"RTN","DGBTE1",84,0)
 . S DGBTCD=Y,X=DGBTCA,X2="0$",X3=8 K Y D COMMA^%DTC S DGBTCA=X K X,X2,X3
"RTN","DGBTE1",85,0)
APPTS ;  search patient file for appointments through claim date (DTI+1),  adddates to array DGBTCL 
"RTN","DGBTE1",86,0)
 N ERRCODE,DGARRAY,CLIEN,APTDT S DGARRAY("FLDS")="2;3;10;18"
"RTN","DGBTE1",87,0)
 S DGARRAY(4)=DFN,I=$$SDAPI^SDAMA301(.DGARRAY)
"RTN","DGBTE1",88,0)
 ; I<0 = Error, I<0 = # of Records retrieved
"RTN","DGBTE1",89,0)
 I I<0 S ERRCODE=$O(^TMP($J,"SDAMA301","")),I1=1,DGBTCL("ERROR")=^TMP($J,"SDAMA301",ERRCODE)
"RTN","DGBTE1",90,0)
 I I>0 D
"RTN","DGBTE1",91,0)
 .S CLIEN=""
"RTN","DGBTE1",92,0)
 .F  S CLIEN=$O(^TMP($J,"SDAMA301",DFN,CLIEN)) Q:'CLIEN  D
"RTN","DGBTE1",93,0)
 ..S APTDT=DGBTDTI\1
"RTN","DGBTE1",94,0)
 ..F  S APTDT=$O(^TMP($J,"SDAMA301",DFN,CLIEN,APTDT)) Q:'APTDT!(APTDT>(DGBTDTI+1))  D
"RTN","DGBTE1",95,0)
 ...S SDATA=^TMP($J,"SDAMA301",DFN,CLIEN,APTDT)
"RTN","DGBTE1",96,0)
 ...S DGBTCL(APTDT)=$P($P(^TMP($J,"SDAMA301",DFN,CLIEN,APTDT),U,2),";",2)_U_$P($P(SDATA,U,3),";")
"RTN","DGBTE1",97,0)
 ...S DGBTCL(APTDT)=DGBTCL(APTDT)_U_$P($P(SDATA,U,18),";")_U_$P($P(SDATA,U,10),";")
"RTN","DGBTE1",98,0)
 K ^TMP($J,"SDAMA301"),DGARRAY,CLIEN,APTDT
"RTN","DGBTE1",99,0)
EXIT ; exit routine
"RTN","DGBTE1",100,0)
 Q
"RTN","DGBTE1",101,0)
ERR1 ;  error condition
"RTN","DGBTE1",102,0)
 G QUIT^DGBTEND Q
"RTN","DGBTE1A")
0^20^B10407793
"RTN","DGBTE1A",1,0)
DGBTE1A ;ALB/SCK - BENEFICIARY TRAVEL FIND OLD CLAIMS PART 2; 1/22/93@1530
"RTN","DGBTE1A",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTE1A",3,0)
 ;
"RTN","DGBTE1A",4,0)
 ;
"RTN","DGBTE1A",5,0)
 Q
"RTN","DGBTE1A",6,0)
NOW ; date/time entry for NOW
"RTN","DGBTE1A",7,0)
 S (Y,Y1)=$$NOW^XLFDT()
"RTN","DGBTE1A",8,0)
 Q
"RTN","DGBTE1A",9,0)
OTHR ; date/time entry for manually entered date
"RTN","DGBTE1A",10,0)
 S %DT(0)="-NOW" D ^%DT S Y1=Y K %DT,%DT(0)
"RTN","DGBTE1A",11,0)
 Q
"RTN","DGBTE1A",12,0)
OLD ; date/time entry for select from past dates 
"RTN","DGBTE1A",13,0)
LIST2 ;  find all previous claims, get total count in DGBTC and put those claims in utility file
"RTN","DGBTE1A",14,0)
 N X1,YY,DGBTDCLM
"RTN","DGBTE1A",15,0)
 S (DGBTC,DGBTCH,DGBTCH1)=0
"RTN","DGBTE1A",16,0)
 F I=0:0 S I=$O(^DGBT(392,"AI",DFN,I)) Q:'I  S DGBTC=DGBTC+1,^TMP("DGBT",$J,DGBTC,I)=9999999.99999-I ; order through claim file
"RTN","DGBTE1A",17,0)
 I '$D(^TMP("DGBT",$J))!('$D(^DGBT(392,"C",DFN))) W !!?10,"There are no entries on file for this patient",! S Y1=-1 G EXIT
"RTN","DGBTE1A",18,0)
 ;  build temporary global array using dates in utility file, converted to external format dates 
"RTN","DGBTE1A",19,0)
 F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  F J=0:0 S J=$O(^TMP("DGBT",$J,I,J)) Q:'J  S K=I,VADAT("W")=^(J) D ^VADATE S DGBTDCLM=$$GET1^DIQ(392,VADAT("W"),45,"I") S ^TMP("DGBTARA",$J,K)=VADATE("E")_$S($G(DGBTDCLM)'="":" (D)",1:"")
"RTN","DGBTE1A",20,0)
LIST3 ;  list claims (in external format) from temporary global, 5 at a time. Loop thru list until selection made.
"RTN","DGBTE1A",21,0)
 S DGBTCH=1 W ! F X1=1:1:DGBTC W !?5,X1,".",?10,^TMP("DGBTARA",$J,X1) I X1#5=0!(X1=DGBTC) D CHOZ I $D(DUOUT)!$D(DTOUT)!(Y>0) S Y1=$S(+Y>0:Y,1:-1) K DIR Q
"RTN","DGBTE1A",22,0)
 G:'$D(DTOUT)&Y="" LIST3
"RTN","DGBTE1A",23,0)
  S Y1=$S(+Y>0:Y,1:-1) K DIR
"RTN","DGBTE1A",24,0)
EXIT ;
"RTN","DGBTE1A",25,0)
 K X1,YY,DGBTCHK,^TMP("DGBT",$J),^TMP("DGBTARA",$J)
"RTN","DGBTE1A",26,0)
 Q
"RTN","DGBTE1A",27,0)
CHOZ ;  select from the displayed past claims dates for claim to be edited.
"RTN","DGBTE1A",28,0)
 W !! S (Y1,Y)=0,DGBTCH1=X1,DIR(0)="FO^1:5",DIR("A")="Select CLAIM"
"RTN","DGBTE1A",29,0)
 S DIR("A",1)="Type '^' to exit date list, or <RETURN> to display more dates"
"RTN","DGBTE1A",30,0)
 S DIR("?")="Entering a '^' will exit the Past CLAIM list, entering <RETURN> will continue to scroll through past dates.",DIR("?",1)="Select a Past CLAIM date by number, or enter 'N' for NOW."
"RTN","DGBTE1A",31,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S Y1=-1 Q
"RTN","DGBTE1A",32,0)
 I Y="N"!(Y="n") W "   " D NOW Q
"RTN","DGBTE1A",33,0)
 Q:Y=""
"RTN","DGBTE1A",34,0)
 I X<DGBTCH!(X>DGBTCH1)!(X'=+X) W !?25,*7,"INVALID ENTRY!" G CHOZ ; value must be between 1 and last displayed number
"RTN","DGBTE1A",35,0)
 I X,$D(^TMP("DGBT",$J,X)) S Y=$O(^TMP("DGBT",$J,X,0)),Y=^TMP("DGBT",$J,X,Y),CHZFLG=1
"RTN","DGBTE1A",36,0)
 Q
"RTN","DGBTE1A",37,0)
HELP ;
"RTN","DGBTE1A",38,0)
 S %DT="EXR" D ^%DT
"RTN","DGBTE1A",39,0)
 W !!,"Time is required when adding a new CLAIM date.",!,"If there is more than one claim per date, select by number to edit."
"RTN","DGBTE1A",40,0)
 Q
"RTN","DGBTE1A",41,0)
 ;
"RTN","DGBTE1A",42,0)
HELP1 ;
"RTN","DGBTE1A",43,0)
 S %DT="EX" D ^%DT
"RTN","DGBTE1A",44,0)
 W !!,"Enter date invoice was received. Can not be a future date."
"RTN","DGBTE1A",45,0)
 Q
"RTN","DGBTEE")
0^4^B60372352
"RTN","DGBTEE",1,0)
DGBTEE ;ALB/SCK - BENEFICIARY TRAVEL ENTER/EDIT; 12/3/92@1600 ;12/15/11  11:17
"RTN","DGBTEE",2,0)
 ;;1.0;Beneficiary Travel;**2,14,20**;September 25, 2001;Build 185
"RTN","DGBTEE",3,0)
 Q
"RTN","DGBTEE",4,0)
SCREEN ;
"RTN","DGBTEE",5,0)
 ;
"RTN","DGBTEE",6,0)
 D SCREEN^DGBTEE1 Q:$G(DGBTTOUT)=-1!($G(DGBTTOUT)=1)  Q:'$D(^DGBT(392,DGBTDT,0))
"RTN","DGBTEE",7,0)
 ;  The following section of code moved to DGBTEE2 for space problems
"RTN","DGBTEE",8,0)
 D STUFF^DGBTEE2
"RTN","DGBTEE",9,0)
MILES ;  get miles between dep. and dest. using function call to DGBTUTL
"RTN","DGBTEE",10,0)
 ;
"RTN","DGBTEE",11,0)
 K X,DGBTREC S (DGBTOWRT,DGBTML,DGBTMLT)=""
"RTN","DGBTEE",12,0)
 I DGBTFR4]""&((DGBTACCT=4)!(DGBTACCT=5)) I $D(^DGBT(392.1,"ACS",DGBTFR4,+VAPA(5))) D
"RTN","DGBTEE",13,0)
 . S X=$O(^(+VAPA(5),0)) ; naked ref. refers to file #392.1, "ACS", city.  Full reference on line MILES+2^DGBTEE, ^DGBTE(392.1,"ACS",DGBTFR4,+VAPA(5)
"RTN","DGBTEE",14,0)
 . ;  function $$miles passes city's record# and div name to function, mileage value is returned
"RTN","DGBTEE",15,0)
 . I X'="" S DGBTREC=X,DGBTML=$$MILES^DGBTUTL(DGBTREC,DGBTDV1),DGBTOWRT="ROUND TRIP" K X
"RTN","DGBTEE",16,0)
 S (DGBTMAL,DGBTFAB,DGBTME,DGBTCP,DGBTFLAG,DGBTDCV,DGBTDE,DGBTDCM,DGBTDPV,DGBTDPM)=0
"RTN","DGBTEE",17,0)
DIE1 ;  stuff from,to address, meals, ferry's/bridges
"RTN","DGBTEE",18,0)
 ;
"RTN","DGBTEE",19,0)
 Q:'$D(^DGBT(392,DGBTDT,0))
"RTN","DGBTEE",20,0)
 ;
"RTN","DGBTEE",21,0)
 S DIE="^DGBT(392,",DA=DGBTDT,DR=$S($G(DGBTACCT)=4:"42//"_$G(DGBTAP),$G(DGBTACCT)=5:"43;S DGBTCP=X;42//"_$G(DGBTAP),1:"44")
"RTN","DGBTEE",22,0)
 D ^DIE I X=""!(X="^") S DGBTTOUT=-1 Q
"RTN","DGBTEE",23,0)
 ;
"RTN","DGBTEE",24,0)
 S DR="21////^S X=DGBTFR1;22////^S X=DGBTFR2;23////^S X=DGBTFR3;24////^S X=DGBTFR4;25////^S X=DGBTTO1;26////^S X=DGBTTO2;27////^S X=DGBTTO3;28////^S X=DGBTTO4" ;;34////^S X=DGBTMAL;35////^S X=DGBTFAB"
"RTN","DGBTEE",25,0)
 D ^DIE I X=""!(X="^") S DGBTTOUT=-1 Q
"RTN","DGBTEE",26,0)
 ;
"RTN","DGBTEE",27,0)
 I DGBTACCT=4!(DGBTACCT=5) D
"RTN","DGBTEE",28,0)
 . W !!,"Please wait, Checking Mileage ..."
"RTN","DGBTEE",29,0)
 .S DGBTRMK=$S($D(DGBTREC):$$DICLKUP^DGBTUTL(DGBTREC,DGBTDV1,4),1:"") I $D(DGBTDEF),DGBTDEF S DGBTRMK="DEFAULT MILEAGE USED"
"RTN","DGBTEE",30,0)
 .I DGBTRMK]"" W !,*7,"MILEAGE REMARKS: ",DGBTRMK,!
"RTN","DGBTEE",31,0)
 ;
"RTN","DGBTEE",32,0)
EDIT ;  display trip type, mileage
"RTN","DGBTEE",33,0)
 I ($G(DGBTACCT)=4)!($G(DGBTACCT)=5) D  Q:$G(DGBTTOUT)=-1  ;20
"RTN","DGBTEE",34,0)
 .I $G(CHZFLG) N OTRIPTYP S OTRIPTYP=$$GET1^DIQ(392,DGBTDT,31,"I")
"RTN","DGBTEE",35,0)
 .S DR="32//"_DGBTML_";S DGBTML=X;31//"_DGBTOWRT_";S DGBTOWRT=X;" D ^DIE I X=""!(X="^") S DGBTTOUT=-1 Q  ;20
"RTN","DGBTEE",36,0)
 .I ($G(CHZFLG))&($G(OTRIPTYP)'=$$GET1^DIQ(392,DGBTDT,31,"I"))&($G(MONTOT)'="") D
"RTN","DGBTEE",37,0)
 ..N NTRIPTYP S NTRIPTYP=$$GET1^DIQ(392,DGBTDT,31,"I")
"RTN","DGBTEE",38,0)
 ..I (OTRIPTYP=1)&(NTRIPTYP=2) D  Q
"RTN","DGBTEE",39,0)
 ...S $P(MONTOT,U)=$P(MONTOT,U)+1
"RTN","DGBTEE",40,0)
 ...S $P(MONTOT,U,2)=$P(MONTOT,U,2)-1
"RTN","DGBTEE",41,0)
 ...S $P(MONTOT,U,3)=$P(MONTOT,U,3)+1
"RTN","DGBTEE",42,0)
 ..I (OTRIPTYP=2)&(NTRIPTYP=1) D  Q
"RTN","DGBTEE",43,0)
 ...S $P(MONTOT,U)=$P(MONTOT,U)-1
"RTN","DGBTEE",44,0)
 ...S $P(MONTOT,U,2)=$P(MONTOT,U,2)+1
"RTN","DGBTEE",45,0)
 ...S $P(MONTOT,U,3)=$P(MONTOT,U,3)-1
"RTN","DGBTEE",46,0)
 .S DGBTCCT=$$GET1^DIQ(392,DGBTDT,54,"I")
"RTN","DGBTEE",47,0)
 .S DIR(0)="Y",DIR("B")=$S($G(DGBTCCT)'="":"YES",1:"NO"),DIR("A")="COMMON CARRIER USED" D ^DIR K DIR I $D(DIRUT) S DGBTTOUT=-1 Q  ;20
"RTN","DGBTEE",48,0)
 .I 'Y,$D(^DGBT(392,DGBTDT,"C")) S $P(^DGBT(392,DGBTDT,"A"),"^",4)="" F I="B","C"  K ^DGBT(392,DGBTDT,I)
"RTN","DGBTEE",49,0)
 .I Y D  ;20
"RTN","DGBTEE",50,0)
 ..K DA,DR,DIE,Y S DIE="^DGBT(392,",DA=DGBTDT,DR="44COMMON CARRIER MODE~R" D ^DIE  I $D(Y) S DGBTTOUT=-1 Q  ;20
"RTN","DGBTEE",51,0)
 ..K DA,DR,DIE,Y S DIE="^DGBT(392,",DA=DGBTDT I $$UP^XLFSTR($$GET1^DIQ(392,DGBTDT,44))["BUS" S DR="52R" D ^DIE I $D(Y) S DGBTTOUT=-1 Q  ;20
"RTN","DGBTEE",52,0)
 ..K DA,DR,DIE,Y I $$GET1^DIQ(392,DGBTDT,52)="PASS" S DIE="^DGBT(392,",DA=DGBTDT,DR="53R" D ^DIE I $D(Y) S DGBTTOUT=-1 Q  ;20
"RTN","DGBTEE",53,0)
 ..N %DT S %DT(0)="-NOW" ;prevents future dates Coder CR 53 for DG*1.0*20
"RTN","DGBTEE",54,0)
 ..K DA,DR,DIE,Y S DIE="^DGBT(392,",DA=DGBTDT,DR="54//"_$P(DGBTDTE,"@",1)_";55;55.1" D ^DIE I $D(Y) S DGBTTOUT=-1 Q  ;20 PAVEL - DGBT*1*20
"RTN","DGBTEE",55,0)
 S:DGBTACCT=5&(DGBTCP=1) DGBTMR=DGBTMR1 S DGBTMLT=DGBTOWRT*DGBTML*DGBTMR,DGBTMLT=$J(DGBTMLT,0,2),DR="33///"_DGBTMLT
"RTN","DGBTEE",56,0)
 D ^DIE I X=""!(X="^") S DGBTTOUT=-1 Q
"RTN","DGBTEE",57,0)
 I $G(^DGBT(392,DGBTDTI,"C"))="" K ^DGBT(392,DGBTDTI,"C"),DGBTVAR("C")
"RTN","DGBTEE",58,0)
 ;
"RTN","DGBTEE",59,0)
DIE2 ;  stuff eligibility data, SC%, acct. type
"RTN","DGBTEE",60,0)
 ;
"RTN","DGBTEE",61,0)
 S DIE("NO^")="12345" S:'$D(DGBTCD) DGBTCD=""
"RTN","DGBTEE",62,0)
 I 'DGBTCORE D
"RTN","DGBTEE",63,0)
 . S DR="3////"_DGBTELIG_";4////"_DGBTSCP_";5///"_DGBTCD_";6////"_DGBTACTN_";I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;7;@1;I DGBTMLFB=0 S Y=""@2"";34//0;W:'X X S DGBTMAL=X;35//0;W:'X X S DGBTFAB=X;@2"
"RTN","DGBTEE",64,0)
 I DGBTCORE D
"RTN","DGBTEE",65,0)
 . S DR(1,392,1)="3////"_DGBTELIG_";4////"_DGBTSCP_";5///"_DGBTCD_";6////"_DGBTACTN_";I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;"
"RTN","DGBTEE",66,0)
 . S DR(1,392,2)="@3;14;S DGBTCSL=$$AFTER^DGBTCSL(392,D0,X,$G(DGBTPRV)) S:DGBTCSL<1 Y=""@3"" W:DGBTCSL<1 ""   Required"" K DGBTPRV,DGBTCSL;@1;I DGBTMLFB=0 S Y=""@2"";34//0;S DGBTMAL=X;35//0;S DGBTFAB=X;@2"
"RTN","DGBTEE",67,0)
 ;
"RTN","DGBTEE",68,0)
 ;DIE3 ;  get most econ. cost
"RTN","DGBTEE",69,0)
 ;
"RTN","DGBTEE",70,0)
 D ^DIE K DR I $G(DTOUT)!(X="^") S DGBTTOUT=-1 Q
"RTN","DGBTEE",71,0)
 ;
"RTN","DGBTEE",72,0)
 ;check for common carrier
"RTN","DGBTEE",73,0)
 S DGBTMAF=$G(DGBTFAB)+$G(DGBTMAL)
"RTN","DGBTEE",74,0)
 S (DGBTCC,DGBTCCAMT,DGBTCCREQ,DGBTCCMODE,DGBTMETC)=0
"RTN","DGBTEE",75,0)
 S DGBTDCM=$P(MONTOT,"^",4)
"RTN","DGBTEE",76,0)
 S DGBTDCM=$S(DGBTMLT-DGBTDCM'>0:DGBTMLT,1:DGBTDCM)
"RTN","DGBTEE",77,0)
 I $D(^DGBT(392,DGBTDTI,"C")) D
"RTN","DGBTEE",78,0)
 .S DGBTCC=$D(^DGBT(392,DGBTDTI,"C"))          ;was common carrier used
"RTN","DGBTEE",79,0)
 .S DGBTCCAMT=$$GET1^DIQ(392,DGBTDTI,55)    ; amount of common carrier
"RTN","DGBTEE",80,0)
 .S DGBTCCREQ=$$GET1^DIQ(392,DGBTDTI,55.1),DGBTCCREQ=$S(DGBTCCREQ="YES":1,1:0)        ;common carrier required - 1=yes,0=no
"RTN","DGBTEE",81,0)
 .S DGBTCCMODE=$$GET1^DIQ(392,DGBTDTI,44,"I")                      ;common carrier mode of transportation
"RTN","DGBTEE",82,0)
 .S DGBTMETC=$G(DGBTME)+$G(DGBTMAL)    ;$S($D(DGBTMAL):DGBTMAL,1:0)   ;most enco + meals and lodging S DGBTDCM=$P(MONTOT,"^",4) S DGBTDCM=$P(MONTOT,"^",4) S DGBTMAF=$S(DGBTMLFB:DGBTMAL+DGBTFAB,1:0),DGBTMETC=DGBTME+$S($D(DGBTMAL):DGBTMAL,1:0)
"RTN","DGBTEE",83,0)
 ;
"RTN","DGBTEE",84,0)
 ;if CC not required reset most econ to 0
"RTN","DGBTEE",85,0)
 I $G(DGBTCCREQ) D
"RTN","DGBTEE",86,0)
 .S FDA(392,DGBTDTI_",",8)=0
"RTN","DGBTEE",87,0)
 .D FILE^DIE(,"FDA")
"RTN","DGBTEE",88,0)
 S:$D(DGBTREC) DGBTME=$$DICLKUP^DGBTUTL(DGBTREC,DGBTDV1,3) S:DGBTME="" DGBTME=0 S DR="8//"_DGBTME_";W:'X X S DGBTME=X" D ^DIE I X=""!(X="^") S DGBTTOUT=-1 G EXIT
"RTN","DGBTEE",89,0)
TCOST ; calculate total cost and monthly cum. deductable
"RTN","DGBTEE",90,0)
MLFB ;
"RTN","DGBTEE",91,0)
 ;
"RTN","DGBTEE",92,0)
 N OWAIV
"RTN","DGBTEE",93,0)
 S OWAIV=$P(MONTOT,U,5)
"RTN","DGBTEE",94,0)
 S MONTOT=$$ADDTO(.MONTOT)
"RTN","DGBTEE",95,0)
 I DGBTACCT'=4&(DGBTACCT'=5) S DGBTPA=DGBTMAF+DGBTME G CONT
"RTN","DGBTEE",96,0)
 I $D(DGBTMLT) D
"RTN","DGBTEE",97,0)
 .I DGBTMLT+DGBTMAF'>DGBTMETC S DGBTTC=DGBTMLT+DGBTMAF Q
"RTN","DGBTEE",98,0)
 .I DGBTMLT+DGBTMAF>DGBTMETC&(DGBTME>0) S DGBTTC=DGBTMETC Q
"RTN","DGBTEE",99,0)
 .I DGBTME'>0 S DGBTTC=DGBTMLT+DGBTMAF Q
"RTN","DGBTEE",100,0)
 .E  S DGBTTC=DGBTMETC
"RTN","DGBTEE",101,0)
 I $G(DGBTCCREQ) S DGBTTC=$G(DGBTTC)+DGBTCCAMT
"RTN","DGBTEE",102,0)
 I DGBTACCT=5 S DGBTDE=0 S DGBTPA=$S((DGBTMLT+DGBTMAF)'=0:DGBTTC,1:DGBTMETC) ;G CONT
"RTN","DGBTEE",103,0)
 ;  the following section of code moved to DGBTEE2 for space reasons
"RTN","DGBTEE",104,0)
 I DGBTACCT'=5 D
"RTN","DGBTEE",105,0)
 .N DGBTDCVX,XY
"RTN","DGBTEE",106,0)
 .I $G(CHZFLG) N ODED S ODED=$$GET1^DIQ(392,DGBTDT,9)
"RTN","DGBTEE",107,0)
 .D DED^DGBTEE2
"RTN","DGBTEE",108,0)
 .I $P($G(MONTOT),"^",5)'["Y" S DGBTDCV=DGBTDCV1
"RTN","DGBTEE",109,0)
 .;add by Pavel for patch 20
"RTN","DGBTEE",110,0)
 .I $G(DGBTCC),$G(DGBTCCREQ),'$G(DGBTMLT) S DGBTDCV=0
"RTN","DGBTEE",111,0)
 .I $G(DGBTCC),'$G(DGBTCCREQ),$G(DGBTMLT)'>0 S DGBTDCV=0
"RTN","DGBTEE",112,0)
 .I $G(DGBTCC),'$G(DGBTCCREQ),$G(DGBTME)'>0
"RTN","DGBTEE",113,0)
 .I $G(DGBTCC),'$G(DGBTCCREQ),$G(DGBTME)>0,$G(DGBTME)'>$G(DGBTMLT) S DGBTDCV=0
"RTN","DGBTEE",114,0)
 .I $G(DGBTCC),$G(DGBTCCREQ),$G(DGBTDE)'<$G(DGBTMLT) S DGBTDE=DGBTMLT
"RTN","DGBTEE",115,0)
 .I '$G(DGBTCC),'$G(DGBTCCREQ),$G(DGBTMLT)'>0 S DGBTDCV=0
"RTN","DGBTEE",116,0)
 .I '$G(DGBTCC),DGBTMLT>DGBTDPV S (DGBTDCV,DGBTDE)=DGBTDPV
"RTN","DGBTEE",117,0)
 .I ($G(CHZFLG))&($$GET1^DIQ(392,DGBTDT,9)=0)&($P($G(MONTOT),U,5)["Y") S (DGBTDCV,DGBTE)=0
"RTN","DGBTEE",118,0)
 .I (+$P($G(MONTOT),U,7)<18)&((+$P($G(MONTOT),U,7)+DGBTDCV)>18)&(OWAIV'["Y")&('$G(CHZFLG)) S DGBTDCV=18-$P(MONTOT,U,7),$P(MONTOT,U,5)="NO" ; RFE 12/5/12
"RTN","DGBTEE",119,0)
 .I (+$G(CHZFLG)&(($P($G(MONTOT),U,7)+DGBTDCV)>18)) S DGBTDCV=18-$P(MONTOT,U,7),$P(MONTOT,U,5)="NO" ; RFE 12/5/12
"RTN","DGBTEE",120,0)
 .I (+$P($G(MONTOT),U,1)>6)!(+$P($G(MONTOT),U,7)>18)!($P($G(MONTOT),U,5)["Y")&('$G(CHZFLG)) S DGBTDCV=0 ; Added ELSE RFE 12/5/12
"RTN","DGBTEE",121,0)
 .I $$DENIED(DGBTDT) S DGBTDCV=0
"RTN","DGBTEE",122,0)
 .I $G(CHZFLG)=0 S ($P(MONTOT,U,4),$P(MONTOT,U,7))=$P(MONTOT,U,4)+DGBTDCV
"RTN","DGBTEE",123,0)
 .S DGBTOTHER=$$GET1^DIQ(392,DGBTDT,43.1,"I")
"RTN","DGBTEE",124,0)
 .I $G(DGBTNSC) S DGBTDCV=0
"RTN","DGBTEE",125,0)
 .I $G(DGBTOTHER)=11 S DGBTDCV=0
"RTN","DGBTEE",126,0)
 .I $G(DGBTOTHER)=12 S DGBTDCV=0
"RTN","DGBTEE",127,0)
 .I $G(DGBTOTHER)=13 S DGBTDCV=0
"RTN","DGBTEE",128,0)
 .S XY=$S(DGBTDCV>99:"99.00",1:DGBTDCV)
"RTN","DGBTEE",129,0)
 .N FDA
"RTN","DGBTEE",130,0)
 .S FDA(392,DGBTDT_",",9)=XY ;Input transform for field 9 is set to max 99
"RTN","DGBTEE",131,0)
 .S FDA(392,DGBTDT_",",56)="M"
"RTN","DGBTEE",132,0)
 .D FILE^DIE(,"FDA")
"RTN","DGBTEE",133,0)
 .W !,"DEDUCTIBLE AMOUNT: "_DGBTDCV_"// "_XY    ;,"   ",$S($G(DGBTREF):"",1:$G(DGBTDCVX))
"RTN","DGBTEE",134,0)
 .S DGBTDCV=XY
"RTN","DGBTEE",135,0)
 .S DGBTDE=DGBTDCV
"RTN","DGBTEE",136,0)
 .I ($G(CHZFLG))&($G(ODED)'=DGBTDE)&($G(MONTOT)'="") D
"RTN","DGBTEE",137,0)
 ..S $P(MONTOT,U,4)=$P(MONTOT,U,4)+DGBTDE
"RTN","DGBTEE",138,0)
 ..S $P(MONTOT,U,4)=$P(MONTOT,U,4)-ODED
"RTN","DGBTEE",139,0)
CONT ;
"RTN","DGBTEE",140,0)
 D CONT^DGBTCE1 Q
"RTN","DGBTEE",141,0)
EXIT ;
"RTN","DGBTEE",142,0)
 K DGBTDV1,DGBTRMK Q
"RTN","DGBTEE",143,0)
  ;
"RTN","DGBTEE",144,0)
DENIED(DGBTDT) ;check for a denied claim
"RTN","DGBTEE",145,0)
 ;
"RTN","DGBTEE",146,0)
 N DENIED
"RTN","DGBTEE",147,0)
 S DENIED=$$GET1^DIQ(392,DGBTDT,45.2,"I")
"RTN","DGBTEE",148,0)
 ;
"RTN","DGBTEE",149,0)
 Q DENIED
"RTN","DGBTEE",150,0)
ADDTO(MONTOT) ;this will add the current trip to the total trips for the month.
"RTN","DGBTEE",151,0)
 ;
"RTN","DGBTEE",152,0)
 N TRIPTYP
"RTN","DGBTEE",153,0)
 I CHZFLG=1 Q MONTOT
"RTN","DGBTEE",154,0)
 I $D(^DGBT(392,DGBTDT,"M")),$P(^("M"),"^")=1 S TRIPTYP=1
"RTN","DGBTEE",155,0)
 E  S TRIPTYP=2
"RTN","DGBTEE",156,0)
 I TRIPTYP=1 S $P(MONTOT,"^",1)=$P(MONTOT,"^",1)+1
"RTN","DGBTEE",157,0)
 I TRIPTYP=2 S $P(MONTOT,"^",1)=$S($P(MONTOT,"^",1)<6:$P(MONTOT,"^",1)+1,1:$P(MONTOT,"^",1)+2)
"RTN","DGBTEE",158,0)
 ;S $P(MONTOT,"^",1)=$S(TRIPTYP=1:$P(MONTOT,"^",1)+1,1:$P(MONTOT,"^",1)+2)     ;add current trip to total for month
"RTN","DGBTEE",159,0)
 I TRIPTYP=1 S $P(MONTOT,U,2)=$P(MONTOT,U,2)+1
"RTN","DGBTEE",160,0)
 I TRIPTYP=2 S $P(MONTOT,U,3)=$P(MONTOT,U,3)+1
"RTN","DGBTEE",161,0)
 S $P(MONTOT,"^",6)=$S(TRIPTYP=1:$P(MONTOT,"^",6)+1,1:$P(MONTOT,"^",6)+2)
"RTN","DGBTEE",162,0)
 I ($P(MONTOT,U,5)'["Y")&($P(MONTOT,U)>6) S $P(MONTOT,U,5)="YES"
"RTN","DGBTEE",163,0)
 I ($P(MONTOT,U,5)'["Y")&($P(MONTOT,U,2)>18) S $P(MONTOT,U,5)="YES"
"RTN","DGBTEE",164,0)
 Q MONTOT
"RTN","DGBTEE",165,0)
 ;
"RTN","DGBTEE1")
0^5^B20015303
"RTN","DGBTEE1",1,0)
DGBTEE1 ;ALB/SCK - BENEFICIARY TRAVEL ENTER/EDIT CHECK; 12/7/92 3/19/93 ;11/10/11  13:16
"RTN","DGBTEE1",2,0)
 ;;1.0;Beneficiary Travel;**14,20**;September 25, 2001;Build 185
"RTN","DGBTEE1",3,0)
 Q
"RTN","DGBTEE1",4,0)
SCREEN ;  called by dgbtee,dgbtce
"RTN","DGBTEE1",5,0)
 Q:'$D(^DGBT(392,DGBTDT,0))!($G(DGBTSP("CLAIM TYPE"))="S")
"RTN","DGBTEE1",6,0)
 K DGBTVAR F I=0,"A","C","D","M","R","T" S DGBTVAR(I)=$S($D(^DGBT(392,DGBTDT,I)):^(I),1:"") ; ref file #392, claims
"RTN","DGBTEE1",7,0)
 W @IOF S DGBTFLAG=0
"RTN","DGBTEE1",8,0)
 I '$D(^DG(43,1,"BT"))!('$D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT"))) W !!,"Module has not been properly initialized - to continue you should first complete",!,"the parameters" Q
"RTN","DGBTEE1",9,0)
 W !?16,"Beneficiary Travel Claim Information <Enter/Edit>"
"RTN","DGBTEE1",10,0)
 D PID^VADPT6
"RTN","DGBTEE1",11,0)
 W !!?8,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),"^",2),!
"RTN","DGBTEE1",12,0)
START ; ask date/time, and division
"RTN","DGBTEE1",13,0)
 K DIC,^TMP("DGBT",$J),X
"RTN","DGBTEE1",14,0)
 S DIE="^DGBT(392,",DIE("NO^")="OUTOK"
"RTN","DGBTEE1",15,0)
 S DR=".01;S (DGBTDT,VADAT(""W""))=X D ^VADATE S DGBTDTI=VADATE(""I""),DGBTDTE=VADATE(""E"") K VADAT,VADATE I '$D(DGBTMD) S Y=""@1"";11;@1"
"RTN","DGBTEE1",16,0)
 ;
"RTN","DGBTEE1",17,0)
 S DIDEL=392 ; allows users to delete BT claims
"RTN","DGBTEE1",18,0)
 D ^DIE K DIE,DIDEL,DQ,DR I $D(DTOUT)!$G(DUOUT)!($D(Y)) S DGBTTOUT=-1,%=-1 Q       ;PAVEL
"RTN","DGBTEE1",19,0)
 K X
"RTN","DGBTEE1",20,0)
 I '$D(^DGBT(392,DGBTDT,0)) Q
"RTN","DGBTEE1",21,0)
 I $D(^DGBT(392,DGBTDT,0)) L +^DGBT(392,DGBTDT):2 I '$T W !?5,"Another user is editing this entry.",*7 S DGBTTOUT=1 G QUIT
"RTN","DGBTEE1",22,0)
 ; set rates and build eligibilities in DGBTEE2
"RTN","DGBTEE1",23,0)
 D RATES^DGBTEE2
"RTN","DGBTEE1",24,0)
ELIG1 ;  select eligibility from those available in TMP list
"RTN","DGBTEE1",25,0)
 I '$O(VAEL(1,0)) S DGBTELIG=+VAEL(1) G ESET1
"RTN","DGBTEE1",26,0)
 S DIR("A")="Select ELIGIBILITY",DIR("B")=$S($P(^DGBT(392,DGBTDT,0),"^",3):$P(^DIC(8,$P(^DGBT(392,DGBTDT,0),"^",3),0),"^"),VAEL(1):$P(VAEL(1),"^",2),1:"")
"RTN","DGBTEE1",27,0)
 S DIR(0)="F",DIR("?")="^D ELIST^DGBTEE2"
"RTN","DGBTEE1",28,0)
 D ^DIR K DIR I $D(DUOUT) W !?3,"SORRY, '^' NOT ALLOWED!!" G ELIG1
"RTN","DGBTEE1",29,0)
 I $D(DTOUT) S DGBTTOUT=-1 Q
"RTN","DGBTEE1",30,0)
 S:Y="" DGBTELIG=$S($P(^DGBT(392,DGBTDT,0),"^",3):$P(^(0),"^",3),1:+VAEL(1)) ; ref file #392, claims
"RTN","DGBTEE1",31,0)
 I X["@" W !,"ELIGIBILITY REQUIRED." G ELIG1
"RTN","DGBTEE1",32,0)
 I Y?1A.E F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  I $E($P(^(I),"^",2),1,$L(X))=X S XX=Y,Y=I G ESET ; ref ^TMP file for eligibility
"RTN","DGBTEE1",33,0)
 I +Y?1N.N S Y=+Y F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  I +$P(^(I),"^")=Y S XX=Y,Y=I G ESET ; ref ^TMP file for eligibility
"RTN","DGBTEE1",34,0)
ECHOZ ;
"RTN","DGBTEE1",35,0)
 W !!,"Choose by NUMBER the primary eligibility or other entitled eligibilities",!
"RTN","DGBTEE1",36,0)
 I DGBTCT>1 F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  W !?5,I,?10,$P(^TMP("DGBT",$J,I),"^",2)
"RTN","DGBTEE1",37,0)
 K DIR,X S DIR("A")="Choose 1-"_DGBTCT,DIR(0)="NO^1:"_DGBTCT,DIR("?")="Enter choice from those displayed"
"RTN","DGBTEE1",38,0)
 D ^DIR K DIR G:$D(DIRUT) ELIG1 S XX=Y
"RTN","DGBTEE1",39,0)
 I '$D(^TMP("DGBT",$J,Y)) W " ?? ",!,"Select ELIGIBILITY: " G ECHOZ
"RTN","DGBTEE1",40,0)
ESET ;
"RTN","DGBTEE1",41,0)
 S:$D(Y) DGBTELIG=$S($D(^TMP("DGBT",$J,Y)):+^TMP("DGBT",$J,Y),'$D(XX):Y,1:+VAEL(1))
"RTN","DGBTEE1",42,0)
 W:Y]"" ?30,$E($P(^DIC(8,+DGBTELIG,0),"^"),$S($D(XX):($L(XX)+1),1:1),99)
"RTN","DGBTEE1",43,0)
ESET1 ;
"RTN","DGBTEE1",44,0)
 S DGBTSCP=$S($P(^DIC(8,DGBTELIG,0),"^",9)=1&(+VAEL(3)):$P(VAEL(3),"^",2),$P(^DIC(8,DGBTELIG,0),"^",9)=3&(+VAEL(3)):$P(VAEL(3),"^",2),1:"")
"RTN","DGBTEE1",45,0)
CERT ;  stuff of certification date if appropriate
"RTN","DGBTEE1",46,0)
 ; naked global ref file #392.2, certification file.
"RTN","DGBTEE1",47,0)
 I $P(VAEL(3),"^") S DGBTCD="" I VAEL(3)&($P(VAEL(3),"^",2)'>29) S DGBTIDT=9999999.99999-DGBTDT F I=0:0 S I=$O(^DGBT(392.2,"C",DFN,I)) Q:'I  I I'>DGBTIDT&($P(^DGBT(392.2,I,0),"^",3)) S DGBTCD=$P(^(0),"^")
"RTN","DGBTEE1",48,0)
ACCT ;  allowed to select only valid active accounts
"RTN","DGBTEE1",49,0)
 ;I DGBTDTI>PATCHDT S DGBTOACT=$S('$D(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0)):0,1:+$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^",5))
"RTN","DGBTEE1",50,0)
 S DGBTOACT=$S('$D(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0)):0,1:+$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^",5))
"RTN","DGBTEE1",51,0)
 K X S (DIC("B"),X)=$S(+$P(DGBTVAR(0),"^",6):$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^"),1:$$DEFLT1()) S DIC("A")="Select ACCOUNT: "
"RTN","DGBTEE1",52,0)
 S DIC="^DGBT(392.3,",DIC(0)="AEQMZ"
"RTN","DGBTEE1",53,0)
 S DIC("S")="I $$ACCTHELP^DGBTEE1"
"RTN","DGBTEE1",54,0)
 D ^DIC K DIC I $D(DTOUT) S DGBTTOUT=-1 K DTOUT Q
"RTN","DGBTEE1",55,0)
 I Y'>0 W !,"ACCOUNT IS REQUIRED!!" G ACCT
"RTN","DGBTEE1",56,0)
 S DGBTACTN=$P(Y,"^"),DGBTACCT=$P(Y(0),"^",5)
"RTN","DGBTEE1",57,0)
 ;  if account is ALL OTHER - stuff in mileage info
"RTN","DGBTEE1",58,0)
 I $D(DGBTVAR("M")) S DGBTML=$P(DGBTVAR("M"),"^",2),DGBTOWRT=$P(DGBTVAR("M"),"^"),DGBTMLT=$J((DGBTML*DGBTOWRT*DGBTMR),0,2)
"RTN","DGBTEE1",59,0)
QUIT ;
"RTN","DGBTEE1",60,0)
 K A,C,I,IA,J,X,XX,^TMP("DGBT",$J),DGBTIDT,DGBTCT
"RTN","DGBTEE1",61,0)
 Q
"RTN","DGBTEE1",62,0)
 ;
"RTN","DGBTEE1",63,0)
DEFLT1() ;
"RTN","DGBTEE1",64,0)
 N REC,Y
"RTN","DGBTEE1",65,0)
 I $P(DGBTDTI,".",1)'=DT Q ""
"RTN","DGBTEE1",66,0)
 S REC="0" F  S REC=$O(^DGBT(392.3,REC)) Q:'REC  D  Q:$D(Y)
"RTN","DGBTEE1",67,0)
 . S:$P(^DGBT(392.3,REC,0),U,5)=4&($P(^(0),U,3)'>DGBTDT&('$P(^(0),U,4)!($P(^(0),U,4)'<DGBTDT))) Y=$P(^(0),U,1)
"RTN","DGBTEE1",68,0)
 Q $G(Y)
"RTN","DGBTEE1",69,0)
ACCTHELP() ;
"RTN","DGBTEE1",70,0)
 N DATUM
"RTN","DGBTEE1",71,0)
 S DATUM=$G(^DGBT(392.3,Y,0))
"RTN","DGBTEE1",72,0)
 I $P(DATUM,U,3)>DGBTDT Q 0
"RTN","DGBTEE1",73,0)
 I ($P(DATUM,U,4)<DGBTDT)&(+$P(DATUM,U,4)>0) Q 0
"RTN","DGBTEE1",74,0)
 Q $E(DATUM,5,16)'="SPECIAL MODE"
"RTN","DGBTEE2")
0^6^B23632699
"RTN","DGBTEE2",1,0)
DGBTEE2 ;ALB/SCK BENEFICIARY TRAVEL ENTER/EDIT CONT; 03/23/93
"RTN","DGBTEE2",2,0)
 ;;1.0;Beneficiary Travel;**17,20**;September 25, 2001;Build 185
"RTN","DGBTEE2",3,0)
START ;
"RTN","DGBTEE2",4,0)
 Q
"RTN","DGBTEE2",5,0)
STUFF ;  stuff departure=home address, destination=division(ins) address, and attendant/payee=patient        
"RTN","DGBTEE2",6,0)
 S DGBTFR1=$S($G(CHZFLG):$P(DGBTVAR("D"),"^",1),1:VAPA(1)),DGBTFR2=$S($G(CHZFLG):$P(DGBTVAR("D"),"^",2),1:VAPA(2)),DGBTFR3=$S($G(CHZFLG):$P(DGBTVAR("D"),"^",3),1:VAPA(3)),DGBTAP=VADM(1)
"RTN","DGBTEE2",7,0)
 ;S DGBTFR1=$S('$G(CHZFLG):VAPA(1),1:$P(DGBTVAR("D"),"^",1)),DGBTFR2=$S('$G(CHZFLG):VAPA(2),1:$P(DGBTVAR("D"),"^",2)),DGBTFR3=$S('$G(CHZFLG):VAPA(3),1:$P(DGBTVAR("D"),"^",3)),DGBTAP=VADM(1)
"RTN","DGBTEE2",8,0)
 ; function call $$DEPCTY passes the zip code from the patient data, and returns with the departure city name or a null.
"RTN","DGBTEE2",9,0)
 ; if a null for the city is returned, the city name in the patient data is defaulted to.
"RTN","DGBTEE2",10,0)
 I '$G(CHZFLG) S XX=$$DEPCTY^DGBTUTL($P(VAPA(11),U,1)) S X=$S(+XX>0:$P(XX,U,2),1:VAPA(4))
"RTN","DGBTEE2",11,0)
 I $G(CHZFLG) S XX=$$DEPCTY^DGBTUTL($P(DGBTVAR("D"),"^",6)) S X=$S(+XX>0:$P(XX,U,2),1:$P(DGBTVAR("D"),"^",4))
"RTN","DGBTEE2",12,0)
 D UP^DGBTHELP S DGBTFR4=X
"RTN","DGBTEE2",13,0)
 K DGBTVAR(0) S DGBTVAR(0)=$S($D(^DGBT(392,DGBTDT,0)):^(0),1:"")
"RTN","DGBTEE2",14,0)
 S (DGBTDIV,DGBTDV1)=$P(DGBTVAR(0),"^",11),DGBTTO1=$P(^DG(40.8,DGBTDIV,0),"^"),DGBTDIV=$P(^DG(40.8,DGBTDIV,0),"^",7)
"RTN","DGBTEE2",15,0)
 S (DGBTTO2,DGBTTO3,DGBTTO4,X)=""
"RTN","DGBTEE2",16,0)
 I ('$G(CHZFLG)&($D(^DIC(4,DGBTDIV,1))#10=1)) S DGBTTO2=$P(^DIC(4,DGBTDIV,1),"^"),DGBTTO3=$P(^(1),"^",2),X=$P(^(1),"^",3) D UP^DGBTHELP S DGBTTO4=X Q  ; ref file #4, institution file by selected div
"RTN","DGBTEE2",17,0)
 S DGBTTO1=$P(DGBTVAR("T"),U),DGBTTO2=$P(DGBTVAR("T"),U,2),DGBTTO3=$P(DGBTVAR("T"),U,3) ;RFE DGBT*1.0*20
"RTN","DGBTEE2",18,0)
 S XX=$$DEPCTY^DGBTUTL($P(DGBTVAR("T"),"^",6)) S X=$S(+XX>0:$P(XX,U,2),1:$P(DGBTVAR("T"),"^",4)) ;RFE DGBT*1.0*20
"RTN","DGBTEE2",19,0)
 D UP^DGBTHELP S DGBTTO4=X ;RFE DGBT*1.0*20
"RTN","DGBTEE2",20,0)
 Q
"RTN","DGBTEE2",21,0)
DED ;
"RTN","DGBTEE2",22,0)
 I $D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")) D
"RTN","DGBTEE2",23,0)
 . S DGBTRATE=^("BT"),DGBTDPV=$P(DGBTRATE,"^"),DGBTDPM=$P(DGBTRATE,"^",2),DGBTMR=$P(DGBTRATE,"^",3) ; ref file #43, MAS parameters file for BT settings
"RTN","DGBTEE2",24,0)
 .; DGBTDPV = DEDUCTIBLE/VISIT     DGBTDPM = DEDUCTIBLE/MONTH     DGBTMR = MILEAGE RATE    DGBTDCM = Deductible paid for this month
"RTN","DGBTEE2",25,0)
 I $D(^DGBT(392,DGBTDT,"M")) I $P(^("M"),"^")=1 S DGBTDPV=DGBTDPV/2 ; ref file #392, claims file.
"RTN","DGBTEE2",26,0)
 S DGBTDRM=DGBTDPM-DGBTDCM ; Deductible to be paid
"RTN","DGBTEE2",27,0)
 I DGBTDRM<0 S DGBTDRM=0
"RTN","DGBTEE2",28,0)
 S DGBTDCV=0
"RTN","DGBTEE2",29,0)
 I DGBTDCM'<DGBTDPM S DGBTDCV=0
"RTN","DGBTEE2",30,0)
 I DGBTDRM'<DGBTDPV&(DGBTTC'<DGBTDPV) S DGBTDCV=DGBTDPV
"RTN","DGBTEE2",31,0)
 I DGBTDRM'<DGBTDPV&(DGBTTC'>DGBTDPV) S DGBTDCV=DGBTTC
"RTN","DGBTEE2",32,0)
 I DGBTDRM'>DGBTDPV&(DGBTTC'>DGBTDRM) S DGBTDCV=DGBTTC
"RTN","DGBTEE2",33,0)
 I DGBTDRM'>DGBTDPV&(DGBTTC'<DGBTDRM) S DGBTDCV=DGBTDRM
"RTN","DGBTEE2",34,0)
 S DGBTDCV=$S(DGBTMLT-DGBTDCV'>0:DGBTMLT,1:DGBTDCV)
"RTN","DGBTEE2",35,0)
 I $G(DGBTDCV)>$G(DGBTDPV) S DGBTDCV=DGBTDPV
"RTN","DGBTEE2",36,0)
 I $G(DGBTCC),'$G(DGBTCCREQ),$G(DGBTME) S DGBTMETC=(DGBTMETC+DGBTMAF)
"RTN","DGBTEE2",37,0)
DED1 ;
"RTN","DGBTEE2",38,0)
 S DGBTDCV1=DGBTDCV    ;save orig value for deductible
"RTN","DGBTEE2",39,0)
 S DGBTDCVX="Computed"
"RTN","DGBTEE2",40,0)
 S:DGBTDCV (DGBTWAIVER,DGBTDCV)=$$DWAIVER^DGBTUTL(DFN,DGBTDCV,DGBTDT),DGBTDCVX=$P(DGBTDCV,U,2),DGBTDCV=+DGBTDCV    ;added by Pavel for patch 20
"RTN","DGBTEE2",41,0)
 I '$G(DGBTREF),$G(DGBTDCV) S DGBTDCV=$S($P(MONTOT,"^",1)>6:0,1:$G(DGBTDCV)),DGBTDCVX="Computed"
"RTN","DGBTEE2",42,0)
 I '$G(DGBTREF),$G(DGBTDCV),$G(DGBTCCREQ),$G(DGBTCC),$G(DGBTMLT),'$G(DGBTME) D  S DGBTDCVX="Mode of transportation is Common Carrier/with Mileage" Q
"RTN","DGBTEE2",43,0)
 .I '$G(DGBTREF),$G(DGBTWAIVER)'["Pension" S DGBTDCV=DGBTDCV1
"RTN","DGBTEE2",44,0)
 .I '$G(DGBTREF),DGBTDCV>$G(DGBTMLT) S DGBTDCV=DGBTMLT-DGBTDCV S:DGBTDCV<0 DGBTDCV=0,DGBTTC=DGBTTC-DGBTMLT
"RTN","DGBTEE2",45,0)
 I '$G(DGBTREF),$G(DGBTDCV),$G(DGBTCCREQ),$G(DGBTCC) S DGBTDCV=0,DGBTDCVX="Mode of transportation is Common Carrier" Q
"RTN","DGBTEE2",46,0)
 I '$G(DGBTREF),'$G(DGBTDCV),$G(DGBTCCREQ),$G(DGBTCC),'$G(DGBTME),'$G(DGBTMLT) S DGBTDCV=0,DGBTDCVX="Mode of transportation is Common Carrier" Q
"RTN","DGBTEE2",47,0)
 I '$G(DGBTREF),'$G(DGBTDCV),$G(DGBTCCREQ),$G(DGBTCC),$G(DGBTME),'$G(DGBTMLT) S DGBTDCV=0,DGBTDCVX="Mode of transportation is Common Carrier" Q
"RTN","DGBTEE2",48,0)
 I $G(DGBTREF),$G(DGBTDCV) S DGBTDCV=$S($P(MONTOT,"^",1)>6:0,1:$G(DGBTDCV)),DGBTDCVX="Patient refuse to provide financial information"
"RTN","DGBTEE2",49,0)
 Q
"RTN","DGBTEE2",50,0)
RATES ;  checks parameter to ask meals & lodging, ferrys & bridges        
"RTN","DGBTEE2",51,0)
 S DGBTMLFB=$S($D(^DG(43,1,"BT")):$P(^DG(43,1,"BT"),"^",2),1:0)
"RTN","DGBTEE2",52,0)
 ;  mileage rate
"RTN","DGBTEE2",53,0)
 S DGBTMR=$S($D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")):$P(^("BT"),"^",3),1:0) ; ref file #43.1, MAS event rates file for BT rates
"RTN","DGBTEE2",54,0)
 S DGBTMR1=$S($D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")):$P(^("BT"),"^",5),1:0) ; ref file #43.1, MAS event rates file for BT rates
"RTN","DGBTEE2",55,0)
ELIG ;  lookup current eligibilities for patient and put into TMP list
"RTN","DGBTEE2",56,0)
 S DGBTCT=1,^TMP("DGBT",$J,DGBTCT)=VAEL(1)
"RTN","DGBTEE2",57,0)
 F I=0:0 S I=$O(VAEL(1,I)) Q:'I  S DGBTCT=DGBTCT+1,^TMP("DGBT",$J,DGBTCT)=VAEL(1,I)
"RTN","DGBTEE2",58,0)
 Q
"RTN","DGBTEE2",59,0)
ELIST ;
"RTN","DGBTEE2",60,0)
 W !!?5,"Primary and other entitled eligibilities for patient:",!
"RTN","DGBTEE2",61,0)
 I DGBTCT>1 F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  W !?10,$P(^TMP("DGBT",$J,I),U,2)
"RTN","DGBTEE2",62,0)
 Q
"RTN","DGBTEE2",63,0)
EXIT ;
"RTN","DGBTEE2",64,0)
 Q
"RTN","DGBTEND")
0^9^B26000162
"RTN","DGBTEND",1,0)
DGBTEND ;ALB/SCK - BENEFICIARY TRAVEL CLEAN-UP VARIABLES ROUTINE;12/15/92 3/19/93
"RTN","DGBTEND",2,0)
 ;;1.0;Beneficiary Travel;**18,20**;September 25, 2001;Build 185
"RTN","DGBTEND",3,0)
 ;
"RTN","DGBTEND",4,0)
END I $G(DGBTTOUT)=1 I $D(^DGBT(392,DGBTDT,0)) F I=0,"A","D","M","R","T" S ^DGBT(392,DGBTDT,I)=$S($D(DGBTVAR(I)):DGBTVAR(I),1:"")
"RTN","DGBTEND",5,0)
 G:'$D(^DGBT(392,DGBTDT,0))!($G(DGBTTOUT)=1) QUIT I '$D(DGBTACCT) S DGBTVAR(0)=^DGBT(392,DGBTDT,0),DGBTACCT=$S('$D(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0)):0,1:+$P(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0),"^",5))
"RTN","DGBTEND",6,0)
 S Z="^INFORMATION^DISPLAY^EDIT",PROMPT="<I>nformation, <D>isplay claim, <E>dit claim," I DGBTACCT=4!(DGBTACCT=5) S PROMPT=PROMPT_" <P>rint form,",Z=Z_"^PRINT"
"RTN","DGBTEND",7,0)
 S DIR("A")=PROMPT_" or <Q>uit ",DIR("B")="Quit",DIR("?")="^D HELP^DGBTEND",DIR(0)="SA^Q:Quit;I:Information;D:Display;E:Edit;P:Print"
"RTN","DGBTEND",8,0)
 D ^DIR K DIR S X=$$UP^XLFSTR(X),ENDMENU=1 G DELETE:Y["Q"!($D(DIRUT)) D SCREEN^DGBTE:Y="I"
"RTN","DGBTEND",9,0)
 S DGBTX1=$S(X="D":"SCREEN^DGBTCD",X="E":"SCREEN^DGBTCE",X="P":"START^DGBTCR",1:"") I DGBTX1]"" D @DGBTX1 D:$G(DGBTTOUT) QUIT^DGBTCE1 G:DGBTX1="START^DGBTCR" PATIENT^DGBTE G END
"RTN","DGBTEND",10,0)
 G END
"RTN","DGBTEND",11,0)
DELETE I '$D(^DGBT(392,DGBTDT,"A")) S %=2 W !!,"Do you want to delete this claim" D YN^DICN D:%=1 DELSP G:%=2 PATIENT^DGBTE G:%=-1 DELETE1 I %<1 D HELP1^DGBTE G DELETE
"RTN","DGBTEND",12,0)
DELETE1 I '$D(^DGBT(392,DGBTDT,"A"))!($G(DGBTTOUT)=-1),'$G(DGBTOLD) W !,"This claim is incomplete and is now being deleted....." S DGBTTOUT="",DIK="^DGBT(392,",DA=DGBTDT D ^DIK   ;PAVEL - DGBT*1*20
"RTN","DGBTEND",13,0)
 G:$G(DGBTTOUT)=-1 QUIT D KVAR ;G PATIENT^DGBTE
"RTN","DGBTEND",14,0)
QUIT K PRCABN,DGBTMD,DGBTTOUT,ANS,DGBTREC,ERR,RETURN,DTOUT,DUOUT,MILEAGEFEE,MODEOFTRANS,NOLINE,NOSHOW,PREAUTH,QUIT,SPEQUIP,TOTALMILES,TOTINVOICE,VENDOR,VACNT,EXTRACREW,ELIGTYP
"RTN","DGBTEND",15,0)
 K DISYS,DIU,DIW,DISTCITY,DGBTINTO,DGBTDL,DGBTCCT,BASERATE,AUTHORIZED,%,WAITTIME,XX,DISTZIP,DGBTOLD,RXDATA,CITYSTZIP,DGBTQ,DGQUERY,DGBTERR,DTOUT,DUOUT,RETURN,LOCRET
"RTN","DGBTEND",16,0)
 K TOTRIPS,TRIP,WAIVER,ONEWAY,RT,MONTOT,LSTMTDT,MOSTENC,MSYS,STDT,RDVMSG,MDATA,PDATA,RTRIP,SDATE,EDATE,EMONTH,DIRUT,DAYFLG
"RTN","DGBTEND",17,0)
QUIT1 K DGBT,DGBTA,DGBTAD,DGBTAI,DGBTAN,DGBTAS,DGBTC,DGBTCA,DGBTCD,DGBTCE,DGBTCH,DGBTCH1,DGBTCL,DGBTCN,DGBTCS,DGBTCSN,DGBTCST,DGBTDD,DGBTDTE,DGBTDTI,DGBTI,DGBTIME,DGBTMTD,DGBTMTI,DGBTNEW,DGBTP,DGBTPAP,DGBTPDE,DGBTPDT,DGBTPDTE,DGBTSCC,DGBTZ
"RTN","DGBTEND",18,0)
 K DGBTMTS,DGBTCSC,DGBTELG,DGBTINC,DGBTDEP,DGBTCMTY,DTOUT,DUOUT,FDA,DGBTOTHER ; created w/ patch 35
"RTN","DGBTEND",19,0)
 K DA,DFN,DIC,DIE,DINUM,DR,S,Y,X,X2,I,J,VA,VADM,VAEL,VAPA,VADAT,VADATE,VAUTD,VAUTNALL,VAUTSTR,DIK
"RTN","DGBTEND",20,0)
 K ^UTILITY($J,"DGBT"),^UTILITY("DGBT",$J),C,DGBTELIG,DGBTSCP,DGBTVAR,DGBTDT,DGBTINFL,DGBTACCT,DGBTACTN,DGBTOACT,DGBTCNU,DGBTFLAG,DGBTFR4,DGBTMETC,DGBTMR,DGBTRATE,DGBTTCTY,DGBTFCTY,CHZFLG,Y1
"RTN","DGBTEND",21,0)
KVAR K VADM(4),VADM(5),VADM(6),VADM(7),VADM(8),VADM(9),VADM(10),VAEL(2),VAEL(4),VAEL(5),VAEL(7),VAEL(8),VAERR,VAPA(7),VAPA(8),VAPA(9),VAPA(10),DIC
"RTN","DGBTEND",22,0)
 K DGBTDEF,PROMPT,DLAYGO,J,DGBTDV1,DGBTRMK,K,DGBTREC,DGBTMD,DGBTSP,DGBTINST,DGARRAY,DG,DGBTAP,DGBTCMTY,DGBTCORE,DGBTCC,DGBTCCREQ,DGBTCCAMT,DGBTCCMODE,DGBTCT,DGBTDCV1,DGBTRDV,DEDUCT
"RTN","DGBTEND",23,0)
 K DGBTCP,DGBTDCM,DGBTDCV,DGBTDE,DGBTDPM,DGBTDPV,DGBTFAB,DGBTFR1,DGBTFR2,DGBTFR3,DGBTMAL,DGBTME,DGBTML,NETINC,PRCFLAG,POP,RXCP,RXCPTS,VACNTRY
"RTN","DGBTEND",24,0)
 K DGBTMLFB,DGBTMLT,DGBTMR1,DGBTOWRT,DGBTRET,DGBTT01,DGBTT02,DGBTT03,DGBTT04,FLAGS,FILE,FIELDS,MTDATA,MTIEN,MTT,OWRTP,DUOUT,DGBTFDA,ERRMSG,X,PAYMENT,SPCOMPLETE,Z
"RTN","DGBTEND",25,0)
 K DIV,DIUDISTCITY,DISTL1,DISTL2,DISTST,DGBTOLD,DEPZIP,DEPST,DEPL2,DEPL1,DEPCITY,D0,ENDMENU,DGBTX1,DGBTDEP,DGBTERR,DTOUT,DUOUT,TOTRIPS,TRIP,WAIVER,ONEWAY,RT,MONTOT,LSTMTDT,MOSTENC,MSYS,STDT
"RTN","DGBTEND",26,0)
 K DGBTRAY,DGBTWAIVER,SDOE0,SDSTOP,DGBTMTTH,DGBTRXTH,DGBTNSC,DGBTDYFL,DGBTSCAP,DGBTCPAP,DGBTQAP,DGBTQ1,ACCT,D,PATCHNBR,DGBTREF,DGINC,DGBTQ,DGBTQ1
"RTN","DGBTEND",27,0)
 Q
"RTN","DGBTEND",28,0)
HELP ;
"RTN","DGBTEND",29,0)
 W !!,"You may choose from the following: ",!!?5,"<I>nformation - to view the two informational screens",!?5,"<D>isplay - to view this claim",!?5,"<E>d it - to change this claim"
"RTN","DGBTEND",30,0)
 W:DGBTACCT=4!(DGBTACCT=5) !?5,"<P>rint - to print form 70-3542d (132 columns)" W !?5,"<Q>uit - to exit from this option"
"RTN","DGBTEND",31,0)
 Q
"RTN","DGBTEND",32,0)
 ;
"RTN","DGBTEND",33,0)
DELSP ;this will delete the Special Mode Claim
"RTN","DGBTEND",34,0)
 I $G(DGBTCMTY)="S" W !,"This claim is now being deleted....." S DGBTTOUT="",DIK="^DGBT(392,",DA=DGBTDT D ^DIK G PATIENT^DGBTE
"RTN","DGBTEND",35,0)
 Q
"RTN","DGBTMTTH")
0^41^B797719
"RTN","DGBTMTTH",1,0)
DGBTMTTH ;BLD-RETRIVE MT THRESHOLD AMOUNTS; 10/05/2012@1130; 03/04/2012
"RTN","DGBTMTTH",2,0)
 ;;1.0;Beneficiary Travel;**20**;March 4, 2012;Build 185
"RTN","DGBTMTTH",3,0)
 ;
"RTN","DGBTMTTH",4,0)
 Q
"RTN","DGBTMTTH",5,0)
 ;
"RTN","DGBTMTTH",6,0)
MTTH(DEP,DGBTDT) ;entry point to return MT threshold amounts
"RTN","DGBTMTTH",7,0)
 ;      input - DEP - number of dependents
"RTN","DGBTMTTH",8,0)
 ;              DGBTDT - BT Claim Date
"RTN","DGBTMTTH",9,0)
 ;      output - DGBTMTTH - MT threshold amount
"RTN","DGBTMTTH",10,0)
 ;
"RTN","DGBTMTTH",11,0)
 N DGBTMTTH,DGBTYEAR,THDATA,MTYEAR,DGBTTH,DGBTTHD1,DGBTTHD2
"RTN","DGBTMTTH",12,0)
 S DGBTMTTH=0
"RTN","DGBTMTTH",13,0)
 S DGBTYEAR=$E(DGBTDT,1,3)_"0000"+1
"RTN","DGBTMTTH",14,0)
 S MTYEAR=$O(^DG(43,1,"MT",DGBTYEAR),-1)
"RTN","DGBTMTTH",15,0)
 S THDATA=^DG(43,1,"MT",MTYEAR,0)
"RTN","DGBTMTTH",16,0)
 S DGBTTH=$P(THDATA,"^",2)
"RTN","DGBTMTTH",17,0)
 S DGBTTHD1=$P(THDATA,"^",3)
"RTN","DGBTMTTH",18,0)
 S DGBTTHD2=$P(THDATA,"^",4)
"RTN","DGBTMTTH",19,0)
 I DEP=0 Q DGBTTH
"RTN","DGBTMTTH",20,0)
 I DEP=1 Q DGBTTH+DGBTTHD1
"RTN","DGBTMTTH",21,0)
 I DEP>1 Q DGBTTH+DGBTTHD1+(DGBTTHD2*(DEP-1))
"RTN","DGBTMTTH",22,0)
 ;
"RTN","DGBTMTTH",23,0)
 Q DGBTMTTH
"RTN","DGBTR")
0^14^B18418330
"RTN","DGBTR",1,0)
DGBTR ;ALB/LM - BENEFICIARY TRAVEL RE-PRINT; 1/30/89@8:00 ;4/26/91  14:32
"RTN","DGBTR",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTR",3,0)
 ;
"RTN","DGBTR",4,0)
 Q
"RTN","DGBTR",5,0)
DISPLAY ;display the selected claim
"RTN","DGBTR",6,0)
 N DGBTCMTY,NOLINE
"RTN","DGBTR",7,0)
 D QUIT^DGBTEND
"RTN","DGBTR",8,0)
 S DGBTR=1 D ASK I $G(DFN)="" D QUIT Q
"RTN","DGBTR",9,0)
 I '$D(DGBTDT) D QUIT
"RTN","DGBTR",10,0)
 S DGBTCMTY=$$GET1^DIQ(392,DGBTDT,56)
"RTN","DGBTR",11,0)
 D CLMTYP(.DGBTCMTY)
"RTN","DGBTR",12,0)
 I $G(DGBTCMTY)="S" S NOLINE=0 K DGBTSP D SCREEN^DGBTCDSP D QUIT,DISPLAY Q
"RTN","DGBTR",13,0)
 I '$D(DGBTDT) D QUIT Q
"RTN","DGBTR",14,0)
 I '$D(^DGBT(392,DGBTDT,0)) D QUIT Q
"RTN","DGBTR",15,0)
 S VADAT("W")=DGBTDT
"RTN","DGBTR",16,0)
 D ^VADATE
"RTN","DGBTR",17,0)
 S DGBTDTE=VADATE("E"),IOP=""
"RTN","DGBTR",18,0)
 D ^%ZIS
"RTN","DGBTR",19,0)
 D SCREEN^DGBTCD
"RTN","DGBTR",20,0)
 D QUIT
"RTN","DGBTR",21,0)
 D DISPLAY Q
"RTN","DGBTR",22,0)
 ;
"RTN","DGBTR",23,0)
REPRINT ;
"RTN","DGBTR",24,0)
 N DGBTDLTR
"RTN","DGBTR",25,0)
 S DGBTR=0 D ASK
"RTN","DGBTR",26,0)
 I '$D(DGBTDT) D QUIT Q
"RTN","DGBTR",27,0)
 S DGBTDLTR=$$GET1^DIQ(392,DGBTDT,45.2,"I")
"RTN","DGBTR",28,0)
 I DGBTDLTR=1 W !!,"CLAIM WAS DENIED. NO VOUCHER FOR THIS CLAIM",!! D QUIT D REPRINT Q
"RTN","DGBTR",29,0)
 I '$D(^DGBT(392,DGBTDT,0)) D QUIT Q
"RTN","DGBTR",30,0)
 I '$D(MONTOT) N MONTOT D 
"RTN","DGBTR",31,0)
 .N TOTRIPS,ONEWAY,RT,MONTHDED,WAIVER,WTYPE,TTRIPS,TDED,DGBTDTI,RDVMSG,DGBTRET,DGBTRDV,TFIEN
"RTN","DGBTR",32,0)
 .S DGBTDTI=DGBTA
"RTN","DGBTR",33,0)
 .D MONTOT^DGBT1(.TOTRIPS,.ONEWAY,.RT,.MONTHDED,.WAIVER,.WTYPE,.TTRIPS,.TDED)
"RTN","DGBTR",34,0)
 D START^DGBTCR
"RTN","DGBTR",35,0)
 D QUIT Q
"RTN","DGBTR",36,0)
 ;
"RTN","DGBTR",37,0)
ASK ;
"RTN","DGBTR",38,0)
 S DIC="^DPT(",DIC(0)="AEQMZ" D ^DIC
"RTN","DGBTR",39,0)
 I Y<1 D QUIT Q
"RTN","DGBTR",40,0)
 S DFN=+Y
"RTN","DGBTR",41,0)
 I '$D(^DGBT(392,"C",DFN)) W !!,"There are no computer entries on file for this patient.",! D ASK Q
"RTN","DGBTR",42,0)
 D 6^VADPT
"RTN","DGBTR",43,0)
 K ^UTILITY($J,"DGBT")
"RTN","DGBTR",44,0)
 W:'DGBTR !!,"Only claims with ACCOUNT TYPE of ALL OTHER or C&P are listed as choices.",! D LIST Q
"RTN","DGBTR",45,0)
 Q
"RTN","DGBTR",46,0)
 ;
"RTN","DGBTR",47,0)
LIST ;list the patients claim by newest claim first
"RTN","DGBTR",48,0)
 ;
"RTN","DGBTR",49,0)
 N DGBTDCLM
"RTN","DGBTR",50,0)
 S X="",(DGBTC,DGBTCH)=0
"RTN","DGBTR",51,0)
 F I=0:0 S I=$O(^DGBT(392,"AI",DFN,I)) Q:'I  S J=^(I) I $S(DGBTR:1,$D(^DGBT(392,"ACTP",4,J)):1,$D(^DGBT(392,"ACTP",5,J)):1,1:0) S DGBTC=DGBTC+1,^UTILITY($J,"DGBT",DGBTC,I)=9999999.99999-I
"RTN","DGBTR",52,0)
 I '$D(^UTILITY($J,"DGBT"))!'$D(^DGBT(392,"C",DFN)) W !,"There are no computer entries on file for this patient with these account types.",! D ASK Q
"RTN","DGBTR",53,0)
 I $D(^UTILITY($J,"DGBT")) W !,"Select Claim DATE/TIME: ",!
"RTN","DGBTR",54,0)
 ;F I=0:0 S I=$O(^UTILITY($J,"DGBT",I)) Q:'I!(DGBTCH)!(X["^")  D  I K#5=0 D CHOZ G QUIT:$D(DTOUT) Q:DGBTCH
"RTN","DGBTR",55,0)
 F I=0:0 S I=$O(^UTILITY($J,"DGBT",I)) D CHOZLAST Q:'I!(DGBTCH)!(X["^")  D  G QUIT:$D(DTOUT)!($D(DUOUT)) Q:DGBTCH
"RTN","DGBTR",56,0)
 .F J=0:0 S J=$O(^UTILITY($J,"DGBT",I,J)) Q:'J  Q:DGBTCH  D
"RTN","DGBTR",57,0)
 ..S K=I,VADAT("W")=^(J)
"RTN","DGBTR",58,0)
 ..D ^VADATE S DGBTDCLM=$$GET1^DIQ(392,VADAT("W"),45,"I")
"RTN","DGBTR",59,0)
 ..W !?5,I,".",?10,VADATE("E")_$S($G(DGBTDCLM)'="":" (D)",1:"") D:K#5=0 CHOZ Q:DGBTCH  I $D(DTOUT)!($D(DUOUT)) Q  ;D QUIT Q
"RTN","DGBTR",60,0)
 I DGBTCH S DGBTA=$O(^UTILITY($J,"DGBT",X,0)),DGBTA=^UTILITY($J,"DGBT",X,DGBTA) S (DGBTDT,VADAT("W"))=DGBTA D ^VADATE S DGBTDCLM=$$GET1^DIQ(392,VADAT("W"),45,"I") W "  ",VADATE("E")_$S($G(DGBTDCLM)'="":" (D)",1:"")
"RTN","DGBTR",61,0)
 I 'DGBTCH D ASK
"RTN","DGBTR",62,0)
 Q
"RTN","DGBTR",63,0)
 ;
"RTN","DGBTR",64,0)
CHOZ ;
"RTN","DGBTR",65,0)
 Q:DGBTCH
"RTN","DGBTR",66,0)
 I K'=DGBTC S DIR("A",1)="",DIR("A",2)="Type '^' to Stop, or" S DIR("?")="^D HELP^DGBTR"
"RTN","DGBTR",67,0)
 S DIR("A")="Choose 1-"_$S(K=1:"",1:K)_": ",DIR(0)="NOA^1:"_K  D ^DIR K DIR S:$D(DTOUT) DTOUT=1 I Y,$D(^UTILITY($J,"DGBT",Y)) S DGBTCH=1 Q
"RTN","DGBTR",68,0)
 Q
"RTN","DGBTR",69,0)
CHOZLAST ;
"RTN","DGBTR",70,0)
 Q:I
"RTN","DGBTR",71,0)
 Q:DGBTCH
"RTN","DGBTR",72,0)
 D CHOZ
"RTN","DGBTR",73,0)
 Q
"RTN","DGBTR",74,0)
QUIT K DIC,DTOUT,X,VA,VADAT,VADATE,DGBTDT,DFN,VAEL,VADM,VAPA,DFN,DGBTA,DGBTC,DGBTCH,DGBTDTE,DGBTR,I,J,K,Y,DGBTFCTY,DGBTMR,DGBTTCTY,VAERR,DGBTCNU,DGBTVAR
"RTN","DGBTR",75,0)
 K DEDUCT,DTOTAL,ONEWAY,RTRIP,MDATA,PDATA,DGVAR,DGPGM,DGBTACCT,CDAT,EMONTH,EDATE
"RTN","DGBTR",76,0)
 Q
"RTN","DGBTR",77,0)
 ; 
"RTN","DGBTR",78,0)
HELP W !!,"ANSWER WITH NUMERIC CHOICE.  BECAUSE ENTRIES ARE STORED BY DATE.TIME.SECONDS,",!,"YOU MUST ENTER A NUMERIC CHOICE."
"RTN","DGBTR",79,0)
 Q
"RTN","DGBTR",80,0)
 ;
"RTN","DGBTR",81,0)
CLMTYP(DGBTCMTY) ;this will return the claim type from ^DGBT(392,IEN,0) field #56. If equal null then mileage claim, if equal "S", special mode claim
"RTN","DGBTR",82,0)
 S DGBTCMTY=$$GET1^DIQ(392,DGBTDT,56,"I")
"RTN","DGBTR",83,0)
 S DGBTCMTY=$S($G(DGBTCMTY)="S":DGBTCMTY,1:"M")
"RTN","DGBTR",84,0)
 Q
"RTN","DGBTR",85,0)
 ;
"RTN","DGBTR121")
0^28^B74474591
"RTN","DGBTR121",1,0)
DGBTR121 ;ALB/RFE - SUMMARY REPORT; 05/02/12
"RTN","DGBTR121",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTR121",3,0)
 Q
"RTN","DGBTR121",4,0)
EN ;Entry point
"RTN","DGBTR121",5,0)
 N %,%Y,CCFEE,DATALINE,DGBTEXCEL,DGBTDIV,DGBTDIVN,DGBTQ,ENDDT,ENTRY,EQUAL,GRAND,I,LINEM,LINESP,LINEZERO,PAGE,PDT,POP,PROMPT,STARTDT,SQ,TYPE,X,X2,Y
"RTN","DGBTR121",6,0)
 N ZTQUEUED
"RTN","DGBTR121",7,0)
 D CLEAN^DILF
"RTN","DGBTR121",8,0)
 S X2="2$",DGBTEXCEL=0
"RTN","DGBTR121",9,0)
 K DIR
"RTN","DGBTR121",10,0)
 S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR121",11,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR121",12,0)
 S STARTDT=Y
"RTN","DGBTR121",13,0)
 S DIR("A")="END DATE: ",DIR(0)="DA^"_STARTDT_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR121",14,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR121",15,0)
 S ENDDT=Y
"RTN","DGBTR121",16,0)
 K DIR
"RTN","DGBTR121",17,0)
 S DIR(0)="S^M:MILEAGE;S:SPECIAL MODE",DIR("A")="Which claim type do you want to run?" D ^DIR K DIR
"RTN","DGBTR121",18,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR121",19,0)
 S TYPE=Y
"RTN","DGBTR121",20,0)
 S X=$G(^DG(40.8,0)) I X="" W !,"WARNING...MEDICAL CENTER DIVISION FILE IS NOT SET UP",!,"USE THE ADT PARAMETER OPTION FILE TO SET UP DIVISION" D CLEAN^DILF Q
"RTN","DGBTR121",21,0)
 D
"RTN","DGBTR121",22,0)
 .I $$GET1^DIQ(43,1,11,"I") D  Q
"RTN","DGBTR121",23,0)
 ..S DGBTDIVN=$$YESNO^DGBTUTL("Do you wish to run this report for all divisions")
"RTN","DGBTR121",24,0)
 ..I DGBTDIVN S DGBTDIVN="ALL",DGBTDIV="" Q
"RTN","DGBTR121",25,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR121",26,0)
 ..K DIR S DIR(0)="P^40.8:EMZ" D ^DIR K DIR
"RTN","DGBTR121",27,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR121",28,0)
 ..S DGBTDIVN=+Y,DGBTDIV=$P(Y,U,2)
"RTN","DGBTR121",29,0)
 .S DGBTDIVN=$O(^DG(40.8,0)),DGBTDIV=$P(^DG(40.8,DGBTDIVN,0),U)
"RTN","DGBTR121",30,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR121",31,0)
 D SETPRT,QUIT
"RTN","DGBTR121",32,0)
 Q
"RTN","DGBTR121",33,0)
SETPRT ;
"RTN","DGBTR121",34,0)
 S DGBTEXCEL=$$SELEXCEL^DGBTUTL
"RTN","DGBTR121",35,0)
 I $G(DGBTEXCEL)="^" Q
"RTN","DGBTR121",36,0)
 I '$G(DGBTEXCEL) N COLWID S COLWID=132 D PRINTMSG^DGBTUTL
"RTN","DGBTR121",37,0)
 D DEVICE^DGBTUTL("Beneficiary Travel Summary Report","MAIN^DGBTR121(STARTDT,ENDDT,DGBTDIVN,DGBTDIV)")
"RTN","DGBTR121",38,0)
 ;D DEVICE^DGBTUTL("Beneficiary Travel Summary Report","MAIN^DGBTR121",DGBTEXCEL,132)
"RTN","DGBTR121",39,0)
 I $G(DGBTQ) Q
"RTN","DGBTR121",40,0)
 ;
"RTN","DGBTR121",41,0)
 I $D(IO("Q")) D:'$D(ZTQUEUED) ^%ZISC Q
"RTN","DGBTR121",42,0)
 D MAIN(STARTDT,ENDDT,DGBTDIVN,DGBTDIV)
"RTN","DGBTR121",43,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","DGBTR121",44,0)
 U IO
"RTN","DGBTR121",45,0)
 Q
"RTN","DGBTR121",46,0)
MAIN(STARTDT,ENDDT,DGBTDIVN,DGBTDIV) ;
"RTN","DGBTR121",47,0)
 K ^TMP("DGBTRPS",$J)
"RTN","DGBTR121",48,0)
 D GETRECS
"RTN","DGBTR121",49,0)
 I '$D(^TMP("DGBTRPS",$J)) W !,"No records found" D QUIT Q
"RTN","DGBTR121",50,0)
 D PRINT
"RTN","DGBTR121",51,0)
 Q
"RTN","DGBTR121",52,0)
GETRECS ;
"RTN","DGBTR121",53,0)
 I TYPE="M" F I="CLAIMS","MILEAGE","CC FEE","ECON","M&L","F&B","DED","PAY" S GRAND(I)=0
"RTN","DGBTR121",54,0)
 I TYPE="S" F I="CLAIMS","MILEAGE","BASE RATE","MILEAGE FEE","NSNL","WAIT TIME","EXTRA CREW","SPECIAL EQUIPMENT","INVOICE AMOUNT" S GRAND(I)=0
"RTN","DGBTR121",55,0)
 S ENTRY=$O(^DGBT(392,"D",STARTDT),-1)
"RTN","DGBTR121",56,0)
 F  S ENTRY=$O(^DGBT(392,"D",ENTRY)) Q:ENTRY=""  Q:ENTRY>ENDDT  D
"RTN","DGBTR121",57,0)
 .S I=""
"RTN","DGBTR121",58,0)
 .F  S I=$O(^DGBT(392,"D",ENTRY,I)) Q:I=""  D GETLINE
"RTN","DGBTR121",59,0)
 Q
"RTN","DGBTR121",60,0)
GETLINE ;
"RTN","DGBTR121",61,0)
 S LINEZERO=$G(^DGBT(392,I,0))
"RTN","DGBTR121",62,0)
 I $$GET1^DIQ(392,I,45.2,"I") Q    ;'="NO" Q
"RTN","DGBTR121",63,0)
 I '$$DIV Q
"RTN","DGBTR121",64,0)
 S SQ=$P(LINEZERO,U,13)_U_$P(LINEZERO,"^",11)_U_$P(LINEZERO,U,6)
"RTN","DGBTR121",65,0)
 S DATALINE=$G(^TMP("DGBTRPS",$J,SQ))
"RTN","DGBTR121",66,0)
 S $P(DATALINE,U)=1+$P(DATALINE,U) ; CLAIMS
"RTN","DGBTR121",67,0)
 I TYPE="M" D GLMILES Q
"RTN","DGBTR121",68,0)
 I TYPE="S" D GLSP Q
"RTN","DGBTR121",69,0)
 Q
"RTN","DGBTR121",70,0)
DIV() ;
"RTN","DGBTR121",71,0)
 I DGBTDIVN="ALL" Q 1
"RTN","DGBTR121",72,0)
 Q $P(LINEZERO,U,11)=DGBTDIVN
"RTN","DGBTR121",73,0)
GLMILES ;
"RTN","DGBTR121",74,0)
 I $$GET1^DIQ(392,I,56,"I")'="M" Q
"RTN","DGBTR121",75,0)
 S LINEM=$G(^DGBT(392,I,"M"))
"RTN","DGBTR121",76,0)
 S CCFEE=$$GET1^DIQ(392,I,55)
"RTN","DGBTR121",77,0)
 ;S PAYABLE=$$PAYABLE
"RTN","DGBTR121",78,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR121",79,0)
 S $P(DATALINE,U,2)=($P(LINEM,U)*$P(LINEM,U,2))+$P(DATALINE,U,2) ; MILEAGE
"RTN","DGBTR121",80,0)
 S GRAND("MILEAGE")=GRAND("MILEAGE")+($P(LINEM,U)*$P(LINEM,U,2))
"RTN","DGBTR121",81,0)
 S $P(DATALINE,U,3)=CCFEE+$P(DATALINE,U,3) ;COMMON CARRIER FEE
"RTN","DGBTR121",82,0)
 S GRAND("CC FEE")=GRAND("CC FEE")+$$GET1^DIQ(392,I,55)
"RTN","DGBTR121",83,0)
 S $P(DATALINE,U,4)=$P(LINEZERO,U,8)+$P(DATALINE,U,4) ; MOST ECONOMICAL COST
"RTN","DGBTR121",84,0)
 S GRAND("ECON")=GRAND("ECON")+$P(LINEZERO,U,8)
"RTN","DGBTR121",85,0)
 S $P(DATALINE,U,5)=$P(LINEM,U,4)+$P(DATALINE,U,5) ; MEALS & LODGING
"RTN","DGBTR121",86,0)
 S GRAND("M&L")=GRAND("M&L")+$P(LINEM,U,4)
"RTN","DGBTR121",87,0)
 S $P(DATALINE,U,6)=$P(LINEM,U,5)+$P(DATALINE,U,6) ; FERRIES & BRIDGES
"RTN","DGBTR121",88,0)
 S GRAND("F&B")=GRAND("F&B")+$P(LINEM,U,5)
"RTN","DGBTR121",89,0)
 S $P(DATALINE,U,7)=$P(LINEZERO,U,9)+$P(DATALINE,U,7) ; DEDUCTIBLE
"RTN","DGBTR121",90,0)
 S GRAND("DED")=GRAND("DED")+$P(LINEZERO,U,9)
"RTN","DGBTR121",91,0)
 S $P(DATALINE,U,8)=$P(LINEZERO,U,10)+$P(DATALINE,U,8) ; PAYABLE
"RTN","DGBTR121",92,0)
 S GRAND("PAY")=GRAND("PAY")+$P(LINEZERO,U,10)
"RTN","DGBTR121",93,0)
 S ^TMP("DGBTRPS",$J,SQ)=DATALINE
"RTN","DGBTR121",94,0)
 Q
"RTN","DGBTR121",95,0)
GLSP ;
"RTN","DGBTR121",96,0)
 I $$GET1^DIQ(392,I,56,"I")'="S" Q
"RTN","DGBTR121",97,0)
 S LINESP=$G(^DGBT(392,I,"SP"))
"RTN","DGBTR121",98,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR121",99,0)
 S $P(DATALINE,U,2)=$P(LINESP,U,12)+$P(DATALINE,U,2) ;MILEAGE
"RTN","DGBTR121",100,0)
 S GRAND("MILEAGE")=GRAND("MILEAGE")+$P(LINESP,U,12)
"RTN","DGBTR121",101,0)
 S $P(DATALINE,U,3)=$P(LINESP,U,5)+$P(DATALINE,U,3) ; BASE RATE FEE
"RTN","DGBTR121",102,0)
 S GRAND("BASE RATE")=GRAND("BASE RATE")+$P(LINESP,U,5)
"RTN","DGBTR121",103,0)
 S $P(DATALINE,U,4)=$P(LINESP,U,6)+$P(DATALINE,U,4) ; MILEAGE FEE
"RTN","DGBTR121",104,0)
 S GRAND("MILEAGE FEE")=GRAND("MILEAGE FEE")+$P(LINESP,U,6)
"RTN","DGBTR121",105,0)
 S $P(DATALINE,U,5)=$P(LINESP,U,7)+$P(DATALINE,U,5) ; NO LOAD/NO SHOW
"RTN","DGBTR121",106,0)
 S GRAND("NSNL")=GRAND("NSNL")+$P(LINESP,U,7)
"RTN","DGBTR121",107,0)
 S $P(DATALINE,U,6)=$P(LINESP,U,8)+$P(DATALINE,U,6) ; WAIT TIME
"RTN","DGBTR121",108,0)
 S GRAND("WAIT TIME")=GRAND("WAIT TIME")+$P(LINESP,U,8)
"RTN","DGBTR121",109,0)
 S $P(DATALINE,U,7)=$P(LINESP,U,9)+$P(DATALINE,U,7) ; EXTRA CREW
"RTN","DGBTR121",110,0)
 S GRAND("EXTRA CREW")=GRAND("EXTRA CREW")+$P(LINESP,U,9)
"RTN","DGBTR121",111,0)
 S $P(DATALINE,U,8)=$P(LINESP,U,10)+$P(DATALINE,U,8) ; SPECIAL EQUIPMENT
"RTN","DGBTR121",112,0)
 S GRAND("SPECIAL EQUIPMENT")=GRAND("SPECIAL EQUIPMENT")+$P(LINESP,U,10)
"RTN","DGBTR121",113,0)
 S $P(DATALINE,U,9)=$P(LINESP,U,4)+$P(DATALINE,U,9) ; TOTAL INVOICE AMOUNT
"RTN","DGBTR121",114,0)
 S GRAND("INVOICE AMOUNT")=GRAND("INVOICE AMOUNT")+$P(LINESP,U,4)
"RTN","DGBTR121",115,0)
 S ^TMP("DGBTRPS",$J,SQ)=DATALINE
"RTN","DGBTR121",116,0)
 Q
"RTN","DGBTR121",117,0)
PRINT ;
"RTN","DGBTR121",118,0)
 U IO
"RTN","DGBTR121",119,0)
 I $G(DGBTEXCEL) D
"RTN","DGBTR121",120,0)
 .I TYPE="M" W "DATE ENTERED^DIVISION^ACCT^# CLAIMS^MILEAGE^CC FEE^MOST ECONOMIC^M & L^FERRIES AND BRIDGES^DEDUCTIBLE^AMOUNT PAYABLE" Q
"RTN","DGBTR121",121,0)
 .W "DATE ENTERED^DIVISION^ACCT^# CLAIMS^MILEAGE^BASE RATE^MILEAGE FEE^NO SHOW NO LOAD^WAIT TIME^EXTRA CREW^SPECIAL EQUPIMENT^INV AMT"
"RTN","DGBTR121",122,0)
 S (PROMPT,SQ)="",PAGE=0,$P(EQUAL,"=",133)=""
"RTN","DGBTR121",123,0)
 D NOW^%DTC S Y=% D DD^%DT S PDT=Y
"RTN","DGBTR121",124,0)
 I (TYPE="M")&('$G(DGBTEXCEL)) D HDRMIL
"RTN","DGBTR121",125,0)
 I (TYPE="S")&('$G(DGBTEXCEL)) D HDRSP
"RTN","DGBTR121",126,0)
 F  S SQ=$O(^TMP("DGBTRPS",$J,SQ)) Q:SQ=""  D  Q:PROMPT="^"
"RTN","DGBTR121",127,0)
 .S DATALINE=^TMP("DGBTRPS",$J,SQ)
"RTN","DGBTR121",128,0)
 .I $G(DGBTEXCEL) D PRTXL Q
"RTN","DGBTR121",129,0)
 .I (TYPE="M")&(($Y+3)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR121",130,0)
 ..I ($E(IOST,1)="C"),(IOSL'[99) R !,"Please press return to continue or '^' to stop ",PROMPT:DTIME Q:PROMPT="^"
"RTN","DGBTR121",131,0)
 ..D HDRMIL
"RTN","DGBTR121",132,0)
 .I (TYPE="S")&(($Y+3)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR121",133,0)
 ..I ($E(IOST,1)="C"),(IOSL'[99) R !,"Please press return to continue or '^' to stop ",PROMPT:DTIME Q:PROMPT="^"
"RTN","DGBTR121",134,0)
 ..D HDRSP
"RTN","DGBTR121",135,0)
 .I TYPE="M" D
"RTN","DGBTR121",136,0)
 ..W !,$S(DGBTDIV'="":DGBTDIV,1:$$GET1^DIQ(40.8,$P(SQ,U,2),.01)),?37,$$FMTE^XLFDT($P(SQ,U)),?50,$$GET1^DIQ(392.3,$P(SQ,U,3),2),?55,$P(DATALINE,U)
"RTN","DGBTR121",137,0)
 ..W ?64,$P(DATALINE,U,2),?72,$$DLRAMT($P(DATALINE,U,3)),?87,$$DLRAMT($P(DATALINE,U,4)),?99,$$DLRAMT($P(DATALINE,U,5)),?112,$$DLRAMT($P(DATALINE,U,6))
"RTN","DGBTR121",138,0)
 ..W !?5,$$DLRAMT($P(DATALINE,U,7)),?18,$$DLRAMT($P(DATALINE,U,8))
"RTN","DGBTR121",139,0)
 .I TYPE="S" D
"RTN","DGBTR121",140,0)
 ..W !,$S(DGBTDIV'="":DGBTDIV,1:$$GET1^DIQ(40.8,$P(SQ,U,2),.01)),?37,$$FMTE^XLFDT($P(SQ,U)),?50,$$GET1^DIQ(392.3,$P(SQ,U,3),2),?55,$P(DATALINE,U)
"RTN","DGBTR121",141,0)
 ..W ?64,$P(DATALINE,U,2),?72,$$DLRAMT($P(DATALINE,U,3)),?87,$$DLRAMT($P(DATALINE,U,4)),?99,$$DLRAMT($P(DATALINE,U,5)),?111,$$DLRAMT($P(DATALINE,U,6))
"RTN","DGBTR121",142,0)
 ..W !,?5,$$DLRAMT($P(DATALINE,U,7)),?17,$$DLRAMT($P(DATALINE,U,8)),?29,$$DLRAMT($P(DATALINE,U,9))
"RTN","DGBTR121",143,0)
 I '$G(DGBTEXCEL) D
"RTN","DGBTR121",144,0)
 .I ($Y+4)<IOSL W !!!
"RTN","DGBTR121",145,0)
 .I TYPE="M" D GRANDMIL
"RTN","DGBTR121",146,0)
 .I TYPE="S" D GRANDSP
"RTN","DGBTR121",147,0)
  I IOST["C-" S DGBTQ=1 S Y=$$PAUSE^DGBTUTL(DGBTEXCEL)
"RTN","DGBTR121",148,0)
  I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR121",149,0)
 Q
"RTN","DGBTR121",150,0)
PRTXL ;
"RTN","DGBTR121",151,0)
 W !,$$FMTE^XLFDT($P(SQ,U)),U,$S(DGBTDIV'="":DGBTDIV,1:$$GET1^DIQ(40.8,$P(SQ,U,2),.01)),U,$$GET1^DIQ(392.3,$P(SQ,U,3),2)
"RTN","DGBTR121",152,0)
 F I=1,2 W U,$P(DATALINE,U,I)
"RTN","DGBTR121",153,0)
 F I=3:1:$L(DATALINE,U) W U,$$DLRAMT($P(DATALINE,U,I))
"RTN","DGBTR121",154,0)
 Q
"RTN","DGBTR121",155,0)
HDRMIL ;
"RTN","DGBTR121",156,0)
 S PAGE=PAGE+1
"RTN","DGBTR121",157,0)
 W @IOF
"RTN","DGBTR121",158,0)
 W "BT SUMMARY REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR121",159,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR121",160,0)
 W !,"CLAIM TYPE: MILEAGE"
"RTN","DGBTR121",161,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:DGBTDIV)
"RTN","DGBTR121",162,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",163,0)
 W !,"DIVISION",?37,"ENTERED",?50,"ACCT",?55,"CLAIMS",?64,"MILEAGE",?72,"CC FEE",?87,"MOST ECON",?99,"M&L",?112,"F&B"
"RTN","DGBTR121",164,0)
 W !,?5,"DED",?18,"PAYABLE"
"RTN","DGBTR121",165,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",166,0)
 Q
"RTN","DGBTR121",167,0)
HDRSP ;
"RTN","DGBTR121",168,0)
 S PAGE=PAGE+1
"RTN","DGBTR121",169,0)
 W @IOF
"RTN","DGBTR121",170,0)
 W "BT SUMMARY REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR121",171,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR121",172,0)
 W !,"CLAIM TYPE: SPECIAL MODE"
"RTN","DGBTR121",173,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:DGBTDIV)
"RTN","DGBTR121",174,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",175,0)
 W !,"DIVISION",?37,"ENTERED",?50,"ACCT",?55,"CLAIMS",?64,"MILEAGE",?72,"BASE RATE",?87,"MILEAGE FEE",?99,"NSNL",?111,"WAIT TIME"
"RTN","DGBTR121",176,0)
 W !,?5,"EXTRA CREW",?17,"SPEC EQ",?29,"INV AMT"
"RTN","DGBTR121",177,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",178,0)
 Q
"RTN","DGBTR121",179,0)
GRANDMIL ;
"RTN","DGBTR121",180,0)
 I ($Y+5)>IOSL D HDRMIL
"RTN","DGBTR121",181,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",182,0)
 W !,?55,"CLAIMS",?64,"MILEAGE",?72,"CC FEE",?87,"MOST ECON",?99,"M&L",?112,"F&B"
"RTN","DGBTR121",183,0)
 W !,?5,"DED",?18,"PAYABLE"
"RTN","DGBTR121",184,0)
 W !,?55,GRAND("CLAIMS"),?64,GRAND("MILEAGE"),?72,$$DLRAMT(GRAND("CC FEE")),?87,$$DLRAMT(GRAND("ECON")),?99,$$DLRAMT(GRAND("M&L"))
"RTN","DGBTR121",185,0)
 W ?112,$$DLRAMT(GRAND("F&B")),!,?5,$$DLRAMT(GRAND("DED")),?18,$$DLRAMT(GRAND("PAY"))
"RTN","DGBTR121",186,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",187,0)
 Q
"RTN","DGBTR121",188,0)
GRANDSP ;
"RTN","DGBTR121",189,0)
 I ($Y+5)>IOSL D HDRSP
"RTN","DGBTR121",190,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",191,0)
 W !,"GRAND TOTALS:",?55,GRAND("CLAIMS"),?64,GRAND("MILEAGE"),?72,$$DLRAMT(GRAND("BASE RATE")),?87,$$DLRAMT(GRAND("MILEAGE FEE"))
"RTN","DGBTR121",192,0)
 W ?99,$$DLRAMT(GRAND("NSNL")),?111,$$DLRAMT(GRAND("WAIT TIME")),!,?5,$$DLRAMT(GRAND("EXTRA CREW")),?17,$$DLRAMT(GRAND("SPECIAL EQUIPMENT"))
"RTN","DGBTR121",193,0)
 W ?29,$$DLRAMT(GRAND("INVOICE AMOUNT"))
"RTN","DGBTR121",194,0)
 W !,$E(EQUAL,1,122)
"RTN","DGBTR121",195,0)
 Q
"RTN","DGBTR121",196,0)
DLRAMT(X) ;
"RTN","DGBTR121",197,0)
 D COMMA^%DTC I '$G(DGBTEXCEL) Q $TR(X," ","")
"RTN","DGBTR121",198,0)
 Q $TR(X," ,$","")
"RTN","DGBTR121",199,0)
QUIT ; 
"RTN","DGBTR121",200,0)
 K ^TMP("DGBTRPS",$J)
"RTN","DGBTR121",201,0)
 D CLEAN^DILF
"RTN","DGBTR121",202,0)
 Q
"RTN","DGBTR122")
0^29^B36391990
"RTN","DGBTR122",1,0)
DGBTR122 ;PAV - BENEFICIARY/TRAVEL E12.2 ROUTINE; 6/20/2012@1130 ;11/14/11  09:58
"RTN","DGBTR122",2,0)
 ;;1.0;Beneficiary Travel;**20**;July 25, 2012;Build 185
"RTN","DGBTR122",3,0)
 Q
"RTN","DGBTR122",4,0)
EN ;12.2 Audit Report
"RTN","DGBTR122",5,0)
 W *7,!!,"        ************* BT  Audit Report *************",!
"RTN","DGBTR122",6,0)
 N DIR,A,AA,B,C,Y,X,I,DA,DIK,DIC,FDA,SDATE,EDATE,SNAME,ENAME,A,DFN,H1,H0,H2,SDATEP,EDATEP,TXT,EXIT,SPR,DEL,DGBTQ,VADM,EXCEL,LINE,PAGE,XDATE,XXDATE
"RTN","DGBTR122",7,0)
 N XNAME,ZTQUEUED
"RTN","DGBTR122",8,0)
 S (EXCEL,EXIT)=0,DEL=U
"RTN","DGBTR122",9,0)
DATE ;
"RTN","DGBTR122",10,0)
 ;Beginning Date. Compared against the Claim entry date.
"RTN","DGBTR122",11,0)
 K DIR S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR122",12,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR122",13,0)
 S SDATE=Y,SDATEP=$$DP(SDATE),SDATE=SDATE-.0001
"RTN","DGBTR122",14,0)
 ;Ending Date. Compared against the Claim entry date.
"RTN","DGBTR122",15,0)
 K DIR S DIR("A")="END DATE:   ",DIR(0)="DA^"_SDATE_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR122",16,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR122",17,0)
 S EDATE=Y,EDATEP=$$DP(EDATE)
"RTN","DGBTR122",18,0)
NAME ;
"RTN","DGBTR122",19,0)
 ;The name of the first veteran to include in the report (last name).  This can be a partial string. Default value is 'AAA'
"RTN","DGBTR122",20,0)
 K DIR S DIR("A")="START NAME  ",DIR("B")="AAA",DIR(0)="F^3:30"    ;DIR(0)="F^1:30^K:X'?1A.A.A X"
"RTN","DGBTR122",21,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR122",22,0)
 S SNAME=$$UP^XLFSTR(Y)
"RTN","DGBTR122",23,0)
 ;The name of the last veteran to include in the report (last name).  This can be a partial string.   Default value is 'ZZZ'
"RTN","DGBTR122",24,0)
 K DIR S DIR("A")="END NAME    ",DIR("B")="ZZZ",DIR(0)="F^3:30"   ;DIR(0)="F^1:30^K:X'?1A.A.A X"
"RTN","DGBTR122",25,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR122",26,0)
 S ENAME=$$UP^XLFSTR(Y)
"RTN","DGBTR122",27,0)
 I SNAME]ENAME W *7,!,"START NAME must be before LAST NAME",! G NAME
"RTN","DGBTR122",28,0)
 S ENAME=ENAME_"Z"
"RTN","DGBTR122",29,0)
 S AA="0,1,2,3,4,5,6,7,21,9,10,11,12,13,14,15,16,17,18,19"
"RTN","DGBTR122",30,0)
 S EXCEL=$$SELEXCEL^DGBTUTL() Q:EXCEL=U  ;
"RTN","DGBTR122",31,0)
 I 'EXCEL N COLWID S COLWID=255 D PRINTMSG^DGBTUTL
"RTN","DGBTR122",32,0)
 S DGBTQ=0 D DEVICE^DGBTUTL("BT Audit Report","QUE^DGBTR122",EXCEL,255) Q:$G(DGBTQ)
"RTN","DGBTR122",33,0)
QUE ;
"RTN","DGBTR122",34,0)
 S B(0)="DATE ENT^10",B(1)="CLAIM DATE^13",B(2)="PATIENT NAME^25",B(3)="SSN^15",B(4)="ELIG^20",B(5)="SC %^6"
"RTN","DGBTR122",35,0)
 S B(6)="ACCT^8",B(7)="R/O^5",B(8)="TOT MILES^10",B(9)="CC MODE^11",B(10)="CC FEE^10",B(11)="ECON^9"
"RTN","DGBTR122",36,0)
 S B(12)="DED^9",B(13)="PAYABLE^9",B(14)="DEP ADDRESS^20",B(15)="DEP CITY^15",B(16)="DEP STATE^18"
"RTN","DGBTR122",37,0)
 S B(17)="DEP ZIP^8",B(18)="DIV^5",B(19)="REMARKS^45",B(20)="CLERK^18",B(21)="MILEAGE^8"
"RTN","DGBTR122",38,0)
 S C(0)="DATE ENTERED^10",C(1)="CLAIM DATE^14",C(2)="PATIENT NAME^16",C(3)="SSN^13",C(4)="ELIGIBILITY^16",C(5)="SC PERCENTAGE^5"
"RTN","DGBTR122",39,0)
 S C(6)="ACCOUNT^16",C(7)="R/O^5",C(8)="TOTAL MILEAGE^7",C(9)="CC MODE^11",C(10)="CC FEE^10",C(11)="MOST ECONOMICAL^9"
"RTN","DGBTR122",40,0)
 S C(12)="DEDUCTIBLE AMOUNT^7",C(13)="AMOUNT PAYABLE^7",C(14)="PLACE OF DEPARTURE^14",C(15)="CITY OF DEPARTURE^12",C(16)="STATE OF DEPARTURE^14"
"RTN","DGBTR122",41,0)
 S C(17)="ZIP CODE OF DEPARTURE^8",C(18)="DIVISION^5",C(19)="REMARKS^42",C(20)="WHO ENTERED INTO FILE^18",C(21)="MILES^6" ;,C(21)="MILES ONE WAY^8"
"RTN","DGBTR122",42,0)
EN1 S PAGE=0,LINE=99999,$P(H1,"-",IOM-1)="-"
"RTN","DGBTR122",43,0)
 S H0="************* BT Audit Report "_SDATEP_"-"_EDATEP_" *************",H2="                                  "
"RTN","DGBTR122",44,0)
 S XDATE=SDATE F  S XDATE=$O(^DGBT(392,"D",XDATE)) Q:'XDATE!(XDATE>EDATE)  D  Q:EXIT
"RTN","DGBTR122",45,0)
 .S XXDATE="" F  S XXDATE=$O(^DGBT(392,"D",XDATE,XXDATE)) Q:'XXDATE  D  Q:EXIT
"RTN","DGBTR122",46,0)
 ..K FDA,A D GETS^DIQ(392,XXDATE_",","**","EI","FDA") Q:'$D(FDA)  ;ZW FDA S EXIT=1 Q
"RTN","DGBTR122",47,0)
 ..S XNAME=$$UP^XLFSTR(FDA(392,XXDATE_",",2,"E")),XNAME=$P(XNAME,U),XNAME=$TR(XNAME,"-"," "),XNAME=$TR(XNAME,"/"," ")
"RTN","DGBTR122",48,0)
 ..Q:XNAME]ENAME!(SNAME]XNAME)  ;Quit if not between names
"RTN","DGBTR122",49,0)
 ..Q:FDA(392,XXDATE_",",45.2,"I")    ;Quit if Denied Claim
"RTN","DGBTR122",50,0)
 ..Q:FDA(392,XXDATE_",",56,"I")="S"  ; Quit if Special Mode
"RTN","DGBTR122",51,0)
 ..S A(0)=$$DP(FDA(392,XXDATE_",",13,"I"))    ;Date Claim entered
"RTN","DGBTR122",52,0)
 ..S A(1)=$$DP(FDA(392,XXDATE_",",.01,"I"))    ;Claim Date
"RTN","DGBTR122",53,0)
 ..S A(2)=FDA(392,XXDATE_",",2,"E")             ;Patient Name
"RTN","DGBTR122",54,0)
 ..S DFN=FDA(392,XXDATE_",",2,"I") D DEM^VADPT
"RTN","DGBTR122",55,0)
 ..S A(3)=$P(VADM(2),U,2)                           ;SSN
"RTN","DGBTR122",56,0)
 ..S A(4)=FDA(392,XXDATE_",",3,"E")             ;Eligibility
"RTN","DGBTR122",57,0)
 ..S A(5)=FDA(392,XXDATE_",",4,"E")             ;SC Percentage
"RTN","DGBTR122",58,0)
 ..S A(6)=+FDA(392,XXDATE_",",6,"E")             ;Account
"RTN","DGBTR122",59,0)
 ..S A(7)=$E(FDA(392,XXDATE_",",31,"E"),1)         ;One Way/Round Trip
"RTN","DGBTR122",60,0)
 ..S A(8)=$$DLRAMT(FDA(392,XXDATE_",",33,"E"))          ;Total Mileage 
"RTN","DGBTR122",61,0)
 ..S A(9)=FDA(392,XXDATE_",",44,"E")             ;Common Carrier mode
"RTN","DGBTR122",62,0)
 ..S A(10)=$$DLRAMT(FDA(392,XXDATE_",",55,"E"))      ;Common Carrier fee 
"RTN","DGBTR122",63,0)
 ..S A(11)=$$DLRAMT(FDA(392,XXDATE_",",8,"E"))       ;Most economical cost 
"RTN","DGBTR122",64,0)
 ..S A(12)=$$DLRAMT(FDA(392,XXDATE_",",9,"E"))      ;Deductible amount
"RTN","DGBTR122",65,0)
 ..S A(13)=$$DLRAMT(FDA(392,XXDATE_",",10,"E"))                       ;Amount payable
"RTN","DGBTR122",66,0)
 ..S A(14)=FDA(392,XXDATE_",",21,"E")               ;Place of departure 
"RTN","DGBTR122",67,0)
 ..S A(15)=FDA(392,XXDATE_",",24,"E")               ;City of departure 
"RTN","DGBTR122",68,0)
 ..S A(16)=FDA(392,XXDATE_",",24.1,"E")            ;State of departure 
"RTN","DGBTR122",69,0)
 ..S A(17)=FDA(392,XXDATE_",",24.2,"E")            ;Zip code of departure
"RTN","DGBTR122",70,0)
 ..S A(18)=FDA(392,XXDATE_",",11,"E")            ;Division
"RTN","DGBTR122",71,0)
 ..S A(19)=FDA(392,XXDATE_",",51,"E")               ;Remarks
"RTN","DGBTR122",72,0)
 ..S A(20)=FDA(392,XXDATE_",",12,"E")            ;WHO ENTERED INTO FILE
"RTN","DGBTR122",73,0)
 ..S A(21)=FDA(392,XXDATE_",",32,"E")               ;MILEAGE/ONE WAY
"RTN","DGBTR122",74,0)
 ..S:A(7)="R" A(21)=A(21)*2              ;If roud trip double miles
"RTN","DGBTR122",75,0)
 ..I FDA(392,XXDATE_",",56,"I")="S" D          ;Handle special mode
"RTN","DGBTR122",76,0)
 ...S A(8)=FDA(392,XXDATE_",",60,"E")          ;SP Total Invoice Amount
"RTN","DGBTR122",77,0)
 ...S A(7)=$E(FDA(392,XXDATE_",",67,"E"),1)      ;SP One Way / Round Trip
"RTN","DGBTR122",78,0)
 ...S A(21)=FDA(392,XXDATE_",",68,"E")             ;SP Total miles ??
"RTN","DGBTR122",79,0)
 ...S A(14)=FDA(392,XXDATE_",",73,"E")                ;SP Place of departure
"RTN","DGBTR122",80,0)
 ...S A(15)=FDA(392,XXDATE_",",75,"E")                ;SP City of departure
"RTN","DGBTR122",81,0)
 ...S A(16)=FDA(392,XXDATE_",",76,"E")                ;SP State of departure
"RTN","DGBTR122",82,0)
 ...S A(17)=FDA(392,XXDATE_",",77,"E")                  ;SP Zip code of departure
"RTN","DGBTR122",83,0)
 ...S A(19)=FDA(392,XXDATE_",",72,"E")                ;SP Remarks
"RTN","DGBTR122",84,0)
 ..I EXCEL D EXCEL Q
"RTN","DGBTR122",85,0)
 ..D PRINT
"RTN","DGBTR122",86,0)
 I IOST["C-" S TT=$$PAUSE^DGBTUTL(EXCEL)
"RTN","DGBTR122",87,0)
 I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR122",88,0)
 D ^%ZISC
"RTN","DGBTR122",89,0)
 Q
"RTN","DGBTR122",90,0)
PRINT ;
"RTN","DGBTR122",91,0)
 N L,T1,TT
"RTN","DGBTR122",92,0)
 D:LINE>IOSL HEADER Q:EXIT
"RTN","DGBTR122",93,0)
 S TXT="",L=0
"RTN","DGBTR122",94,0)
 F L=1:1 S I=$P(AA,",",L) Q:'$L(I)  S T1=$P(B(I),U,2)-$L(A(I)) S:T1'>0 T1=1 S TXT=TXT_$E(A(I),1,$P(B(I),U,2)-1)_$S(I=19:"",1:$E(H2,1,T1))
"RTN","DGBTR122",95,0)
 U IO F I=0:IOM S TT=$E(TXT,I+1,I+IOM) Q:'$L(TT)  W !,TT
"RTN","DGBTR122",96,0)
 S LINE=LINE+($L(TXT)\IOM)+3
"RTN","DGBTR122",97,0)
 U IO W !
"RTN","DGBTR122",98,0)
 Q
"RTN","DGBTR122",99,0)
HEADER ;
"RTN","DGBTR122",100,0)
 S PAGE=PAGE+1,L=0,TXT="",TT=""
"RTN","DGBTR122",101,0)
 I LINE'=99999,$E(IOST,1,4)="C-VT" U IO S TT=$$PAUSE^DGBTR124() I TT[U S EXIT=1 Q
"RTN","DGBTR122",102,0)
 U IO W @IOF,?IOM/2-35,H0," Page: ",PAGE,!,H1
"RTN","DGBTR122",103,0)
 F L=1:1 S I=$P(AA,",",L) Q:'$L(I)  S T1=$P(B(I),U,2)-$L($P(B(I),U)) S TXT=TXT_$P(B(I),U)_$E(H2,1,T1)
"RTN","DGBTR122",104,0)
 U IO F I=0:IOM S TT=$E(TXT,I+1,I+IOM) Q:'$L(TT)  W !,TT
"RTN","DGBTR122",105,0)
 U IO W !,H1 S LINE=5
"RTN","DGBTR122",106,0)
 Q
"RTN","DGBTR122",107,0)
DP(DATE) ;Set printable date
"RTN","DGBTR122",108,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","DGBTR122",109,0)
EXCEL ;Print to spreadsheet
"RTN","DGBTR122",110,0)
 D:LINE=99999
"RTN","DGBTR122",111,0)
 .S LINE=0,TXT="" F L=1:1 S I=$P(AA,",",L) Q:'$L(I)  S TXT=TXT_$TR($P(C(I),U),DEL," ")_$S(I=19:"",1:DEL)
"RTN","DGBTR122",112,0)
 .U IO W !,TXT
"RTN","DGBTR122",113,0)
 S TXT="" F L=1:1 S I=$P(AA,",",L) Q:'$L(I)  S TXT=TXT_$TR(A(I),DEL," ")_$S(I=19:"",1:DEL)
"RTN","DGBTR122",114,0)
 U IO W !,TXT
"RTN","DGBTR122",115,0)
 Q
"RTN","DGBTR122",116,0)
DLRAMT(X) D COMMA^%DTC Q $S(EXCEL:"",1:"$")_$TR(X," ","")
"RTN","DGBTR122",117,0)
EXIT ;
"RTN","DGBTR122",118,0)
 Q
"RTN","DGBTR123")
0^30^B179962898
"RTN","DGBTR123",1,0)
DGBTR123 ;ALB/RFE - CLERK REPORT; 06/04/12
"RTN","DGBTR123",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTR123",3,0)
 Q
"RTN","DGBTR123",4,0)
EN ;Entry point
"RTN","DGBTR123",5,0)
 N %,%Y,CCFEE,CLERK,CLERKALL,CLERKNAME,DATALINE,DFN,DGBTDIVN,DGBTEXC,DGBTQ,EQUAL,ENDDT,ENTRY,GRAND,I,LINEM,LINESP,LINEZERO,PAGE,PDT,PATZERO,POP
"RTN","DGBTR123",6,0)
 N PROMPT,REPTYPE,SQ1,SQ2,STARTDT,SUBS,TYPE,X,X2,X3,Y,ZTQUEUED
"RTN","DGBTR123",7,0)
 D CLEAN^DILF
"RTN","DGBTR123",8,0)
 S X2="2$",DGBTEXC=0
"RTN","DGBTR123",9,0)
 K DIR
"RTN","DGBTR123",10,0)
 S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR123",11,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR123",12,0)
 S STARTDT=Y
"RTN","DGBTR123",13,0)
 S DIR("A")="END DATE: ",DIR(0)="DA^"_STARTDT_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR123",14,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR123",15,0)
 S ENDDT=Y
"RTN","DGBTR123",16,0)
 D
"RTN","DGBTR123",17,0)
 .I $$GET1^DIQ(43,1,11,"I") D  Q
"RTN","DGBTR123",18,0)
 ..S DGBTDIVN=$$YESNO^DGBTUTL("Do you wish to run this report for all divisions")
"RTN","DGBTR123",19,0)
 ..I DGBTDIVN S DGBTDIVN="ALL" Q
"RTN","DGBTR123",20,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR123",21,0)
 ..K DIR S DIR(0)="P^40.8:EMZ" D ^DIR K DIR
"RTN","DGBTR123",22,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR123",23,0)
 ..S DGBTDIVN=+Y
"RTN","DGBTR123",24,0)
 .S DGBTDIVN=$O(^DG(40.8,0))
"RTN","DGBTR123",25,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR123",26,0)
 K DIR
"RTN","DGBTR123",27,0)
 S DIR(0)="S^M:MILEAGE;S:SPECIAL MODE",DIR("A")="Which claim type do you want to run?" D ^DIR K DIR
"RTN","DGBTR123",28,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR123",29,0)
 S TYPE=Y
"RTN","DGBTR123",30,0)
 S CLERKALL=$$YESNO^DGBTUTL("Do you wish to run this report for all clerks")
"RTN","DGBTR123",31,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR123",32,0)
 S CLERK=""
"RTN","DGBTR123",33,0)
 I 'CLERKALL D
"RTN","DGBTR123",34,0)
 .K DIR S DIR(0)="P^200:EMZ",DIR("A")="Select CLERK" D ^DIR K DIR
"RTN","DGBTR123",35,0)
 .I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR123",36,0)
 .S CLERK=$P(Y,U)
"RTN","DGBTR123",37,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR123",38,0)
 K DIR
"RTN","DGBTR123",39,0)
 S DIR(0)="S^F:FULL;T:TOTAL",DIR("A")="Which claim type do you want to run?" D ^DIR K DIR
"RTN","DGBTR123",40,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR123",41,0)
 S REPTYPE=Y
"RTN","DGBTR123",42,0)
 D SETPRT,QUIT
"RTN","DGBTR123",43,0)
 Q
"RTN","DGBTR123",44,0)
SETPRT ;
"RTN","DGBTR123",45,0)
 S DGBTEXC=$$SELEXCEL^DGBTUTL
"RTN","DGBTR123",46,0)
 I DGBTEXC="^" Q
"RTN","DGBTR123",47,0)
 S SUBS=DGBTEXC_U_STARTDT_U_ENDDT_U_DGBTDIVN_U_TYPE_U_REPTYPE_U_CLERKALL_U_CLERK
"RTN","DGBTR123",48,0)
 I 'DGBTEXC N COLWID S COLWID=132 D PRINTMSG^DGBTUTL
"RTN","DGBTR123",49,0)
 D DEVICE^DGBTUTL("Beneficiary Travel Clerk Report","MAIN^DGBTR123(SUBS)",DGBTEXC,132)
"RTN","DGBTR123",50,0)
 I $G(DGBTQ) Q
"RTN","DGBTR123",51,0)
 ;
"RTN","DGBTR123",52,0)
 I $D(IO("Q")) D:'$D(ZTQUEUED) ^%ZISC Q
"RTN","DGBTR123",53,0)
 D MAIN(SUBS)
"RTN","DGBTR123",54,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","DGBTR123",55,0)
 U IO
"RTN","DGBTR123",56,0)
 Q
"RTN","DGBTR123",57,0)
MAIN(SUBS) ;
"RTN","DGBTR123",58,0)
 K ^TMP("DGBTRPTC",$J)
"RTN","DGBTR123",59,0)
 S DGBTEXC=$P(SUBS,U)
"RTN","DGBTR123",60,0)
 S STARTDT=$P(SUBS,U,2)
"RTN","DGBTR123",61,0)
 S ENDDT=$P(SUBS,U,3)
"RTN","DGBTR123",62,0)
 S DGBTDIVN=$P(SUBS,U,4)
"RTN","DGBTR123",63,0)
 S TYPE=$P(SUBS,U,5)
"RTN","DGBTR123",64,0)
 S REPTYPE=$P(SUBS,U,6)
"RTN","DGBTR123",65,0)
 S CLERKALL=$P(SUBS,U,7)
"RTN","DGBTR123",66,0)
 S CLERK=$P(SUBS,U,8)
"RTN","DGBTR123",67,0)
 S CLERKNAME=$$GET1^DIQ(200,CLERK,.01)
"RTN","DGBTR123",68,0)
 D GETRECS
"RTN","DGBTR123",69,0)
 I '$D(^TMP("DGBTRPTC",$J)) W !,"No records found" D QUIT Q
"RTN","DGBTR123",70,0)
 D PRINT
"RTN","DGBTR123",71,0)
 Q
"RTN","DGBTR123",72,0)
GETRECS ;
"RTN","DGBTR123",73,0)
 I ((TYPE="M")&(REPTYPE="F")) F I="CLAIMS","TOT MILE","CC FEE","ECON","M&L","F&B","DED","PAY" S GRAND(I)=0
"RTN","DGBTR123",74,0)
 I ((TYPE="M")&(REPTYPE="T")) F I="MILE","CC FEE","ECON","M&L","F&B","DED","PAY" S GRAND(I)=0
"RTN","DGBTR123",75,0)
 I ((TYPE="S")&(REPTYPE="F")) F I="CLAIMS","MILE","BASE RATE","NSNL","WAIT TIME","EXTRA CREW","SPECIAL EQUIPMENT","INVOICE AMT" S GRAND(I)=0
"RTN","DGBTR123",76,0)
 I ((TYPE="S")&(REPTYPE="T")) F I="CLAIMS","MILE","BASE RATE","NSNL","WAIT TIME","EXTRA CREW","SPECIAL EQUIPMENT","INVOICE AMT" S GRAND(I)=0
"RTN","DGBTR123",77,0)
 S ENTRY=$O(^DGBT(392,"D",STARTDT),-1)
"RTN","DGBTR123",78,0)
 F  S ENTRY=$O(^DGBT(392,"D",ENTRY)) Q:ENTRY=""  Q:ENTRY>ENDDT  D
"RTN","DGBTR123",79,0)
 .S I=""
"RTN","DGBTR123",80,0)
 .F  S I=$O(^DGBT(392,"D",ENTRY,I)) Q:I=""  D GETLINE
"RTN","DGBTR123",81,0)
 Q
"RTN","DGBTR123",82,0)
GETLINE ;
"RTN","DGBTR123",83,0)
 S LINEZERO=$G(^DGBT(392,I,0)) Q:'$$CLERK
"RTN","DGBTR123",84,0)
 I $$GET1^DIQ(392,I,45.2,"I") Q  ;'="NO" Q
"RTN","DGBTR123",85,0)
 I '$$DIV Q
"RTN","DGBTR123",86,0)
 S DATALINE=""
"RTN","DGBTR123",87,0)
 S SQ1=$P(LINEZERO,"^",13)_"^"_$P(LINEZERO,"^",12)
"RTN","DGBTR123",88,0)
 I TYPE="M" D GLMILE
"RTN","DGBTR123",89,0)
 I TYPE="S" D GLSP
"RTN","DGBTR123",90,0)
 I DATALINE'="" S ^TMP("DGBTRPTC",$J,SQ1,SQ2)=DATALINE
"RTN","DGBTR123",91,0)
 Q
"RTN","DGBTR123",92,0)
DIV() ;
"RTN","DGBTR123",93,0)
 I DGBTDIVN="ALL" Q 1
"RTN","DGBTR123",94,0)
 Q $P(LINEZERO,U,11)=DGBTDIVN
"RTN","DGBTR123",95,0)
CLERK() ;
"RTN","DGBTR123",96,0)
 I CLERKALL Q 1
"RTN","DGBTR123",97,0)
 Q $P(LINEZERO,"^",12)=CLERK
"RTN","DGBTR123",98,0)
GLMILE ;
"RTN","DGBTR123",99,0)
 I $$GET1^DIQ(392,I,56,"I")'="M" Q
"RTN","DGBTR123",100,0)
 S LINEM=$G(^DGBT(392,I,"M"))
"RTN","DGBTR123",101,0)
 S CCFEE=$$GET1^DIQ(392,$P(LINEZERO,U),55)
"RTN","DGBTR123",102,0)
 I REPTYPE="F" D GLMILEF
"RTN","DGBTR123",103,0)
 I REPTYPE="T" D GLMILET
"RTN","DGBTR123",104,0)
 Q
"RTN","DGBTR123",105,0)
GLMILEF ; Mileage full
"RTN","DGBTR123",106,0)
 S SQ2=$O(^TMP("DGBTRPTC",$J,SQ1,""),-1)+1
"RTN","DGBTR123",107,0)
 S DFN=$P(LINEZERO,U,2) Q:DFN=""
"RTN","DGBTR123",108,0)
 S PATZERO=$G(^DPT(DFN,0))
"RTN","DGBTR123",109,0)
 S DATALINE=$P(PATZERO,U) ; Pat name
"RTN","DGBTR123",110,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR123",111,0)
 S $P(DATALINE,U,2)=$P(PATZERO,U,9) ; Pat ID
"RTN","DGBTR123",112,0)
 S $P(DATALINE,U,3)=$$FMTE^XLFDT($P($P(LINEZERO,U),".")) ; Claim date/time
"RTN","DGBTR123",113,0)
 I DGBTEXC S $P(DATALINE,U,3)=$P($P(DATALINE,U,3),"@")
"RTN","DGBTR123",114,0)
 S $P(DATALINE,U,4)=$$GET1^DIQ(40.8,$P(LINEZERO,U,11),.01) ; Division
"RTN","DGBTR123",115,0)
 S $P(DATALINE,U,5)=$$GET1^DIQ(392.3,$P(LINEZERO,U,6),2) ; Account
"RTN","DGBTR123",116,0)
 S $P(DATALINE,U,6)=$S($P(LINEM,U)=1:"O",1:"R")
"RTN","DGBTR123",117,0)
 S $P(DATALINE,U,7)=$P(LINEM,U)*$P(LINEM,U,2) ; Total mileage
"RTN","DGBTR123",118,0)
 S GRAND("TOT MILE")=GRAND("TOT MILE")+($P(LINEM,U)*$P(LINEM,U,2))
"RTN","DGBTR123",119,0)
 S $P(DATALINE,U,8)=$$GET1^DIQ(392,$P(LINEZERO,U),44) ; Common carrier mode
"RTN","DGBTR123",120,0)
 S $P(DATALINE,U,9)=$$DLRAMT(CCFEE) ; Common carrier fee
"RTN","DGBTR123",121,0)
 S GRAND("CC FEE")=GRAND("CC FEE")+$$GET1^DIQ(392,$P(LINEZERO,U),55)
"RTN","DGBTR123",122,0)
 S $P(DATALINE,U,10)=$$DLRAMT($P(LINEZERO,U,8)) ; Most economical cost
"RTN","DGBTR123",123,0)
 S GRAND("ECON")=GRAND("ECON")+$P(LINEZERO,U,8)
"RTN","DGBTR123",124,0)
 S $P(DATALINE,U,11)=$$DLRAMT($P(LINEM,U,4)) ; Meals & lodging
"RTN","DGBTR123",125,0)
 S GRAND("M&L")=GRAND("M&L")+$P(LINEM,U,4)
"RTN","DGBTR123",126,0)
 S $P(DATALINE,U,12)=$$DLRAMT($P(LINEM,U,5)) ; Ferries & bridges
"RTN","DGBTR123",127,0)
 S GRAND("F&B")=GRAND("F&B")+$P(LINEM,U,5)
"RTN","DGBTR123",128,0)
 S $P(DATALINE,U,13)=$$DLRAMT($P(LINEZERO,U,9)) ; Deductible
"RTN","DGBTR123",129,0)
 S GRAND("DED")=GRAND("DED")+$P(LINEZERO,U,9)
"RTN","DGBTR123",130,0)
 S $P(DATALINE,U,14)=$$DLRAMT($P(LINEZERO,U,10)) ; Payable
"RTN","DGBTR123",131,0)
 S GRAND("PAY")=GRAND("PAY")+$P(LINEZERO,U,10)
"RTN","DGBTR123",132,0)
 S $P(DATALINE,U,15)=$TR($$GET1^DIQ(392,$P(LINEZERO,U),51),"^","") ; Remarks
"RTN","DGBTR123",133,0)
 Q
"RTN","DGBTR123",134,0)
GLMILET ; Mileage total
"RTN","DGBTR123",135,0)
 S $P(SQ1,"^",3)=$P(LINEZERO,U,11)
"RTN","DGBTR123",136,0)
 S $P(SQ1,"^",4)=$P(LINEZERO,U,6)
"RTN","DGBTR123",137,0)
 S SQ2=0
"RTN","DGBTR123",138,0)
 S DATALINE=$G(^TMP("DGBTRPTC",$J,SQ1,SQ2))
"RTN","DGBTR123",139,0)
 S $P(DATALINE,U)=($P(LINEM,U)*$P(LINEM,U,2))+$P(DATALINE,U) ; MILEAGE
"RTN","DGBTR123",140,0)
 S $P(DATALINE,U,2)=$$GET1^DIQ(392,I,55)+$P(DATALINE,U,2) ;COMMON CARRIER FEE
"RTN","DGBTR123",141,0)
 S GRAND("CC FEE")=GRAND("CC FEE")+CCFEE
"RTN","DGBTR123",142,0)
 S $P(DATALINE,U,3)=$P(LINEZERO,U,8)+$P(DATALINE,U,3) ; MOST ECONOMICAL COST
"RTN","DGBTR123",143,0)
 S GRAND("ECON")=GRAND("ECON")+$P(LINEZERO,U,8)
"RTN","DGBTR123",144,0)
 S $P(DATALINE,U,4)=$P(LINEM,U,4)+$P(DATALINE,U,4) ; MEALS & LODGING
"RTN","DGBTR123",145,0)
 S GRAND("M&L")=GRAND("M&L")+$P(LINEM,U,4)
"RTN","DGBTR123",146,0)
 S $P(DATALINE,U,5)=$P(LINEM,U,5)+$P(DATALINE,U,5) ; FERRIES & BRIDGES
"RTN","DGBTR123",147,0)
 S GRAND("F&B")=GRAND("F&B")+$P(LINEM,U,5)
"RTN","DGBTR123",148,0)
 S $P(DATALINE,U,6)=$P(LINEZERO,U,9)+$P(DATALINE,U,6) ; DEDUCTIBLE
"RTN","DGBTR123",149,0)
 S GRAND("DED")=GRAND("DED")+$P(LINEZERO,U,9)
"RTN","DGBTR123",150,0)
 S $P(DATALINE,U,7)=$P(LINEZERO,U,10)+$P(DATALINE,U,7) ; PAYABLE
"RTN","DGBTR123",151,0)
 S GRAND("PAY")=GRAND("PAY")+$P(LINEZERO,U,10)
"RTN","DGBTR123",152,0)
 Q
"RTN","DGBTR123",153,0)
GLSP ;
"RTN","DGBTR123",154,0)
 I $$GET1^DIQ(392,I,56,"I")'="S" Q
"RTN","DGBTR123",155,0)
 S LINESP=$G(^DGBT(392,I,"SP"))
"RTN","DGBTR123",156,0)
 I REPTYPE="F" D GLSPF
"RTN","DGBTR123",157,0)
 I REPTYPE="T" D GLSPT
"RTN","DGBTR123",158,0)
 Q
"RTN","DGBTR123",159,0)
GLSPF ; Special mode full
"RTN","DGBTR123",160,0)
 S SQ2=$O(^TMP("DGBTRPTC",$J,SQ1,""),-1)+1
"RTN","DGBTR123",161,0)
 S DFN=$P(LINEZERO,U,2) Q:DFN=""
"RTN","DGBTR123",162,0)
 S PATZERO=$G(^DPT(DFN,0))
"RTN","DGBTR123",163,0)
 S DATALINE=$P(PATZERO,U) ; Pat name
"RTN","DGBTR123",164,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR123",165,0)
 S $P(DATALINE,U,2)=$P(PATZERO,U,9) ; Pat ID
"RTN","DGBTR123",166,0)
 S $P(DATALINE,U,3)=$$FMTE^XLFDT($P($P(LINEZERO,U),".")) ; Claim date/time
"RTN","DGBTR123",167,0)
 I DGBTEXC S $P(DATALINE,U,3)=$P($P(DATALINE,U,3),"@")
"RTN","DGBTR123",168,0)
 S $P(DATALINE,U,4)=$$GET1^DIQ(40.8,$P(LINEZERO,U,11),.01) ; Division
"RTN","DGBTR123",169,0)
 S $P(DATALINE,U,5)=$$GET1^DIQ(392.3,$P(LINEZERO,U,6),2) ; Account
"RTN","DGBTR123",170,0)
 S $P(DATALINE,U,6)=$P(LINESP,U,12) ; Mileage
"RTN","DGBTR123",171,0)
 S GRAND("MILE")=GRAND("MILE")+$P(LINESP,U,12)
"RTN","DGBTR123",172,0)
 S $P(DATALINE,U,7)=$$DLRAMT($P(LINESP,U,5)) ; Base rate fee
"RTN","DGBTR123",173,0)
 S GRAND("BASE RATE")=GRAND("BASE RATE")+$P(LINESP,U,5)
"RTN","DGBTR123",174,0)
 S $P(DATALINE,U,8)=$$DLRAMT($P(LINESP,U,7)) ; No show/no load fee
"RTN","DGBTR123",175,0)
 S GRAND("NSNL")=GRAND("NSNL")+$P(LINESP,U,7)
"RTN","DGBTR123",176,0)
 S $P(DATALINE,U,9)=$$DLRAMT($P(LINESP,U,8)) ; Wait time fee
"RTN","DGBTR123",177,0)
 S GRAND("WAIT TIME")=GRAND("WAIT TIME")+$P(LINESP,U,8)
"RTN","DGBTR123",178,0)
 S $P(DATALINE,U,10)=$$DLRAMT($P(LINESP,U,9)) ; Extra crew fee
"RTN","DGBTR123",179,0)
 S GRAND("EXTRA CREW")=GRAND("EXTRA CREW")+$P(LINESP,U,9)
"RTN","DGBTR123",180,0)
 S $P(DATALINE,U,11)=$$DLRAMT($P(LINESP,U,10)) ; Special equipment fee
"RTN","DGBTR123",181,0)
 S GRAND("SPECIAL EQUIPMENT")=GRAND("SPECIAL EQUIPMENT")+$P(LINESP,U,10)
"RTN","DGBTR123",182,0)
 S $P(DATALINE,U,12)=$$DLRAMT($P(LINESP,U,4)) ; Invoice
"RTN","DGBTR123",183,0)
 S GRAND("INVOICE AMT")=GRAND("INVOICE AMT")+$P(LINESP,U,4)
"RTN","DGBTR123",184,0)
 S $P(DATALINE,U,13)=$TR($P(LINESP,U,26),"^","") ; Remarks
"RTN","DGBTR123",185,0)
 Q
"RTN","DGBTR123",186,0)
GLSPT ; Special mode total
"RTN","DGBTR123",187,0)
 S $P(SQ1,"^",3)=$P(LINEZERO,U,11)
"RTN","DGBTR123",188,0)
 S $P(SQ1,"^",4)=$P(LINEZERO,U,6)
"RTN","DGBTR123",189,0)
 S SQ2=0
"RTN","DGBTR123",190,0)
 S DATALINE=$G(^TMP("DGBTRPTC",$J,SQ1,SQ2))
"RTN","DGBTR123",191,0)
 S $P(DATALINE,U)=1+$P(DATALINE,U) ; TOTAL CLAIMS
"RTN","DGBTR123",192,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR123",193,0)
 S $P(DATALINE,U,2)=$P(LINESP,U,12)+$P(DATALINE,U,2) ; MILEAGE
"RTN","DGBTR123",194,0)
 S GRAND("MILE")=GRAND("MILE")+$P(LINESP,U,12)
"RTN","DGBTR123",195,0)
 S $P(DATALINE,U,3)=$P(LINESP,U,5)+$P(DATALINE,U,3) ; BASE RATE FEE
"RTN","DGBTR123",196,0)
 S GRAND("BASE RATE")=GRAND("BASE RATE")+$P(LINESP,U,5)
"RTN","DGBTR123",197,0)
 S $P(DATALINE,U,4)=$P(LINESP,U,7)+$P(DATALINE,U,4) ; NO LOAD/NO SHOW
"RTN","DGBTR123",198,0)
 S GRAND("NSNL")=GRAND("NSNL")+$P(LINESP,U,7)
"RTN","DGBTR123",199,0)
 S $P(DATALINE,U,5)=$P(LINESP,U,8)+$P(DATALINE,U,5) ; WAIT TIME
"RTN","DGBTR123",200,0)
 S GRAND("WAIT TIME")=GRAND("WAIT TIME")+$P(LINESP,U,8)
"RTN","DGBTR123",201,0)
 S $P(DATALINE,U,6)=$P(LINESP,U,9)+$P(DATALINE,U,6) ; EXTRA CREW
"RTN","DGBTR123",202,0)
 S GRAND("EXTRA CREW")=GRAND("EXTRA CREW")+$P(LINESP,U,9)
"RTN","DGBTR123",203,0)
 S $P(DATALINE,U,7)=$P(LINESP,U,10)+$P(DATALINE,U,7) ; SPECIAL EQUIPMENT
"RTN","DGBTR123",204,0)
 S GRAND("SPECIAL EQUIPMENT")=GRAND("SPECIAL EQUIPMENT")+$P(LINESP,U,10)
"RTN","DGBTR123",205,0)
 S $P(DATALINE,U,8)=$P(LINESP,U,4)+$P(DATALINE,U,8) ; TOTAL INVOICE AMOUNT
"RTN","DGBTR123",206,0)
 S GRAND("INVOICE AMT")=GRAND("INVOICE AMT")+$P(LINESP,U,4)
"RTN","DGBTR123",207,0)
 Q
"RTN","DGBTR123",208,0)
PRINT ;
"RTN","DGBTR123",209,0)
 U IO
"RTN","DGBTR123",210,0)
 S PAGE=0,$P(EQUAL,"=",133)=""
"RTN","DGBTR123",211,0)
 D NOW^%DTC S Y=% D DD^%DT S PDT=Y
"RTN","DGBTR123",212,0)
 I DGBTEXC D
"RTN","DGBTR123",213,0)
 .I (TYPE="M")&(REPTYPE="F") D
"RTN","DGBTR123",214,0)
 ..W "DATE ENTERED^PATIENT^PATIENT ID^CLERK^CLAIM DATE^DIVISION^ACCT^R/O^MILEAGE^CC MODE^CC FEE^MOST ECONOMIC^M & L^FERRIES & BRIDGES^DEDUCTIBLE^AMOUNT PAYABLE^REMARK"
"RTN","DGBTR123",215,0)
 .I (TYPE="M")&(REPTYPE="T") D
"RTN","DGBTR123",216,0)
 ..W "DATE ENTERED^CLERK^DIVISION^ACCT^MILEAGE^CC FEE^MOST ECONOMIC^M & L^FERRIES &BRIDGES^DEDUCTIBLE^AMOUNT PAYABLE"
"RTN","DGBTR123",217,0)
 .I (TYPE="S")&(REPTYPE="F") D
"RTN","DGBTR123",218,0)
 ..W "DATE ENTERED^PATIENT^PATIENT ID^CLERK^CLAIM DATE^DIVISION^ACCT^MILEAGE^BASE RATE^NO SHOW NO LOAD^WAIT TIME^EXTRA CREW^SPECIAL EQUIPMENT^INVOICE AMOUNT^REMARK"
"RTN","DGBTR123",219,0)
 .I (TYPE="S")&(REPTYPE="T") D
"RTN","DGBTR123",220,0)
 ..W "DATE ENTERED^CLERK^DIVISION^ACCT^# CLAIMS^MILEAGE^BASE RATE^NO SHOW NO LOAD^WAIT TIME^EXTRA CREW^SPECIAL EQUIPMENT^INVOICE AMOUNT"
"RTN","DGBTR123",221,0)
 I (TYPE="M")&(REPTYPE="F")&('DGBTEXC) D HDRMF^DGBTR3A
"RTN","DGBTR123",222,0)
 I (TYPE="M")&(REPTYPE="T")&('DGBTEXC) D HDRMT
"RTN","DGBTR123",223,0)
 I (TYPE="S")&(REPTYPE="F")&('DGBTEXC) D HDRSF
"RTN","DGBTR123",224,0)
 I (TYPE="S")&(REPTYPE="T")&('DGBTEXC) D HDRST
"RTN","DGBTR123",225,0)
 S (PROMPT,SQ1)=""
"RTN","DGBTR123",226,0)
 F  S SQ1=$O(^TMP("DGBTRPTC",$J,SQ1)) Q:SQ1=""  D  Q:PROMPT="^"
"RTN","DGBTR123",227,0)
 .S SQ2=""
"RTN","DGBTR123",228,0)
 .F  S SQ2=$O(^TMP("DGBTRPTC",$J,SQ1,SQ2)) Q:SQ2=""  D  Q:PROMPT="^"
"RTN","DGBTR123",229,0)
 ..S DATALINE=^TMP("DGBTRPTC",$J,SQ1,SQ2)
"RTN","DGBTR123",230,0)
 ..I DGBTEXC D PRTXL Q
"RTN","DGBTR123",231,0)
 ..I (TYPE="M")&(REPTYPE="F")&(($Y+4)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR123",232,0)
 ...D HDRMF^DGBTR3A
"RTN","DGBTR123",233,0)
 ..I (TYPE="M")&(REPTYPE="F") D
"RTN","DGBTR123",234,0)
 ...W !,$P(DATALINE,U),?32,$P(DATALINE,U,2),?43,$$GET1^DIQ(200,$P(SQ1,U,2),.01),?78,$P(DATALINE,U,3),?92,$$FMTE^XLFDT($P(SQ1,U))
"RTN","DGBTR123",235,0)
 ...W ?109,$P(DATALINE,U,5)
"RTN","DGBTR123",236,0)
 ...W !,?5,$P(DATALINE,U,4),?42,$P(DATALINE,U,6),?48,$P(DATALINE,U,7),?54,$P(DATALINE,U,8),?92,$P(DATALINE,U,9),?107,$P(DATALINE,U,10)
"RTN","DGBTR123",237,0)
 ...W ?119,$P(DATALINE,U,11)
"RTN","DGBTR123",238,0)
 ...W !,?5,$P(DATALINE,U,12),?17,$P(DATALINE,U,13),?25,$P(DATALINE,U,14),?38,$P(DATALINE,U,15)
"RTN","DGBTR123",239,0)
 ..I (TYPE="S")&(REPTYPE="F")&(($Y+4)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR123",240,0)
 ...D HDRSF
"RTN","DGBTR123",241,0)
 ..I (TYPE="S")&(REPTYPE="F") D
"RTN","DGBTR123",242,0)
 ...W !,$P(DATALINE,U),?32,$P(DATALINE,U,2),?43,$$GET1^DIQ(200,$P(SQ1,U,2),.01),?78,$P(DATALINE,U,3),?92,$$FMTE^XLFDT($P(SQ1,U))
"RTN","DGBTR123",243,0)
 ...W ?109,$P(DATALINE,U,5)
"RTN","DGBTR123",244,0)
 ...W !,?5,$P(DATALINE,U,4),?42,$P(DATALINE,U,6),?50,$P(DATALINE,U,7),?65,$P(DATALINE,U,8),?79,$P(DATALINE,U,9),?90,$P(DATALINE,U,10)
"RTN","DGBTR123",245,0)
 ...W ?102,$P(DATALINE,U,11),?116,$P(DATALINE,U,12)
"RTN","DGBTR123",246,0)
 ...W !,?5,$P(DATALINE,U,13)
"RTN","DGBTR123",247,0)
 ..I (TYPE="M")&(REPTYPE="T")&(($Y+3)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR123",248,0)
 ...D HDRMT
"RTN","DGBTR123",249,0)
 ..I (TYPE="M")&(REPTYPE="T") D
"RTN","DGBTR123",250,0)
 ...W !,$$GET1^DIQ(40.8,$P(SQ1,U,3),.01),?37,$$FMTE^XLFDT($P(SQ1,U)),?50,$$GET1^DIQ(392.3,$P(SQ1,U,4),2),?55,$P(DATALINE,U)
"RTN","DGBTR123",251,0)
 ...W ?63,$$DLRAMT($P(DATALINE,U,2)),?78,$$DLRAMT($P(DATALINE,U,3)),?90,$$DLRAMT($P(DATALINE,U,4)),?103,$$DLRAMT($P(DATALINE,U,5))
"RTN","DGBTR123",252,0)
 ...W !,?5,$$DLRAMT($P(DATALINE,U,6)),?18,$$DLRAMT($P(DATALINE,U,7)),?29,$$GET1^DIQ(200,$P(SQ1,U,2),.01)
"RTN","DGBTR123",253,0)
 ..I (TYPE="S")&(REPTYPE="T")&(($Y+3)>IOSL) D  Q:PROMPT="^"
"RTN","DGBTR123",254,0)
 ...D HDRST
"RTN","DGBTR123",255,0)
 ..I (TYPE="S")&(REPTYPE="T") D
"RTN","DGBTR123",256,0)
 ...W !,$$GET1^DIQ(40.8,$P(SQ1,U,3),.01),?37,$$FMTE^XLFDT($P(SQ1,U)),?50,$$GET1^DIQ(392.3,$P(SQ1,U,4),2),?55,$P(DATALINE,U,2)
"RTN","DGBTR123",257,0)
 ...W ?63,$P(DATALINE,U),?72,$$DLRAMT($P(DATALINE,U,3)),?87,$$DLRAMT($P(DATALINE,U,4)),?102,$$DLRAMT($P(DATALINE,U,5))
"RTN","DGBTR123",258,0)
 ...W ?117,$$DLRAMT($P(DATALINE,U,6))
"RTN","DGBTR123",259,0)
 ...W !,?5,$$DLRAMT($P(DATALINE,U,7)),?15,$$DLRAMT($P(DATALINE,U,8)),?25,$$GET1^DIQ(200,$P(SQ1,U,2),.01)
"RTN","DGBTR123",260,0)
 ..Q
"RTN","DGBTR123",261,0)
 I 'DGBTEXC D
"RTN","DGBTR123",262,0)
 .I ($Y+4)<IOSL W !!!
"RTN","DGBTR123",263,0)
 .I (REPTYPE="F"),(TYPE="M") D GRANDMF^DGBTR3A
"RTN","DGBTR123",264,0)
 .I (REPTYPE="T"),(TYPE="M") D GRANDMT^DGBTR3A
"RTN","DGBTR123",265,0)
 .I (REPTYPE="F"),(TYPE="S") D GRANDSF^DGBTR3A
"RTN","DGBTR123",266,0)
 .I (REPTYPE="T"),(TYPE="S") D GRANDST^DGBTR3A
"RTN","DGBTR123",267,0)
 I IOST["C-" S Y=$$PAUSE^DGBTUTL(DGBTEXC)
"RTN","DGBTR123",268,0)
 I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR123",269,0)
 Q
"RTN","DGBTR123",270,0)
PRTXL ;
"RTN","DGBTR123",271,0)
 I REPTYPE="F" D
"RTN","DGBTR123",272,0)
 .W !,$$FMTE^XLFDT($P(SQ1,U)),U,$P(DATALINE,U),U,$P(DATALINE,U,2),U,$$GET1^DIQ(200,$P(SQ1,U,2),.01) F I=3:1:$L(DATALINE,U) W U,$P(DATALINE,U,I)
"RTN","DGBTR123",273,0)
 I REPTYPE="T" D
"RTN","DGBTR123",274,0)
 .W !,$$FMTE^XLFDT($P(SQ1,U)),U,$$GET1^DIQ(200,$P(SQ1,U,2),.01),U,$$GET1^DIQ(40.8,$P(SQ1,U,3),.01),U,$$GET1^DIQ(392.3,$P(SQ1,U,4),2)
"RTN","DGBTR123",275,0)
 .I TYPE="M" D
"RTN","DGBTR123",276,0)
 ..W U,$P(DATALINE,U,1)
"RTN","DGBTR123",277,0)
 ..F I=2:1:$L(DATALINE,U) W U,$$DLRAMT($P(DATALINE,U,I))
"RTN","DGBTR123",278,0)
 .I TYPE="S" D
"RTN","DGBTR123",279,0)
 ..F I=1,2 W U,$P(DATALINE,U,I)
"RTN","DGBTR123",280,0)
 ..F I=3:1:$L(DATALINE,U) W U,$$DLRAMT($P(DATALINE,U,I))
"RTN","DGBTR123",281,0)
 Q
"RTN","DGBTR123",282,0)
DLRAMT(X) ;
"RTN","DGBTR123",283,0)
 D COMMA^%DTC I 'DGBTEXC Q $TR(X," ","")
"RTN","DGBTR123",284,0)
 Q $TR(X," ,$","")
"RTN","DGBTR123",285,0)
HDRMT ;
"RTN","DGBTR123",286,0)
 S PAGE=PAGE+1
"RTN","DGBTR123",287,0)
 W @IOF
"RTN","DGBTR123",288,0)
 W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR123",289,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR123",290,0)
 W !,"VERSION: TOTAL"
"RTN","DGBTR123",291,0)
 W !,"TYPE: MILEAGE"
"RTN","DGBTR123",292,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR123",293,0)
 W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR123",294,0)
 W !,$E(EQUAL,1,117)
"RTN","DGBTR123",295,0)
 W !,"DIVISION",?37,"ENTERED",?50,"ACCT",?55,"MILEAGE",?63,"CC FEE",?78,"MOST ECON",?90,"M&L",?103,"F&B"
"RTN","DGBTR123",296,0)
 W !,?5,"DED",?18,"PAYABLE",?29,"CLERK"
"RTN","DGBTR123",297,0)
 W !,$E(EQUAL,1,117)
"RTN","DGBTR123",298,0)
 Q
"RTN","DGBTR123",299,0)
HDRSF ;
"RTN","DGBTR123",300,0)
 S PAGE=PAGE+1
"RTN","DGBTR123",301,0)
 W @IOF
"RTN","DGBTR123",302,0)
 W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR123",303,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR123",304,0)
 W !,"VERSION: FULL"
"RTN","DGBTR123",305,0)
 W !,"TYPE: SPECIAL MODE"
"RTN","DGBTR123",306,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR123",307,0)
 W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR123",308,0)
 W !,$E(EQUAL,1,124)
"RTN","DGBTR123",309,0)
 W !,"PATIENT NAME",?32,"SSN",?43,"CLERK",?78,"CL DT",?92,"ENT DT",?109,"ACCT"
"RTN","DGBTR123",310,0)
 W !,?5,"DIVISION",?42,"MILEAGE",?50,"BASE RATE",?65,"NSNL",?79,"WAIT TIME",?90,"EX CREW",?102,"SPEC EQ",?116,"INV AMT"
"RTN","DGBTR123",311,0)
 W !,?5,"REMARKS"
"RTN","DGBTR123",312,0)
 W !,$E(EQUAL,1,124)
"RTN","DGBTR123",313,0)
 Q
"RTN","DGBTR123",314,0)
HDRST ;
"RTN","DGBTR123",315,0)
 S PAGE=PAGE+1
"RTN","DGBTR123",316,0)
 W @IOF
"RTN","DGBTR123",317,0)
 W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR123",318,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR123",319,0)
 W !,"VERSION: TOTAL"
"RTN","DGBTR123",320,0)
 W !,"TYPE: SPECIAL MODE"
"RTN","DGBTR123",321,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR123",322,0)
 W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR123",323,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR123",324,0)
 W !,"DIVISION",?37,"ENTERED",?50,"ACCT",?55,"MILEAGE",?63,"CLAIMS",?72,"BASE RATE",?87,"NSNL",?102,"WAIT TIME",?117,"EXTRA CREW"
"RTN","DGBTR123",325,0)
 W !,?5,"SPEC EQ",?15,"INV AMT",?25,"CLERK"
"RTN","DGBTR123",326,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR123",327,0)
 Q
"RTN","DGBTR123",328,0)
QUIT ;
"RTN","DGBTR123",329,0)
 K ^TMP("DGBTRPTC",$J)
"RTN","DGBTR123",330,0)
 D CLEAN^DILF
"RTN","DGBTR123",331,0)
 Q
"RTN","DGBTR124")
0^31^B36833401
"RTN","DGBTR124",1,0)
DGBTR124 ;PAV - BENEFICIARY/TRAVEL E12.2 ROUTINE; 6/20/2012@1130 ;11/14/11  09:58
"RTN","DGBTR124",2,0)
 ;;1.0;Beneficiary Travel;**20**;July 25, 2012;Build 185
"RTN","DGBTR124",3,0)
EN ;12.2 BT Travel Pattern Report
"RTN","DGBTR124",4,0)
 W *7,!!,"        ************* BT Travel Pattern Report *************",!
"RTN","DGBTR124",5,0)
 N DIR,A,AA,B,C,Y,X,I,DA,DIK,DIC,FDA,SDATE,EDATE,SNAME,ENAME,A,DFN,H1,H0,H2,SDATEP,EDATEP,TXT,EXIT,SPR,DEL,DGBTQ,VADM,RNAME,EXCEL,LINE,PAGE
"RTN","DGBTR124",6,0)
 N XDATE,XNAME,XXDATE
"RTN","DGBTR124",7,0)
 S (EXCEL,EXIT)=0,DEL=U
"RTN","DGBTR124",8,0)
DATE ;
"RTN","DGBTR124",9,0)
 ;Beginning Date. Compared against the Claim entry date.
"RTN","DGBTR124",10,0)
 K DIR S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR124",11,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR124",12,0)
 S SDATE=Y,SDATEP=$$DP(SDATE),SDATE=SDATE-.0001
"RTN","DGBTR124",13,0)
 ;Ending Date. Compared against the Claim entry date.
"RTN","DGBTR124",14,0)
 K DIR S DIR("A")="END DATE:   ",DIR(0)="DA^"_SDATE_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR124",15,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR124",16,0)
 S EDATE=Y,EDATEP=$$DP(EDATE)
"RTN","DGBTR124",17,0)
NAME ;
"RTN","DGBTR124",18,0)
 ;The name of the first veteran to include in the report (last name).  This can be a partial string. Default value is 'AAA'
"RTN","DGBTR124",19,0)
 K DIR S DIR("A")="START NAME  ",DIR("B")="AAA",DIR(0)="F^3:30" ;^K:X'?1A.A.A X"
"RTN","DGBTR124",20,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR124",21,0)
 S SNAME=$$UP^XLFSTR(Y)
"RTN","DGBTR124",22,0)
 ;The name of the last veteran to include in the report (last name).  This can be a partial string.   Default value is 'ZZZ'
"RTN","DGBTR124",23,0)
 K DIR S DIR("A")="END NAME    ",DIR("B")="ZZZ",DIR(0)="F^3:30" ;^K:X'?1A.A.A X"
"RTN","DGBTR124",24,0)
 D ^DIR G:(Y=U)!$G(DTOUT)!$G(DUOUT) EXIT
"RTN","DGBTR124",25,0)
 S ENAME=$$UP^XLFSTR(Y)
"RTN","DGBTR124",26,0)
 I SNAME]ENAME W *7,!,"START NAME must be before LAST NAME",! G NAME
"RTN","DGBTR124",27,0)
 S ENAME=ENAME_"Z"
"RTN","DGBTR124",28,0)
 S AA="1,2,3,6,14,15,16,17,7,21,13,20,19"
"RTN","DGBTR124",29,0)
 S RNAME=" BT Travel Pattern Report "
"RTN","DGBTR124",30,0)
 S EXCEL=$$SELEXCEL^DGBTUTL() Q:EXCEL=U  ;
"RTN","DGBTR124",31,0)
 I 'EXCEL N COLWID S COLWID=255 D PRINTMSG^DGBTUTL
"RTN","DGBTR124",32,0)
 S DGBTQ=0 D DEVICE^DGBTUTL(RNAME,"EN1^DGBTR124",EXCEL,255) Q:$G(DGBTQ)
"RTN","DGBTR124",33,0)
EN1 ;start computation
"RTN","DGBTR124",34,0)
 S B(0)="DATE ENT^10",B(1)="CLAIM DATE^13",B(2)="PATIENT NAME^25",B(3)="SSN^15",B(4)="ELIG^20",B(5)="SC %^6"
"RTN","DGBTR124",35,0)
 S B(6)="ACCT^8",B(7)="R/O^5",B(8)="TOT MILES^10",B(9)="CC MODE^11",B(10)="CC FEE^10",B(11)="ECON^9"
"RTN","DGBTR124",36,0)
 S B(12)="DED^9",B(13)="PAYABLE^9",B(14)="DEP ADDRESS^20",B(15)="DEP CITY^15",B(16)="DEP STATE^18"
"RTN","DGBTR124",37,0)
 S B(17)="DEP ZIP^8",B(18)="DIV^5",B(19)="REMARKS^45",B(20)="CLERK^18",B(21)="MILEAGE^8"
"RTN","DGBTR124",38,0)
 S C(0)="DATE ENTERED^10",C(1)="CLAIM DATE^14",C(2)="PATIENT NAME^16",C(3)="SSN^13",C(4)="ELIGIBILITY^16",C(5)="SC PERCENTAGE^5"
"RTN","DGBTR124",39,0)
 S C(6)="ACCOUNT^16",C(7)="R/O^5",C(8)="TOTAL MILEAGE^7",C(9)="CC MODE^11",C(10)="CC FEE^10",C(11)="MOST ECONOMICAL^9"
"RTN","DGBTR124",40,0)
 S C(12)="DEDUCTIBLE AMOUNT^7",C(13)="AMOUNT PAYABLE^7",C(14)="PLACE OF DEPARTURE^14",C(15)="CITY OF DEPARTURE^12",C(16)="STATE OF DEPARTURE^14"
"RTN","DGBTR124",41,0)
 S C(17)="ZIP CODE OF DEPARTURE^8",C(18)="DIVISION^5",C(19)="REMARKS^42",C(20)="WHO ENTERED INTO FILE^18",C(21)="MILES^6" ;,C(21)="MILES ONE WAY^8"
"RTN","DGBTR124",42,0)
 S PAGE=0,LINE=99999,$P(H1,"-",IOM-1)="-"
"RTN","DGBTR124",43,0)
 S H0="*************"_RNAME_SDATEP_"-"_EDATEP_" *************",H2="                                  "
"RTN","DGBTR124",44,0)
 S XDATE=SDATE F  S XDATE=$O(^DGBT(392,"D",XDATE)) Q:'XDATE!(XDATE>EDATE)  D  Q:EXIT
"RTN","DGBTR124",45,0)
 .S XXDATE="" F  S XXDATE=$O(^DGBT(392,"D",XDATE,XXDATE)) Q:'XXDATE  D  Q:EXIT
"RTN","DGBTR124",46,0)
 ..K FDA,A D GETS^DIQ(392,XXDATE_",","**","EI","FDA") Q:'$D(FDA)  ;ZW FDA S EXIT=1 Q
"RTN","DGBTR124",47,0)
 ..S XNAME=$$UP^XLFSTR(FDA(392,XXDATE_",",2,"E")),XNAME=$P(XNAME,U),XNAME=$TR(XNAME,"-"," "),XNAME=$TR(XNAME,"/"," ")
"RTN","DGBTR124",48,0)
 ..Q:XNAME]ENAME!(SNAME]XNAME)                 ;Quit if not between names
"RTN","DGBTR124",49,0)
 ..Q:FDA(392,XXDATE_",",45.2,"I")              ;Quit if Denied Claim
"RTN","DGBTR124",50,0)
 ..Q:FDA(392,XXDATE_",",56,"I")="S"            ; Quit if Special Mode
"RTN","DGBTR124",51,0)
 ..S A(0)=$$DP(FDA(392,XXDATE_",",13,"I"))     ;Date Claim entered
"RTN","DGBTR124",52,0)
 ..S A(1)=$$DP(FDA(392,XXDATE_",",.01,"I"))    ;Claim Date
"RTN","DGBTR124",53,0)
 ..S A(2)=FDA(392,XXDATE_",",2,"E")            ;Patient Name
"RTN","DGBTR124",54,0)
 ..S DFN=FDA(392,XXDATE_",",2,"I") D DEM^VADPT
"RTN","DGBTR124",55,0)
 ..S A(3)=$P(VADM(2),U,2)                      ;SSN
"RTN","DGBTR124",56,0)
 ..S A(4)=FDA(392,XXDATE_",",3,"E")            ;Eligibility
"RTN","DGBTR124",57,0)
 ..S A(5)=FDA(392,XXDATE_",",4,"E")            ;SC Percentage
"RTN","DGBTR124",58,0)
 ..S A(6)=+FDA(392,XXDATE_",",6,"E")           ;Account
"RTN","DGBTR124",59,0)
 ..S A(7)=$E(FDA(392,XXDATE_",",31,"E"),1)     ;One Way/Round Trip
"RTN","DGBTR124",60,0)
 ..S A(8)=$$DLRAMT(FDA(392,XXDATE_",",33,"E"))  ;Total Mileage 
"RTN","DGBTR124",61,0)
 ..S A(9)=FDA(392,XXDATE_",",44,"E")            ;Common Carrier mode
"RTN","DGBTR124",62,0)
 ..S A(10)=$$DLRAMT(FDA(392,XXDATE_",",55,"E"))  ;Common Carrier fee 
"RTN","DGBTR124",63,0)
 ..S A(11)=$$DLRAMT(FDA(392,XXDATE_",",8,"E"))   ;Most economical cost 
"RTN","DGBTR124",64,0)
 ..S A(12)=$$DLRAMT(FDA(392,XXDATE_",",9,"E"))   ;Deductible amount
"RTN","DGBTR124",65,0)
 ..S A(13)=$$DLRAMT(FDA(392,XXDATE_",",10,"E"))                      ;Amount payable 
"RTN","DGBTR124",66,0)
 ..S A(14)=FDA(392,XXDATE_",",21,"E")                ;Place of departure 
"RTN","DGBTR124",67,0)
 ..S A(15)=FDA(392,XXDATE_",",24,"E")             ;City of departure 
"RTN","DGBTR124",68,0)
 ..S A(16)=FDA(392,XXDATE_",",24.1,"E")           ;State of departure 
"RTN","DGBTR124",69,0)
 ..S A(17)=FDA(392,XXDATE_",",24.2,"E")            ;Zip code of departure
"RTN","DGBTR124",70,0)
 ..S A(18)=FDA(392,XXDATE_",",11,"E")               ;Division
"RTN","DGBTR124",71,0)
 ..S A(19)=FDA(392,XXDATE_",",51,"E")               ;Remarks
"RTN","DGBTR124",72,0)
 ..S A(20)=FDA(392,XXDATE_",",12,"E")              ;WHO ENTERED INTO FILE
"RTN","DGBTR124",73,0)
 ..S A(21)=FDA(392,XXDATE_",",32,"E")               ;MILEAGE/ONE WAY
"RTN","DGBTR124",74,0)
 ..S:A(7)="R" A(21)=A(21)*2                         ;If roud trip double miles
"RTN","DGBTR124",75,0)
 ..I FDA(392,XXDATE_",",56,"I")="S" D                  ;Handle special mode
"RTN","DGBTR124",76,0)
 ...S A(8)=FDA(392,XXDATE_",",60,"E")                  ;SP Total Invoice Amount
"RTN","DGBTR124",77,0)
 ...S A(7)=$E(FDA(392,XXDATE_",",67,"E"),1)           ;SP One Way / Round Trip
"RTN","DGBTR124",78,0)
 ...S A(21)=FDA(392,XXDATE_",",68,"E")                ;SP Total miles ??
"RTN","DGBTR124",79,0)
 ...S A(14)=FDA(392,XXDATE_",",73,"E")                ;SP Place of departure
"RTN","DGBTR124",80,0)
 ...S A(15)=FDA(392,XXDATE_",",75,"E")                ;SP City of departure
"RTN","DGBTR124",81,0)
 ...S A(16)=FDA(392,XXDATE_",",76,"E")                ;SP State of departure
"RTN","DGBTR124",82,0)
 ...S A(17)=FDA(392,XXDATE_",",77,"E")                ;SP Zip code of departure
"RTN","DGBTR124",83,0)
 ...S A(19)=FDA(392,XXDATE_",",72,"E")                ;SP Remarks
"RTN","DGBTR124",84,0)
 ..I EXCEL D EXCEL Q
"RTN","DGBTR124",85,0)
 ..D PRINT
"RTN","DGBTR124",86,0)
 I IOST["C-" S TT=$$PAUSE^DGBTUTL(EXCEL)
"RTN","DGBTR124",87,0)
 I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR124",88,0)
 D ^%ZISC
"RTN","DGBTR124",89,0)
 Q
"RTN","DGBTR124",90,0)
PRINT ;
"RTN","DGBTR124",91,0)
 N L,T1,TT
"RTN","DGBTR124",92,0)
 D:LINE>IOSL HEADER Q:EXIT
"RTN","DGBTR124",93,0)
 S TXT="",L=0
"RTN","DGBTR124",94,0)
 F L=1:1 S I=$P(AA,",",L) Q:'I  S T1=$P(B(I),U,2)-$L(A(I)) S:T1'>0 T1=1 S TXT=TXT_$E(A(I),1,$P(B(I),U,2)-1)_$S(I=19:"",1:$E(H2,1,T1))
"RTN","DGBTR124",95,0)
 U IO F I=0:IOM S TT=$E(TXT,I+1,I+IOM) Q:'$L(TT)  W !,TT
"RTN","DGBTR124",96,0)
 S LINE=LINE+($L(TXT)\IOM)+3
"RTN","DGBTR124",97,0)
 U IO W !
"RTN","DGBTR124",98,0)
 Q
"RTN","DGBTR124",99,0)
HEADER ;
"RTN","DGBTR124",100,0)
 S PAGE=PAGE+1,L=0,TXT="",TT=""
"RTN","DGBTR124",101,0)
 I LINE'=99999,$E(IOST,1,4)="C-VT" U IO S TT=$$PAUSE() I TT[U S EXIT=1 Q
"RTN","DGBTR124",102,0)
 U IO W @IOF,?IOM/2-35,H0," Page: ",PAGE,!,H1
"RTN","DGBTR124",103,0)
 F L=1:1 S I=$P(AA,",",L) Q:'I  S T1=$P(B(I),U,2)-$L($P(B(I),U)) S TXT=TXT_$P(B(I),U)_$E(H2,1,T1)
"RTN","DGBTR124",104,0)
 U IO F I=0:IOM S TT=$E(TXT,I+1,I+IOM) Q:'$L(TT)  W !,TT
"RTN","DGBTR124",105,0)
 U IO W !,H1 S LINE=5
"RTN","DGBTR124",106,0)
 Q
"RTN","DGBTR124",107,0)
DP(DATE) ;Set printable date
"RTN","DGBTR124",108,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","DGBTR124",109,0)
EXCEL ;Print to spreadsheet
"RTN","DGBTR124",110,0)
 D:LINE=99999
"RTN","DGBTR124",111,0)
 .S LINE=0,TXT="" F L=1:1 S I=$P(AA,",",L) Q:'I  S TXT=TXT_$TR($P(C(I),U),DEL," ")_$S(I=19:"",1:DEL)
"RTN","DGBTR124",112,0)
 .U IO W !,TXT
"RTN","DGBTR124",113,0)
 S TXT="" F L=1:1 S I=$P(AA,",",L) Q:'I  S TXT=TXT_$TR(A(I),DEL," ")_$S(I=19:"",1:DEL)
"RTN","DGBTR124",114,0)
 U IO W !,TXT
"RTN","DGBTR124",115,0)
 Q
"RTN","DGBTR124",116,0)
DLRAMT(X) D COMMA^%DTC Q $S(EXCEL:"",1:"$")_$TR(X," ","")
"RTN","DGBTR124",117,0)
EXIT ;
"RTN","DGBTR124",118,0)
 Q
"RTN","DGBTR124",119,0)
PAUSE(X) ;Local pause
"RTN","DGBTR124",120,0)
 N DIR,Y
"RTN","DGBTR124",121,0)
 S X=$G(X,"PRESS RETURN TO CONTINUE OR '^' TO STOP")
"RTN","DGBTR124",122,0)
 S DIR("A")=X,DIR(0)="FAO" D ^DIR
"RTN","DGBTR124",123,0)
 Q Y
"RTN","DGBTR125")
0^32^B94720260
"RTN","DGBTR125",1,0)
DGBTR125 ;ALB/RFE - SPECIAL MODE REPORT; 06/22/12
"RTN","DGBTR125",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTR125",3,0)
 Q
"RTN","DGBTR125",4,0)
EN ;Entry point
"RTN","DGBTR125",5,0)
 N %,%Y,DATALINE,DENY,DFN,DGBTDIVN,DGBTEXC,DGBTQ,ENAME,ENDDT,ENTRY,EQUAL,GRAND,I,LINESP,LINEZERO,PAGE,PATNAME,PDT,POP,PROMPT,REPTYPE,SNAME,SQ1,SQ2
"RTN","DGBTR125",6,0)
 N STARTDT,X,X2,X3,Y,ZTQUEUED
"RTN","DGBTR125",7,0)
 D CLEAN^DILF
"RTN","DGBTR125",8,0)
 S X2="2$"
"RTN","DGBTR125",9,0)
 K DIR
"RTN","DGBTR125",10,0)
 S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR125",11,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR125",12,0)
 S STARTDT=Y
"RTN","DGBTR125",13,0)
 S DIR("A")="END DATE: ",DIR(0)="DA^"_STARTDT_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR125",14,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR125",15,0)
 S ENDDT=Y
"RTN","DGBTR125",16,0)
 D
"RTN","DGBTR125",17,0)
 .I $$GET1^DIQ(43,1,11,"I") D  Q
"RTN","DGBTR125",18,0)
 ..S DGBTDIVN=$$YESNO^DGBTUTL("Do you wish to run this report for all divisions")
"RTN","DGBTR125",19,0)
 ..I DGBTDIVN S DGBTDIVN="ALL" Q
"RTN","DGBTR125",20,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR125",21,0)
 ..K DIR S DIR(0)="P^40.8:EMZ" D ^DIR K DIR
"RTN","DGBTR125",22,0)
 ..I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR125",23,0)
 ..S DGBTDIVN=+Y
"RTN","DGBTR125",24,0)
 .S DGBTDIVN=$O(^DG(40.8,0))
"RTN","DGBTR125",25,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR125",26,0)
 F  D  Q:DONE
"RTN","DGBTR125",27,0)
 .S DONE=1
"RTN","DGBTR125",28,0)
 .K DIR S DIR("A")="START NAME",DIR("B")="AAA",DIR(0)="F^1:30^" D ^DIR K DIR
"RTN","DGBTR125",29,0)
 .I ($D(DIRUT))!($D(DIROUT)) Q
"RTN","DGBTR125",30,0)
 .S SNAME=$$UP^XLFSTR(Y)
"RTN","DGBTR125",31,0)
 .K DIR S DIR("A")="END NAME",DIR("B")="ZZZ",DIR(0)="F^1:30^" D ^DIR K DIR
"RTN","DGBTR125",32,0)
 .I ($D(DIRUT))!($D(DIROUT)) Q
"RTN","DGBTR125",33,0)
 .S ENAME=$$UP^XLFSTR(Y)
"RTN","DGBTR125",34,0)
 .I SNAME]ENAME W !,"START NAME CANNOT FOLLOW END NAME" S DONE=0 Q
"RTN","DGBTR125",35,0)
 K DONE
"RTN","DGBTR125",36,0)
 I ($D(DIRUT))!($D(DIROUT)) D CLEAN^DILF Q
"RTN","DGBTR125",37,0)
 K DIR
"RTN","DGBTR125",38,0)
 S DIR(0)="S^F:FULL;T:TOTAL",DIR("A")="Which claim type do you want to run?" D ^DIR K DIR
"RTN","DGBTR125",39,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR125",40,0)
 S REPTYPE=Y
"RTN","DGBTR125",41,0)
 D SETPRT,QUIT
"RTN","DGBTR125",42,0)
 Q
"RTN","DGBTR125",43,0)
SETPRT ;
"RTN","DGBTR125",44,0)
 S DGBTEXC=$$SELEXCEL^DGBTUTL
"RTN","DGBTR125",45,0)
 I DGBTEXC="^" Q
"RTN","DGBTR125",46,0)
 I 'DGBTEXC N COLWID S COLWID=132 D PRINTMSG^DGBTUTL
"RTN","DGBTR125",47,0)
 D DEVICE^DGBTUTL("Beneficiary Travel Special Mode Report","MAIN^DGBTR125(DGBTEXC,STARTDT,ENDDT,DGBTDIVN,SNAME,ENAME,REPTYPE)",DGBTEXC,132)
"RTN","DGBTR125",48,0)
 I $G(DGBTQ) Q
"RTN","DGBTR125",49,0)
 ;
"RTN","DGBTR125",50,0)
 I $D(IO("Q")) D:'$D(ZTQUEUED) ^%ZISC Q
"RTN","DGBTR125",51,0)
 D MAIN(DGBTEXC,STARTDT,ENDDT,DGBTDIVN,SNAME,ENAME,REPTYPE)
"RTN","DGBTR125",52,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","DGBTR125",53,0)
 U IO
"RTN","DGBTR125",54,0)
 Q
"RTN","DGBTR125",55,0)
MAIN(DGBTEXC,STARTDT,ENDDT,DGBTDIVN,SNAME,ENAME,REPTYPE) ;
"RTN","DGBTR125",56,0)
 K ^TMP("DGBTR125",$J)
"RTN","DGBTR125",57,0)
 D GETRECS
"RTN","DGBTR125",58,0)
 I '$D(^TMP("DGBTR125",$J)) W !,"No records found" D QUIT Q
"RTN","DGBTR125",59,0)
 D PRINT
"RTN","DGBTR125",60,0)
 Q
"RTN","DGBTR125",61,0)
GETRECS ;
"RTN","DGBTR125",62,0)
 I REPTYPE="F" F I="CLAIMS","MILE","BASE RATE","MILEAGE FEE","NSNL","WAIT TIME","EXTRA CREW","SPECIAL EQUIPMENT","INVOICE AMT" S GRAND(I)=0
"RTN","DGBTR125",63,0)
 I REPTYPE="T" F I="PAID","DENIED","CLAIMS","NSNL","PAID AMT" S GRAND(I)=0
"RTN","DGBTR125",64,0)
 S ENTRY=$O(^DGBT(392,"D",STARTDT),-1)
"RTN","DGBTR125",65,0)
 F  S ENTRY=$O(^DGBT(392,"D",ENTRY)) Q:ENTRY=""  Q:ENTRY>ENDDT  D
"RTN","DGBTR125",66,0)
 .S I=""
"RTN","DGBTR125",67,0)
 .F  S I=$O(^DGBT(392,"D",ENTRY,I)) Q:I=""  D GETLINE
"RTN","DGBTR125",68,0)
 Q
"RTN","DGBTR125",69,0)
GETLINE ; 
"RTN","DGBTR125",70,0)
 S LINEZERO=$G(^DGBT(392,I,0))
"RTN","DGBTR125",71,0)
 I '$$DIV Q
"RTN","DGBTR125",72,0)
 S DATALINE=""
"RTN","DGBTR125",73,0)
 I $$GET1^DIQ(392,I,56,"I")'="S" Q
"RTN","DGBTR125",74,0)
 S DFN=$P(LINEZERO,U,2) Q:DFN=""
"RTN","DGBTR125",75,0)
 S PATNAME=$$GET1^DIQ(2,DFN,.01)
"RTN","DGBTR125",76,0)
 I '$$NMRNG^DGBTUTL(PATNAME,SNAME,ENAME,1) Q
"RTN","DGBTR125",77,0)
 S LINESP=$G(^DGBT(392,I,"SP"))
"RTN","DGBTR125",78,0)
 S DATALINE=""
"RTN","DGBTR125",79,0)
 I REPTYPE="F" D GLFULL
"RTN","DGBTR125",80,0)
 I REPTYPE="T" D GLTOTAL
"RTN","DGBTR125",81,0)
 I DATALINE'="" S ^TMP("DGBTR125",$J,SQ1,SQ2)=DATALINE
"RTN","DGBTR125",82,0)
 Q
"RTN","DGBTR125",83,0)
DIV() ;
"RTN","DGBTR125",84,0)
 I DGBTDIVN="ALL" Q 1
"RTN","DGBTR125",85,0)
 Q $P(LINEZERO,U,11)=DGBTDIVN
"RTN","DGBTR125",86,0)
GLFULL ; Special mode full
"RTN","DGBTR125",87,0)
 S SQ1=ENTRY
"RTN","DGBTR125",88,0)
 S SQ2=$O(^TMP("DGBTR125",$J,SQ1,""),-1)+1
"RTN","DGBTR125",89,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR125",90,0)
 S $P(DATALINE,U)=PATNAME
"RTN","DGBTR125",91,0)
 S $P(DATALINE,U,2)=$$FMTE^XLFDT($P($P(LINEZERO,U),".")) ; Claim date/time
"RTN","DGBTR125",92,0)
 S $P(DATALINE,U,3)=$$GET1^DIQ(392.42,$P(LINESP,U),.01) ; Mode of transportation
"RTN","DGBTR125",93,0)
 S $P(DATALINE,U,4)=$P(LINESP,U,2) ; Invoice #
"RTN","DGBTR125",94,0)
 S $P(DATALINE,U,5)=$$FMTE^XLFDT($P(LINESP,U,3)) ; Invoice date
"RTN","DGBTR125",95,0)
 S $P(DATALINE,U,6)=$$GET1^DIQ(392,I,67,"I") ; One way/round trip
"RTN","DGBTR125",96,0)
 S $P(DATALINE,U,7)=$P(LINESP,U,12) ; Miles
"RTN","DGBTR125",97,0)
 S GRAND("MILE")=GRAND("MILE")+$P(LINESP,U,12)
"RTN","DGBTR125",98,0)
 S $P(DATALINE,U,8)=$$DLRAMT($P(LINESP,U,5)) ; Base rate fee
"RTN","DGBTR125",99,0)
 S GRAND("BASE RATE")=GRAND("BASE RATE")+$P(LINESP,U,5)
"RTN","DGBTR125",100,0)
 S $P(DATALINE,U,9)=$$DLRAMT($P(LINESP,U,6)) ; Mileage fee
"RTN","DGBTR125",101,0)
 S GRAND("MILEAGE FEE")=GRAND("MILEAGE FEE")+$P(LINESP,U,6)
"RTN","DGBTR125",102,0)
 S $P(DATALINE,U,10)=$$DLRAMT($P(LINESP,U,7)) ; No show/no load fee
"RTN","DGBTR125",103,0)
 S GRAND("NSNL")=GRAND("NSNL")+$P(LINESP,U,7)
"RTN","DGBTR125",104,0)
 S $P(DATALINE,U,11)=$$DLRAMT($P(LINESP,U,8)) ; Wait time fee
"RTN","DGBTR125",105,0)
 S GRAND("WAIT TIME")=GRAND("WAIT TIME")+$P(LINESP,U,8)
"RTN","DGBTR125",106,0)
 S $P(DATALINE,U,12)=$$DLRAMT($P(LINESP,U,9)) ; Extra crew fee
"RTN","DGBTR125",107,0)
 S GRAND("EXTRA CREW")=GRAND("EXTRA CREW")+$P(LINESP,U,9)
"RTN","DGBTR125",108,0)
 S $P(DATALINE,U,13)=$$DLRAMT($P(LINESP,U,10)) ; Special equipment fee
"RTN","DGBTR125",109,0)
 S GRAND("SPECIAL EQUIPMENT")=GRAND("SPECIAL EQUIPMENT")+$P(LINESP,U,10)
"RTN","DGBTR125",110,0)
 S $P(DATALINE,U,14)=$$DLRAMT($P(LINESP,U,4)) ; Total invoice amount
"RTN","DGBTR125",111,0)
 S GRAND("INVOICE AMT")=GRAND("INVOICE AMT")+$P(LINESP,U,4)
"RTN","DGBTR125",112,0)
 S $P(DATALINE,U,15)=$$GET1^DIQ(40.8,$P(LINEZERO,U,11),.01) ; Division
"RTN","DGBTR125",113,0)
 S $P(DATALINE,U,16)=$$GET1^DIQ(440,$P(LINESP,U,14),.01) ; Vendor
"RTN","DGBTR125",114,0)
 S $P(DATALINE,U,17)=$S($$GET1^DIQ(392,I,45.2,"I"):"D",1:"")
"RTN","DGBTR125",115,0)
 Q
"RTN","DGBTR125",116,0)
GLTOTAL ; Special mode total
"RTN","DGBTR125",117,0)
 S SQ1=$P(LINEZERO,U,11)_"^"_$$GET1^DIQ(392.42,$P(LINESP,U),.01)
"RTN","DGBTR125",118,0)
 S SQ2=0
"RTN","DGBTR125",119,0)
 S DENY=$$GET1^DIQ(392,I,45.2,"I")
"RTN","DGBTR125",120,0)
 S DATALINE=$G(^TMP("DGBTR125",$J,SQ1,SQ2))
"RTN","DGBTR125",121,0)
 S $P(DATALINE,U)=$P(DATALINE,U)+$S(DENY:0,1:1) ;claims paid
"RTN","DGBTR125",122,0)
 I 'DENY S GRAND("PAID")=GRAND("PAID")+1
"RTN","DGBTR125",123,0)
 S $P(DATALINE,U,2)=$P(DATALINE,U,2)+$S(DENY:1,1:0) ; Claims denied
"RTN","DGBTR125",124,0)
 I DENY S GRAND("DENIED")=GRAND("DENIED")+1
"RTN","DGBTR125",125,0)
 S $P(DATALINE,U,3)=1+$P(DATALINE,U,3) ; Number of claims
"RTN","DGBTR125",126,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR125",127,0)
 S $P(DATALINE,U,4)=$P(DATALINE,U,4)+$S('DENY:$P(LINESP,U,7),1:0) ; No show/no load
"RTN","DGBTR125",128,0)
 I 'DENY S GRAND("NSNL")=GRAND("NSNL")+$P(LINESP,U,7)
"RTN","DGBTR125",129,0)
 S $P(DATALINE,U,5)=$P(DATALINE,U,5)+$S('DENY:$P(LINESP,U,4),1:0) ; Invoice
"RTN","DGBTR125",130,0)
 I 'DENY S GRAND("PAID AMT")=GRAND("PAID AMT")+$P(LINESP,U,4)
"RTN","DGBTR125",131,0)
 Q
"RTN","DGBTR125",132,0)
PRINT ;
"RTN","DGBTR125",133,0)
 U IO
"RTN","DGBTR125",134,0)
 S $P(EQUAL,"=",133)="",PAGE=0
"RTN","DGBTR125",135,0)
 D NOW^%DTC S Y=% D DD^%DT S PDT=Y
"RTN","DGBTR125",136,0)
 I 'DGBTEXC D
"RTN","DGBTR125",137,0)
 .I REPTYPE="F" D HDRFUL
"RTN","DGBTR125",138,0)
 .I REPTYPE="T" D HDRTOT
"RTN","DGBTR125",139,0)
 I DGBTEXC D
"RTN","DGBTR125",140,0)
 .I REPTYPE="F" D
"RTN","DGBTR125",141,0)
 ..W "ENTRY DATE^PATIENT^CLAIM DATE^CC MODE^INV #^INV DT^R/O^MILES^BASE RATE^MILE FEE^NO SHOW NO LOAD^WAIT TIME^EXTRA CREW^SPECIAL EQUIPMENT^INV AMT^"
"RTN","DGBTR125",142,0)
 ..W "DIVISION^VENDOR^STATUS"
"RTN","DGBTR125",143,0)
 .I REPTYPE="T" D
"RTN","DGBTR125",144,0)
 ..W "DIVISION^# PAID^# DENIED ^BY MODE^NSNL^INVOICE PAID^MODE"
"RTN","DGBTR125",145,0)
 S (PROMPT,SQ1)=""
"RTN","DGBTR125",146,0)
 F  S SQ1=$O(^TMP("DGBTR125",$J,SQ1)) Q:SQ1=""  D  Q:PROMPT="^"
"RTN","DGBTR125",147,0)
 .S SQ2=""
"RTN","DGBTR125",148,0)
 .F  S SQ2=$O(^TMP("DGBTR125",$J,SQ1,SQ2)) Q:SQ2=""  D  Q:PROMPT="^"
"RTN","DGBTR125",149,0)
 ..S DATALINE=^TMP("DGBTR125",$J,SQ1,SQ2)
"RTN","DGBTR125",150,0)
 ..I DGBTEXC D PRTXL Q
"RTN","DGBTR125",151,0)
 ..I ($Y+$S(REPTYPE="F":4,1:2))>IOSL D  Q:PROMPT="^"
"RTN","DGBTR125",152,0)
 ...I ($E(IOST,1)="C"),(IOSL'[99) R !,"Please press ENTER to continue or '^' to stop ",PROMPT:DTIME Q:PROMPT="^"
"RTN","DGBTR125",153,0)
 ...I REPTYPE="F" D HDRFUL
"RTN","DGBTR125",154,0)
 ...I REPTYPE="T" D HDRTOT
"RTN","DGBTR125",155,0)
 ..I REPTYPE="F" D PRTFUL
"RTN","DGBTR125",156,0)
 ..I REPTYPE="T" D PRTTOT
"RTN","DGBTR125",157,0)
 I 'DGBTEXC D
"RTN","DGBTR125",158,0)
 .I ($Y+4)<IOSL W !!!
"RTN","DGBTR125",159,0)
 .I REPTYPE="F" D GRANDFUL
"RTN","DGBTR125",160,0)
 .I REPTYPE="T" D GRANDTOT
"RTN","DGBTR125",161,0)
 I IOST["C-" S Y=$$PAUSE^DGBTUTL(DGBTEXC)
"RTN","DGBTR125",162,0)
 I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR125",163,0)
 Q
"RTN","DGBTR125",164,0)
PRTXL ;
"RTN","DGBTR125",165,0)
 I REPTYPE="F" D
"RTN","DGBTR125",166,0)
 . W !,$$FMTE^XLFDT($P(SQ1,U)),U,DATALINE
"RTN","DGBTR125",167,0)
 I REPTYPE="T" D
"RTN","DGBTR125",168,0)
 .W !,$$GET1^DIQ(40.8,$P(SQ1,U),.01),U F I=1:1:3 W $P(DATALINE,U,I),U
"RTN","DGBTR125",169,0)
 .W $$DLRAMT($P(DATALINE,U,4)),U,$$DLRAMT($P(DATALINE,U,5)),U,$P(SQ1,U,2)
"RTN","DGBTR125",170,0)
 Q
"RTN","DGBTR125",171,0)
PRTFUL ;
"RTN","DGBTR125",172,0)
 W !,$P(DATALINE,U),?32,$P(DATALINE,U,2),?52,$P(DATALINE,U,3),?84,$P(DATALINE,U,4),?116,$P(DATALINE,U,5)
"RTN","DGBTR125",173,0)
 W !,?5,$P(DATALINE,U,6),?17,$P(DATALINE,U,7),?27,$P(DATALINE,U,8),?42,$P(DATALINE,U,9),?52,$P(DATALINE,U,10),?63,$P(DATALINE,U,11)
"RTN","DGBTR125",174,0)
 W ?73,$P(DATALINE,U,12),?83,$P(DATALINE,U,13),?94,$P(DATALINE,U,14),?105,$$FMTE^XLFDT(SQ1)
"RTN","DGBTR125",175,0)
 W !,?5,$P(DATALINE,U,15),?37,$P(DATALINE,U,16),?75,$P(DATALINE,U,17)
"RTN","DGBTR125",176,0)
 Q
"RTN","DGBTR125",177,0)
PRTTOT ;
"RTN","DGBTR125",178,0)
 W !,$$GET1^DIQ(40.8,$P(SQ1,U),.01),?37,$P(DATALINE,U),?43,$P(DATALINE,U,2),?51,$P(DATALINE,U,3),?59,$$DLRAMT($P(DATALINE,U,4))
"RTN","DGBTR125",179,0)
 W ?74,$$DLRAMT($P(DATALINE,U,5)),?90,$P(SQ1,U,2)
"RTN","DGBTR125",180,0)
 Q
"RTN","DGBTR125",181,0)
HDRFUL ;
"RTN","DGBTR125",182,0)
 S PAGE=PAGE+1
"RTN","DGBTR125",183,0)
 W @IOF
"RTN","DGBTR125",184,0)
 W "BT SPECIAL MODE FULL REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR125",185,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR125",186,0)
 W !,"FIRST VETERAN NAME: ",SNAME
"RTN","DGBTR125",187,0)
 W !,"LAST VETERAN NAME: ",ENAME
"RTN","DGBTR125",188,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR125",189,0)
 W !,$E(EQUAL,1,128)
"RTN","DGBTR125",190,0)
 W !,"PATIENT NAME",?32,"CLAIM DATE",?52,"MODE",?84,"INV #",?116,"INVOICE DATE"
"RTN","DGBTR125",191,0)
 w !?5,"R/O",?17,"MILES",?27,"BASE RATE",?42,"MILEAGE",?52,"NSNL",?63,"WAIT FEE",?73,"EXT CREW",?83,"SPEC EQ",?94,"INV AMT",?105,"ENTRY DATE"
"RTN","DGBTR125",192,0)
 W !?5,"DIVISION",?37,"VENDOR",?75,"STATUS"
"RTN","DGBTR125",193,0)
 W !,$E(EQUAL,1,128)
"RTN","DGBTR125",194,0)
 Q
"RTN","DGBTR125",195,0)
HDRTOT ;
"RTN","DGBTR125",196,0)
 S PAGE=PAGE+1
"RTN","DGBTR125",197,0)
 W @IOF
"RTN","DGBTR125",198,0)
 W "BT SPECIAL MODE TOTAL REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR125",199,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR125",200,0)
 W !,"FIRST VETERAN NAME: ",SNAME
"RTN","DGBTR125",201,0)
 W !,"LAST VETERAN NAME: ",ENAME
"RTN","DGBTR125",202,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR125",203,0)
 W !,$E(EQUAL,1,126)
"RTN","DGBTR125",204,0)
 W !,"DIVISION",?37,"PAID",?43,"DENIED",?51,"CLAIMS",?59,"NSNL",?74,"INV PAID",?90,"MODE"
"RTN","DGBTR125",205,0)
 W !,$E(EQUAL,1,126)
"RTN","DGBTR125",206,0)
 Q
"RTN","DGBTR125",207,0)
GRANDFUL ;
"RTN","DGBTR125",208,0)
 I ($Y+5)>IOSL D
"RTN","DGBTR125",209,0)
 .S PAGE=PAGE+1
"RTN","DGBTR125",210,0)
 .W @IOF
"RTN","DGBTR125",211,0)
 .W "BT SPECIAL MODE FULL REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR125",212,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR125",213,0)
 .W !,"FIRST VETERAN NAME: ",SNAME
"RTN","DGBTR125",214,0)
 .W !,"LAST VETERAN NAME: ",ENAME
"RTN","DGBTR125",215,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR125",216,0)
 W !,$E(EQUAL,1,128)
"RTN","DGBTR125",217,0)
 W !,"GRAND TOTALS:",?17,"MILES",?27,"BASE RATE",?42,"MILEAGE",?52,"NSNL",?63,"WAIT FEE",?73,"EXT CREW",?83,"SPEC EQ",?94,"INV AMT",?105,"CLAIMS"
"RTN","DGBTR125",218,0)
 W !,?17,GRAND("MILE"),?27,$$DLRAMT(GRAND("BASE RATE")),?42,$$DLRAMT(GRAND("MILEAGE FEE")),?52,$$DLRAMT(GRAND("NSNL"))
"RTN","DGBTR125",219,0)
 W ?63,$$DLRAMT(GRAND("WAIT TIME")),?73,$$DLRAMT(GRAND("EXTRA CREW")),?83,$$DLRAMT(GRAND("SPECIAL EQUIPMENT"))
"RTN","DGBTR125",220,0)
 W ?94,$$DLRAMT(GRAND("INVOICE AMT")),?105,GRAND("CLAIMS")
"RTN","DGBTR125",221,0)
 W !,$E(EQUAL,1,128)
"RTN","DGBTR125",222,0)
 Q
"RTN","DGBTR125",223,0)
GRANDTOT ;
"RTN","DGBTR125",224,0)
 I ($Y+5)>IOSL D
"RTN","DGBTR125",225,0)
 .S PAGE=PAGE+1
"RTN","DGBTR125",226,0)
 .W @IOF
"RTN","DGBTR125",227,0)
 .W "BT SPECIAL MODE TOTAL REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR125",228,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR125",229,0)
 .W !,"FIRST VETERAN NAME: ",SNAME
"RTN","DGBTR125",230,0)
 .W !,"LAST VETERAN NAME: ",ENAME
"RTN","DGBTR125",231,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR125",232,0)
 W !,$E(EQUAL,1,126)
"RTN","DGBTR125",233,0)
 W !,"GRAND TOTALS:",?37,"PAID",?43,"DENIED",?51,"CLAIMS",?59,"NSNL",?74,"INV PAID"
"RTN","DGBTR125",234,0)
 W !,?37,GRAND("PAID"),?43,GRAND("DENIED"),?51,GRAND("CLAIMS"),?59,$$DLRAMT(GRAND("NSNL")),?74,$$DLRAMT(GRAND("PAID AMT"))
"RTN","DGBTR125",235,0)
 W !,$E(EQUAL,1,126)
"RTN","DGBTR125",236,0)
 Q
"RTN","DGBTR125",237,0)
DLRAMT(X) ;
"RTN","DGBTR125",238,0)
 D COMMA^%DTC I 'DGBTEXC Q $TR(X," ","")
"RTN","DGBTR125",239,0)
 Q $TR(X," ,$","")
"RTN","DGBTR125",240,0)
QUIT ;
"RTN","DGBTR125",241,0)
 K ^TMP("DGBTR125",$J)
"RTN","DGBTR125",242,0)
 D CLEAN^DILF
"RTN","DGBTR125",243,0)
 Q
"RTN","DGBTR17")
0^33^B130956711
"RTN","DGBTR17",1,0)
DGBTR17 ;ALB/RFE - VOUCHER REPORT; 03/14/12
"RTN","DGBTR17",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTR17",3,0)
 Q
"RTN","DGBTR17",4,0)
EN ; Entry point
"RTN","DGBTR17",5,0)
 N %,%Y,ACCOUNT,ADDRLIN,ALLOW,CCFEE,DED,DEPARTLIN,DESTLIN,DFN,DGBTDIV,DGBTDIVI,DGBTDIVN,DGBTEXCEL,DGBTQ,ECON,ENDDT,ENTRY,ERR,EQUAL,FERRIES,FACLIN
"RTN","DGBTR17",6,0)
 N FIRSTPAGE,GRAND,I,II,LINEZERO,MASDATE,MASLIN,MASRATE,MEALS,MILES,MILESRATE,MILESTRAV,RAY,PAGE,PATSTATE,PATZERO,POP,PDT,SQ1,SQ2,STARTDT,TMPADD,TRIPS
"RTN","DGBTR17",7,0)
 N TRIPTYP,WRTLIN,X,X2,X3,Y,ZTQUEUED
"RTN","DGBTR17",8,0)
 K ^TMP("DGBTVRPT",$J)
"RTN","DGBTR17",9,0)
 D CLEAN^DILF
"RTN","DGBTR17",10,0)
 S X2="2$"
"RTN","DGBTR17",11,0)
DIVISN ; if MED CTR DIV file set up (first record) and record does not exist, write warning and exit
"RTN","DGBTR17",12,0)
 S X=$G(^DG(40.8,0)) I X="" W !,"WARNING...MEDICAL CENTER DIVISION FILE IS NOT SET UP",!,"USE THE ADT PARAMETER OPTION FILE TO SET UP DIVISION" Q
"RTN","DGBTR17",13,0)
 ;  check if multi-divisional center (GL node exists and 2nd piece=1). Do lookup, if it exists-set local variables
"RTN","DGBTR17",14,0)
 I $D(^DG(43,1,"GL")),$P(^("GL"),U,2) D  Q:Y'>0  Q:$D(ERR)  D MAIN,QUIT Q
"RTN","DGBTR17",15,0)
 .S DGBTDIVN=$$YESNO^DGBTUTL("Do you wish to run this report for all divisions")
"RTN","DGBTR17",16,0)
 .I DGBTDIVN S DGBTDIVN="ALL",(DGBTDIVI,DGBTDIV)=0 Q
"RTN","DGBTR17",17,0)
 .I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR17",18,0)
 .K DIR S DIR(0)="P^40.8:EMZ" D ^DIR K DIR
"RTN","DGBTR17",19,0)
 .I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) Q
"RTN","DGBTR17",20,0)
 .S DGBTDIVN=+Y,DGBTDIVI=$P(Y,U,2)
"RTN","DGBTR17",21,0)
 .D INSTIT
"RTN","DGBTR17",22,0)
 I (($D(DIRUT))!($D(DTOUT))!($D(DUOUT))) D CLEAN^DILF Q
"RTN","DGBTR17",23,0)
 ;  if not a multi-divisional center, default to institution name
"RTN","DGBTR17",24,0)
 S DGBTDIVN=$O(^DG(40.8,0)),DGBTDIVI=$P(^DG(40.8,DGBTDIVN,0),U) D INSTIT
"RTN","DGBTR17",25,0)
 Q:$D(ERR)
"RTN","DGBTR17",26,0)
 D MAIN
"RTN","DGBTR17",27,0)
 D QUIT
"RTN","DGBTR17",28,0)
 Q
"RTN","DGBTR17",29,0)
MAIN ;
"RTN","DGBTR17",30,0)
 K DIR
"RTN","DGBTR17",31,0)
 S DIR("A")="START DATE: ",DIR(0)="DA^2991231:NOW:EX" D ^DIR K DIR
"RTN","DGBTR17",32,0)
 I ($D(DIRUT))!($D(DIROUT)) Q
"RTN","DGBTR17",33,0)
 S STARTDT=Y
"RTN","DGBTR17",34,0)
 S DIR("A")="END DATE: ",DIR(0)="DA^"_STARTDT_":NOW:EX" D ^DIR K DIR
"RTN","DGBTR17",35,0)
 I ($D(DIRUT))!($D(DIROUT)) Q
"RTN","DGBTR17",36,0)
 S ENDDT=Y
"RTN","DGBTR17",37,0)
 S DGBTEXCEL=$$SELEXCEL^DGBTUTL
"RTN","DGBTR17",38,0)
 I DGBTEXCEL="^" Q
"RTN","DGBTR17",39,0)
 I 'DGBTEXCEL N COLWID S COLWID=132 D PRINTMSG^DGBTUTL
"RTN","DGBTR17",40,0)
 D DEVICE^DGBTUTL("Beneficiary Travel Fiscal Report","MAIN1^DGBTR17(DGBTEXCEL,STARTDT,ENDDT,DGBTDIVI,DGBTDIVN,DGBTDIV)",DGBTEXCEL,132)
"RTN","DGBTR17",41,0)
 I $G(DGBTQ) Q
"RTN","DGBTR17",42,0)
 ;
"RTN","DGBTR17",43,0)
 ;I $D(IO("Q")) D:'$D(ZTQUEUED) ^%ZISC Q
"RTN","DGBTR17",44,0)
 D MAIN1(DGBTEXCEL,STARTDT,ENDDT,DGBTDIVI,DGBTDIVN,DGBTDIV)
"RTN","DGBTR17",45,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","DGBTR17",46,0)
 U IO
"RTN","DGBTR17",47,0)
 Q
"RTN","DGBTR17",48,0)
MAIN1(DGBTEXCEL,STARTDT,ENDDT,DGBTDIVI,DGBTDIVN,DGBTDIV) ;
"RTN","DGBTR17",49,0)
 K ^TMP("DGBTVRPT",$J)
"RTN","DGBTR17",50,0)
 D GETRECS
"RTN","DGBTR17",51,0)
 I ($D(DIRUT))!($D(DIROUT))!($D(ERR)) Q
"RTN","DGBTR17",52,0)
 I '$D(^TMP("DGBTVRPT",$J)) W !,"NO VOUCHERS FOUND" Q
"RTN","DGBTR17",53,0)
 D PRINT
"RTN","DGBTR17",54,0)
 Q
"RTN","DGBTR17",55,0)
PRINT ;
"RTN","DGBTR17",56,0)
 U IO
"RTN","DGBTR17",57,0)
 I DGBTEXCEL D
"RTN","DGBTR17",58,0)
 .W "NAME^ADD1^ADD2^CITY^STATE^ZIP^ID^FAC^DEP^DEST^MILES^M & L^TOTAL - 11^TOTAL - 13^CL DT^CERT^VOUCH DT^ACCOUNT^DED^CC FEE^PAYABLE"
"RTN","DGBTR17",59,0)
 .Q
"RTN","DGBTR17",60,0)
 N PROMPT
"RTN","DGBTR17",61,0)
 S PROMPT="",PAGE=0,$P(EQUAL,"=",133)=""
"RTN","DGBTR17",62,0)
 D NOW^%DTC S Y=% D DD^%DT S PDT=Y
"RTN","DGBTR17",63,0)
 S FIRSTPAGE=0
"RTN","DGBTR17",64,0)
 I 'DGBTEXCEL D HDR
"RTN","DGBTR17",65,0)
 S SQ1=""
"RTN","DGBTR17",66,0)
 F  Q:PROMPT="^"  S SQ1=$O(^TMP("DGBTVRPT",$J,SQ1)) Q:SQ1=""  S SQ2=""  D 
"RTN","DGBTR17",67,0)
 .F  S SQ2=$O(^TMP("DGBTVRPT",$J,SQ1,SQ2)) Q:SQ2=""  D PRT Q:PROMPT="^"
"RTN","DGBTR17",68,0)
 K ^TMP("DGBTVRPT",$J)
"RTN","DGBTR17",69,0)
 I ('DGBTEXCEL),(PROMPT="^") Q
"RTN","DGBTR17",70,0)
 I 'DGBTEXCEL D GTOT
"RTN","DGBTR17",71,0)
 I IOST["C-" S Y=$$PAUSE^DGBTUTL(DGBTEXCEL)
"RTN","DGBTR17",72,0)
 I IOST'["C-" W !,"REPORT HAS FINISHED"
"RTN","DGBTR17",73,0)
 Q
"RTN","DGBTR17",74,0)
GETRECS ;
"RTN","DGBTR17",75,0)
 F I="CLAIMS","MILES","ALLOW","M&L","F&B","ALLOW TOT","ECON","ECON TOT","PAYABLE","1W","RT","DED","CC FEE" S GRAND(I)=0
"RTN","DGBTR17",76,0)
 I DGBTDIVN'="ALL" D
"RTN","DGBTR17",77,0)
 .S RAY("FACILITY NAME")=$$GET1^DIQ(4,DGBTDIV,.01)
"RTN","DGBTR17",78,0)
 .S FACLIN=$G(^DIC(4,DGBTDIV,1))
"RTN","DGBTR17",79,0)
 .S RAY("FACILITY ADDR 1")=$P(FACLIN,"^")
"RTN","DGBTR17",80,0)
 .S RAY("FACILITY ADDR 2")=$P(FACLIN,"^",2)
"RTN","DGBTR17",81,0)
 .S RAY("FACILITY CITY")=$P(FACLIN,"^",3)
"RTN","DGBTR17",82,0)
 S PATSTATE=$$GET1^DIQ(4,DGBTDIV,.02,"I")
"RTN","DGBTR17",83,0)
 S RAY("FACILITY STATE")=$$GET1^DIQ(5,PATSTATE,1)
"RTN","DGBTR17",84,0)
 S RAY("FACILITY ZIP")=$$GET1^DIQ(4,DGBTDIV,1.04)
"RTN","DGBTR17",85,0)
 S ENTRY=$O(^DGBT(392,"D",STARTDT),-1)
"RTN","DGBTR17",86,0)
 F  S ENTRY=$O(^DGBT(392,"D",ENTRY)) Q:ENTRY=""  Q:ENTRY>ENDDT  D
"RTN","DGBTR17",87,0)
 .S I=""
"RTN","DGBTR17",88,0)
 .F  S I=$O(^DGBT(392,"D",ENTRY,I)) Q:I=""  I $$FAC(I),($$GET1^DIQ(392,I,56,"I")="M"),'($$GET1^DIQ(392,I,45.2,"I")) D REC
"RTN","DGBTR17",89,0)
 Q
"RTN","DGBTR17",90,0)
QUIT ;
"RTN","DGBTR17",91,0)
 K ^TMP("DGBTVRPT",$J)
"RTN","DGBTR17",92,0)
 D CLEAN^DILF
"RTN","DGBTR17",93,0)
 Q
"RTN","DGBTR17",94,0)
REC ;
"RTN","DGBTR17",95,0)
 I DGBTDIVN="ALL" D
"RTN","DGBTR17",96,0)
 .S DGBTDIVI=$$GET1^DIQ(40.8,$$GET1^DIQ(392,I,11,"I"),.01),DGBTDIV=$$GET1^DIQ(40.8,$$GET1^DIQ(392,I,11,"I"),.07,"I")
"RTN","DGBTR17",97,0)
 .S RAY("FACILITY NAME")=$$GET1^DIQ(4,DGBTDIV,.01)
"RTN","DGBTR17",98,0)
 .S FACLIN=$G(^DIC(4,DGBTDIV,1))
"RTN","DGBTR17",99,0)
 .S RAY("FACILITY ADDR 1")=$P(FACLIN,"^")
"RTN","DGBTR17",100,0)
 .S RAY("FACILITY ADDR 2")=$P(FACLIN,"^",2)
"RTN","DGBTR17",101,0)
 .S RAY("FACILITY CITY")=$P(FACLIN,"^",3)
"RTN","DGBTR17",102,0)
 S LINEZERO=^DGBT(392,I,0)
"RTN","DGBTR17",103,0)
 S DFN=$P(LINEZERO,"^",2)
"RTN","DGBTR17",104,0)
 S PATZERO=$G(^DPT(DFN,0))
"RTN","DGBTR17",105,0)
 S SQ1=RAY("FACILITY NAME")_"^"_$P(I,".")_"^"_$P(PATZERO,",")
"RTN","DGBTR17",106,0)
 S SQ2=$O(^TMP("DGBTVRPT",$J,SQ1,""),-1)+1
"RTN","DGBTR17",107,0)
 S GRAND("CLAIMS")=GRAND("CLAIMS")+1
"RTN","DGBTR17",108,0)
 S CCFEE=$$GET1^DIQ(392,I,55)
"RTN","DGBTR17",109,0)
 S RAY("NAME")=$P(PATZERO,"^")
"RTN","DGBTR17",110,0)
 S WRTLIN=$P(PATZERO,"^")
"RTN","DGBTR17",111,0)
 S TMPADD=$$GET1^DIQ(2,DFN,.12105)
"RTN","DGBTR17",112,0)
 S ADDRLIN=$G(^DPT(DFN,$S(TMPADD="YES":.121,1:.11)))
"RTN","DGBTR17",113,0)
 S MASLIN=$$MASLIN
"RTN","DGBTR17",114,0)
 F II=1:1:4 S WRTLIN=WRTLIN_"^"_$P(ADDRLIN,"^",II)
"RTN","DGBTR17",115,0)
 F II=1:1:3 S RAY("PAT ADDR "_II)=$P(ADDRLIN,"^",II)
"RTN","DGBTR17",116,0)
 S RAY("PAT CITY")=$P(ADDRLIN,"^",4)
"RTN","DGBTR17",117,0)
 S PATSTATE=$$GET1^DIQ(2,DFN,$S(TMPADD="YES":.1215,1:.115),"I")
"RTN","DGBTR17",118,0)
 S RAY("PAT STATE")=$$GET1^DIQ(5,PATSTATE,1)
"RTN","DGBTR17",119,0)
 S RAY("PAT ZIP")=$$GET1^DIQ(2,DFN,$S(TMPADD="YES":.1216,1:.116))
"RTN","DGBTR17",120,0)
 S RAY("SOCIAL SECURITY")=$P(PATZERO,"^",9)
"RTN","DGBTR17",121,0)
 S RAY("FISCAL SYMBOL")=$P(MASLIN,"^",4)
"RTN","DGBTR17",122,0)
 S DEPARTLIN=$G(^DGBT(392,I,"D"))
"RTN","DGBTR17",123,0)
 F II=1:1:3 S RAY("DEPARTURE "_II)=$P(DEPARTLIN,"^",II)
"RTN","DGBTR17",124,0)
 S RAY("DEPARTURE CITY")=$P(DEPARTLIN,"^",4)
"RTN","DGBTR17",125,0)
 S PATSTATE=$$GET1^DIQ(392,I,24.1,"I")
"RTN","DGBTR17",126,0)
 S RAY("DEPARTURE STATE")=$$GET1^DIQ(5,PATSTATE,1)
"RTN","DGBTR17",127,0)
 S RAY("DEPARTURE ZIP")=$$GET1^DIQ(392,I,24.2)
"RTN","DGBTR17",128,0)
 S DESTLIN=$G(^DGBT(392,I,"T"))
"RTN","DGBTR17",129,0)
 F II=1:1:3 S RAY("DESTINATION "_II)=$P(DESTLIN,"^",II)
"RTN","DGBTR17",130,0)
 S RAY("DESTINATION CITY")=$P(DESTLIN,"^",4)
"RTN","DGBTR17",131,0)
 S PATSTATE=$$GET1^DIQ(392,I,28.1,"I")
"RTN","DGBTR17",132,0)
 S RAY("DESTINATION STATE")=$$GET1^DIQ(5,PATSTATE,1)
"RTN","DGBTR17",133,0)
 S RAY("DESTINATION ZIP")=$$GET1^DIQ(392,I,28.2)
"RTN","DGBTR17",134,0)
 S MILES=$G(^DGBT(392,I,"M"))
"RTN","DGBTR17",135,0)
 S (MILESTRAV,RAY("MILES TRAVELED"))=$P(MILES,"^")*$P(MILES,"^",2)
"RTN","DGBTR17",136,0)
 S GRAND("MILES")=GRAND("MILES")+MILESTRAV
"RTN","DGBTR17",137,0)
 S (MILESRATE,RAY("MILES RATE"))=$P(MASLIN,"^",3)
"RTN","DGBTR17",138,0)
 S ALLOW=(MILESTRAV*MILESRATE)
"RTN","DGBTR17",139,0)
 S RAY("MILEAGE ALLOWANCE")=$$DLRAMT(ALLOW)
"RTN","DGBTR17",140,0)
 S GRAND("ALLOW")=GRAND("ALLOW")+ALLOW
"RTN","DGBTR17",141,0)
 S MEALS=$P(MILES,"^",4)
"RTN","DGBTR17",142,0)
 S RAY("MEALS LODGING")=$$DLRAMT(MEALS)
"RTN","DGBTR17",143,0)
 S GRAND("M&L")=GRAND("M&L")+MEALS
"RTN","DGBTR17",144,0)
 S FERRIES=$P(MILES,"^",5)
"RTN","DGBTR17",145,0)
 S RAY("FERRIES")=$$DLRAMT(FERRIES)
"RTN","DGBTR17",146,0)
 S GRAND("F&B")=GRAND("F&B")+FERRIES
"RTN","DGBTR17",147,0)
 S RAY("MILEAGE TOTAL")=$$DLRAMT(ALLOW+MEALS+FERRIES)
"RTN","DGBTR17",148,0)
 S GRAND("ALLOW TOT")=GRAND("ALLOW TOT")+ALLOW+MEALS+FERRIES
"RTN","DGBTR17",149,0)
 S ECON=$P(LINEZERO,"^",8)
"RTN","DGBTR17",150,0)
 S RAY("ECONOMICAL")=$$DLRAMT(ECON)
"RTN","DGBTR17",151,0)
 S GRAND("ECON")=GRAND("ECON")+ECON
"RTN","DGBTR17",152,0)
 S RAY("TRANS TOTAL")=$$DLRAMT(MEALS+ECON)
"RTN","DGBTR17",153,0)
 S GRAND("ECON TOT")=GRAND("ECON TOT")+MEALS+ECON
"RTN","DGBTR17",154,0)
 S RAY("PAYABLE")=$$DLRAMT($P(LINEZERO,U,10))
"RTN","DGBTR17",155,0)
 S GRAND("PAYABLE")=GRAND("PAYABLE")+$P(LINEZERO,U,10) S RAY("CLAIM DATE")=$$FMTE^XLFDT(I)
"RTN","DGBTR17",156,0)
 I DGBTEXCEL S RAY("CLAIM DATE")=$P(RAY("CLAIM DATE"),"@")
"RTN","DGBTR17",157,0)
 S RAY("PAYEE SIGNATURE")="" ; Future use
"RTN","DGBTR17",158,0)
 S RAY("VOUCHER DATE")=$$GET1^DIQ(392,I,13)
"RTN","DGBTR17",159,0)
 S RAY("CERT OFFICIAL")=$$GET1^DIQ(392,I,12)
"RTN","DGBTR17",160,0)
 S RAY("REMARKS")=$TR($G(^DGBT(392,I,"R")),"^","")
"RTN","DGBTR17",161,0)
 S ACCOUNT=$$GET1^DIQ(392,I,6,"I")
"RTN","DGBTR17",162,0)
 S RAY("ACCOUNT")=$$GET1^DIQ(392.3,ACCOUNT,2)
"RTN","DGBTR17",163,0)
 S RAY("COMMON CARRIER FEE")=$$DLRAMT(CCFEE)
"RTN","DGBTR17",164,0)
 S GRAND("CC FEE")=GRAND("CC FEE")+CCFEE
"RTN","DGBTR17",165,0)
 S RAY("ACC DED")=$$DLRAMT($P(LINEZERO,U,9))
"RTN","DGBTR17",166,0)
 D TOTMONTH Q:$D(ERR)
"RTN","DGBTR17",167,0)
 S RAY("ONE WAY")=TRIPS(1)
"RTN","DGBTR17",168,0)
 S RAY("ROUND TRIP")=TRIPS(2)
"RTN","DGBTR17",169,0)
 S RAY("DEDUCTIBLE")=$$DLRAMT(DED)
"RTN","DGBTR17",170,0)
 S GRAND("1W")=GRAND("1W")+TRIPS(1)
"RTN","DGBTR17",171,0)
 S GRAND("RT")=GRAND("RT")+TRIPS(2)
"RTN","DGBTR17",172,0)
 S GRAND("DED")=GRAND("DED")+DED
"RTN","DGBTR17",173,0)
 S WRTLIN=RAY("NAME")_"^"_RAY("PAT ADDR 1")_"^"_RAY("PAT ADDR 2")_"^"_RAY("PAT ADDR 3")_"^"_RAY("PAT CITY")_"^"_RAY("PAT STATE")_"^"_RAY("PAT ZIP")
"RTN","DGBTR17",174,0)
 S WRTLIN=WRTLIN_"^"_RAY("SOCIAL SECURITY")_"^"_RAY("FACILITY NAME")_"^"_RAY("FACILITY ADDR 1")_"^"_RAY("FACILITY ADDR 2")_"^"_RAY("FACILITY CITY")
"RTN","DGBTR17",175,0)
 S WRTLIN=WRTLIN_"^"_RAY("FACILITY STATE")_"^"_RAY("FACILITY ZIP")_"^"_RAY("FISCAL SYMBOL")_"^"_RAY("DEPARTURE 1")_"^"_RAY("DEPARTURE 2")
"RTN","DGBTR17",176,0)
 S WRTLIN=WRTLIN_"^"_RAY("DEPARTURE 3")_"^"_RAY("DEPARTURE CITY")_"^"_RAY("DEPARTURE STATE")_"^"_RAY("DEPARTURE ZIP")_"^"_RAY("DESTINATION 1")
"RTN","DGBTR17",177,0)
 S WRTLIN=WRTLIN_"^"_RAY("DESTINATION 2")_"^"_RAY("DESTINATION 3")_"^"_RAY("DESTINATION CITY")_"^"_RAY("DESTINATION STATE")_"^"_RAY("DESTINATION ZIP")
"RTN","DGBTR17",178,0)
 S WRTLIN=WRTLIN_"^"_RAY("MILES TRAVELED")_"^"_RAY("MILES RATE")_"^"_RAY("MILEAGE ALLOWANCE")_"^"_RAY("MEALS LODGING")_"^"_RAY("FERRIES")
"RTN","DGBTR17",179,0)
 S WRTLIN=WRTLIN_"^"_RAY("MILEAGE TOTAL")_"^"_RAY("ECONOMICAL")_"^"_RAY("TRANS TOTAL")_"^"_RAY("PAYABLE")_"^"_RAY("CLAIM DATE")_"^"_RAY("CERT OFFICIAL")
"RTN","DGBTR17",180,0)
 S WRTLIN=WRTLIN_"^^"_RAY("VOUCHER DATE")_"^"_RAY("REMARKS")_"^"_RAY("ACCOUNT")_"^"_RAY("COMMON CARRIER FEE")_"^"_RAY("ONE WAY")_"^"_RAY("ROUND TRIP")
"RTN","DGBTR17",181,0)
 S WRTLIN=WRTLIN_"^"_RAY("DEDUCTIBLE")_U_RAY("ACC DED")
"RTN","DGBTR17",182,0)
 S ^TMP("DGBTVRPT",$J,SQ1,SQ2)=WRTLIN
"RTN","DGBTR17",183,0)
 Q
"RTN","DGBTR17",184,0)
FAC(J) ;
"RTN","DGBTR17",185,0)
 I DGBTDIVN="ALL" Q 1
"RTN","DGBTR17",186,0)
 Q $$GET1^DIQ(392,J,11,"I")=DGBTDIVN
"RTN","DGBTR17",187,0)
MASLIN() ;
"RTN","DGBTR17",188,0)
 S MASRATE=""
"RTN","DGBTR17",189,0)
 I $D(^DG(43.1,"B",$P(I,"."))) S MASRATE=$O(^DG(43.1,$P(I,".","")))
"RTN","DGBTR17",190,0)
 E  S MASDATE=$O(^DG(43.1,"B",$P(I,".")),-1) I MASDATE'="" S MASRATE=$O(^DG(43.1,"B",MASDATE,""))
"RTN","DGBTR17",191,0)
 I MASRATE="" Q ""
"RTN","DGBTR17",192,0)
 Q $G(^DG(43.1,MASRATE,"BT"))
"RTN","DGBTR17",193,0)
TOTMONTH ;
"RTN","DGBTR17",194,0)
 N DTRAY
"RTN","DGBTR17",195,0)
 F II=0,1,2 S TRIPS(II)=0
"RTN","DGBTR17",196,0)
 S DED=0
"RTN","DGBTR17",197,0)
 S II=$O(^DGBT(392,"C",DFN,$E(I,1,5)_"00"),-1)
"RTN","DGBTR17",198,0)
 F  S II=$O(^DGBT(392,"C",DFN,II)) Q:II=""  Q:$P(II,".")'<$P(I,".")  D
"RTN","DGBTR17",199,0)
 .I '$$FAC(II) Q
"RTN","DGBTR17",200,0)
 .Q:$D(^DGBT(392,II,"C"))
"RTN","DGBTR17",201,0)
 .I $D(DTRAY($P(II,"."))) Q
"RTN","DGBTR17",202,0)
 .I $$GET1^DIQ(392,II,45.2,"I") Q  ;'=0 Q
"RTN","DGBTR17",203,0)
 .I $$GET1^DIQ(392.3,$$GET1^DIQ(392,II,6,"I"),2)'=829 Q
"RTN","DGBTR17",204,0)
 .S DTRAY($P(II,"."))=""
"RTN","DGBTR17",205,0)
 .S DED=DED+$$GET1^DIQ(392,II,9)
"RTN","DGBTR17",206,0)
 .S TRIPTYP=+$$GET1^DIQ(392,II,31,"I")
"RTN","DGBTR17",207,0)
 .S TRIPS(TRIPTYP)=TRIPS(TRIPTYP)+1
"RTN","DGBTR17",208,0)
 Q 
"RTN","DGBTR17",209,0)
INSTIT ;  check for pointer to institution file and for address information on institution
"RTN","DGBTR17",210,0)
 S DGBTDIV=$$GET1^DIQ(40.8,DGBTDIVN,.07,"I")
"RTN","DGBTR17",211,0)
 Q
"RTN","DGBTR17",212,0)
 ;
"RTN","DGBTR17",213,0)
PRT ;
"RTN","DGBTR17",214,0)
 S WRTLIN=^TMP("DGBTVRPT",$J,SQ1,SQ2)
"RTN","DGBTR17",215,0)
 I DGBTEXCEL D  Q
"RTN","DGBTR17",216,0)
 .W !,$P(WRTLIN,U),U,$P(WRTLIN,U,2),U,$P(WRTLIN,U,3),U,$P(WRTLIN,U,5),U,$P(WRTLIN,U,6),U,$P(WRTLIN,U,7),U,$P(WRTLIN,U,8),U,$P(WRTLIN,U,9),U
"RTN","DGBTR17",217,0)
 .W $P(WRTLIN,U,21),U,$P(WRTLIN,U,27),U,$P(WRTLIN,U,28),U,$P(WRTLIN,U,31),U,$P(WRTLIN,U,33),U,$P(WRTLIN,U,35),U,$P(WRTLIN,U,37),U
"RTN","DGBTR17",218,0)
 .W $P(WRTLIN,U,38),U,$P(WRTLIN,U,40),U,$P(WRTLIN,U,42),U,$P(WRTLIN,U,47),U,$P(WRTLIN,U,43),U,$P(WRTLIN,U,36)
"RTN","DGBTR17",219,0)
 I (($Y+11)>IOSL)&(FIRSTPAGE)&('DGBTEXCEL) D  Q:PROMPT[U
"RTN","DGBTR17",220,0)
 .I ($E(IOST,1)="C"),(IOSL'[99) D  Q:PROMPT[U
"RTN","DGBTR17",221,0)
 ..K DIR
"RTN","DGBTR17",222,0)
 ..S DIR("A")="PRESS RETURN TO CONTINUE OR '^' TO STOP....",DIR(0)="FAO" D ^DIR S PROMPT=Y K DIR
"RTN","DGBTR17",223,0)
 .D HDR
"RTN","DGBTR17",224,0)
 S FIRSTPAGE=1
"RTN","DGBTR17",225,0)
 W !,$P(WRTLIN,U),?32,$P(WRTLIN,U,8),?45,$P(WRTLIN,U,37),?67,$P(WRTLIN,U,40),?81,$P(WRTLIN,U,38),?118,$P(WRTLIN,U,42)
"RTN","DGBTR17",226,0)
 W !,?5,$P(WRTLIN,U,2)," ",$P(WRTLIN,U,3)," ",$P(WRTLIN,U,4)
"RTN","DGBTR17",227,0)
 W !,?5,$P(WRTLIN,U,5),?22,$P(WRTLIN,U,6),?26,$P(WRTLIN,U,7),?38,$P(WRTLIN,U,9)," ",$P(WRTLIN,U,10)
"RTN","DGBTR17",228,0)
 I $P(WRTLIN,U,11)'="" W !,?5,$P(WRTLIN,U,11)," ",$P(WRTLIN,U,12)," ",$P(WRTLIN,U,13)," ",$P(WRTLIN,U,14)," ",$P(WRTLIN,U,15)
"RTN","DGBTR17",229,0)
 I $P(WRTLIN,U,11)="" W !,?5,$P(WRTLIN,U,12)," ",$P(WRTLIN,U,13)," ",$P(WRTLIN,U,14)," ",$P(WRTLIN,U,15)
"RTN","DGBTR17",230,0)
 W !,?5,$P(WRTLIN,U,16)," ",$P(WRTLIN,U,17)," ",$P(WRTLIN,U,18)
"RTN","DGBTR17",231,0)
 W !,?5,$P(WRTLIN,U,19)," ",$P(WRTLIN,U,20)," ",$P(WRTLIN,U,21)
"RTN","DGBTR17",232,0)
 W !,?5,$P(WRTLIN,U,22)," ",$P(WRTLIN,U,23)," ",$P(WRTLIN,U,24)
"RTN","DGBTR17",233,0)
 W !,?5,$P(WRTLIN,U,25)," ",$P(WRTLIN,U,26)," ",$P(WRTLIN,U,27)
"RTN","DGBTR17",234,0)
 W !,?5,$P(WRTLIN,U,28),?11,$P(WRTLIN,U,29),?18,$P(WRTLIN,U,30),?30,$P(WRTLIN,U,31),?42,$P(WRTLIN,U,32),?54,$P(WRTLIN,U,33),?67,$P(WRTLIN,U,34)
"RTN","DGBTR17",235,0)
 W ?79,$P(WRTLIN,U,35),?90,$P(WRTLIN,U,36),?102,$P(WRTLIN,U,44),?106,$P(WRTLIN,U,45),?110,$P(WRTLIN,U,46),?121,$P(WRTLIN,U,43)
"RTN","DGBTR17",236,0)
 W !,?5,$P(WRTLIN,U,41),?87,$P(WRTLIN,U,15)
"RTN","DGBTR17",237,0)
 Q
"RTN","DGBTR17",238,0)
HDR ;
"RTN","DGBTR17",239,0)
 S PAGE=PAGE+1
"RTN","DGBTR17",240,0)
 W @IOF
"RTN","DGBTR17",241,0)
 W "BT ELECTRONIC VOUCHER REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR17",242,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR17",243,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:DGBTDIVI)
"RTN","DGBTR17",244,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR17",245,0)
 W !,"NAME",?32,"SSN",?45,"CLAIM DATE",?67,"ENTRY DATE",?81,"CLERK",?118,"ACCT"
"RTN","DGBTR17",246,0)
 W !,?5,"ADDRESS"
"RTN","DGBTR17",247,0)
 W !?5,"CITY",?22,"ST",?26,"ZIP",?38,"FACILITY"
"RTN","DGBTR17",248,0)
 W !,?5,"FACILITY ADDRESS"
"RTN","DGBTR17",249,0)
 W !,?5,"DEPARTURE"
"RTN","DGBTR17",250,0)
 W !,?5,"DEPARTURE"
"RTN","DGBTR17",251,0)
 W !,?5,"DESTINATION"
"RTN","DGBTR17",252,0)
 W !,?5,"DESTINATION"
"RTN","DGBTR17",253,0)
 W !,?5,"MILES",?11,"RATE",?18,"ALLOW",?30,"M&L",?42,"F&B",?54,"TOTAL",?67,"ECON",?79,"TOTAL",?90,"PAYABLE",?102,"1W",?106,"RT",?110,"DED",?121,"CC FEE"
"RTN","DGBTR17",254,0)
 W !,?5,"REMARKS",?87,"FISCAL SYMBOLS"
"RTN","DGBTR17",255,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR17",256,0)
 Q
"RTN","DGBTR17",257,0)
GTOT ;
"RTN","DGBTR17",258,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR17",259,0)
 W !,"GRAND TOTALS"
"RTN","DGBTR17",260,0)
 W !,"MILES",?7,"CLMS",?14,"ALLOW",?26,"M&L",?38,"F&B",?50,"TOTAL",?63,"ECON",?75,"TOTAL",?86,"PAYABLE",?98,"1W",?102,"RT",?106,"DED",?117,"CC FEE"
"RTN","DGBTR17",261,0)
 W !,GRAND("MILES"),?7,GRAND("CLAIMS"),?14,$$DLRAMT(GRAND("ALLOW")),?26,$$DLRAMT(GRAND("M&L")),?38,$$DLRAMT(GRAND("F&B")),?50,$$DLRAMT(GRAND("ALLOW TOT"))
"RTN","DGBTR17",262,0)
 W ?63,$$DLRAMT(GRAND("ECON")),?75,$$DLRAMT(GRAND("ECON TOT")),?86,$$DLRAMT(GRAND("PAYABLE")),?98,GRAND("1W"),?102,GRAND("RT")
"RTN","DGBTR17",263,0)
 W ?106,$$DLRAMT(GRAND("DED")),?117,$$DLRAMT(GRAND("CC FEE"))
"RTN","DGBTR17",264,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR17",265,0)
 Q
"RTN","DGBTR17",266,0)
DLRAMT(X) ;
"RTN","DGBTR17",267,0)
 D COMMA^%DTC I 'DGBTEXCEL Q $TR(X," ","")
"RTN","DGBTR17",268,0)
 Q $TR(X," ,$","")
"RTN","DGBTR3A")
0^37^B18478741
"RTN","DGBTR3A",1,0)
DGBTR3A ;ALB/RFE - CLERK REPORT; 07/10/12
"RTN","DGBTR3A",2,0)
 ;;1.0;Beneficiary Travel;**20**;November 11, 2011;Build 185
"RTN","DGBTR3A",3,0)
 Q
"RTN","DGBTR3A",4,0)
 ;/*Called from DGBTR123*/
"RTN","DGBTR3A",5,0)
HDRMF ;
"RTN","DGBTR3A",6,0)
 S PAGE=PAGE+1
"RTN","DGBTR3A",7,0)
 W @IOF
"RTN","DGBTR3A",8,0)
 W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR3A",9,0)
 W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR3A",10,0)
 W !,"VERSION: FULL"
"RTN","DGBTR3A",11,0)
 W !,"TYPE: MILEAGE"
"RTN","DGBTR3A",12,0)
 W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR3A",13,0)
 W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR3A",14,0)
 W !,$E(EQUAL,1,130)
"RTN","DGBTR3A",15,0)
 W !,"PATIENT NAME",?32,"SSN",?43,"CLERK",?78,"CL DT",?92,"ENT DT",?109,"ACCT"
"RTN","DGBTR3A",16,0)
 W !,?5,"DIVISION",?42,"R/O",?48,"MILEAGE",?56,"CC MODE",?94,"CC FEE",?109,"ECON",?121,"M&L"
"RTN","DGBTR3A",17,0)
 W !,?5,"F&B",?17,"DED",?25,"PAYABLE",?38,"REMARKS"
"RTN","DGBTR3A",18,0)
 W !,$E(EQUAL,1,130)
"RTN","DGBTR3A",19,0)
 Q
"RTN","DGBTR3A",20,0)
GRANDMF ;
"RTN","DGBTR3A",21,0)
 I ($Y+8)>IOSL D
"RTN","DGBTR3A",22,0)
 .S PAGE=PAGE+1
"RTN","DGBTR3A",23,0)
 .W @IOF
"RTN","DGBTR3A",24,0)
 .W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR3A",25,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR3A",26,0)
 .W !,"VERSION: FULL"
"RTN","DGBTR3A",27,0)
 .W !,"TYPE: MILEAGE"
"RTN","DGBTR3A",28,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR3A",29,0)
 .W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR3A",30,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR3A",31,0)
 W !,"GRAND TOTALS:",?15,"CLAIMS",?48,"MILEAGE",?94,"CC FEE",?109,"ECON",?121,"M&L"
"RTN","DGBTR3A",32,0)
 W !,?5,"F&B",?17,"DED",?25,"PAYABLE"
"RTN","DGBTR3A",33,0)
 W !?15,GRAND("CLAIMS"),?48,GRAND("TOT MILE"),?94,$$DLRAMT(GRAND("CC FEE")),?109,$$DLRAMT(GRAND("ECON")),?121,$$DLRAMT(GRAND("M&L"))
"RTN","DGBTR3A",34,0)
 W !,?5,$$DLRAMT(GRAND("F&B")),?17,$$DLRAMT(GRAND("DED")),?25,$$DLRAMT(GRAND("PAY"))
"RTN","DGBTR3A",35,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR3A",36,0)
 Q
"RTN","DGBTR3A",37,0)
GRANDMT ;
"RTN","DGBTR3A",38,0)
 I ($Y+7)>IOSL D
"RTN","DGBTR3A",39,0)
 .S PAGE=PAGE+1
"RTN","DGBTR3A",40,0)
 .W @IOF
"RTN","DGBTR3A",41,0)
 .W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR3A",42,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR3A",43,0)
 .W !,"VERSION: TOTAL"
"RTN","DGBTR3A",44,0)
 .W !,"TYPE: MILEAGE"
"RTN","DGBTR3A",45,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR3A",46,0)
 .W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR3A",47,0)
 W !,$E(EQUAL,1,117)
"RTN","DGBTR3A",48,0)
 W !,"GRAND TOTALS:",?55,"MILEAGE",?63,"CC FEE",?78,"MOST ECON",?90,"M&L",?103,"F&B"
"RTN","DGBTR3A",49,0)
 W !,?5,"DED",?18,"PAYABLE"
"RTN","DGBTR3A",50,0)
 W !,?55,GRAND("MILE"),?63,$$DLRAMT(GRAND("CC FEE")),?78,$$DLRAMT(GRAND("ECON")),?90,$$DLRAMT(GRAND("M&L")),?103,$$DLRAMT(GRAND("F&B"))
"RTN","DGBTR3A",51,0)
 W !?5,$$DLRAMT(GRAND("DED")),?18,$$DLRAMT(GRAND("PAY"))
"RTN","DGBTR3A",52,0)
 W !,$E(EQUAL,1,117)
"RTN","DGBTR3A",53,0)
 Q
"RTN","DGBTR3A",54,0)
GRANDSF ;
"RTN","DGBTR3A",55,0)
 I ($Y+5)>IOSL D
"RTN","DGBTR3A",56,0)
 .S PAGE=PAGE+1
"RTN","DGBTR3A",57,0)
 .W @IOF
"RTN","DGBTR3A",58,0)
 .W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR3A",59,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR3A",60,0)
 .W !,"VERSION: FULL"
"RTN","DGBTR3A",61,0)
 .W !,"TYPE: SPECIAL MODE"
"RTN","DGBTR3A",62,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR3A",63,0)
 .W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR3A",64,0)
 W !,$E(EQUAL,1,124)
"RTN","DGBTR3A",65,0)
 W !,"GRAND TOTALS: ",?15,"CLAIMS",?42,"MILEAGE",?50,"BASE RATE",?64,"NSNL",?79,"WAIT TIME",?90,"EX CREW",?102,"SPEC EQ",?116,"INV AMT"
"RTN","DGBTR3A",66,0)
 W !,?15,GRAND("CLAIMS"),?42,GRAND("MILE"),?50,$$DLRAMT(GRAND("BASE RATE")),?65,$$DLRAMT(GRAND("NSNL")),?79,$$DLRAMT(GRAND("WAIT TIME"))
"RTN","DGBTR3A",67,0)
 W ?90,$$DLRAMT(GRAND("EXTRA CREW")),?102,$$DLRAMT(GRAND("SPECIAL EQUIPMENT")),?115,$$DLRAMT(GRAND("INVOICE AMT"))
"RTN","DGBTR3A",68,0)
 W !,$E(EQUAL,1,124)
"RTN","DGBTR3A",69,0)
 Q
"RTN","DGBTR3A",70,0)
GRANDST ;
"RTN","DGBTR3A",71,0)
 I ($Y+7)>IOSL D
"RTN","DGBTR3A",72,0)
 .S PAGE=PAGE+1
"RTN","DGBTR3A",73,0)
 .W @IOF
"RTN","DGBTR3A",74,0)
 .W "BT CLERK REPORT      PRINT DATE: ",PDT,?(126-$L(PAGE)),"PAGE ",PAGE
"RTN","DGBTR3A",75,0)
 .W !,$$FMTE^XLFDT(STARTDT)," TO ",$$FMTE^XLFDT(ENDDT)
"RTN","DGBTR3A",76,0)
 .W !,"VERSION: TOTAL"
"RTN","DGBTR3A",77,0)
 .W !,"TYPE: SPECIAL MODE"
"RTN","DGBTR3A",78,0)
 .W !,"DIVISION: ",$S(DGBTDIVN="ALL":"ALL",1:$$GET1^DIQ(40.8,DGBTDIVN,.01))
"RTN","DGBTR3A",79,0)
 .W !,"CLERK: ",$S(CLERKALL:"ALL",1:CLERKNAME)
"RTN","DGBTR3A",80,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR3A",81,0)
 W !,"GRAND TOTALS:",?55,"MILEAGE",?63,"CLAIMS",?72,"BASE RATE",?87,"NSNL",?102,"WAIT TIME",?117,"EXTRA CREW"
"RTN","DGBTR3A",82,0)
 W !,?5,"SPEC EQ",?15,"INV AMT"
"RTN","DGBTR3A",83,0)
 W !,?55,GRAND("MILE"),?63,GRAND("CLAIMS"),?72,$$DLRAMT(GRAND("BASE RATE")),?87,$$DLRAMT(GRAND("NSNL")),?102,$$DLRAMT(GRAND("WAIT TIME"))
"RTN","DGBTR3A",84,0)
 W ?117,$$DLRAMT(GRAND("EXTRA CREW")),!,?5,$$DLRAMT(GRAND("SPECIAL EQUIPMENT")),?15,$$DLRAMT(GRAND("INVOICE AMT"))
"RTN","DGBTR3A",85,0)
 W !,$E(EQUAL,1,127)
"RTN","DGBTR3A",86,0)
 Q
"RTN","DGBTR3A",87,0)
DLRAMT(X) ;
"RTN","DGBTR3A",88,0)
 D COMMA^%DTC I 'DGBTEXC Q $TR(X," ","")
"RTN","DGBTR3A",89,0)
 Q $TR(X," ,$","")
"RTN","DGBTRDV")
0^34^B21663244
"RTN","DGBTRDV",1,0)
DGBTRDV ;ALB/BLD - Beneficiary Travel information VIA RDV; 11/20/92@1000; 06/01/12
"RTN","DGBTRDV",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTRDV",3,0)
 ;
"RTN","DGBTRDV",4,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DGBTRDV",5,0)
 ;
"RTN","DGBTRDV",6,0)
 ; This routine is used to exchange insurance information between
"RTN","DGBTRDV",7,0)
 ; facilities.
"RTN","DGBTRDV",8,0)
 ;
"RTN","DGBTRDV",9,0)
 ;COPIED FROM IBCNRDV **************
"RTN","DGBTRDV",10,0)
 ;
"RTN","DGBTRDV",11,0)
 Q
"RTN","DGBTRDV",12,0)
 ;
"RTN","DGBTRDV",13,0)
OPT(DFN,DGBTDTI) ; Menu option entry point.
"RTN","DGBTRDV",14,0)
 ; information about from the remote treating facilities.
"RTN","DGBTRDV",15,0)
 N DIC,X,Y,DTOUT,DUOUT,%,%Y,DGBTIEN,VADM,DGBTIBB,DGBTD,DGBTIBI,DGBTICN,DGBTIBRZ,DGBTDGBTIBY,DGBTZ,DGBTWAIT,DGBTIBI
"RTN","DGBTRDV",16,0)
 N DO,DGBTYPE,DGBTIB1,DGBTRPC,DGBTR,RET,DGBTHDL
"RTN","DGBTRDV",17,0)
 ;
"RTN","DGBTRDV",18,0)
 K ^TMP("DGBTRDV"),^TMP("BARRY")
"RTN","DGBTRDV",19,0)
 ;
"RTN","DGBTRDV",20,0)
 S (RDVMSG,DGBTYPE)=0             ;this tell's the system not to run in back ground. it has to be a foreground job
"RTN","DGBTRDV",21,0)
 ; prompt for patient
"RTN","DGBTRDV",22,0)
 ;
"RTN","DGBTRDV",23,0)
BACKGND ; background/tasked entry point
"RTN","DGBTRDV",24,0)
 ; DGBTYPE is being used as a flag to indicate this is running in background
"RTN","DGBTRDV",25,0)
 ; DGBTRDV is array of treating facilities
"RTN","DGBTRDV",26,0)
 ; look up treating facilities
"RTN","DGBTRDV",27,0)
 K DGBTRDV S DGBTRDV=$$TFL(DFN,.DGBTRDV)
"RTN","DGBTRDV",28,0)
 I DGBTRDV<1,$D(DGBTYPE) S RDVMSG=1 W !!,"This patient has no remote treating facilities to query." Q
"RTN","DGBTRDV",29,0)
 I DGBTRDV<1 Q
"RTN","DGBTRDV",30,0)
 ;
"RTN","DGBTRDV",31,0)
 ; get ICN
"RTN","DGBTRDV",32,0)
 ; DGBTICN - is the patients ICN
"RTN","DGBTRDV",33,0)
 S DGBTICN=$$ICN(DFN) I 'DGBTICN,'$D(DGBTYPE) S RDVMSG=1 W !!,"No ICN for this patient" Q
"RTN","DGBTRDV",34,0)
 I 'DGBTICN Q
"RTN","DGBTRDV",35,0)
 ;
"RTN","DGBTRDV",36,0)
 ; sent off the remote queries and get back handles
"RTN","DGBTRDV",37,0)
 ; DGBTRPC is name of RPC in file 8994
"RTN","DGBTRDV",38,0)
 ; DGBTIEN is IEN of the treating facilities array
"RTN","DGBTRDV",39,0)
 ; DGBTRET - the array that contains the return data
"RTN","DGBTRDV",40,0)
 ;
"RTN","DGBTRDV",41,0)
 S DGBTRPC="DGBT CLAIM DEDUCTIBLE PAID"
"RTN","DGBTRDV",42,0)
 S DGBTIEN=0 F  S DGBTIEN=$O(DGBTRDV(DGBTIEN)) Q:DGBTIEN<1  D
"RTN","DGBTRDV",43,0)
 .D SEND(.DGBTRET,DGBTIEN,DGBTICN,DGBTRPC,DGBTDTI)
"RTN","DGBTRDV",44,0)
 .X $S(DGBTRET(0)'="":"S $P(DGBTRDV(DGBTIEN),U,5)=DGBTRET(0)",1:"W:'$D(DGBTYPE) !,""No handle returned for "",$P(DGBTRDV(DGBTIEN),U,2) K DGBTRDV(DGBTIEN)")
"RTN","DGBTRDV",45,0)
 ;
"RTN","DGBTRDV",46,0)
 ; no handles returned
"RTN","DGBTRDV",47,0)
 I $D(DGBTRDV)<9,$D(DGBTYPE) S RDVMSG=1 W !!,"Unable to perform any remote queries.",! Q
"RTN","DGBTRDV",48,0)
 I $D(DGBTRDV)<9 Q
"RTN","DGBTRDV",49,0)
 ;
"RTN","DGBTRDV",50,0)
 ; go through every DGBTRDV()
"RTN","DGBTRDV",51,0)
 S DGBTIBRZ="|",DGBTIEN=0
"RTN","DGBTRDV",52,0)
 F  S DGBTIEN=$O(DGBTRDV(DGBTIEN)) Q:DGBTIEN<1!($D(DGBTRDV)<9)  D
"RTN","DGBTRDV",53,0)
 .;
"RTN","DGBTRDV",54,0)
 .; do I have a return data.
"RTN","DGBTRDV",55,0)
 .F DGBTWAIT=1:1:30 W:$D(DGBTYPE) "." H 1 D CHECK(.DGBTR,$P(DGBTRDV(DGBTIEN),"^",5)) I $G(DGBTR(0))["Done" Q
"RTN","DGBTRDV",56,0)
 .I $G(DGBTR(0))'["Done" S:$D(DGBTYPE) RDVMSG=1 W:$D(DGBTYPE) !!,"Unable to communicate with ",$P(DGBTRDV(DGBTIEN),U,2) Q
"RTN","DGBTRDV",57,0)
 .D RETURN(.DGBTR,$P(DGBTRDV(DGBTIEN),"^",5))
"RTN","DGBTRDV",58,0)
 .;
"RTN","DGBTRDV",59,0)
 .; no data returned or error message
"RTN","DGBTRDV",60,0)
 .S DGBTIBRZ=$S(-1=+$G(DGBTR):DGBTR,$G(DGBTR(0))="":$G(DGBTR(1)),1:$G(DGBTR(0)))
"RTN","DGBTRDV",61,0)
 .;
"RTN","DGBTRDV",62,0)
 .; no info to proceed
"RTN","DGBTRDV",63,0)
 .I DGBTIBRZ<1 S RDVMSG=1 W:'$D(DGBTYPE) !,"Response from ",$P(DGBTRDV(DGBTX),U,2),!,$P(DGBTIBRZ,"^",2) K DGBTRDV(DGBTIEN) Q
"RTN","DGBTRDV",64,0)
 .I DGBTIBRZ<1 K DGBTRDV(DGBTIEN) Q
"RTN","DGBTRDV",65,0)
 .;
"RTN","DGBTRDV",66,0)
 ;
"RTN","DGBTRDV",67,0)
 Q
"RTN","DGBTRDV",68,0)
 ;
"RTN","DGBTRDV",69,0)
RPC(DGBTRET,DGBTICN,DGBTDTI) ; RPC entry for Beneficiary Travel Claims for a given month
"RTN","DGBTRDV",70,0)
 N DFN
"RTN","DGBTRDV",71,0)
 S ^TMP("FROM CHEY246",$H)=""
"RTN","DGBTRDV",72,0)
 S DFN=$$DFN(DGBTICN) I 'DFN S DGBTRET="-1^ICN Not found" Q
"RTN","DGBTRDV",73,0)
 S DGBTRET(0)=$$WAIV^DGBTRDVW(DFN,DGBTDTI)
"RTN","DGBTRDV",74,0)
 I $G(DGBTRET(0))="" S DGBTRDV="-1^No BT Claims on File" Q
"RTN","DGBTRDV",75,0)
 ; set up return format
"RTN","DGBTRDV",76,0)
 ;
"RTN","DGBTRDV",77,0)
 Q
"RTN","DGBTRDV",78,0)
 ;
"RTN","DGBTRDV",79,0)
SEND(DGBTRET,DGBTIEN,DGBTICN,DGBTRPC,DGBTDTI) ; called to send off queries
"RTN","DGBTRDV",80,0)
 D EN1^XWB2HL7(.DGBTRET,DGBTIEN,DGBTRPC,"",DGBTICN,DGBTDTI)
"RTN","DGBTRDV",81,0)
 Q
"RTN","DGBTRDV",82,0)
 ;
"RTN","DGBTRDV",83,0)
CHECK(DGBTRET,DGBTHDL) ; called to check the return status of an RPC
"RTN","DGBTRDV",84,0)
 D RPCCHK^XWB2HL7(.DGBTRET,DGBTHDL)
"RTN","DGBTRDV",85,0)
 Q
"RTN","DGBTRDV",86,0)
 ;
"RTN","DGBTRDV",87,0)
RETURN(DGBTRTN,DGBTHDL) ; called to get the return data and clear the broker
"RTN","DGBTRDV",88,0)
 N I,DGBTZ
"RTN","DGBTRDV",89,0)
 D RTNDATA^XWBDRPC(.DGBTRET,DGBTHDL),CLEAR^XWBDRPC(.DGBTZ,DGBTHDL)
"RTN","DGBTRDV",90,0)
 F I=1:1:$L(DGBTRET(0),"^") S $P(RETURN,"^",I)=$P(RETURN,"^",I)+$P(DGBTRET(0),"^",I)
"RTN","DGBTRDV",91,0)
 Q
"RTN","DGBTRDV",92,0)
 ;
"RTN","DGBTRDV",93,0)
 ;****************************************************************************
"RTN","DGBTRDV",94,0)
 ;***** the following tags are from DGBTRDV1 ***********
"RTN","DGBTRDV",95,0)
 ;
"RTN","DGBTRDV",96,0)
TFL(DFN,DGBTIBT) ; returns treating facility list (pass IBT by reference)
"RTN","DGBTRDV",97,0)
 ; supported references ia #2990 and #10112, value returned is count
"RTN","DGBTRDV",98,0)
 ; needed to N Y because VAFCTFU1 will kill it
"RTN","DGBTRDV",99,0)
 N DGBTIBC,DGBTIBZ,DGBTIBS,DGBTIBFT
"RTN","DGBTRDV",100,0)
 ;
"RTN","DGBTRDV",101,0)
 D TFL^VAFCTFU1(.DGBTIBZ,DFN) Q:-$G(DGBTIBZ(1))=1 0
"RTN","DGBTRDV",102,0)
 S DGBTIBS=+$P($$SITE,"^",3),(DGBTIBZ,DGBTIBC)=0
"RTN","DGBTRDV",103,0)
 ; Return only remote facilities of certain types:
"RTN","DGBTRDV",104,0)
 F  S DGBTIBZ=$O(DGBTIBZ(DGBTIBZ)) Q:DGBTIBZ<1  D
"RTN","DGBTRDV",105,0)
 .I $P(DGBTIBZ(DGBTIBZ),"^",3)="" Q
"RTN","DGBTRDV",106,0)
 .I $E($P(DGBTIBZ(DGBTIBZ),"^",3),1,5)'=$E(DGBTDT,1,5) Q
"RTN","DGBTRDV",107,0)
 .I +DGBTIBZ(DGBTIBZ)>0,+DGBTIBZ(DGBTIBZ)'=DGBTIBS S DGBTIBT(+DGBTIBZ(DGBTIBZ))=DGBTIBZ(DGBTIBZ),DGBTIBC=DGBTIBC+1
"RTN","DGBTRDV",108,0)
 Q DGBTIBC
"RTN","DGBTRDV",109,0)
 ;
"RTN","DGBTRDV",110,0)
SITE() ; returns site number and info
"RTN","DGBTRDV",111,0)
 Q $$SITE^VASITE
"RTN","DGBTRDV",112,0)
 ;
"RTN","DGBTRDV",113,0)
 ;
"RTN","DGBTRDV",114,0)
ICN(DFN) ; returns icn for dfn ia #2701 and #2702
"RTN","DGBTRDV",115,0)
 N DGBTIBICN
"RTN","DGBTRDV",116,0)
 I '$L($T(GETICN^MPIF001)) Q 0 ; mpi not installed
"RTN","DGBTRDV",117,0)
 S DGBTIBICN=$$MPINODE^MPIFAPI(+DFN) Q:$P(DGBTIBICN,"^",4) 0 ; local icn
"RTN","DGBTRDV",118,0)
 S DGBTIBICN=$$GETICN^MPIF001(+DFN)
"RTN","DGBTRDV",119,0)
 Q $S(DGBTIBICN>0:DGBTIBICN,1:0)
"RTN","DGBTRDV",120,0)
 ;
"RTN","DGBTRDV",121,0)
DFN(DGBTIBICN) ; returns dfn for icn ia #2701
"RTN","DGBTRDV",122,0)
 N DFN ; check to see if mpi software installed
"RTN","DGBTRDV",123,0)
 S DFN=$S($L($T(GETDFN^MPIF001)):+$$GETDFN^MPIF001(+DGBTIBICN),1:0)
"RTN","DGBTRDV",124,0)
 Q $S(DFN>0:DFN,1:0)
"RTN","DGBTRDV",125,0)
 ;
"RTN","DGBTRDVW")
0^36^B8811174
"RTN","DGBTRDVW",1,0)
DGBTRDVW ;ALB/RFE - BENEFICIARY/TRAVEL UTILITY ROUTINES; 07/03/12
"RTN","DGBTRDVW",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTRDVW",3,0)
 Q
"RTN","DGBTRDVW",4,0)
WAIV(DFN,DGBTDTI) ;
"RTN","DGBTRDVW",5,0)
 N %H,DED,I,TRIP,TRIPCT,RETURN,DGBTDW,EXPDT,FUTURE,FDED,WAIVER
"RTN","DGBTRDVW",6,0)
 ;Return values: total number of trips ^ number of one way trips ^ number of round trips ^ deductible (all this for the month)^ waiver y/n (y will be 1, n will be no) ^ type of wavier i.e MAN for manual, PENSION etc. ^
"RTN","DGBTRDVW",7,0)
 ;total number of trips as of this claim date ^ deductible as of this claim date
"RTN","DGBTRDVW",8,0)
 S TRIP=$$TRIP
"RTN","DGBTRDVW",9,0)
 S WAIVER=$$WAIVYN
"RTN","DGBTRDVW",10,0)
 S RETURN=TRIP_WAIVER_U_(TRIPCT-FUTURE)_U_(DED-FDED)
"RTN","DGBTRDVW",11,0)
 Q RETURN
"RTN","DGBTRDVW",12,0)
 ;
"RTN","DGBTRDVW",13,0)
TRIP() ;
"RTN","DGBTRDVW",14,0)
 N DTRAY,I,TRIPS,TRIPTYP,MONTH,DGBTDT,ACCTYPE,DGBTEND
"RTN","DGBTRDVW",15,0)
 S (DED,TRIPCT,FUTURE,FDED)=0
"RTN","DGBTRDVW",16,0)
 F I=0:1:2 S TRIPS(I)=0
"RTN","DGBTRDVW",17,0)
 S DGBTEND=$E(DGBTDTI,1,5)+1_"00"
"RTN","DGBTRDVW",18,0)
 S (MONTH,DGBTDT)=$E(DGBTDTI,1,5)_"00"
"RTN","DGBTRDVW",19,0)
 ;F  S DGBTDT=$O(^DGBT(392,"C",DFN,DGBTDT)) Q:DGBTDT=""!(DGBTDT>DGBTDTI)  D
"RTN","DGBTRDVW",20,0)
 F  S DGBTDT=$O(^DGBT(392,"C",DFN,DGBTDT)) Q:DGBTDT=""!(DGBTDT'<DGBTEND)  D
"RTN","DGBTRDVW",21,0)
 .I (DGBTDT=DGBTDTI)&($G(CHZFLG)=0) Q
"RTN","DGBTRDVW",22,0)
 .Q:$$GET1^DIQ(392,DGBTDT,56,"I")="S"
"RTN","DGBTRDVW",23,0)
 .I $$GET1^DIQ(392,DGBTDT,45.2,"I")=1 Q
"RTN","DGBTRDVW",24,0)
 .I $D(DTRAY($P(DGBTDT,"."))) Q
"RTN","DGBTRDVW",25,0)
 .S ACCTYPE=$$GET1^DIQ(392.3,$$GET1^DIQ(392,DGBTDT,6,"I"),5,"I")
"RTN","DGBTRDVW",26,0)
 .I ACCTYPE="" Q
"RTN","DGBTRDVW",27,0)
 .I 45'[ACCTYPE Q
"RTN","DGBTRDVW",28,0)
 .S DTRAY($P(DGBTDT,"."))=""
"RTN","DGBTRDVW",29,0)
 .S DED=DED+$$GET1^DIQ(392,DGBTDT,9)
"RTN","DGBTRDVW",30,0)
 .S TRIPTYP=+$$GET1^DIQ(392,DGBTDT,31,"I")
"RTN","DGBTRDVW",31,0)
 .S TRIPS(TRIPTYP)=TRIPS(TRIPTYP)+1
"RTN","DGBTRDVW",32,0)
 .S TRIPCT=TRIPCT+TRIPTYP
"RTN","DGBTRDVW",33,0)
 .I ($G(CHZFLG))&($P(DGBTDT,".")=$P(DGBTDTI,".")) S FUTURE=FUTURE+TRIPTYP,FDED=FDED+$$GET1^DIQ(392,DGBTDT,9,"I")
"RTN","DGBTRDVW",34,0)
 Q TRIPCT_U_TRIPS(1)_U_TRIPS(2)_U_DED_U
"RTN","DGBTRDVW",35,0)
WAIVYN() ;
"RTN","DGBTRDVW",36,0)
 I DED'<18 Q "1^DED^"
"RTN","DGBTRDVW",37,0)
 I TRIPCT>6 Q "1^TRIPS^"
"RTN","DGBTRDVW",38,0)
 I '$D(DGBTINCA) N DGBTINCA,DGBTERR D GA^DGBTUTL(DFN,"DGBTINCA",DGBTDTI)
"RTN","DGBTRDVW",39,0)
 I DGBTINCA Q "1^ALTINC^"
"RTN","DGBTRDVW",40,0)
 I $$MANRQ Q "1^MAN^"_EXPDT
"RTN","DGBTRDVW",41,0)
 I '$D(VAEL) N VAEL,VAERR D ELIG^VADPT
"RTN","DGBTRDVW",42,0)
 I $$PENSION Q "1^PENSION^"
"RTN","DGBTRDVW",43,0)
 ;I '$D(DGBTDEP) N DGBTDEP S DGBTDEP=$$DEP^VAFMON(DFN,DGBTDTI)
"RTN","DGBTRDVW",44,0)
 ;I '$D(DGBTNSC) N DGBTNSC S DGBTNSC=$$NSC^DGBTUTL
"RTN","DGBTRDVW",45,0)
 ;I '$D(DGBTINC) N DGBTINC S DGBTINC=$$INCOME^VAFMON(DFN,DGBTDTI,1)
"RTN","DGBTRDVW",46,0)
 ;I '$D(DGBTMTTH) N DGBTMTTH S DGBTMTTH=$$MTTH^DGBTMTTH(DGBTDEP,DGBTDTI)
"RTN","DGBTRDVW",47,0)
 ;I (DGBTNSC)&(+$TR($P(DGBTINC,U),"$,","")<DGBTRXTH) Q "1^NSC^"
"RTN","DGBTRDVW",48,0)
 ;I '(DGBTNSC)&(+$G(VAEL(3)))&(+$TR($P(DGBTINC,U),"$,","")<DGBTMTTH) Q "1^LI^"
"RTN","DGBTRDVW",49,0)
 ;I '(DGBTNSC),+$$LI^DGBTUTL(DFN,DGBTDTI,DGBTDEP,,DGBTINCA)'=0 Q "1^LI^"
"RTN","DGBTRDVW",50,0)
 Q 0_"^^"
"RTN","DGBTRDVW",51,0)
MANRQ() ; Manual waiver request
"RTN","DGBTRDVW",52,0)
 I '$D(^DGBT(392.7,"C",DFN)) Q 0_"^"
"RTN","DGBTRDVW",53,0)
 N STDT
"RTN","DGBTRDVW",54,0)
 S (DGBTDW,I)=""
"RTN","DGBTRDVW",55,0)
 F  S I=$O(^DGBT(392.7,"C",DFN,I),-1) Q:I=""  D  Q:DGBTDW'=""
"RTN","DGBTRDVW",56,0)
 .I $$GET1^DIQ(392.7,I,97,"I") Q
"RTN","DGBTRDVW",57,0)
 .S STDT=$$GET1^DIQ(392.7,I,.01,"I")
"RTN","DGBTRDVW",58,0)
 .I STDT>DGBTDTI S DGBTDW=0 Q
"RTN","DGBTRDVW",59,0)
 .S EXPDT=$$GET1^DIQ(392.7,I,8,"I")
"RTN","DGBTRDVW",60,0)
 .I EXPDT="PENSION" S DGBTDW=1 Q
"RTN","DGBTRDVW",61,0)
 .I $E(I,1,3)=$E(DGBTDTI,1,3) S DGBTDW=^DGBT(392.7,I,0) Q
"RTN","DGBTRDVW",62,0)
 .I $E(I,1,3)'=($E(DGBTA,1,3)-1) Q
"RTN","DGBTRDVW",63,0)
 .I $$GET1^DIQ(392.7,I,8,"I")<$P(DGBTDTI,".") Q
"RTN","DGBTRDVW",64,0)
 .S DGBTDW=^DGBT(392.7,I,0)
"RTN","DGBTRDVW",65,0)
 I DGBTDW="" Q 0
"RTN","DGBTRDVW",66,0)
 I $$GET1^DIQ(392.7,I,3)="NO" Q 0
"RTN","DGBTRDVW",67,0)
 I $G(EXPDT)="PENSION" Q 1
"RTN","DGBTRDVW",68,0)
 I $P(DGBTDTI,".")<$P($P(DGBTDW,U),".") Q 0
"RTN","DGBTRDVW",69,0)
 I $G(EXPDT)?7N S EXPDT=$$DTFORM^DGBT1(EXPDT)
"RTN","DGBTRDVW",70,0)
 Q DGBTDW
"RTN","DGBTRDVW",71,0)
PENSION() ;
"RTN","DGBTRDVW",72,0)
 I '$D(VAEL) N VAEL,VAERR D ELIG^VADPT
"RTN","DGBTRDVW",73,0)
 I VAEL(1)["PENSION" Q 1
"RTN","DGBTRDVW",74,0)
 I $P(VAEL(1),"^",2)="AID & ATTENDANCE" Q 1
"RTN","DGBTRDVW",75,0)
 I $P(VAEL(1),"^",2)="HOUSEBOUND" Q 1
"RTN","DGBTRDVW",76,0)
 N HIT
"RTN","DGBTRDVW",77,0)
 S (HIT,I)=""
"RTN","DGBTRDVW",78,0)
 F  S I=$O(VAEL(1,I)) Q:I=""  D  Q:HIT
"RTN","DGBTRDVW",79,0)
 .I VAEL(1,I)["PENSION" S HIT=1 Q
"RTN","DGBTRDVW",80,0)
 .I $P(VAEL(1,I),"^",2)="AID & ATTENDANCE" S HIT=1 Q
"RTN","DGBTRDVW",81,0)
 .I $P(VAEL(1,I),"^",2)="HOUSEBOUND" S HIT=1 Q
"RTN","DGBTRDVW",82,0)
 Q HIT
"RTN","DGBTSP")
0^10^B183996110
"RTN","DGBTSP",1,0)
DGBTSP ;ALB/BLD-BENEFICIARY TRAVEL SPECIAL MODE OF TRANSPORTATION; 12/18/2011@1000; 12/23/2012
"RTN","DGBTSP",2,0)
 ;;1.0;Beneficiary Travel;**20**;December 27, 2011;Build 185
"RTN","DGBTSP",3,0)
 ;
"RTN","DGBTSP",4,0)
 ;MUST ENTER AT EN^DGBTSP
"RTN","DGBTSP",5,0)
 Q
"RTN","DGBTSP",6,0)
 ;
"RTN","DGBTSP",7,0)
 ;
"RTN","DGBTSP",8,0)
EN(DGBTSP) ;main entry point from DGBTE
"RTN","DGBTSP",9,0)
 ;
"RTN","DGBTSP",10,0)
 ;TRNSMDE = mode of transportation
"RTN","DGBTSP",11,0)
 ;REMARKS = will only have data if OTHER is chosed from mode of transportation list
"RTN","DGBTSP",12,0)
 ;
"RTN","DGBTSP",13,0)
 N TRNSMDE,DGBTINTO,PREAUTH,DGBTACTYPE,MODEOFTRANS,OTHERTRANRMKS,AUTHORIZED,VENDOR,INVOICE,INVDT,OWTRP,TOTALMILES,TOTINVOICE,DGBTFDA
"RTN","DGBTSP",14,0)
 N BASERATE,MILEAGEFEE,NOSHOW,WAITTIME,EXTRACREW,SPEQUIP,REMARKS,DGBTINTO,ERRMSG,OTHERTRANSRMKS,ACTTYPE,ERRMSG
"RTN","DGBTSP",15,0)
 ;
"RTN","DGBTSP",16,0)
 ;
"RTN","DGBTSP",17,0)
 S DGBTSP=1,DGBTCMTY="M",SPCOMPLETE=0
"RTN","DGBTSP",18,0)
 ;type of claim - Mileage or Special Mode Claim
"RTN","DGBTSP",19,0)
 S DGBTACTYPE=$$GET1^DIQ(392,DGBTDT,56,"I")
"RTN","DGBTSP",20,0)
 S DIR("A")="Is this a Mileage or Special Mode Claim?",DIR("?")="Enter 'M' for Mileage Claim or RETURN to continue procesing Mileage claim or 'S' for Special Mode Claim"
"RTN","DGBTSP",21,0)
 S DIR(0)="S^M:MILEAGE;S:SPECIAL MODE^^W $S(X=""M"":""MILEAGE"",X=""S"":""SPECIAL MODE"",1:"""") K:X="" X"
"RTN","DGBTSP",22,0)
 S DIR("B")=$S($G(DGBTSP("CLAIM TYPE"))'="":DGBTSP("CLAIM TYPE"),$G(DGBTACTYPE)'="":DGBTACTYPE,1:"M")
"RTN","DGBTSP",23,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=$S($D(^DGBT(392,DGBTDTI,"SP")):1,1:0),SPCOMPLETE=$S($G(CHZFLG)=1:1,1:0),DGBTTOUT=-1 Q
"RTN","DGBTSP",24,0)
 S DGBTSP("CLAIM TYPE")=$P(Y,",",1),DGBTCMTY=$P(Y,",",1)
"RTN","DGBTSP",25,0)
 ;*************
"RTN","DGBTSP",26,0)
 ;
"RTN","DGBTSP",27,0)
 I +DGBTELL=15 D
"RTN","DGBTSP",28,0)
 .S DGBTFDA(392,DGBTDTI_",",56)=$G(DGBTSP("CLAIM TYPE"))
"RTN","DGBTSP",29,0)
 .S DGBTFDA(392,DGBTDTI_",",3)=$P(VAEL(1),"^",2)
"RTN","DGBTSP",30,0)
 .I +VAEL(3) S DGBTFDA(392,DGBTDTI_",",4)=$P(VAEL(3),"^",2)
"RTN","DGBTSP",31,0)
 .S DGBTFDA(392,DGBTDTI_",",41)=$$GET1^DIQ(200,DUZ,.01)
"RTN","DGBTSP",32,0)
 .S DGBTFDA(392,DGBTDTI_",",42)=$$GET1^DIQ(2,DFN,.01)
"RTN","DGBTSP",33,0)
 .I $E(DGBTDTI,1,7)=DGBTDT D
"RTN","DGBTSP",34,0)
 ..S DGBTFDA(392,DGBTDTI_",",6)=$S(DGBTCMTY="S":$$GET1^DIQ(392.3,6,.01),1:$$GET1^DIQ(392.3,8,.01))
"RTN","DGBTSP",35,0)
 .D FILE^DIE("EKTS","DGBTFDA","ERRMSG")
"RTN","DGBTSP",36,0)
 .;*************************
"RTN","DGBTSP",37,0)
 .I '$D(ERRMSG) S SPCOMPLETE=1
"RTN","DGBTSP",38,0)
 I DGBTSP("CLAIM TYPE")'="S" D
"RTN","DGBTSP",39,0)
 .S DA=DGBTDT,DIE="^DGBT(392,",DR="56///"_DGBTCMTY D ^DIE S %=1
"RTN","DGBTSP",40,0)
 .K DGBTSP S DGBTCMTY="M" S DGBTSP=0,SPCOMPLETE=0 D:$D(^DGBT(392,DGBTDT,"SP")) DELSP^DGBTSP1(DGBTDT)
"RTN","DGBTSP",41,0)
 Q
"RTN","DGBTSP",42,0)
 ;
"RTN","DGBTSP",43,0)
RESTART(DGBTCMTY)  ;
"RTN","DGBTSP",44,0)
 N SPACCT,SPACTIEN
"RTN","DGBTSP",45,0)
 S SPACCT="826 SPECIAL MODE - NON-EMERGEN"
"RTN","DGBTSP",46,0)
 S (ACCT,SPACTIEN,DGBTQ)=0
"RTN","DGBTSP",47,0)
 F  S ACCT=$O(^DGBT(392.3,"B",ACCT)) D  Q:DGBTQ!('ACCT)
"RTN","DGBTSP",48,0)
 .I ACCT'["SPECIAL MODE - NON-EMERGEN" Q
"RTN","DGBTSP",49,0)
 .S SPACTIEN=$O(^DGBT(392.3,"B",ACCT,""))
"RTN","DGBTSP",50,0)
 .I $$GET1^DIQ(392.3,SPACTIEN,4,"I")'<DT!($$GET1^DIQ(392.3,SPACTIEN,4)=""),$$GET1^DIQ(392.3,SPACTIEN,5,"I")=3 S DGBTQ=1
"RTN","DGBTSP",51,0)
 .E  S ACCT=""
"RTN","DGBTSP",52,0)
 I 'ACCT D  Q
"RTN","DGBTSP",53,0)
 .D ACTFILE^DGBTSP
"RTN","DGBTSP",54,0)
 .I 'CHZFLG S DGBTTOUT=-1,DGBTOLD=0,SPCOMPLETE=0
"RTN","DGBTSP",55,0)
 .E  S DUOUT=1,SPCOMPLETE=0
"RTN","DGBTSP",56,0)
 S $P(^DGBT(392,DGBTDT,0),"^",9)=""
"RTN","DGBTSP",57,0)
 S DGBTSP("ACCOUNT")=$$GET1^DIQ(392.3,SPACTIEN,.01)
"RTN","DGBTSP",58,0)
 ;
"RTN","DGBTSP",59,0)
 ;mode of special transportation used
"RTN","DGBTSP",60,0)
 W !
"RTN","DGBTSP",61,0)
 S SPCOMPLETE=0
"RTN","DGBTSP",62,0)
 S MODEOFTRANS=$$GET1^DIQ(392,DGBTDT,57,"E")
"RTN","DGBTSP",63,0)
 S DIR("A")="MODE OF TRANSPORTATION: ",DIR("?")="This field points to the Beneficiary Travel Mode of Transportation file and indicates the mode of transportation used for this Beneficiary Travel Claim."
"RTN","DGBTSP",64,0)
 S DIR(0)="PA^392.42:EMZ"
"RTN","DGBTSP",65,0)
 S MODEOFTRANS=$S($G(MODEOFTRANS)'="":MODEOFTRANS,1:$G(DGBTSP("MODE OF TRANS")))
"RTN","DGBTSP",66,0)
 I MODEOFTRANS'="" S DIR("B")=$S($G(MODEOFTRANS)'="":MODEOFTRANS,1:$G(DGBTSP("MODE OF TRANS")))
"RTN","DGBTSP",67,0)
 D ^DIR S TRNSMDE=$P($G(Y(0)),",",1) K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP",68,0)
 S DGBTSP("MODE OF TRANS")=$P($G(Y(0)),",",1)
"RTN","DGBTSP",69,0)
 I TRNSMDE="OTHER" D SPRMKS(.DGBTSP)
"RTN","DGBTSP",70,0)
 D PREAUTH(.DGBTSP) Q:$D(DUOUT)!$D(DTOUT)!(SPCOMPLETE=0)
"RTN","DGBTSP",71,0)
 D VENDOR(.DGBTSP) Q:$D(DUOUT)!$D(DTOUT)
"RTN","DGBTSP",72,0)
 D ADDINFO(.DGBTSP) Q:$D(DUOUT)!$D(DTOUT)
"RTN","DGBTSP",73,0)
 Q
"RTN","DGBTSP",74,0)
 ;
"RTN","DGBTSP",75,0)
SPRMKS(DGBTSP) ;will allow user to enter other remarks about special mode transportation
"RTN","DGBTSP",76,0)
 W !
"RTN","DGBTSP",77,0)
 S OTHERTRANSRMKS=$$GET1^DIQ(392,DGBTDT,69,"I")
"RTN","DGBTSP",78,0)
 S DIR("A")="SPECIFY OTHER MODE OF TRANSPORTATION"
"RTN","DGBTSP",79,0)
 S DIR("?")="Enter other information about the type of Special Mode of Transportation. 3-25 characters."
"RTN","DGBTSP",80,0)
 S DIR(0)="FO^3:25"
"RTN","DGBTSP",81,0)
 I OTHERTRANSRMKS'="" S DIR("B")=$S($G(OTHERTRANSRMKS)'="":OTHERTRANSRMKS,1:$G(DGBTSP("OTHER TRANS REMARKS")))
"RTN","DGBTSP",82,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP",83,0)
 S DGBTSP("OTHER TRANS REMARKS")=Y
"RTN","DGBTSP",84,0)
 Q
"RTN","DGBTSP",85,0)
 ;
"RTN","DGBTSP",86,0)
PREAUTH(DGBTSP) ;this will ask if trip was pre-authorized. If answer is no then ask end user if claim is approved or denied.
"RTN","DGBTSP",87,0)
 ;if end userindicates theat authorizstion has been denied, then the System denies the Claim and issues an Appeal Rights
"RTN","DGBTSP",88,0)
 ;document and prompts the the end user for the Vendor. The end user is only allowed to select a Vendor from the list
"RTN","DGBTSP",89,0)
 ;of vendors already in the FMS system.
"RTN","DGBTSP",90,0)
 ;
"RTN","DGBTSP",91,0)
 W !
"RTN","DGBTSP",92,0)
 Q:$G(DFN)=""!($G(DGBTSP)=0)
"RTN","DGBTSP",93,0)
 S PREAUTH=$$GET1^DIQ(392,DGBTDT,70)           ;,"I"),PREAUTH=$S(PREAUTH="Y":"YES",1:"NO")
"RTN","DGBTSP",94,0)
 S DIR("A")="WAS TRIP PRE-AUTHORIZED"
"RTN","DGBTSP",95,0)
 S DIR(0)="Y"
"RTN","DGBTSP",96,0)
 S DIR("?")="Sorry, enter 'N'o if not Pre-Authorized, 'Y'es if Pre-Authorized",DIR(0)="Y"
"RTN","DGBTSP",97,0)
 I PREAUTH'="" S DIR("B")=$S($G(PREAUTH)'="":$G(PREAUTH),1:$S($G(DGBTSP("PRE-AUTHORIZED"))=1:"YES",1:"NO"))
"RTN","DGBTSP",98,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",99,0)
 S DGBTSP("PRE-AUTHORIZED")=+Y
"RTN","DGBTSP",100,0)
 S DGBTSP("PRE-AUTHORIZED")=$G(Y(0))
"RTN","DGBTSP",101,0)
 I DGBTSP("PRE-AUTHORIZED")="YES" K DGBTSP("AUTHORIZED") S DGBTSP("AUTHORIZED")="YES" D CLRLTR^DGBTDLT(0)
"RTN","DGBTSP",102,0)
 I '+Y D  I ($D(DTOUT))!($D(DUOUT))!(SPCOMPLETE=0) S DGBTSP=0 Q
"RTN","DGBTSP",103,0)
 .S AUTHORIZED=$$GET1^DIQ(392,DGBTDT,85)                              ;,"I"),AUTHORIZED=$S(AUTHORIZED="Y":"YES",1:"NO")
"RTN","DGBTSP",104,0)
 .S DIR("A")="IS AUTHORIZATION APPROVED"
"RTN","DGBTSP",105,0)
 .S DIR("?")="Sorry, enter 'N'o if Claim not Authorized, 'Y'es if Claim is Authorized",DIR(0)="Y"
"RTN","DGBTSP",106,0)
 .S DIR(0)="Y"
"RTN","DGBTSP",107,0)
 .S DIR("B")=$S($G(AUTHORIZED)'="":$G(AUTHORIZED),1:$S($G(DGBTSP("AUTHORIZED"))=1:"YES",1:"NO"))
"RTN","DGBTSP",108,0)
 .D ^DIR K DIR S:+Y SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","DGBTSP",109,0)
 .S DGBTSP("AUTHORIZED")=+Y
"RTN","DGBTSP",110,0)
 .S DGBTSP("AUTHORIZED")=$G(Y(0))
"RTN","DGBTSP",111,0)
 .I Y(0)="NO" D  Q
"RTN","DGBTSP",112,0)
 ..I $G(DGBTAPPTYP) W !!,"CLAIM HAS BEEN DENIED AND DENIAL OF BENEFITS LETTER HAS ALREADY BEEN ISSUED"
"RTN","DGBTSP",113,0)
 ..I '$G(DGBTAPPTYP) W !!,"CLAIM HAS BEEN DENIED AND DENIAL OF BENEFITS LETTER WILL BE ISSUED"
"RTN","DGBTSP",114,0)
 ..I '$G(DGBTAPPTYP) D DGBTDR^DGBTDLT Q:SPCOMPLETE=0
"RTN","DGBTSP",115,0)
 ..W !!,"PLEASE COMPLETE THE INVOICE INFORMATION." H 1
"RTN","DGBTSP",116,0)
 ..S SPCOMPLETE=1
"RTN","DGBTSP",117,0)
 I '$G(DGBTAPPTYP) D CLRLTR^DGBTDLT(0)
"RTN","DGBTSP",118,0)
 S SPCOMPLETE=1
"RTN","DGBTSP",119,0)
 Q
"RTN","DGBTSP",120,0)
 ;
"RTN","DGBTSP",121,0)
VENDOR(DGBTSP) ;allows the user to select from a vendor already in the FMS system
"RTN","DGBTSP",122,0)
 ;
"RTN","DGBTSP",123,0)
 W !
"RTN","DGBTSP",124,0)
 Q:$G(DFN)=""!($G(DGBTSP)=0)
"RTN","DGBTSP",125,0)
 S VENDOR=$$GET1^DIQ(392,DGBTDT,71,"E")
"RTN","DGBTSP",126,0)
 S DIR("A")="SELECT VENDOR: "
"RTN","DGBTSP",127,0)
 S DIR("?")="Select a Vendor from the list only"
"RTN","DGBTSP",128,0)
 S DIR(0)="PA^440:EMZ"
"RTN","DGBTSP",129,0)
 S VENDOR=$S($G(VENDOR)'="":VENDOR,$G(DGBTSP("VENDOR"))'="":$G(DGBTSP("VENDOR")),1:"")
"RTN","DGBTSP",130,0)
 I VENDOR'="" S DIR("B")=$S($G(VENDOR)'="":VENDOR,1:$G(DGBTSP("VENDOR")))
"RTN","DGBTSP",131,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",132,0)
 S DGBTSP("VENDOR")=$P($G(Y(0)),"^",1)
"RTN","DGBTSP",133,0)
 ;
"RTN","DGBTSP",134,0)
 Q
"RTN","DGBTSP",135,0)
 ;
"RTN","DGBTSP",136,0)
ADDINFO(DGBTSP) ;this will ask additional quesitons of the end user about the invoice presented by the patient.
"RTN","DGBTSP",137,0)
 ;
"RTN","DGBTSP",138,0)
 Q:$G(DFN)=""!($G(DGBTSP)=0)
"RTN","DGBTSP",139,0)
 N I
"RTN","DGBTSP",140,0)
 D INST(.DGBTINST)
"RTN","DGBTSP",141,0)
 ;
"RTN","DGBTSP",142,0)
 ;address information
"RTN","DGBTSP",143,0)
 S DIR("A")="PLACE OF DEPARTURE [LINE 1]"
"RTN","DGBTSP",144,0)
 S DIR("?")="ENTER "_"PLACE OF DEPARTURE [LINE 1]. 1 TO 30 CHARACTERS"
"RTN","DGBTSP",145,0)
 S DIR(0)="FO^1:30"
"RTN","DGBTSP",146,0)
 S DEPL1=$$GET1^DIQ(392,DGBTDTI,73)
"RTN","DGBTSP",147,0)
 S DIR("B")=$S($G(DEPL1)'="":$G(DEPL1),1:$G(VAPA(1)))
"RTN","DGBTSP",148,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",149,0)
 S DGBTSP("PLACE OF DEPARTURE")=Y
"RTN","DGBTSP",150,0)
 ;
"RTN","DGBTSP",151,0)
 S DIR("A")="PLACE OF DEPARTURE [LINE 2]"
"RTN","DGBTSP",152,0)
 S DIR("?")="ENTER "_"PLACE OF DEPARTURE [LINE 2]. 1 TO 30 CHARACTERS"
"RTN","DGBTSP",153,0)
 S DIR(0)="FO^1:30"
"RTN","DGBTSP",154,0)
 S DEPL2=$$GET1^DIQ(392,DGBTDTI,74)
"RTN","DGBTSP",155,0)
 S DIR("B")=$S($G(DEPL2)'="":$G(DEPL2),1:$G(VAPA(2)))
"RTN","DGBTSP",156,0)
 I $G(DIR("B"))="" K DIR("B")
"RTN","DGBTSP",157,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",158,0)
 S DGBTSP("PLACE OF DEPARTURE 2")=Y
"RTN","DGBTSP",159,0)
 ;
"RTN","DGBTSP",160,0)
 S DIR("A")="CITY OF DEPARTURE"
"RTN","DGBTSP",161,0)
 S DIR("?")="ENTER "_"CITY OF DEPARTURE. 3 TO 30 CHARACTERS"
"RTN","DGBTSP",162,0)
 S DIR(0)="FO^3:30"
"RTN","DGBTSP",163,0)
 S DEPCITY=$$GET1^DIQ(392,DGBTDTI,75)
"RTN","DGBTSP",164,0)
 S DIR("B")=$S($G(DEPCITY)'="":$G(DEPCITY),1:$G(VAPA(4)))
"RTN","DGBTSP",165,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",166,0)
 S DGBTSP("CITY OF DEPARTURE")=Y
"RTN","DGBTSP",167,0)
 ;
"RTN","DGBTSP",168,0)
 S DIR("A")="STATE OF DEPARTURE"
"RTN","DGBTSP",169,0)
 S DIR("?")="ENTER "_"STATE OF DEPARTURE"
"RTN","DGBTSP",170,0)
 S DIR(0)="P^5:EMZ"
"RTN","DGBTSP",171,0)
 S DEPST=$$GET1^DIQ(392,DGBTDTI,76)
"RTN","DGBTSP",172,0)
 S DIR("B")=$S($G(DEPST)'="":$G(DEPST),1:$P($G(VAPA(5)),"^",2))
"RTN","DGBTSP",173,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",174,0)
 S DGBTSP("STATE OF DEPARTURE")=$P(Y,"^",2)
"RTN","DGBTSP",175,0)
 ;
"RTN","DGBTSP",176,0)
 S DIR("A")="ZIP CODE/DEPARTURE"
"RTN","DGBTSP",177,0)
 S DIR("?")="ENTER "_"ZIP CODE/DEPARTURE (5 NUMBERS)"
"RTN","DGBTSP",178,0)
 S DIR(0)="FO^5:5"    ;$S(I="STATE OF DEPATURE":"P^5:EMZ",1:"FO^3:30")
"RTN","DGBTSP",179,0)
 S DEPZIP=$$GET1^DIQ(392,DGBTDTI,77)
"RTN","DGBTSP",180,0)
 S DIR("B")=$S($G(DEPZIP)'="":$G(DEPZIP),1:$P($G(VAPA(11)),"^",2))
"RTN","DGBTSP",181,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",182,0)
 S DGBTSP("ZIP CODE/DEPARTURE")=Y
"RTN","DGBTSP",183,0)
 ;
"RTN","DGBTSP",184,0)
 Q:$G(DGBTSP)=0
"RTN","DGBTSP",185,0)
 ;
"RTN","DGBTSP",186,0)
 ;destination information
"RTN","DGBTSP",187,0)
 W !
"RTN","DGBTSP",188,0)
 ;
"RTN","DGBTSP",189,0)
 S DIR("A")="DESTINATION [LINE 1]"
"RTN","DGBTSP",190,0)
 S DIR("?")="ENTER "_"DESTINATION [LINE 1]. 1 TO 30 CHARACTERS"
"RTN","DGBTSP",191,0)
 S DIR(0)="FO^1:30"
"RTN","DGBTSP",192,0)
 S DISTL1=$$GET1^DIQ(392,DGBTDTI,78)
"RTN","DGBTSP",193,0)
 S DIR("B")=$S($G(DISTL1)'="":DISTL1,1:DGBTINST("DIVISION"))
"RTN","DGBTSP",194,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",195,0)
 S DGBTINST("DIVISION")=Y
"RTN","DGBTSP",196,0)
 ;
"RTN","DGBTSP",197,0)
 S DIR("A")="DESTINATION [LINE 2]"
"RTN","DGBTSP",198,0)
 S DIR("?")="ENTER "_"DESTINATION [LINE 2]. 1 TO 30 CHARACTERS"
"RTN","DGBTSP",199,0)
 S DIR(0)="FO^1:30"
"RTN","DGBTSP",200,0)
 S DISTL2=$$GET1^DIQ(392,DGBTDTI,79)
"RTN","DGBTSP",201,0)
 S DIR("B")=$S($G(DISTL2)'="":DISTL2,1:DGBTINST("INST NAME"))
"RTN","DGBTSP",202,0)
 I $G(DIR("B"))="" K DIR("B")
"RTN","DGBTSP",203,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",204,0)
 S DGBTINST("INST NAME")=Y
"RTN","DGBTSP",205,0)
 ;
"RTN","DGBTSP",206,0)
 S DIR("A")="DESTINATION [LINE 3]"
"RTN","DGBTSP",207,0)
 S DIR("?")="ENTER "_"DESTINATION [LINE 3]. 1 TO 30 CHARACTERS"
"RTN","DGBTSP",208,0)
 S DIR(0)="FO^1:30"
"RTN","DGBTSP",209,0)
 S DISTL1=$$GET1^DIQ(392,DGBTDTI,80)
"RTN","DGBTSP",210,0)
 S DIR("B")=$S($G(DISTL1)'="":DISTL1,1:DGBTINST("ADDRESS1"))
"RTN","DGBTSP",211,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",212,0)
 S DGBTINST("ADDRESS1")=Y
"RTN","DGBTSP",213,0)
 ;
"RTN","DGBTSP",214,0)
 S DIR("A")="CITY"
"RTN","DGBTSP",215,0)
 S DIR("?")="ENTER "_"CITY OF DESTINATION. 3 TO 30 CHARACTERS"
"RTN","DGBTSP",216,0)
 S DIR(0)="FO^3:30"
"RTN","DGBTSP",217,0)
 S DISTCITY=$$GET1^DIQ(392,DGBTDTI,81)
"RTN","DGBTSP",218,0)
 S DIR("B")=$S($G(DISTCITY)'="":DISTCITY,1:DGBTINST("CITY"))
"RTN","DGBTSP",219,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",220,0)
 S DGBTINST("CITY")=Y
"RTN","DGBTSP",221,0)
 ;
"RTN","DGBTSP",222,0)
 S DIR("A")="STATE OF DESTINATION"
"RTN","DGBTSP",223,0)
 S DIR("?")="ENTER "_"STATE OF DESTINATION"
"RTN","DGBTSP",224,0)
 S DIR(0)="PO^5:EMZ"
"RTN","DGBTSP",225,0)
 S DISTST=$$GET1^DIQ(392,DGBTDTI,82)
"RTN","DGBTSP",226,0)
 S DIR("B")=$S($G(DISTST)'="":DISTST,1:DGBTINST("STATE"))
"RTN","DGBTSP",227,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",228,0)
 S DGBTINST("STATE")=$P(Y,"^",2)
"RTN","DGBTSP",229,0)
 ;
"RTN","DGBTSP",230,0)
 S DIR("A")="ZIP CODE/DESTINATION"
"RTN","DGBTSP",231,0)
 S DIR("?")="ENTER "_"ZIP CODE/DESTINATION (5 NUMBERS)"
"RTN","DGBTSP",232,0)
 S DIR(0)="FO^5:5"
"RTN","DGBTSP",233,0)
 S DISTZIP=$$GET1^DIQ(392,DGBTDTI,83)
"RTN","DGBTSP",234,0)
 S DIR("B")=$S($G(DISTZIP)'="":DISTZIP,1:DGBTINST("ZIP CODE"))
"RTN","DGBTSP",235,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I $D(DTOUT)!($D(DUOUT)) S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",236,0)
 S DGBTINST("ZIP CODE")=Y
"RTN","DGBTSP",237,0)
 ;
"RTN","DGBTSP",238,0)
 Q:$G(DGBTSP)=0
"RTN","DGBTSP",239,0)
 ;
"RTN","DGBTSP",240,0)
 ;invoice information
"RTN","DGBTSP",241,0)
 W !
"RTN","DGBTSP",242,0)
 S INVOICE=$$GET1^DIQ(392,DGBTDT,58,"I")
"RTN","DGBTSP",243,0)
 S DIR("A")="INVOICE NUMBER: "
"RTN","DGBTSP",244,0)
 S DIR("?")="Enter Special Mode invoice number. Should be min 1 max of 30."
"RTN","DGBTSP",245,0)
 S DIR(0)="FA^1:30"
"RTN","DGBTSP",246,0)
 S INVOICE=$S($G(INVOICE)'="":INVOICE,$G(DGBTSP("INVOICE NUMBER"))'="":$G(DGBTSP("INVOICE NUMBER")),1:"")
"RTN","DGBTSP",247,0)
 I INVOICE'="" S DIR("B")=$S($G(INVOICE)'="":INVOICE,1:$G(DGBTSP("INVOICE NUMBER")))
"RTN","DGBTSP",248,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",249,0)
 S DGBTSP("INVOICE NUMBER")=Y
"RTN","DGBTSP",250,0)
 ;
"RTN","DGBTSP",251,0)
 W !
"RTN","DGBTSP",252,0)
 S INVDT=$$GET1^DIQ(392,DGBTDT,59,"E")
"RTN","DGBTSP",253,0)
 S DIR("A")="INVOICE DATE: "
"RTN","DGBTSP",254,0)
 S DIR("?")="^D HELP1^DGBTE1A"
"RTN","DGBTSP",255,0)
 S DIR(0)="DAO^3000101:DT+1:EX"
"RTN","DGBTSP",256,0)
 I INVDT'="" S DIR("B")=$S($G(INVDT)'="":$G(INVDT),$G(DGBTSP("DT INVOICE REC")):$G(DGBTSP("INVOICE NUMBER")),1:DGBTDTE)
"RTN","DGBTSP",257,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",258,0)
 S DGBTSP("DT INVOICE REC")=$G(Y(0))
"RTN","DGBTSP",259,0)
 ;
"RTN","DGBTSP",260,0)
 W !
"RTN","DGBTSP",261,0)
 S OWRTP=$$GET1^DIQ(392,DGBTDT,67,"E")
"RTN","DGBTSP",262,0)
 S DIR("A")="ONE WAY/ROUND TRIP:"
"RTN","DGBTSP",263,0)
 S DIR("?")="Enter 'R' for Round Trip or 'O' for One Way Trip ."
"RTN","DGBTSP",264,0)
 S DIR(0)="SA^R:ROUND TRIP;O:ONE WAY TRIP"
"RTN","DGBTSP",265,0)
 S OWRTP=$S($G(OWRTP)'="":OWRTP,$G(DGBTSP("RT/ONE WAY")):$G(DGBTSP("RT/ONE WAY")),1:"")
"RTN","DGBTSP",266,0)
 I OWRTP'="" S DIR("B")=$S($G(OWRTP)'="":OWRTP,1:$G(DGBTSP("RT/ONE WAY")))
"RTN","DGBTSP",267,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",268,0)
 S DGBTSP("RT/ONE WAY")=Y
"RTN","DGBTSP",269,0)
 ;
"RTN","DGBTSP",270,0)
 W !
"RTN","DGBTSP",271,0)
 S TOTALMILES=$$GET1^DIQ(392,DGBTDT,68,"E")
"RTN","DGBTSP",272,0)
 S DIR("A")="TOTAL MILES: "
"RTN","DGBTSP",273,0)
 S DIR("?")="Type a Number between 0 and 10000, 0 Decimal Digits"
"RTN","DGBTSP",274,0)
 S DIR(0)="NA^1:99999:1"
"RTN","DGBTSP",275,0)
 S TOTALMILES=$S($G(TOTALMILES)'="":TOTALMILES,$G(DGBTSP("TOTAL MILES")):$G(DGBTSP("TOTAL MILES")),1:"")
"RTN","DGBTSP",276,0)
 I TOTALMILES'="" S DIR("B")=$S($G(TOTALMILES)'="":TOTALMILES,1:$G(DGBTSP("TOTAL MILES")))
"RTN","DGBTSP",277,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",278,0)
 S DGBTSP("TOTAL MILES")=Y
"RTN","DGBTSP",279,0)
 ;
"RTN","DGBTSP",280,0)
 F I=1:1 Q:I>1&($G(DGBTSP("TOTAL INVOICE"))'="")&($G(DGBTSP("TOTAL INVOICE"))=$G(DGBTINTO))  D INVAMT^DGBTSP1 Q:$G(DGBTSP)=0  I ($G(DGBTSP("TOTAL INVOICE"))'="")&($G(DGBTSP("TOTAL INVOICE"))'=$G(DGBTINTO)) D
"RTN","DGBTSP",281,0)
 .W !!,"TOTAL INVOICE DOES NOT EQUAL THE SUM OF THE COMPONENT FEES."
"RTN","DGBTSP",282,0)
 .W !,"YOU MUST CORRECT THE CLAIM BEFORE CONTINUING",!
"RTN","DGBTSP",283,0)
 ;
"RTN","DGBTSP",284,0)
 Q:DGBTSP=0
"RTN","DGBTSP",285,0)
 ;
"RTN","DGBTSP",286,0)
 W !
"RTN","DGBTSP",287,0)
 S REMARKS=$$GET1^DIQ(392,DGBTDT,72,"E")
"RTN","DGBTSP",288,0)
 S DIR("A")="REMARKS: "
"RTN","DGBTSP",289,0)
 S DIR("?")="Enter other information about the Special Mode of Transportation Invoice. 3-50 characters."
"RTN","DGBTSP",290,0)
 S DIR(0)="FOA^3:50"
"RTN","DGBTSP",291,0)
 I REMARKS'="" S DIR("B")=$S($G(REMARKS)'="":REMARKS,1:$G(DGBTSP("SP MODE OTHER REMARKS")))
"RTN","DGBTSP",292,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0,SPCOMPLETE=0 Q
"RTN","DGBTSP",293,0)
 S DGBTSP("SP MODE OTHER REMARKS")=Y
"RTN","DGBTSP",294,0)
 ;
"RTN","DGBTSP",295,0)
 Q
"RTN","DGBTSP",296,0)
 ;
"RTN","DGBTSP",297,0)
INST(DGBTINST) ;get destination information
"RTN","DGBTSP",298,0)
 ;
"RTN","DGBTSP",299,0)
 N FAC,ERROR,FIELDS,TEMP
"RTN","DGBTSP",300,0)
 S DGBTINST("DIVISION")=$$GET1^DIQ(40.8,DGBTDIVI,.01)
"RTN","DGBTSP",301,0)
 S DGBTINST("INST NAME")=$$GET1^DIQ(4,DGBTDIVN,.01)
"RTN","DGBTSP",302,0)
 S DGBTINST("ADDRESS1")=$$GET1^DIQ(4,DGBTDIVN,1.01)
"RTN","DGBTSP",303,0)
 S DGBTINST("CITY")=$$GET1^DIQ(4,DGBTDIVN,1.03)
"RTN","DGBTSP",304,0)
 S DGBTINST("STATE")=$$GET1^DIQ(4,DGBTDIVN,.02)
"RTN","DGBTSP",305,0)
 S DGBTINST("ZIP CODE")=$E($$GET1^DIQ(4,DGBTDIVN,1.04),1,5)
"RTN","DGBTSP",306,0)
 ;
"RTN","DGBTSP",307,0)
 Q
"RTN","DGBTSP",308,0)
 ;
"RTN","DGBTSP",309,0)
CLEANUP ;this will clean up the ^DGBT(392,D0) file for nodes "M","D","T" and the 3 and 4 piece of the "A" node
"RTN","DGBTSP",310,0)
 ;
"RTN","DGBTSP",311,0)
 ;N DGBTDL
"RTN","DGBTSP",312,0)
 Q:$G(DGBTDTI)=""
"RTN","DGBTSP",313,0)
 F I="M","D","B","C","T" I $D(DGBTDTI) K ^DGBT(392,DGBTDTI,I)
"RTN","DGBTSP",314,0)
 ;F I=8,9,10 S $P(^DGBT(392,DGBTDTI,0),"^",I)=""
"RTN","DGBTSP",315,0)
 S DGBTDL("ISSUED")=$S($G(DGBTDL("ISSUED"))'="":$G(DGBTDL("ISSUED")),1:"")
"RTN","DGBTSP",316,0)
 S DGBTDL("ISSUED DATE")=$S($G(DGBTDL("ISSUED DATE"))'="":$G(DGBTDL("ISSUED DATE")),1:"")
"RTN","DGBTSP",317,0)
 S DGBTDL("CLAIM DENIED")=$S($G(DGBTDL("CLAIM DENIED"))'="":$G(DGBTDL("CLAIM DENIED")),1:"NO")
"RTN","DGBTSP",318,0)
 S DGBTDL("DT DENIED")=$S($G(DGBTDL("DT DENIED"))'="":$G(DGBTDL("DT DENIED")),1:"")
"RTN","DGBTSP",319,0)
 S DGBTDL("DENIED REASON")=$S($G(DGBTDL("DENIED REASON"))'="":$G(DGBTDL("DENIED REASON")),1:"")
"RTN","DGBTSP",320,0)
 ;
"RTN","DGBTSP",321,0)
 S DGBTFDA(392,DGBTDTI_",",45)=$G(DGBTDL("ISSUED"))
"RTN","DGBTSP",322,0)
 S DGBTFDA(392,DGBTDTI_",",45.1)=$G(DGBTDL("ISSUED DATE"))
"RTN","DGBTSP",323,0)
 S DGBTFDA(392,DGBTDTI_",",45.2)=$G(DGBTDL("CLAIM DENIED"))
"RTN","DGBTSP",324,0)
 S DGBTFDA(392,DGBTDTI_",",45.3)=$G(DGBTDL("DT DENIED"))
"RTN","DGBTSP",325,0)
 S DGBTFDA(392,DGBTDTI_",",45.4)=$G(DGBTDL("DENIED REASON"))
"RTN","DGBTSP",326,0)
 S DGBTFDA(392,DGBTDTI_",",8)=""
"RTN","DGBTSP",327,0)
 S DGBTFDA(392,DGBTDTI_",",9)=""
"RTN","DGBTSP",328,0)
 S DGBTFDA(392,DGBTDTI_",",10)=""
"RTN","DGBTSP",329,0)
 D FILE^DIE("EKTS","DGBTFDA","ERRMSG") K DGBTFDA
"RTN","DGBTSP",330,0)
 Q
"RTN","DGBTSP",331,0)
 ;
"RTN","DGBTSP",332,0)
ACTFILE ;
"RTN","DGBTSP",333,0)
 K DIR
"RTN","DGBTSP",334,0)
 I 'ACCT D  Q
"RTN","DGBTSP",335,0)
 .W !!
"RTN","DGBTSP",336,0)
 .S MYHELP("DIHELP",1)="Beneficiary Travel Account file (#392.3) is not set up correctly."
"RTN","DGBTSP",337,0)
 .S MYHELP("DIHELP",2)="Please see User Manual for proper setup."
"RTN","DGBTSP",338,0)
 .D MSG^DIALOG("WSH","","","","MYHELP")
"RTN","DGBTSP",339,0)
 .W !!
"RTN","DGBTSP",340,0)
 .S DIR(0)="E"
"RTN","DGBTSP",341,0)
 .D ^DIR
"RTN","DGBTSP",342,0)
 .S DGBTTOUT=-1
"RTN","DGBTSP",343,0)
 Q
"RTN","DGBTSP1")
0^13^B78025858
"RTN","DGBTSP1",1,0)
DGBTSP1 ;ALB/BLD-BENEFICIARY TRAVEL SPECIAL MODE OF TRANSPORTATION; 12/18/2011@1000; 12/23/2012
"RTN","DGBTSP1",2,0)
 ;;1.0;Beneficiary Travel;**20**;December 27, 2011;Build 185
"RTN","DGBTSP1",3,0)
 ;
"RTN","DGBTSP1",4,0)
ACCT ;  allowed to select only valid active accounts
"RTN","DGBTSP1",5,0)
 S DGBTOACT=$S('$D(^DGBT(392.3,+$P(DGBTVAR(0),"^",6),0)):0,1:+$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^",5))
"RTN","DGBTSP1",6,0)
 K X S (DIC("B"),X)=$S(+$P(DGBTVAR(0),"^",6):$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^"),1:$$DEFLT1^DGBTEE1) S DIC("A")="Select ACCOUNT: "
"RTN","DGBTSP1",7,0)
 S DIC="^DGBT(392.3,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,3)'>DGBTDT&('$P(^(0),U,4)!($P(^(0),U,4)'<DGBTDT))"
"RTN","DGBTSP1",8,0)
 D ^DIC K DIC I $D(DTOUT) S DGBTTOUT=-1 K DTOUT Q
"RTN","DGBTSP1",9,0)
 I Y'>0 W !,"ACCOUNT IS REQUIRED!!" G ACCT
"RTN","DGBTSP1",10,0)
 S DGBTACTN=$P(Y,"^"),DGBTACCT=$P($G(Y(0)),"^",5)
"RTN","DGBTSP1",11,0)
 ;  if account is ALL OTHER - stuff in mileage info
"RTN","DGBTSP1",12,0)
 I $D(DGBTVAR("M")) S DGBTML=$P(DGBTVAR("M"),"^",2),DGBTOWRT=$P(DGBTVAR("M"),"^"),DGBTMLT=$J((DGBTML*DGBTOWRT*DGBTMR),0,2)
"RTN","DGBTSP1",13,0)
 Q
"RTN","DGBTSP1",14,0)
 ;
"RTN","DGBTSP1",15,0)
DGBTDC(DGBTDT,DFN) ;this will process denie the claim and issue a denial letter
"RTN","DGBTSP1",16,0)
 ;
"RTN","DGBTSP1",17,0)
 W !!,"CLAIM HAS BEEN DENIED AND DENIAL OF BENEFITS LETTER WILL BE ISSUED"
"RTN","DGBTSP1",18,0)
 I '$G(DGBTAPPTYP) D DGBTDR^DGBTDLT
"RTN","DGBTSP1",19,0)
 W !!,"PLEASE COMPLETE THE INVOICE INFORMATION." H 1
"RTN","DGBTSP1",20,0)
 Q
"RTN","DGBTSP1",21,0)
 ;
"RTN","DGBTSP1",22,0)
DELSP(DGBTDT) ;this will delete the special mode data when editing a claim and the claim changes from a Special Mode to a Mileage Claim
"RTN","DGBTSP1",23,0)
 ;
"RTN","DGBTSP1",24,0)
 N ACCT,ACTNBR,NULL,DGBTDL
"RTN","DGBTSP1",25,0)
 S (ACTNBR,ACCT,NULL)=""
"RTN","DGBTSP1",26,0)
 F  S ACCT=$O(^DGBT(392.3,"D","ALL OTHER",ACCT)) Q:ACCT=""  D  Q:ACTNBR
"RTN","DGBTSP1",27,0)
 .I $P(^DGBT(392.3,ACCT,0),"^",4)="" S ACTNBR=ACCT
"RTN","DGBTSP1",28,0)
 S ACTNBR=$$GET1^DIQ(392.3,ACCT,.01)
"RTN","DGBTSP1",29,0)
 K ^DGBT(392,DGBTDT,"SP"),^DGBT(392,DGBTDT,"SPAD")
"RTN","DGBTSP1",30,0)
 ;
"RTN","DGBTSP1",31,0)
 S DGBTDL("ISSUED")=""
"RTN","DGBTSP1",32,0)
 S DGBTDL("ISSUED DATE")=""
"RTN","DGBTSP1",33,0)
 S DGBTDL("CLAIM DENIED")="NO"
"RTN","DGBTSP1",34,0)
 S DGBTDL("DT DENIED")=""
"RTN","DGBTSP1",35,0)
 S DGBTDL("DENIED REASON")=""
"RTN","DGBTSP1",36,0)
 S DGBTDL("ACCT NBR")=ACTNBR
"RTN","DGBTSP1",37,0)
 S DGBTDL("CLAIM TYPE")=""
"RTN","DGBTSP1",38,0)
 ;
"RTN","DGBTSP1",39,0)
 S DGBTFDA(392,DGBTDTI_",",45)=$G(DGBTDL("ISSUED"))
"RTN","DGBTSP1",40,0)
 S DGBTFDA(392,DGBTDTI_",",45.1)=$G(DGBTDL("ISSUED DATE"))
"RTN","DGBTSP1",41,0)
 S DGBTFDA(392,DGBTDTI_",",45.2)=$G(DGBTDL("CLAIM DENIED"))
"RTN","DGBTSP1",42,0)
 S DGBTFDA(392,DGBTDTI_",",45.3)=$G(DGBTDL("DT DENIED"))
"RTN","DGBTSP1",43,0)
 S DGBTFDA(392,DGBTDTI_",",45.4)=$G(DGBTDL("DENIED REASON"))
"RTN","DGBTSP1",44,0)
 S DGBTFDA(392,DGBTDTI_",",6)=$G(DGBTDL("ACCT NBR"))
"RTN","DGBTSP1",45,0)
 S DGBTFDA(392,DGBTDTI_",",56)=$G(DGBTCMTY)
"RTN","DGBTSP1",46,0)
 D FILE^DIE("EKTS","DGBTFDA","ERRMSG") K DGBTFDA
"RTN","DGBTSP1",47,0)
 Q
"RTN","DGBTSP1",48,0)
 ;
"RTN","DGBTSP1",49,0)
FILE(DGBTDT) ;this will file the special mode into file 392 (Beneficiary Travel Claim File).
"RTN","DGBTSP1",50,0)
 ;
"RTN","DGBTSP1",51,0)
 N DGBTDTI,DGBTFDA
"RTN","DGBTSP1",52,0)
 W !!,"FILING....."
"RTN","DGBTSP1",53,0)
 ;
"RTN","DGBTSP1",54,0)
 S DGBTDTI=DGBTA
"RTN","DGBTSP1",55,0)
 D CLEANUP^DGBTSP
"RTN","DGBTSP1",56,0)
 S DGBTFDA(392,DGBTDTI_",",3)=$P(VAEL(1),"^",2)                     ;primary eligibility
"RTN","DGBTSP1",57,0)
 S DGBTFDA(392,DGBTDTI_",",4)=$P(VAEL(3),"^",3)                     ;% of disablility
"RTN","DGBTSP1",58,0)
 S DGBTFDA(392,DGBTDTI_",",6)=$G(DGBTSP("ACCOUNT"))
"RTN","DGBTSP1",59,0)
 S DGBTFDA(392,DGBTDTI_",",11)=DGBTDIVI                             ;division
"RTN","DGBTSP1",60,0)
 ;S DGBTFDA(392,DGBTDTI_",",12)=$P(^VA(200,DUZ,0),"^",1)             ;person who entered claim
"RTN","DGBTSP1",61,0)
 S DGBTFDA(392,DGBTDTI_",",13)=DT                                   ;date claim was entered 
"RTN","DGBTSP1",62,0)
 S DGBTFDA(392,DGBTDTI_",",56)=$G(DGBTSP("CLAIM TYPE"))
"RTN","DGBTSP1",63,0)
 S DGBTFDA(392,DGBTDTI_",",57)=$G(DGBTSP("MODE OF TRANS"))
"RTN","DGBTSP1",64,0)
 S DGBTFDA(392,DGBTDTI_",",58)=$G(DGBTSP("INVOICE NUMBER"))
"RTN","DGBTSP1",65,0)
 S DGBTFDA(392,DGBTDTI_",",59)=$G(DGBTSP("DT INVOICE REC"))
"RTN","DGBTSP1",66,0)
 S DGBTFDA(392,DGBTDTI_",",60)=$G(DGBTSP("TOTAL INVOICE"))
"RTN","DGBTSP1",67,0)
 S DGBTFDA(392,DGBTDTI_",",61)=$G(DGBTSP("BASE RATE FEE"))
"RTN","DGBTSP1",68,0)
 S DGBTFDA(392,DGBTDTI_",",62)=$G(DGBTSP("MILEAGE FEE"))
"RTN","DGBTSP1",69,0)
 S DGBTFDA(392,DGBTDTI_",",63)=$G(DGBTSP("NO SHOW"))
"RTN","DGBTSP1",70,0)
 S DGBTFDA(392,DGBTDTI_",",64)=$G(DGBTSP("WAIT TIME"))
"RTN","DGBTSP1",71,0)
 S DGBTFDA(392,DGBTDTI_",",65)=$G(DGBTSP("EXTRA CREW"))
"RTN","DGBTSP1",72,0)
 S DGBTFDA(392,DGBTDTI_",",66)=$G(DGBTSP("SP EQUIP"))
"RTN","DGBTSP1",73,0)
 S DGBTFDA(392,DGBTDTI_",",67)=$G(DGBTSP("RT/ONE WAY"))
"RTN","DGBTSP1",74,0)
 S DGBTFDA(392,DGBTDTI_",",68)=$G(DGBTSP("TOTAL MILES"))
"RTN","DGBTSP1",75,0)
 S DGBTFDA(392,DGBTDTI_",",69)=$G(DGBTSP("OTHER TRANS REMARKS"))
"RTN","DGBTSP1",76,0)
 S DGBTFDA(392,DGBTDTI_",",70)=$G(DGBTSP("PRE-AUTHORIZED"))
"RTN","DGBTSP1",77,0)
 S DGBTFDA(392,DGBTDTI_",",71)=$G(DGBTSP("VENDOR"))
"RTN","DGBTSP1",78,0)
 S DGBTFDA(392,DGBTDTI_",",72)=$G(DGBTSP("SP MODE OTHER REMARKS"))
"RTN","DGBTSP1",79,0)
 S DGBTFDA(392,DGBTDTI_",",73)=$G(DGBTSP("PLACE OF DEPARTURE "))
"RTN","DGBTSP1",80,0)
 S DGBTFDA(392,DGBTDTI_",",85)=$G(DGBTSP("AUTHORIZED"))
"RTN","DGBTSP1",81,0)
 I $G(DGBTSP("AUTHORIZED"))="Y" D
"RTN","DGBTSP1",82,0)
 .S DGBTFDA(392,DGBTDTI_",",84)=$$GET1^DIQ(200,$G(DUZ),.01)
"RTN","DGBTSP1",83,0)
 .S DGBTFDA(392,DGBTDI_",",86)=$$FMTE^XLFDT(DT)  ;$G(DGBTDT)
"RTN","DGBTSP1",84,0)
 ;
"RTN","DGBTSP1",85,0)
 S DGBTFDA(392,DGBTDTI_",",73)=$G(DGBTSP("PLACE OF DEPARTURE"))
"RTN","DGBTSP1",86,0)
 S DGBTFDA(392,DGBTDTI_",",74)=$G(DGBTSP("PLACE OF DEPARTURE 2"))
"RTN","DGBTSP1",87,0)
 S DGBTFDA(392,DGBTDTI_",",75)=$G(DGBTSP("CITY OF DEPARTURE"))
"RTN","DGBTSP1",88,0)
 S DGBTFDA(392,DGBTDTI_",",76)=$G(DGBTSP("STATE OF DEPARTURE"))
"RTN","DGBTSP1",89,0)
 S DGBTFDA(392,DGBTDTI_",",77)=$G(DGBTSP("ZIP CODE/DEPARTURE"))
"RTN","DGBTSP1",90,0)
 ;
"RTN","DGBTSP1",91,0)
 S DGBTFDA(392,DGBTDTI_",",78)=$G(DGBTINST("DIVISION"))
"RTN","DGBTSP1",92,0)
 S DGBTFDA(392,DGBTDTI_",",79)=$G(DGBTINST("INST NAME"))
"RTN","DGBTSP1",93,0)
 S DGBTFDA(392,DGBTDTI_",",80)=$G(DGBTINST("ADDRESS1"))
"RTN","DGBTSP1",94,0)
 S DGBTFDA(392,DGBTDTI_",",81)=$G(DGBTINST("CITY"))
"RTN","DGBTSP1",95,0)
 S DGBTFDA(392,DGBTDTI_",",82)=$G(DGBTINST("STATE"))
"RTN","DGBTSP1",96,0)
 S DGBTFDA(392,DGBTDTI_",",83)=$G(DGBTINST("ZIP CODE"))
"RTN","DGBTSP1",97,0)
 S DGBTFDA(392,DGBTDTI_",",42)=VADM(1)
"RTN","DGBTSP1",98,0)
 ;
"RTN","DGBTSP1",99,0)
 D FILE^DIE("EKTS","DGBTFDA","ERRMSG")
"RTN","DGBTSP1",100,0)
 I '$D(ERRMSG) W " COMPLETED..." D
"RTN","DGBTSP1",101,0)
 .S DGBTFDA1(392,DGBTDTI_",",12)=DUZ D FILE^DIE(,"DGBTFDA1","ERRMSG")             ;person who entered claim
"RTN","DGBTSP1",102,0)
 .W $$PAUSE^DGBTUTL(0) S (DGBTSP,SPCOMPLETE)=1
"RTN","DGBTSP1",103,0)
 I $D(ERRMSG) W !!,"DATA DID NOT FILE DUE TO ERRORS",!! M ^TMP("DGBTE",$J,DGBTDTI)=ERRMSG S PROMPT="PRESS RETURN TO QUIT AND DELETE THE CLAIM..." D  Q
"RTN","DGBTSP1",104,0)
 .W $$PAUSE^DGBTUTL(PROMPT)
"RTN","DGBTSP1",105,0)
 .S DGBTTOUT=-1,DGBTOLD=0,DGBTDT=DGBTDTI
"RTN","DGBTSP1",106,0)
 .K ^DGBT(392,DGBTDTI,"A")
"RTN","DGBTSP1",107,0)
 .D EXIT2^DGBTE S DGBTSP=0
"RTN","DGBTSP1",108,0)
 S DGBTSP=1,CHZFLG=1
"RTN","DGBTSP1",109,0)
 Q
"RTN","DGBTSP1",110,0)
 ;
"RTN","DGBTSP1",111,0)
INVAMT ;this will ask the dollar amount of any extra fees
"RTN","DGBTSP1",112,0)
 ;
"RTN","DGBTSP1",113,0)
 S DGBTINTO=0
"RTN","DGBTSP1",114,0)
 W !
"RTN","DGBTSP1",115,0)
 S BASERATE=$$GET1^DIQ(392,DGBTDT,61,"E")
"RTN","DGBTSP1",116,0)
 S DIR("A")="BASE RATE FEE: "
"RTN","DGBTSP1",117,0)
 S DIR("?")="Enter the Vendor's Base Rate. Type a Dollar Amount between 1 and 100,000, 2 Decimal Digits"
"RTN","DGBTSP1",118,0)
 S DIR(0)="NA^0:100000:2"
"RTN","DGBTSP1",119,0)
 S BASERATE=$S($G(BASERATE)'="":BASERATE,$G(DGBTSP("BASE RATE FEE"))'="":$G(DGBTSP("BASE RATE FEE")),1:"")
"RTN","DGBTSP1",120,0)
 I BASERATE'="" S DIR("B")=$S($G(BASERATE)'="":BASERATE,$G(DGBTSP("BASE RATE FEE"))'="":$G(DGBTSP("BASE RATE FEE")),1:0)
"RTN","DGBTSP1",121,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I Y=""!($D(DTOUT))!($D(DUOUT)) S DGBTSP=0 Q
"RTN","DGBTSP1",122,0)
 S DGBTSP("BASE RATE FEE")=Y
"RTN","DGBTSP1",123,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",124,0)
 ;
"RTN","DGBTSP1",125,0)
 W !
"RTN","DGBTSP1",126,0)
 S MILEAGEFEE=$$GET1^DIQ(392,DGBTDT,62,"E")
"RTN","DGBTSP1",127,0)
 S DIR("A")="MILEAGE FEE: "
"RTN","DGBTSP1",128,0)
 S DIR("?")="Enter the Vendor's Mileage fee. Type a Dollar Amount between 1 and 10,000, 2 Decimal Digits."
"RTN","DGBTSP1",129,0)
 S DIR(0)="NA^0:10000:2"
"RTN","DGBTSP1",130,0)
 S MILEAGEFEE=$S($G(MILEAGEFEE)'="":MILEAGEFEE,$G(DGBTSP("MILEAGE FEE"))'="":$G(DGBTSP("MILEAGE FEE")),1:"")
"RTN","DGBTSP1",131,0)
 I MILEAGEFEE'="" S DIR("B")=$S($G(MILEAGEFEE)'="":MILEAGEFEE,$G(DGBTSP("MILEAGE FEE"))'="":$G(DGBTSP("MILEAGE FEE")),1:0)
"RTN","DGBTSP1",132,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP1",133,0)
 S DGBTSP("MILEAGE FEE")=Y
"RTN","DGBTSP1",134,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",135,0)
 ;
"RTN","DGBTSP1",136,0)
 W !
"RTN","DGBTSP1",137,0)
 S NOSHOW=$$GET1^DIQ(392,DGBTDT,63,"E")
"RTN","DGBTSP1",138,0)
 S DIR("A")="NO-SHOW/NO-LOAD FEE: "
"RTN","DGBTSP1",139,0)
 S DIR("?")="Type a Dollar Amount between 1 and 1000, 2 Decimal Digits."
"RTN","DGBTSP1",140,0)
 S DIR(0)="FOA^0:1000:2"
"RTN","DGBTSP1",141,0)
 S NOSHOW=$S($G(NOSHOW)'="":NOSHOW,$G(DGBTSP("NO SHOW"))'="":$G(DGBTSP("NO SHOW")),1:"")
"RTN","DGBTSP1",142,0)
 I NOSHOW'="" S DIR("B")=$S($G(NOSHOW)'="":NOSHOW,$G(DGBTSP("NO SHOW"))'="":$G(DGBTSP("NO SHOW")),1:0)
"RTN","DGBTSP1",143,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP1",144,0)
 S DGBTSP("NO SHOW")=Y
"RTN","DGBTSP1",145,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",146,0)
 ;
"RTN","DGBTSP1",147,0)
 W !
"RTN","DGBTSP1",148,0)
 S WAITTIME=$$GET1^DIQ(392,DGBTDT,64,"E")
"RTN","DGBTSP1",149,0)
 S DIR("A")="WAIT TIME FEE: "
"RTN","DGBTSP1",150,0)
 S DIR("?")="Enter the Vendor's fee for waiting. Type a Dollar Amount between 1 and 1000, 2 Decimal Digits."
"RTN","DGBTSP1",151,0)
 S DIR(0)="NOA^0:1000:2"
"RTN","DGBTSP1",152,0)
 S WAITTIME=$S($G(WAITTIME)'="":WAITTIME,$G(DGBTSP("WAIT TIME"))'="":$G(DGBTSP("WAIT TIME")),1:"")
"RTN","DGBTSP1",153,0)
 I WAITTIME'="" S DIR("B")=$S($G(WAITTIME)'="":WAITTIME,$G(DGBTSP("WAIT TIME"))'="":$G(DGBTSP("WAIT TIME")),1:0)
"RTN","DGBTSP1",154,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP1",155,0)
 S DGBTSP("WAIT TIME")=Y
"RTN","DGBTSP1",156,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",157,0)
 ;
"RTN","DGBTSP1",158,0)
 W !
"RTN","DGBTSP1",159,0)
 S EXTRACREW=$$GET1^DIQ(392,DGBTDT,65,"E")
"RTN","DGBTSP1",160,0)
 S DIR("A")="EXTRA CREW FEE: "
"RTN","DGBTSP1",161,0)
 S DIR("?")="Enter the Vendor's extra crew fee. Type a Dollar Amount between 1 and 10,000, 2 Decimal Digits."
"RTN","DGBTSP1",162,0)
 S DIR(0)="NOA^0:10000:2"
"RTN","DGBTSP1",163,0)
 S EXTRACREW=$S($G(EXTRACREW)'="":EXTRACREW,$G(DGBTSP("EXTRA CREW"))'="":$G(DGBTSP("EXTRA CREW")),1:"")
"RTN","DGBTSP1",164,0)
 I EXTRACREW'="" S DIR("B")=$S($G(EXTRACREW)'="":EXTRACREW,$G(DGBTSP("EXTRA CREW"))'="":$G(DGBTSP("EXTRA CREW")),1:0)
"RTN","DGBTSP1",165,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP1",166,0)
 S DGBTSP("EXTRA CREW")=Y
"RTN","DGBTSP1",167,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",168,0)
 ;
"RTN","DGBTSP1",169,0)
 W !
"RTN","DGBTSP1",170,0)
 S SPEQUIP=$$GET1^DIQ(392,DGBTDT,66,"E")
"RTN","DGBTSP1",171,0)
 S DIR("A")="SPECIAL EQUIPMENT FEE: "
"RTN","DGBTSP1",172,0)
 S DIR("?")="Enter the Vendor's fee for additional equipment needed. Type a Dollar Amount between 1 and 5000, 2 Decimal Digits."
"RTN","DGBTSP1",173,0)
 S DIR(0)="NOA^0:5000:2"
"RTN","DGBTSP1",174,0)
 S SPEQUIP=$S($G(SPEQUIP)'="":SPEQUIP,$G(DGBTSP("SP EQUIP"))'="":$G(DGBTSP("SP EQUIP")),1:"")
"RTN","DGBTSP1",175,0)
 I SPEQUIP'="" S DIR("B")=$S($G(SPEQUIP)'="":SPEQUIP,$G(DGBTSP("SP EQUIP"))'="":$G(DGBTSP("SP EQUIP")),1:0)
"RTN","DGBTSP1",176,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I ($D(DTOUT))!($D(DUOUT)) K DGBTSP S DGBTSP=0 Q
"RTN","DGBTSP1",177,0)
 S DGBTSP("SP EQUIP")=Y
"RTN","DGBTSP1",178,0)
 S DGBTINTO=$G(DGBTINTO)+Y
"RTN","DGBTSP1",179,0)
 ;
"RTN","DGBTSP1",180,0)
 W !
"RTN","DGBTSP1",181,0)
 S TOTINVOICE=$$GET1^DIQ(392,DGBTDT,60,"I")
"RTN","DGBTSP1",182,0)
 S DIR("A")="TOTAL INVOICE: "
"RTN","DGBTSP1",183,0)
 S DIR("?")="Type a Dollar Amount between 1 and 127,000, 2 Decimal Digits."
"RTN","DGBTSP1",184,0)
 S DIR(0)="NA^0:127000:2"
"RTN","DGBTSP1",185,0)
 I TOTINVOICE'="" S DIR("B")=$S($G(TOTINVOICE)'="":TOTINVOICE,1:$G(DGBTSP("TOTAL INVOICE")))
"RTN","DGBTSP1",186,0)
 D ^DIR K DIR S:$D(^DGBT(392,DGBTDTI,"SP")) SPCOMPLETE=1 I Y=""!($D(DTOUT))!($D(DUOUT)) S DGBTSP=0 Q
"RTN","DGBTSP1",187,0)
 S DGBTSP("TOTAL INVOICE")=Y
"RTN","DGBTSP1",188,0)
 ;
"RTN","DGBTSP1",189,0)
 Q
"RTN","DGBTSP1",190,0)
 ;
"RTN","DGBTSP1",191,0)
DENREA(DGBTCMTY) ;denial reasons
"RTN","DGBTSP1",192,0)
 ;
"RTN","DGBTSP1",193,0)
 ;S DGBTOACT=$S('$D(^DGBT(392.5,+$P(DGBTVAR(0),"^",6),0)):0,1:+$P(^DGBT(392.3,$P(DGBTVAR(0),"^",6),0),"^",5))
"RTN","DGBTSP1",194,0)
 K X S (DIC("B"),X)="" S DIC("A")="Select Denial Reason:"
"RTN","DGBTSP1",195,0)
 S DIC="^DGBT(392.5,",DIC(0)="AEQMZ" ;,DIC("S")="I $P(^(0),U,3)'>DGBTDT&('$P(^(0),U,4)!($P(^(0),U,4)'<DGBTDT))"
"RTN","DGBTSP1",196,0)
 D ^DIC K DIC I $D(DTOUT) S DGBTTOUT=-1 K DTOUT Q
"RTN","DGBTSP1",197,0)
 S DGBTACTN=$P(Y,"^"),DGBTACCT=$P($G(Y(0)),"^",5)
"RTN","DGBTSP1",198,0)
 ;
"RTN","DGBTSP1",199,0)
 Q
"RTN","DGBTUTL")
0^2^B98577404
"RTN","DGBTUTL",1,0)
DGBTUTL ;ALB/SCK - BENEFICIARY/TRAVEL UTILITY ROUTINES; 1/6/93@1130 ;11/14/11  09:58
"RTN","DGBTUTL",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTUTL",3,0)
START ;
"RTN","DGBTUTL",4,0)
 Q
"RTN","DGBTUTL",5,0)
MILES(DGBTRN,DGBTDX) ;
"RTN","DGBTUTL",6,0)
 ; DGBTRN holds the record no., and DGBTDX holds the division pointer passed in during the function call
"RTN","DGBTUTL",7,0)
 N DGBTML,XX,DGBTCHK
"RTN","DGBTUTL",8,0)
 S XX="",(DGBTML,DGBTDEF)=0
"RTN","DGBTUTL",9,0)
 F XX=0:0 S XX=$O(^DGBT(392.1,DGBTRN,1,XX)) Q:+XX'>0!(DGBTML>0)  D
"RTN","DGBTUTL",10,0)
 . S DGBTCHK=$P($G(^DGBT(392.1,DGBTRN,1,XX,0)),U,1) I DGBTDX=DGBTCHK S DGBTML=$P($G(^(0)),U,2)
"RTN","DGBTUTL",11,0)
 I DGBTML'>0 S DGBTML=$P($G(^DGBT(392.1,DGBTRN,0)),U,3),DGBTDEF=1
"RTN","DGBTUTL",12,0)
 K DGBTRN,DGBTDX
"RTN","DGBTUTL",13,0)
 Q DGBTML
"RTN","DGBTUTL",14,0)
DICLKUP(DGBTRN,DGBTDX,DGBTP) ;
"RTN","DGBTUTL",15,0)
 N RETURN,XX
"RTN","DGBTUTL",16,0)
 S DIC="^DGBT(392.1,DGBTRN,1,",DIC(0)="MZX",X=DGBTDX,RETURN=""
"RTN","DGBTUTL",17,0)
 D ^DIC
"RTN","DGBTUTL",18,0)
 I +Y>0 D
"RTN","DGBTUTL",19,0)
 . I DGBTP=4 S RETURN=$S(+$P($G(Y(0)),U,4)>0:$P($G(Y(0)),U,5),1:"")
"RTN","DGBTUTL",20,0)
 . I DGBTP=3 S RETURN=$S(+$P($G(Y(0)),U,3)>0:$P(^(0),U,3),1:0)
"RTN","DGBTUTL",21,0)
 Q RETURN
"RTN","DGBTUTL",22,0)
DEPCTY(ZIPCDE) ;
"RTN","DGBTUTL",23,0)
 N RETURN
"RTN","DGBTUTL",24,0)
 S DIC="^DGBT(392.1,",DIC(0)="MZ",X=$S($L(ZIPCDE)>5:$E(ZIPCDE,1,5),1:ZIPCDE) D ^DIC S RETURN=Y K DIC
"RTN","DGBTUTL",25,0)
 K ZIPCDE
"RTN","DGBTUTL",26,0)
 Q RETURN
"RTN","DGBTUTL",27,0)
 ;
"RTN","DGBTUTL",28,0)
DWAIVER(DFN,DGBTDCV,CLIEN) ;Get Deductible Waiver ***PAVEL
"RTN","DGBTUTL",29,0)
 ;DFN - Patient IEN
"RTN","DGBTUTL",30,0)
 ;DGBTDCV - Deductible amount
"RTN","DGBTUTL",31,0)
 ;CLIEN - Ien of current BT Claim
"RTN","DGBTUTL",32,0)
 N VAEL,DGBTMW,EXIT,DGBTRDV
"RTN","DGBTUTL",33,0)
 S EXIT=0
"RTN","DGBTUTL",34,0)
 ;added by bld to correct problem with manual waiver's
"RTN","DGBTUTL",35,0)
 I $D(DGBTRET(0)),$P(DGBTRET(0),"^",6)="MAN" Q "0^Manual Waiver"
"RTN","DGBTUTL",36,0)
 I $D(^DGBT(392.7,"C",DFN)) D  Q:EXIT "0^Manual Waiver"
"RTN","DGBTUTL",37,0)
 .S EXIT=0,DGBTMW=CLIEN+0.00001
"RTN","DGBTUTL",38,0)
 .F  S DGBTMW=$O(^DGBT(392.7,"C",DFN,DGBTMW),-1) Q:'DGBTMW!EXIT  D
"RTN","DGBTUTL",39,0)
 ..Q:$P(^DGBT(392.7,DGBTMW,0),"^",3)'=1      ;Waiver not Authorized
"RTN","DGBTUTL",40,0)
 ..Q:$D(^DGBT(392.7,DGBTMW,"DEL"))     ;Waiver deleted
"RTN","DGBTUTL",41,0)
 ..I $P(^DGBT(392.7,DGBTMW,0),"^",7)="PENSION" S EXIT=1 Q      ;Waiver never expire
"RTN","DGBTUTL",42,0)
 ..Q:$P(CLIEN,".",1)>$P(^DGBT(392.7,DGBTMW,0),"^",7)      ;Waiver expired
"RTN","DGBTUTL",43,0)
 ..S EXIT=1       ;Waiver found.
"RTN","DGBTUTL",44,0)
 .Q
"RTN","DGBTUTL",45,0)
 D ELIG^VADPT
"RTN","DGBTUTL",46,0)
 I $$WVELG^DGBT1 Q "0^VA Pension"
"RTN","DGBTUTL",47,0)
 I $P(DGBTINC,U,2)="H" Q "0^Alt Income Hardship"
"RTN","DGBTUTL",48,0)
 I $P(DGBTINC,U,2)="P" Q "0^Alt Income POW"
"RTN","DGBTUTL",49,0)
 I $G(DAYFLG)&('$G(DGBTREF))&(DGBTNSC)&($P($G(DGBTINC),"^",1)'="")&(+$TR($P(DGBTINC,U),"$,","")<DGBTRXTH) Q "0^NSC Low Income"
"RTN","DGBTUTL",50,0)
 I $G(DGBTREF)&(DGBTNSC) Q "0^Patient refuse to provide financial information"
"RTN","DGBTUTL",51,0)
 I '$G(DAYFLG) Q "0^Patient has expired Means Test or Co-Pay Test"
"RTN","DGBTUTL",52,0)
 ;Output:
"RTN","DGBTUTL",53,0)
 ;VAEL(4) If the VETERAN (Y/N)? field is YES, a "1" will be returned; otherwise, a "0" will be returned. (e.g., 1)
"RTN","DGBTUTL",54,0)
 I 'VAEL(4) Q "0^NO Veteran"
"RTN","DGBTUTL",55,0)
 N INCOME,X0,X1,X2,XX,MTEST
"RTN","DGBTUTL",56,0)
 N VAMB D MB^VADPT
"RTN","DGBTUTL",57,0)
 N LI
"RTN","DGBTUTL",58,0)
 ;Output:
"RTN","DGBTUTL",59,0)
 ;VAMB(1) A&A BENEFITS? field is YES, a "1" will be returned in the first piece; otherwise, a "0".
"RTN","DGBTUTL",60,0)
 ; If receiving A&A benefits, the TOTAL ANNUAL VA CHECK AMOUNT will be returned in the second piece. (e.g., 1^1000)
"RTN","DGBTUTL",61,0)
 ;VAMB(2) HOUSEBOUND BENEFITS? field is YES, a "1" will be returned in the first piece; otherwise, a "0".
"RTN","DGBTUTL",62,0)
 ; If receiving housebound benefits, the TOTAL ANNUAL VA CHECK AMOUNT will be returned in the second piece.
"RTN","DGBTUTL",63,0)
 ;(e.g., 1^0) ;VAMB(4) VA PENSION? field is YES, a "1" will be returned in the first piece; otherwise, a "0" .
"RTN","DGBTUTL",64,0)
 ; If receiving a VA pension, the TOTAL ANNUAL VA CHECK AMOUNT will be returned in the second piece. (e.g., 1^563.23)
"RTN","DGBTUTL",65,0)
 I VAMB(4),VAMB(1) Q "0^VA Pension and A&A"
"RTN","DGBTUTL",66,0)
 I VAMB(4),VAMB(2) Q "0^VA Pension and HB"
"RTN","DGBTUTL",67,0)
 I VAMB(4) Q "0^VA Pension"
"RTN","DGBTUTL",68,0)
 ;Is the mode of transportation :Common Carrier ?
"RTN","DGBTUTL",69,0)
 S LI=0
"RTN","DGBTUTL",70,0)
 I '$G(DGBTREF) S XX=$$LI(DFN,DGBTDTI,DGBTDEP,,DGBTINCA) ;Get Low Income + Hardship
"RTN","DGBTUTL",71,0)
 I $G(DGBTMLT)=0 S XX=0
"RTN","DGBTUTL",72,0)
 I '$G(XX),$G(DGBTCCMODE)'="",$G(DGBTCCREQ),$G(DGBTMLT) Q "0^Mode of transportation is Common Carrier/With Mileage"
"RTN","DGBTUTL",73,0)
 I '$G(XX),$G(DGBTCCMODE)'="",$G(DGBTCCREQ) Q "0^Mode of transportation is Common Carrier"
"RTN","DGBTUTL",74,0)
 Q $S(+$G(XX):"0^"_$P($G(XX),U,2),1:DGBTDCV)
"RTN","DGBTUTL",75,0)
 ;
"RTN","DGBTUTL",76,0)
GA(DFN,AA,DGBTDTI,AB) ;Get Alternate Income on file
"RTN","DGBTUTL",77,0)
 ;@AA= 0^    = no Valid Alternate Income
"RTN","DGBTUTL",78,0)
 ;@AA= 1^Alt Income^Date Alt. Income Entered^Reason: Hardship or POW^Expiration date
"RTN","DGBTUTL",79,0)
 ;@AB(I)=1^Alt Income^Date Alt. Income Entered^Reason: Hardship or POW^Expiration date   - Expire income
"RTN","DGBTUTL",80,0)
 ;Example:  @AA=1^7777.7^3120501.203728^H^3121231
"RTN","DGBTUTL",81,0)
 ;FDA(392.9,"7171872,",.01,"I")="7171872"
"RTN","DGBTUTL",82,0)
 ;FDA(392.91,"3120423.211054,7171872,",.01,"I")=3120423.211054
"RTN","DGBTUTL",83,0)
 ;FDA(392.91,"3120423.211054,7171872,",1,"I")=12345.67
"RTN","DGBTUTL",84,0)
 ;FDA(392.91,"3120423.211054,7171872,",2,"I")="H"
"RTN","DGBTUTL",85,0)
 ;FDA(392.91,"3120423.211054,7171872,",3,"I")=3121231
"RTN","DGBTUTL",86,0)
 N FDA,X0,X,Y,I,FDD,AC
"RTN","DGBTUTL",87,0)
 S @AA="0^" ;S XX(3)="0^"
"RTN","DGBTUTL",88,0)
 D GETS^DIQ(392.9,DFN_",","**","I","FDA","DGBTERR")
"RTN","DGBTUTL",89,0)
 S X0=$G(FDA(392.9,DFN_",",.01,"I"))
"RTN","DGBTUTL",90,0)
 Q:'$L(X0)!'$G(DGBTDTI)
"RTN","DGBTUTL",91,0)
 S X0="" F  S X0=$O(FDA(392.91,X0)) Q:'$L(X0)  S X=$P(X0,",",1) M FDD(392.91,X)=FDA(392.91,X0)
"RTN","DGBTUTL",92,0)
 S X0=DGBTDTI+0.000001
"RTN","DGBTUTL",93,0)
 F  S X0=$O(FDD(392.91,X0),-1) Q:'X0  D  Q:+@AA  ;Quit If Alternate income found
"RTN","DGBTUTL",94,0)
 .Q:DGBTDTI>$G(FDD(392.91,X0,3,"I"))  ;Alternate Income Expired continue search
"RTN","DGBTUTL",95,0)
 .S @AA="1^"_$G(FDD(392.91,X0,1,"I"))_U_X0_U_$G(FDD(392.91,X0,2,"I"))_U_$G(FDD(392.91,X0,3,"I"))
"RTN","DGBTUTL",96,0)
 .K FDD(392.91,X0)
"RTN","DGBTUTL",97,0)
 I $D(FDD),$L($G(AB)) D
"RTN","DGBTUTL",98,0)
 .S AB=$S($E(AB,$L(AB))=")":$E(AB,1,$L(AB)-1)_",",1:AB_"(")
"RTN","DGBTUTL",99,0)
 .S X0=0 F I=1:1 S X0=$O(FDD(392.91,X0)) Q:'X0  S AC=AB_I_")",@AC="1^"_$G(FDD(392.91,X0,1,"I"))_U_X0_U_$G(FDD(392.91,X0,2,"I"))_U_$G(FDD(392.91,X0,3,"I"))
"RTN","DGBTUTL",100,0)
 Q
"RTN","DGBTUTL",101,0)
LI(DFN,DGBTDTI,DGBTDEP,FLAG,DGBTINCA) ;Low Income
"RTN","DGBTUTL",102,0)
 ;DGBTDEP = # of Dependence
"RTN","DGBTUTL",103,0)
 ;FLAG = 1 Indication if printable Income value returned in DGBTINC and Income Type Type in DGBTIFL
"RTN","DGBTUTL",104,0)
 ;DGBTINCA = Possible Alternate income set for the VA Patient
"RTN","DGBTUTL",105,0)
 ;             1^alt income^date^alt. income reason POW or HARDSHIP^expiration date
"RTN","DGBTUTL",106,0)
 ;DGBTRET = RETURN VALUE:
"RTN","DGBTUTL",107,0)
 ;           0^
"RTN","DGBTUTL",108,0)
 ;           1^Low Income Copay
"RTN","DGBTUTL",109,0)
 ;           2^Low Income M Test
"RTN","DGBTUTL",110,0)
 ;           3^Alt. Income POW
"RTN","DGBTUTL",111,0)
 ;           4^Alt. Income Hardship
"RTN","DGBTUTL",112,0)
 N INCOME,X,X0,X2,X3,Y,MTEST,DGBTRET
"RTN","DGBTUTL",113,0)
 S DGBTRET="0^"
"RTN","DGBTUTL",114,0)
 I $G(DGBTREF) Q DGBTRET
"RTN","DGBTUTL",115,0)
 I '$G(DAYFLG) Q DGBTRET
"RTN","DGBTUTL",116,0)
 I '$G(FLAG) N DGBTINC,DGBTIFL
"RTN","DGBTUTL",117,0)
 S DGBTINCA=$G(DGBTINCA,"0^")
"RTN","DGBTUTL",118,0)
 S (Y,INCOME)=$$INCOME^VAFMON(DFN,DGBTDTI,1)
"RTN","DGBTUTL",119,0)
 I '$G(DGBTDYFL) S (Y,INCOME)="0^"
"RTN","DGBTUTL",120,0)
 S:DGBTINCA (Y,INCOME)=$P(DGBTINCA,U,2)_U_$E($P(DGBTINCA,U,4))
"RTN","DGBTUTL",121,0)
 S X=$P(Y,U),DGBTIFL=$P(Y,U,2) ; returns income & source.
"RTN","DGBTUTL",122,0)
 I DGBTIFL["I^V" S (DGBTINC,DGBTIFL,X,Y)="" Q DGBTRET ;Ignore if Income type is I or V
"RTN","DGBTUTL",123,0)
 I X?1N.E!(X<0) D
"RTN","DGBTUTL",124,0)
 .I X<0 S X=0
"RTN","DGBTUTL",125,0)
 .S X2="0$",X3=8 D COMMA^%DTC
"RTN","DGBTUTL",126,0)
 S DGBTINC=X_U_$G(DGBTIFL)
"RTN","DGBTUTL",127,0)
 I $G(DGBTINCA) Q $S($P(DGBTINCA,U,4)="P":"3^Alt. Income POW",1:"4^Alt. Income Hardship")
"RTN","DGBTUTL",128,0)
 I $P(INCOME,U,2)="C" D  Q:$G(DGBTRET) $G(DGBTRET)  ;Copay income
"RTN","DGBTUTL",129,0)
 .S INCOME=+$G(INCOME)
"RTN","DGBTUTL",130,0)
 .I $G(DGBTRXTH),'($G(INCOME)>$G(DGBTRXTH)) S DGBTRET="1^Low Income Copay"
"RTN","DGBTUTL",131,0)
 ;Get the patient Means Test for corresponding data and see if patient is M-test Low Income.
"RTN","DGBTUTL",132,0)
 S MTEST=+$$LST^DGMTU(DFN,DGBTDTI,1) Q:'MTEST DGBTRET ;Get last Means test
"RTN","DGBTUTL",133,0)
 I $G(DGBTRXTH),'($G(INCOME)>$G(DGBTRXTH)) Q "2^Low Income M Test"                                ;change by bld 10/9/2012@2346
"RTN","DGBTUTL",134,0)
 Q $G(DGBTRET)
"RTN","DGBTUTL",135,0)
 ;
"RTN","DGBTUTL",136,0)
EXIT ;
"RTN","DGBTUTL",137,0)
 Q
"RTN","DGBTUTL",138,0)
TEST ;
"RTN","DGBTUTL",139,0)
 W !,"DATE/TIME REQUIRED.."
"RTN","DGBTUTL",140,0)
 S X="OLD",DTOUT=1
"RTN","DGBTUTL",141,0)
 Q
"RTN","DGBTUTL",142,0)
 ;
"RTN","DGBTUTL",143,0)
ABP(DGBTU) ;Function returns date if patient has an active bus pass. Function added in patch 20
"RTN","DGBTUTL",144,0)
 N DATE,IEN,EXPDT
"RTN","DGBTUTL",145,0)
 S DATE=0,IEN=0,EXPDT=0
"RTN","DGBTUTL",146,0)
 F  S DATE=$O(^DGBT(392,"AI",DGBTU,DATE)) Q:'+DATE  S IEN=^DGBT(392,"AI",DGBTU,DATE) I $D(^DGBT(392,IEN,"B"))&($P($G(^DGBT(392,IEN,"B")),U,2)'<DT) S EXPDT=$P(^("B"),U,2) Q
"RTN","DGBTUTL",147,0)
 Q EXPDT
"RTN","DGBTUTL",148,0)
 ;
"RTN","DGBTUTL",149,0)
MHELP ;help text for Mileage/One Way field. Field 32 file 392.
"RTN","DGBTUTL",150,0)
 ;
"RTN","DGBTUTL",151,0)
 ;
"RTN","DGBTUTL",152,0)
 W !,?5,"If patient used a common carrier, then the mileage entered here would be"
"RTN","DGBTUTL",153,0)
 W !,?5,"only the mileage needed to get to the common carrier pick up point.",!
"RTN","DGBTUTL",154,0)
 Q
"RTN","DGBTUTL",155,0)
 ;
"RTN","DGBTUTL",156,0)
PAUSE(EXCEL) ;
"RTN","DGBTUTL",157,0)
 ;
"RTN","DGBTUTL",158,0)
 N DIR,PROMPT,PROMPT1,PROMPT2,PROMPT3
"RTN","DGBTUTL",159,0)
 K Y
"RTN","DGBTUTL",160,0)
 S EXCEL=$G(EXCEL)
"RTN","DGBTUTL",161,0)
 S PROMPT1="REPORT HAS FINISHED, "
"RTN","DGBTUTL",162,0)
 I IOST'["C-" S DGBTQ=1 W !!!,PROMPT1 Q ""                                ;quit if sent to a printer
"RTN","DGBTUTL",163,0)
 S PROMPT2="TURN OFF CAPTURE, THEN "
"RTN","DGBTUTL",164,0)
 S PROMPT3="PRESS RETURN TO CONTINUE OR '^' TO STOP...."
"RTN","DGBTUTL",165,0)
 I EXCEL S PROMPT=PROMPT1_PROMPT2_PROMPT3
"RTN","DGBTUTL",166,0)
 I 'EXCEL S PROMPT=PROMPT3
"RTN","DGBTUTL",167,0)
 W !
"RTN","DGBTUTL",168,0)
 S DIR("A")=PROMPT,DIR(0)="FAO" D ^DIR
"RTN","DGBTUTL",169,0)
 Q Y
"RTN","DGBTUTL",170,0)
 ;
"RTN","DGBTUTL",171,0)
YESNO(PROMPT) ;
"RTN","DGBTUTL",172,0)
 ;
"RTN","DGBTUTL",173,0)
 K DTOUT,DUOUT,DIRUT,DIROUT
"RTN","DGBTUTL",174,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("?")="ENTER Y(ES) OR N(O)"
"RTN","DGBTUTL",175,0)
 I $G(PROMPT)'="" S DIR("A")=PROMPT
"RTN","DGBTUTL",176,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) Q 0
"RTN","DGBTUTL",177,0)
 Q Y
"RTN","DGBTUTL",178,0)
 ;
"RTN","DGBTUTL",179,0)
DEVICE(RPTNAM,ROUTINE,DGBTEXCEL,COLWID) ;common device call for DGBT reports
"RTN","DGBTUTL",180,0)
 ;
"RTN","DGBTUTL",181,0)
 N %ZIS,ZTSK,ZTRTN,ZTIO,ZTDESC,ZTSAVE,POP,ZTQUEUED
"RTN","DGBTUTL",182,0)
 ; RPTNAM = NAME OF DGBT REPORT BEING RUN
"RTN","DGBTUTL",183,0)
 ; ROUTINE = "TAG^ROUTINE"
"RTN","DGBTUTL",184,0)
 ;
"RTN","DGBTUTL",185,0)
 S DGBTQ1=0
"RTN","DGBTUTL",186,0)
 S %ZIS="PQM"
"RTN","DGBTUTL",187,0)
 D ^%ZIS
"RTN","DGBTUTL",188,0)
 I POP S DGBTQ=1 Q
"RTN","DGBTUTL",189,0)
 I IOST["C-" D  Q  ;
"RTN","DGBTUTL",190,0)
 .N X I IOM=255,$D(^%ZOSF("RM")) S (X,IOM)=512 X ^%ZOSF("RM")
"RTN","DGBTUTL",191,0)
 ;Check for exit
"RTN","DGBTUTL",192,0)
 I $G(IO("Q"))  D  S DGBTQ=1
"RTN","DGBTUTL",193,0)
  .S ZTRTN=ROUTINE
"RTN","DGBTUTL",194,0)
 .S ZTDESC="BT REPORT: "_RPTNAM
"RTN","DGBTUTL",195,0)
 .S ZTSAVE("*")=""
"RTN","DGBTUTL",196,0)
 .D ^%ZTLOAD
"RTN","DGBTUTL",197,0)
 .W !,$S($D(ZTSK):"REQUEST QUEUED TASK="_ZTSK,1:"REQUEST CANCELLED")
"RTN","DGBTUTL",198,0)
 .D HOME^%ZIS K IO("Q")
"RTN","DGBTUTL",199,0)
 Q
"RTN","DGBTUTL",200,0)
 ;
"RTN","DGBTUTL",201,0)
SELEXCEL() ; - Returns whether to capture data for Excel report.
"RTN","DGBTUTL",202,0)
 ; Output: EXCEL = 1 - YES (capture data) / 0 - NO (DO NOT capture data)
"RTN","DGBTUTL",203,0)
 ;
"RTN","DGBTUTL",204,0)
 N EXCEL,DIR,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","DGBTUTL",205,0)
 ;
"RTN","DGBTUTL",206,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("T")=DTIME W !
"RTN","DGBTUTL",207,0)
 S DIR("A")="Do you want to capture report data for an Excel document"
"RTN","DGBTUTL",208,0)
 S DIR("?")="^D HEXC^DGBTUTL"
"RTN","DGBTUTL",209,0)
 D ^DIR K DIR I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) Q "^"
"RTN","DGBTUTL",210,0)
 K DIROUT,DTOUT,DUOUT,DIRUT
"RTN","DGBTUTL",211,0)
 S EXCEL=0 I Y S EXCEL=1
"RTN","DGBTUTL",212,0)
 ;
"RTN","DGBTUTL",213,0)
 ;Display Excel display message
"RTN","DGBTUTL",214,0)
 I EXCEL=1 D EXMSG
"RTN","DGBTUTL",215,0)
 ;
"RTN","DGBTUTL",216,0)
 Q EXCEL
"RTN","DGBTUTL",217,0)
 ;
"RTN","DGBTUTL",218,0)
HEXC ; - 'Do you want to capture data...' prompt
"RTN","DGBTUTL",219,0)
 W !!,"      Enter:  'Y'    -  To capture detail report data to transfer"
"RTN","DGBTUTL",220,0)
 W !,"                        to an Excel document"
"RTN","DGBTUTL",221,0)
 W !,"              '<CR>' -  To skip this option"
"RTN","DGBTUTL",222,0)
 W !,"              '^'    -  To quit this option"
"RTN","DGBTUTL",223,0)
 Q
"RTN","DGBTUTL",224,0)
 ;
"RTN","DGBTUTL",225,0)
PRINTMSG ;common help message if user selects a printer
"RTN","DGBTUTL",226,0)
 ;
"RTN","DGBTUTL",227,0)
 W !!,"WARNING - THIS REPORT REQUIRES THAT A DEVICE WITH ",COLWID," COLUMN WIDTH BE USED."
"RTN","DGBTUTL",228,0)
 W !,"IT WILL NOT DISPLAY CORRECTLY USING 80 COLUMN WIDTH DEVICES",!
"RTN","DGBTUTL",229,0)
 Q
"RTN","DGBTUTL",230,0)
 ;
"RTN","DGBTUTL",231,0)
EXMSG ;common help message if user selects Excel option
"RTN","DGBTUTL",232,0)
 W !!?5,"Before continuing, please set up your terminal to capture the"
"RTN","DGBTUTL",233,0)
 W !?5,"detail report data. On some terminals, this can  be  done  by"
"RTN","DGBTUTL",234,0)
 W !?5,"clicking  on the 'Tools' menu above, then click  on  'Capture"
"RTN","DGBTUTL",235,0)
 W !?5,"Incoming  Data' to save to  Desktop. This  report  may take a"
"RTN","DGBTUTL",236,0)
 W !?5,"while to run."
"RTN","DGBTUTL",237,0)
 W !!?5,"Note: To avoid  undesired  wrapping of the data  saved to the"
"RTN","DGBTUTL",238,0)
 W !?5,"      file, please enter '0;512;999' at the 'DEVICE:' prompt.",!
"RTN","DGBTUTL",239,0)
 Q
"RTN","DGBTUTL",240,0)
 ;
"RTN","DGBTUTL",241,0)
RDV(DGBTRDV,DGBTDTI) ;this will process the remote sites for visits during current month.
"RTN","DGBTUTL",242,0)
 ;
"RTN","DGBTUTL",243,0)
 q
"RTN","DGBTUTL",244,0)
 N DGBTIEN,CURDATE,LASTVISIT
"RTN","DGBTUTL",245,0)
 S DGBTIEN=0
"RTN","DGBTUTL",246,0)
 S CLMMONTH=$E(DGBTDTI,1,5)
"RTN","DGBTUTL",247,0)
 F  S DGBTIEN=$O(DGBTRDV(DGBTIEN)) Q:DGBTIEN=""  D
"RTN","DGBTUTL",248,0)
 .S VISITDATA=DGBTRDV(DGBTIEN)
"RTN","DGBTUTL",249,0)
 .S LASTVISIT=$E($P(VISITDATA,"^",3),1,5)
"RTN","DGBTUTL",250,0)
 .Q:LASTVISIT'=CLMMONTH
"RTN","DGBTUTL",251,0)
 ;
"RTN","DGBTUTL",252,0)
 Q
"RTN","DGBTUTL",253,0)
NMRNG(PATNAME,SNAME,ENAME,RESULT) ;
"RTN","DGBTUTL",254,0)
 I (SNAME="AAA"),(ENAME="ZZZ") Q 1
"RTN","DGBTUTL",255,0)
 N DONE,I,LEN1,LEN2,PNAM
"RTN","DGBTUTL",256,0)
 S PNAM=$$UP^XLFSTR(PATNAME)
"RTN","DGBTUTL",257,0)
 I '$$SNAM(PNAM,$$UP^XLFSTR(SNAME)) Q 0
"RTN","DGBTUTL",258,0)
 Q $$ENAM(PNAM,$$UP^XLFSTR(ENAME))
"RTN","DGBTUTL",259,0)
SNAM(PNAM,SNAM) ;
"RTN","DGBTUTL",260,0)
 I SNAM="AAA" Q 1
"RTN","DGBTUTL",261,0)
 S LEN1=$L(PNAM),LEN2=$L(SNAM),DONE=0
"RTN","DGBTUTL",262,0)
 F I=1:1:$S(LEN1<LEN2:LEN1,1:LEN2) D  Q:DONE
"RTN","DGBTUTL",263,0)
 .I $E(PNAM,I)]$E(SNAM,I) S DONE=1 Q
"RTN","DGBTUTL",264,0)
 .I $E(PNAM,I)=$E(SNAM,I) Q
"RTN","DGBTUTL",265,0)
 .S RESULT=0,DONE=1
"RTN","DGBTUTL",266,0)
 Q RESULT
"RTN","DGBTUTL",267,0)
ENAM(PNAM,ENAM) ;
"RTN","DGBTUTL",268,0)
 I ENAM="ZZZ" Q 1
"RTN","DGBTUTL",269,0)
 S LEN1=$L(PNAM),LEN2=$L(ENAM),DONE=0
"RTN","DGBTUTL",270,0)
 F I=1:1:$S(LEN1<LEN2:LEN1,1:LEN2) D  Q:DONE
"RTN","DGBTUTL",271,0)
 .I $E(ENAM,I)]$E(PNAM,I) S DONE=1 Q
"RTN","DGBTUTL",272,0)
 .I $E(ENAM,I)=$E(PNAM,I) Q
"RTN","DGBTUTL",273,0)
 .S RESULT=0,DONE=1
"RTN","DGBTUTL",274,0)
 Q RESULT
"RTN","DGBTUTL",275,0)
 ;
"RTN","DGBTUTL",276,0)
DRDV(DFN,DGBTDCV,DGBTDTI,DLM) ;Used in remote data view to get local Deductible
"RTN","DGBTUTL",277,0)
 N I,DGBTDCM
"RTN","DGBTUTL",278,0)
 S DLM=$G(DLM,";") ;Output Delimiter
"RTN","DGBTUTL",279,0)
 S DGBTDCM=0 ;Cumulative of Deductible
"RTN","DGBTUTL",280,0)
 ;Get Ded. paid.
"RTN","DGBTUTL",281,0)
 S I=$E(DGBTDTI,1,5)_"00.2399"
"RTN","DGBTUTL",282,0)
 F  S I=$O(^DGBT(392,"C",DFN,I)) Q:'I!($E(I,1,5)>$E(DGBTDT,1,5))  S:$P($G(^DGBT(392,I,1)),U,2)'=15 DGBTDCM=DGBTDCM+($P(^DGBT(392,I,0),"^",9))
"RTN","DGBTUTL",283,0)
 S I=$$DWAIVER(DFN,DGBTDCV,DGBTDTI)
"RTN","DGBTUTL",284,0)
 ;Q Site;Ded paid;0 if ded reset to 0; Why deductible reset to 0 
"RTN","DGBTUTL",285,0)
 Q $G(DUZ(2))_DLM_DGBTDCM_DLM_$P(I,U,1)_DLM_$P(I,U,2)
"RTN","DGBTUTL",286,0)
 Q
"RTN","DGBTUTL",287,0)
 ;
"RTN","DGBTUTL",288,0)
NSC() ;
"RTN","DGBTUTL",289,0)
 I VAEL(1)["NSC" Q 1
"RTN","DGBTUTL",290,0)
 N HIT
"RTN","DGBTUTL",291,0)
 S (HIT,I)=""
"RTN","DGBTUTL",292,0)
 F  S I=$O(VAEL(1,I)) Q:I=""  D  Q:HIT
"RTN","DGBTUTL",293,0)
 .I VAEL(1,I)["NSC" S HIT=1
"RTN","DGBTUTL",294,0)
 Q HIT
"RTN","DGBTUTL",295,0)
 ;
"RTN","DGBTUTL",296,0)
DAYFLAG() ; See if we have a valid income test
"RTN","DGBTUTL",297,0)
 N MTIEN,STATUS
"RTN","DGBTUTL",298,0)
 S MTIEN=$O(^DGMT(408.31,"C",DFN,""),-1)
"RTN","DGBTUTL",299,0)
 I MTIEN="" Q 0
"RTN","DGBTUTL",300,0)
 S STATUS=$P($$MTS^DGMTU(DFN,$$GET1^DIQ(408.31,MTIEN,.03,"I")),U,2)
"RTN","DGBTUTL",301,0)
 I (STATUS?1A)&("LN"[STATUS) Q 0
"RTN","DGBTUTL",302,0)
 Q $$FMDIFF^XLFDT($P(DGBTDTI,"."),$$GET1^DIQ(408.31,MTIEN,.01,"I"))'>365
"RTN","DGBTUTL1")
0^15^B40695224
"RTN","DGBTUTL1",1,0)
DGBTUTL1 ;PAV - BENEFICIARY/TRAVEL UTILITY ROUTINES; 1/6/93@1130 ;11/14/11  09:58
"RTN","DGBTUTL1",2,0)
 ;;1.0;Beneficiary Travel;**20**;September 25, 2001;Build 185
"RTN","DGBTUTL1",3,0)
ELIG(DFN) ;***PAVEL
"RTN","DGBTUTL1",4,0)
 ;IBARXEU1 = DBIA1046
"RTN","DGBTUTL1",5,0)
 ;DFN - Patient IEN
"RTN","DGBTUTL1",6,0)
 ;The BT System must correctly determine if a veteran is eligible for BT reimbursement.  
"RTN","DGBTUTL1",7,0)
 ;There are several checks that the BT System must be modified to automatically make 
"RTN","DGBTUTL1",8,0)
 ;when determin;ing a veteran's eligibility, as well as several checks that require input from the user.
"RTN","DGBTUTL1",9,0)
 ;When the BT user starts a claim, the BT System must be modified to perform the following checks automatically:
"RTN","DGBTUTL1",10,0)
 D SETC     ;Setting entries in file 492.41
"RTN","DGBTUTL1",11,0)
 N VAEL,DGBTX D ELIG^VADPT
"RTN","DGBTUTL1",12,0)
 S DGBTX=0
"RTN","DGBTUTL1",13,0)
 ;a)    If the veteran is Service Connected 30% or greater they are eligible for BT reimbursement.
"RTN","DGBTUTL1",14,0)
 I $G(VAEL(3)),$P(VAEL(3),U,2)>29 D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+1),";;",2)) ;"1^SC 30% or greater"
"RTN","DGBTUTL1",15,0)
 I $P(DGBTINC,U,2)="H" D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+18),";;",2))
"RTN","DGBTUTL1",16,0)
 I $P(DGBTINC,U,2)="P" D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+19),";;",2))
"RTN","DGBTUTL1",17,0)
 ;b)    If the veteran receives a VA pension they are eligible for BT reimbursement.
"RTN","DGBTUTL1",18,0)
 I $$WVELG^DGBT1 D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+2),";;",2)) ;"2^Recipient of VA Pension"
"RTN","DGBTUTL1",19,0)
 I '$G(DGBTREF)&(DGBTNSC)&($P(DGBTINC,"^",1)'="")&(+$TR($P(DGBTINC,U),"$,","")<DGBTRXTH)&(DGBTDYFL) D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+16),";;",2))
"RTN","DGBTUTL1",20,0)
 I '$G(DGBTREF)&(+$P($G(VAEL(3)),U)&(+$P($G(VAEL(3)),U,2)<30)) D  I $G(DGBTX) Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+17),";;",2))
"RTN","DGBTUTL1",21,0)
 .I ($P(DGBTINC,"^",1)'="")&(+$TR($P(DGBTINC,U),"$,","")<DGBTRXTH)&('DGBTNSC)&(DGBTDYFL) S DGBTX=$T D QUALQUES
"RTN","DGBTUTL1",22,0)
 N VAMB D MB^VADPT
"RTN","DGBTUTL1",23,0)
 I VAMB(4) D QUALQUES Q $S($G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:$P($T(BTC+2),";;",2)) ;"2^Recipient of VA Pension"
"RTN","DGBTUTL1",24,0)
 ;c)    If the veteran is below the Low Income Eligibility thresholds based upon his current Means Test or Rx Co-pay test 
"RTN","DGBTUTL1",25,0)
 ;      they are eligible for BT reimbursement.
"RTN","DGBTUTL1",26,0)
 N XX,LI
"RTN","DGBTUTL1",27,0)
 S LI="0^"
"RTN","DGBTUTL1",28,0)
 I 'DGBTREF&($P(DGBTINC,"^",1)'="") S LI=$$LI^DGBTUTL(DFN,DGBTDTI,DGBTDEP,,DGBTINCA)
"RTN","DGBTUTL1",29,0)
 I LI D QUALQUES S XX=$S(+LI:$P($T(BTC+(LI+2)),";;",2),$G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:0) Q:XX XX
"RTN","DGBTUTL1",30,0)
 ;$G(DGBTELL)=14:$P($T(BTC+14),";;",2),$G(DGBTELL)=15:$P($T(BTC+15),";;",2),1:
"RTN","DGBTUTL1",31,0)
 ;
"RTN","DGBTUTL1",32,0)
 ;d)    The.  Service Connected (SC) appointment. If it can be determined that the veteran is travelling for a SC appointment 
"RTN","DGBTUTL1",33,0)
 ;      then they are eligible for BT reimbursement.  NOTE: the data in PCE may not always be complete.  If BT is unable 
"RTN","DGBTUTL1",34,0)
 ;      to automatically determine if the travel is SC related then BT may need to ask the user to perform this step manually (see step f).
"RTN","DGBTUTL1",35,0)
 ;e)    The BT System must check the PCE System in VistA to see if the patient is travelling for a Comp and Pension (C&P) appointment. 
"RTN","DGBTUTL1",36,0)
 ;      If it can be determined that the veteran is travelling for a C&P appointment then they are eligible for BT reimbursement.  
"RTN","DGBTUTL1",37,0)
 ;      NOTE: the data in PCE may not always be complete.  If BT is unable to automatically determine if the travel is C&P 
"RTN","DGBTUTL1",38,0)
 ;      related then BT may need to ask the user to perform this step manually (see step g).
"RTN","DGBTUTL1",39,0)
 ;
"RTN","DGBTUTL1",40,0)
PCE ; Patient Encounter
"RTN","DGBTUTL1",41,0)
 N DGVAL,DGCBK,DGDT1,DGQUERY,SDOE0,SDSTOP
"RTN","DGBTUTL1",42,0)
 ;
"RTN","DGBTUTL1",43,0)
 ;S DGVAL("DFN")=DFN,DGVAL("BDT")=DGBTDTI\1,DGVAL("EDT")=DGVAL("BDT")_".9999"
"RTN","DGBTUTL1",44,0)
 ;S DGCBK="I $P(SDOE0,U,8)=2 D VIS^DGBTUTL1(SDOE0) S DGDT1=+SDOE0",DGDT1=""
"RTN","DGBTUTL1",45,0)
 ;S XX=0 ;D SCAN^DGSDU("PATIENT/DATE",.DGVAL,"",DGCBK,1,.DGQUERY)
"RTN","DGBTUTL1",46,0)
 ;Q:XX XX    ;XX="7^Service connected appointment on the file"
"RTN","DGBTUTL1",47,0)
 ;XX="8^Compensation & Pension appointment on the file"
"RTN","DGBTUTL1",48,0)
 ;
"RTN","DGBTUTL1",49,0)
 ;If any of the above automatic checks (a, b, c, d or e) indicate that the veteran is eligible for BT reimbursement 
"RTN","DGBTUTL1",50,0)
 ;then the processing for this enhancement is complete.  If, however, the veteran does not pass any of the tests 
"RTN","DGBTUTL1",51,0)
 ;outlined above, the BT System must ask the user for additional information in order to determine if the veteran 
"RTN","DGBTUTL1",52,0)
 ;is eligible for BT reimbursement:
"RTN","DGBTUTL1",53,0)
 ;
"RTN","DGBTUTL1",54,0)
 ;f)    The BT System must ask the user if the veteran is travelling for a SC appointment.
"RTN","DGBTUTL1",55,0)
 ;      If the user responds with YES then the veteran is eligible for BT reimbursement.  Otherwise, go to step g.
"RTN","DGBTUTL1",56,0)
 ;g)    The BT System must ask the user if the veteran is travelling for a C&P appointment.
"RTN","DGBTUTL1",57,0)
 ;      If the user responds with YES then the veteran is eligible for BT reimbursement.
"RTN","DGBTUTL1",58,0)
 ;
"RTN","DGBTUTL1",59,0)
 ;DGBTSCAP - Contains answer to SC appointment question
"RTN","DGBTUTL1",60,0)
 ;DGBTCPAP = Contains answer to C&P appointment question
"RTN","DGBTUTL1",61,0)
 S DGBTSCAP=$$GET1^DIQ(392,DGBTDTI,43.4,"I")
"RTN","DGBTUTL1",62,0)
 S DGBTCPAP=$$GET1^DIQ(392,DGBTDTI,43,"I")
"RTN","DGBTUTL1",63,0)
 I '$G(DGBTNSC) W !,"IS THIS A CLAIM FOR A SERVICE CONNECTED APPOINTMENT" S %=$S('DGBTSCAP:2,1:1) D YN^DICN S DGBTSCAP=$S(%=2:"NO",1:"YES") I %'=2 D CLRLTR^DGBTDLT(0)
"RTN","DGBTUTL1",64,0)
 I '$G(DGBTNSC) Q:%=1 $P($T(BTC+9),";;",2) ;"9^Patient stated SERVICE CONNECTED APPOINTMENT^43.1"
"RTN","DGBTUTL1",65,0)
 I '$G(DGBTNSC) Q:%=-1 $P($T(BTC+14),";;",2) ;"14^Patient Exits Claim"
"RTN","DGBTUTL1",66,0)
 W !,"IS THIS A CLAIM FOR A COMP AND PENSION APPOINTMENT" S %=$S('DGBTCPAP:2,1:1) D YN^DICN S DGBTCPAP=$S(%=2:"NO",1:"YES") I %'=2 D CLRLTR^DGBTDLT(0)
"RTN","DGBTUTL1",67,0)
 Q:%=1 $P($T(BTC+10),";;",2) ;"10^Patient stated COMP AND PENSION APPOINTMENT"
"RTN","DGBTUTL1",68,0)
 Q:%=-1 $P($T(BTC+14),";;",2) ;"14^Patient Exits Claim"
"RTN","DGBTUTL1",69,0)
 W !!,"PATIENT IS NOT ELIGIBLE FOR BT REIMBURSEMENT"
"RTN","DGBTUTL1",70,0)
 W !!,"CONTINUE WITH CLAIM" S %=2 D YN^DICN
"RTN","DGBTUTL1",71,0)
 I %=2!('%)  S DGBTAPPTYP=1 Q $P($T(BTC+15),";;",2) ;"15^PATIENT AGREES WITH DENIAL OF CLAIM" ;<==  Here we should plug E11 Patient stated that he doesn' want to continue with claim
"RTN","DGBTUTL1",72,0)
 D CLRLTR^DGBTDLT(0)
"RTN","DGBTUTL1",73,0)
 Q:%=-1 $P($T(BTC+14),";;",2) ;"14^Patient Exits Claim"
"RTN","DGBTUTL1",74,0)
 K DIR S DIR("A")="SELECT REASON FOR ELIGIBILITY: ",DIR(0)="SA^1:Caregiver;2:Transplant;3:Other" D ^DIR
"RTN","DGBTUTL1",75,0)
 Q:Y=U $P($T(BTC+14),";;",2) ;"14^Patient Exits Claim"
"RTN","DGBTUTL1",76,0)
 Q:Y=1 $P($T(BTC+11),";;",2) ;"11^PATIENT STATED ELIGIBILITY REASON Caregiver "
"RTN","DGBTUTL1",77,0)
 Q:Y=2 $P($T(BTC+12),";;",2) ;"12^PATIENT STATED ELIGIBILITY REASON Transplant"
"RTN","DGBTUTL1",78,0)
 ; Here assuming that Y=3
"RTN","DGBTUTL1",79,0)
 K DIR S DIR("A")="SPECIFY OTHER REASON FOR ELIGIBILITY",DIR(0)="F" D ^DIR
"RTN","DGBTUTL1",80,0)
 Q:Y=U $P($T(BTC+14),";;",2) ;"14^Patient Exits Claim"
"RTN","DGBTUTL1",81,0)
 Q $P($T(BTC+13),";;",2)_": "_Y ;"13^PATIENT STATED OTHER REASON FOR ELIGIBILITY: "_Y
"RTN","DGBTUTL1",82,0)
 ;
"RTN","DGBTUTL1",83,0)
 ;If any of the above manual checks (f or g) indicate that the veteran is eligible for BT reimbursement then 
"RTN","DGBTUTL1",84,0)
 ;the processing for this enhancement is complete.  If, however, the veteran does not pass any of the manual tests outlined above, 
"RTN","DGBTUTL1",85,0)
 ;the BT System must inform the user that the veteran does not qualify for BT reimbursement.  
"RTN","DGBTUTL1",86,0)
 ;The BT System must then ask the user if they want to continue with the claim anyway.  
"RTN","DGBTUTL1",87,0)
 ;If the user responds with NO then the claim is denied and the enhancement is complete. 
"RTN","DGBTUTL1",88,0)
 ;NOTE: at this point in the processing the BT application must Auto-generate BT Denial-of-Benefits Statement and 
"RTN","DGBTUTL1",89,0)
 ;Appellate Rights (see section 2.6.11)
"RTN","DGBTUTL1",90,0)
EXIT ;
"RTN","DGBTUTL1",91,0)
 Q
"RTN","DGBTUTL1",92,0)
VIS(DGBTCSN) ;
"RTN","DGBTUTL1",93,0)
 Q
"RTN","DGBTUTL1",94,0)
 S:$S('DGDT1:0,1:+SDOE0'=DGDT1) SDSTOP=1
"RTN","DGBTUTL1",95,0)
 I 'SDSTOP D
"RTN","DGBTUTL1",96,0)
 .N DGBTCS,YY
"RTN","DGBTUTL1",97,0)
 .S:$P(DGBTCSN,U,3) DGBTCS=$P(DGBTCSN,U,3)
"RTN","DGBTUTL1",98,0)
 .S YY=$$GET1^DIQ(409.1,$P(DGBTCSN,"^",10)_",",4)
"RTN","DGBTUTL1",99,0)
 .S:YY="SC" XX=$P($T(BTC+7),";;",2) ;"7^Service connected appointment on the file"
"RTN","DGBTUTL1",100,0)
 .S:YY="CP" XX=$P($T(BTC+8),";;",2) ;"8^Compensation & Pension appointment on the file"
"RTN","DGBTUTL1",101,0)
 Q
"RTN","DGBTUTL1",102,0)
BTC ; List of entries in 392.41 file
"RTN","DGBTUTL1",103,0)
 ;;1^SC 30% or greater
"RTN","DGBTUTL1",104,0)
 ;;2^Recipient of VA Pension
"RTN","DGBTUTL1",105,0)
 ;;3^Low Income Copay
"RTN","DGBTUTL1",106,0)
 ;;4^Low Income M Test
"RTN","DGBTUTL1",107,0)
 ;;5^Alt. Income POW
"RTN","DGBTUTL1",108,0)
 ;;6^Alt.Income Hardship
"RTN","DGBTUTL1",109,0)
 ;;7^Service connected appointment on the file
"RTN","DGBTUTL1",110,0)
 ;;8^Compensation & Pension appointment on the file
"RTN","DGBTUTL1",111,0)
 ;;9^Patient stated SERVICE CONNECTED APPOINTMENT
"RTN","DGBTUTL1",112,0)
 ;;10^Patient stated COMP AND PENSION APPOINTMENT
"RTN","DGBTUTL1",113,0)
 ;;11^PATIENT STATED ELIGIBILITY REASON Caregiver
"RTN","DGBTUTL1",114,0)
 ;;12^PATIENT STATED ELIGIBILITY REASON Transplant
"RTN","DGBTUTL1",115,0)
 ;;13^PATIENT STATED OTHER REASON FOR ELIGIBILITY 
"RTN","DGBTUTL1",116,0)
 ;;14^""
"RTN","DGBTUTL1",117,0)
 ;;15^CLAIM DENIED
"RTN","DGBTUTL1",118,0)
 ;;16^NSC Low Income
"RTN","DGBTUTL1",119,0)
 ;;17^SC Under 30% and Low Income
"RTN","DGBTUTL1",120,0)
 ;;18^Alternate Income Hardship
"RTN","DGBTUTL1",121,0)
 ;;19^Alternate Income POW
"RTN","DGBTUTL1",122,0)
 ;;20^Patient stated QUALIFIED SC APPOINTMENT
"RTN","DGBTUTL1",123,0)
 ;;21^Patient refuse to provide financial information
"RTN","DGBTUTL1",124,0)
 ;;END
"RTN","DGBTUTL1",125,0)
 Q
"RTN","DGBTUTL1",126,0)
SETC ;Set entries into 392.41 if these are not there
"RTN","DGBTUTL1",127,0)
 N II,FDA,IENC
"RTN","DGBTUTL1",128,0)
 F II=1:1 S IENC(1)=+$P($T(BTC+II),";;",2) Q:'IENC(1)  S FDA(392.41,"+1,",.01)=IENC(1),FDA(392.41,"+1,",1)=$P($T(BTC+II),"^",2) D UPDATE^DIE(,"FDA","IENC")
"RTN","DGBTUTL1",129,0)
 Q
"RTN","DGBTUTL1",130,0)
KILLC ;Remove all entries from 392.41
"RTN","DGBTUTL1",131,0)
 N DA,DIK S DA=0,DIK="^DGBT(392.41," F  S DA=$O(^DGBT(392.41,DA)) Q:'DA  D ^DIK
"RTN","DGBTUTL1",132,0)
 Q
"RTN","DGBTUTL1",133,0)
 ;
"RTN","DGBTUTL1",134,0)
QUALQUES ;this will ask if the appointment was a qualified appointment if the patient is SC 30% or greater
"RTN","DGBTUTL1",135,0)
 ;
"RTN","DGBTUTL1",136,0)
 ;DGBTQAP - Contains answer for Qualified Appointment question
"RTN","DGBTUTL1",137,0)
 S DGBTQAP=$$GET1^DIQ(392,DGBTDTI,43.5,"I")
"RTN","DGBTUTL1",138,0)
 W !!,"Answer NO if you want to deny claim for any reason. Want to continue" S %=$S('$G(DGBTQAP):1,1:$G(DGBTQAP)) D YN^DICN S DGBTQAP=$S(%=2:"NO",1:"YES") I %'=2 D CLRLTR^DGBTDLT(0)
"RTN","DGBTUTL1",139,0)
 I %=2 S DGBTELL=15,LI="" ;$P($T(BTC+9),";;",2) ;"20^Patient stated QUALIFIED SC APPOINTMENT^43.1"
"RTN","DGBTUTL1",140,0)
 I %'=2 D CLRLTR^DGBTDLT(0)
"RTN","DGBTUTL1",141,0)
 I %=-1 S DGBTELL=14
"RTN","DGBTUTL1",142,0)
 ;
"RTN","DGBTUTL1",143,0)
 Q
"SEC","^DD",392,392,.01,8.5)

"SEC","^DD",392,392,44,8.5)

"SEC","^DIC",392,392,0,"AUDIT")

"SEC","^DIC",392,392,0,"DD")
@
"SEC","^DIC",392,392,0,"DEL")
"@"
"SEC","^DIC",392,392,0,"LAYGO")
@
"SEC","^DIC",392,392,0,"RD")
d
"SEC","^DIC",392,392,0,"WR")
@
"SEC","^DIC",392.3,392.3,0,"DD")
@
"SEC","^DIC",392.3,392.3,0,"DEL")
@
"SEC","^DIC",392.3,392.3,0,"LAYGO")
@
"SEC","^DIC",392.3,392.3,0,"RD")
d
"SEC","^DIC",392.3,392.3,0,"WR")
@
"SEC","^DIC",392.41,392.41,0,"AUDIT")
@
"SEC","^DIC",392.41,392.41,0,"DD")
@
"SEC","^DIC",392.41,392.41,0,"DEL")
@
"SEC","^DIC",392.41,392.41,0,"LAYGO")
@
"SEC","^DIC",392.41,392.41,0,"RD")
@
"SEC","^DIC",392.41,392.41,0,"WR")
@
"SEC","^DIC",392.43,392.43,0,"AUDIT")

"SEC","^DIC",392.43,392.43,0,"DD")
@
"SEC","^DIC",392.43,392.43,0,"DEL")
@
"SEC","^DIC",392.43,392.43,0,"LAYGO")

"SEC","^DIC",392.43,392.43,0,"RD")
d
"SEC","^DIC",392.43,392.43,0,"WR")
D
"SEC","^DIC",392.6,392.6,0,"AUDIT")
@
"SEC","^DIC",392.6,392.6,0,"DD")
@
"SEC","^DIC",392.6,392.6,0,"DEL")
@
"SEC","^DIC",392.6,392.6,0,"LAYGO")
@
"SEC","^DIC",392.6,392.6,0,"RD")
@
"SEC","^DIC",392.6,392.6,0,"WR")
@
"SEC","^DIC",392.7,392.7,0,"AUDIT")
@
"SEC","^DIC",392.7,392.7,0,"DD")
@
"SEC","^DIC",392.7,392.7,0,"DEL")
@
"SEC","^DIC",392.7,392.7,0,"LAYGO")
@
"SEC","^DIC",392.7,392.7,0,"RD")
@
"SEC","^DIC",392.7,392.7,0,"WR")
@
"SEC","^DIC",392.8,392.8,0,"AUDIT")
@
"SEC","^DIC",392.8,392.8,0,"DD")
@
"SEC","^DIC",392.8,392.8,0,"DEL")
@
"SEC","^DIC",392.8,392.8,0,"LAYGO")
@
"SEC","^DIC",392.8,392.8,0,"RD")
@
"SEC","^DIC",392.8,392.8,0,"WR")
@
"SEC","^DIC",392.9,392.9,0,"AUDIT")
@
"SEC","^DIC",392.9,392.9,0,"DD")
@
"SEC","^DIC",392.9,392.9,0,"DEL")
@
"SEC","^DIC",392.9,392.9,0,"LAYGO")
@
"SEC","^DIC",392.9,392.9,0,"RD")
@
"SEC","^DIC",392.9,392.9,0,"WR")
@
"VER")
8.0^22.0
"^DD",392,392,0)
FIELD^^43.4^81
"^DD",392,392,0,"DDA")
N
"^DD",392,392,0,"DT")
3121019
"^DD",392,392,0,"ID",2)
S %I=Y,Y=$S('$D(^(0)):"",$D(^DPT(+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",392,392,0,"ID",6)
S %I=Y,Y=$S('$D(^(0)):"",$D(^DGBT(392.3,+$P(^(0),U,6),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(392.3,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",392,392,0,"IX","AC",392,6)

"^DD",392,392,0,"IX","ACTP",392,6)

"^DD",392,392,0,"IX","AD",392,9)

"^DD",392,392,0,"IX","ADENIED",392,45.2)

"^DD",392,392,0,"IX","AE",392,3)

"^DD",392,392,0,"IX","AFLS",392,14)

"^DD",392,392,0,"IX","AI",392,2)

"^DD",392,392,0,"IX","AS",392,7)

"^DD",392,392,0,"IX","B",392,.01)

"^DD",392,392,0,"IX","C",392,2)

"^DD",392,392,0,"IX","D",392,13)

"^DD",392,392,0,"NM","BENEFICIARY TRAVEL CLAIM")

"^DD",392,392,0,"VRPK")
DGBT
"^DD",392,392,.01,0)
Claim DATE/TIME^RDX^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X I $D(X) S DINUM=X
"^DD",392,392,.01,1,0)
^.1
"^DD",392,392,.01,1,1,0)
392^B
"^DD",392,392,.01,1,1,1)
S ^DGBT(392,"B",$E(X,1,30),DA)=""
"^DD",392,392,.01,1,1,2)
K ^DGBT(392,"B",$E(X,1,30),DA)
"^DD",392,392,.01,3)
Enter the Beneficiary Travel CLAIM date/time in the usual fileman format.
"^DD",392,392,.01,21,0)
^.001^1^1^3120802^^^^
"^DD",392,392,.01,21,1,0)
Enter the date/time of the Bene Travel Claim.
"^DD",392,392,.01,22)

"^DD",392,392,.01,"DT")
3120629
"^DD",392,392,2,0)
NAME^RP2'I^DPT(^0;2^Q
"^DD",392,392,2,1,0)
^.1
"^DD",392,392,2,1,1,0)
392^C
"^DD",392,392,2,1,1,1)
S ^DGBT(392,"C",$E(X,1,30),DA)=""
"^DD",392,392,2,1,1,2)
K ^DGBT(392,"C",$E(X,1,30),DA)
"^DD",392,392,2,1,2,0)
392^AI^MUMPS
"^DD",392,392,2,1,2,1)
S ^DGBT(392,"AI",$E(X,1,30),9999999.99999-DA)=DA
"^DD",392,392,2,1,2,2)
K ^DGBT(392,"AI",$E(X,1,30),9999999.99999-DA)
"^DD",392,392,2,21,0)
^^1^1^2920108^
"^DD",392,392,2,21,1,0)
Enter the patient that is related to this Bene Travel Claim.
"^DD",392,392,2,"DT")
3120629
"^DD",392,392,3,0)
ELIGIBILITY^P8'X^DIC(8,^0;3^Q
"^DD",392,392,3,1,0)
^.1
"^DD",392,392,3,1,1,0)
392^AE
"^DD",392,392,3,1,1,1)
S ^DGBT(392,"AE",$E(X,1,30),DA)=""
"^DD",392,392,3,1,1,2)
K ^DGBT(392,"AE",$E(X,1,30),DA)
"^DD",392,392,3,3)
Enter the primary eligibility or other entitled eligibilities
"^DD",392,392,3,21,0)
^.001^1^1^3120802^^
"^DD",392,392,3,21,1,0)
This field contains the eligibililty of the patient for this Bene Travel Claim.
"^DD",392,392,3,"DT")
2890108
"^DD",392,392,4,0)
SC PERCENTAGE^NJ3,0^^0;4^K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"^DD",392,392,4,3)
Type a Number between 0 and 100, 0 Decimal Digits
"^DD",392,392,4,21,0)
^^1^1^2920109^^
"^DD",392,392,4,21,1,0)
Enter the SC percentage of this patient related to this Bene Travel Claim.
"^DD",392,392,5,0)
CERTIFICATION DATE^*P392.2'^DGBT(392.2,^0;5^S DIC("S")="I $P(^(0),U,2)=$P(^DGBT(392,DA,0),U,2)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",392,392,5,.1)
ANNUAL CERTIFICATION
"^DD",392,392,5,3)

"^DD",392,392,5,4)

"^DD",392,392,5,12)
Only allowed to select Certification Dates for this patient
"^DD",392,392,5,12.1)
S DIC("S")="I $P(^(0),U,2)=$P(^DGBT(392,DA,0),U,2)"
"^DD",392,392,5,21,0)
^^1^1^2960726^^^
"^DD",392,392,5,21,1,0)
This field contains the Beneficiary Travel Certification date.
"^DD",392,392,5,"DT")
2890106
"^DD",392,392,6,0)
ACCOUNT^R*P392.3'^DGBT(392.3,^0;6^S DIC("S")="I $P(^(0),U,3)'>DA&('$P(^(0),U,4)!($P(^(0),U,4)'<DA))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",392,392,6,1,0)
^.1
"^DD",392,392,6,1,1,0)
392^AC
"^DD",392,392,6,1,1,1)
S ^DGBT(392,"AC",$E(X,1,30),DA)=""
"^DD",392,392,6,1,1,2)
K ^DGBT(392,"AC",$E(X,1,30),DA)
"^DD",392,392,6,1,2,0)
392^ACTP^MUMPS
"^DD",392,392,6,1,2,1)
Q:'$D(^DGBT(392.3,X,0))  S:+$P(^(0),U,5) ^DGBT(392,"ACTP",+$P(^(0),U,5),DA)=""
"^DD",392,392,6,1,2,2)
Q:'$D(^DGBT(392.3,X,0))  K:+$P(^(0),U,5) ^DGBT(392,"ACTP",+$P(^(0),U,5),DA)
"^DD",392,392,6,3)

"^DD",392,392,6,12)
Enter the appropriate account at the time of the claim.
"^DD",392,392,6,12.1)
S DIC("S")="I $P(^(0),U,3)'>DA&('$P(^(0),U,4)!($P(^(0),U,4)'<DA))"
"^DD",392,392,6,21,0)
^.001^3^3^3120611^^^^
"^DD",392,392,6,21,1,0)
This field is a pointer to the Beneficiary Travel Account file and
"^DD",392,392,6,21,2,0)
contains the account number assigned to an individual beneficiary
"^DD",392,392,6,21,3,0)
travel claim.
"^DD",392,392,6,"DT")
2910219
"^DD",392,392,7,0)
CARRIER^RP440'^PRC(440,^0;7^Q
"^DD",392,392,7,1,0)
^.1
"^DD",392,392,7,1,1,0)
392^AS
"^DD",392,392,7,1,1,1)
S ^DGBT(392,"AS",$E(X,1,30),DA)=""
"^DD",392,392,7,1,1,2)
K ^DGBT(392,"AS",$E(X,1,30),DA)
"^DD",392,392,7,3)

"^DD",392,392,7,21,0)
^.001^2^2^3020507^^
"^DD",392,392,7,21,1,0)
This field points to the Vendor File and contains the Carrier providing 
"^DD",392,392,7,21,2,0)
services for this Bene Travel Claim.
"^DD",392,392,7,"DT")
2890129
"^DD",392,392,8,0)
MOST ECON. COST^NJ8,2^^0;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0) X
"^DD",392,392,8,3)
Type a Dollar Amount between 0 and 10000, 2 Decimal Digits
"^DD",392,392,8,21,0)
^.001^2^2^3120627^^^^
"^DD",392,392,8,21,1,0)
This field contains the most economical cost amount (whatever cost less) 
"^DD",392,392,8,21,2,0)
for this Bene Travel Claim.
"^DD",392,392,8,"DT")
2881214
"^DD",392,392,9,0)
DEDUCTIBLE AMOUNT^NJ4,2X^^0;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>99)!(X<0) X
"^DD",392,392,9,1,0)
^.1
"^DD",392,392,9,1,1,0)
392^AD^MUMPS
"^DD",392,392,9,1,1,1)
S ^DGBT(392,"AD",$P(^DGBT(392,DA,0),"^",2),$E(DA,2,5),DA)=X
"^DD",392,392,9,1,1,2)
K ^DGBT(392,"AD",$P(^DGBT(392,DA,0),"^",2),$E(DA,2,5),DA)
"^DD",392,392,9,3)
Type a Dollar Amount between 0 and 99, 2 Decimal Digits
"^DD",392,392,9,21,0)
^.001^1^1^3120703^^^^
"^DD",392,392,9,21,1,0)
This field contains the deductible amount applied to this Bene Travel Claim.
"^DD",392,392,9,"DT")
3120924
"^DD",392,392,10,0)
AMOUNT PAYABLE^NJ8,2^^0;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0) X
"^DD",392,392,10,3)
Type a dollar amount between 0 and 10000, 2 decimal digits.
"^DD",392,392,10,21,0)
^.001^2^2^3120720^^^^
"^DD",392,392,10,21,1,0)
This field contains the amount payable (cost minus any applied deductible) 
"^DD",392,392,10,21,2,0)
for this Bene Travel Claim.
"^DD",392,392,10,"DT")
3120703
"^DD",392,392,11,0)
DIVISION^RP40.8'^DG(40.8,^0;11^Q
"^DD",392,392,11,21,0)
^^2^2^2920109^
"^DD",392,392,11,21,1,0)
This field contains the medical center division related to this Bene Travel 
"^DD",392,392,11,21,2,0)
Claim.
"^DD",392,392,11,"DT")
2890127
"^DD",392,392,12,0)
WHO ENTERED INTO FILE^P200'^VA(200,^0;12^Q
"^DD",392,392,12,21,0)
^^1^1^2920109^^^
"^DD",392,392,12,21,1,0)
The name of the user who first entered this patient into the Beneficiary Travel Claim file.
"^DD",392,392,12,"DT")
2901017
"^DD",392,392,13,0)
DATE ENTERED INTO THE FILE^MD^^0;13^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,13,1,0)
^.1
"^DD",392,392,13,1,1,0)
392^D
"^DD",392,392,13,1,1,1)
S ^DGBT(392,"D",$E(X,1,30),DA)=""
"^DD",392,392,13,1,1,2)
K ^DGBT(392,"D",$E(X,1,30),DA)
"^DD",392,392,13,1,1,"DT")
3120508
"^DD",392,392,13,21,0)
^^1^1^2881215^^
"^DD",392,392,13,21,1,0)
The date this beneficiary travel claim was entered into this file.
"^DD",392,392,13,"DT")
3120508
"^DD",392,392,14,0)
COREFLS CARRIER^P392.31'O^DGBT(392.31,^0;14^Q
"^DD",392,392,14,1,0)
^.1
"^DD",392,392,14,1,1,0)
392^AFLS
"^DD",392,392,14,1,1,1)
S ^DGBT(392,"AFLS",$E(X,1,30),DA)=""
"^DD",392,392,14,1,1,2)
K ^DGBT(392,"AFLS",$E(X,1,30),DA)
"^DD",392,392,14,1,1,"DT")
3020416
"^DD",392,392,14,2)
S Y(0)=Y K DGBTPRV S DGBTPRV=$$PREV^DGBTCSL(.Y)
"^DD",392,392,14,2.1)
K DGBTPRV S DGBTPRV=$$PREV^DGBTCSL(.Y)
"^DD",392,392,14,3)
Enter a COREFLS Carrier for this claim.
"^DD",392,392,14,21,0)
^^1^1^3021207^
"^DD",392,392,14,21,1,0)
This field contains the COREFLS Carrier for this Bene Travel Claim.
"^DD",392,392,14,"DEL",1,0)
I 1 W !,*7,"DELETIONS ARE NOT ALLOWED"
"^DD",392,392,14,"DT")
3021211
"^DD",392,392,21,0)
PLACE OF DEPARTURE [LINE 1]^F^^D;1^K:$L(X)>35!($L(X)<3) X
"^DD",392,392,21,1,0)
^.1
"^DD",392,392,21,1,1,0)
^^TRIGGER^392^22
"^DD",392,392,21,1,1,1)
Q
"^DD",392,392,21,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"D")):^("D"),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"D")),DIV=X S $P(^("D"),U,2)=DIV,DIH=392,DIG=22 D ^DICR
"^DD",392,392,21,1,1,"CREATE VALUE")
NO EFFECT
"^DD",392,392,21,1,1,"DELETE VALUE")
@
"^DD",392,392,21,1,1,"DT")
3100818
"^DD",392,392,21,1,1,"FIELD")
PLACE OF DEPARTURE [LINE 2]
"^DD",392,392,21,3)
Enter the first line of the place of departure address.  Answer must be 3-35 characters in length.
"^DD",392,392,21,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,21,21,1,0)
This field contains the first line of the address for the place of 
"^DD",392,392,21,21,2,0)
departure for this Bene Travel Claim.
"^DD",392,392,21,"DT")
3100818
"^DD",392,392,22,0)
PLACE OF DEPARTURE [LINE 2]^F^^D;2^K:$L(X)>30!($L(X)<3) X
"^DD",392,392,22,1,0)
^.1^^-1
"^DD",392,392,22,1,1,0)
^^TRIGGER^392^23
"^DD",392,392,22,1,1,1)
Q
"^DD",392,392,22,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"D")):^("D"),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"D")),DIV=X S $P(^("D"),U,3)=DIV,DIH=392,DIG=23 D ^DICR
"^DD",392,392,22,1,1,"CREATE VALUE")
NO EFFECT
"^DD",392,392,22,1,1,"DELETE VALUE")
@
"^DD",392,392,22,1,1,"DT")
3100804
"^DD",392,392,22,1,1,"FIELD")
PLACE OF DEPARTURE [LINE 3]
"^DD",392,392,22,3)
If the space provided in 'PLACE OF DEPARTURE [LINE 1] was not sufficient, enter the second line of the place of departure address.  Answer must be 3-30 characters in length.
"^DD",392,392,22,5,1,0)
392^21^1
"^DD",392,392,22,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,22,21,1,0)
This field contains the second line of the address for the place of 
"^DD",392,392,22,21,2,0)
departure for this Bene Travel Claim.
"^DD",392,392,22,"DT")
3100804
"^DD",392,392,23,0)
PLACE OF DEPARTURE [LINE 3]^F^^D;3^K:$L(X)>30!($L(X)<3) X
"^DD",392,392,23,3)
Answer must be 3-30 characters in length.
"^DD",392,392,23,5,1,0)
392^22^1
"^DD",392,392,23,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,23,21,1,0)
This field contains the third line of the address for the place of 
"^DD",392,392,23,21,2,0)
departure for this Bene Travel Claim.
"^DD",392,392,23,"DT")
2881215
"^DD",392,392,24,0)
CITY OF DEPARTURE^FX^^D;4^K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X I $D(X) D UP^DGHELP
"^DD",392,392,24,3)
Answer must be 2-30 characters in length.
"^DD",392,392,24,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,24,21,1,0)
This field contains the name of the city in the address for the place of 
"^DD",392,392,24,21,2,0)
departure for this Bene Travel Claim.
"^DD",392,392,24,"DT")
2890227
"^DD",392,392,24.1,0)
STATE OF DEPARTURE^P5'^DIC(5,^D;5^Q
"^DD",392,392,24.1,21,0)
^.001^2^2^3120611^^
"^DD",392,392,24.1,21,1,0)
This field points to the State File and uses this for the state in the 
"^DD",392,392,24.1,21,2,0)
address for the place of departure for this Bene Travel Claim.
"^DD",392,392,24.1,"DT")
2890227
"^DD",392,392,24.2,0)
ZIP CODE/DEPARTURE^FXO^^D;6^K:$L(X)>20!($L(X)<5) X I $D(X) D ZIPIN^VAFADDR
"^DD",392,392,24.2,2)
S Y(0)=Y D ZIPOUT^VAFADDR
"^DD",392,392,24.2,2.1)
D ZIPOUT^VAFADDR
"^DD",392,392,24.2,3)
Answer with either 5 digit or 9 digit zip code.
"^DD",392,392,24.2,21,0)
^.001^2^2^3120611^^
"^DD",392,392,24.2,21,1,0)
This field contains the 5-digit zip code used in the address for the place
"^DD",392,392,24.2,21,2,0)
of departure for this Bene Travel Claim.
"^DD",392,392,24.2,"DT")
3120814
"^DD",392,392,25,0)
DESTINATION [LINE 1]^F^^T;1^K:$L(X)>35!($L(X)<3) X
"^DD",392,392,25,1,0)
^.1^^-1
"^DD",392,392,25,1,1,0)
^^TRIGGER^392^26
"^DD",392,392,25,1,1,1)
Q
"^DD",392,392,25,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"T")):^("T"),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"T")),DIV=X S $P(^("T"),U,2)=DIV,DIH=392,DIG=26 D ^DICR
"^DD",392,392,25,1,1,"CREATE VALUE")
NO EFFECT
"^DD",392,392,25,1,1,"DELETE VALUE")
@
"^DD",392,392,25,1,1,"DT")
3100804
"^DD",392,392,25,1,1,"FIELD")
DESTINATION [LINE 2]
"^DD",392,392,25,3)
Answer must be 3-35 characters in length.
"^DD",392,392,25,21,0)
^.001^2^2^3120626^^^
"^DD",392,392,25,21,1,0)
This field contains the first line of the address for place of destination 
"^DD",392,392,25,21,2,0)
for this Bene Travel Claim.
"^DD",392,392,25,"DT")
3100804
"^DD",392,392,26,0)
DESTINATION [LINE 2]^F^^T;2^K:$L(X)>30!($L(X)<3) X
"^DD",392,392,26,1,0)
^.1^^-1
"^DD",392,392,26,1,1,0)
^^TRIGGER^392^27
"^DD",392,392,26,1,1,1)
Q
"^DD",392,392,26,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"T")):^("T"),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"T")),DIV=X S $P(^("T"),U,3)=DIV,DIH=392,DIG=27 D ^DICR
"^DD",392,392,26,1,1,"CREATE VALUE")
NO EFFECT
"^DD",392,392,26,1,1,"DELETE VALUE")
@
"^DD",392,392,26,1,1,"DT")
3100804
"^DD",392,392,26,1,1,"FIELD")
DESTINATION [LINE 3]
"^DD",392,392,26,3)
Answer must be 3-30 characters in length.
"^DD",392,392,26,5,1,0)
392^25^1
"^DD",392,392,26,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,26,21,1,0)
This field contains the second line of the address for the place of 
"^DD",392,392,26,21,2,0)
destination for this Bene Travel Claim.
"^DD",392,392,26,"DT")
3100804
"^DD",392,392,27,0)
DESTINATION [LINE 3]^F^^T;3^K:$L(X)>30!($L(X)<3) X
"^DD",392,392,27,3)
Answer must be 3-30 characters in length.
"^DD",392,392,27,5,1,0)
392^26^1
"^DD",392,392,27,21,0)
^.001^2^2^3120626^^^^
"^DD",392,392,27,21,1,0)
This field contains the third line of the address for the place of 
"^DD",392,392,27,21,2,0)
destination for this Bene Travel Claim.
"^DD",392,392,27,"DT")
2890208
"^DD",392,392,28,0)
CITY OF DESTINATION^FX^^T;4^K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X I $D(X) D UP^DGHELP
"^DD",392,392,28,3)
Answer must be 2-30 characters in length.
"^DD",392,392,28,21,0)
^.001^2^2^3120626^^^
"^DD",392,392,28,21,1,0)
This field contains the name of the city in the address for the place of 
"^DD",392,392,28,21,2,0)
destination for this Bene Travel Claim.
"^DD",392,392,28,"DT")
2890309
"^DD",392,392,28.1,0)
STATE OF DESTINATION^P5'^DIC(5,^T;5^Q
"^DD",392,392,28.1,21,0)
^.001^2^2^3120611^^^
"^DD",392,392,28.1,21,1,0)
This field points the the STATE file and contains the state used in the 
"^DD",392,392,28.1,21,2,0)
address for the place of destination for this Bene Travel Claim.
"^DD",392,392,28.1,"DT")
2890227
"^DD",392,392,28.2,0)
ZIP CODE/DESTINATION^FXO^^T;6^K:$L(X)>20!($L(X)<5) X I $D(X) D ZIPIN^VAFADDR
"^DD",392,392,28.2,2)
S Y(0)=Y D ZIPOUT^VAFADDR
"^DD",392,392,28.2,2.1)
D ZIPOUT^VAFADDR
"^DD",392,392,28.2,3)
Answer with either 5 digit or 9 digit zip code.
"^DD",392,392,28.2,21,0)
^.001^2^2^3120611^^
"^DD",392,392,28.2,21,1,0)
This field contains the 5-digit zip code used in the address for the 
"^DD",392,392,28.2,21,2,0)
place of destination for this Bene Travel Claim.
"^DD",392,392,28.2,"DT")
2930301
"^DD",392,392,31,0)
ONE WAY/ROUND TRIP^RS^1:ONE WAY;2:ROUND TRIP;^M;1^Q
"^DD",392,392,31,21,0)
^^1^1^2920109^^
"^DD",392,392,31,21,1,0)
This field indicates one way or round trip for this Bene Travel Claim.
"^DD",392,392,31,"DT")
2890208
"^DD",392,392,32,0)
MILEAGE/ONE WAY^RNJ5,0^^M;2^K:+X'=X!(X>10000)!(X<0)!(X?.E1"."1N.N) X
"^DD",392,392,32,3)
Type a Number between 0 and 10000, 0 Decimal Digits
"^DD",392,392,32,4)
S X="D MHELP^DGBTUTL" X X
"^DD",392,392,32,21,0)
^.001^1^1^3120627^^^^
"^DD",392,392,32,21,1,0)
This field contains the one way mileage for this Bene Travel Calim.
"^DD",392,392,32,"DT")
2890129
"^DD",392,392,33,0)
TOTAL MILEAGE AMOUNT^NJ8,2^^M;3^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0) X
"^DD",392,392,33,3)
Type a Dollar Amount between 0 and 10000, 2 Decimal Digits
"^DD",392,392,33,21,0)
^.001^2^2^3120611^^^
"^DD",392,392,33,21,1,0)
This is a numeric field containing the total mileage entered for a
"^DD",392,392,33,21,2,0)
specific beneficiary travel claim.
"^DD",392,392,33,"DT")
2890107
"^DD",392,392,34,0)
MEALS & LODGING^NJ8,2^^M;4^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0) X
"^DD",392,392,34,3)
Type a Dollar Amount between 0 and 10000, 2 Decimal Digits
"^DD",392,392,34,21,0)
^.001^1^1^3120720^^^^
"^DD",392,392,34,21,1,0)
This field contains meals and lodging costs for this Bene Travel Claim.
"^DD",392,392,34,"DT")
2890107
"^DD",392,392,35,0)
FERRY, BRIDGES, ETC.^NJ8,2^^M;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0) X
"^DD",392,392,35,3)
Type a Dollar Amount between 0 and 10000, 2 Decimal Digits
"^DD",392,392,35,21,0)
^.001^1^1^3120627^^^^
"^DD",392,392,35,21,1,0)
This field contains ferry, bridges, etc. costs for this Bene Travel Claim.
"^DD",392,392,35,"DT")
2890107
"^DD",392,392,41,0)
AUTHORIZING PERSON^P200'^VA(200,^A;1^Q
"^DD",392,392,41,21,0)
^^2^2^2930127^^
"^DD",392,392,41,21,1,0)
This field points the person file to indicate who the authorizing person 
"^DD",392,392,41,21,2,0)
responsible for this Bene Travel Claim.
"^DD",392,392,41,"DT")
2930127
"^DD",392,392,42,0)
ATTENDANT/PAYEE^FX^^A;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!(X?1P.E)!(X'?1U.ANP)!(X'[",") X I $D(X) D UP^DGHELP S Y=", " F I=0:0 Q:$F(X,Y)<1  S X=$E(X,1,($F(X,Y)-2))_$E(X,$F(X,Y),99)
"^DD",392,392,42,3)
Enter the name in 'Last,First Middle' format between 3-30 characters.  With the exception of the comma, period, space, hyphen, dash and apostrophe punctuation characters should be avoided.
"^DD",392,392,42,21,0)
^^2^2^2930730^^
"^DD",392,392,42,21,1,0)
This field contains the 'Last, First Middle' name format of the 
"^DD",392,392,42,21,2,0)
attendent/payee of this Bene Travel Claim.
"^DD",392,392,42,"DT")
2930730
"^DD",392,392,43,0)
C&P REVIEW VISIT^S^0:NO;1:YES;^A;3^Q
"^DD",392,392,43,3)
Answer whether this claim is a C&P review visit and should be paid at the C&P review visit mileage rate as indicated in the BT parameters.
"^DD",392,392,43,21,0)
^.001^3^3^3121019^^
"^DD",392,392,43,21,1,0)
This field indicates whether this is a C&P review visit and should be 
"^DD",392,392,43,21,2,0)
paid at the C&P review visit mileage rate as indicated in the BT 
"^DD",392,392,43,21,3,0)
parameters for this Bene Travel Claim.
"^DD",392,392,43,"DT")
3121019
"^DD",392,392,43.1,0)
BT CLAIM ELIGIBILITY CODE^P392.41'^DGBT(392.41,^1;2^Q
"^DD",392,392,43.1,3)
Select the eligibility code.
"^DD",392,392,43.1,21,0)
^.001^1^1^3120807^^^^
"^DD",392,392,43.1,21,1,0)
This is the reason patient is eligible for BT.
"^DD",392,392,43.1,"DT")
3120802
"^DD",392,392,43.2,0)
BT CLAIM ELIGIBILITY ADDITION^F^^1;1^K:$L(X)>80!($L(X)<1) X
"^DD",392,392,43.2,3)
Answer must be 1-80 characters in length.
"^DD",392,392,43.2,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,43.2,21,1,0)
This is additional information or explanation if 'Other Eligibility Reason' was entered in the
"^DD",392,392,43.2,21,2,0)
BT CLAIM ELIGIBILITY CODE (#43.1) field. 
"^DD",392,392,43.2,"DT")
3120806
"^DD",392,392,43.4,0)
SC APPOINTMENT^S^0:NO;1:YES;^A;12^Q
"^DD",392,392,43.4,3)
Enter a 'Yes' or 'No'.
"^DD",392,392,43.4,21,0)
^.001^2^2^3121019^^
"^DD",392,392,43.4,21,1,0)
This field contains 1(Yes) or 0(No) on whether or not the patients 
"^DD",392,392,43.4,21,2,0)
appointment was a SC appointment.
"^DD",392,392,43.4,"DT")
3121019
"^DD",392,392,43.5,0)
QUALIFIED APPOINTMENT^S^0:NO;1:YES;^A;11^Q
"^DD",392,392,43.5,3)
Enter 'Yes' if a Qualified Appointment, 'No' if not a Qualified Appointment.
"^DD",392,392,43.5,21,0)
^^2^2^3121019^
"^DD",392,392,43.5,21,1,0)
The field will contain the a 1(yes) or 0(no) on whether or not the
"^DD",392,392,43.5,21,2,0)
patients appointment was a qualified appointment for BT reimburstment.
"^DD",392,392,43.5,"DT")
3121019
"^DD",392,392,44,0)
MODE OF TRANSPORTATION^RP392.43'^DGBT(392.43,^A;4^Q
"^DD",392,392,44,1,0)
^.1^^-1
"^DD",392,392,44,1,2,0)
^^TRIGGER^392^52
"^DD",392,392,44,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=$P($G(^DGBT(392.43,+Y(0),0)),U)'["BUS" I X S X=DIV S Y(1)=$S($D(^DGBT(392,D0,"B")):^("B"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X="" X ^DD(392,44,1,2,1.4)
"^DD",392,392,44,1,2,1.4)
S DIH=$G(^DGBT(392,DIV(0),"B")),DIV=X S $P(^("B"),U,1)=DIV,DIH=392,DIG=52 D ^DICR
"^DD",392,392,44,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"B")):^("B"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"B")),DIV=X S $P(^("B"),U,1)=DIV,DIH=392,DIG=52 D ^DICR
"^DD",392,392,44,1,2,"%D",0)
^.101^3^3^3120928^^^
"^DD",392,392,44,1,2,"%D",1,0)
If mode of transportation is changed to something other than bus then the 
"^DD",392,392,44,1,2,"%D",2,0)
BUS PASS OR TICKET field is automatically deleted as it's no longer 
"^DD",392,392,44,1,2,"%D",3,0)
relevant to this claim.
"^DD",392,392,44,1,2,"CREATE CONDITION")
MODE OF TRANSPORTATION'["BUS"
"^DD",392,392,44,1,2,"CREATE VALUE")
@
"^DD",392,392,44,1,2,"DELETE VALUE")
@
"^DD",392,392,44,1,2,"DT")
3120808
"^DD",392,392,44,1,2,"FIELD")
BUS PASS OR TICKET
"^DD",392,392,44,3)
Enter the mode of transportation used for this Beneficiary Travel Claim.
"^DD",392,392,44,21,0)
^.001^1^1^3120928^^^^
"^DD",392,392,44,21,1,0)
This field indicates the mode of transportation used for this Beneficiary Travel Claim. 
"^DD",392,392,44,"DT")
3120928
"^DD",392,392,45,0)
DENIAL LETTER ISSUED^S^0:NO;1:YES;^A;6^Q
"^DD",392,392,45,3)
Was a BT denial letter issued?
"^DD",392,392,45,21,0)
^^1^1^3120808^
"^DD",392,392,45,21,1,0)
Field indicates whether or not a BT claim denial letter was issued.
"^DD",392,392,45,"DT")
3120808
"^DD",392,392,45.1,0)
DENIAL LETTER ISSUED DATE^D^^A;7^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,45.1,3)
Please enter date and time
"^DD",392,392,45.1,21,0)
^.001^1^1^3120802^^^^
"^DD",392,392,45.1,21,1,0)
Date and time the BT claim was denied and letter was issued.
"^DD",392,392,45.1,"DT")
3120703
"^DD",392,392,45.2,0)
CLAIM DENIED^S^0:NO;1:YES;^A;8^Q
"^DD",392,392,45.2,1,0)
^.1
"^DD",392,392,45.2,1,1,0)
392^ADENIED^MUMPS
"^DD",392,392,45.2,1,1,1)
I X S DFN=$P(^DGBT(392,DA,0),"^",2) S ^DGBT(392,"ADENIED",DFN,DA)=""
"^DD",392,392,45.2,1,1,2)
I $D(DA) S DFN=$P(^DGBT(392,DA,0),"^",2) K ^DGBT(392,"ADENIED",DFN,DA)
"^DD",392,392,45.2,1,1,"%D",0)
^.101^1^1^3121021^^^^
"^DD",392,392,45.2,1,1,"%D",1,0)
WHOLE FILE CROSS REFERENCE ON FIELD 45.2, CLAIM DENIED.
"^DD",392,392,45.2,1,1,"DT")
3121021
"^DD",392,392,45.2,3)
Is the claim denied?
"^DD",392,392,45.2,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,45.2,21,1,0)
This field will inform whether a claim has been approved or denied. 
"^DD",392,392,45.2,"DT")
3121021
"^DD",392,392,45.3,0)
DATE CLAIM DENIED^D^^A;9^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,45.3,3)
Enter Date the Claim was Denied.
"^DD",392,392,45.3,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,45.3,21,1,0)
This field contains the date the claim was denied. 
"^DD",392,392,45.3,"DT")
3120807
"^DD",392,392,45.4,0)
CLAIM DENIED REASON^P392.8'^DGBT(392.8,^A;10^Q
"^DD",392,392,45.4,3)
Enter reason claim was denied.
"^DD",392,392,45.4,21,0)
^^1^1^3120808^
"^DD",392,392,45.4,21,1,0)
Reason claim was denied.
"^DD",392,392,45.4,"DT")
3120808
"^DD",392,392,51,0)
REMARKS^FX^^R;1^K:$L(X)>79!($L(X)<1)!(X[";") X
"^DD",392,392,51,3)
Answer must be 1-79 characters in length and not containing a "".
"^DD",392,392,51,21,0)
^^1^1^3120806^
"^DD",392,392,51,21,1,0)
This field contains remarks related to this Beneficiary Travel Claim.
"^DD",392,392,51,"DT")
3120806
"^DD",392,392,52,0)
BUS PASS OR TICKET^S^P:PASS;T:TICKET;^B;1^Q
"^DD",392,392,52,1,0)
^.1^^-1
"^DD",392,392,52,1,2,0)
^^TRIGGER^392^53
"^DD",392,392,52,1,2,1)
X ^DD(392,52,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^DGBT(392,D0,"B")):^("B"),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"B")),DIV=X S $P(^("B"),U,2)=DIV,DIH=392,DIG=53 D ^DICR
"^DD",392,392,52,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$P($G(^DD(392,52,0)),U,3) S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59))'="PASS"
"^DD",392,392,52,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGBT(392,D0,"B")):^("B"),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X="" S DIH=$G(^DGBT(392,DIV(0),"B")),DIV=X S $P(^("B"),U,2)=DIV,DIH=392,DIG=53 D ^DICR
"^DD",392,392,52,1,2,"%D",0)
^^3^3^3120808^
"^DD",392,392,52,1,2,"%D",1,0)
If the BUS PASS OR TICKET (#52) field doesn't contain "pass" as a value 
"^DD",392,392,52,1,2,"%D",2,0)
then the BUS PASS EXPIRATION DATE (#53) field is deleted as it's no 
"^DD",392,392,52,1,2,"%D",3,0)
longer relevant.
"^DD",392,392,52,1,2,"CREATE CONDITION")
BUS PASS OR TICKET'="PASS"
"^DD",392,392,52,1,2,"CREATE VALUE")
@
"^DD",392,392,52,1,2,"DELETE VALUE")
@
"^DD",392,392,52,1,2,"DT")
3120808
"^DD",392,392,52,1,2,"FIELD")
BUS PASS EXPIRATION DATE
"^DD",392,392,52,3)
Choose whether the patient has a monthly bus pass or a single use ticket.
"^DD",392,392,52,5,1,0)
392^44^2
"^DD",392,392,52,21,0)
^.001^3^3^3111215^^^^
"^DD",392,392,52,21,1,0)
This field stores the type of ticket that the veteran used when
"^DD",392,392,52,21,2,0)
riding the bus.  The type of ticket determines how the veteran is
"^DD",392,392,52,21,3,0)
reimbursed.
"^DD",392,392,52,"DT")
3120808
"^DD",392,392,53,0)
BUS PASS EXPIRATION DATE^DX^^B;2^S %DT="EX" D ^%DT S X=Y K:Y<1!($P($G(^DGBT(392,DA,"B")),U)'="P") X I $D(X),X<$P(DA,".",1) K X
"^DD",392,392,53,3)
Enter the expiration date for the patient's bus pass.
"^DD",392,392,53,5,1,0)
392^52^2
"^DD",392,392,53,5,2,0)
392^52^2
"^DD",392,392,53,21,0)
^^3^3^3120810^
"^DD",392,392,53,21,1,0)
This field holds the expiration date of the bus pass and can only be 
"^DD",392,392,53,21,2,0)
filled in if the BUS PASS OR TICKET (#52) field is set to pass. 
"^DD",392,392,53,21,3,0)
The bus pass expiration date can't before the claim date.
"^DD",392,392,53,"DT")
3120810
"^DD",392,392,54,0)
COMMON CARRIER DATE REIMBURSED^RD^^C;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,54,3)
Enter date reimbursement was given for use of common carrier. No future dates allowed.
"^DD",392,392,54,21,0)
^.001^2^2^3120802^^
"^DD",392,392,54,21,1,0)
This field holds the date of reimbursement for use of common
"^DD",392,392,54,21,2,0)
carrier transportation.
"^DD",392,392,54,"DT")
3120116
"^DD",392,392,55,0)
COMMON CARRIER FEE^RNJ10,2^^C;2^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>1000000)!(X<0) X
"^DD",392,392,55,3)
Type a dollar amount between 0 and 1000000, 2 decimal digits.
"^DD",392,392,55,21,0)
^.001^1^1^3120806^^
"^DD",392,392,55,21,1,0)
This is the amount charged for use of the common carrier transportation.
"^DD",392,392,55,"DT")
3120810
"^DD",392,392,55.1,0)
COMMON CARRIER REQUIRED^RS^1:YES;0:NO;^C;3^Q
"^DD",392,392,55.1,3)
Is Common Carrier required?
"^DD",392,392,55.1,21,0)
^^2^2^3120810^
"^DD",392,392,55.1,21,1,0)
Field is used to indicate whether or not the use of a common 
"^DD",392,392,55.1,21,2,0)
carrier was best or only way to travel to a VA medical center.
"^DD",392,392,55.1,"DT")
3120810
"^DD",392,392,56,0)
TYPE OF CLAIM^RS^M:MILEAGE;S:SPECIAL MODE;^0;15^Q
"^DD",392,392,56,.1)
IS THIS FOR A MILEAGE OR SPECIAL MODE CLAIM
"^DD",392,392,56,3)
Choose claim type.
"^DD",392,392,56,21,0)
^.001^1^1^3120807^^
"^DD",392,392,56,21,1,0)
This field indicates what type of claim this is.
"^DD",392,392,56,"AUDIT")
n
"^DD",392,392,56,"DT")
3120807
"^DD",392,392,57,0)
SPECIAL MODE OF TRANSPORTATION^RP392.42'^DGBT(392.42,^SP;1^Q
"^DD",392,392,57,.1)
TYPE OF SPECIAL MODE OF TRANSPORTATION
"^DD",392,392,57,3)
Select the method of the Special Mode of Transportation.
"^DD",392,392,57,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,57,21,1,0)
This is the type of Special Mode of Transportation.
"^DD",392,392,57,"DT")
3120224
"^DD",392,392,58,0)
INVOICE NUMBER^RF^^SP;2^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,58,.1)
VENDOR INVOICE NUMBER
"^DD",392,392,58,3)
Answer must be 1-30 characters in length.
"^DD",392,392,58,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,58,21,1,0)
The field contains the invoice number from the vendor who provided
"^DD",392,392,58,21,2,0)
the special mode of transportation for the patient.
"^DD",392,392,58,"DT")
3120224
"^DD",392,392,59,0)
DATE INVOICE RECEIVED^D^^SP;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,59,.1)
SPECIAL MODE DATE INVOICE RECEIVED
"^DD",392,392,59,3)
Enter the date the invoice was received by the VA from the patient or vendor for the special mode transportation.
"^DD",392,392,59,21,0)
^.001^2^2^3120807^^^^
"^DD",392,392,59,21,1,0)
This is the date the invoice was received by the VA from either the 
"^DD",392,392,59,21,2,0)
patient or the vendor for the special mode transportation.
"^DD",392,392,59,"DT")
3120806
"^DD",392,392,60,0)
TOTAL INVOICE AMOUNT^RNJ9,2^^SP;4^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>100000)!(X<1)!(X?.E1"."3.N) X
"^DD",392,392,60,3)
Type a dollar amount between 1 and 100000, 2 decimal digits.
"^DD",392,392,60,21,0)
^.001^3^3^3120806^^^^
"^DD",392,392,60,21,1,0)
This is the total of all charges by a vendor for the 
"^DD",392,392,60,21,2,0)
transportation of the patient by special mode. This includes all cost 
"^DD",392,392,60,21,3,0)
and special add-on fees.
"^DD",392,392,60,"DT")
3120810
"^DD",392,392,61,0)
BASE RATE FEE^RNJ9,2^^SP;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>100000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,61,3)
Type a dollar amount between 0 and 100,000, 2 decimal digits.
"^DD",392,392,61,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,61,21,1,0)
This is the base rate fee if any, charged by the vendor for 
"^DD",392,392,61,21,2,0)
transporting the patient by special mode.
"^DD",392,392,61,"DT")
3120811
"^DD",392,392,62,0)
MILEAGE FEE^RNJ8,2^^SP;6^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,62,.1)
SPECIAL MODE MILEAGE FEE
"^DD",392,392,62,3)
Type a dollar amount between 0 and 10,000, 2 decimal digits.
"^DD",392,392,62,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,62,21,1,0)
This is the per mile amount charged by the vendor for transporting 
"^DD",392,392,62,21,2,0)
the patient by special mode.
"^DD",392,392,62,"DT")
3120811
"^DD",392,392,63,0)
NO SHOW/NO LOAD FEE^NJ7,2X^^SP;7^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>1000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,63,3)
Type a dollar amount between 1 and 1,000, 2 decimal digits.
"^DD",392,392,63,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,63,21,1,0)
Vendor's charge for a no-show patient.
"^DD",392,392,63,"DT")
3120811
"^DD",392,392,64,0)
WAIT TIME FEE^NJ7,2X^^SP;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>1000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,64,3)
Type a dollar amount between 0 and 1,000, 2 decimal digits.
"^DD",392,392,64,21,0)
^.001^1^1^3120811^^^^
"^DD",392,392,64,21,1,0)
This is the fee charged by the vendor to wait for the patient.
"^DD",392,392,64,"DT")
3120811
"^DD",392,392,65,0)
EXTRA CREW FEE^NJ8,2^^SP;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>10000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,65,3)
Type a dollar amount between 0 and 10,000, 2 decimal digits.
"^DD",392,392,65,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,65,21,1,0)
This is the fee charged by the vendor when extra crew is provided by the 
"^DD",392,392,65,21,2,0)
vendor to transport the patient by special mode.
"^DD",392,392,65,"DT")
3120811
"^DD",392,392,66,0)
SPECIAL EQUIPMENT FEE^NJ7,2^^SP;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>5000)!(X<0)!(X?.E1"."3.N) X
"^DD",392,392,66,3)
Type a dollar amount between 0 and 5,000, 2 decimal digits.
"^DD",392,392,66,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,66,21,1,0)
This is the fee charged by the vendor to provide special equipment during the 
"^DD",392,392,66,21,2,0)
special mode transportation.
"^DD",392,392,66,"DT")
3120811
"^DD",392,392,67,0)
SPECIAL MODE RT/ONE-WAY^RS^R:ROUND TRIP;O:ONE WAY;^SP;11^Q
"^DD",392,392,67,3)
Choose trip type.
"^DD",392,392,67,21,0)
^.001^2^2^3120807^^^^
"^DD",392,392,67,21,1,0)
This field indicates whether the special mode transportation was 
"^DD",392,392,67,21,2,0)
round trip or one way.
"^DD",392,392,67,"DT")
3120224
"^DD",392,392,68,0)
SPECIAL MODE TOTAL MILES^RNJ7,1^^SP;12^K:+X'=X!(X>10000)!(X<0)!(X?.E1"."2.N) X
"^DD",392,392,68,3)
Type a number between 0 and 10000, 1 decimal digit.
"^DD",392,392,68,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,68,21,1,0)
This is the total mileage for the special mode transportation 
"^DD",392,392,68,21,2,0)
trip.
"^DD",392,392,68,"DT")
3120810
"^DD",392,392,69,0)
OTHER SM TRANSPORTATION^F^^SP;25^K:$L(X)>45!($L(X)<3) X
"^DD",392,392,69,.1)
OTHER TYPES OF SM MODE TRANSPORTATION
"^DD",392,392,69,3)
Answer must be 3-45 characters in length.
"^DD",392,392,69,21,0)
^^2^2^3120810^
"^DD",392,392,69,21,1,0)
Other types of special mode transportation used when 'OTHER' is selected 
"^DD",392,392,69,21,2,0)
from the SPECIAL MODE OF TRANSPORTATION (#57) field.
"^DD",392,392,69,"DT")
3120810
"^DD",392,392,70,0)
PRE-AUTHORIZED^RS^1:YES;0:NO;^SP;13^Q
"^DD",392,392,70,3)
Was trip pre-authorized for Special Mode transportation?
"^DD",392,392,70,21,0)
^^2^2^3120810^
"^DD",392,392,70,21,1,0)
This field indicates whether the 
"^DD",392,392,70,21,2,0)
transportation for the Special Mode trip was pre-authorized.
"^DD",392,392,70,"DT")
3120810
"^DD",392,392,71,0)
SPECIAL MODE VENDOR^RP440'^PRC(440,^SP;14^Q
"^DD",392,392,71,3)
Enter the Special Mode Transportation Vendor.
"^DD",392,392,71,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,71,21,1,0)
This is the vendor who supplied the special mode transportation for the patient.
"^DD",392,392,71,"DT")
3120224
"^DD",392,392,72,0)
SPECIAL MODE OTHER REMARKS^F^^SP;26^K:$L(X)>50!($L(X)<3) X
"^DD",392,392,72,3)
Answer must be 3-50 characters in length.
"^DD",392,392,72,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,72,21,1,0)
This field is any additional information  
"^DD",392,392,72,21,2,0)
about the special mode of transportation claim.
"^DD",392,392,72,"DT")
3120202
"^DD",392,392,73,0)
SP MODE DEPARTURE ADDRESS1^RF^^SPAD;1^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,73,.1)
SPECIAL MODE DEPARTURE ADDRESS [LINE1]
"^DD",392,392,73,3)
Answer must be 1-30 characters in length.
"^DD",392,392,73,21,0)
^^2^2^3120814^
"^DD",392,392,73,21,1,0)
Line one of the address the patient departed from for this
"^DD",392,392,73,21,2,0)
claim. It defaults to line one of the patient's home address.
"^DD",392,392,73,"DT")
3120814
"^DD",392,392,74,0)
SP MODE DEPARTURE ADDRESS2^F^^SPAD;2^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,74,.1)
SPECIAL MODE DEPARTURE ADDRESS [LINE2]
"^DD",392,392,74,3)
Answer must be 1-30 characters in length.
"^DD",392,392,74,21,0)
^.001^2^2^3120807^^^
"^DD",392,392,74,21,1,0)
This is the second line of the departure address of the patient. It defaults to 
"^DD",392,392,74,21,2,0)
the patient's 2nd line of their home address.
"^DD",392,392,74,"DT")
3120806
"^DD",392,392,75,0)
SP MODE DEPARTURE CITY^RF^^SPAD;3^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,75,.1)
SPECIAL MODE DEPARTURE CITY
"^DD",392,392,75,3)
Answer must be 1-30 characters in length.
"^DD",392,392,75,21,0)
^.001^2^2^3120807^^^
"^DD",392,392,75,21,1,0)
This is the city the patient departed from for this claim. It 
"^DD",392,392,75,21,2,0)
defaults to the patient's home address city.
"^DD",392,392,75,"DT")
3120806
"^DD",392,392,76,0)
SP MODE DEPARTURE STATE^RP5'^DIC(5,^SPAD;4^Q
"^DD",392,392,76,.1)
SPECIAL MODE DEPARTURE STATE
"^DD",392,392,76,3)
Select the departure state.
"^DD",392,392,76,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,76,21,1,0)
This is the state from which the patient departed for the 
"^DD",392,392,76,21,2,0)
claim. It defaults to the state from the patient's home address.
"^DD",392,392,76,"DT")
3111228
"^DD",392,392,77,0)
SP MODE DEPARTURE ZIP CODE^RFXO^^SPAD;5^K:$L(X)>20!($L(X)<5) X I $D(X) D ZIPIN^VAFADDR
"^DD",392,392,77,.1)
SPECIAL MODE DEPARTURE ZIP CODE
"^DD",392,392,77,2)
S Y(0)=Y D ZIPOUT^VAFADDR
"^DD",392,392,77,2.1)
D ZIPOUT^VAFADDR
"^DD",392,392,77,3)
Answer with either 5 digit or 9 digit zip code.
"^DD",392,392,77,21,0)
^^2^2^3120814^
"^DD",392,392,77,21,1,0)
This is the patient's departure ZIP code for this claim. It 
"^DD",392,392,77,21,2,0)
defaults to the ZIP code from the patient's home address.
"^DD",392,392,77,"DT")
3120814
"^DD",392,392,78,0)
SP MODE DESTINATION 1^RF^^SPAD;6^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,78,.1)
SPECIAL MODE DESTINATION [LINE 1]
"^DD",392,392,78,3)
Answer must be 1-30 characters in length.
"^DD",392,392,78,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,78,21,1,0)
This is line one of the destination address. It defaults 
"^DD",392,392,78,21,2,0)
to the site's address.
"^DD",392,392,78,"DT")
3120218
"^DD",392,392,79,0)
SP MODE DESTINATION 2^F^^SPAD;7^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,79,.1)
SPECIAL MODE DESTINATION [LINE 2]
"^DD",392,392,79,3)
Answer must be 1-30 characters in length.
"^DD",392,392,79,21,0)
^^2^2^3120810^
"^DD",392,392,79,21,1,0)
This is line 2 of the destination address. It defaults to the 
"^DD",392,392,79,21,2,0)
site's address line 2.
"^DD",392,392,79,"DT")
3120810
"^DD",392,392,80,0)
SP MODE DESTINATION 3^F^^SPAD;8^K:$L(X)>30!($L(X)<1) X
"^DD",392,392,80,.1)
SPECIAL MODE DESTINATION [LINE 3]
"^DD",392,392,80,3)
Answer must be 1-30 characters in length.
"^DD",392,392,80,21,0)
^.001^2^2^3120807^^^
"^DD",392,392,80,21,1,0)
This is the third line of the site's address. It defaults to 
"^DD",392,392,80,21,2,0)
the site's address line 3.
"^DD",392,392,80,"DT")
3120806
"^DD",392,392,81,0)
SP MODE DESTINATION CITY^RF^^SPAD;9^K:$L(X)>25!($L(X)<3) X
"^DD",392,392,81,.1)
SPECIAL MODE DESTINATION CITY
"^DD",392,392,81,3)
Answer must be 3-25 characters in length.
"^DD",392,392,81,21,0)
^.001^2^2^3120806^^^^
"^DD",392,392,81,21,1,0)
This is the city the site is located in. It defaults to 
"^DD",392,392,81,21,2,0)
the site's city.
"^DD",392,392,81,"DT")
3111228
"^DD",392,392,82,0)
SP MODE DESTINATION STATE^RP5'^DIC(5,^SPAD;10^Q
"^DD",392,392,82,.1)
SPECIAL MODE DESTINATION STATE
"^DD",392,392,82,3)
Select the state of destination.
"^DD",392,392,82,21,0)
^.001^2^2^3120807^^^^
"^DD",392,392,82,21,1,0)
This is the destination state of the site. It defaults to 
"^DD",392,392,82,21,2,0)
the site's state.
"^DD",392,392,82,"DT")
3111228
"^DD",392,392,83,0)
SP MODE DESTINATION ZIP CODE^RFXO^^SPAD;11^K:$L(X)>20!($L(X)<5) X I $D(X) D ZIPIN^VAFADDR
"^DD",392,392,83,.1)
SPECIAL MODE DESTINATION ZIP CODE
"^DD",392,392,83,2)
S Y(0)=Y D ZIPOUT^VAFADDR
"^DD",392,392,83,2.1)
D ZIPOUT^VAFADDR
"^DD",392,392,83,3)
Answer with either 5 digit or 9 digit zip code.
"^DD",392,392,83,21,0)
^.001^2^2^3120807^^^^
"^DD",392,392,83,21,1,0)
This is the destination ZIP code of the site. It defaults 
"^DD",392,392,83,21,2,0)
to the site's ZIP code.
"^DD",392,392,83,"DT")
3120814
"^DD",392,392,84,0)
PRE-AUTHORIZED BY^P200'^VA(200,^SP;16^Q
"^DD",392,392,84,3)
Enter User who PRE-AUTHORIZED the Claim.
"^DD",392,392,84,21,0)
^.001^2^2^3120806^^
"^DD",392,392,84,21,1,0)
This is User who PRE-AUTHORIZED the Claim. By default it's user who 
"^DD",392,392,84,21,2,0)
entered the claim.
"^DD",392,392,84,"DT")
3120806
"^DD",392,392,85,0)
SPECIAL MODE CLAIM AUTHORIZED^S^1:YES;0:NO;^SP;15^Q
"^DD",392,392,85,.1)
IS SPECIAL MODE CLAIM AUTHORIZED?
"^DD",392,392,85,3)
Enter 'YES' if Special Mode Claim is Authorized, enter 'NO' if Special Mode Claim is Denied.
"^DD",392,392,85,21,0)
^.001^1^1^3120806^^^^
"^DD",392,392,85,21,1,0)
This field indicates whether Special Mode transportation is authorized or denied. 
"^DD",392,392,85,"DT")
3120810
"^DD",392,392,86,0)
DATE/TIME AUTHORIZED^D^^SP;17^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",392,392,86,3)
Enter Date/Time the trip was authorized.
"^DD",392,392,86,21,0)
^.001^2^2^3120807^^^^
"^DD",392,392,86,21,1,0)
This is the date/time the travel was authorized if not a 
"^DD",392,392,86,21,2,0)
pre-authorized trip.
"^DD",392,392,86,"DT")
3120806
"^DD",392.3,392.3,0)
FIELD^^5^5
"^DD",392.3,392.3,0,"DDA")
N
"^DD",392.3,392.3,0,"DT")
3121019
"^DD",392.3,392.3,0,"ID",2)
W "   ",$P(^(0),U,2)
"^DD",392.3,392.3,0,"IX","B",392.3,.01)

"^DD",392.3,392.3,0,"IX","C",392.3,2)

"^DD",392.3,392.3,0,"IX","D",392.3,.01)

"^DD",392.3,392.3,0,"NM","BENEFICIARY TRAVEL ACCOUNT")

"^DD",392.3,392.3,0,"PT",392,6)

"^DD",392.3,392.3,0,"VRPK")
DGBT
"^DD",392.3,392.3,.01,0)
ACCOUNT^RFXI^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!(X'?3.4N1" "1AN.ANP) X
"^DD",392.3,392.3,.01,1,0)
^.1
"^DD",392.3,392.3,.01,1,1,0)
392.3^B
"^DD",392.3,392.3,.01,1,1,1)
S ^DGBT(392.3,"B",$E(X,1,30),DA)=""
"^DD",392.3,392.3,.01,1,1,2)
K ^DGBT(392.3,"B",$E(X,1,30),DA)
"^DD",392.3,392.3,.01,1,2,0)
392.3^D^MUMPS
"^DD",392.3,392.3,.01,1,2,1)
S ^DGBT(392.3,"D",$P(X," ",2,$L(X," ")),DA)=""
"^DD",392.3,392.3,.01,1,2,2)
K ^DGBT(392.3,"D",$P(X," ",2,$L(X," ")),DA)
"^DD",392.3,392.3,.01,3)
Enter account number (three to four numerics) space account name (26 character limit, upper case).
"^DD",392.3,392.3,.01,4)
W !!?5,"Some examples of valid entries follow:",!!?8,"888 SAMPLE",!?8,"1021 SECOND SAMPLE",!!
"^DD",392.3,392.3,.01,9)
^
"^DD",392.3,392.3,.01,21,0)
^.001^3^3^3120611^^
"^DD",392.3,392.3,.01,21,1,0)
This field contains the account number (three to four numerics) a space
"^DD",392.3,392.3,.01,21,2,0)
then the account name (26 characters limit, upper case) associated with
"^DD",392.3,392.3,.01,21,3,0)
the Beneficiary Travel Claims.
"^DD",392.3,392.3,.01,"DEL",1,0)
I 1 W *7,!,"ACCOUNT TYPES CAN NOT BE DELETED!!"
"^DD",392.3,392.3,.01,"DT")
3011030
"^DD",392.3,392.3,2,0)
ACCOUNT NUMBER^RFX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>4!($L(X)<3)!'(X?3.4N) X I $D(X),X'=$P($P(^DGBT(392.3,DA,0),U)," ",1) W !,"Account number must match the number in the ACCOUNT (.01) field." K X
"^DD",392.3,392.3,2,1,0)
^.1
"^DD",392.3,392.3,2,1,1,0)
392.3^C
"^DD",392.3,392.3,2,1,1,1)
S ^DGBT(392.3,"C",$E(X,1,30),DA)=""
"^DD",392.3,392.3,2,1,1,2)
K ^DGBT(392.3,"C",$E(X,1,30),DA)
"^DD",392.3,392.3,2,1,1,"DT")
2931103
"^DD",392.3,392.3,2,3)
Type a three to four character Number between 000 and 9999, No decimal digits.
"^DD",392.3,392.3,2,9)
^
"^DD",392.3,392.3,2,21,0)
^^4^4^3011026^
"^DD",392.3,392.3,2,21,1,0)
 
"^DD",392.3,392.3,2,21,2,0)
This field contains the Account Number (a three to four character number
"^DD",392.3,392.3,2,21,3,0)
between 000 and 9999) and must match the number in the ACCOUNT (.01) field
"^DD",392.3,392.3,2,21,4,0)
of this file associated with the Beneficiary Travel Claims.
"^DD",392.3,392.3,2,"DT")
3011026
"^DD",392.3,392.3,3,0)
ACTIVE DATE^RD^^0;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.3,392.3,3,21,0)
^^1^1^2920123^
"^DD",392.3,392.3,3,21,1,0)
This field contains date this Beneficiary Travel Account became active.
"^DD",392.3,392.3,4,0)
INACTIVE DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.3,392.3,4,21,0)
^^1^1^2920123^
"^DD",392.3,392.3,4,21,1,0)
This field contains the date this Beneficiary Travel Account became inactive.
"^DD",392.3,392.3,5,0)
ACCOUNT TYPE^RS^1:EMERGENCIES;2:INTERFACILITY;3:SPECIAL MODE;4:ALL OTHER;5:C&P EXAMS;^0;5^Q
"^DD",392.3,392.3,5,3)
Select the account type which pertains to the account.
"^DD",392.3,392.3,5,4)

"^DD",392.3,392.3,5,21,0)
^^2^2^2920123^^^^
"^DD",392.3,392.3,5,21,1,0)
Field is designed to group like ACCOUNTs by account type, since the
"^DD",392.3,392.3,5,21,2,0)
account name/number is subject to change.
"^DD",392.3,392.3,5,"DT")
2910212
"^DD",392.41,392.41,0)
FIELD^^1^2
"^DD",392.41,392.41,0,"DDA")
N
"^DD",392.41,392.41,0,"DT")
3120803
"^DD",392.41,392.41,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",392.41,392.41,0,"IX","B",392.41,.01)

"^DD",392.41,392.41,0,"IX","C",392.41,1)

"^DD",392.41,392.41,0,"NM","BT CLAIM ELIGIBILITY CODE")

"^DD",392.41,392.41,0,"PT",392,43.1)

"^DD",392.41,392.41,0,"VRPK")
DGBT
"^DD",392.41,392.41,.01,0)
BT ELIGIBILITY CODE^RNJ2,0^^0;1^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",392.41,392.41,.01,1,0)
^.1
"^DD",392.41,392.41,.01,1,1,0)
392.41^B
"^DD",392.41,392.41,.01,1,1,1)
S ^DGBT(392.41,"B",$E(X,1,30),DA)=""
"^DD",392.41,392.41,.01,1,1,2)
K ^DGBT(392.41,"B",$E(X,1,30),DA)
"^DD",392.41,392.41,.01,3)
Type a number between 1 and 99, 0 decimal digits.
"^DD",392.41,392.41,.01,21,0)
^^1^1^3120807^
"^DD",392.41,392.41,.01,21,1,0)
This is the BT Eligibility Code number.
"^DD",392.41,392.41,.01,"DT")
3120807
"^DD",392.41,392.41,1,0)
BT ELIGIBILITY CODE NAME^RF^^0;2^K:$L(X)>70!($L(X)<1) X
"^DD",392.41,392.41,1,1,0)
^.1
"^DD",392.41,392.41,1,1,1,0)
392.41^C
"^DD",392.41,392.41,1,1,1,1)
S ^DGBT(392.41,"C",$E(X,1,30),DA)=""
"^DD",392.41,392.41,1,1,1,2)
K ^DGBT(392.41,"C",$E(X,1,30),DA)
"^DD",392.41,392.41,1,1,1,"DT")
3120430
"^DD",392.41,392.41,1,3)
Answer must be 1-70 characters in length.
"^DD",392.41,392.41,1,21,0)
^.001^2^2^3120808^^^
"^DD",392.41,392.41,1,21,1,0)
This is the name that is associated with and describes the eligibility 
"^DD",392.41,392.41,1,21,2,0)
code.
"^DD",392.41,392.41,1,"DT")
3120807
"^DD",392.42,392.42,0)
FIELD^^.01^1
"^DD",392.42,392.42,0,"DDA")
N
"^DD",392.42,392.42,0,"DT")
3120806
"^DD",392.42,392.42,0,"IX","B",392.42,.01)

"^DD",392.42,392.42,0,"NM","BT SPECIAL MODE OF TRANSPORTATION")

"^DD",392.42,392.42,0,"PT",392,57)

"^DD",392.42,392.42,0,"VRPK")
DGBT
"^DD",392.42,392.42,.01,0)
NAME^RF^^0;1^K:$L(X)>60!($L(X)<3)!'(X'?1P.E) X
"^DD",392.42,392.42,.01,.1)
SPECIAL MODE OF TRANSPORTATION
"^DD",392.42,392.42,.01,1,0)
^.1
"^DD",392.42,392.42,.01,1,1,0)
392.42^B
"^DD",392.42,392.42,.01,1,1,1)
S ^DGBT(392.42,"B",$E(X,1,30),DA)=""
"^DD",392.42,392.42,.01,1,1,2)
K ^DGBT(392.42,"B",$E(X,1,30),DA)
"^DD",392.42,392.42,.01,3)
Answer must be 3-60 characters in length.
"^DD",392.42,392.42,.01,21,0)
^^1^1^3120807^
"^DD",392.42,392.42,.01,21,1,0)
This is an acceptable type of transportation for special mode patients.
"^DD",392.42,392.42,.01,"AUDIT")
n
"^DD",392.42,392.42,.01,"DT")
3120807
"^DD",392.43,392.43,0)
FIELD^^.01^1
"^DD",392.43,392.43,0,"DDA")
N
"^DD",392.43,392.43,0,"DT")
3120928
"^DD",392.43,392.43,0,"IX","B",392.43,.01)

"^DD",392.43,392.43,0,"NM","BT COMMON CARRIER MODE OF TRANSPORTATION")

"^DD",392.43,392.43,0,"PT",392,44)

"^DD",392.43,392.43,0,"VRPK")
DGBT
"^DD",392.43,392.43,.01,0)
MODE OF TRANSPORTATION^F^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",392.43,392.43,.01,1,0)
^.1
"^DD",392.43,392.43,.01,1,1,0)
392.43^B
"^DD",392.43,392.43,.01,1,1,1)
S ^DGBT(392.43,"B",$E(X,1,30),DA)=""
"^DD",392.43,392.43,.01,1,1,2)
K ^DGBT(392.43,"B",$E(X,1,30),DA)
"^DD",392.43,392.43,.01,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH, ENTER THE TYPE OF TRANSPORTATION USED FOR BENEFICIARY TRAVEL.
"^DD",392.43,392.43,.01,21,0)
^^3^3^3120928^
"^DD",392.43,392.43,.01,21,1,0)
This field contains the free text 3-30 characters in length (name or type)
"^DD",392.43,392.43,.01,21,2,0)
mode of transportation used in the Beneficiary Travel Claims for Common 
"^DD",392.43,392.43,.01,21,3,0)
Carrier.
"^DD",392.43,392.43,.01,"DT")
3120928
"^DD",392.6,392.6,0)
FIELD^^4^5
"^DD",392.6,392.6,0,"DDA")
N
"^DD",392.6,392.6,0,"DT")
3120802
"^DD",392.6,392.6,0,"IX","B",392.6,.01)

"^DD",392.6,392.6,0,"NM","BENEFICIARY TRAVEL DENIAL LETTERS")

"^DD",392.6,392.6,0,"VRPK")
DGBT
"^DD",392.6,392.6,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",392.6,392.6,.01,1,0)
^.1
"^DD",392.6,392.6,.01,1,1,0)
392.6^B
"^DD",392.6,392.6,.01,1,1,1)
S ^DGBT(392.6,"B",$E(X,1,30),DA)=""
"^DD",392.6,392.6,.01,1,1,2)
K ^DGBT(392.6,"B",$E(X,1,30),DA)
"^DD",392.6,392.6,.01,3)
Answer must be 3-30 characters in length.
"^DD",392.6,392.6,.01,21,0)
^^1^1^3120807^
"^DD",392.6,392.6,.01,21,1,0)
This is the name of the denial letter.
"^DD",392.6,392.6,.01,"DT")
3120807
"^DD",392.6,392.6,1,0)
MILEAGE LETTER TEXT PART 1^392.61^^1;0
"^DD",392.6,392.6,1,21,0)
^.001^1^1^3120802^^^^
"^DD",392.6,392.6,1,21,1,0)
Mileage letter text part 1
"^DD",392.6,392.6,2,0)
MILEAGE LETTER TEXT PART 2^392.62^^2;0
"^DD",392.6,392.6,2,21,0)
^^1^1^3120802^
"^DD",392.6,392.6,2,21,1,0)
Mileage letter text part 2
"^DD",392.6,392.6,3,0)
SP MODE LETTER TEXT PART 1^392.63^^3;0
"^DD",392.6,392.6,3,21,0)
^.001^1^1^3120802^^^^
"^DD",392.6,392.6,3,21,1,0)
SP Mode letter text part 1
"^DD",392.6,392.6,4,0)
SP MODE LETTER TEXT PART 2^392.64^^4;0
"^DD",392.6,392.6,4,21,0)
^.001^1^1^3120802^^^
"^DD",392.6,392.6,4,21,1,0)
SP Mode letter text part 2
"^DD",392.6,392.61,0)
MILEAGE LETTER TEXT PART 1 SUB-FIELD^^.01^1
"^DD",392.6,392.61,0,"DT")
3120226
"^DD",392.6,392.61,0,"NM","MILEAGE LETTER TEXT PART 1")

"^DD",392.6,392.61,0,"UP")
392.6
"^DD",392.6,392.61,.01,0)
MILEAGE LETTER TEXT PART 1^Wx^^0;1^Q
"^DD",392.6,392.61,.01,3)
Word processing for mileage denial letter. Cannot be changed without a security key
"^DD",392.6,392.61,.01,21,0)
^.001^2^2^3120802^^^^
"^DD",392.6,392.61,.01,21,1,0)
This field will contain the first part of the letter prior to the denial 
"^DD",392.6,392.61,.01,21,2,0)
reason.
"^DD",392.6,392.61,.01,"DT")
3120226
"^DD",392.6,392.62,0)
MILEAGE LETTER TEXT PART 2 SUB-FIELD^^.01^1
"^DD",392.6,392.62,0,"DT")
3120226
"^DD",392.6,392.62,0,"NM","MILEAGE LETTER TEXT PART 2")

"^DD",392.6,392.62,0,"UP")
392.6
"^DD",392.6,392.62,.01,0)
MILEAGE LETTER TEXT PART 2^Wx^^0;1^Q
"^DD",392.6,392.62,.01,3)
Word processing for mileage denial letter. Cannot be changed wihout a security key
"^DD",392.6,392.62,.01,21,0)
^.001^2^2^3120802^^^^
"^DD",392.6,392.62,.01,21,1,0)
This field will contain the text from the mileage claim denial letter 
"^DD",392.6,392.62,.01,21,2,0)
after the denial reason.
"^DD",392.6,392.62,.01,"DT")
3120226
"^DD",392.6,392.63,0)
SP MODE LETTER TEXT PART 1 SUB-FIELD^^.01^1
"^DD",392.6,392.63,0,"DT")
3120306
"^DD",392.6,392.63,0,"NM","SP MODE LETTER TEXT PART 1")

"^DD",392.6,392.63,0,"UP")
392.6
"^DD",392.6,392.63,.01,0)
SP MODE LETTER TEXT PART 1^Wx^^0;1^Q
"^DD",392.6,392.63,.01,3)
Word processing for SP denial letter.  Cannot be changed without a security key..
"^DD",392.6,392.63,.01,21,0)
^.001^2^2^3120802^^^^
"^DD",392.6,392.63,.01,21,1,0)
This field will contain the top part of the special mode denial letter 
"^DD",392.6,392.63,.01,21,2,0)
before the denial reason is inserted.
"^DD",392.6,392.63,.01,"DT")
3120306
"^DD",392.6,392.64,0)
SP MODE LETTER TEXT PART 2 SUB-FIELD^^.01^1
"^DD",392.6,392.64,0,"DT")
3120306
"^DD",392.6,392.64,0,"NM","SP MODE LETTER TEXT PART 2")

"^DD",392.6,392.64,0,"UP")
392.6
"^DD",392.6,392.64,.01,0)
SP MODE LETTER TEXT PART 2^Wx^^0;1^Q
"^DD",392.6,392.64,.01,3)
word processing for SP denial letter. Cannot be changed without a security key.
"^DD",392.6,392.64,.01,21,0)
^.001^2^2^3120802^^^^
"^DD",392.6,392.64,.01,21,1,0)
This field will contain the bottom part of the special mode denial letter
"^DD",392.6,392.64,.01,21,2,0)
below the denial reason.
"^DD",392.6,392.64,.01,"DT")
3120306
"^DD",392.7,392.7,0)
FIELD^^99^12
"^DD",392.7,392.7,0,"DDA")
N
"^DD",392.7,392.7,0,"DT")
3120820
"^DD",392.7,392.7,0,"IX","B",392.7,.01)

"^DD",392.7,392.7,0,"IX","C",392.7,2)

"^DD",392.7,392.7,0,"NM","BENEFICIARY TRAVEL MANUAL DEDUCTIBLE WAIVER")

"^DD",392.7,392.7,0,"VRPK")
DGBT
"^DD",392.7,392.7,.01,0)
WAIVER REQUEST DATE AND TIME^RDX^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X I $D(X) S DINUM=X
"^DD",392.7,392.7,.01,1,0)
^.1^^-1
"^DD",392.7,392.7,.01,1,1,0)
392.7^B
"^DD",392.7,392.7,.01,1,1,1)
S ^DGBT(392.7,"B",$E(X,1,30),DA)=""
"^DD",392.7,392.7,.01,1,1,2)
K ^DGBT(392.7,"B",$E(X,1,30),DA)
"^DD",392.7,392.7,.01,3)
Type a date between 30 days before CURRENT DATE and CURRENT DATE.
"^DD",392.7,392.7,.01,4)

"^DD",392.7,392.7,.01,21,0)
^.001^1^1^3120820^^^^
"^DD",392.7,392.7,.01,21,1,0)
This is the date/time of the waiver request.
"^DD",392.7,392.7,.01,23,0)
^.001^1^1^3120820^^^^
"^DD",392.7,392.7,.01,23,1,0)
Date checks are done in the routine.
"^DD",392.7,392.7,.01,"DT")
3120810
"^DD",392.7,392.7,2,0)
PATIENT NAME^RP2'I^DPT(^0;2^Q
"^DD",392.7,392.7,2,1,0)
^.1^^-1
"^DD",392.7,392.7,2,1,1,0)
392.7^C
"^DD",392.7,392.7,2,1,1,1)
S ^DGBT(392.7,"C",$E(X,1,30),DA)=""
"^DD",392.7,392.7,2,1,1,2)
K ^DGBT(392.7,"C",$E(X,1,30),DA)
"^DD",392.7,392.7,2,1,1,"DT")
3120306
"^DD",392.7,392.7,2,3)
Select the patient.
"^DD",392.7,392.7,2,21,0)
^^1^1^3120808^
"^DD",392.7,392.7,2,21,1,0)
This is the patient to whom the waiver pertains.
"^DD",392.7,392.7,2,"DT")
3120808
"^DD",392.7,392.7,3,0)
WAIVER STATUS^RS^1:YES;0:NO;^0;3^Q
"^DD",392.7,392.7,3,3)
Is the Waiver Authorized?
"^DD",392.7,392.7,3,21,0)
^^1^1^3120808^
"^DD",392.7,392.7,3,21,1,0)
This indicates whether or not the waiver is authorized.
"^DD",392.7,392.7,3,"DT")
3120808
"^DD",392.7,392.7,4,0)
GRANTED/DENIED BY^RP200'^VA(200,^0;4^Q
"^DD",392.7,392.7,4,3)
Select the person who decided the waiver status.  
"^DD",392.7,392.7,4,21,0)
^^1^1^3120808^
"^DD",392.7,392.7,4,21,1,0)
This is the person who granted/denied the waiver.
"^DD",392.7,392.7,4,"DT")
3120808
"^DD",392.7,392.7,5,0)
WAIVER APPROVAL/DENIAL DATE^RD^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.7,392.7,5,3)
Enter date travel waiver was approved or denied.
"^DD",392.7,392.7,5,21,0)
^^1^1^3120808^
"^DD",392.7,392.7,5,21,1,0)
This is the date the travel waiver was approved or denied.
"^DD",392.7,392.7,5,"DT")
3120808
"^DD",392.7,392.7,6,0)
WAIVER ENTERED BY^RP200'I^VA(200,^0;6^Q
"^DD",392.7,392.7,6,3)
This is the person who entered the waiver status.
"^DD",392.7,392.7,6,21,0)
^.001^1^1^3120820^^^
"^DD",392.7,392.7,6,21,1,0)
Select the person who entered the waiver status.
"^DD",392.7,392.7,6,"DT")
3120808
"^DD",392.7,392.7,7,0)
WAIVER REMARKS^F^^RMK;1^K:$L(X)>235!($L(X)<3) X
"^DD",392.7,392.7,7,3)
Answer must be 3-235 characters in length.
"^DD",392.7,392.7,7,21,0)
^.001^2^2^3120820^^^
"^DD",392.7,392.7,7,21,1,0)
This field contains  user remarks about why the waiver was approved or
"^DD",392.7,392.7,7,21,2,0)
denied.
"^DD",392.7,392.7,7,"DT")
3120808
"^DD",392.7,392.7,8,0)
EXPIRATION DATE^RD^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.7,392.7,8,3)
Enter the date the waiver expires.
"^DD",392.7,392.7,8,21,0)
^.001^2^2^3120810^^
"^DD",392.7,392.7,8,21,1,0)
This is the date the waiver will expire. The expiration date will be set 
"^DD",392.7,392.7,8,21,2,0)
without user intervention.
"^DD",392.7,392.7,8,"DT")
3120810
"^DD",392.7,392.7,9,0)
DATE ENTERED^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.7,392.7,9,3)
Entered without user intervention.
"^DD",392.7,392.7,9,21,0)
^^2^2^3120808^
"^DD",392.7,392.7,9,21,1,0)
This is the date the record was added to the file. It is set by the 
"^DD",392.7,392.7,9,21,2,0)
system. This cannot be changed except by programmer.
"^DD",392.7,392.7,9,"DT")
3120808
"^DD",392.7,392.7,97,0)
DELETION DATE^D^^DEL;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",392.7,392.7,97,3)
Enter the date the manual request was deleted.
"^DD",392.7,392.7,97,21,0)
^^2^2^3120824^
"^DD",392.7,392.7,97,21,1,0)
This is the date the manual waiver request was deleted. This field is set 
"^DD",392.7,392.7,97,21,2,0)
by a routine.
"^DD",392.7,392.7,97,"DT")
3120824
"^DD",392.7,392.7,98,0)
WAIVER DELETED BY^RP200'^VA(200,^DEL;2^Q
"^DD",392.7,392.7,98,3)
Select the person who deleted the waiver request.
"^DD",392.7,392.7,98,21,0)
^^1^1^3120824^
"^DD",392.7,392.7,98,21,1,0)
This is the person who deleted the waiver request.
"^DD",392.7,392.7,98,"DT")
3120824
"^DD",392.7,392.7,99,0)
DELETION REMARKS^RF^^DEL;3^K:$L(X)>100!($L(X)<3) X
"^DD",392.7,392.7,99,3)
Answer must be 3-100 characters in length.
"^DD",392.7,392.7,99,21,0)
^^1^1^3120820^
"^DD",392.7,392.7,99,21,1,0)
This field contains remarks about why the waiver was deleted.
"^DD",392.7,392.7,99,"DT")
3120820
"^DD",392.8,392.8,0)
FIELD^^1^2
"^DD",392.8,392.8,0,"DDA")
N
"^DD",392.8,392.8,0,"DT")
3120810
"^DD",392.8,392.8,0,"IX","B",392.8,.01)

"^DD",392.8,392.8,0,"NM","BENEFICIARY TRAVEL DENIAL REASONS")

"^DD",392.8,392.8,0,"PT",392,45.4)

"^DD",392.8,392.8,0,"VRPK")
DGBT
"^DD",392.8,392.8,.01,0)
DENIAL REASON^RF^^0;1^K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
"^DD",392.8,392.8,.01,.1)

"^DD",392.8,392.8,.01,1,0)
^.1
"^DD",392.8,392.8,.01,1,1,0)
392.8^B
"^DD",392.8,392.8,.01,1,1,1)
S ^DGBT(392.8,"B",$E(X,1,30),DA)=""
"^DD",392.8,392.8,.01,1,1,2)
K ^DGBT(392.8,"B",$E(X,1,30),DA)
"^DD",392.8,392.8,.01,3)
Answer must be 3-50 characters in length.
"^DD",392.8,392.8,.01,21,0)
^^1^1^3120808^
"^DD",392.8,392.8,.01,21,1,0)
This is the reason the Beneficiary Travel is denied.
"^DD",392.8,392.8,.01,"DT")
3120810
"^DD",392.8,392.8,1,0)
TEXT^392.81^^1;0
"^DD",392.8,392.8,1,21,0)
^^1^1^3120809^
"^DD",392.8,392.8,1,21,1,0)
This is the complete explanation for the reason the claim was denied.
"^DD",392.8,392.81,0)
TEXT SUB-FIELD^^.01^1
"^DD",392.8,392.81,0,"DT")
3120301
"^DD",392.8,392.81,0,"NM","TEXT")

"^DD",392.8,392.81,0,"UP")
392.8
"^DD",392.8,392.81,.01,0)
TEXT^Wx^^0;1^Q
"^DD",392.8,392.81,.01,21,0)
^^1^1^3120808^
"^DD",392.8,392.81,.01,21,1,0)
This field will contain the text for the denial reasons.
"^DD",392.8,392.81,.01,"DT")
3120808
"^DD",392.9,392.9,0)
FIELD^^1^2
"^DD",392.9,392.9,0,"DDA")
N
"^DD",392.9,392.9,0,"DT")
3120808
"^DD",392.9,392.9,0,"IX","B",392.9,.01)

"^DD",392.9,392.9,0,"NM","BT PATIENT ALTERNATE INCOME")

"^DD",392.9,392.9,0,"VRPK")
DGBT
"^DD",392.9,392.9,.01,0)
BT PATIENT^RP2'X^DPT(^0;1^S DINUM=X
"^DD",392.9,392.9,.01,1,0)
^.1
"^DD",392.9,392.9,.01,1,1,0)
392.9^B
"^DD",392.9,392.9,.01,1,1,1)
S ^DGBT(392.9,"B",$E(X,1,30),DA)=""
"^DD",392.9,392.9,.01,1,1,2)
K ^DGBT(392.9,"B",$E(X,1,30),DA)
"^DD",392.9,392.9,.01,3)
Select the patient.
"^DD",392.9,392.9,.01,21,0)
^^1^1^3120808^
"^DD",392.9,392.9,.01,21,1,0)
This is the Beneficiary Travel Patient associated with Alternate Income.
"^DD",392.9,392.9,.01,"DT")
3120808
"^DD",392.9,392.9,1,0)
ALTERNATE INCOME^392.91DA^^1;0
"^DD",392.9,392.9,1,21,0)
^^2^2^3120808^
"^DD",392.9,392.9,1,21,1,0)
This is a multiple containing alternate income date, alternate income 
"^DD",392.9,392.9,1,21,2,0)
amount, alternate income reason, and alternate income expiration date.
"^DD",392.9,392.91,0)
ALTERNATE INCOME SUB-FIELD^^3^4
"^DD",392.9,392.91,0,"DT")
3120808
"^DD",392.9,392.91,0,"IX","B",392.91,.01)

"^DD",392.9,392.91,0,"NM","ALTERNATE INCOME")

"^DD",392.9,392.91,0,"UP")
392.9
"^DD",392.9,392.91,.01,0)
ALTERNATE INCOME DATE^RDX^^0;1^S %DT="EST" D ^%DT S X=Y K:X<1 X S:$D(X) DINUM=X
"^DD",392.9,392.91,.01,1,0)
^.1
"^DD",392.9,392.91,.01,1,1,0)
392.91^B
"^DD",392.9,392.91,.01,1,1,1)
S ^DGBT(392.9,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",392.9,392.91,.01,1,1,2)
K ^DGBT(392.9,DA(1),1,"B",$E(X,1,30),DA)
"^DD",392.9,392.91,.01,3)
Enter Date within last 30 days.
"^DD",392.9,392.91,.01,21,0)
^^1^1^3120802^
"^DD",392.9,392.91,.01,21,1,0)
Date Alternate Income starts to be valid.
"^DD",392.9,392.91,.01,"DT")
3120802
"^DD",392.9,392.91,1,0)
ALTERNATE INCOME^RNJ9,2^^0;2^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>100000)!(X<1)!(X?.E1"."3.N) X
"^DD",392.9,392.91,1,.1)
ALTERNATE INCOME AMOUNT
"^DD",392.9,392.91,1,3)
Type a dollar amount between 1 and 100000, 2 decimal digits.
"^DD",392.9,392.91,1,21,0)
^.001^1^1^3120808^^^^
"^DD",392.9,392.91,1,21,1,0)
Dollar Amount of Alternate Income entered in case of POW or Hardship.
"^DD",392.9,392.91,1,"DT")
3120808
"^DD",392.9,392.91,2,0)
ALTERNATE INCOME REASON^RS^P:POW;H:HARDSHIP;^0;3^Q
"^DD",392.9,392.91,2,3)
Choose the reason for alternate income.
"^DD",392.9,392.91,2,21,0)
^^1^1^3120808^
"^DD",392.9,392.91,2,21,1,0)
This is the reason for alternate income.
"^DD",392.9,392.91,2,"DT")
3120808
"^DD",392.9,392.91,3,0)
ALTERNATE INCOME EXPIRATION^RD^^0;4^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",392.9,392.91,3,3)
Enter Date Alternate Income Expires.
"^DD",392.9,392.91,3,21,0)
^^2^2^3120806^
"^DD",392.9,392.91,3,21,1,0)
Expiration Date of Alternate Income. The last day the Alternate Income is 
"^DD",392.9,392.91,3,21,2,0)
valid for.
"^DD",392.9,392.91,3,"DT")
3120806
"^DIC",392,392,0)
BENEFICIARY TRAVEL CLAIM^392ID
"^DIC",392,392,0,"GL")
^DGBT(392,
"^DIC",392,392,"%",0)
^1.005^^0
"^DIC",392,392,"%D",0)
^1.001^2^2^3120928^^^^
"^DIC",392,392,"%D",1,0)
This file contains the completed travel claim entries for patients showing
"^DIC",392,392,"%D",2,0)
departure/destination data, as well as specific claim data.
"^DIC",392,"B","BENEFICIARY TRAVEL CLAIM",392)

"^DIC",392.3,392.3,0)
BENEFICIARY TRAVEL ACCOUNT^392.3I
"^DIC",392.3,392.3,0,"GL")
^DGBT(392.3,
"^DIC",392.3,392.3,"%",0)
^1.005^^0
"^DIC",392.3,392.3,"%D",0)
^1.001^2^2^3120611^^
"^DIC",392.3,392.3,"%D",1,0)
Although this file has be decentralized, changes and additions should be 
"^DIC",392.3,392.3,"%D",2,0)
made with extreme care. 
"^DIC",392.3,"B","BENEFICIARY TRAVEL ACCOUNT",392.3)

"^DIC",392.41,392.41,0)
BT CLAIM ELIGIBILITY CODE^392.41
"^DIC",392.41,392.41,0,"GL")
^DGBT(392.41,
"^DIC",392.41,392.41,"%",0)
^1.005^^0
"^DIC",392.41,392.41,"%D",0)
^^2^2^3120807^
"^DIC",392.41,392.41,"%D",1,0)
This file contains internal codes and descriptions of patients' reasons 
"^DIC",392.41,392.41,"%D",2,0)
for BT eligibility.
"^DIC",392.41,"B","BT CLAIM ELIGIBILITY CODE",392.41)

"^DIC",392.42,392.42,0)
BT SPECIAL MODE OF TRANSPORTATION^392.42
"^DIC",392.42,392.42,0,"GL")
^DGBT(392.42,
"^DIC",392.42,392.42,"%",0)
^1.005^^0
"^DIC",392.42,392.42,"%D",0)
^^2^2^3120807^^
"^DIC",392.42,392.42,"%D",1,0)
The file contains a list of acceptable types of transporation for special 
"^DIC",392.42,392.42,"%D",2,0)
mode patients.
"^DIC",392.42,"B","BT SPECIAL MODE OF TRANSPORTATION",392.42)

"^DIC",392.43,392.43,0)
BT COMMON CARRIER MODE OF TRANSPORTATION^392.43
"^DIC",392.43,392.43,0,"GL")
^DGBT(392.43,
"^DIC",392.43,392.43,"%",0)
^1.005^^0
"^DIC",392.43,"B","BT COMMON CARRIER MODE OF TRANSPORTATION",392.43)

"^DIC",392.6,392.6,0)
BENEFICIARY TRAVEL DENIAL LETTERS^392.6
"^DIC",392.6,392.6,0,"GL")
^DGBT(392.6,
"^DIC",392.6,392.6,"%",0)
^1.005^^0
"^DIC",392.6,392.6,"%D",0)
^^1^1^3120807^
"^DIC",392.6,392.6,"%D",1,0)
This file contains the denial letters the site uses.
"^DIC",392.6,"B","BENEFICIARY TRAVEL DENIAL LETTERS",392.6)

"^DIC",392.7,392.7,0)
BENEFICIARY TRAVEL MANUAL DEDUCTIBLE WAIVER^392.7
"^DIC",392.7,392.7,0,"GL")
^DGBT(392.7,
"^DIC",392.7,392.7,"%",0)
^1.005^1^1
"^DIC",392.7,392.7,"%",1,0)
DGBT
"^DIC",392.7,392.7,"%","B","DGBT",1)

"^DIC",392.7,392.7,"%D",0)
^^2^2^3120809^
"^DIC",392.7,392.7,"%D",1,0)
This file contains the list of patients that have an active manual 
"^DIC",392.7,392.7,"%D",2,0)
waiver at the time the Travel Claim.
"^DIC",392.7,"B","BENEFICIARY TRAVEL MANUAL DEDUCTIBLE WAIVER",392.7)

"^DIC",392.8,392.8,0)
BENEFICIARY TRAVEL DENIAL REASONS^392.8
"^DIC",392.8,392.8,0,"GL")
^DGBT(392.8,
"^DIC",392.8,392.8,"%",0)
^1.005^^0
"^DIC",392.8,392.8,"%D",0)
^^1^1^3120808^
"^DIC",392.8,392.8,"%D",1,0)
This file contains the Beneficiary Travel denial reasons.
"^DIC",392.8,"B","BENEFICIARY TRAVEL DENIAL REASONS",392.8)

"^DIC",392.9,392.9,0)
BT PATIENT ALTERNATE INCOME^392.9
"^DIC",392.9,392.9,0,"GL")
^DGBT(392.9,
"^DIC",392.9,392.9,"%",0)
^1.005^^0
"^DIC",392.9,392.9,"%D",0)
^^1^1^3120808^
"^DIC",392.9,392.9,"%D",1,0)
This file contains alternate income data for patients.
"^DIC",392.9,"B","BT PATIENT ALTERNATE INCOME",392.9)

**END**
**END**
