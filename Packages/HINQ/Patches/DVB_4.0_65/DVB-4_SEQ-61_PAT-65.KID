EMERGENCY Released DVB*4*65 SEQ #61
Extracted from mail message
**KIDS**:DVB*4.0*65^

**INSTALL NAME**
DVB*4.0*65
"BLD",7991,0)
DVB*4.0*65^HINQ^0^3101028^y
"BLD",7991,1,0)
^^4^4^3100817^
"BLD",7991,1,1,0)
Patch for VBA Data Sharing update.
"BLD",7991,1,2,0)
 
"BLD",7991,1,3,0)
See the Patch Description for DVB*4.0*65 as documented in the Forum Patch 
"BLD",7991,1,4,0)
Module.
"BLD",7991,4,0)
^9.64PA^^
"BLD",7991,6)
3^
"BLD",7991,6.3)
19
"BLD",7991,"ABPKG")
n
"BLD",7991,"KRN",0)
^9.67PA^779.2^20
"BLD",7991,"KRN",.4,0)
.4
"BLD",7991,"KRN",.401,0)
.401
"BLD",7991,"KRN",.402,0)
.402
"BLD",7991,"KRN",.403,0)
.403
"BLD",7991,"KRN",.5,0)
.5
"BLD",7991,"KRN",.84,0)
.84
"BLD",7991,"KRN",3.6,0)
3.6
"BLD",7991,"KRN",3.8,0)
3.8
"BLD",7991,"KRN",9.2,0)
9.2
"BLD",7991,"KRN",9.8,0)
9.8
"BLD",7991,"KRN",9.8,"NM",0)
^9.68A^8^7
"BLD",7991,"KRN",9.8,"NM",1,0)
DVBHQM1^^0^B34655117
"BLD",7991,"KRN",9.8,"NM",2,0)
DVBHQM11^^0^B22113835
"BLD",7991,"KRN",9.8,"NM",3,0)
DVBHQR1^^0^B21624161
"BLD",7991,"KRN",9.8,"NM",4,0)
DVBHQR11^^0^B34481907
"BLD",7991,"KRN",9.8,"NM",6,0)
DVBHQM2^^0^B35953581
"BLD",7991,"KRN",9.8,"NM",7,0)
DVBHUTL1^^0^B6884601
"BLD",7991,"KRN",9.8,"NM",8,0)
DVBHQEDT^^0^B22066129
"BLD",7991,"KRN",9.8,"NM","B","DVBHQEDT",8)

"BLD",7991,"KRN",9.8,"NM","B","DVBHQM1",1)

"BLD",7991,"KRN",9.8,"NM","B","DVBHQM11",2)

"BLD",7991,"KRN",9.8,"NM","B","DVBHQM2",6)

"BLD",7991,"KRN",9.8,"NM","B","DVBHQR1",3)

"BLD",7991,"KRN",9.8,"NM","B","DVBHQR11",4)

"BLD",7991,"KRN",9.8,"NM","B","DVBHUTL1",7)

"BLD",7991,"KRN",19,0)
19
"BLD",7991,"KRN",19.1,0)
19.1
"BLD",7991,"KRN",101,0)
101
"BLD",7991,"KRN",409.61,0)
409.61
"BLD",7991,"KRN",771,0)
771
"BLD",7991,"KRN",779.2,0)
779.2
"BLD",7991,"KRN",870,0)
870
"BLD",7991,"KRN",8989.51,0)
8989.51
"BLD",7991,"KRN",8989.52,0)
8989.52
"BLD",7991,"KRN",8994,0)
8994
"BLD",7991,"KRN","B",.4,.4)

"BLD",7991,"KRN","B",.401,.401)

"BLD",7991,"KRN","B",.402,.402)

"BLD",7991,"KRN","B",.403,.403)

"BLD",7991,"KRN","B",.5,.5)

"BLD",7991,"KRN","B",.84,.84)

"BLD",7991,"KRN","B",3.6,3.6)

"BLD",7991,"KRN","B",3.8,3.8)

"BLD",7991,"KRN","B",9.2,9.2)

"BLD",7991,"KRN","B",9.8,9.8)

"BLD",7991,"KRN","B",19,19)

"BLD",7991,"KRN","B",19.1,19.1)

"BLD",7991,"KRN","B",101,101)

"BLD",7991,"KRN","B",409.61,409.61)

"BLD",7991,"KRN","B",771,771)

"BLD",7991,"KRN","B",779.2,779.2)

"BLD",7991,"KRN","B",870,870)

"BLD",7991,"KRN","B",8989.51,8989.51)

"BLD",7991,"KRN","B",8989.52,8989.52)

"BLD",7991,"KRN","B",8994,8994)

"BLD",7991,"QUES",0)
^9.62^^
"BLD",7991,"REQB",0)
^9.611^1^1
"BLD",7991,"REQB",1,0)
DVB*4.0*63^2
"BLD",7991,"REQB","B","DVB*4.0*63",1)

"MBREQ")
0
"PKG",91,-1)
1^1
"PKG",91,0)
HINQ^DVB^HINQ(Hospital Inquiry)
"PKG",91,20,0)
^9.402P^^
"PKG",91,22,0)
^9.49I^1^1
"PKG",91,22,1,0)
4.0^2920325^2960819
"PKG",91,22,1,"PAH",1,0)
65^3101028^100992
"PKG",91,22,1,"PAH",1,1,0)
^^4^4^3101028
"PKG",91,22,1,"PAH",1,1,1,0)
Patch for VBA Data Sharing update.
"PKG",91,22,1,"PAH",1,1,2,0)
 
"PKG",91,22,1,"PAH",1,1,3,0)
See the Patch Description for DVB*4.0*65 as documented in the Forum Patch 
"PKG",91,22,1,"PAH",1,1,4,0)
Module.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","DVBHQEDT")
0^8^B22066129^B21705515
"RTN","DVBHQEDT",1,0)
DVBHQEDT ;ALB/JLU - THIS ROUTINE CHECKS THE ONE MANY ALL INPUT FOR HINQ SCREENS;3/19/90
"RTN","DVBHQEDT",2,0)
 ;;4.0;HINQ;**6,49,65**;03/25/92;Build 19
"RTN","DVBHQEDT",3,0)
A ;ENTRY POINT FROM TEMPLATE DVBHINQEDT
"RTN","DVBHQEDT",4,0)
 S ERROR=0,Z="" K Z2,Z3
"RTN","DVBHQEDT",5,0)
 I "Aa"[ANS D L3 Q
"RTN","DVBHQEDT",6,0)
 I ANS'?.NP S ERROR=1 D ERR Q
"RTN","DVBHQEDT",7,0)
 I +ANS>$E(DVBJS,2) S ERROR=1 D ERR Q
"RTN","DVBHQEDT",8,0)
 I (ANS?1N)!(ANS?1N1",") S Z=$P(ANS,",")_"^" D EX Q
"RTN","DVBHQEDT",9,0)
 I ANS?1N1"-"1N D L0,EX:'ERROR,ERR:ERROR Q
"RTN","DVBHQEDT",10,0)
 F Z0=1:2:$L(ANS) S Z1=$E(ANS,Z0,Z0),Z2=$E(ANS,Z0+1,Z0+1) D L1 Q:ERROR!(Z2="")
"RTN","DVBHQEDT",11,0)
 I 'ERROR F Z4=0:0 S Z4=$O(Z3(Z4)) Q:'Z4  S Z=Z_Z4_"^"
"RTN","DVBHQEDT",12,0)
 I ANS=0 F Z1=1:1:$E(DVBJS,2) S Z=Z_Z1_"^" W Z
"RTN","DVBHQEDT",13,0)
 D ERR:ERROR Q
"RTN","DVBHQEDT",14,0)
EX I $E(Z,$L(Z)-1,$L(Z)-1)>$E(DVBJS,2) W !,"Number too large for selectable numbers." S ERROR=1 D ERR Q
"RTN","DVBHQEDT",15,0)
 Q
"RTN","DVBHQEDT",16,0)
ERR W !!,*7,?9,"Check boundaries and/or syntax and try again.",!,?9,"Use '?' if still having problems OK!!   <RET>" R DVBZ:DTIME K DVBZ Q
"RTN","DVBHQEDT",17,0)
 ;
"RTN","DVBHQEDT",18,0)
L0 I $P(ANS,"-",2)>$P(ANS,"-") F Z1=$P(ANS,"-"):1:$P(ANS,"-",2) S Z=Z_Z1_"^"
"RTN","DVBHQEDT",19,0)
 E  S ERROR=1 Q
"RTN","DVBHQEDT",20,0)
 D ERR:ERROR K Z1 Q
"RTN","DVBHQEDT",21,0)
L1 I Z1'?1N,Z0=1 S ERROR=1 Q
"RTN","DVBHQEDT",22,0)
 I (Z1?1N),((Z2=",")!(Z2="")) S Z3(Z1)="" Q
"RTN","DVBHQEDT",23,0)
 I Z1?1N,Z2="-" D L2 Q
"RTN","DVBHQEDT",24,0)
 Q
"RTN","DVBHQEDT",25,0)
L2 I Z1>$E(ANS,Z0+2,Z0+2) S ERROR=1 Q
"RTN","DVBHQEDT",26,0)
 I $E(ANS,Z0+3,Z0+3)'=",",($E(ANS,Z0+3,Z0+3)'="") S ERROR=1 Q
"RTN","DVBHQEDT",27,0)
 F Z4=Z1:1:$E(ANS,Z0+2,Z0+2) S Z3(Z4)=""
"RTN","DVBHQEDT",28,0)
 S Z0=Z0+2
"RTN","DVBHQEDT",29,0)
 Q
"RTN","DVBHQEDT",30,0)
L3 F Z1=1:1:$E(DVBJS,2) S Z=Z_Z1_"^"
"RTN","DVBHQEDT",31,0)
 Q
"RTN","DVBHQEDT",32,0)
 ;
"RTN","DVBHQEDT",33,0)
B ;THIS IS THE ENTRY POINT FOR THE HELP SCREEN IN THE HINQ UPLOAD.
"RTN","DVBHQEDT",34,0)
 W @$S('$D(IOF):"#",IOF="":"#",1:IOF)
"RTN","DVBHQEDT",35,0)
 W !,?25,DVBON,"HINQ Help Screen",DVBOFF
"RTN","DVBHQEDT",36,0)
 W !!,?5,DVBON,"<RET>",DVBOFF,"  press return to continue on to the next display screen.",!!,?6,DVBON,"'^'",DVBOFF,"   use the up arrow to get out of the upload mode."
"RTN","DVBHQEDT",37,0)
 W !!,?14,"To upload you have a choice of ONE, MANY, or ALL."
"RTN","DVBHQEDT",38,0)
 W !!,?27,DVBON,"N",DVBOFF,"     for a single selection.",!,?27,DVBON,"N,N,N",DVBOFF," for specific fields.",!,?27,DVBON,"N-N",DVBOFF,"   for a range of fields."
"RTN","DVBHQEDT",39,0)
 W !,?27,DVBON,"A",DVBOFF,"     for the entire screen."
"RTN","DVBHQEDT",40,0)
 W !!,?8,"Except for the first screen which is the verification screen,"
"RTN","DVBHQEDT",41,0)
 W !,?8,"highlighted numbers in ",DVBON,"[]",DVBOFF," can be uploaded where as highlighted"
"RTN","DVBHQEDT",42,0)
 W !,?8,"numbers in ",DVBON,"<>",DVBOFF," can not."
"RTN","DVBHQEDT",43,0)
 W !!,?8,"Screen jumping is also allowed to some extent.  You are able"
"RTN","DVBHQEDT",44,0)
 W !,?8,"to jump from any one of the three screens except from 3 to any"
"RTN","DVBHQEDT",45,0)
 W !,?8,"of the others.  1->2  1->3    2->1  2->3  but not 3->N"
"RTN","DVBHQEDT",46,0)
 W !,?8,"The correct format is ^N (Ex. to go from 2 to 1   ^1)"
"RTN","DVBHQEDT",47,0)
 W !!,?20,"<Press return to continue.>"
"RTN","DVBHQEDT",48,0)
 Q
"RTN","DVBHQEDT",49,0)
KA1 K JU,J,JZ,K1,K2,L,L1,X,XX,Y,Z,DFN,DGEDCN,DI,DVBJ2,DVBOFF,DVBON,DVBOUT,I,D0,DVBJA,DVB8,DVB9,ERROR,Y1,DVBY,DVBJ1,ZTSK,DVBLIT,DVBENT,DVBLP,DVBMM,DVBUQ,DVBLIT1,DVBLIT2,DVBS,DVBBLF,DVBBLO,DVBDIQ,DVBX,DVBSCRN
"RTN","DVBHQEDT",50,0)
 K DVBI,DVBUSER,N,O,R,R1,Y0,ANS
"RTN","DVBHQEDT",51,0)
KA K DVBERR,DVBERR1,DVBIXMZ,DVBNETER,DVBOTM,DVBOXMZ,DVBREQST,DVBREQUE,DVBV,DVBAAHB,DVBADR,DVBADRLN,DVBASVC,DVBBOS,DVBCHDOB,DVBCHECK,DVBCHILD,DVBCHNO,DVBCI,DVBCN,DVBCPS,DVBCSVC,DVBDOB,DVBDX,DVBDXNO,DVBDXPCT,DVBDXSC,DVBDXX,DVBENT
"RTN","DVBHQEDT",52,0)
 K DVBEI,DVBEINC,DVBEOD,DVBFIDUC,DVBFL,DVBINC,DVBEOD,DVBLEN,DVBNAME,DVBOINC,DVBP,DVBPOW,DVBPTI,DVBPTIDT,DVBDENTI,DVBRAD,DVBRETO,DVBRETT,DVBRTYP,DVBRTYPE,DVBSPDOB,DVBSPENC,DVBSPETO,DVBSPINC,DVBSPNAM,DVBSPRET,DVBSPSSA,DVBSSA,DVBZIP,DVBSN
"RTN","DVBHQEDT",53,0)
 K DVBPOA,DVBPAT,DVBCAP,DVBBOSRC,DVBCSVC,DVBCSVCN,DVBEODN,DVBNMREC,DVBPNAM,DVBPOWD,DVBRADN,DVBSNREC,DVBSSN,DVBTOTAS,DXS,DVBJS,JL,JU,DIC,DIE,DR,DVB,DVB1,ZTRTN,ZTDESC,ZTIO,POP,DIR,ZTSAVE,DVBJC,JP,Z1,Z2,DVB4,DVB5,DVB6,DVB7,DVBOH
"RTN","DVBHQEDT",54,0)
 K DIQ,DIQ2,DVBADD,DVBBAS,DVBBIR,DVBCHI,DVBDBE,DVBSSAJ,DVBDBF,DVBDIA,DVBFUE,DVBFUF,DVBMM2,DVBMON,DVBREF,DVBV1,DVBV2,DVBVET,DVBWIT,LP,LX,LY,LP1,LP2,DVBSEX
"RTN","DVBHQEDT",55,0)
 Q
"RTN","DVBHQEDT",56,0)
DX ;left to ensure no error
"RTN","DVBHQEDT",57,0)
 Q
"RTN","DVBHQM1")
0^1^B34655117^B34394004
"RTN","DVBHQM1",1,0)
DVBHQM1 ;ISC-ALBANY/PKE/JLU - create mail message;8/27/05 4:18pm
"RTN","DVBHQM1",2,0)
 ;;4.0;HINQ;**49,65**;03/25/92;Build 19
"RTN","DVBHQM1",3,0)
 G EN
"RTN","DVBHQM1",4,0)
LIN Q:CT>200  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM1",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") S:$L(Y)=10 Y=Y_" " Q
"RTN","DVBHQM1",6,0)
 ;
"RTN","DVBHQM1",7,0)
EN S DVBCTN=CT+1
"RTN","DVBHQM1",8,0)
 I $D(DVBNAME),DVBNAME'?7" " S T1="    VBA name = "_DVBNAME D LIN
"RTN","DVBHQM1",9,0)
 I $D(DVBPNAM) S T1=" Prior names =" D LIN S T1="" F I=0:0 S I=$O(DVBPNAM(I)) Q:I=""  D
"RTN","DVBHQM1",10,0)
 . S T1="       "_DVBPNAM(I)
"RTN","DVBHQM1",11,0)
 . D LIN
"RTN","DVBHQM1",12,0)
 ;I $D(DVBPNAM) D LIN
"RTN","DVBHQM1",13,0)
 I $D(DVBADRLN),+DVBADRLN F G=1:1:$S(DVBADRLN<7:DVBADRLN,1:0) I $D(DVBADR(G)) S CT=CT+1,A1=A_CT_",0)",@A1="     "_$S(G=1:"   Name",1:"Address")_" = "_DVBADR(G)
"RTN","DVBHQM1",14,0)
 I $D(DVBZIP),DVBZIP'?9" " S T1="         ZIP = "_DVBZIP D LIN
"RTN","DVBHQM1",15,0)
2 ;
"RTN","DVBHQM1",16,0)
 I $D(DVBVET),$P(DVBVET,U,1)'="C" S T1="          Sex = "_$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")_$E(BL,1,29)_$S($P(DVBVET,U,2)=" ":"",1:"BLIND Ind.") D LIN I 1
"RTN","DVBHQM1",17,0)
 E  I $D(DVBBIR) S T1="          Sex = "_$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"") D LIN
"RTN","DVBHQM1",18,0)
 ;
"RTN","DVBHQM1",19,0)
 I $D(DVBDOB),DVBDOB?8N S M=$E(DVBDOB,1,2) D MM^DVBHQM11 S T1="Date of Birth = "_M_" "_$S(+$E(DVBDOB,3,4)>0:$E(DVBDOB,3,4)_", ",1:" ")_$E(DVBDOB,5,8) D LIN
"RTN","DVBHQM1",20,0)
 I $D(DVBP(6)),$P(DVBP(6),U) S M=$E(DVBP(6),1,2) D MM^DVBHQM11 S T1="Date of Death = "_M_" "_$S(+$E(DVBP(6),3,4)>0:$E(DVBP(6),3,4)_", ",1:" ")_$E(DVBP(6),5,8) D LIN
"RTN","DVBHQM1",21,0)
 ;;;I $D(DVBP(6)),$P(DVBP(6),U) S Y=$P(DVBP(6),U) D DD S T1="Date of Death = "_Y D LIN
"RTN","DVBHQM1",22,0)
P6 I $P($G(DVBREF),U)'?9N I $D(DVBSSN),+DVBSSN S T1="    VBA SSN = "_DVBSSN D VSS,LIN
"RTN","DVBHQM1",23,0)
P61 D P4^DVBHQM11
"RTN","DVBHQM1",24,0)
 ;
"RTN","DVBHQM1",25,0)
 D BLOCK^DVBHQM12
"RTN","DVBHQM1",26,0)
 ;
"RTN","DVBHQM1",27,0)
10 ;if DVBCSVC(2) is populated, kill DVBCSVC(1) - DVB*4*49
"RTN","DVBHQM1",28,0)
 I $G(DVBCSVC(2))]"" K DVBCSVC(1)
"RTN","DVBHQM1",29,0)
 I $D(DVBCSVC) S T1=" Char of Svc: " F I=0:0 S I=$O(DVBCSVC(I)) D:I="" LIN Q:I=""  S Y=DVBCSVC(I) D DISCHG:I=1 S:I>1 Y=$$DISCH2(DVBCSVC(I)) S T1=T1_Y
"RTN","DVBHQM1",30,0)
 ;
"RTN","DVBHQM1",31,0)
 ;Additional Service is no longer being sent, DVB*4*49
"RTN","DVBHQM1",32,0)
 ;
"RTN","DVBHQM1",33,0)
 ;DVB*4.0*65
"RTN","DVBHQM1",34,0)
 D P1^DVBHQM11,P6^DVBHQM11,P5^DVBHQM11,P3^DVBHQM11
"RTN","DVBHQM1",35,0)
 ;
"RTN","DVBHQM1",36,0)
11 K DVBNMREC,DVBBOSRC,DVBCSVCN,DVBEODN,DVBRADN,DVBSNREC,DVBPNAM,DVBSN,DVBCSVC,DVBPOA,DVBRAD,DVBEOD,DVBPOWD,DVBTOTAS,DVBASVC,DVBNM,DVBNSVC,DVBPOW,DVBSN,DVBBOS,DVBCN,DVBDOB,DVBADRLN,DVBZIP,DVBNAM,DVBADR,DVBSSN
"RTN","DVBHQM1",37,0)
 ;
"RTN","DVBHQM1",38,0)
 ;I $D(DVBDXPCT) S T1="    Combined % Disability = "_+DVBDXPCT D LIN
"RTN","DVBHQM1",39,0)
 ;I $D(DVBDXNO),+DVBDXNO S T1="         Disabilities = "_DVBDXNO D LIN
"RTN","DVBHQM1",40,0)
 ;I $D(DVBDXX) S T1="  Additional Disabilities = "_DVBDXX D LIN
"RTN","DVBHQM1",41,0)
 ;
"RTN","DVBHQM1",42,0)
 S T1="DISABILITIES" D LIN
"RTN","DVBHQM1",43,0)
 S T1="Combined %="_$S($D(DVBDXPCT):+DVBDXPCT,1:"  ")_"     "
"RTN","DVBHQM1",44,0)
 S T1=T1_"Disab. in Record="_$S($D(DVBDXNO):DVBDXNO,1:"   ")
"RTN","DVBHQM1",45,0)
 I $G(DVBEFF)]"",DVBEFF'="        " S M=$E(DVBEFF,1,2) D MM^DVBHQM11 S DVBEFF=M_" "_$E(DVBEFF,3,4)_","_$E(DVBEFF,5,8)
"RTN","DVBHQM1",46,0)
 S T1=T1_"     Eff. Date of Comb. Eval.="_$G(DVBEFF)
"RTN","DVBHQM1",47,0)
 D LIN S T1="" D LIN
"RTN","DVBHQM1",48,0)
 I $D(DVBDX)>9 D
"RTN","DVBHQM1",49,0)
 . S T1="                                                     "
"RTN","DVBHQM1",50,0)
 . S T1=T1_"       Orig       Curr" D LIN
"RTN","DVBHQM1",51,0)
 . S T1="     SC Disability                       "
"RTN","DVBHQM1",52,0)
 . S T1=T1_"         %  Extr   Eff Dt     Eff Dt"
"RTN","DVBHQM1",53,0)
 . D LIN
"RTN","DVBHQM1",54,0)
 ;
"RTN","DVBHQM1",55,0)
DX I $D(DVBDX)>9 F I=0:0 S I=$O(DVBDX(I)) Q:'I!(I>DVBDXNO)  S Y=DVBDX(I) D DX1 I +Y S T1=Y D LIN
"RTN","DVBHQM1",56,0)
 ;
"RTN","DVBHQM1",57,0)
BBIRLS I $G(DVBDXVER)="N" D ERR
"RTN","DVBHQM1",58,0)
 S T1=" " D LIN
"RTN","DVBHQM1",59,0)
 K DVBFL,DVBDXX,DVBDXNO,DVBDX,DVBDXPCT
"RTN","DVBHQM1",60,0)
 G EN^DVBHQM2
"RTN","DVBHQM1",61,0)
 ;
"RTN","DVBHQM1",62,0)
SVC ;
"RTN","DVBHQM1",63,0)
 ;
"RTN","DVBHQM1",64,0)
DISCHG S DVBV1=Y,Y=$S(Y=1:"HONORABLE ",Y=2:"OTHER THAN HONORABLE ",Y=3:"DISHONORABLE ",Y=4:"HON VA PUR. ",Y=5:"DISHON VA PUR. ",Y=0!(Y=" "):"UNVERIFIED  ",1:"            ")
"RTN","DVBHQM1",65,0)
 Q
"RTN","DVBHQM1",66,0)
DISCH2(DVBD) ;this will handle codes from Corporate
"RTN","DVBHQM1",67,0)
 ;DVBD is the code for character of discharge
"RTN","DVBHQM1",68,0)
 N DVBDD
"RTN","DVBHQM1",69,0)
 S DVBD=$$UP^XLFSTR(DVBD)
"RTN","DVBHQM1",70,0)
 S DVBDD=$S(DVBD="HON":"Honorable",DVBD="BAD":"Bad Conduct",DVBD="DIS":"Dishonorable",DVBD="DVA":"Dis for VA Pur",DVBD="GEN":"General",DVBD="HVA":"Hon for VA Pur",DVBD="OTH":"Other than Hon",1:"")
"RTN","DVBHQM1",71,0)
 I $G(DVBDD)="" S DVBDD=$S(DVBD="UNC":"Unchar",DVBD="UEL":"Unchar-Entry Lev",DVBD="UHC":"Under Hon Cond",DVBD="UNK":"Unknown",DVBD="UNS":"Unsuitable",DVBD="UNV":"Unverified",1:DVBD)
"RTN","DVBHQM1",72,0)
 S DVBD="                     "
"RTN","DVBHQM1",73,0)
 S DVBD=DVBDD_$E(DVBD,$L(DVBDD)+1,22) ;longest str=21 chars, pad w/1 char
"RTN","DVBHQM1",74,0)
 Q DVBD
"RTN","DVBHQM1",75,0)
 ;
"RTN","DVBHQM1",76,0)
ASVC S Z=$S(Z=0:"None",Z=1:"Wartime and/or Peacetime",Z=2:"Peacetime",Z=3:"Less than 90 days wartime, has SC disability",Z=4:"18-29 months continuous service (CH34)",Z=" ":"Not an issue",1:Z) Q
"RTN","DVBHQM1",77,0)
 ;
"RTN","DVBHQM1",78,0)
DX1 I '+Y!(Y["-") S Y=0 Q
"RTN","DVBHQM1",79,0)
 ;I '+$P(Y,U,2) S DVBDX(I)=+Y_" - "_$E(BL,1,32)
"RTN","DVBHQM1",80,0)
 I '+$P(Y,U,2) S DVBDX(I)=+Y_" - Code not in local file-see ADPAC"
"RTN","DVBHQM1",81,0)
 E  S DVBDX(I)=+Y_"-"_$E($P(^DIC(31,$P(Y,U,2),0),U),1,43)_$E(BL,1,43-$L($P(^(0),U)))
"RTN","DVBHQM1",82,0)
 N DVBCURR,DVBORIG
"RTN","DVBHQM1",83,0)
 S DVBORIG=$S($P(Y,U,5)]"":$P(Y,U,5),1:"")
"RTN","DVBHQM1",84,0)
 S DVBCURR=$S($P(Y,U,6)]"":$P(Y,U,6),1:"")
"RTN","DVBHQM1",85,0)
 I $G(DVBORIG)'="        ",$G(DVBORIG)]"" S M=$E(DVBORIG,1,2) D MM^DVBHQM11 S DVBORIG=M_" "_$E(DVBORIG,3,4)_","_$E(DVBORIG,5,8)
"RTN","DVBHQM1",86,0)
 I $G(DVBCURR)'="        ",$G(DVBCURR)]"" S M=$E(DVBCURR,1,2) D MM^DVBHQM11 S DVBCURR=M_" "_$E(DVBCURR,3,4)_","_$E(DVBCURR,5,8)
"RTN","DVBHQM1",87,0)
 S DVBDX(I)=DVBDX(I)_"-"_$S($P(Y,U,3)'["X":$P(Y,U,3),$P(Y,U,3)="X0":"100",1:"..")_"%-"_$S($P(Y,U,4)]"":$P(Y,U,4),1:"  ")_"-"
"RTN","DVBHQM1",88,0)
 S DVBDX(I)=DVBDX(I)_$S($G(DVBORIG)]"":DVBORIG,1:$E(BL,1,11))_"-"_$G(DVBCURR)
"RTN","DVBHQM1",89,0)
 S Y=DVBDX(I)
"RTN","DVBHQM1",90,0)
 Q
"RTN","DVBHQM1",91,0)
 ;
"RTN","DVBHQM1",92,0)
VSS I $D(DVBP(6)) S C=$P(DVBP(6),U,3) I C S T1=T1_$S(C=1:" Verified SSA",C=2:" Verified VBA",C=4:" Verified by BIRLS",C=9:" SSA Verified No Number Exists",C=0:" Un verified",C=3:" Not Required, Child Under 2",1:" "_C) K C
"RTN","DVBHQM1",93,0)
 Q
"RTN","DVBHQM1",94,0)
 ;
"RTN","DVBHQM1",95,0)
ERR ;These are the error messages for the BIRLS only equivalent record
"RTN","DVBHQM1",96,0)
 ;which is possibly not verified (DVB*4*49) 
"RTN","DVBHQM1",97,0)
 ;
"RTN","DVBHQM1",98,0)
 S T1=" " D LIN
"RTN","DVBHQM1",99,0)
 S T1="             Diagnostic Verified Indicator is NO." D LIN
"RTN","DVBHQM1",100,0)
 S T1="      Verify Service Connections "_$S($D(DVBFL):"at "_DVBFL,1:"with VBA") D LIN
"RTN","DVBHQM1",101,0)
 S T1=" " D LIN
"RTN","DVBHQM1",102,0)
 Q
"RTN","DVBHQM11")
0^2^B22113835^B14847772
"RTN","DVBHQM11",1,0)
DVBHQM11 ;ISC-ALBANY/JLU/PKE - create mail message;10/27/87  10:50
"RTN","DVBHQM11",2,0)
 ;;4.0;HINQ;**7,20,49,65**;03/25/92;Build 19
"RTN","DVBHQM11",3,0)
 ;
"RTN","DVBHQM11",4,0)
LIN Q:CT>100  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM11",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") S:$L(Y)=10 Y=Y_" " Q
"RTN","DVBHQM11",6,0)
 ;
"RTN","DVBHQM11",7,0)
MM S M=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",M) Q
"RTN","DVBHQM11",8,0)
 ;
"RTN","DVBHQM11",9,0)
P1 Q:'$D(DVBP(1))
"RTN","DVBHQM11",10,0)
 S T1=$P(DVBP(1),U,4)
"RTN","DVBHQM11",11,0)
 I T1'="" D
"RTN","DVBHQM11",12,0)
 . ;VBA is no longer sending entitlement code, but AAC is computing a
"RTN","DVBHQM11",13,0)
 . ;type of benefit code from the information sent. DVB*4*49  
"RTN","DVBHQM11",14,0)
 . S T1="Type Benefit: "_$S($P(DVBP(1),U,4)="01":"Compensation",$P(DVBP(1),U,4)="0L":"Pension",1:" ")
"RTN","DVBHQM11",15,0)
 . D LIN
"RTN","DVBHQM11",16,0)
 ;VBA will be sending all records as Type "A" records, so Record Type
"RTN","DVBHQM11",17,0)
 ;will no longer display
"RTN","DVBHQM11",18,0)
 Q
"RTN","DVBHQM11",19,0)
 ;
"RTN","DVBHQM11",20,0)
P2 Q:'$D(DVBP(2))
"RTN","DVBHQM11",21,0)
 S T1=" " D LIN S T1=$P(DVBP(2),U) I T1'="  " S Z=$O(^DVB(395.2,"B",T1,"")) I Z S S="   Anatomical loss = ",ST=$P(^DVB(395.2,Z,0),U,2)_" - "_T1 D WRAP
"RTN","DVBHQM11",22,0)
 S T1=$P(DVBP(2),U,3) I T1'="  " S Z=$O(^DVB(395.2,"B",T1,"")) I Z S T1="       Loss of use = "_$P(^DVB(395.2,Z,0),U,2)_" - "_T1 D LIN
"RTN","DVBHQM11",23,0)
 S T1=$P(DVBP(2),U,4) I T1'=" " D OLC^DVBHQM13 I Z'="" S T1="        Other loss = "_Z_" - "_T1 D LIN
"RTN","DVBHQM11",24,0)
 S T1=$P(DVBP(2),U,5) D VMV^DVBHQM13 I Z'="" S S="   Vet married Vet = ",ST=Z D WRAP
"RTN","DVBHQM11",25,0)
 ;Special Monthly Comp. will no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM11",26,0)
 ;Special Provision will no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM11",27,0)
 Q
"RTN","DVBHQM11",28,0)
 ;
"RTN","DVBHQM11",29,0)
P3 Q  ;P3 concerns future data - after DVB*4*49 there will be none
"RTN","DVBHQM11",30,0)
 Q:'$D(DVBP(3))
"RTN","DVBHQM11",31,0)
 I $P(DVBP(3),U,3)="RR" S T1="Future data present - contact RO !!" D LIN Q
"RTN","DVBHQM11",32,0)
 I $P(DVBFUE,U,22) S T1="Amount PFOP Deduction = "_"$"_$E($P(DVBFUE,U,22),1,4)_"."_$E($P(DVBFUE,U,22),5,6) D LIN Q
"RTN","DVBHQM11",33,0)
 I $P(DVBP(3),U)="A" D T4 F XX=1:1:T4 S T3=$P(DVBP(3),U,XX+2) I T3?7N1E S M=$E(T3,5,6) D MM,T5,EMP,HD S ST="  "_M_", "_$E(T3,1,4)_"  "_$S(Z:$P(^DVB(395.4,Z,0),U,2),1:"")_" - "_DVBV1,S=" " D WRAP
"RTN","DVBHQM11",34,0)
 D EMP Q
"RTN","DVBHQM11",35,0)
 ;
"RTN","DVBHQM11",36,0)
P4 Q:'$D(DVBREF)
"RTN","DVBHQM11",37,0)
 I $P(DVBREF,U,3)?9N S T1="Cross Reference number = "_$P(DVBREF,U,3) D LIN
"RTN","DVBHQM11",38,0)
 I $P(DVBREF,U)?9N S T1="     VBA SSN = "_$P(DVBREF,U) D VSS,LIN
"RTN","DVBHQM11",39,0)
 S T1=" " D LIN
"RTN","DVBHQM11",40,0)
 Q
"RTN","DVBHQM11",41,0)
 ;
"RTN","DVBHQM11",42,0)
P5 Q:'$D(DVBP(5))  S T1=$P(DVBP(5),U) I T1 S T1="PFOP Balance : "_" $"_+$E(T1,1,6)_"."_$E(T1,7,8) D LIN Q
"RTN","DVBHQM11",43,0)
 ;
"RTN","DVBHQM11",44,0)
 Q
"RTN","DVBHQM11",45,0)
 ;
"RTN","DVBHQM11",46,0)
 ;DVB*4.0*65
"RTN","DVBHQM11",47,0)
P6 ;
"RTN","DVBHQM11",48,0)
 I $P(DVBP(1),U,10)>0 S M=$E($P(DVBP(1),U,10),1,2) D MM^DVBHQM11 D
"RTN","DVBHQM11",49,0)
 . S T1="Pension Award Eff Date = "_M_" "_$S(+$E($P(DVBP(1),U,10),3,4)>0:$E($P(DVBP(1),U,10),3,4)_", ",1:" ")_$E($P(DVBP(1),U,10),5,8) S:$P(DVBP(1),U,11)]"" T1=T1_"            Reason code = "_$P(DVBP(1),U,11) D LIN
"RTN","DVBHQM11",50,0)
 I $P(DVBP(1),U,12)>0 S M=$E($P(DVBP(1),U,12),1,2) D MM^DVBHQM11 D
"RTN","DVBHQM11",51,0)
 . S T1="    Pension Terminated = "_M_" "_$S(+$E($P(DVBP(1),U,12),3,4)>0:$E($P(DVBP(1),U,12),3,4)_", ",1:" ")_$E($P(DVBP(1),U,12),5,8) S:$P(DVBP(1),U,13)]"" T1=T1_"            Reason code = "_$P(DVBP(1),U,13) D LIN
"RTN","DVBHQM11",52,0)
 I $P(DVBP(1),U,14)'?1" "." " S T1="                                                 Reason code = "_$P(DVBP(1),U,14) D LIN
"RTN","DVBHQM11",53,0)
 I $P(DVBP(1),U,15)'?1" "." " S T1="                                                 Reason code = "_$P(DVBP(1),U,15) D LIN
"RTN","DVBHQM11",54,0)
 I $P(DVBP(1),U,16)'?1" "." " S T1="                                                 Reason code = "_$P(DVBP(1),U,16) D LIN
"RTN","DVBHQM11",55,0)
 ;
"RTN","DVBHQM11",56,0)
 Q
"RTN","DVBHQM11",57,0)
 ;
"RTN","DVBHQM11",58,0)
EMP S T1=" " D LIN Q
"RTN","DVBHQM11",59,0)
 ;
"RTN","DVBHQM11",60,0)
HD S T1="Diary data:" D LIN Q
"RTN","DVBHQM11",61,0)
T4 S T4=$P(DVBP(3),U,2) Q
"RTN","DVBHQM11",62,0)
 ;
"RTN","DVBHQM11",63,0)
T5 S DVBV1=$E(T3,7,8)
"RTN","DVBHQM11",64,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL
"RTN","DVBHQM11",65,0)
 S Z=$O(^DVB(395.4,"B",DVBV1,""))
"RTN","DVBHQM11",66,0)
 Q
"RTN","DVBHQM11",67,0)
 ;
"RTN","DVBHQM11",68,0)
WRAP S B=$L(S),GL=$P((($L(ST)+B/78)+.9),"."),SP=1,V=78-B,$P(T," ",B+1)=""
"RTN","DVBHQM11",69,0)
 F LP=1:1:GL S Z=$E(ST,V*LP) D:Z=" "!(Z="") SET D:Z'=" "&(Z'="") PAR
"RTN","DVBHQM11",70,0)
 K GL,LP,LP1,Z,Z1,EP,SP,ST,B,V,T,S Q
"RTN","DVBHQM11",71,0)
SET S T1=$E(ST,SP,V*LP) S:SP=1 T1=S_T1 S:SP'=1 T1=T_T1 S SP=V*LP+1 D LIN Q
"RTN","DVBHQM11",72,0)
PAR F LP1=1:1 S EP=(V*LP)-LP1,Z1=$E(ST,EP) Q:Z1=" "
"RTN","DVBHQM11",73,0)
 S T1=$E(ST,SP,EP) S:SP=1 T1=S_T1 S:SP'=1 T1=T_T1 S SP=EP+1 D LIN Q
"RTN","DVBHQM11",74,0)
 ;
"RTN","DVBHQM11",75,0)
VSS I $D(DVBP(1)) S C=$P(DVBP(1),U,8) I C]"" S T1=T1_$S(C=1:" Verified SSA",C=2:" Verified VBA",C=4:" Verified by BIRLS",C=9:" SSA Verified No Number Exists",C=0:" Unverified",C=3:" Not Required, Child Under 2",1:" "_C) K C
"RTN","DVBHQM11",76,0)
 Q
"RTN","DVBHQM2")
0^6^B35953581^B31832375
"RTN","DVBHQM2",1,0)
DVBHQM2 ;ISC-ALBANY/PKE - MAIL DELIVERY PROGRAM;6/10/09 6:01pm
"RTN","DVBHQM2",2,0)
 ;;4.0;HINQ;**49,63,65**;03/25/92;Build 19
"RTN","DVBHQM2",3,0)
 G EN
"RTN","DVBHQM2",4,0)
LIN S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM2",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") Q
"RTN","DVBHQM2",6,0)
 ;
"RTN","DVBHQM2",7,0)
EN ;P&T now sent by VBA, 2=no, 3=yes, else null
"RTN","DVBHQM2",8,0)
 I $D(DVBPTI),((DVBPTI=2)!(DVBPTI=3)) S DVBPTI=$S(DVBPTI=2:"No",DVBPTI=3:"Yes",1:""),T1="    Perm.,Total Disability = "_DVBPTI D LIN
"RTN","DVBHQM2",9,0)
 ;DVB*4*65
"RTN","DVBHQM2",10,0)
 I $D(DVBPTI),($G(DVBPTIDT)>0) S M=$E(DVBPTIDT,1,2) D MM^DVBHQM11 S T1="    Perm.,Total Disability Eff Date = "_M_" "_$S(+$E(DVBPTIDT,3,4)>0:$E(DVBPTIDT,3,4)_", ",1:" ")_$E(DVBPTIDT,5,8) D LIN
"RTN","DVBHQM2",11,0)
 I $D(DVBAAHB),((DVBAAHB="A")!(DVBAAHB="H")) S Y=DVBAAHB S Y=$S(Y="A":"A&A Paid",Y="H":"Housebound Paid",1:"") S T1="             AID & ATTEND = "_Y D LIN
"RTN","DVBHQM2",12,0)
 I $D(DVBFIDUC),(DVBFIDUC>0) S T1="Chief Attorney, fiduciary = "_DVBFIDUC D LIN
"RTN","DVBHQM2",13,0)
 ;;;I $D(DVBFIDUC),DVBFIDUC,$D(^DIC(4,DVBFIDUC,0)) S DVBFIDUC=$P(^(0),U),T1="Chief Attorney, fiduciary = "_DVBFIDUC D LIN
"RTN","DVBHQM2",14,0)
 ;VBA field is Unemployable, codes will Y=Unemploy, N=Employ DVB*4*49 
"RTN","DVBHQM2",15,0)
 I $D(DVBEI),((DVBEI="N")!(DVBEI="Y")) S DVBEI=$S(DVBEI="N":"Employable or not an issue",DVBEI="Y":"Unemployable",1:""),T1="     Employable indicator = "_DVBEI D LIN
"RTN","DVBHQM2",16,0)
 ;new VBA codes, I=incompetent or C=competent DVB*4*49
"RTN","DVBHQM2",17,0)
 I $D(DVBCI),((DVBCI'=" ")) S DVBCI=$S(DVBCI=1!(DVBCI="C"):"Competent, or not an issue",DVBCI="I"!(DVBCI="2"):"Incompetent",1:DVBCI),T1="     Competency indicator = "_DVBCI D LIN
"RTN","DVBHQM2",18,0)
 ;Severence Recoup, PFOP, Competency Pay Status  and Consol Payment will
"RTN","DVBHQM2",19,0)
 ;no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM2",20,0)
 ;DVB*4*65
"RTN","DVBHQM2",21,0)
 I $D(DVBDENTI),((DVBDENTI'=" ")) S DVBDENTI=$S(DVBDENTI="Y":"    Dental Treatment provided at discharge",DVBDENTI="N":"    No dental treatment at discharge",1:DVBDENTI),T1=DVBDENTI D LIN
"RTN","DVBHQM2",22,0)
 ;
"RTN","DVBHQM2",23,0)
 I $D(DVBP(2)) D P2^DVBHQM11
"RTN","DVBHQM2",24,0)
PNX I $D(DVBSPNAM),DVBSPNAM'?10" " S T1=" " D LIN S T1="Spouse name = "_DVBSPNAM D SDB,LIN
"RTN","DVBHQM2",25,0)
 S T1="" D LIN
"RTN","DVBHQM2",26,0)
 S T1="          "
"RTN","DVBHQM2",27,0)
 ;CHAMPVA no longer sent by VBA - DVB*4*49
"RTN","DVBHQM2",28,0)
 K C I $D(DVBBAS(1)) F N=32:1:35 I $P(DVBBAS(1),U,N) D SHDR Q
"RTN","DVBHQM2",29,0)
 I $D(C) D COUNT ;DVB*4*49 - some fields for C not sent by VBA any more
"RTN","DVBHQM2",30,0)
 ;so calculate from Child Status field
"RTN","DVBHQM2",31,0)
 I $D(C) D LIN S T1="",$P(T1,"-",80)="" D LIN S T1="School = "_$P(C,U,3)_"   Helpless School = "_$P(C,U,4)_"   Depend. total = "_$$DEP($P(C,U,1))_"   This Award = "_$$DEP($P(C,U,2)) D LIN
"RTN","DVBHQM2",32,0)
 I '$D(C),T1'["Not" S T1=$E(T1,1,23) D LIN
"RTN","DVBHQM2",33,0)
 K C
"RTN","DVBHQM2",34,0)
 I $D(DVBCHILD) S T1="" D LIN S T1="Child name        DOB       Child Status" D LIN
"RTN","DVBHQM2",35,0)
 I $D(DVBCHILD) F DVBC=0:0 S DVBC=$O(DVBCHILD(DVBC)) Q:'DVBC  S DVBDOB=$P(DVBCHILD(DVBC),U,3),V=$P(DVBCHILD(DVBC),U),T1=$P(DVBCHILD(DVBC),U,2) D CDATE,CHILD D
"RTN","DVBHQM2",36,0)
 . F DVBB=$L(T1):1:10 S T1=T1_" "
"RTN","DVBHQM2",37,0)
 . S T1=T1_"   "_$E(Y_" ",1,11)_"   "_V D LIN
"RTN","DVBHQM2",38,0)
 K DVBPSNAM,DVBSPDOB,DVBCHILD,DVBDOB,V
"RTN","DVBHQM2",39,0)
 ;
"RTN","DVBHQM2",40,0)
 ;-8
"RTN","DVBHQM2",41,0)
 ;with DVB*4*49 Hardship Exp no longer sent by VBA, so removed from line
"RTN","DVBHQM2",42,0)
 S T1=" " D LIN
"RTN","DVBHQM2",43,0)
 S T1="Check Amount= '''                Net Award= '''"
"RTN","DVBHQM2",44,0)
 I $D(DVBBAS(1)) S $P(T1,"'",5,6)="$"_$P(DVBBAS(1),U,20)
"RTN","DVBHQM2",45,0)
 I $D(DVBCHECK) S $P(T1,"'",2,3)="$"_DVBCHECK
"RTN","DVBHQM2",46,0)
 ;I $P(^DIC(8,$P(^DPT(DFN,.36),U),0),U)'="NSC" D LIN
"RTN","DVBHQM2",47,0)
 D LIN
"RTN","DVBHQM2",48,0)
 K DVBCAP
"RTN","DVBHQM2",49,0)
 ;
"RTN","DVBHQM2",50,0)
RINC ;
"RTN","DVBHQM2",51,0)
 I $G(DVBINC)]"" I +$P(DVBINC,U,15)>0 S T1="                Income for VA Purposes= '$"_$P(DVBINC,U,15)_".00'" D LIN
"RTN","DVBHQM2",52,0)
 ;
"RTN","DVBHQM2",53,0)
EX ;
"RTN","DVBHQM2",54,0)
 K C,T2,T1,DVBDXPCT,DVBPT,DVBPTI,DVBPTIDT,DVBDENTI,DVBAAHB,DVBFIDUC,DVBEI,DVBCI,DVBCPS,DVBSPNAM,DVBSPDOB,DVBCHILD,DVBDOB,V,DVBCHECK,Y
"RTN","DVBHQM2",55,0)
 D ADD^DVBHQM31
"RTN","DVBHQM2",56,0)
 G ERR^DVBHQM3 ;with DVB*4*49 no call made to EN^DVBHQM3
"RTN","DVBHQM2",57,0)
 ;
"RTN","DVBHQM2",58,0)
SHDR S T1=T1_"             Number of CHILDREN"
"RTN","DVBHQM2",59,0)
 I N>31 S C=$P(DVBBAS(1),U,32,35) Q
"RTN","DVBHQM2",60,0)
 ;
"RTN","DVBHQM2",61,0)
RHDR S T1="" D LIN
"RTN","DVBHQM2",62,0)
 S T1="last date    previously    INCOME REPORTED              amount, type" D LIN
"RTN","DVBHQM2",63,0)
 S T1="Reported     Reported    This Year   For VA purposes   Medical or Last Expense" D LIN
"RTN","DVBHQM2",64,0)
 S T1="",$P(T1,"-",80)="" D LIN Q
"RTN","DVBHQM2",65,0)
 ;
"RTN","DVBHQM2",66,0)
FILLER S T1="" F N=14,12,13,15,16,17 I N'=16 S T2=$S(N'=14:"$",1:"")_+$P(DVBINC,U,N),T1=T1_$J(T2,6) S:N<16 T1=T1_"       " I N=17 S T2=$P(DVBINC,U,16) D RTYP S T1=T1_" "_T2 D LIN S T1="" D LIN
"RTN","DVBHQM2",67,0)
 Q
"RTN","DVBHQM2",68,0)
 ;
"RTN","DVBHQM2",69,0)
RTYP S T2=$S(T2=" ":T2,T2="B":"SS/Other",T2="C":"Unusual Med.Exp.",T2="O":"Other",T2="R":"10%Ret.Pay excl.",T2="S":"Social Security",1:"") Q
"RTN","DVBHQM2",70,0)
 ;
"RTN","DVBHQM2",71,0)
AAA S V=Y S:Y>3&(Y<8) V=Y-4 S V=$S(V=0:"HB and/or A&A TERM",V=1:"HOSPITALIZED, HB,A&A PAY",V=2:"PAY A&A",V=3:"HB ONLY ",V=" ":"HB and/or A&A NOT GRANTED",1:"") I +Y,Y>3&(Y<8) S Y=V_", INCREMENT FOR SPOUSE" Q
"RTN","DVBHQM2",72,0)
 S Y=V Q
"RTN","DVBHQM2",73,0)
 ;
"RTN","DVBHQM2",74,0)
CHILD Q:$G(V)'?1U  S V=$S(V="H":"Helpless Child",V="M":"Minor Child",V="N":"Not an award dep.",V="S":"School Child",V="U":"Unclaimed DIC Child",1:"")
"RTN","DVBHQM2",75,0)
 Q
"RTN","DVBHQM2",76,0)
 ;
"RTN","DVBHQM2",77,0)
CPS S Y=$S(Y=1:"Competent,or not an issue,Pay direct",Y=2:"Incompetent by VA, Court .. pay fiduciary",Y=3:"Incompetent by Court, .. pay fiduciary",Y=4:"Competent by Court, Incompetent by VA .. pay direct",Y=5:"Supervised direct pay",1:Y) Q
"RTN","DVBHQM2",78,0)
 ;
"RTN","DVBHQM2",79,0)
SDB I $D(DVBSPDOB),DVBSPDOB I DVBSPDOB?8N S M=$E(DVBSPDOB,1,2) D MM^DVBHQM11 S T1=T1_"    DOB = "_M_" "_$S(+$E(DVBSPDOB,3,4)>0:$E(DVBSPDOB,3,4)_", ",1:" ")_$E(DVBSPDOB,5,8) K M
"RTN","DVBHQM2",80,0)
 Q
"RTN","DVBHQM2",81,0)
 ;
"RTN","DVBHQM2",82,0)
CDATE I DVBDOB'?8N S Y="" Q
"RTN","DVBHQM2",83,0)
 ;change CDATE to receive date as MMDDYYYY - DVB*4*49
"RTN","DVBHQM2",84,0)
 ;change to take in an eight digit date - DVB*4*63
"RTN","DVBHQM2",85,0)
 S M=$E(DVBDOB,1,2) D MM^DVBHQM11
"RTN","DVBHQM2",86,0)
 S Y=M_" "_$S(+$E(DVBDOB,3,4)>0:$E(DVBDOB,3,4)_",",1:" ")_$E(DVBDOB,5,8)
"RTN","DVBHQM2",87,0)
 Q
"RTN","DVBHQM2",88,0)
DEP(X) ;;V-S^V-S-F^V-S-M^V-S-2P^V-F^V-M^V-2P^V^
"RTN","DVBHQM2",89,0)
 ;Dependency codes
"RTN","DVBHQM2",90,0)
 Q:X>89 X Q:X'?2N X
"RTN","DVBHQM2",91,0)
 I X="00" S X="V" Q X
"RTN","DVBHQM2",92,0)
 I X="80" S X="V-C" Q X
"RTN","DVBHQM2",93,0)
 I $E(X,2)=0 S X=$P($P($T(DEP),";;",2),"^",$E(X,1)) Q X
"RTN","DVBHQM2",94,0)
 I X?2N S X=$P($P($T(DEP),";;",2),"^",$E(X,1))_"-"_$E(X,2)_"C" Q X
"RTN","DVBHQM2",95,0)
 Q X
"RTN","DVBHQM2",96,0)
COUNT ;loop through the DVBCHILD array and count the total, helpless and 
"RTN","DVBHQM2",97,0)
 ;school children
"RTN","DVBHQM2",98,0)
 N DVBC,DVBH,DVBS,DVBT
"RTN","DVBHQM2",99,0)
 S (DVBC,DVBH,DVBS,DVBT)=0
"RTN","DVBHQM2",100,0)
 F  S DVBC=$O(DVBCHILD(DVBC)) Q:DVBC'>0  D
"RTN","DVBHQM2",101,0)
 . I $P(DVBCHILD(DVBC),U)="H" S DVBH=DVBH+1
"RTN","DVBHQM2",102,0)
 . I $P(DVBCHILD(DVBC),U)="S" S DVBS=DVBS+1
"RTN","DVBHQM2",103,0)
 . S DVBT=DVBT+1
"RTN","DVBHQM2",104,0)
 S C=DVBT_"^"_+$P(C,U,2)_"^"_DVBS_"^"_DVBH
"RTN","DVBHQM2",105,0)
 Q
"RTN","DVBHQR1")
0^3^B21624161^B21400838
"RTN","DVBHQR1",1,0)
DVBHQR1 ;ISC-ALBANY/PKE/JLU - parse HINQ response;27 SEP 85  10:56 am
"RTN","DVBHQR1",2,0)
 ;;4.0;HINQ;**5,32,53,49,65**;03/25/92;Build 19
"RTN","DVBHQR1",3,0)
 ; PROCESSING THE C&P RECORD AND THEN THE BIRLS RECORD
"RTN","DVBHQR1",4,0)
BASIC S DFN=+$E(X(1),8,21),DVBLEN=$E(X(1),22,25),X=$E(X(1),26,999),DVBCN=$E(X,1,9)
"RTN","DVBHQR1",5,0)
 ;
"RTN","DVBHQR1",6,0)
 ;DVB*4*49 - claim # no longer coming as last 2 chars first
"RTN","DVBHQR1",7,0)
 S $P(DVBBAS(1),U,3)=$E(X,10),$P(DVBBAS(1),U,4)=$E(X,11,12)
"RTN","DVBHQR1",8,0)
 S $P(DVBBAS(1),U,5)=$E(X,13,17),$P(DVBBAS(1),U,6)="A"
"RTN","DVBHQR1",9,0)
 ;all records after DVB*4*49 will be sent as type "A"
"RTN","DVBHQR1",10,0)
 ;beginning of basic seg A,B,C,E,F
"RTN","DVBHQR1",11,0)
 S DVBNAME=$E(X,19,25)
"RTN","DVBHQR1",12,0)
 S $P(DVBBAS(1),U,8)=$E(X,26,27)
"RTN","DVBHQR1",13,0)
 S $P(DVBBAS(1),U,9)=$E(X,28),$P(DVBBAS(1),U,10)=$E(X,29,33)
"RTN","DVBHQR1",14,0)
 S DVBFL=$E(X,34,35)
"RTN","DVBHQR1",15,0)
 I +DVBFL S Y=$S($D(^DIC(4,"D",3_DVBFL)):$O(^(3_DVBFL,"")),$D(^DIC(4,"D",4_DVBFL)):$O(^(4_DVBFL,"")),1:"") I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:""),DVBFL=Y
"RTN","DVBHQR1",16,0)
 I DVBFL="" S DVBFL="UNABLE TO DETERMINE"
"RTN","DVBHQR1",17,0)
 S $P(DVBBAS(1),U,12)=$E(X,36),$P(DVBBAS(1),U,13)=$E(X,37)
"RTN","DVBHQR1",18,0)
 S $P(DVBBAS(1),U,14)=$E(X,38),$P(DVBBAS(1),U,15)=$E(X,39)
"RTN","DVBHQR1",19,0)
 S $P(DVBBAS(1),U,16)=$E(X,40)
"RTN","DVBHQR1",20,0)
 S DVBV1=$E(X,41)
"RTN","DVBHQR1",21,0)
 ;I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL
"RTN","DVBHQR1",22,0)
 S $P(DVBBAS(1),U,17)=DVBV1
"RTN","DVBHQR1",23,0)
 S $P(DVBBAS(1),U,18)=$E(X,42)
"RTN","DVBHQR1",24,0)
 I $P(DVBBAS(1),U,6)="D" S $P(DVBBAS(1),U,19)=$E(X,43),$P(DVBBAS(1),U,20)=$E(X,44,45) S L=161 D RON G STAT^DVBHQR11 ;end of  BASIC D segment
"RTN","DVBHQR1",25,0)
 S $P(DVBBAS(1),U,19)=$E(X,43,45)
"RTN","DVBHQR1",26,0)
 S DVBV1=+$E(X,46,51)
"RTN","DVBHQR1",27,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",28,0)
 S $P(DVBBAS(1),U,20)=+$E(DVBV1,1,$L(DVBV1)-2)_"."_$E(DVBV1,$L(DVBV1)-1,$L(DVBV1))
"RTN","DVBHQR1",29,0)
 S L=52 D RON
"RTN","DVBHQR1",30,0)
 S $P(DVBBAS(1),U,21)=$E(X,1,8)
"RTN","DVBHQR1",31,0)
 S DVBV1=+$E(X,9,14)
"RTN","DVBHQR1",32,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",33,0)
 S DVBCHECK=+$E(DVBV1,1,$L(DVBV1)-2)_"."_$E(DVBV1,$L(DVBV1)-1,$L(DVBV1))
"RTN","DVBHQR1",34,0)
 S $P(DVBBAS(1),U,23)=$E(X,15)
"RTN","DVBHQR1",35,0)
 S $P(DVBP(1),U,4)=$E(X,16,17)
"RTN","DVBHQR1",36,0)
 S DVBV1=$E(X,18)
"RTN","DVBHQR1",37,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",38,0)
 S DVBADRLN=DVBV1
"RTN","DVBHQR1",39,0)
 S DVBV1=$E(X,19)
"RTN","DVBHQR1",40,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",41,0)
 S $P(DVBBAS(1),U,26)=DVBV1
"RTN","DVBHQR1",42,0)
 S $P(DVBBAS(1),U,27)=$E(X,20)
"RTN","DVBHQR1",43,0)
 S DVBFIDUC=$E(X,21,22)
"RTN","DVBHQR1",44,0)
 I +DVBFIDUC S Y=$S($D(^DIC(4,"D",3_DVBFIDUC)):$O(^(3_DVBFIDUC,"")),$D(^DIC(4,"D",4_DVBFIDUC)):$O(^(4_DVBFIDUC,"")),1:"") I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:""),DVBFIDUC=Y
"RTN","DVBHQR1",45,0)
 I DVBFIDUC=99 S DVBFIDUC=""
"RTN","DVBHQR1",46,0)
 S $P(DVBBAS(1),U,29)=$E(X,23,24),$P(DVBBAS(1),U,30)=$E(X,25)
"RTN","DVBHQR1",47,0)
 S $P(DVBBAS(1),U,31)=$E(X,26),$P(DVBBAS(1),U,32)=$E(X,27,28)
"RTN","DVBHQR1",48,0)
 S $P(DVBBAS(1),U,33)=$E(X,29,30),$P(DVBBAS(1),U,34)=$E(X,31)
"RTN","DVBHQR1",49,0)
 S $P(DVBBAS(1),U,35)=$E(X,32)
"RTN","DVBHQR1",50,0)
 ;need to calculate power of attorney from C&P
"RTN","DVBHQR1",51,0)
 S DVBPOA="0"_$E(X,33,34) D POA^DVBHQR2
"RTN","DVBHQR1",52,0)
 S $P(DVBBAS(1),U,37)=$E(X,35)
"RTN","DVBHQR1",53,0)
 S DVBV1=$E(X,36)
"RTN","DVBHQR1",54,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",55,0)
 S $P(DVBBAS(1),U,38)=DVBV1
"RTN","DVBHQR1",56,0)
 S $P(DVBBAS(1),U,39)=$E(X,37,41),$P(DVBBAS(1),U,40)=$E(X,42,43)
"RTN","DVBHQR1",57,0)
 S $P(DVBP(1),U,5)=$E(X,44,45)
"RTN","DVBHQR1",58,0)
 S $P(DVBBAS(1),U,42)=$E(X,46,47)
"RTN","DVBHQR1",59,0)
 S DVBAAHB=$E(X,48)
"RTN","DVBHQR1",60,0)
 S L=49 D RON
"RTN","DVBHQR1",61,0)
 S $P(DVBBAS(2),U,1)=$E(X,1),$P(DVBBAS(2),U,2)=$E(X,2)
"RTN","DVBHQR1",62,0)
 S $P(DVBP(1),U,8)=$E(X,3)
"RTN","DVBHQR1",63,0)
 S $P(DVBBAS(2),U,4)=$E(X,4)
"RTN","DVBHQR1",64,0)
 S $P(DVBBAS(2),U,5)=$E(X,5),$P(DVBBAS(2),U,6)=$E(X,6)
"RTN","DVBHQR1",65,0)
 S $P(DVBBAS(2),U,7)=$E(X,7),$P(DVBBAS(2),U,8)=$E(X,8)
"RTN","DVBHQR1",66,0)
 S $P(DVBBAS(2),U,9)=$E(X,9),$P(DVBBAS(2),U,10)=$E(X,10)
"RTN","DVBHQR1",67,0)
 S $P(DVBP(1),U,2)=$E(X,11),$P(DVBP(1),U,1)=$E(X,12)
"RTN","DVBHQR1",68,0)
 S $P(DVBP(1),U,7)=$E(X,13),$P(DVBP(1),U,6)=$E(X,14)
"RTN","DVBHQR1",69,0)
 S DVBCSVC(1)=$E(X,15)
"RTN","DVBHQR1",70,0)
 ;;;S DVBCSVC(1)=5
"RTN","DVBHQR1",71,0)
 S $P(DVBP(1),U,3)=$E(X,16,23)
"RTN","DVBHQR1",72,0)
 S $P(DVBBAS(2),U,17)=$E(X,24)
"RTN","DVBHQR1",73,0)
 S $P(DVBBAS(2),U,18)=$E(X,25),$P(DVBBAS(2),U,19)=$E(X,26)
"RTN","DVBHQR1",74,0)
 S DVBPOW=$E(X,27)
"RTN","DVBHQR1",75,0)
 S $P(DVBBAS(2),U,21)=$E(X,28),$P(DVBBAS(2),U,22)=$E(X,29)
"RTN","DVBHQR1",76,0)
 S $P(DVBBAS(2),U,23)=$E(X,30),$P(DVBBAS(2),U,24)=$E(X,31)
"RTN","DVBHQR1",77,0)
 S $P(DVBBAS(2),U,25)=$E(X,32),$P(DVBBAS(2),U,26)=$E(X,33)
"RTN","DVBHQR1",78,0)
 S $P(DVBBAS(2),U,27)=$E(X,34),$P(DVBBAS(2),U,28)=$E(X,35)
"RTN","DVBHQR1",79,0)
 S $P(DVBBAS(2),U,29)=$E(X,36),$P(DVBBAS(2),U,30)=$E(X,37)
"RTN","DVBHQR1",80,0)
 S $P(DVBBAS(2),U,31)=$E(X,38),$P(DVBBAS(2),U,32)=$E(X,39)
"RTN","DVBHQR1",81,0)
 S $P(DVBBAS(2),U,33)=$E(X,40),$P(DVBBAS(2),U,34)=$E(X,41)
"RTN","DVBHQR1",82,0)
 S $P(DVBBAS(2),U,35)=$E(X,42),$P(DVBBAS(2),U,36)=$E(X,43)
"RTN","DVBHQR1",83,0)
 S $P(DVBBAS(2),U,37)=$E(X,44),$P(DVBBAS(2),U,38)=$E(X,45)
"RTN","DVBHQR1",84,0)
 S $P(DVBBAS(2),U,39)=$E(X,46),$P(DVBBAS(2),U,40)=$E(X,47)
"RTN","DVBHQR1",85,0)
 S $P(DVBBAS(2),U,41)=$E(X,48),$P(DVBBAS(2),U,42)=$E(X,49)
"RTN","DVBHQR1",86,0)
 S $P(DVBBAS(2),U,43)=$E(X,50),$P(DVBBAS(2),U,44)=$E(X,51)
"RTN","DVBHQR1",87,0)
 S $P(DVBBAS(2),U,45)=$E(X,52),$P(DVBBAS(2),U,46)=$E(X,53)
"RTN","DVBHQR1",88,0)
 S $P(DVBBAS(2),U,47)=$E(X,54),$P(DVBBAS(2),U,48)=$E(X,55,57)
"RTN","DVBHQR1",89,0)
 S $P(DVBBAS(2),U,49)=$E(X,58),$P(DVBBAS(2),U,50)=$E(X,59,61)
"RTN","DVBHQR1",90,0)
 S L=62 D RON
"RTN","DVBHQR1",91,0)
 ;
"RTN","DVBHQR1",92,0)
 ;check pension dates DVB*4.0*65
"RTN","DVBHQR1",93,0)
 D PENSION^DVBHQR11
"RTN","DVBHQR1",94,0)
 ;
"RTN","DVBHQR1",95,0)
 ;end of basic segment A,B,C,E,F
"RTN","DVBHQR1",96,0)
 ;
"RTN","DVBHQR1",97,0)
 G STAT^DVBHQR11
"RTN","DVBHQR1",98,0)
 ;
"RTN","DVBHQR1",99,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR1",100,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR1",101,0)
 Q
"RTN","DVBHQR1",102,0)
 ;
"RTN","DVBHQR1",103,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR1",104,0)
 ;;;I $D(X(3)),'$D(X(2)) S X(2)=X(3) K X(3) I $D(X(4)),'$D(X(3)) S X(3)=X(4) K X(4) I $D(X(5)),'$D(X(4)) S X(4)=X(5) K X(5)
"RTN","DVBHQR1",105,0)
 QUIT
"RTN","DVBHQR1",106,0)
END K NAM,NUM Q
"RTN","DVBHQR1",107,0)
 Q
"RTN","DVBHQR11")
0^4^B34481907^B30574454
"RTN","DVBHQR11",1,0)
DVBHQR11 ;ISC-ALBANY/PKE - parse HINQ response;6/10/09 7:39pm
"RTN","DVBHQR11",2,0)
 ;;4.0;HINQ;**32,35,49,63,65**;03/25/92;Build 19
"RTN","DVBHQR11",3,0)
 ;
"RTN","DVBHQR11",4,0)
 ;
"RTN","DVBHQR11",5,0)
STAT ;Parse Statistics Segment for the records that have it.
"RTN","DVBHQR11",6,0)
 I ($P(DVBBAS(1),U,6)="A"!($P(DVBBAS(1),U,6)="E")),$P(DVBBAS(1),U,4)="00" D ASTAT
"RTN","DVBHQR11",7,0)
 I $P(DVBBAS(1),U,6)="B"!($P(DVBBAS(1),U,6)="F") D BSTAT
"RTN","DVBHQR11",8,0)
 I $P(DVBBAS(1),U,6)="E",$P(DVBBAS(1),U,4)'="00" D BSTAT
"RTN","DVBHQR11",9,0)
 I $P(DVBBAS(1),U,6)="C",$P(DVBBAS(1),U,4)=10 D CSTAT
"RTN","DVBHQR11",10,0)
 I $P(DVBBAS(1),U,6)="C",$P(DVBBAS(1),U,4)'=10 S DVBVET="C^^^^"
"RTN","DVBHQR11",11,0)
 ;
"RTN","DVBHQR11",12,0)
 G CHILD ;changing the order of the response message - diag will
"RTN","DVBHQR11",13,0)
 ;come at the very end to accommodate variable length records
"RTN","DVBHQR11",14,0)
 ;
"RTN","DVBHQR11",15,0)
DIAG ;Diagnostics Segment.
"RTN","DVBHQR11",16,0)
 K DXP,DX,DVBDX,DVBEFF
"RTN","DVBHQR11",17,0)
 N DVBCUR,DVBEXT,DVBORIG
"RTN","DVBHQR11",18,0)
 ;with the HINQ replacement, interim solution (DVB*4*49) there are 
"RTN","DVBHQR11",19,0)
 ;several changes to the diagnostic segment.  Total # codes, Add'l
"RTN","DVBHQR11",20,0)
 ;codes, length of segment are not longer being sent.  # SC Codes is
"RTN","DVBHQR11",21,0)
 ;being stored in DVBDXNO.  The for loop at DIAG+15 will terminate
"RTN","DVBHQR11",22,0)
 ;after DVBDXNO, the 6 code limit from VBA has been increased to 150.
"RTN","DVBHQR11",23,0)
 ;Total # of SC Diagnostic Codes.
"RTN","DVBHQR11",24,0)
 S DVBV1=$E(X,1,3)
"RTN","DVBHQR11",25,0)
 I DVBV1["{" S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)  ;????
"RTN","DVBHQR11",26,0)
 S DVBDXNO=+DVBV1
"RTN","DVBHQR11",27,0)
 ;Combined Degree of Disability, Effective Date of Combined SC% Eval
"RTN","DVBHQR11",28,0)
 S DVBDXPCT=$E(X,4,6)
"RTN","DVBHQR11",29,0)
 S DVBDXPCT=$TR(DVBDXPCT," ")
"RTN","DVBHQR11",30,0)
 S DVBEFF=$E(X,7,14)
"RTN","DVBHQR11",31,0)
 S DVBEFF=$TR(DVBEFF," ")
"RTN","DVBHQR11",32,0)
 S L=15 D RON S L=1
"RTN","DVBHQR11",33,0)
 ;Y=Diagnostic Codes; DXP(I)=Percent of Disability:
"RTN","DVBHQR11",34,0)
 F I=1:1:DVBDXNO D
"RTN","DVBHQR11",35,0)
 . D RON S L=1
"RTN","DVBHQR11",36,0)
 . I $E(X,L,L+3)["    "!($E(X,L,L+3)']"") S L=L+25 Q
"RTN","DVBHQR11",37,0)
 . S Y=$E(X,L,L+3),DXP(I)=$E(X,L+4,L+6)
"RTN","DVBHQR11",38,0)
 . S DVBEXT(I)=$E(X,L+7,L+8)
"RTN","DVBHQR11",39,0)
 . S DVBEXT(I)=$TR(DVBEXT(I)," ")
"RTN","DVBHQR11",40,0)
 . S DVBORIG(I)=$E(X,L+9,L+16)
"RTN","DVBHQR11",41,0)
 . S DVBORIG(I)=$TR(DVBORIG(I)," ")
"RTN","DVBHQR11",42,0)
 . S DVBCUR(I)=$E(X,L+17,L+24)
"RTN","DVBHQR11",43,0)
 . S DVBCUR(I)=$TR(DVBCUR(I)," ")
"RTN","DVBHQR11",44,0)
 . S L=L+25 I DXP(I)'="   " S DX(I)="" F J=1:1:4 S Z=$E(Y,J) S:Z'?1N Z=$A(Z)-64 S:Z>9 Z=0 S DX(I)=DX(I)_Z
"RTN","DVBHQR11",45,0)
 F I=0:0 S I=$O(DX(I)) Q:'I  S Y=DX(I),DX(I)=$S($O(^DIC(31,"C",+DX(I),0)):$O(^(0)),1:"") S DVBDX(I)=Y_"^"_DX(I)_"^"_DXP(I)_"^"_$G(DVBEXT(I))_"^"_$G(DVBORIG(I))_"^"_$G(DVBCUR(I))
"RTN","DVBHQR11",46,0)
 ;
"RTN","DVBHQR11",47,0)
 ;sorting by SC% so that they will be saved and displayed that way
"RTN","DVBHQR11",48,0)
 N DVBCT,DVBDD,DVBE,DVBEE
"RTN","DVBHQR11",49,0)
 F DVBE=0:0 S DVBE=$O(DVBDX(DVBE)) Q:DVBE'>0  S DVBDD(+$P(DVBDX(DVBE),U,3),DVBE)=DVBDX(DVBE)
"RTN","DVBHQR11",50,0)
 S DVBE="",DVBCT=1
"RTN","DVBHQR11",51,0)
 F  S DVBE=$O(DVBDD(DVBE),-1) Q:DVBE']""  D
"RTN","DVBHQR11",52,0)
 . F DVBEE=0:0 S DVBEE=$O(DVBDD(DVBE,DVBEE)) Q:DVBEE'>0  D
"RTN","DVBHQR11",53,0)
 . . S DVBDX(DVBCT)=DVBDD(DVBE,DVBEE) S DVBCT=DVBCT+1
"RTN","DVBHQR11",54,0)
 K DVBDD,DX,DXP
"RTN","DVBHQR11",55,0)
 Q
"RTN","DVBHQR11",56,0)
 S L=L+1 D RON
"RTN","DVBHQR11",57,0)
 ;
"RTN","DVBHQR11",58,0)
CHILD ;Child-Birth-Data.
"RTN","DVBHQR11",59,0)
 S $P(DVBCHI,U,1)=$E(X,1,2)
"RTN","DVBHQR11",60,0)
 S DVBV1=$E(X,3,4)
"RTN","DVBHQR11",61,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",62,0)
 S DVBCHNO=DVBV1,L=5,J1=0 D RON
"RTN","DVBHQR11",63,0)
 I 'DVBCHNO S DVBCHNO=0 F DVBV=1:1:20 S L=20 D RON
"RTN","DVBHQR11",64,0)
 E  F DVBV=1:1:20 S DVBV1=$E(X,1,19),L=20 D RON I DVBV'>DVBCHNO S DVBCHDOB=$E(DVBV1,1,8) S:DVBCHDOB?8N J1=J1+1,DVBCHILD(J1)=$E(DVBV1,9)_U_$E(DVBV1,10,19)_U_DVBCHDOB
"RTN","DVBHQR11",65,0)
 K DVBCHDOB,J1,DVBV1,DVBV
"RTN","DVBHQR11",66,0)
 ;
"RTN","DVBHQR11",67,0)
WITH ;WITHHOLDING-APPORTIONED-SEGMENT.
"RTN","DVBHQR11",68,0)
 S $P(DVBWIT,U,1)=$E(X,1),DVBV1=$E(X,2,7)
"RTN","DVBHQR11",69,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",70,0)
 S $P(DVBWIT,U,2)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR11",71,0)
 S DVBV1=$E(X,8,13)
"RTN","DVBHQR11",72,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",73,0)
 S $P(DVBWIT,U,3)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR11",74,0)
 S DVBV1=$E(X,14,19)
"RTN","DVBHQR11",75,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",76,0)
 S $P(DVBWIT,U,4)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6),$P(DVBWIT,U,5)=$E(X,20)
"RTN","DVBHQR11",77,0)
 S L=21 D RON
"RTN","DVBHQR11",78,0)
 ;
"RTN","DVBHQR11",79,0)
NMADR ;ADDRESS-SEGMENT.
"RTN","DVBHQR11",80,0)
 S M("+")=7 F I=65:1:70 S M($C(I))=71-I
"RTN","DVBHQR11",81,0)
 S M("-")=15 F I=74:1:80 S M($C(I))=88-I
"RTN","DVBHQR11",82,0)
 F I=84:1:88 S M($C(I))=104-I
"RTN","DVBHQR11",83,0)
 S M("&")=7
"RTN","DVBHQR11",84,0)
 ;Blank & Length of Segment:
"RTN","DVBHQR11",85,0)
 S $P(DVBADD,U,1)=$E(X,1),DVBV1=$E(X,2,4)
"RTN","DVBHQR11",86,0)
 I DVBV1?2N1A!(DVBV1["{") S DVBV2=3 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",87,0)
 S $P(DVBADD,U,2)=DVBV1
"RTN","DVBHQR11",88,0)
 ;Sequence Control:
"RTN","DVBHQR11",89,0)
 S $P(DVBADD,U,3)=$E(X,5)
"RTN","DVBHQR11",90,0)
 ;Name Line Indicator:
"RTN","DVBHQR11",91,0)
 S $P(DVBADD,U,4)=$E(X,6)
"RTN","DVBHQR11",92,0)
 ;Zip Code:
"RTN","DVBHQR11",93,0)
 S DVBZIP=$E(X,7,15)
"RTN","DVBHQR11",94,0)
 S DVBZIP=$E(DVBZIP,1,5) ;use only 1st 5 digits - DVB*4*49
"RTN","DVBHQR11",95,0)
 S L=16,L1=15
"RTN","DVBHQR11",96,0)
 F I=1:1:DVBADRLN Q:$E(X,L)=" "!($E(X,L)="")  Q:'$G(M($E(X,L)))  S M=M($E(X,L)),DVBADR(I)=$E(X,L+1,L+M),L=L+M+1,L1=L1+M+1 D RON S L=1
"RTN","DVBHQR11",97,0)
 S $P(DVBADD,U,18)=145-L1
"RTN","DVBHQR11",98,0)
 S L=$P(DVBADD,U,18)+1 D RON
"RTN","DVBHQR11",99,0)
 K M,L1
"RTN","DVBHQR11",100,0)
 ;instead of calling DEDBL^DVBHQR12 call REF^DVBHQR12, since the DED/BAL
"RTN","DVBHQR11",101,0)
 ;segments will no longer be included in the VBA resp message, DVB*4*49
"RTN","DVBHQR11",102,0)
 G REF^DVBHQR12
"RTN","DVBHQR11",103,0)
 ;
"RTN","DVBHQR11",104,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR11",105,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR11",106,0)
 Q
"RTN","DVBHQR11",107,0)
 ;
"RTN","DVBHQR11",108,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR11",109,0)
 QUIT
"RTN","DVBHQR11",110,0)
 ;
"RTN","DVBHQR11",111,0)
ASTAT ;Statistics Segment of Type A Record.
"RTN","DVBHQR11",112,0)
 S $P(DVBVET,U,1)="A",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",113,0)
 S $P(DVBVET,U,3)=$E(X,2)
"RTN","DVBHQR11",114,0)
 S DVBBOS(1)=$E(X,3),DVBEOD(1)=$E(X,4,11),DVBRAD(1)=$E(X,12,19),DVBASVC=$E(X,20),DVBDOB=$E(X,21,28)
"RTN","DVBHQR11",115,0)
 S $P(DVBVET,U,9)=$E(X,29,30),$P(DVBVET,U,10)=$E(X,31)
"RTN","DVBHQR11",116,0)
 S $P(DVBP(2),U,2)=$E(X,32)
"RTN","DVBHQR11",117,0)
 S DVBEI=$E(X,33),DVBCI=$E(X,34)
"RTN","DVBHQR11",118,0)
 S $P(DVBVET,U,14)=$E(X,35)
"RTN","DVBHQR11",119,0)
 S DVBCPS=$E(X,36)
"RTN","DVBHQR11",120,0)
 S DVBPTI=$E(X,37)
"RTN","DVBHQR11",121,0)
 S $P(DVBP(2),U,6)=$E(X,38,39),$P(DVBP(2),U,3)=$E(X,40,41),$P(DVBP(2),U,1)=$E(X,42,43),$P(DVBP(2),U,4)=$E(X,44),$P(DVBP(2),U,5)=$E(X,45)
"RTN","DVBHQR11",122,0)
 S L=46 D RON
"RTN","DVBHQR11",123,0)
 S DVBSPDOB=$E(X,1,8)
"RTN","DVBHQR11",124,0)
 ;leave spouse DOB in format MMDDYYYY
"RTN","DVBHQR11",125,0)
 S DVBSPNAM=$E(X,9,18) ;;;DVBPTI=$E(X,40)
"RTN","DVBHQR11",126,0)
 ;Hospitalized SMC code:
"RTN","DVBHQR11",127,0)
 S $P(DVBVET,U,24)=$E(X,19,20)
"RTN","DVBHQR11",128,0)
 ;DOB of Father:
"RTN","DVBHQR11",129,0)
 S $P(DVBVET,U,25)=$E(X,21,28)
"RTN","DVBHQR11",130,0)
 ;DOB of Mother:
"RTN","DVBHQR11",131,0)
 S $P(DVBVET,U,26)=$E(X,29,36)
"RTN","DVBHQR11",132,0)
 ;Blanks:
"RTN","DVBHQR11",133,0)
 S $P(DVBVET,U,27)=$E(X,37,40)
"RTN","DVBHQR11",134,0)
 ;P&T disability and dental
"RTN","DVBHQR11",135,0)
 S DVBPTIDT=$E(X,41,48) ;DVB*4*65
"RTN","DVBHQR11",136,0)
 S DVBDENTI=$E(X,49) ;DVB*4*65
"RTN","DVBHQR11",137,0)
 S L=50 D RON
"RTN","DVBHQR11",138,0)
 ;
"RTN","DVBHQR11",139,0)
 Q
"RTN","DVBHQR11",140,0)
 ;
"RTN","DVBHQR11",141,0)
BSTAT ;Statistics Segment of Type B Record.
"RTN","DVBHQR11",142,0)
 S $P(DVBVET,U,1)="B",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",143,0)
 S $P(DVBVET,U,3)=$E(X,2)
"RTN","DVBHQR11",144,0)
 S DVBBOS(1)=$E(X,3),DVBEOD(1)=$E(X,4,11),DVBRAD(1)=$E(X,12,19),DVBASVC=$E(X,20),DVBDOB=$E(X,21,28)
"RTN","DVBHQR11",145,0)
 S DVBDOB=$E(DVBDOB,5,8)_$E(DVBDOB,1,4)
"RTN","DVBHQR11",146,0)
 S $P(DVBVET,U,9)=$E(X,29,30),$P(DVBVET,U,10)=$E(X,31,37)
"RTN","DVBHQR11",147,0)
 ;Age at Death & Death Date:
"RTN","DVBHQR11",148,0)
 S $P(DVBVET,U,11)=$E(X,38,39),$P(DVBVET,U,12)=$E(X,40,47)
"RTN","DVBHQR11",149,0)
 ;Blank & Pay Grade
"RTN","DVBHQR11",150,0)
 S $P(DVBVET,U,13)=$E(X,48),$P(DVBVET,U,14)=$E(X,49,50)
"RTN","DVBHQR11",151,0)
 ;DOB of Payee & DOB of 3rd Party:
"RTN","DVBHQR11",152,0)
 S $P(DVBVET,U,15)=$E(X,51,58),$P(DVBVET,U,16)=$E(X,59,66)
"RTN","DVBHQR11",153,0)
 ;Name of 3rd Party & Filler
"RTN","DVBHQR11",154,0)
 S $P(DVBVET,U,17)=$E(X,67,73),$P(DVBVET,U,18)=$E(74,85)
"RTN","DVBHQR11",155,0)
 S L=86 D RON
"RTN","DVBHQR11",156,0)
 Q
"RTN","DVBHQR11",157,0)
 ;
"RTN","DVBHQR11",158,0)
CSTAT ;Statistics Segment of Type C Record.
"RTN","DVBHQR11",159,0)
 S $P(DVBVET,U,1)="C",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",160,0)
 ;CP-APPORT-SPOUSE NAME & DOB
"RTN","DVBHQR11",161,0)
 S $P(DVBVET,U,3)=$E(X,2,11),$P(DVBVET,U,4)=$E(X,12,19)
"RTN","DVBHQR11",162,0)
 S $P(DVBVET,U,5)=$E(X,20,25)
"RTN","DVBHQR11",163,0)
 S L=86 D RON
"RTN","DVBHQR11",164,0)
 Q
"RTN","DVBHQR11",165,0)
 ;
"RTN","DVBHQR11",166,0)
PENSION ;DVB*4*65
"RTN","DVBHQR11",167,0)
 S $P(DVBP(1),U,10)=$E(X,1,8),$P(DVBP(1),U,11)=$E(X,9,20),$P(DVBP(1),U,12)=$E(X,21,28),$P(DVBP(1),U,13)=$E(X,29,40),$P(DVBP(1),U,14)=$E(X,41,52),$P(DVBP(1),U,15)=$E(X,53,64),$P(DVBP(1),U,16)=$E(X,65,76)
"RTN","DVBHQR11",168,0)
 S L=77 D RON
"RTN","DVBHQR11",169,0)
 ;
"RTN","DVBHQR11",170,0)
 Q
"RTN","DVBHQR11",171,0)
 ;
"RTN","DVBHUTL1")
0^7^B6884601^B6969582
"RTN","DVBHUTL1",1,0)
DVBHUTL1 ;ISC-ALB/JLU - General utility routine;1/10/94
"RTN","DVBHUTL1",2,0)
 ;;4.0;HINQ;**15,20,65**;03/25/92;Build 19
"RTN","DVBHUTL1",3,0)
 ;
"RTN","DVBHUTL1",4,0)
POW ;this subroutine is to figure out the BIRLS pow indicator. a 'c' is
"RTN","DVBHUTL1",5,0)
 ;checked for because of old unconverted VBA data.
"RTN","DVBHUTL1",6,0)
 ;
"RTN","DVBHUTL1",7,0)
 K DVBPOWD
"RTN","DVBHUTL1",8,0)
 S Y=$E(X,5,10)
"RTN","DVBHUTL1",9,0)
 I $E(X,1,1)="C",+$E(X,2,4)<30 S DVBPOWD="1 to 29 days"
"RTN","DVBHUTL1",10,0)
 I $E(X,1,1)="C",+$E(X,2,4)>29 S DVBPOWD="30 days or greater"
"RTN","DVBHUTL1",11,0)
 I '$D(DVBPOWD) DO
"RTN","DVBHUTL1",12,0)
 .N A
"RTN","DVBHUTL1",13,0)
 .F A=1:1:4 S DVBPOWD=+$E(X,A,4) Q:DVBPOWD
"RTN","DVBHUTL1",14,0)
 .I DVBPOWD S DVBPOWD=DVBPOWD_" days "
"RTN","DVBHUTL1",15,0)
 .E  K DVBPOWD
"RTN","DVBHUTL1",16,0)
 .Q
"RTN","DVBHUTL1",17,0)
 Q
"RTN","DVBHUTL1",18,0)
CLEAN ;this subroutine is used to kill the variables that would have
"RTN","DVBHUTL1",19,0)
 ;be killed if the mail message parameter was turned on for
"RTN","DVBHUTL1",20,0)
 ;the alerts
"RTN","DVBHUTL1",21,0)
 K DVBCHECK,DVBADR,DVBZIP,DVBAAHB,DVBCN,DVBDXPCT,DVBFL,DVBBAS,DVBP(1),DVBP(2),DVBP(3),DVBP(4),DVBP(5),DVBP(6),DVBVET,DVBDIA,DVBCHI,DVBRTYPE,DVBRTYP,DVBEI,DVBCI,DVBCPS,DVBSPNAM,DVBSPDOB,DVBCHILD,DVBDOB,V,DVBDXX,DVBHOLD,DVBEINC
"RTN","DVBHUTL1",22,0)
 K DVBSSA,DVBRETT,DVBRETO,DVBOINC,DVBNMREC,DVBSRC,DVBSVCN,DVBEODN,DVBRADN,DVBPNAM,DVBSN,DVBCSVC,DVBPOA,DVBRAD,DVBEOD,DVBPOWD,DVBTOTAS,DVBASVC,DVBNAM,DVBSNSVC,DVBPOW,DVBBOS,DVBADRLN,DVBVNA,DVBRMA,DVBSPENC,DVBSPSSA,DVBSPRET
"RTN","DVBHUTL1",23,0)
 K DVBSPETD,DVBSPINC,Y,DVBDXNO,DVBDX,DVBPT,DVBPTI,DVBPTIDT,DVBDENTI,DVBFIDCU,DVBNAM,DVBSSN,DVBDIV,DVBREQST,DVBOTM,DVBNETER,DVBREQUE,DVBCHNO,DVBCTN,DVBIXMZ,DVBNAME,DVBMON,DVBERR1,DVBSTATS,DVBWIT,DVBAD,DVBBDF,DVBDBE,DVBREF
"RTN","DVBHUTL1",24,0)
 K DVBFUT,DVBINC,DVBBIR,DVBCAP
"RTN","DVBHUTL1",25,0)
 Q
"VER")
8.0^22.0
"BLD",7991,6)
^61
**END**
**END**
