EMERGENCY Released FB*3.5*133 SEQ #111
Extracted from mail message
**KIDS**:FB*3.5*133^

**INSTALL NAME**
FB*3.5*133
"BLD",8573,0)
FB*3.5*133^FEE BASIS^0^3111017^y
"BLD",8573,4,0)
^9.64PA^162^1
"BLD",8573,4,162,0)
162
"BLD",8573,4,162,2,0)
^9.641^162.03^1
"BLD",8573,4,162,2,162.03,0)
SERVICE PROVIDED  (sub-file)
"BLD",8573,4,162,2,162.03,1,0)
^9.6411^79^16
"BLD",8573,4,162,2,162.03,1,58,0)
ATTENDING PROV NAME
"BLD",8573,4,162,2,162.03,1,59,0)
ATTENDING PROV NPI
"BLD",8573,4,162,2,162.03,1,60,0)
ATTENDING PROV TAXONOMY CODE
"BLD",8573,4,162,2,162.03,1,61,0)
OPERATING PROV NAME
"BLD",8573,4,162,2,162.03,1,62,0)
OPERATING PROV NPI
"BLD",8573,4,162,2,162.03,1,63,0)
RENDERING PROV NAME
"BLD",8573,4,162,2,162.03,1,64,0)
RENDERING PROV NPI
"BLD",8573,4,162,2,162.03,1,65,0)
RENDERING PROV TAXONOMY CODE
"BLD",8573,4,162,2,162.03,1,66,0)
SERVICING PROV NAME
"BLD",8573,4,162,2,162.03,1,67,0)
SERVICING PROV NPI
"BLD",8573,4,162,2,162.03,1,68,0)
REFERRING PROV NAME
"BLD",8573,4,162,2,162.03,1,69,0)
REFERRING PROV NPI
"BLD",8573,4,162,2,162.03,1,76,0)
SERVICING FACILITY ADDRESS
"BLD",8573,4,162,2,162.03,1,77,0)
SERVICING FACILITY CITY
"BLD",8573,4,162,2,162.03,1,78,0)
SERVICING FACILITY STATE
"BLD",8573,4,162,2,162.03,1,79,0)
SERVICING FACILITY ZIP
"BLD",8573,4,162,222)
y^y^p^^^^n^^n
"BLD",8573,4,162,224)
 
"BLD",8573,4,"APDD",162,162.03)
 
"BLD",8573,4,"APDD",162,162.03,58)
 
"BLD",8573,4,"APDD",162,162.03,59)
 
"BLD",8573,4,"APDD",162,162.03,60)
 
"BLD",8573,4,"APDD",162,162.03,61)
 
"BLD",8573,4,"APDD",162,162.03,62)
 
"BLD",8573,4,"APDD",162,162.03,63)
 
"BLD",8573,4,"APDD",162,162.03,64)
 
"BLD",8573,4,"APDD",162,162.03,65)
 
"BLD",8573,4,"APDD",162,162.03,66)
 
"BLD",8573,4,"APDD",162,162.03,67)
 
"BLD",8573,4,"APDD",162,162.03,68)
 
"BLD",8573,4,"APDD",162,162.03,69)
 
"BLD",8573,4,"APDD",162,162.03,76)
 
"BLD",8573,4,"APDD",162,162.03,77)
 
"BLD",8573,4,"APDD",162,162.03,78)
 
"BLD",8573,4,"APDD",162,162.03,79)
 
"BLD",8573,4,"B",162,162)
 
"BLD",8573,6.3)
5
"BLD",8573,"INI")
PRE^FBXIP133
"BLD",8573,"INIT")
POST^FBXIP133
"BLD",8573,"KRN",0)
^9.67PA^779.2^20
"BLD",8573,"KRN",.4,0)
.4
"BLD",8573,"KRN",.401,0)
.401
"BLD",8573,"KRN",.402,0)
.402
"BLD",8573,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",8573,"KRN",.403,0)
.403
"BLD",8573,"KRN",.5,0)
.5
"BLD",8573,"KRN",.84,0)
.84
"BLD",8573,"KRN",3.6,0)
3.6
"BLD",8573,"KRN",3.8,0)
3.8
"BLD",8573,"KRN",9.2,0)
9.2
"BLD",8573,"KRN",9.8,0)
9.8
"BLD",8573,"KRN",9.8,"NM",0)
^9.68A^21^8
"BLD",8573,"KRN",9.8,"NM",1,0)
FBAAPET^^0^B35047442
"BLD",8573,"KRN",9.8,"NM",2,0)
FBAACO^^0^B28861560
"BLD",8573,"KRN",9.8,"NM",3,0)
FBAACO2^^0^B14116879
"BLD",8573,"KRN",9.8,"NM",4,0)
FBAAPIN^^0^B33741138
"BLD",8573,"KRN",9.8,"NM",6,0)
FBUTL8^^0^B25540087
"BLD",8573,"KRN",9.8,"NM",19,0)
FBAACO3^^0^B48919280
"BLD",8573,"KRN",9.8,"NM",20,0)
FBPCR2^^0^B77224131
"BLD",8573,"KRN",9.8,"NM",21,0)
FBCHEP1^^0^B11600569
"BLD",8573,"KRN",9.8,"NM","B","FBAACO",2)
 
"BLD",8573,"KRN",9.8,"NM","B","FBAACO2",3)
 
"BLD",8573,"KRN",9.8,"NM","B","FBAACO3",19)
 
"BLD",8573,"KRN",9.8,"NM","B","FBAAPET",1)
 
"BLD",8573,"KRN",9.8,"NM","B","FBAAPIN",4)
 
"BLD",8573,"KRN",9.8,"NM","B","FBCHEP1",21)
 
"BLD",8573,"KRN",9.8,"NM","B","FBPCR2",20)
 
"BLD",8573,"KRN",9.8,"NM","B","FBUTL8",6)
 
"BLD",8573,"KRN",19,0)
19
"BLD",8573,"KRN",19,"NM",0)
^9.68A^^0
"BLD",8573,"KRN",19.1,0)
19.1
"BLD",8573,"KRN",101,0)
101
"BLD",8573,"KRN",409.61,0)
409.61
"BLD",8573,"KRN",771,0)
771
"BLD",8573,"KRN",779.2,0)
779.2
"BLD",8573,"KRN",870,0)
870
"BLD",8573,"KRN",8989.51,0)
8989.51
"BLD",8573,"KRN",8989.52,0)
8989.52
"BLD",8573,"KRN",8994,0)
8994
"BLD",8573,"KRN","B",.4,.4)
 
"BLD",8573,"KRN","B",.401,.401)
 
"BLD",8573,"KRN","B",.402,.402)
 
"BLD",8573,"KRN","B",.403,.403)
 
"BLD",8573,"KRN","B",.5,.5)
 
"BLD",8573,"KRN","B",.84,.84)
 
"BLD",8573,"KRN","B",3.6,3.6)
 
"BLD",8573,"KRN","B",3.8,3.8)
 
"BLD",8573,"KRN","B",9.2,9.2)
 
"BLD",8573,"KRN","B",9.8,9.8)
 
"BLD",8573,"KRN","B",19,19)
 
"BLD",8573,"KRN","B",19.1,19.1)
 
"BLD",8573,"KRN","B",101,101)
 
"BLD",8573,"KRN","B",409.61,409.61)
 
"BLD",8573,"KRN","B",771,771)
 
"BLD",8573,"KRN","B",779.2,779.2)
 
"BLD",8573,"KRN","B",870,870)
 
"BLD",8573,"KRN","B",8989.51,8989.51)
 
"BLD",8573,"KRN","B",8989.52,8989.52)
 
"BLD",8573,"KRN","B",8994,8994)
 
"BLD",8573,"QUES",0)
^9.62^^
"BLD",8573,"REQB",0)
^9.611^1^1
"BLD",8573,"REQB",1,0)
FB*3.5*122^2
"BLD",8573,"REQB","B","FB*3.5*122",1)
 
"FIA",162)
FEE BASIS PAYMENT
"FIA",162,0)
^FBAAC(
"FIA",162,0,0)
162P
"FIA",162,0,1)
y^y^p^^^^n^^n
"FIA",162,0,10)
 
"FIA",162,0,11)
 
"FIA",162,0,"RLRO")
 
"FIA",162,0,"VR")
3.5^FB
"FIA",162,162)
1
"FIA",162,162.03)
1
"FIA",162,162.03,58)
 
"FIA",162,162.03,59)
 
"FIA",162,162.03,60)
 
"FIA",162,162.03,61)
 
"FIA",162,162.03,62)
 
"FIA",162,162.03,63)
 
"FIA",162,162.03,64)
 
"FIA",162,162.03,65)
 
"FIA",162,162.03,66)
 
"FIA",162,162.03,67)
 
"FIA",162,162.03,68)
 
"FIA",162,162.03,69)
 
"FIA",162,162.03,76)
 
"FIA",162,162.03,77)
 
"FIA",162,162.03,78)
 
"FIA",162,162.03,79)
 
"INI")
PRE^FBXIP133
"INIT")
POST^FBXIP133
"MBREQ")
0
"PKG",344,-1)
1^1
"PKG",344,0)
FEE BASIS^FB^Used to pay private vendors
"PKG",344,20,0)
^9.402P^1^1
"PKG",344,20,1,0)
2^^FBPMRG
"PKG",344,20,1,1)
 
"PKG",344,20,"B",2,1)
 
"PKG",344,22,0)
^9.49I^1^1
"PKG",344,22,1,0)
3.5^2950130^2950329
"PKG",344,22,1,"PAH",1,0)
133^3111017^10000000034
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")
 
"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","FBAACO")
0^2^B28861560^B28594326
"RTN","FBAACO",1,0)
FBAACO ;AISC/GRR-ENTER MEDICAL PAYMENT ;7/13/2003
"RTN","FBAACO",2,0)
 ;;3.5;FEE BASIS;**4,61,79,116,122,133**;JAN 30, 1995;Build 5
"RTN","FBAACO",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAACO",4,0)
EN583 ;driver for opt payments (entry point for uc)
"RTN","FBAACO",5,0)
 K FBAAOUT,FBPOP
"RTN","FBAACO",6,0)
 D SITE G Q:$G(FBPOP) D BT G Q:$G(FBAAOUT)
"RTN","FBAACO",7,0)
1 K FBAAID,FBAAVID,FBAAOUT,FBDL,FBAAMM D SITE G Q:$G(FBPOP) S FBINTOT=0 W !!
"RTN","FBAACO",8,0)
 I '$D(FB583) K FBDL,FBAR D GETVET^FBAAUTL1 G EN583:'DFN K FBAAOUT,FBDMRA D GETAUTH^FBAAUTL1 G 1:FTP']""
"RTN","FBAACO",9,0)
 K FBAAOUT
"RTN","FBAACO",10,0)
 I $G(FBCHCO) S FB7078=$S($G(FB7078):FB7078_";FB7078(",$D(FB583):FB583_";FB583(",1:"")
"RTN","FBAACO",11,0)
 D:FBAAPTC="R" ^FBAACO0
"RTN","FBAACO",12,0)
 D ^FBAAEAR:$P(FBSITE(1),"^",4)="Y"
"RTN","FBAACO",13,0)
 D PAT,GETVEN1^FBAACO1:$D(FB583),GETVEN^FBAACO1:'$D(FB583) I $G(FBAAOUT) G Q:$D(FB583),1
"RTN","FBAACO",14,0)
 W !! D FILEV^FBAACO5(DFN,FBV) I $G(FBAAOUT) G Q:$D(FB583),1
"RTN","FBAACO",15,0)
 ;check for payments against all linked vendors
"RTN","FBAACO",16,0)
 S DA=+Y D CHK^FBAACO4 K FBAACK1,FBAAOUT,DA,X,Y
"RTN","FBAACO",17,0)
 K FBAAID,FBAAVID D GETINV^FBAACO1 I $G(FBAAOUT) Q:$D(FBCHCO)  G Q:$D(FB583),1
"RTN","FBAACO",18,0)
 I '$D(FBAAID)!('$D(FBAAVID)) D GETINDT^FBAACO1 I $G(FBAAOUT) D OUT G Q:$D(FB583),1:'$D(FBCHCO) Q
"RTN","FBAACO",19,0)
 ; ask patient account number
"RTN","FBAACO",20,0)
 S FBCSID=$$ASKPAN^FBUTL5() I FBCSID="^" K FBCSID S FBAAOUT=1 D OUT G Q:$D(FB583),1:'$D(FBCHCO) Q
"RTN","FBAACO",21,0)
 ; if U/C then get FPPS Claim ID else ask user
"RTN","FBAACO",22,0)
 I $D(FB583) S FBFPPSC=$P($G(^FB583(FB583,5)),U) W !,"FPPS CLAIM ID: ",$S(FBFPPSC="":"N/A",1:FBFPPSC)
"RTN","FBAACO",23,0)
 E  S FBFPPSC=$$FPPSC^FBUTL5() I FBFPPSC=-1 K FBFPPSC S FBAAOUT=1 D OUT G Q:$D(FB583),1:'$D(FBCHCO) Q
"RTN","FBAACO",24,0)
 G 1^FBAAMP:$G(FBMP) D MM G Q:$G(FBAAOUT)
"RTN","FBAACO",25,0)
SVDT K FBAAOUT,HOLDY W !! D GETSVDT^FBAACO5(DFN,FBV,FBASSOC,1) I $G(FBAAOUT) K FBAADT,FBX,FBAACP W:FBINTOT>0 !!,"Invoice: "_FBAAIN_" Totals $ "_$J(FBINTOT,1,2) G Q:$D(FB583)!($G(FBCHCO)),1
"RTN","FBAACO",26,0)
 D SETO^FBAACO3,DISPINV^FBAACO1
"RTN","FBAACO",27,0)
 W ! D ASKZIP^FBAAFS($G(FBV),$G(FBAADT))
"RTN","FBAACO",28,0)
 I $G(FBAAOUT)!(FBZIP']"") D DEL^FBAACO3 G SVDT
"RTN","FBAACO",29,0)
CPT K FBAAOUT W !
"RTN","FBAACO",30,0)
 D CPTM^FBAALU($G(FBAADT),$G(DFN)) I 'FBGOT D DEL^FBAACO3 G SVDT
"RTN","FBAACO",31,0)
 D CHK2^FBAACO4 I FBJ']"" G SVPR
"RTN","FBAACO",32,0)
CHKE ;determines what action to take on duplicate services entered
"RTN","FBAACO",33,0)
 K FBAAOUT W !!,*7,"Service selected for that date already in system."
"RTN","FBAACO",34,0)
 S DIR(0)="Y",DIR("A")="Do you want to add another service for the SAME DATE",DIR("B")="No" D ^DIR K DIR G Q:$D(DIRUT),SVPR:Y
"RTN","FBAACO",35,0)
 I FBJ]"",FBJ'=FBV W !!,*7,"You must use the 'EDIT PAYMENT' option to edit the service previously",!,"entered for that date." D DEL^FBAACO3 G SVDT
"RTN","FBAACO",36,0)
 S DIR(0)="Y",DIR("A")="Want to edit it",DIR("B")="No" D ^DIR K DIR G Q:$D(DIRUT) I Y D DOEDIT^FBAACO3 G SVDT:'$D(FBDL)!($G(FBAAOUT)),Q:$D(FB583),1
"RTN","FBAACO",37,0)
 D ^FBAACO2 G CPT:'$G(FBDEN)
"RTN","FBAACO",38,0)
SVPR K FBAAOUT
"RTN","FBAACO",39,0)
 I $$ANES^FBAAFS($$CPT^FBAAUTL4($G(FBAACP))) D ASKTIME^FBAAFS I $G(FBAAOUT)!'$G(FBTIME) G CPT
"RTN","FBAACO",40,0)
 D SVCPR^FBAACO1 G CPT:$G(FBAAOUT)
"RTN","FBAACO",41,0)
 S FBAMTPD=0 D FILE^FBAACO2 I $D(FBAAOUT) G Q:$D(FB583),1:$D(FBDL),Q ;FB*3.5*133 removed provider field save
"RTN","FBAACO",42,0)
 D OUT^FBAACO3 W:Z1>(FBAAMPI-20) !,*7,"Warning, you can only enter ",(FBAAMPI-Z1)," more line(s)!" G CPT:Z1'>(FBAAMPI-1) D WARN^FBAACO3 G EN583
"RTN","FBAACO",43,0)
 G 1
"RTN","FBAACO",44,0)
 ;
"RTN","FBAACO",45,0)
Q ;exit point for outpatient payment routines
"RTN","FBAACO",46,0)
 K FBAAPTC,DIC,Y,A,I,DFN,BO,DA,DI,DQ,DR,E,FBAABDT,FBAABE,FBFY,FBDL,FBAAID,FBAAIN,FBAAMPI,FBAAOPA,FBAAPN,FBCONT,FBDX,FBGOT,FBPOV,FBPT,DLAYGO,FBPSA,FBASSOC,FBZBN,FBZBS,FBDEN,FBV,FBSDI,FBAACPI,FBAACP,FBX,FBLOCK
"RTN","FBAACO",47,0)
 K FBSP,FBTPD,FBTT,FBTYPE,FTP,FBDEL,FY,FBINTOT,G,H,MAJN,NO,PI,Q,R,SUB,SUBN,TA,TP,UL,W,X1,Z,Z1,ZZ,FBAADT,K,L,J,FBTOV,FBPARCD,FBT,FEEO,Z2,FBSITE,FBAUT,T,FBLOC,FBSSN,FBVEN,FBD1,Z0,FB583
"RTN","FBAACO",48,0)
 K A1,A2,B1,B2,DAT,DIE,FBAACPT,FBAMTPD,FBAAEDT,FBAAOUT,FBAAPD,FBI,FBIN,FBPROG,FBRR,FBXX,PTYPE,S,VAL,X,V,ZS,FB7078,FBFDC,FBCOUNTY,FBMST,FBTTYPE,FBTV,HY,FBDMRA,DIRUT,FBPOP,FBJ,FBAACK1,FBAR,FBDA,FBST
"RTN","FBAACO",49,0)
 K FBMP,FBK,FBAAAS,%DT,FBDT,FBMAX,FBAMFS,FBAASC,FBHCFA,FBSI,FBCNP,FBAAAMT,FBAAVID,FBAAMM,FBAAMM1,VAPA,FBZX,FBTST,HOLDY,FBAOT
"RTN","FBAACO",50,0)
 K FBCSID,FBFPPSC,FBFPPSL,FBADJ,FBADJD,FBADJL,FBRRMK,FBRRMKD,FBRRMKL,FBUNITS
"RTN","FBAACO",51,0)
AUTHQ K DIC,DFN,CNT,FB7078,FBAABDT,FBAAEDT,FBAAOUT,FBASSOC,FBAUT,FBPOV,FBPROG,FBPSA,FBPT,FBTT,FBTYPE,FBVEN,FBTP,PI,TA,FBMOD,FBMODA,FBZIP,FBTIME,FBFSAMT,FBFSUSD
"RTN","FBAACO",52,0)
 Q
"RTN","FBAACO",53,0)
 ;
"RTN","FBAACO",54,0)
SITE ;set up site variables
"RTN","FBAACO",55,0)
 D:'$D(FBSITE(0)) SITEP^FBAAUTL Q:$G(FBPOP)  I '$G(FBPROG) D
"RTN","FBAACO",56,0)
 .I $G(FBCHCO) S FBPROG="I ($P(^(0),""^"",3)=6!($P(^(0),""^"",3)=7))&($P(^(0),U,9)'[""FB583"")" Q
"RTN","FBAACO",57,0)
 .S FBPROG=$S($P(FBSITE(1),"^",6)="":"I $P(^(0),""^"",9)'[""FB583""",1:"I $P(^(0),""^"",3)=2,($P(^(0),""^"",9)'[""FB583"")")
"RTN","FBAACO",58,0)
 S:'$D(FBAAPTC) FBAAPTC="V"
"RTN","FBAACO",59,0)
 S FBAAMPI=$P($G(^FBAA(161.4,1,"FBNUM")),"^",3),FBAAMPI=$S(FBAAMPI]"":FBAAMPI,1:100)
"RTN","FBAACO",60,0)
 Q
"RTN","FBAACO",61,0)
 ;
"RTN","FBAACO",62,0)
BT ;select batch
"RTN","FBAACO",63,0)
 S DIC="^FBAA(161.7,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,3)=""B3""&($G(^(""ST""))=""O"")&(($P(^(0),U,5)=DUZ)!($D(^XUSEC(""FBAASUPERVISOR"",DUZ))))",DIC("W")="W !,""  Obligation #: "",$P(^(0),U,2)" W !! D ^DIC K DIC I X["^"!(X="") S FBAAOUT=1 Q
"RTN","FBAACO",64,0)
 G BT:Y<0 S (DA,FBAABE)=+Y,Y(0)=^FBAA(161.7,DA,0)
"RTN","FBAACO",65,0)
 I $P(Y(0),"^",11)>(FBAAMPI-1) W !!,"This Batch already has the maximum number of Payments!" G BT
"RTN","FBAACO",66,0)
 S Z1=$P(Y(0),"^",11),FB7078="",BO=$P(^FBAA(161.7,DA,0),"^",2)
"RTN","FBAACO",67,0)
 Q
"RTN","FBAACO",68,0)
PAT ;set up patient in patient file
"RTN","FBAACO",69,0)
 ;required input variable DFN
"RTN","FBAACO",70,0)
 I '$D(^FBAAC(DFN,0)) K DD,DO S (X,DINUM)=DFN,DIC(0)="L",DLAYGO=162,DIC="^FBAAC(" D FILE^DICN K DLAYGO,DIC,DINUM,DD,DO,DA
"RTN","FBAACO",71,0)
 Q
"RTN","FBAACO",72,0)
MM ;check for money management of entire invoice
"RTN","FBAACO",73,0)
 ; fb*3.5*116
"RTN","FBAACO",74,0)
 ;I FBAAPTC="R" S FBAAMM="" Q
"RTN","FBAACO",75,0)
 ;W ! S DIR(0)="Y",DIR("A")="Will any line items in this invoice be for contracted services",DIR("B")="No",DIR("?")="Answering no indicates interest will not be paid for any line items." D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
"RTN","FBAACO",76,0)
 ;S FBAAMM=$S(Y=1:1,1:"")
"RTN","FBAACO",77,0)
 D MMPPT^FBAACP
"RTN","FBAACO",78,0)
 Q
"RTN","FBAACO",79,0)
OUT K FBAADT,FBX,FBAACP W:FBINTOT>0 !!,"Invoice: "_FBAAIN_" Totals $ "_$J(FBINTOT,1,2) Q
"RTN","FBAACO2")
0^3^B14116879^B13323096
"RTN","FBAACO2",1,0)
FBAACO2 ;AISC/GRR-PAYMENT PROCESS FOR DUPLICATE ;7/13/2003
"RTN","FBAACO2",2,0)
 ;;3.5;FEE BASIS;**4,55,61,77,116,122,133**;JAN 30, 1995;Build 5
"RTN","FBAACO2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAACO2",4,0)
RD S DIR(0)="Y",DIR("A")="Want this payment stored as a Medical Denial",DIR("B")="YES",DIR("?")="Enter 'Yes' to store payment entry as a denial and send a Suspension letter.  Enter 'No' to have nothing happen." D ^DIR K DIR Q:$D(DIRUT)!('Y)
"RTN","FBAACO2",5,0)
 S FBDEN=1 Q
"RTN","FBAACO2",6,0)
FILE ;files sp multiple entry
"RTN","FBAACO2",7,0)
 K DR S TP="" I $G(FBDEN) S FBAMTPD=0
"RTN","FBAACO2",8,0)
 S DR="49///^S X=$G(FBCSID);50///^S X=$G(FBFPPSC);I $G(FBDEN) S Y=1;48;47//1;S FBUNITS=X;S:$G(FBFPPSC)="""" Y=""@11"";S FBX=$$FPPSL^FBUTL5();S:FBX=-1 Y=0;51///^S X=FBX;@11"
"RTN","FBAACO2",9,0)
 ; fb*3.5*116 do not enable different interest indicator values at line item level; interest indicator set at invoice level
"RTN","FBAACO2",10,0)
 ;S DR(1,162.03,1)="D PPT^FBAACO1();34///^S X=$G(FBAAMM1);D POS^FBAACO1;S:'$G(FBHCFA(30)) Y=0;1;S J=X;I $G(FBDEN) S Y=2;D FEE^FBAACO0;44////^S X=FBFSAMT;45///^S X=FBFSUSD;2///^S X=FBAMTPD;S K=X"
"RTN","FBAACO2",11,0)
 S DR(1,162.03,1)="34///^S X=$G(FBAAMM);D POS^FBAACO1;S:'$G(FBHCFA(30)) Y=0;1;S J=X;I $G(FBDEN) S Y=2;D FEE^FBAACO0;44////^S X=FBFSAMT;45///^S X=FBFSUSD;2///^S X=FBAMTPD;S K=X"
"RTN","FBAACO2",12,0)
 ;S DR(1,162.03,2)="S:J-K=0 Y=6;3//^S X=$S(J-K:J-K,1:"""");S:'X Y=6;3.5///^S X=DT;@4;4;I X']"""" D SC^FBAACO3;S:X'=4 Y=6;22;6////^S X=DUZ"
"RTN","FBAACO2",13,0)
 S DR(1,162.03,2)="S FBX=$$ADJ^FBUTL2(J-K,.FBADJ,2);S:FBX=0 Y=0;6////^S X=DUZ"
"RTN","FBAACO2",14,0)
 S DR(1,162.03,3)="7////^S X=FBAABE;8////^S X=BO;13///^S X=FBAAID;14///^S X=FBAAIN;33///^S X=FBAAVID;I $G(FBDEN) S FBTST=1"
"RTN","FBAACO2",15,0)
 I '$G(FBDEN) D
"RTN","FBAACO2",16,0)
 .N FBCSVSTR S FBCSVSTR="I X]"""" S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@1"";"
"RTN","FBAACO2",17,0)
 .S DR(1,162.03,4)="S:$$EXTPV^FBAAUTL5(FBPOV)=""01"" Y=""@1"";S:FB7078]""""!($D(FB583)) Y=30;@5;28R;S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@5"";30////^S X=FBHCFA(30);31;32R;S Y=15;@1;28;"_FBCSVSTR_"30////^S X=FBHCFA(30);31"
"RTN","FBAACO2",18,0)
 .S DR(1,162.03,5)="15///^S X=FBPT;S FBX=$$RR^FBUTL4(.FBRRMK,2);S:FBX=0 Y=0"
"RTN","FBAACO2",19,0)
 .S DR(1,162.03,6)="16////^S X=FBPOV;17///^S X=FBTT;18///^S X=FBAAPTC;23////^S X=FBTYPE;26////^S X=FBPSA;S:$D(FBV583) Y=""@2"";27////^S X=FB7078;S Y=""@99"";@2;27////^S X=FBV583;@99;S FBTST=1"
"RTN","FBAACO2",20,0)
 .S DR(1,162.03,7)="73;74;75;58;59;60;61;62;63;64;65;66;67;76;77;78;79;68;69" ;FB*3.5*122 Line Item Provider information ;FB*3.5*133 Provider Information
"RTN","FBAACO2",21,0)
 S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,"
"RTN","FBAACO2",22,0)
 S DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,DA=FBAACPI
"RTN","FBAACO2",23,0)
 D LOCK^FBUCUTL("^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",FBAACPI,1)
"RTN","FBAACO2",24,0)
 D
"RTN","FBAACO2",25,0)
 . N ICDVDT S ICDVDT=$G(FBAADT) D ^DIE
"RTN","FBAACO2",26,0)
 I '$D(DTOUT),$G(FBTST) D
"RTN","FBAACO2",27,0)
 . D FILEADJ^FBAAFA(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBADJ)
"RTN","FBAACO2",28,0)
 . D FILERR^FBAAFR(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBRRMK)
"RTN","FBAACO2",29,0)
 L -^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI)
"RTN","FBAACO2",30,0)
 I $D(DTOUT) D KILL Q
"RTN","FBAACO2",31,0)
 I '$G(FBTST),$G(DA) S DIR(0)="YA",DIR("A")="Entering an '^' will delete "_$S($G(FBDEN):"denial",1:"payment")_".  Are you sure you want to delete? ",DIR("B")="No" D ^DIR K DIR G FILE:'$D(DIRUT)&('Y) D KILL Q
"RTN","FBAACO2",32,0)
 K FBTST,FBDEN,FBAAMM1,DIE,DR,DA,FBX
"RTN","FBAACO2",33,0)
 I $D(FBDL) S FBAAOUT=1 Q
"RTN","FBAACO2",34,0)
 Q
"RTN","FBAACO2",35,0)
KILL S DIK=DIE D ^DIK K DIE,DIK I '$G(FBCNP) D Q^FBAACO S FBAAOUT=1
"RTN","FBAACO2",36,0)
 W !,"Deleted" Q
"RTN","FBAACO3")
0^19^B48919280^B50872609
"RTN","FBAACO3",1,0)
FBAACO3 ;AISC/GRR-ENTER PAYMENT CONTINUED ;7/7/2003
"RTN","FBAACO3",2,0)
 ;;3.5;FEE BASIS;**4,38,55,61,116,122,133**;JAN 30, 1995;Build 5
"RTN","FBAACO3",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAACO3",4,0)
DOEDIT ;
"RTN","FBAACO3",5,0)
 N FB1725,FBFPPSC
"RTN","FBAACO3",6,0)
 W ! S FBAACP(0)=FBAACP
"RTN","FBAACO3",7,0)
 S DIC="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,"
"RTN","FBAACO3",8,0)
 S DIC(0)="EQMZ",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI
"RTN","FBAACO3",9,0)
 S X=$$CPT^FBAAUTL4(FBAACP)
"RTN","FBAACO3",10,0)
 D ^DIC I Y<0 S FBAAOUT=1 Q
"RTN","FBAACO3",11,0)
 S (DA,FBAACPI)=+Y,K=$P(Y(0),U,3),FBZBN=$P(Y(0),U,8),FBZBS=$S(FBZBN]"":$P($G(^FBAA(161.7,FBZBN,"ST")),U),1:""),FBAAPTC=$P(Y(0),U,20),J(0)=$P(Y(0),U,2)
"RTN","FBAACO3",12,0)
 ; set FB1725 true (1) if payment is for a Mill Bill claim
"RTN","FBAACO3",13,0)
 S FB1725=$S($P(Y(0),U,13)["FB583":+$P($G(^FB583(+$P(Y(0),U,13),0)),U,28),1:0)
"RTN","FBAACO3",14,0)
 S FBAAMM1=$P($G(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,2)),U,2)
"RTN","FBAACO3",15,0)
 S FBFSAMT(0)=$P($G(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,2)),U,12)
"RTN","FBAACO3",16,0)
 ; determine lesser of original fee schedule amount and amount claimed
"RTN","FBAACO3",17,0)
 S FBAMTPD(0)=$S(FBFSAMT(0)="":J(0),FBFSAMT(0)>J(0):J(0),1:FBFSAMT(0))
"RTN","FBAACO3",18,0)
 S FBMODL=$$MODL^FBAAUTL4("^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,"_FBAACPI_",""M"")")
"RTN","FBAACO3",19,0)
 ; load current adjustment data
"RTN","FBAACO3",20,0)
 D LOADADJ^FBAAFA(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBADJ)
"RTN","FBAACO3",21,0)
 ; save adjustment data prior to edit session in sorted list
"RTN","FBAACO3",22,0)
 S FBADJL(0)=$$ADJL^FBUTL2(.FBADJ) ; sorted list of original adjustments
"RTN","FBAACO3",23,0)
 ; load current remittance remark data
"RTN","FBAACO3",24,0)
 D LOADRR^FBAAFR(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBRRMK)
"RTN","FBAACO3",25,0)
 ; save remittance remarks prior to edit session in sorted list
"RTN","FBAACO3",26,0)
 S FBRRMKL(0)=$$RRL^FBUTL4(.FBRRMK)
"RTN","FBAACO3",27,0)
 ; load FPPS data
"RTN","FBAACO3",28,0)
 S FBFPPSC=$P($G(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,3)),U)
"RTN","FBAACO3",29,0)
 S FBFPPSL=$P($G(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,3)),U,2)
"RTN","FBAACO3",30,0)
 I FBZBS=""!(FBZBS="V") D NOGO S FBAAOUT=1 Q
"RTN","FBAACO3",31,0)
 ; first edit CPT code and modifiers
"RTN","FBAACO3",32,0)
 D CPTM^FBAALU(FBAADT,DFN,FBAACP(0),FBMODL) I '$G(FBGOT) S FBAAOUT=1 Q
"RTN","FBAACO3",33,0)
 ; if CPT was changed then update file
"RTN","FBAACO3",34,0)
 I FBAACP'=FBAACP(0) D  I FBAACP="@" S FBAAOUT=1 Q
"RTN","FBAACO3",35,0)
 . N FBIENS,FBFDA
"RTN","FBAACO3",36,0)
 . S FBIENS=FBAACPI_","_FBSDI_","_FBV_","_DFN_","
"RTN","FBAACO3",37,0)
 . S FBFDA(162.03,FBIENS,.01)=FBAACP
"RTN","FBAACO3",38,0)
 . D FILE^DIE("","FBFDA") D MSG^DIALOG()
"RTN","FBAACO3",39,0)
 ; if modifiers changed then update file
"RTN","FBAACO3",40,0)
 I FBMODL'=$$MODL^FBAAUTL4("FBMODA") D REPMOD^FBAAUTL4(DFN,FBV,FBSDI,FBAACPI)
"RTN","FBAACO3",41,0)
 ; now edit remaining fields
"RTN","FBAACO3",42,0)
 D SETO K DR
"RTN","FBAACO3",43,0)
 S DR="48;47;S FBUNITS=X;42R;S FBZIP=X;S:$$ANES^FBAAFS($$CPT^FBAAUTL4(FBAACP)) Y=""@2"";43///@;S FBTIME=X;S Y=""@3"";@2;43R;S FBTIME=X;@3"
"RTN","FBAACO3",44,0)
 ; fb*3.5*116 remove edit of interest indicator (162.03,34) to prevent different interest indicator values at line item level; interest indicator set at invoice level only
"RTN","FBAACO3",45,0)
 ;S DR(1,162.03,1)="S FBAAMM=$S(FBAAPTC=""R"":"""",1:1);D PPT^FBAACO1(FBAAMM1);34///@;34////^S X=FBAAMM1;30R;S FBHCFA(30)=X;1;S J=X;Q"
"RTN","FBAACO3",46,0)
 S DR(1,162.03,1)="30R;S FBHCFA(30)=X;1;S J=X;Q"
"RTN","FBAACO3",47,0)
 S DR(1,162.03,2)="D FEEDT^FBAACO3;44///@;44///^S X=FBFSAMT;45///@;45///^S X=FBFSUSD;S:FBAMTPD'>0!(FBAMTPD=FBAMTPD(0)) Y=""@4"";2///^S X=FBAMTPD;@4;2//^S X=FBAMTPD;D CHKIT^FBAACO3;S K=X"
"RTN","FBAACO3",48,0)
 ;S DR(1,162.03,3)="3//^S X=$S(J-K:J-K,1:"""");4;S:X'=4 Y=6;22;6////^S X=DUZ;13;33"
"RTN","FBAACO3",49,0)
 S DR(1,162.03,3)="K FBADJD;M FBADJD=FBADJ;S FBX=$$ADJ^FBUTL2(J-K,.FBADJ,2,,.FBADJD,1)"
"RTN","FBAACO3",50,0)
 S DR(1,162.03,4)="S:FBFPPSC="""" Y=13;W !,""FPPS CLAIM ID: ""_FBFPPSC;S FBX=$$FPPSL^FBUTL5(FBFPPSL,,1);51///^S X=FBX;S FBFPPSL=X;13;33"
"RTN","FBAACO3",51,0)
 S DR(1,162.03,5)="S:$$EXTPV^FBAAUTL5(FBPOV)=""01"" Y=""@1"";S Y=$S('$D(FB7078):28,FB7078]"""":31,1:28);@5;28R;S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@5"";31;32R;S Y=""@7"";@1;28;I X]"""" S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@1"";31"
"RTN","FBAACO3",52,0)
 S DR(1,162.03,6)="@7;K FBRRMKD;M FBRRMKD=FBRRMK;S FBX=$$RR^FBUTL4(.FBRRMK,2,,.FBRRMKD)"
"RTN","FBAACO3",53,0)
 S DR(1,162.03,7)="73;74;75;58;59;60;61;62;63;64;65;66;67;76;77;78;79;68;69"
"RTN","FBAACO3",54,0)
 S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DIE("NO^")="",FBOT=1
"RTN","FBAACO3",55,0)
 D LOCK^FBUCUTL("^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",FBAACPI) I 'FBLOCK S FBAAOUT=1 Q
"RTN","FBAACO3",56,0)
 D ^DIE
"RTN","FBAACO3",57,0)
 ; if adjustment data changed then file
"RTN","FBAACO3",58,0)
 I $$ADJL^FBUTL2(.FBADJ)'=FBADJL(0) D FILEADJ^FBAAFA(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBADJ)
"RTN","FBAACO3",59,0)
 ; if remit remark data changed then file
"RTN","FBAACO3",60,0)
 I $$RRL^FBUTL4(.FBRRMK)'=FBRRMKL(0) D FILERR^FBAAFR(FBAACPI_","_FBSDI_","_FBV_","_DFN_",",.FBRRMK)
"RTN","FBAACO3",61,0)
 L -^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI) K FBOT,DIE,DR,DA
"RTN","FBAACO3",62,0)
 Q:$D(FBDL)
"RTN","FBAACO3",63,0)
 I $G(FBAAIN) S FBINTOT=0 D CALC
"RTN","FBAACO3",64,0)
 Q
"RTN","FBAACO3",65,0)
SETO S FY=$E(FBAADT,1,3)+1700+$S($E(FBAADT,4,5)>9:1,1:0)
"RTN","FBAACO3",66,0)
 Q
"RTN","FBAACO3",67,0)
OUT ;
"RTN","FBAACO3",68,0)
 ; FB*3.5*116 count line items that have 0.00 amount paid
"RTN","FBAACO3",69,0)
 ;I K>0 S Z1=$P(^FBAA(161.7,FBAABE,0),"^",11)+1,$P(^(0),"^",11)=Z1,FBINTOT=FBINTOT+K
"RTN","FBAACO3",70,0)
 S Z1=$P(^FBAA(161.7,FBAABE,0),"^",11)+1,$P(^(0),"^",11)=Z1,FBINTOT=FBINTOT+K
"RTN","FBAACO3",71,0)
 Q
"RTN","FBAACO3",72,0)
CKMAX S (FBAOT,A)=0,O="" F Z=S-.1:0 S Z=$O(^FBAAC(DFN,"AB",Z)) Q:Z'>0!(Z>R)  F Q=0:0 S Q=$O(^FBAAC(DFN,"AB",Z,Q)) Q:Q'>0  S W=$O(^FBAAC(DFN,"AB",Z,Q,0)) I $D(^FBAAC(DFN,1,Q,1,W,0)) D SMORE
"RTN","FBAACO3",73,0)
 I A>$P(FBSITE(1),"^",9) G NO
"RTN","FBAACO3",74,0)
 Q
"RTN","FBAACO3",75,0)
SMORE N FBA,FBB S FBB=$P($G(^FBAAC(+DFN,1,+Q,1,+W,0)),U,4),E=0
"RTN","FBAACO3",76,0)
 F  S E=$O(^FBAAC(DFN,1,Q,1,W,1,E)) Q:'E  S FBA=$G(^(E,0)) I $P(FBA,"^",9)=2,$P(FBA,"^",18)'=1 D
"RTN","FBAACO3",77,0)
 .I $$IDCHK^FBAAUTL3(DFN,FBB) S A=A+$P(FBA,"^",3) Q
"RTN","FBAACO3",78,0)
 .S FBAOT=FBAOT+$P(FBA,U,3)
"RTN","FBAACO3",79,0)
 Q
"RTN","FBAACO3",80,0)
NO W !!,*7,"Warning Patient already at maximum allowed for month of service",! Q
"RTN","FBAACO3",81,0)
WARN W !!,*7,"You have reached the maximum number of payments for a Batch!",!,"You must select another Batch for entering Payments!"
"RTN","FBAACO3",82,0)
CALC ;Calculate Current Invoice Total
"RTN","FBAACO3",83,0)
 F J=0:0 S J=$O(^FBAAC("C",FBAAIN,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("C",FBAAIN,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("C",FBAAIN,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("C",FBAAIN,J,K,L,M)) Q:M'>0  D CALC1
"RTN","FBAACO3",84,0)
 K J,K,L,M,FZNODE Q
"RTN","FBAACO3",85,0)
CALC1 S FZNODE=^FBAAC(J,1,K,1,L,1,M,0),A2=$P(FZNODE,"^",3),FBINTOT=FBINTOT+A2,FBAAID=$P(FZNODE,"^",15),FBAAVID=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^")
"RTN","FBAACO3",86,0)
 Q
"RTN","FBAACO3",87,0)
FEEDT ;
"RTN","FBAACO3",88,0)
 ; input FB1725 - true (=1) when edited payment is for a Mill Bill claim
"RTN","FBAACO3",89,0)
 N FBX
"RTN","FBAACO3",90,0)
 D SETO:'$G(FY) S FBFY=FY-1
"RTN","FBAACO3",91,0)
 S (FBFSAMT,FBFSUSD)="",FBAMTPD=$G(FBAMTPD)
"RTN","FBAACO3",92,0)
 S FBX=$$GET^FBAAFS($$CPT^FBAAUTL4(FBAACP),$$MODL^FBAAUTL4("FBMODA","E"),FBAADT,$G(FBZIP),$$FAC^FBAAFS($G(FBHCFA(30))),$G(FBTIME))
"RTN","FBAACO3",93,0)
 I '$G(FBAAMM1) D
"RTN","FBAACO3",94,0)
 . S FBFSAMT=$P(FBX,U),FBFSUSD=$P(FBX,U,2)
"RTN","FBAACO3",95,0)
 E  D
"RTN","FBAACO3",96,0)
 . W !,?2,"Payment is for a contracted service so fee schedule does not apply."
"RTN","FBAACO3",97,0)
 I $P($G(FBX),U)]"" D
"RTN","FBAACO3",98,0)
 . W !?2,$S($G(FBAAMM1):"However, f",1:"F")
"RTN","FBAACO3",99,0)
 . W "ee schedule amount is $",$P(FBX,U)," from the "
"RTN","FBAACO3",100,0)
 . W:$P(FBX,U,3)]"" $P(FBX,U,3)," " ; year if returned
"RTN","FBAACO3",101,0)
 . W:$P(FBX,U,2)]"" $$EXTERNAL^DILFD(162.03,45,"",$P(FBX,U,2))
"RTN","FBAACO3",102,0)
 E  W !?2,"Unable to determine a FEE schedule amount."
"RTN","FBAACO3",103,0)
 ;
"RTN","FBAACO3",104,0)
 I FB1725 D
"RTN","FBAACO3",105,0)
 . W !!?2,"**Payment is for emergency treatment under 38 U.S.C. 1725."
"RTN","FBAACO3",106,0)
 . I FBFSAMT D
"RTN","FBAACO3",107,0)
 . . S FBFSAMT=$J(FBFSAMT*.7,0,2)
"RTN","FBAACO3",108,0)
 . . W !?2,"  Therefore, fee schedule amount reduced to $",FBFSAMT," (70%)."
"RTN","FBAACO3",109,0)
 ;
"RTN","FBAACO3",110,0)
 I $G(FBUNITS)>1 D
"RTN","FBAACO3",111,0)
 . W !!?2,"Units Paid = ",FBUNITS
"RTN","FBAACO3",112,0)
 . Q:FBFSAMT'>0
"RTN","FBAACO3",113,0)
 . N FBFSUNIT
"RTN","FBAACO3",114,0)
 . ; determine if fee schedule can be multipled by units
"RTN","FBAACO3",115,0)
 . S FBFSUNIT=$S(FBFSUSD="R":1,FBFSUSD="F"&(FBAADT>3040930):1,1:0)
"RTN","FBAACO3",116,0)
 . I FBFSUNIT D
"RTN","FBAACO3",117,0)
 . . S FBFSAMT=$J(FBFSAMT*FBUNITS,0,2)
"RTN","FBAACO3",118,0)
 . . W !?2,"  Therefore, fee schedule amount increased to $",FBFSAMT
"RTN","FBAACO3",119,0)
 . E  D
"RTN","FBAACO3",120,0)
 . . W !?2,"  Fee schedule not complied on per unit basis so amount not adjusted by units."
"RTN","FBAACO3",121,0)
 ;
"RTN","FBAACO3",122,0)
 I '$G(FBAAMM1) D
"RTN","FBAACO3",123,0)
 . ; set default amount paid to lesser of amt claimed (J) or fee sched.
"RTN","FBAACO3",124,0)
 . S FBAMTPD=$S(FBFSAMT'>0:J,FBFSAMT>J:J,1:FBFSAMT)
"RTN","FBAACO3",125,0)
 W !
"RTN","FBAACO3",126,0)
 Q
"RTN","FBAACO3",127,0)
CHKIT I X>FBAMTPD&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,"You must be a holder of the 'FBAASUPERVISOR' security key in order to",!,"exceed the Fee Schedule.",! S $P(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,0),"^",3)=K,Y=2 Q
"RTN","FBAACO3",128,0)
 Q
"RTN","FBAACO3",129,0)
NOGO W !!,*7,"This payment CANNOT be edited.  The batch the payment is in",!,"has been Vouchered.  You may void the payment with the Void Payment option.",!
"RTN","FBAACO3",130,0)
 Q
"RTN","FBAACO3",131,0)
 ;
"RTN","FBAACO3",132,0)
SC W *7,!?4,"Suspense code is required!",! S Y="@4" Q
"RTN","FBAACO3",133,0)
 ;
"RTN","FBAACO3",134,0)
DEL ;delete date of service if no service provided entered
"RTN","FBAACO3",135,0)
 I '$O(^FBAAC(DFN,1,FBV,1,FBSDI,1,0)) D
"RTN","FBAACO3",136,0)
 .S DIK="^FBAAC(DFN,1,FBV,1,",DA(2)=DFN,DA(1)=FBV,DA=FBSDI D ^DIK W !!?5,*7,"Incomplete payment entry deleted.",!
"RTN","FBAACO3",137,0)
 K DIK,DA Q
"RTN","FBAAPET")
0^1^B35047442^B35557510
"RTN","FBAAPET",1,0)
FBAAPET ;AISC/DMK-EDIT PAYMENT ;7/13/2003
"RTN","FBAAPET",2,0)
 ;;3.5;FEE BASIS;**4,38,55,61,77,116,122,133**;JAN 30, 1995;Build 5
"RTN","FBAAPET",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAAPET",4,0)
 S FBOT=1
"RTN","FBAAPET",5,0)
GETPT I $G(BAT) D
"RTN","FBAAPET",6,0)
 .I '$D(^FBAAC("AC",+BAT)) F I=9,10,11 S $P(^FBAA(161.7,+BAT,0),U,I)=""
"RTN","FBAAPET",7,0)
 .I $D(^FBAAC("AC",+BAT)) D  S $P(^FBAA(161.7,+BAT,0),U,11)=I,$P(^(0),U,9)=$G(FBTOT) K I,FBTOT
"RTN","FBAAPET",8,0)
 ..N J,K,L,M S (I,J,K,L,M,FBTOT)=0
"RTN","FBAAPET",9,0)
 ..F  S J=$O(^FBAAC("AC",+BAT,J)) Q:'J  F  S K=$O(^FBAAC("AC",+BAT,J,K)) Q:'K  F  S L=$O(^FBAAC("AC",+BAT,J,K,L)) Q:'L  F  S M=$O(^FBAAC("AC",+BAT,J,K,L,M)) Q:'M  I $D(^FBAAC(J,1,K,1,L,1,M,0)) S I=I+1,FBTOT=FBTOT+$P(^(0),U,3)
"RTN","FBAAPET",10,0)
 W !! S DIC="^FBAAC(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),GETPT:Y<0 S (DFN,FBDA(3))=+Y
"RTN","FBAAPET",11,0)
 S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
"RTN","FBAAPET",12,0)
 S DIC=DIC_DFN_",1,"
"RTN","FBAAPET",13,0)
GETVD W !! S DIC(0)="AEQM" D ^DIC G GETPT:X="^"!(X=""),GETVD:Y<0 S (FBV,FBVD,FBDA(2))=+Y
"RTN","FBAAPET",14,0)
 S:'$D(^FBAAC(DFN,1,FBDA(2),1,0)) ^FBAAC(DFN,1,FBDA(2),1,0)="^162.02DA^0^0"
"RTN","FBAAPET",15,0)
 S DIC=DIC_FBVD_",1,"
"RTN","FBAAPET",16,0)
GETDT S DIC(0)="AEQM",DIC("A")="Date of Service: " D ^DIC K DIC("A") G GETPT:X="^"!(X=""),GETDT:Y<0 S (FBSD,FBSDI,FBDA(1))=+Y,FBAADT=$P(Y,U,2)
"RTN","FBAAPET",17,0)
 S:'$D(^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)) ^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)="^162.03A^0^0"
"RTN","FBAAPET",18,0)
 S FBZ=DIC_FBSD_",1,"
"RTN","FBAAPET",19,0)
SERV S DA(3)=FBDA(3),DA(2)=FBDA(2),DA(1)=FBDA(1)
"RTN","FBAAPET",20,0)
 S DIC("W")="N FBX S FBX=$$MODL^FBAAUTL4(""^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,+Y,""""M"""")"",""E"") W:FBX]"""" ""    CPT Modifier(s): "",FBX Q"
"RTN","FBAAPET",21,0)
 S DIC=FBZ,DIC(0)="AEQMZ"
"RTN","FBAAPET",22,0)
 D
"RTN","FBAAPET",23,0)
 . N ICPTVDT S ICPTVDT=$G(FBAADT) D ^DIC
"RTN","FBAAPET",24,0)
 G GETPT:X="^"!(X=""),SERV:Y<0 S (FBSV,FBAACPI,FBDA)=+Y,BAT=$P(Y(0),U,8),FBDUZ=$P(Y(0),U,7),(FBAACP,FBAACP(0))=$P(Y,U,2),K=$P(Y(0),U,3),FBAAPTC=$P(Y(0),U,20),J(0)=$P(Y(0),U,2)
"RTN","FBAAPET",25,0)
 ; set FB1725 true (1) if payment is for a Mill Bill claim
"RTN","FBAAPET",26,0)
 S FB1725=$S($P(Y(0),U,13)["FB583":+$P($G(^FB583(+$P(Y(0),U,13),0)),U,28),1:0)
"RTN","FBAAPET",27,0)
 I FBDUZ'=DUZ&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry,only the clerk who entered the payment ",!," or a supervisor can edit this payment." G GETPT
"RTN","FBAAPET",28,0)
 S FBAAMM1=$P($G(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,2)),U,2)
"RTN","FBAAPET",29,0)
 S FBFSAMT(0)=$P($G(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,2)),U,12)
"RTN","FBAAPET",30,0)
 ; determine lesser of original fee schedule amount and amount claimed
"RTN","FBAAPET",31,0)
 S FBAMTPD(0)=$S(FBFSAMT(0)="":J(0),FBFSAMT(0)>J(0):J(0),1:FBFSAMT(0))
"RTN","FBAAPET",32,0)
 S FBMODL=$$MODL^FBAAUTL4("^FBAAC("_FBDA(3)_",1,"_FBDA(2)_",1,"_FBDA(1)_",1,"_FBDA_",""M"")")
"RTN","FBAAPET",33,0)
 ; load current adjustment data
"RTN","FBAAPET",34,0)
 D LOADADJ^FBAAFA(FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",",.FBADJ)
"RTN","FBAAPET",35,0)
 ; save adjustment data prior to edit session in sorted list
"RTN","FBAAPET",36,0)
 S FBADJL(0)=$$ADJL^FBUTL2(.FBADJ) ; sorted list of original adjustments
"RTN","FBAAPET",37,0)
 ; load current remittance remark data
"RTN","FBAAPET",38,0)
 D LOADRR^FBAAFR(FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",",.FBRRMK)
"RTN","FBAAPET",39,0)
 ; save remittance remarks prior to edit session in sorted list
"RTN","FBAAPET",40,0)
 S FBRRMKL(0)=$$RRL^FBUTL4(.FBRRMK)
"RTN","FBAAPET",41,0)
 ; save FPPS data prior to edit session
"RTN","FBAAPET",42,0)
 S FBFPPSC(0)=$P($G(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,3)),U)
"RTN","FBAAPET",43,0)
 S FBFPPSC=FBFPPSC(0)
"RTN","FBAAPET",44,0)
 S FBFPPSL(0)=$P($G(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,3)),U,2)
"RTN","FBAAPET",45,0)
 S FBFPPSL=FBFPPSL(0)
"RTN","FBAAPET",46,0)
 G:BAT']"" EDIT
"RTN","FBAAPET",47,0)
 I $G(^FBAA(161.7,BAT,"ST"))]"",$P(^FBAA(161.7,BAT,"ST"),"^")="S"!($P(^FBAA(161.7,BAT,"ST"),"^")="T")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry, only the Supervisor can edit a payment once the batch has been released." G GETPT
"RTN","FBAAPET",48,0)
 I $G(^FBAA(161.7,BAT,"ST"))]"",$P(^FBAA(161.7,BAT,"ST"),"^")="V" W !!,*7,"Sorry,you cannot edit a payment once the batch has been Finalized." G GETPT
"RTN","FBAAPET",49,0)
EDIT S DA=FBSV
"RTN","FBAAPET",50,0)
 ;
"RTN","FBAAPET",51,0)
 ; first edit CPT code and modifiers
"RTN","FBAAPET",52,0)
 D CPTM^FBAALU(FBAADT,DFN,FBAACP(0),FBMODL) I '$G(FBGOT) G GETPT
"RTN","FBAAPET",53,0)
 ; if CPT was changed then update file
"RTN","FBAAPET",54,0)
 I FBAACP'=FBAACP(0) D  I FBAACP="@" G GETPT
"RTN","FBAAPET",55,0)
 . N FBIENS,FBFDA
"RTN","FBAAPET",56,0)
 . S FBIENS=FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_","
"RTN","FBAAPET",57,0)
 . S FBFDA(162.03,FBIENS,.01)=FBAACP
"RTN","FBAAPET",58,0)
 . D FILE^DIE("","FBFDA") D MSG^DIALOG()
"RTN","FBAAPET",59,0)
 ; if modifiers changed then update file
"RTN","FBAAPET",60,0)
 I FBMODL'=$$MODL^FBAAUTL4("FBMODA") D REPMOD^FBAAUTL4(FBDA(3),FBDA(2),FBDA(1),FBDA)
"RTN","FBAAPET",61,0)
 ;
"RTN","FBAAPET",62,0)
 ; now edit remaining fields
"RTN","FBAAPET",63,0)
 S DIE("NO^")=""
"RTN","FBAAPET",64,0)
 S DR="48;47;S FBUNITS=X;42R;S FBZIP=X;S:$$ANES^FBAAFS($$CPT^FBAAUTL4(FBAACP)) Y=""@2"";43///@;S FBTIME=X;S Y=""@3"";@2;43R;S FBTIME=X;@3"
"RTN","FBAAPET",65,0)
 ; fb*3.5*116 remove edit of interest indicator (162.03,34) to prevent different interest indicator values at line item level; interest indicator set at invoice level only; 
"RTN","FBAAPET",66,0)
 ;S DR(1,162.03,1)="S FBAAMM=$S(FBAAPTC=""R"":"""",1:1);D PPT^FBAACO1(FBAAMM1);34///@;34////^S X=FBAAMM1;30R;S FBHCFA(30)=X;1;S J=X;Q"
"RTN","FBAAPET",67,0)
 S DR(1,162.03,1)="30R;S FBHCFA(30)=X;1;S J=X;Q"
"RTN","FBAAPET",68,0)
 S DR(1,162.03,2)="D FEEDT^FBAACO3;44///@;44///^S X=FBFSAMT;45///@;45///^S X=FBFSUSD;S:FBAMTPD'>0!(FBAMTPD=FBAMTPD(0)) Y=""@4"";2///^S X=FBAMTPD;@4;2//^S X=FBAMTPD;D CHKIT^FBAACO3;S K=X"
"RTN","FBAAPET",69,0)
 ;S DR(1,162.03,3)="3////^S X=$S(J-K:J-K,1:"""");I X S Y=""@11"";4////@;S Y=""@5"";@11;3R;4R;S:X'=4 Y=""@5"";22"
"RTN","FBAAPET",70,0)
 S DR(1,162.03,3)="K FBADJD;M FBADJD=FBADJ;S FBX=$$ADJ^FBUTL2(J-K,.FBADJ,2,,.FBADJD,1)"
"RTN","FBAAPET",71,0)
 S DR(1,162.03,4)="S FBX=$$FPPSC^FBUTL5(1,FBFPPSC);S:FBX=-1 Y=0;S:FBX="""" Y=""@5"";50///^S X=FBX;S FBFPPSC=X;S FBX=$$FPPSL^FBUTL5(FBFPPSL);S:FBX=-1 Y=0;51///^S X=FBX;S FBFPPCL=X;S Y=""@55"";@5;50///@;S FBFPPSC="""";51///@;S FBFPPSL="""";@55"
"RTN","FBAAPET",72,0)
 S DR(1,162.03,5)="K DIE(""NO^"");W !,""Exit ('^') allowed now"";26;S PRC(""SITE"")=X;8;13;Q;33;49"
"RTN","FBAAPET",73,0)
 S DR(1,162.03,6)="15;17;16;S:X=1 Y=""@1"";@6;28R;S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@6"";31;32R;S Y=""@7"";@1;28;I X]"""" S:$$INPICD9^FBCSV1(X,"""",$G(FBAADT)) Y=""@1"";31"
"RTN","FBAAPET",74,0)
 S DR(1,162.03,7)="@7;K FBRRMKD;M FBRRMKD=FBRRMK;S FBX=$$RR^FBUTL4(.FBRRMK,2,,.FBRRMKD)"
"RTN","FBAAPET",75,0)
 S DR(1,162.03,8)="73;74;75;58;59;60;61;62;63;64;65;66;67;76;77;78;79;68;69" ;FB*3.5*122,FB*3.5*133 edit line item provider fields
"RTN","FBAAPET",76,0)
 S DIE=FBZ
"RTN","FBAAPET",77,0)
 D
"RTN","FBAAPET",78,0)
 . N ICPTVDT,ICDVDT S (ICPTVDT,ICDVDT)=$G(FBAADT) D ^DIE
"RTN","FBAAPET",79,0)
 ; if adjustment data changed then file
"RTN","FBAAPET",80,0)
 I $$ADJL^FBUTL2(.FBADJ)'=FBADJL(0) D FILEADJ^FBAAFA(FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",",.FBADJ)
"RTN","FBAAPET",81,0)
 ; if remit remark data changed then file
"RTN","FBAAPET",82,0)
 I $$RRL^FBUTL4(.FBRRMK)'=FBRRMKL(0) D FILERR^FBAAFR(FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",",.FBRRMK)
"RTN","FBAAPET",83,0)
 ; if FPPS CLAIM ID changed, update other line items on invoice
"RTN","FBAAPET",84,0)
 I FBFPPSC'=FBFPPSC(0) D
"RTN","FBAAPET",85,0)
 . N FBAAIN
"RTN","FBAAPET",86,0)
 . S FBAAIN=$$GET1^DIQ(162.03,FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",",14)
"RTN","FBAAPET",87,0)
 . D CKINVEDI^FBAAPET1(FBFPPSC(0),FBFPPSC,FBAAIN,FBDA_","_FBDA(1)_","_FBDA(2)_","_FBDA(3)_",")
"RTN","FBAAPET",88,0)
 K FBSV W !! G SERV
"RTN","FBAAPET",89,0)
END K DR,DIC,DIE,X,DFN,FBOT,FBVD,FBSD,BAT,FBAADT,FBSV,DA,FBDA,FBZ,FBDUZ,FBAACP,FBFY,FY,FBAMTPD,J,K,Y,ZZ,PRC,FBHOLDX,FBV,FBSDI,FBAACPI
"RTN","FBAAPET",90,0)
 K FBFSAMT,FBFSUSD,FBMODA,FBZIP,FBTIME,FBHCFA(30),FBAAPTC,FB1725,FBADJ,FBADJD,FBADJL(0),FBRRMK,FBRRMKD,FBRRMKL(0),FBX,FBUNITS
"RTN","FBAAPET",91,0)
 Q
"RTN","FBAAPIN")
0^4^B33741138^B33397999
"RTN","FBAAPIN",1,0)
FBAAPIN ;AISC/GRR-INVOICE DISPLAY ;7/17/2003
"RTN","FBAAPIN",2,0)
 ;;3.5;FEE BASIS;**4,61,122,133**;JAN 30, 1995;Build 5
"RTN","FBAAPIN",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBAAPIN",4,0)
 D DT^DICRW
"RTN","FBAAPIN",5,0)
RD1 W ! S (FBHDONE,FBAAOUT,FBINTOT)=0,FBSW=0 K FBHED S DIR(0)="NO",DIR("A")="Select Invoice Number",DIR("?")="^D HELP^FBAAPIN1" D ^DIR K DIR G Q:$D(DIRUT)!'Y
"RTN","FBAAPIN",6,0)
 I '$D(^FBAAC("C",X)) W !,*7,"Invalid selection.",! G RD1
"RTN","FBAAPIN",7,0)
 S HX=X,FBAAIN=X D LIST S X=HX G RD1
"RTN","FBAAPIN",8,0)
LIST S Q="",$P(Q,"=",80)="="
"RTN","FBAAPIN",9,0)
 S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
"RTN","FBAAPIN",10,0)
 F J=0:0 S J=$O(^FBAAC("C",FBAAIN,J)) Q:J'>0!(FBAAOUT)  D MMORE
"RTN","FBAAPIN",11,0)
 Q
"RTN","FBAAPIN",12,0)
SET S FBFILE="^FBAAC("_J_",1,"_K_",1,"_L_",1,"_M_",1,",D=$P($G(^FBAAC(J,1,K,1,L,0)),"^",1),FBYY=$G(^FBAAC(J,1,K,1,L,1,M,0)),FBYY("REJ")=$S($D(^FBAAC(J,1,K,1,L,1,M,"FBREJ")):^("FBREJ"),1:""),FBY=$G(^FBAAC(J,1,K,1,L,1,M,2))
"RTN","FBAAPIN",13,0)
 S FBY3=$G(^FBAAC(J,1,K,1,L,1,M,3))
"RTN","FBAAPIN",14,0)
 S FBAARCE=$$GET1^DIQ(162.03,M_","_L_","_K_","_J_",",48)
"RTN","FBAAPIN",15,0)
 D SET2
"RTN","FBAAPIN",16,0)
 Q
"RTN","FBAAPIN",17,0)
SET2 ;
"RTN","FBAAPIN",18,0)
 N FBX
"RTN","FBAAPIN",19,0)
 S N=$S($D(^DPT(J,0)):$P(^(0),"^",1),1:""),S=$S(N]"":$P(^DPT(J,0),"^",9),1:""),V=$S($D(^FBAAV(K,0)):$P(^FBAAV(K,0),"^",1),1:"")
"RTN","FBAAPIN",20,0)
 S T=$P(FBYY,"^",5),D2=$P(FBYY,"^",6),ZS=$P(FBYY,"^",20),VP=$P(FBYY,"^",21)
"RTN","FBAAPIN",21,0)
 S T=$P($G(^FBAA(161.27,+T,0)),U)
"RTN","FBAAPIN",22,0)
 S TAMT=$FN($P(FBYY,U,4),"",2)
"RTN","FBAAPIN",23,0)
 S FBAACPT=$P(FBYY,"^",1) I FBAACPT]"" S FBAACPT=$$CPT^FBAAUTL4(FBAACPT)
"RTN","FBAAPIN",24,0)
 S FBMODLE=$$MODL^FBAAUTL4("^FBAAC("_J_",1,"_K_",1,"_L_",1,"_M_",""M"")","E")
"RTN","FBAAPIN",25,0)
 S FBUNITS=$P(FBY,U,14)
"RTN","FBAAPIN",26,0)
 S FBFPPSL=$P(FBY3,U,2)
"RTN","FBAAPIN",27,0)
 S FBX=$$ADJLRA^FBAAFA(M_","_L_","_K_","_J_",")
"RTN","FBAAPIN",28,0)
 S FBADJLR=$P(FBX,U)
"RTN","FBAAPIN",29,0)
 S FBADJLA=$P(FBX,U,2)
"RTN","FBAAPIN",30,0)
 S FBRRMKL=$$RRL^FBAAFR(M_","_L_","_K_","_J_",")
"RTN","FBAAPIN",31,0)
 S A1=$P(FBYY,"^",2)+.0001,A2=$P(FBYY,"^",3)+.0001,A3=$P(FBYY,"^",12)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),A3=$P(A3,".",1)_"."_$E($P(A3,".",2),1,2),FBINTOT=FBINTOT+A2+.0001
"RTN","FBAAPIN",32,0)
 S FBINTOT=$P(FBINTOT,".")_"."_$E($P(FBINTOT,".",2),1,2)
"RTN","FBAAPIN",33,0)
 S FBBN=$S($P(FBYY,"^",8)]"":$S($D(^FBAA(161.7,$P(FBYY,"^",8),0)):$P(^(0),"^",1),1:""),$P(FBYY("REJ"),"^",3)]"":$S($D(^FBAA(161.7,$P(FBYY("REJ"),"^",3),0)):$P(^(0),"^",1),1:""),1:"")
"RTN","FBAAPIN",34,0)
 D FBCKO^FBAACCB2(J,K,L,M)
"RTN","FBAAPIN",35,0)
 I $D(^FBAAC(J,1,K,1,L,1,M,4))!($D(^FBAAC(J,1,K,1,L,1,M,5))) D PROV
"RTN","FBAAPIN",36,0)
 I '$D(FBHED) D HED
"RTN","FBAAPIN",37,0)
 D WRT S FBHED=1
"RTN","FBAAPIN",38,0)
 Q
"RTN","FBAAPIN",39,0)
WRT I ($Y+5)>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  D HED
"RTN","FBAAPIN",40,0)
 W !!,N,?33,$$DATX^FBAAUTL(D),?43,FBAACPT_$S($G(FBMODLE)]"":"-"_$P(FBMODLE,","),1:"")
"RTN","FBAAPIN",41,0)
 I FBAARCE]"" W ?51,"/",FBAARCE
"RTN","FBAAPIN",42,0)
 W ?57,FBBN,?67,$S(FBYY("REJ")]"":"Rejected",1:$$DATX^FBAAUTL(D2))
"RTN","FBAAPIN",43,0)
 I $P($G(FBMODLE),",",2)]"" D  Q:FBAAOUT
"RTN","FBAAPIN",44,0)
 . N FBI
"RTN","FBAAPIN",45,0)
 . F FBI=2:1 S FBMOD=$P(FBMODLE,",",FBI) Q:FBMOD=""  D  Q:FBAAOUT
"RTN","FBAAPIN",46,0)
 . . I $Y+5>IOSL D  Q:FBAAOUT  W !,"(continued)"
"RTN","FBAAPIN",47,0)
 . . . S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  D HED
"RTN","FBAAPIN",48,0)
 . . W !,?48,"-",FBMOD
"RTN","FBAAPIN",49,0)
 W !,$S(ZS="R":"*",1:""),$S(VP="VP":"#",1:""),$S($G(FBCAN)]"":"+",1:"")
"RTN","FBAAPIN",50,0)
 W ?3,FBFPPSL,?14,"$",$J(A1,8),?26,"$",$J(A2,8),?37,FBUNITS
"RTN","FBAAPIN",51,0)
 ; write adjustment reasons, if null then write suspend code
"RTN","FBAAPIN",52,0)
 W ?43,$S(FBADJLR]"":FBADJLR,1:T)
"RTN","FBAAPIN",53,0)
 ; write adjustment amounts, if null then write amount suspended
"RTN","FBAAPIN",54,0)
 W ?53,"$",$S(FBADJLA]"":FBADJLA,1:TAMT)
"RTN","FBAAPIN",55,0)
 W ?69,FBRRMKL
"RTN","FBAAPIN",56,0)
 ; if adjustment reasons null and suspend code = other then write desc.
"RTN","FBAAPIN",57,0)
 I FBADJLR="",T=4 D ^FBAAPIN1
"RTN","FBAAPIN",58,0)
 D PMNT^FBAACCB2
"RTN","FBAAPIN",59,0)
 Q
"RTN","FBAAPIN",60,0)
HED W @IOF,!,"Invoice Number: ",FBAAIN,?30,"Vendor Name: ",V,!,?2,"Date Received: ",FBINDAT
"RTN","FBAAPIN",61,0)
 I +$G(FBY) W ?33,"Invoice Date: ",$$DATX^FBAAUTL(+FBY)
"RTN","FBAAPIN",62,0)
 W !?2,"FPPS Claim ID: ",$S(FBFPPSC]"":FBFPPSC,1:"N/A")
"RTN","FBAAPIN",63,0)
 W ?33,"Patient Account #: ",FBCSID
"RTN","FBAAPIN",64,0)
 W !?10,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
"RTN","FBAAPIN",65,0)
 ;W !,"SVC DATE"," CPT-MOD ","   AMT CLAIMED",?35,"AMT PAID",?47,"CODE",?57,"BATCH NO.",?67,"VOUCHER DATE",!,?5,"Other Suspension Description",!,$$REPEAT^XLFSTR("=",79),!
"RTN","FBAAPIN",66,0)
 W !,"PATIENT",?33,"SVC DATE",?43,"CPT-MOD",?51,"/REV",?57,"BATCH NO.",?67,"VOUCHER DATE"
"RTN","FBAAPIN",67,0)
 W !,?3,"FPPS LINE",?14,"AMT CLAIMED",?26,"AMT PAID",?36,"UNITS",?43,"ADJ CODE",?53,"ADJ AMT",?69,"REMIT RMK"
"RTN","FBAAPIN",68,0)
 W !,$$REPEAT^XLFSTR("=",79)
"RTN","FBAAPIN",69,0)
 Q
"RTN","FBAAPIN",70,0)
Q K D,N,V,D2,J,K,L,M,DIC,T,FBYY,Q,I,A1,A2,A3,C,DIYS,FBAACPT,FBAAIN,FBAAOUT,FBBN,FBINTOT,FBINDAT,FBSW,FBHDONE,HX,S,VP,Z,ZS,FBHED,FBFILE,DIRUT,FBY,FBMOD
"RTN","FBAAPIN",71,0)
 K FBMODLE
"RTN","FBAAPIN",72,0)
 K FBAARCE,FBADJLA,FBADJLR,FBCSID,FBFPPSC,FBFPPSL,FBRRMKL,FBUNITS,TAMT
"RTN","FBAAPIN",73,0)
 Q
"RTN","FBAAPIN",74,0)
ERR W !,*7,"Please enter a whole number! Alpha characters and puctuation are invalid" G RD1
"RTN","FBAAPIN",75,0)
SETHD S V=$S($D(^FBAAV(K,0)):$P(^(0),"^",1),1:"") D INDAT:FBSW S FBHDONE=1 Q
"RTN","FBAAPIN",76,0)
MMORE S FBSW=1 F K=0:0 S K=$O(^FBAAC("C",FBAAIN,J,K)) Q:K=""!(FBAAOUT)  D SETHD F L=0:0 S L=$O(^FBAAC("C",FBAAIN,J,K,L)) Q:L=""!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("C",FBAAIN,J,K,L,M)) Q:M'>0  D SET Q:FBAAOUT
"RTN","FBAAPIN",77,0)
 Q
"RTN","FBAAPIN",78,0)
INDAT S L=$O(^FBAAC("C",FBAAIN,J,K,"")),M=$O(^FBAAC("C",FBAAIN,J,K,L,""))
"RTN","FBAAPIN",79,0)
 S FBINDAT=$P($G(^FBAAC(J,1,K,1,L,1,M,0)),"^",15)
"RTN","FBAAPIN",80,0)
 S FBINDAT=$S(FBINDAT="":"Unknown",1:$E(FBINDAT,4,5)_"/"_$E(FBINDAT,6,7)_"/"_$E(FBINDAT,2,3))
"RTN","FBAAPIN",81,0)
 S FBFPPSC=$P($G(^FBAAC(J,1,K,1,L,1,M,3)),U,1)
"RTN","FBAAPIN",82,0)
 S FBCSID=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),U,16)
"RTN","FBAAPIN",83,0)
 S FBSW=0 K L,M Q
"RTN","FBAAPIN",84,0)
 Q
"RTN","FBAAPIN",85,0)
PROV ;Display Invoice Provider information before invoice details FB*3.5*122
"RTN","FBAAPIN",86,0)
 N FBPRI,FBSRVF S FBPRI=$G(^FBAAC(J,1,K,1,L,1,M,4)),FBSRVF=$G(^FBAAC(J,1,K,1,L,1,M,5)),$P(FBSRVF,U,3)=$$GET1^DIQ(5,$P(FBSRVF,U,3)_",",1)
"RTN","FBAAPIN",87,0)
 W @IOF,!?30,"INVOICE DISPLAY",!?30,"===============",!?28,"PROVIDER INFORMATION",!
"RTN","FBAAPIN",88,0)
 I $L($P(FBPRI,U,1,3))>3 W !?3,"ATTENDING PROV NAME: "_$P(FBPRI,U),!?3,"ATTENDING PROV NPI: "_$P(FBPRI,U,2),?35,"ATTENDING PROV TAXONOMY CODE: "_$P(FBPRI,U,3)
"RTN","FBAAPIN",89,0)
 I $L($P(FBPRI,U,4,5))>2 W !!?3,"OPERATING PROV NAME: "_$P(FBPRI,U,4),!?3,"OPERATING PROV NPI: "_$P(FBPRI,U,5)
"RTN","FBAAPIN",90,0)
 I $L($P(FBPRI,U,6,8))>3 W !!?3,"RENDERING PROV NAME: "_$P(FBPRI,U,6),!?3,"RENDERING PROV NPI: "_$P(FBPRI,U,7),?35,"RENDERING PROV TAXONOMY CODE: "_$P(FBPRI,U,8)
"RTN","FBAAPIN",91,0)
 I $L($P(FBPRI,U,9,10))>2 W !!?3,"SERVICING PROV NAME: "_$P(FBPRI,U,9),!?3,"SERVICING PROV NPI: "_$P(FBPRI,U,10)
"RTN","FBAAPIN",92,0)
 I $L($P(FBSRVF,U,1,4))>4 W !?3,"SERVICING FACILITY ADDRESS: ",!?5,$P(FBSRVF,U),!?5,$P(FBSRVF,U,2) I $P(FBSRVF,U,2)'="" W ", "
"RTN","FBAAPIN",93,0)
 W $P(FBSRVF,U,3)_" "_$P(FBSRVF,U,4)
"RTN","FBAAPIN",94,0)
 I $L($P(FBPRI,U,11,12))>2 W !!?3,"REFERRING PROV NAME: "_$P(FBPRI,U,11),!?3,"REFERRING PROV NPI: "_$P(FBPRI,U,12),!!
"RTN","FBAAPIN",95,0)
 I '$D(FBHED) S DIR(0)="E" D ^DIR
"RTN","FBAAPIN",96,0)
 Q
"RTN","FBCHEP1")
0^21^B11600569^B11345024
"RTN","FBCHEP1",1,0)
FBCHEP1 ;AISC/DMK-EDIT PAYMENT FOR CONTRACT HOSPITAL ;7/8/2003
"RTN","FBCHEP1",2,0)
 ;;3.5;FEE BASIS;**38,61,122,133**;JAN 30, 1995;Build 5
"RTN","FBCHEP1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBCHEP1",4,0)
EDIT ;ENTRY POINT TO EDIT PAYMENT
"RTN","FBCHEP1",5,0)
 S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
"RTN","FBCHEP1",6,0)
BT W ! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,15)=""Y"")",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):DIC("S"),1:DIC("S")_"&($P(^(0),U,5)=DUZ)") D ^DIC
"RTN","FBCHEP1",7,0)
 G END:X=""!(X="^"),BT:Y<0 S FBN=+Y,FBN(0)=Y(0)
"RTN","FBCHEP1",8,0)
 S FBEXMPT=$P(FBN(0),"^",18)
"RTN","FBCHEP1",9,0)
 S FBSTAT=^FBAA(161.7,FBN,"ST"),FBBAMT=$S($P(FBN(0),"^",9)="":0,1:$P(FBN(0),"^",9))
"RTN","FBCHEP1",10,0)
 I FBSTAT="C"&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must Reopen the batch prior to editting the invoice.",! G END
"RTN","FBCHEP1",11,0)
 I FBSTAT="S"!(FBSTAT="P")!(FBSTAT="R")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must be a holder of the 'FBAASUPERVISOR' security key",!,?3,"to edit this invoice.",! G END
"RTN","FBCHEP1",12,0)
 I FBSTAT="T"!(FBSTAT="V") W !!,?3,"Batch has already been sent to Austin for payment.",! G END
"RTN","FBCHEP1",13,0)
INV W ! S DIC="^FBAAI(",DIC(0)="AEQZ",DIC("S")="I $P(^(0),U,17)=FBN" D ^DIC K DIC("S") G BT:X=""!(X="^"),INV:Y<0 S FBI=+Y
"RTN","FBCHEP1",14,0)
 S FBK=$S($P(^FBAAI(FBI,0),"^",9)="":0,1:$P(^(0),"^",9))
"RTN","FBCHEP1",15,0)
 S FBLISTC="",FBAAI=FBI W @IOF D START^FBCHDI2 S FBI=FBAAI I $P(^FBAAI(FBI,0),"^",9)="" S FBPRICE=""
"RTN","FBCHEP1",16,0)
 ; set FB1725 flag = true if payment for a 38 U.S.C. 1725 claim
"RTN","FBCHEP1",17,0)
 D
"RTN","FBCHEP1",18,0)
 . N FBY
"RTN","FBCHEP1",19,0)
 . S FBY=$G(^FBAAI(FBI,0))
"RTN","FBCHEP1",20,0)
 . S FB1725=$S($P(FBY,U,5)["FB583":+$P($G(^FB583(+$P(FBY,U,5),0)),U,28),1:0)
"RTN","FBCHEP1",21,0)
 ; get values of FPPS Claim ID and Line Item
"RTN","FBCHEP1",22,0)
 S FBFPPSC=$P($G(^FBAAI(FBI,3)),U)
"RTN","FBCHEP1",23,0)
 S FBFPPSL=$P($G(^FBAAI(FBI,3)),U,2)
"RTN","FBCHEP1",24,0)
 ; load current adjustment data
"RTN","FBCHEP1",25,0)
 D LOADADJ^FBCHFA(FBI_",",.FBADJ)
"RTN","FBCHEP1",26,0)
 ; save adjustment data prior to edit session in sorted list
"RTN","FBCHEP1",27,0)
 S FBADJL(0)=$$ADJL^FBUTL2(.FBADJ) ; sorted list of original adjustments
"RTN","FBCHEP1",28,0)
 ; load current remittance remark data
"RTN","FBCHEP1",29,0)
 D LOADRR^FBCHFR(FBI_",",.FBRRMK)
"RTN","FBCHEP1",30,0)
 ; load Item level Rendering provider data
"RTN","FBCHEP1",31,0)
 D LOADRP^FBUTL8(FBI_",",.FBPROV) ;FB*3.5*122
"RTN","FBCHEP1",32,0)
 ; save remittance remarks prior to edit session in sorted list
"RTN","FBCHEP1",33,0)
 S FBRRMKL(0)=$$RRL^FBUTL4(.FBRRMK)
"RTN","FBCHEP1",34,0)
 S (DIE,DIC)="^FBAAI(",DIC(0)="AEQM",DA=FBI,DR="[FBCH EDIT PAYMENT]" W ! D ^DIE
"RTN","FBCHEP1",35,0)
 ; if adjustment data changed then file
"RTN","FBCHEP1",36,0)
 I $$ADJL^FBUTL2(.FBADJ)'=FBADJL(0) D FILEADJ^FBCHFA(FBI_",",.FBADJ)
"RTN","FBCHEP1",37,0)
 ; if remit remark data changed then file
"RTN","FBCHEP1",38,0)
 I $$RRL^FBUTL4(.FBRRMK)'=FBRRMKL(0) D FILERR^FBCHFR(FBI_",",.FBRRMK)
"RTN","FBCHEP1",39,0)
 ; if line item rendering providers exist then file FB*3.5*133
"RTN","FBCHEP1",40,0)
 I $D(FBPROV) D FILERP^FBUTL8(FBI_",",.FBPROV)
"RTN","FBCHEP1",41,0)
 K FBAAMM,FBAAMM1
"RTN","FBCHEP1",42,0)
 S FBNK=$P(^FBAAI(FBI,0),"^",9)
"RTN","FBCHEP1",43,0)
 I FBNK-FBK S $P(^FBAA(161.7,FBN,0),"^",9)=FBBAMT+(FBNK-FBK)
"RTN","FBCHEP1",44,0)
END K DA,DFN,DIC,DIE,DR,FBAAOUT,FBDX,FBI,FBIN,FBLISTC,FBN,FBPROC,FBSTAT,FBVEN,FBVID,J,K,L,POP,Q,VA,VADM,X,FBIFN,Y,FBPRICE,FBK,FBNK,FB583,FBAAPN,FBASSOC,FBDEL,FBLOC,DAT
"RTN","FBCHEP1",45,0)
 K CNT,D0,FB7078,FBAABDT,FBAAEDT,FBASSOC,FBAUT,FBLOC,FBPROG,FBPSA,FBPT,FBRR,FBTT,FBTYPE,FBXX,FTP,PI,PTYPE,T,Z,ZZ,F,FBPOV,I,TA,VAL,DUOUT,FBVET,FBBAMT,FBAAI,FBEXMPT,FB1725,FBPAMT
"RTN","FBCHEP1",46,0)
 K FBFPPSC,FBFPPSL,FBADJ,FBADJD,FBRRMK,FBRRMKD
"RTN","FBCHEP1",47,0)
 D END^FBCHDI
"RTN","FBCHEP1",48,0)
 Q
"RTN","FBPCR2")
0^20^B77224131^B61489051
"RTN","FBPCR2",1,0)
FBPCR2 ;AISC/DMK,GRR,TET-OUTPATIENT POTENTIAL COST RECOVERY SORT/PRINT ;07/01/2006
"RTN","FBPCR2",2,0)
 ;;3.5;FEE BASIS;**4,48,55,69,76,98,122,133**;JAN 30, 1995;Build 5
"RTN","FBPCR2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBPCR2",4,0)
EN ;entry point
"RTN","FBPCR2",5,0)
 S (FBCATC,FBINS,FBPSF)=0
"RTN","FBPCR2",6,0)
SORT ;sort by date finalized, patient, vendor, treatment ien, service ien
"RTN","FBPCR2",7,0)
 S FBPVLIST="ATTENDING PROV NAME^ATTENDING PROV NPI^ATTENDING PROV TAXONOMY CODE^OPERATING PROV NAME^OPERATING PROV NPI^RENDERING PROV NAME"  ; FB*3.5*122
"RTN","FBPCR2",8,0)
 S FBPVLIST=FBPVLIST_"^RENDERING PROV NPI^RENDERING PROV TAXONOMY CODE^SERVICING PROV NAME^SERVICING PROV NPI^REFERRING PROV NAME^REFERRING PROV NPI"  ; FB*3.5*122
"RTN","FBPCR2",9,0)
 S FBLIPVL="^^LI-RENDERING-PROV-NAME^LI-RENDERING-PROV-NPI^LI-RENDERING-PROV-TAXONOMY"   ; FB*3.5*122
"RTN","FBPCR2",10,0)
 S I=FBBDATE-.1 F  S I=$O(^FBAAC("AK",I)) Q:'I!(I>FBEDATE)  S J=0 F  S J=$O(^FBAAC("AK",I,J)) Q:'J  D
"RTN","FBPCR2",11,0)
 .S DFN=J D VET^FBPCR
"RTN","FBPCR2",12,0)
 .S K=0  F  S K=$O(^FBAAC("AK",I,J,K)) Q:'K  S L=0 F  S L=$O(^FBAAC("AK",I,J,K,L)) Q:'L  D SETTR S M=0 F  S M=$O(^FBAAC("AK",I,J,K,L,M)) Q:'M  D  S (FBCATC,FBINS,FBPSF)=0
"RTN","FBPCR2",13,0)
 ..D SET Q:'FBPSV&('$D(FBPSV(FBPSF)))  I FBCATC!FBINS D SETTMP
"RTN","FBPCR2",14,0)
KILL ;kill variables set in this routine
"RTN","FBPCR2",15,0)
 K A1,A2,A3,D,D2,DFN,FBAACPTC,FBBN,FBCATC,FBCP,FBDOB,FBDOS,FBDT,FBDT1,FBIN,FBINS,FBOB,FBP,FBPAT,FBPCR,FBPDX,FBPDXC,FBPID,FBPNAME,FBPSF,FBSC,FBTA,FBTYPE,FBVEN,FBVID,FBVNAME,FBVP,I,J,K,L,M,T,Y,FBMODLE
"RTN","FBPCR2",16,0)
 K FBCSID,FBADJLA,FBADJLR,FBRRMKL,FBUNITS,TAMT,T,FBADJ,FBDAT002,FBDAT003,FBDAT004,FBDAT005,FBPVLIST,FBLIPVL,FBPVL133  ; FB*3.5*122 ; FB*3.5*133
"RTN","FBPCR2",17,0)
 Q
"RTN","FBPCR2",18,0)
SET ;set variables - also entry point from FBPCR67
"RTN","FBPCR2",19,0)
 N FBPCR,FBX
"RTN","FBPCR2",20,0)
 S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) Q:'+$P(Y,U,9)!($G(^FBAAC(J,1,K,1,L,1,M,"FBREJ"))]"")
"RTN","FBPCR2",21,0)
 S FBY=$G(^FBAAC(J,1,K,1,L,1,M,2)),FBDAT003=$G(^FBAAC(J,1,K,1,L,1,M,3))  ; FB*3.5*122
"RTN","FBPCR2",22,0)
 S FBDAT004=$G(^FBAAC(J,1,K,1,L,1,M,4)),FBDAT005=$G(^FBAAC(J,1,K,1,L,1,M,5))  ; FB*3.5*133
"RTN","FBPCR2",23,0)
 S FBVNAME=$E($P($G(^FBAAV(K,0)),U),1,23),FBVID=$S(FBVNAME]"":$P(^(0),U,2)_"/"_$S($P($G(^(3)),U,2)]"":$P(^(3),U,2),1:"**********"),1:"")
"RTN","FBPCR2",24,0)
 S FBP=+$P(Y,U,9),FBSC=$P(Y,U,27),FBPDX=+$P(Y,U,23),FBPSF=+$P(Y,U,12)
"RTN","FBPCR2",25,0)
 S ^TMP($J,"FB",FBPSF)=$G(^FBAAC(J,1,K,1,L,4))  ; FB*3.5*122
"RTN","FBPCR2",26,0)
 S FBSC=$S(FBSC="Y":"YES",FBSC="N":"NO",1:"-")
"RTN","FBPCR2",27,0)
 S T=$P(Y,U,5),D2=$P(Y,U,6),FBDOS=D2,D2=$$DATX^FBAAUTL(D2),FBCP=$P(Y,U,18),FBCP=$S(FBCP=1:"(C&P)",1:"")
"RTN","FBPCR2",28,0)
 Q:FBCP]""!('FBPSV&('$D(FBPSV(FBPSF))))  S FBPCR=+$G(^FBAAC(J,1,K,1,L,0)),FBCATC=$$CATC^FBPCR(DFN,FBPCR,+$P(Y,U,18)),FBINS=$S(FBSC["N":$$INSURED^FBPCR4(DFN,FBPCR),1:0) Q:'FBCATC&'FBINS
"RTN","FBPCR2",29,0)
 S FBAACPTC=$$CPT^FBAAUTL4($P(Y,U))
"RTN","FBPCR2",30,0)
 S FBOB=$P(Y,U,10)
"RTN","FBPCR2",31,0)
 I T]"" S T=$P($G(^FBAA(161.27,+T,0)),U)
"RTN","FBPCR2",32,0)
 S FBTYPE=$P(Y,U,20),FBVP=$P(Y,U,21),FBIN=$P(Y,U,16),FBBN=$P(Y,U,8),FBBN=$S(FBBN']"":"",$D(^FBAA(161.7,FBBN,0)):$P(^(0),U),1:""),FBBN=$S(FBBN="":"",1:$E("00000",$L(FBBN)+1,5)_FBBN)
"RTN","FBPCR2",33,0)
 S FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
"RTN","FBPCR2",34,0)
 S FBMODLE=$$MODL^FBAAUTL4("^FBAAC("_J_",1,"_K_",1,"_L_",1,"_M_",""M"")","E")
"RTN","FBPCR2",35,0)
 I T]"" S T=$P($G(^FBAA(161.27,+T,0)),U) ;suspend code
"RTN","FBPCR2",36,0)
 S TAMT=$FN($P(Y,U,4),"",2) ;suspend amount
"RTN","FBPCR2",37,0)
 S FBUNITS=$P(FBY,U,14) ;units paid
"RTN","FBPCR2",38,0)
 S FBCSID=$P(FBY,U,16) ;patient account number
"RTN","FBPCR2",39,0)
 S FBX=$$ADJLRA^FBAAFA(M_","_L_","_K_","_J_",")
"RTN","FBPCR2",40,0)
 S FBADJLR=$P(FBX,U) ;adjustment codes
"RTN","FBPCR2",41,0)
 S FBADJLA=$P(FBX,U,2) ;adjustment amounts
"RTN","FBPCR2",42,0)
 S FBRRMKL=$$RRL^FBAAFR(M_","_L_","_K_","_J_",") ;remit remarks
"RTN","FBPCR2",43,0)
 ;output format
"RTN","FBPCR2",44,0)
 S A1=$J($P(Y,U,2),6,2),A2=$J($P(Y,U,3),6,2),A3=$J(A3,6,2),FBIN=$J(FBIN,7)
"RTN","FBPCR2",45,0)
 S FBDT1=$S(FBVP="VP":"#",1:"")_$S(FBTYPE="R":"*",1:" ")_FBDT
"RTN","FBPCR2",46,0)
 Q
"RTN","FBPCR2",47,0)
SETTMP ;sort data by primary service facility, patient, fee program, vendor, date
"RTN","FBPCR2",48,0)
 Q:$$FILTER^FBPCR4()=0
"RTN","FBPCR2",49,0)
 I $P(Y,U,9)'=FBPI Q
"RTN","FBPCR2",50,0)
 S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M)=FBDT1_U_FBAACPTC_FBCP_$S($G(FBMODLE)]"":"-"_FBMODLE,1:"")_U_A1_U_A2_U_T_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB_U_FBPI_U_FBCATC_U_FBINS
"RTN","FBPCR2",51,0)
 S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M,"FBADJ")=TAMT_U_FBUNITS_U_FBADJLR_U_FBADJLA_U_FBRRMKL_U_FBCSID
"RTN","FBPCR2",52,0)
 ;I $TR($G(FBDAT002),U)'="" S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN)=FBDAT002 K FBDAT002                   ; FB*3.5*122
"RTN","FBPCR2",53,0)
 ;I $TR($G(FBDAT004),U)'="" S $P(^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN),U,20)=FBDAT004 K FBDAT004          ; FB*3.5*122
"RTN","FBPCR2",54,0)
 I $TR($G(FBDAT003),U)'="" S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M,"FBDAT003")=FBDAT003 K FBDAT003  ; FB*3.5*122
"RTN","FBPCR2",55,0)
 I $TR($G(FBDAT004),U)'="" S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M,"FBDAT004")=FBDAT004 K FBDAT004  ; FB*3.5*133
"RTN","FBPCR2",56,0)
 I $TR($G(FBDAT005),U)'="" S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M,"FBDAT005")=FBDAT005 K FBDAT005  ; FB*3.5*133
"RTN","FBPCR2",57,0)
 Q
"RTN","FBPCR2",58,0)
SETTR S D=$S($D(^FBAAC(J,1,K,1,L,0)):$P(^(0),"^",1),1:""),A3=".00"
"RTN","FBPCR2",59,0)
 I D]"",$D(^FBAAC(J,3,"AB",D)) S FBTA=$O(^FBAAC(J,3,"AB",D,0)),A3=$S($P(^FBAAC(J,3,FBTA,0),"^",3)]"":$P(^(0),"^",3),1:.0001)
"RTN","FBPCR2",60,0)
 S FBDT=$$DATX^FBAAUTL(D)
"RTN","FBPCR2",61,0)
 ;S FBDAT002=$G(^FBAAC(J,1,K,1,L,2))  ; FB*3.5*122
"RTN","FBPCR2",62,0)
 ;S FBDAT004=$G(^FBAAC(J,1,K,1,L,4))  ; FB*3.5*122
"RTN","FBPCR2",63,0)
 Q
"RTN","FBPCR2",64,0)
EN1 ;entry point to set variables, called by fbpcr67, anc
"RTN","FBPCR2",65,0)
 N FBVEN,FBPAT,FBDT1
"RTN","FBPCR2",66,0)
 D SETTR,SET
"RTN","FBPCR2",67,0)
 Q
"RTN","FBPCR2",68,0)
PRINT ;write output
"RTN","FBPCR2",69,0)
 N FB5010PV,FBLIPVL,FBPVLIST
"RTN","FBPCR2",70,0)
 S FB5010PV=""
"RTN","FBPCR2",71,0)
 S FBPVLIST="ATTENDING PROV NAME^NPI^TAXONOMY CODE^OPERATING PROV NAME^NPI^RENDERING PROV NAME^NPI^TAXONOMY CODE"
"RTN","FBPCR2",72,0)
 S FBPVLIST=FBPVLIST_"^SERVICING PROV NAME^NPI^REFERRING PROV NAME^NPI"
"RTN","FBPCR2",73,0)
 S FBPVL133="ATTENDING PROV NAME^NPI^TAXONOMY CODE^OPERATING PROV NAME^NPI^RENDERING PROV NAME"  ; FB*3.5*133
"RTN","FBPCR2",74,0)
 S FBPVL133=FBPVL133_"^NPI^TAXONOMY CODE^SERVICING PROV NAME^NPI^REFERRING PROV NAME^NPI"  ; FB*3.5*133
"RTN","FBPCR2",75,0)
 S FBLIPVL="^^RENDERING PROV NAME (LI)^NPI^TAXONOMY CODE"
"RTN","FBPCR2",76,0)
 D HDR1 S FBVI=""
"RTN","FBPCR2",77,0)
 F  S FBVI=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D:FB5010PV]"" PRNT5010(2,FB5010PV) S FB5010PV=FBVI D SH Q:FBOUT  D  Q:FBOUT
"RTN","FBPCR2",78,0)
 .S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT)) Q:'FBDT  S M=0 F  S M=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,M)) Q:'M  D  Q:FBOUT
"RTN","FBPCR2",79,0)
 ..I ($Y+4)>IOSL D PAGE Q:FBOUT
"RTN","FBPCR2",80,0)
 ..S FBDATA=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,M),FBCATC=$P(FBDATA,U,13),FBINS=$P(FBDATA,U,14)
"RTN","FBPCR2",81,0)
 ..S FBADJ=$G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,M,"FBADJ"))
"RTN","FBPCR2",82,0)
 ..;S FBLOC=1_U_12_U_23_U_33_U_47_U_57_U_63_U_71
"RTN","FBPCR2",83,0)
 ..W !
"RTN","FBPCR2",84,0)
 ..;S I=1 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
"RTN","FBPCR2",85,0)
 ..W ?1,$P(FBDATA,U,1)
"RTN","FBPCR2",86,0)
 ..;S I=2 W ?$P(FBLOC,U,I),$P($P(FBDATA,U,I),",")
"RTN","FBPCR2",87,0)
 ..W ?11,$P($P(FBDATA,U,2),",")
"RTN","FBPCR2",88,0)
 ..;F I=3:1:8 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
"RTN","FBPCR2",89,0)
 ..W ?31,$J($P(FBADJ,U,2),10)
"RTN","FBPCR2",90,0)
 ..W ?43,$P(FBDATA,U,6)
"RTN","FBPCR2",91,0)
 ..W ?54,$P(FBDATA,U,7)
"RTN","FBPCR2",92,0)
 ..W ?64,$P(FBDATA,U,8)
"RTN","FBPCR2",93,0)
 ..I $P($P(FBDATA,U,2),",",2)]"" D  Q:FBOUT
"RTN","FBPCR2",94,0)
 ...N FBI,FBMOD
"RTN","FBPCR2",95,0)
 ...F FBI=2:1 S FBMOD=$P($P(FBDATA,U,2),",",FBI) Q:FBMOD=""  D  Q:FBOUT
"RTN","FBPCR2",96,0)
 ....I $Y+7>IOSL D PAGE Q:FBOUT  W !,"  (continued)"
"RTN","FBPCR2",97,0)
 ....W !,?16,"-",FBMOD
"RTN","FBPCR2",98,0)
 ..W !,$P(FBDATA,U,3)
"RTN","FBPCR2",99,0)
 ..W ?13,$P(FBDATA,U,4)
"RTN","FBPCR2",100,0)
 ..W ?23,$S($P(FBADJ,U,3)]"":$P(FBADJ,U,3),1:$P(FBDATA,U,5))
"RTN","FBPCR2",101,0)
 ..W ?33,$J($S($P(FBADJ,U,4)]"":$J($P(FBADJ,U,4),14),1:$P(FBADJ,U,1)),14)
"RTN","FBPCR2",102,0)
 ..W ?48,$P(FBADJ,U,5)
"RTN","FBPCR2",103,0)
 ..W ?60,$P(FBADJ,U,6)
"RTN","FBPCR2",104,0)
 ..S FBPDX=$P(FBDATA,U,10),FBPDXC=$$ICD9^FBCSV1(FBPDX,$$DT2FMDT^FBCSV1($P(FBDATA,U))),$P(FBDATA,U,10)=$E($$ICD9P^FBCSV1(FBPDX,3,$$DT2FMDT^FBCSV1($P(FBDATA,U))),1,19),FBPDXC=$S(FBPDXC="":"",1:" ("_FBPDXC_")")
"RTN","FBPCR2",105,0)
 ..W !?3,"Primary Dx: ",$P(FBDATA,U,10),FBPDXC,?45,"S/C Condition? ",$P(FBDATA,U,9) W ?66,"Obl.#: ",$P(FBDATA,U,11)
"RTN","FBPCR2",106,0)
 ..I FBCATC!FBINS D
"RTN","FBPCR2",107,0)
 ...W !?5,">>>"
"RTN","FBPCR2",108,0)
 ...I FBCATC=0 W "Cost recover from insurance."
"RTN","FBPCR2",109,0)
 ...I FBCATC=1 W "Cost recover from means testing"_$S(FBINS:" and insurance.",1:".")
"RTN","FBPCR2",110,0)
 ...I FBCATC=2 W "Cost recover from LTC co-pay"_$S(FBINS:" and insurance.",1:".")
"RTN","FBPCR2",111,0)
 ...I FBCATC=3 W $S(FBINS:"Cost recover from insurance, ",1:"")_"1010EC Missing for LTC Patient."
"RTN","FBPCR2",112,0)
 ...I FBCATC=4 W $S(FBINS:"Cost Recover from insurance and ",1:"")_"Potential Cost Recover from LTC co-pay."
"RTN","FBPCR2",113,0)
 .. D PRNT5010(3,M)  ; FB*3.5*122
"RTN","FBPCR2",114,0)
 ..S A3=".00"
"RTN","FBPCR2",115,0)
 I FB5010PV]"" D PRNT5010(2,FB5010PV)  ; FB*3.5*122
"RTN","FBPCR2",116,0)
 Q
"RTN","FBPCR2",117,0)
HDR ;main header
"RTN","FBPCR2",118,0)
 D HDR^FBPCR Q:FBOUT
"RTN","FBPCR2",119,0)
HDR1 W !!?(IOM-(13+$L(FBXPROG))/2),"FEE PROGRAM: ",FBXPROG
"RTN","FBPCR2",120,0)
 ;W !!,?2,"Svc Date",?11,"CPT-MOD",?23,"Amount",?33," Amount",?42,"Susp",?49,"Travel",?57,"Batch",?63,"Invoice",?71,"Voucher"
"RTN","FBPCR2",121,0)
 ;W !,?23,"Claimed",?35,"Paid",?42,"Code",?50,"Paid",?58,"Num",?64,"Num",?72,"Date",!,FBDASH
"RTN","FBPCR2",122,0)
 W !!,?1,"Svc Date",?11,"CPT-MOD ",?19,"Travel Paid",?31,"Units Paid",?43,"Batch No.",?54,"Inv No.",?64,"Voucher Date"
"RTN","FBPCR2",123,0)
 W !,"Amt Claimed",?13,"Amt Paid",?23,"Adj Code",?36,"Adj Amounts",?48,"Remit Remark",?61,"Patient Account No",!,FBDASH
"RTN","FBPCR2",124,0)
 Q
"RTN","FBPCR2",125,0)
SH ;subheader - vendor, prints when name changed
"RTN","FBPCR2",126,0)
 I ($Y+6)>IOSL D HDR Q:FBOUT
"RTN","FBPCR2",127,0)
 ;W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID/NPI: ",$P(FBVI,";",2)
"RTN","FBPCR2",128,0)
 W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID: ",$P($P(FBVI,";",2),"/",1)
"RTN","FBPCR2",129,0)
 W !?20,"Fee Basis Billing Provider NPI: ",$P(FBVI,"/",2)
"RTN","FBPCR2",130,0)
 Q
"RTN","FBPCR2",131,0)
CR ;read for display
"RTN","FBPCR2",132,0)
 S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
"RTN","FBPCR2",133,0)
 Q
"RTN","FBPCR2",134,0)
PAGE ;new page
"RTN","FBPCR2",135,0)
 D HDR Q:FBOUT  D SH
"RTN","FBPCR2",136,0)
 Q
"RTN","FBPCR2",137,0)
PRNT5010(FBTYPE,FBNODE) ; Format and print based on data type  ; FB*3.5*122  FB*3.5*133
"RTN","FBPCR2",138,0)
 N FBVDAT,FBCNT
"RTN","FBPCR2",139,0)
 I $G(FBTYPE)=2 D  Q   ; Vender level
"RTN","FBPCR2",140,0)
 . I $G(FBPSF)]"",$G(FBPT)]"",$G(FBPI)]"",$G(FBNODE)]"",$G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBNODE))]"" S FBVDAT=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBNODE)
"RTN","FBPCR2",141,0)
 . E  Q
"RTN","FBPCR2",142,0)
 . F FBCNT=1,6 I $P(FBVDAT,U,FBCNT)]"" D
"RTN","FBPCR2",143,0)
 .. W !,$P(FBPVLIST,U,FBCNT)_": "_$P(FBVDAT,U,FBCNT),?55,$P(FBPVLIST,U,FBCNT+1)_": "_$P(FBVDAT,U,FBCNT+1)
"RTN","FBPCR2",144,0)
 .. W !,?6,$P(FBPVLIST,U,FBCNT+2)_": "_$P(FBVDAT,U,FBCNT+2)
"RTN","FBPCR2",145,0)
 . F FBCNT=4,11,9 I $P(FBVDAT,U,FBCNT)]"" D
"RTN","FBPCR2",146,0)
 .. W !,$P(FBPVLIST,U,FBCNT)_": "_$P(FBVDAT,U,FBCNT),?55,$P(FBPVLIST,U,FBCNT+1)_": "_$P(FBVDAT,U,FBCNT+1)
"RTN","FBPCR2",147,0)
 . I $P(FBVDAT,U,20)]"" D
"RTN","FBPCR2",148,0)
 .. W !,"  SERVICING FACILITY ADDRESS: "_$P(FBVDAT,U,20),!,"                              "_$P(FBVDAT,U,21)_", "
"RTN","FBPCR2",149,0)
 .. I $P(FBVDAT,U,22)]"" W $$GET1^DIQ(5,$P(FBVDAT,U,22)_",",.01)
"RTN","FBPCR2",150,0)
 .. W " "_$P(FBVDAT,U,23),!
"RTN","FBPCR2",151,0)
 ;
"RTN","FBPCR2",152,0)
 I $G(FBTYPE)=3 D  Q   ; Line Item level
"RTN","FBPCR2",153,0)
 . I $G(FBPSF)]"",$G(FBPT)]"",$G(FBPI)]"",$G(FBVI)]"",$G(FBDT)]"",$G(FBNODE)]"",$G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT003"))]"" D
"RTN","FBPCR2",154,0)
 .. S FBVDAT=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT003")
"RTN","FBPCR2",155,0)
 .. W !,?8,$P(FBLIPVL,U,3)_": "_$P(FBVDAT,U,3)
"RTN","FBPCR2",156,0)
 .. W !,?12,$P(FBLIPVL,U,4)_": "_$P(FBVDAT,U,4),?35,$P(FBLIPVL,U,5),": ",$P(FBVDAT,U,5),!!
"RTN","FBPCR2",157,0)
 . ;
"RTN","FBPCR2",158,0)
 . ; FB*3.5*133
"RTN","FBPCR2",159,0)
 . I $G(FBPSF)]"",$G(FBPT)]"",$G(FBPI)]"",$G(FBVI)]"",$G(FBDT)]"",$G(FBNODE)]"",$G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT004"))]"" D
"RTN","FBPCR2",160,0)
 .. S FBVDAT=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT004")
"RTN","FBPCR2",161,0)
 .. F FBCNT=1,6 I $P(FBVDAT,U,FBCNT)]"" D
"RTN","FBPCR2",162,0)
 ... W !,$P(FBPVL133,U,FBCNT)_": "_$P(FBVDAT,U,FBCNT),?55,$P(FBPVL133,U,FBCNT+1)_": "_$P(FBVDAT,U,FBCNT+1)
"RTN","FBPCR2",163,0)
 ... W !,?6,$P(FBPVL133,U,FBCNT+2)_": "_$P(FBVDAT,U,FBCNT+2)
"RTN","FBPCR2",164,0)
 .. F FBCNT=4,11,9 I $P(FBVDAT,U,FBCNT)]"" D
"RTN","FBPCR2",165,0)
 ... W !,$P(FBPVL133,U,FBCNT)_": "_$P(FBVDAT,U,FBCNT),?55,$P(FBPVL133,U,FBCNT+1)_": "_$P(FBVDAT,U,FBCNT+1)
"RTN","FBPCR2",166,0)
 . ;
"RTN","FBPCR2",167,0)
 . I $G(FBPSF)]"",$G(FBPT)]"",$G(FBPI)]"",$G(FBVI)]"",$G(FBDT)]"",$G(FBNODE)]"",$G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT005"))]"" D
"RTN","FBPCR2",168,0)
 .. S FBVDAT=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBNODE,"FBDAT005")
"RTN","FBPCR2",169,0)
 .. W !,"  SERVICING FACILITY ADDRESS: "_$P(FBVDAT,U,1),!,"                              "_$P(FBVDAT,U,2)_", "
"RTN","FBPCR2",170,0)
 .. I $P(FBVDAT,U,3)]"" W $$GET1^DIQ(5,$P(FBVDAT,U,3)_",",.01)
"RTN","FBPCR2",171,0)
 .. W " "_$P(FBVDAT,U,4),!
"RTN","FBPCR2",172,0)
 Q
"RTN","FBUTL8")
0^6^B25540087^B31445484
"RTN","FBUTL8",1,0)
FBUTL8 ;DSS/BPD - FEE BASIS UTILITY FOR PROVIDER INFORMATION ;5/11/2011
"RTN","FBUTL8",2,0)
 ;;3.5;FEE BASIS;**122,133**;JAN 30, 1995;Build 5
"RTN","FBUTL8",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBUTL8",4,0)
 Q
"RTN","FBUTL8",5,0)
RPROV(FBPROV,FBPROVD) ; Prompt for line item rendering providers
"RTN","FBUTL8",6,0)
 ;
"RTN","FBUTL8",7,0)
 ; Input
"RTN","FBUTL8",8,0)
 ;   FBPROV - required, array passed by reference
"RTN","FBUTL8",9,0)
 ;            will be initialized (killed)
"RTN","FBUTL8",10,0)
 ;            array of any entered line item rendering providers
"RTN","FBUTL8",11,0)
 ;            format
"RTN","FBUTL8",12,0)
 ;              FBPROV(#)=NAME^NPI^TAXONOMY
"RTN","FBUTL8",13,0)
 ;   FBPROVD-  optional, array passed by reference
"RTN","FBUTL8",14,0)
 ;             same format as FBPROV
"RTN","FBUTL8",15,0)
 ;             if passed, it will be used to supply default values
"RTN","FBUTL8",16,0)
 ;             normally only used when editing an existing payment 
"RTN","FBUTL8",17,0)
 ; Result (value of $$ADJ extrinsic function)
"RTN","FBUTL8",18,0)
 ;   FBRET  - boulean value (0 or 1)
"RTN","FBUTL8",19,0)
 ;             = 1 when valid line item rendering providers entered
"RTN","FBUTL8",20,0)
 ;             = 0 when processed ended due to time-out or entry of '^'
"RTN","FBUTL8",21,0)
 ; Output
"RTN","FBUTL8",22,0)
 ;   FBPROV  - the FBPROV input array passed by reference will be modified
"RTN","FBUTL8",23,0)
 ;            if the result = 1 then it will contain entered line item rendering providers
"RTN","FBUTL8",24,0)
 ;            if the result = 0 then it will be undefined
"RTN","FBUTL8",25,0)
 ;
"RTN","FBUTL8",26,0)
 N FBADJR,FBCAS,FBCNT,FBEDIT,FBERR,FBI,FBNEW,FBRET
"RTN","FBUTL8",27,0)
 N DIR,DIRUT,DTOUT,DUOUT,X,Y
"RTN","FBUTL8",28,0)
 S FBRET=1,FBEDIT=0
"RTN","FBUTL8",29,0)
 S FBNOOUT=$G(FBNOOUT,0)
"RTN","FBUTL8",30,0)
 K FBPROV
"RTN","FBUTL8",31,0)
 ;
"RTN","FBUTL8",32,0)
 ; if existing LI Rendering Provider exist then load them into array
"RTN","FBUTL8",33,0)
 I $D(FBPROVD) M FBPROV=FBPROVD
"RTN","FBUTL8",34,0)
 S (FBCNT,FBCAS)=0
"RTN","FBUTL8",35,0)
 I $D(FBPROV) S FBI=0 F  S FBI=$O(FBPROV(FBI)) Q:'FBI  D
"RTN","FBUTL8",36,0)
 . S FBCNT=FBCNT+1
"RTN","FBUTL8",37,0)
 ;
"RTN","FBUTL8",38,0)
ASKRPROV ; multiply prompt for rendering providers
"RTN","FBUTL8",39,0)
 ;
"RTN","FBUTL8",40,0)
 ; display current list of Rendering Providers
"RTN","FBUTL8",41,0)
 I FBCNT>0 D
"RTN","FBUTL8",42,0)
 . W !!,"Current list of Line Item Rendering Providers: "
"RTN","FBUTL8",43,0)
 . I '$O(FBPROV(0)) W "none"
"RTN","FBUTL8",44,0)
 . S FBI=0 F  S FBI=$O(FBPROV(FBI)) Q:'FBI  D
"RTN","FBUTL8",45,0)
 . . W !?3,"Line Item: "_FBI
"RTN","FBUTL8",46,0)
 . . W ?25,"Rendering Provider Name: "_$P(FBPROV(FBI),U)
"RTN","FBUTL8",47,0)
 . . W !?3,"Rendering Provider NPI: "_$P(FBPROV(FBI),U,2)
"RTN","FBUTL8",48,0)
 . . W ?45,"Taxonomy Code: "_$P(FBPROV(FBI),U,3)
"RTN","FBUTL8",49,0)
 ;
"RTN","FBUTL8",50,0)
 ; prompt for Line Item Rendering Provider
"RTN","FBUTL8",51,0)
 N FBI,FBPROVR
"RTN","FBUTL8",52,0)
 S DIR(0)="162.579,.01",DIR("A")="Enter LINE ITEM NUMBER"
"RTN","FBUTL8",53,0)
 S DIR("?",1)="Please enter the Rendering Provider information for a specific line item."
"RTN","FBUTL8",54,0)
 S DIR("?",2)="This information is only required if the line item transaction has a different Rendering Provider than the claim."
"RTN","FBUTL8",55,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT))!(Y="") G EXIT
"RTN","FBUTL8",56,0)
 S FBI=+Y I Y'=0,$G(FBPROV(+Y))'="" S FBEDIT=1
"RTN","FBUTL8",57,0)
 I 'FBEDIT S FBPROV(FBI)=""
"RTN","FBUTL8",58,0)
 S DIR(0)="162.579,.02" I FBEDIT=1,$D(FBPROV(FBI)) S DIR("B")=$P(FBPROV(FBI),U)
"RTN","FBUTL8",59,0)
 S DIR("A")="LINE ITEM RENDERING PROV NAME",DIR("?",1)="Enter the Rendering Provider's Name for the specified line item,"
"RTN","FBUTL8",60,0)
 S DIR("?",2)="if different than the claim level Rendering Provider" D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","FBUTL8",61,0)
 I X="@" D DEL(FBI)
"RTN","FBUTL8",62,0)
 S $P(FBPROV(FBI),U)=Y
"RTN","FBUTL8",63,0)
 S DIR(0)="162.579,.03" I FBEDIT=1,$D(FBPROV(FBI)) S DIR("B")=$P(FBPROV(FBI),U,2)
"RTN","FBUTL8",64,0)
 S DIR("A")="LINE ITEM RENDERING PROV NPI",DIR("?",1)="Enter the Rendering Provider's NPI for the specified line item."
"RTN","FBUTL8",65,0)
 S DIR("?",2)="if different than the claim level Rendering Provider" D ^DIR K DIR I $D(DTOUT)!($D(DIOUT)) G EXIT
"RTN","FBUTL8",66,0)
 S $P(FBPROV(FBI),U,2)=Y
"RTN","FBUTL8",67,0)
 S DIR(0)="162.579,.04",DIR("A")="LINE ITEM RENDERING PROV TAXONOMY CODE" I FBEDIT=1,$D(FBPROV(FBI)) S DIR("B")=$P(FBPROV(FBI),U,3)
"RTN","FBUTL8",68,0)
 S DIR("?",1)="Enter the Rendering Provider's Name for the specified line item,"
"RTN","FBUTL8",69,0)
 S DIR("?",2)="if different than the claim level Rendering Provider" D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","FBUTL8",70,0)
 S $P(FBPROV(FBI),U,3)=Y
"RTN","FBUTL8",71,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="ENTER ANOTHER LINE ITEM RENDERING PROVIDER"
"RTN","FBUTL8",72,0)
 S DIR("?")="Do you need to enter another Line Item level Rendering Provider?",DIR("?",1)="Answering yes will prompt you for more information or allow"
"RTN","FBUTL8",73,0)
 S DIR("?",2)="you to modify an entered record." D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","FBUTL8",74,0)
 I FBPROV(FBI)="" K FBPROV(FBI)
"RTN","FBUTL8",75,0)
 G:Y ASKRPROV G:'Y EXIT
"RTN","FBUTL8",76,0)
 ;
"RTN","FBUTL8",77,0)
EXIT Q FBRET
"RTN","FBUTL8",78,0)
 ;
"RTN","FBUTL8",79,0)
DEL(FBI) ; delete Rendering Provider from list
"RTN","FBUTL8",80,0)
 K FBPROV(FBI)
"RTN","FBUTL8",81,0)
 W "   (provider deleted)"
"RTN","FBUTL8",82,0)
 Q
"RTN","FBUTL8",83,0)
 ;
"RTN","FBUTL8",84,0)
 ;FBUTL2
"RTN","FBUTL8",85,0)
FILERP(FBIENS,FBPROV) ; Routine to file Rendering Provider information to 162.5
"RTN","FBUTL8",86,0)
 ; 
"RTN","FBUTL8",87,0)
 ; Input
"RTN","FBUTL8",88,0)
 ;       IENS - Required - DA_"," for the record to save the Rendering Provider information to
"RTN","FBUTL8",89,0)
 ;       FBPROV - Required - Passed by reference array that contains the information to save
"RTN","FBUTL8",90,0)
 ;
"RTN","FBUTL8",91,0)
  ; Output
"RTN","FBUTL8",92,0)
 ;   Data in File 162.5 will be modified
"RTN","FBUTL8",93,0)
 ;
"RTN","FBUTL8",94,0)
 N FB,FBFDA,FBI
"RTN","FBUTL8",95,0)
 ;
"RTN","FBUTL8",96,0)
 ; delete line item rendering providers currently on file
"RTN","FBUTL8",97,0)
 D GETS^DIQ(162.5,FBIENS,"79*","","FB")
"RTN","FBUTL8",98,0)
 K FBFDA
"RTN","FBUTL8",99,0)
 S FBSIENS="" F  S FBSIENS=$O(FB(162.579,FBSIENS)) Q:FBSIENS=""  D
"RTN","FBUTL8",100,0)
 .S FBFDA(162.579,FBSIENS,.01)="@"
"RTN","FBUTL8",101,0)
 I $D(FBFDA) D FILE^DIE("","FBFDA")
"RTN","FBUTL8",102,0)
 ;
"RTN","FBUTL8",103,0)
 ; file line item rendering providers from input array
"RTN","FBUTL8",104,0)
 K FBFDA
"RTN","FBUTL8",105,0)
 S FBI=0 F  S FBI=$O(FBPROV(FBI)) Q:'FBI  D
"RTN","FBUTL8",106,0)
 .S FBFDA(162.579,"+"_FBI_","_FBIENS,.01)=FBI
"RTN","FBUTL8",107,0)
 .S FBFDA(162.579,"+"_FBI_","_FBIENS,.02)=$P(FBPROV(FBI),U)
"RTN","FBUTL8",108,0)
 .S FBFDA(162.579,"+"_FBI_","_FBIENS,.03)=$P(FBPROV(FBI),U,2)
"RTN","FBUTL8",109,0)
 .S FBFDA(162.579,"+"_FBI_","_FBIENS,.04)=$P(FBPROV(FBI),U,3)
"RTN","FBUTL8",110,0)
 I $D(FBFDA) D UPDATE^DIE("","FBFDA")
"RTN","FBUTL8",111,0)
 ;
"RTN","FBUTL8",112,0)
 Q
"RTN","FBUTL8",113,0)
LOADRP(FBIENS,FBPROV) ; Load Line Item Rendering Providers
"RTN","FBUTL8",114,0)
 ; Input
"RTN","FBUTL8",115,0)
 ;   FBIENS -  required, internal entry numbers for subfile 162.5
"RTN","FBUTL8",116,0)
 ;             in standard format as specified for FileMan DBS calls
"RTN","FBUTL8",117,0)
 ;   FBPROV - required, array passed by reference
"RTN","FBUTL8",118,0)
 ;             array to load line item rendering providers into
"RTN","FBUTL8",119,0)
 ; Output
"RTN","FBUTL8",120,0)
 ;   FBPROV - the FBPROV input array passed by reference will be modified
"RTN","FBUTL8",121,0)
 ;             format
"RTN","FBUTL8",122,0)
 ;               FBPROV(#)=IEN^NAME^NPI^TAXONOMY
"RTN","FBUTL8",123,0)
 ;             if no line item rendering providers are on file then the array will be undefined
"RTN","FBUTL8",124,0)
 N FB,FBC,FBSIENS
"RTN","FBUTL8",125,0)
 ;
"RTN","FBUTL8",126,0)
 K FBPROV
"RTN","FBUTL8",127,0)
 ;
"RTN","FBUTL8",128,0)
 S FBC=0
"RTN","FBUTL8",129,0)
 D GETS^DIQ(162.5,FBIENS,"79*","I","FB")
"RTN","FBUTL8",130,0)
 S FBSIENS="" F  S FBSIENS=$O(FB(162.579,FBSIENS)) Q:FBSIENS=""  D
"RTN","FBUTL8",131,0)
 . S FBC=FB(162.579,FBSIENS,.01,"I")
"RTN","FBUTL8",132,0)
 . S FBPROV(FBC)=FB(162.579,FBSIENS,.02,"I")
"RTN","FBUTL8",133,0)
 . S $P(FBPROV(FBC),U,2)=FB(162.579,FBSIENS,.03,"I")
"RTN","FBUTL8",134,0)
 . S $P(FBPROV(FBC),U,3)=FB(162.579,FBSIENS,.04,"I")
"RTN","FBUTL8",135,0)
 ;
"RTN","FBUTL8",136,0)
 Q
"RTN","FBXIP133")
0^^B10333437^n/a
"RTN","FBXIP133",1,0)
FBXIP133 ;DSS/BPD - PATCH INSTALL ROUTINE;OCT 13, 2011
"RTN","FBXIP133",2,0)
 ;;3.5;FEE BASIS;**133**;APR 04, 2011;Build 5
"RTN","FBXIP133",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","FBXIP133",4,0)
 ;DBIA# Supported Reference
"RTN","FBXIP133",5,0)
 ;----- --------------------------------
"RTN","FBXIP133",6,0)
 ;10141 $$VERSION^XPDUTL
"RTN","FBXIP133",7,0)
 ;10141 MES^XPDUTL
"RTN","FBXIP133",8,0)
 ;
"RTN","FBXIP133",9,0)
 Q
"RTN","FBXIP133",10,0)
PRE ;PATCH 133 PRE-INSTALL ROUTINE
"RTN","FBXIP133",11,0)
 ; DELETE THE FOLLOWING FIELDS FROM THE 162 FILE SO THEY CAN BE MOVED TO A DIFFERENT SUB-FILE
"RTN","FBXIP133",12,0)
 ; VIA INSTALLATION OF THE FILE IN THE KID BUILD
"RTN","FBXIP133",13,0)
 ;DELETE FIELD #58 - ATTENDING PROV NAME, DELETE FIELD #59 - ATTENDING PROV NPI
"RTN","FBXIP133",14,0)
 ;DELETE FIELD #60 - ATTENDING PROV TAXONOMY CODE, DELETE FIELD #61 - OPERATING PROV NAME
"RTN","FBXIP133",15,0)
 ;DELETE FIELD #62 - OPERATING PROV NPI, DELETE FIELD #63 - RENDERING PROV NAME
"RTN","FBXIP133",16,0)
 ;DELETE FIELD #64 - RENDERING PROV NPI, DELETE FIELD #65 - RENDERING PROV TAXONOMY CODE
"RTN","FBXIP133",17,0)
 ;DELETE FIELD #66 - SERVICING PROV NAME, DELETE FIELD #67 - SERVICING PROV NPI
"RTN","FBXIP133",18,0)
 ;DELETE FIELD #68 - REFERRING PROV NAME, DELETE FIELD #69 - REFERRING PROV NPI
"RTN","FBXIP133",19,0)
 ;DELETE FIELD #76 - SERVICING FACILITY ADDRESS, DELETE FIELD #77 - SERVICING FACILITY CITY
"RTN","FBXIP133",20,0)
 ;DELETE FIELD #78 - SERVICING FACILITY STATE, DELETE FIELD #79 - SERVICING FACILITY ZIP
"RTN","FBXIP133",21,0)
 N FLD
"RTN","FBXIP133",22,0)
 F FLD=58,59,60,61,62,63,64,65,66,67,68,69,76,77,78,79 D
"RTN","FBXIP133",23,0)
 .I $$VFILE^DSICFM06(,162.02,1)>0,$$VFIELD^DSICFM06(,162.02,FLD,1)>0 D
"RTN","FBXIP133",24,0)
 ..N DA,DD,DO,DIK S DA(1)=162.02,DA=FLD,DIK="^DD(162.02," D ^DIK
"RTN","FBXIP133",25,0)
 ..Q
"RTN","FBXIP133",26,0)
 S ^TMP("FBXIP133",$J)=$$PATCH^XPDUTL("FB*3.5*133")
"RTN","FBXIP133",27,0)
 Q
"RTN","FBXIP133",28,0)
DATADEL ;
"RTN","FBXIP133",29,0)
 N FBPAT,FBVEN,FBDAT,CNT S FBPAT=0,FBVEN=0,FBDAT=0,CNT=1,FBRET=$NA(^TMP("FBXIP133",$J))
"RTN","FBXIP133",30,0)
 F  S FBPAT=$O(^FBAAC(FBPAT)) Q:'FBPAT  D
"RTN","FBXIP133",31,0)
 .S FBVEN=0 F  S FBVEN=$O(^FBAAC(FBPAT,1,FBVEN)) Q:'FBVEN  D
"RTN","FBXIP133",32,0)
 ..S FBDAT=0 F  S FBDAT=$O(^FBAAC(FBPAT,1,FBVEN,1,FBDAT)) Q:'FBDAT  D
"RTN","FBXIP133",33,0)
 ...I $D(^FBAAC(FBPAT,1,FBVEN,1,FBDAT,2)) K ^FBAAC(FBPAT,1,FBVEN,1,FBDAT,2) S @FBRET@(CNT)="KILLED ^FBAAC("_FBPAT_",1,"_FBVEN_",1,"_FBDAT_",2)",CNT=CNT+1
"RTN","FBXIP133",34,0)
 ...I $D(^FBAAC(FBPAT,1,FBVEN,1,FBDAT,4)) K ^FBAAC(FBPAT,1,FBVEN,1,FBDAT,4) S @FBRET@(CNT)="KILLED ^FBAAC("_FBPAT_",1,"_FBVEN_",1,"_FBDAT_",4)",CNT=CNT+1
"RTN","FBXIP133",35,0)
 Q
"RTN","FBXIP133",36,0)
POST ;
"RTN","FBXIP133",37,0)
 ;
"RTN","FBXIP133",38,0)
 ;Queue off visit date fix
"RTN","FBXIP133",39,0)
 N M S M(1)=" This part of the post-install will be queued, but may "
"RTN","FBXIP133",40,0)
 S M(2)=" take some time to run. It loops through the FEE BASIS PAYMENT "
"RTN","FBXIP133",41,0)
 S M(3)=" file and removes any data that existed in the fields being moved "
"RTN","FBXIP133",42,0)
 S M(4)=" to a different location within FEE BASIS PAYMENT."
"RTN","FBXIP133",43,0)
 S M(5)=" The fields being deleted and re-added in a new location are: "
"RTN","FBXIP133",44,0)
 S M(6)=" Fields: 59,60,61,62,63,64,65,66,67,68,69,76,77,78,79"
"RTN","FBXIP133",45,0)
 D MES^DSICXPDU(.M,1)
"RTN","FBXIP133",46,0)
 I ^TMP("FBXIP133",$J)=0 D TASK ; Task off repairing Visit dates
"RTN","FBXIP133",47,0)
 ;
"RTN","FBXIP133",48,0)
 K ^TMP("FBXIP133",$J)
"RTN","FBXIP133",49,0)
 Q
"RTN","FBXIP133",50,0)
TASK ; Create a queued task to perform visit date fix caused
"RTN","FBXIP133",51,0)
 ; in P57 when undeleting transactions
"RTN","FBXIP133",52,0)
 N X,Y,Z,ZTSK,ZTIO,ZTRTN,ZTDTH,ZTSAVE,ZTDESC
"RTN","FBXIP133",53,0)
 I '$D(XPDNM) D  Q:'X
"RTN","FBXIP133",54,0)
 .I $G(DUZ)<.5 W !!,"Please sign on properly through the Kernel" S X=0
"RTN","FBXIP133",55,0)
 .E  D HOME^%ZIS,DT^DICRW S X=1
"RTN","FBXIP133",56,0)
 .Q
"RTN","FBXIP133",57,0)
 S ZTIO="",ZTDTH=$H,ZTRTN="DATADEL^FBXIP133",ZTDESC="FB PATCH 133 POST-INSTALL"
"RTN","FBXIP133",58,0)
 D ^%ZTLOAD S X="Patch 133 post-install successfully queued, task# "_$G(ZTSK)
"RTN","FBXIP133",59,0)
 I $G(ZTSK) D MSG(X)
"RTN","FBXIP133",60,0)
 I '$G(ZTSK) D MSG("Could not queue the Post-Install!"),MSG("Enter a Remedy ticket.")
"RTN","FBXIP133",61,0)
 Q
"RTN","FBXIP133",62,0)
MSG(X) ;
"RTN","FBXIP133",63,0)
 S X="   >> "_X_" <<"
"RTN","FBXIP133",64,0)
 D MES^DSICXPDU(X,1)
"RTN","FBXIP133",65,0)
 Q
"UP",162,162.03,-3)
162^1
"UP",162,162.03,-2)
162.01^1
"UP",162,162.03,-1)
162.02^1
"UP",162,162.03,0)
162.03
"VER")
8.0^22.0
"^DD",162,162.03,58,0)
ATTENDING PROV NAME^F^^4;1^K:$L(X)>30!($L(X)<1) X
"^DD",162,162.03,58,3)
Answer must be 1-30 characters in length.
"^DD",162,162.03,58,21,0)
^.001^1^1^3111017^^
"^DD",162,162.03,58,21,1,0)
Enter the Attending Provider's name found in the claim information.
"^DD",162,162.03,58,"DT")
3111013
"^DD",162,162.03,59,0)
ATTENDING PROV NPI^F^^4;2^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,59,3)
Answer must be 10 characters in length.
"^DD",162,162.03,59,21,0)
^^3^3^3111017^
"^DD",162,162.03,59,21,1,0)
Enter the Attending Provider's National Provider Identifier (NPI) found 
"^DD",162,162.03,59,21,2,0)
in the claim information. This value must be 10 characters, including any 
"^DD",162,162.03,59,21,3,0)
leading zeros.
"^DD",162,162.03,59,"DT")
3111013
"^DD",162,162.03,60,0)
ATTENDING PROV TAXONOMY CODE^F^^4;3^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,60,3)
Answer must be 10 characters in length.
"^DD",162,162.03,60,21,0)
^^3^3^3111013^
"^DD",162,162.03,60,21,1,0)
Enter the Attending Provider's Taxonomy code found in the claim 
"^DD",162,162.03,60,21,2,0)
information. This value must be 10 characters, including any leading 
"^DD",162,162.03,60,21,3,0)
zeros.
"^DD",162,162.03,60,"DT")
3111013
"^DD",162,162.03,61,0)
OPERATING PROV NAME^F^^4;4^K:$L(X)>30!($L(X)<1) X
"^DD",162,162.03,61,3)
Answer must be 1-30 characters in length.
"^DD",162,162.03,61,21,0)
^^1^1^3111013^
"^DD",162,162.03,61,21,1,0)
Enter the Operating Provider's name found in the claim information.
"^DD",162,162.03,61,"DT")
3111013
"^DD",162,162.03,62,0)
OPERATING PROV NPI^F^^4;5^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,62,3)
Answer must be 10 characters in length.
"^DD",162,162.03,62,21,0)
^^3^3^3111013^
"^DD",162,162.03,62,21,1,0)
Enter the Operating Provider's National Provider Identifier (NPI) found 
"^DD",162,162.03,62,21,2,0)
in the claim information. This value must be 10 characters, including any 
"^DD",162,162.03,62,21,3,0)
leading zeros.
"^DD",162,162.03,62,"DT")
3111013
"^DD",162,162.03,63,0)
RENDERING PROV NAME^F^^4;6^K:$L(X)>30!($L(X)<1) X
"^DD",162,162.03,63,3)
Answer must be 1-30 characters in length.
"^DD",162,162.03,63,21,0)
^.001^1^1^3111013^^
"^DD",162,162.03,63,21,1,0)
Enter the Rendering Provider's name found in the claim information.
"^DD",162,162.03,63,"DT")
3111013
"^DD",162,162.03,64,0)
RENDERING PROV NPI^F^^4;7^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,64,3)
Answer must be 10 characters in length.
"^DD",162,162.03,64,21,0)
^^3^3^3111013^
"^DD",162,162.03,64,21,1,0)
Enter the Rendering Provider's National Provider Identifier (NPI) found 
"^DD",162,162.03,64,21,2,0)
in the claim information. This value must be 10 characters, including any 
"^DD",162,162.03,64,21,3,0)
leading zeros.
"^DD",162,162.03,64,"DT")
3111013
"^DD",162,162.03,65,0)
RENDERING PROV TAXONOMY CODE^F^^4;8^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,65,3)
Answer must be 10 characters in length.
"^DD",162,162.03,65,21,0)
^^3^3^3111013^
"^DD",162,162.03,65,21,1,0)
Enter the Rendering Provider's Taxonomy code found in the claim 
"^DD",162,162.03,65,21,2,0)
information. This value must be 10 characters, including any leading 
"^DD",162,162.03,65,21,3,0)
zeros.
"^DD",162,162.03,65,"DT")
3111013
"^DD",162,162.03,66,0)
SERVICING PROV NAME^F^^4;9^K:$L(X)>30!($L(X)<1) X
"^DD",162,162.03,66,3)
Answer must be 1-30 characters in length.
"^DD",162,162.03,66,21,0)
^^1^1^3111013^
"^DD",162,162.03,66,21,1,0)
Enter the Servicing Provider's name found in the claim information.
"^DD",162,162.03,66,"DT")
3111013
"^DD",162,162.03,67,0)
SERVICING PROV NPI^F^^4;10^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,67,3)
Answer must be 10 characters in length.
"^DD",162,162.03,67,21,0)
^^3^3^3111013^
"^DD",162,162.03,67,21,1,0)
Enter the Servicing Provider's National Provider Identifier (NPI) found 
"^DD",162,162.03,67,21,2,0)
in the claim information. This value must be 10 characters, including any 
"^DD",162,162.03,67,21,3,0)
leading zeros.
"^DD",162,162.03,67,"DT")
3111013
"^DD",162,162.03,68,0)
REFERRING PROV NAME^F^^4;11^K:$L(X)>30!($L(X)<1) X
"^DD",162,162.03,68,3)
Answer must be 1-30 characters in length.
"^DD",162,162.03,68,21,0)
^^1^1^3111013^
"^DD",162,162.03,68,21,1,0)
Enter the Referring Provider's name found in the claim information.
"^DD",162,162.03,68,"DT")
3111013
"^DD",162,162.03,69,0)
REFERRING PROV NPI^F^^4;12^K:$L(X)>10!($L(X)<10) X
"^DD",162,162.03,69,3)
Answer must be 10 characters in length.
"^DD",162,162.03,69,21,0)
^^3^3^3111013^
"^DD",162,162.03,69,21,1,0)
Enter the Referring Provider's National Provider Identifier (NPI) found 
"^DD",162,162.03,69,21,2,0)
in the claim information. This value must be 10 characters, including ay 
"^DD",162,162.03,69,21,3,0)
leading zeros.
"^DD",162,162.03,69,"DT")
3111013
"^DD",162,162.03,76,0)
SERVICING FACILITY ADDRESS^F^^5;1^K:$L(X)>60!($L(X)<1) X
"^DD",162,162.03,76,3)
Answer must be 1-60 characters in length.
"^DD",162,162.03,76,21,0)
^^2^2^3111013^
"^DD",162,162.03,76,21,1,0)
Enter the Servicing Facility street address found in the claim 
"^DD",162,162.03,76,21,2,0)
information.
"^DD",162,162.03,76,"DT")
3111013
"^DD",162,162.03,77,0)
SERVICING FACILITY CITY^F^^5;2^K:$L(X)>20!($L(X)<1) X
"^DD",162,162.03,77,3)
Answer must be 1-20 characters in length.
"^DD",162,162.03,77,21,0)
^^1^1^3111013^
"^DD",162,162.03,77,21,1,0)
Enter the Servicing Facility city found in the claim information.
"^DD",162,162.03,77,"DT")
3111013
"^DD",162,162.03,78,0)
SERVICING FACILITY STATE^P5'^DIC(5,^5;3^Q
"^DD",162,162.03,78,21,0)
^^1^1^3111013^
"^DD",162,162.03,78,21,1,0)
Enter the Servicing Facility state found in the claim information.
"^DD",162,162.03,78,"DT")
3111013
"^DD",162,162.03,79,0)
SERVICING FACILITY ZIP^FXO^^5;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<5) X I $D(X) D ZIPIN^VAFADDR
"^DD",162,162.03,79,2)
S Y(0)=Y D ZIPOUT^VAFADDR
"^DD",162,162.03,79,2.1)
D ZIPOUT^VAFADDR
"^DD",162,162.03,79,3)
Answer with either 5 digit or 9 digit zip code.
"^DD",162,162.03,79,21,0)
^^2^2^3111013^
"^DD",162,162.03,79,21,1,0)
Enter the Servicing Facility zip code, in either the 5 digit format (e.g. 
"^DD",162,162.03,79,21,2,0)
12345) or 9 digit format (e.g. 12345.6789 or 123456789).
"^DD",162,162.03,79,"DT")
3111013
"BLD",8573,6)
^111
**END**
**END**
