Released DG*5.3*866 SEQ #761
Extracted from mail message
**KIDS**:DG*5.3*866^

**INSTALL NAME**
DG*5.3*866
"BLD",9209,0)
DG*5.3*866^REGISTRATION^0^3130128^y
"BLD",9209,1,0)
^^5^5^3130128^
"BLD",9209,1,1,0)
Patch DG*5.3*866 addresses the following issue:
"BLD",9209,1,2,0)
 
"BLD",9209,1,3,0)
        1.  Pseudo Social Security Number Calculator allows duplicates.
"BLD",9209,1,4,0)
            This is creating an issue for the New Born Project with
"BLD",9209,1,5,0)
            with multiple births and bill processing.
"BLD",9209,4,0)
^9.64PA^^
"BLD",9209,6.3)
9
"BLD",9209,"KRN",0)
^9.67PA^779.2^20
"BLD",9209,"KRN",.4,0)
.4
"BLD",9209,"KRN",.401,0)
.401
"BLD",9209,"KRN",.402,0)
.402
"BLD",9209,"KRN",.403,0)
.403
"BLD",9209,"KRN",.5,0)
.5
"BLD",9209,"KRN",.84,0)
.84
"BLD",9209,"KRN",3.6,0)
3.6
"BLD",9209,"KRN",3.8,0)
3.8
"BLD",9209,"KRN",9.2,0)
9.2
"BLD",9209,"KRN",9.8,0)
9.8
"BLD",9209,"KRN",9.8,"NM",0)
^9.68A^2^1
"BLD",9209,"KRN",9.8,"NM",2,0)
DGRPDD1^^0^B32361034
"BLD",9209,"KRN",9.8,"NM","B","DGRPDD1",2)

"BLD",9209,"KRN",19,0)
19
"BLD",9209,"KRN",19.1,0)
19.1
"BLD",9209,"KRN",101,0)
101
"BLD",9209,"KRN",409.61,0)
409.61
"BLD",9209,"KRN",771,0)
771
"BLD",9209,"KRN",779.2,0)
779.2
"BLD",9209,"KRN",870,0)
870
"BLD",9209,"KRN",8989.51,0)
8989.51
"BLD",9209,"KRN",8989.52,0)
8989.52
"BLD",9209,"KRN",8994,0)
8994
"BLD",9209,"KRN","B",.4,.4)

"BLD",9209,"KRN","B",.401,.401)

"BLD",9209,"KRN","B",.402,.402)

"BLD",9209,"KRN","B",.403,.403)

"BLD",9209,"KRN","B",.5,.5)

"BLD",9209,"KRN","B",.84,.84)

"BLD",9209,"KRN","B",3.6,3.6)

"BLD",9209,"KRN","B",3.8,3.8)

"BLD",9209,"KRN","B",9.2,9.2)

"BLD",9209,"KRN","B",9.8,9.8)

"BLD",9209,"KRN","B",19,19)

"BLD",9209,"KRN","B",19.1,19.1)

"BLD",9209,"KRN","B",101,101)

"BLD",9209,"KRN","B",409.61,409.61)

"BLD",9209,"KRN","B",771,771)

"BLD",9209,"KRN","B",779.2,779.2)

"BLD",9209,"KRN","B",870,870)

"BLD",9209,"KRN","B",8989.51,8989.51)

"BLD",9209,"KRN","B",8989.52,8989.52)

"BLD",9209,"KRN","B",8994,8994)

"BLD",9209,"QDEF")
^^^^NO^^^^^^YES
"BLD",9209,"QUES",0)
^9.62^^
"BLD",9209,"REQB",0)
^9.611^2^1
"BLD",9209,"REQB",2,0)
DG*5.3*797^2
"BLD",9209,"REQB","B","DG*5.3*797",2)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
866^3130128
"PKG",5,22,1,"PAH",1,1,0)
^^5^5^3130128
"PKG",5,22,1,"PAH",1,1,1,0)
Patch DG*5.3*866 addresses the following issue:
"PKG",5,22,1,"PAH",1,1,2,0)
 
"PKG",5,22,1,"PAH",1,1,3,0)
        1.  Pseudo Social Security Number Calculator allows duplicates.
"PKG",5,22,1,"PAH",1,1,4,0)
            This is creating an issue for the New Born Project with
"PKG",5,22,1,"PAH",1,1,5,0)
            with multiple births and bill processing.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGRPDD1")
0^2^B32361034^B31264129
"RTN","DGRPDD1",1,0)
DGRPDD1 ;ALB/JDS,LBD - INPUT SYNTAX CHECKS - FORMERLY DGINP ; 1/28/13 9:50am
"RTN","DGRPDD1",2,0)
 ;;5.3;Registration;**72,136,244,621,797,866**;AUG 13, 1993;Build 9
"RTN","DGRPDD1",3,0)
 ;
"RTN","DGRPDD1",4,0)
 ;  NOTE: THIS USED TO BE NAMED 'DGINP'
"RTN","DGRPDD1",5,0)
 ;                               -----
"RTN","DGRPDD1",6,0)
 ;
"RTN","DGRPDD1",7,0)
INPUT ; from 7.5 node to massage input before input transform
"RTN","DGRPDD1",8,0)
 I X?.N1"/"1N.ANP D BCDFN^RTDPA Q  ; check for RT label scan
"RTN","DGRPDD1",9,0)
 Q
"RTN","DGRPDD1",10,0)
 ;
"RTN","DGRPDD1",11,0)
SSN I X'?.AN F %=1:1:$L(X) I $E(X,%)?1P S X=$E(X,0,%-1)_$E(X,%+1,999),%=%-1
"RTN","DGRPDD1",12,0)
 I X="P"!(X="p") D PSEU S X=L K L W:'$D(ZTQUEUED) "  ",X G SSNQ
"RTN","DGRPDD1",13,0)
 I X["P",'$D(DPTZNV) D PSEU I X'=L K X,L W:'$D(ZTQUEUED) *7,"  Invalid pseudo SSN.",!,"Type 'P' for the valid one" Q
"RTN","DGRPDD1",14,0)
 I X["P",$D(DPTZNV) D PSEU I X'=L S X=L W:'$D(ZTQUEUED) !!,$C(7),"Pseudo SSN adjusted to match edited name value ==> ",X,!
"RTN","DGRPDD1",15,0)
 G SSNQ:X["P" I X'?9N K X Q
"RTN","DGRPDD1",16,0)
 I $G(DIUTIL)'="VERIFY FIELDS" S DGY=$O(^DPT("SSN",X,0)) I DGY>0,$D(^DPT(DGY,0)) W:'$D(ZTQUEUED) *7,"  Already used by patient '",$P(^(0),"^",1),"'." K X Q
"RTN","DGRPDD1",17,0)
 I $D(X) S L=$E(X,1) I L=9 W:'$D(ZTQUEUED) *7,!,"  The SSN must not begin with 9." K X Q
"RTN","DGRPDD1",18,0)
 I $D(X),$E(X,1,3)="000",$E(X,1,5)'="00000" W:'$D(ZTQUEUED) *7,!,"   First three digits cannot be zeros." K X Q
"RTN","DGRPDD1",19,0)
 I $D(X) S L=$E(X,1,3) I (L>699)&(L<729) W:'$D(ZTQUEUED) !,*7,!,"      Note: This is a RR Retirement SSN."
"RTN","DGRPDD1",20,0)
 I $D(X),$E(X,1,5)="00000" W:'$D(ZTQUEUED) !,*7,!,"      Note: This is a Test Patient SSN."
"RTN","DGRPDD1",21,0)
SSNQ D:$D(X) S^DGPATN Q
"RTN","DGRPDD1",22,0)
C I $D(X) S L=$P(^DPT(DA,0),U,9) I $L(L)=9,X'=L S Y=L_"00" D COL
"RTN","DGRPDD1",23,0)
 K L Q:'$D(X)  Q:X'?11N!(X["P")  S L=0 F Y=0:0 S Y=$O(^DPT("BS",$E(X,6,9),Y)) Q:Y'>0  I Y-DA,$D(^DPT(Y,0)),$P(^(0),U,9)=$E(X,1,9) S L=1 Q
"RTN","DGRPDD1",24,0)
 I L W:'$D(ZTQUEUED) " Collateral of ",$P(^DPT(Y,0),U,1) K L Q
"RTN","DGRPDD1",25,0)
 W:'$D(ZTQUEUED) !,"Must have same SSN to be collateral" K X,L Q
"RTN","DGRPDD1",26,0)
PSEU I $D(DPTIDS(.03)),$D(DPTX) S NAM=DPTX,DOB=DPTIDS(.03)
"RTN","DGRPDD1",27,0)
 E  S L=^DPT(DA,0),DOB=$P(L,"^",3),NAM=$P(L,"^",1)
"RTN","DGRPDD1",28,0)
 ; DG*5.3*621
"RTN","DGRPDD1",29,0)
 I DOB="" S DOB=2000000
"RTN","DGRPDD1",30,0)
 S L1=$E($P(NAM," ",2),1),L3=$E(NAM,1),NAM=$P(NAM,",",2),L2=$E(NAM,1)
"RTN","DGRPDD1",31,0)
 S Z=L1 D CON S L1=Z,Z=L2 D CON S L2=Z,Z=L3 D CON S L3=Z S L=L2_L1_L3_$E(DOB,4,7)_$E(DOB,2,3)_"P"
"RTN","DGRPDD1",32,0)
 I $D(^DPT("SSN",L)) S L=$$CHECK(L)
"RTN","DGRPDD1",33,0)
 K L1,L2,L3,Z,DOB,NAM Q
"RTN","DGRPDD1",34,0)
CHECK(PSSN) ;patch DG*5.3*866 no duplicate pseudo ssn's
"RTN","DGRPDD1",35,0)
 F  Q:'$D(^DPT("SSN",PSSN))  S PSSN=(PSSN+1)_"P"
"RTN","DGRPDD1",36,0)
 Q PSSN
"RTN","DGRPDD1",37,0)
COL S Y=$O(^DPT("SSN",Y)) Q:$E(Y,1,9)'=L  I $L(Y)=11,$E(Y,1,9)=L S Z=$O(^(Y,0)) I $D(^DPT(Z,0)) W:'$D(ZTQUEUED) !,"Has collateral ",$P(^(0),U,1)," be sure to change SSN" K Z G COL
"RTN","DGRPDD1",38,0)
 Q
"RTN","DGRPDD1",39,0)
CON S Z=$A(Z)-65\3+1 S:Z<0 Z=0 Q
"RTN","DGRPDD1",40,0)
 ;
"RTN","DGRPDD1",41,0)
CAT S L=^DPT(DA,0),DOB=+$P(L,"^",3),AGE=DT-DOB\10000,X1=^DIC(45.82,+Y,0),EDB=+$P(X1,U,4),LDB=+$P(X1,U,5),EAG=+$P(X1,U,6)
"RTN","DGRPDD1",42,0)
 I EDB>0,DOB<EDB W:'$D(ZTQUEUED) !!,"The date of birth is too early for the selected category of beneficiary",!,"Make another selection or correct the date of birth.",!!,*7 K X G CATQ
"RTN","DGRPDD1",43,0)
 I LDB>0,DOB>LDB W:'$D(ZTQUEUED) !!,"The date of birth is too late for the selected category of beneficiary.",!,"Make another selection or correct the date of birth.",!!,*7 K X G CATQ
"RTN","DGRPDD1",44,0)
 I EAG>0,AGE<EAG W:'$D(ZTQUEUED) !!,"The patient's age is too young for the selected category of beneficiary.",!,"Make another selection or correct the date of birth.",!!,*7 K X G CATQ
"RTN","DGRPDD1",45,0)
CATQ K EAG,AGE,DOB,LDB,EDB,X1 Q
"RTN","DGRPDD1",46,0)
 ;
"RTN","DGRPDD1",47,0)
VIET Q
"RTN","DGRPDD1",48,0)
POS S L=^DPT(DA,0),Y=+$P(L,"^",3) I X-Y\10000<15 X ^DD("DD") W:'$D(ZTQUEUED) !!,"This service entry date would make the patient too young for service.",!,"DOB ",Y,!,*7 K X G POSQ
"RTN","DGRPDD1",49,0)
 G POSQ:SD1=1!'$D(^DPT(DA,.32)) S L1=^(.32) I $P(L1,"^",SD1-1*5+1)="" W:'$D(ZTQUEUED) !?5,"Previous service entry date is not on file",*7 G POSQ
"RTN","DGRPDD1",50,0)
 S Y=$P(L1,U,6) I SD1=2,X'<Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"This service entry date must be before than the first service entry date ",Y,!!,*7 K X G POSQ
"RTN","DGRPDD1",51,0)
 S Y=$P(L1,U,11) I SD1=3,X'<Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"This service entry date must be less than the second service entry date ",Y,!!,*7 K X G POSQ
"RTN","DGRPDD1",52,0)
POSQ K L1,L,DOB,AGE,SD1 Q
"RTN","DGRPDD1",53,0)
 ;
"RTN","DGRPDD1",54,0)
PS S L1=$S($D(^DPT(DA,.32)):^(.32),1:"") G PS2:SD1=2,PS3:SD1=3 S Y=$P(L1,U,6) I X'>Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"The service separation date must be after the entry date ",Y,!!,*7 K X G PSQ
"RTN","DGRPDD1",55,0)
 ;
"RTN","DGRPDD1",56,0)
 G PSQ
"RTN","DGRPDD1",57,0)
PS2 S Y=$P(L1,U,11) I X'>Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"The service separation date must be after the service entry date ",Y,!!,*7 K X G PSQ
"RTN","DGRPDD1",58,0)
 S Y=$P(L1,U,6) I Y,X'<Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"This service separation date must be before the next service entry date ",Y,!!,*7 K X G PSQ
"RTN","DGRPDD1",59,0)
 G PSQ
"RTN","DGRPDD1",60,0)
PS3 S Y=$P(L1,U,16) I X'>Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"The service separation date must be after the service entry date ",Y,!!,*7 K X G PSQ
"RTN","DGRPDD1",61,0)
 S Y=$P(L1,U,11) I X'<Y X ^DD("DD") W:'$D(ZTQUEUED) !!,"The service separation date must be before the next service entry date ",Y,!!,*7 K X G POSQ
"RTN","DGRPDD1",62,0)
PSQ K L1,SD1 Q
"RTN","DGRPDD1",63,0)
CAT1 S DDA=DA,DA=+^DGPT(DA,0) D CAT S DA=DDA K DDA Q
"RTN","DGRPDD1",64,0)
 ;
"RTN","DGRPDD1",65,0)
AGE(DFN,X) ;Called from input transform of SERVICE ENTRY field (#.01) of the
"RTN","DGRPDD1",66,0)
 ;MILITARY SERVICE EPISODE sub-file #2.3216. Added for DG*5.3*797.
"RTN","DGRPDD1",67,0)
 N DOB,MSG
"RTN","DGRPDD1",68,0)
 Q:'$G(DFN) 0 Q:'$G(X) 0
"RTN","DGRPDD1",69,0)
 S DOB=+$P($G(^DPT(DFN,0)),U,3)
"RTN","DGRPDD1",70,0)
 I X-DOB\10000<15 D  Q 0
"RTN","DGRPDD1",71,0)
 .S MSG(1)="This service entry date would make the patient too young for service."
"RTN","DGRPDD1",72,0)
 .S MSG(1,"F")="!!"
"RTN","DGRPDD1",73,0)
 .S MSG(2)="DOB "_$$FMTE^XLFDT(DOB)
"RTN","DGRPDD1",74,0)
 .D EN^DDIOL(.MSG)
"RTN","DGRPDD1",75,0)
 Q 1
"VER")
8.0^22.0
"BLD",9209,6)
^761
**END**
**END**
