Released PRC*5.1*128 SEQ #122
Extracted from mail message
**KIDS**:PRC*5.1*128^

**INSTALL NAME**
PRC*5.1*128
"BLD",5821,0)
PRC*5.1*128^IFCAP^0^3101223^y
"BLD",5821,1,0)
^^2^2^3100331^^
"BLD",5821,1,1,0)
1. Amendment to decrease line item quantity to less than delivery
"BLD",5821,1,2,0)
   schedule causes infinite error message loop.
"BLD",5821,4,0)
^9.64PA^442^2
"BLD",5821,4,442,0)
442
"BLD",5821,4,442,2,0)
^9.641^442.01^1
"BLD",5821,4,442,2,442.01,0)
ITEM  (sub-file)
"BLD",5821,4,442,2,442.01,1,0)
^9.6411^8^1
"BLD",5821,4,442,2,442.01,1,8,0)
FEDERAL SUPPLY CLASSIFICATION
"BLD",5821,4,442,222)
y^n^p^^^^n^^n
"BLD",5821,4,442,224)

"BLD",5821,4,443.6,0)
443.6
"BLD",5821,4,443.6,2,0)
^9.641^443.61^1
"BLD",5821,4,443.6,2,443.61,0)
ITEM  (sub-file)
"BLD",5821,4,443.6,2,443.61,1,0)
^9.6411^8^1
"BLD",5821,4,443.6,2,443.61,1,8,0)
FEDERAL SUPPLY CLASSIFICATION
"BLD",5821,4,443.6,222)
y^n^p^^^^n^^n
"BLD",5821,4,443.6,224)

"BLD",5821,4,"APDD",442,442.01)

"BLD",5821,4,"APDD",442,442.01,8)

"BLD",5821,4,"APDD",443.6,443.61)

"BLD",5821,4,"APDD",443.6,443.61,8)

"BLD",5821,4,"B",442,442)

"BLD",5821,4,"B",443.6,443.6)

"BLD",5821,6.3)
7
"BLD",5821,"ABPKG")
n
"BLD",5821,"INID")
^y
"BLD",5821,"INIT")
FIXDD^PRCH128P
"BLD",5821,"KRN",0)
^9.67PA^8989.52^19
"BLD",5821,"KRN",.4,0)
.4
"BLD",5821,"KRN",.401,0)
.401
"BLD",5821,"KRN",.402,0)
.402
"BLD",5821,"KRN",.402,"NM",0)
^9.68A^4^4
"BLD",5821,"KRN",.402,"NM",1,0)
PRCHLINE    FILE #443.6^443.6^0
"BLD",5821,"KRN",.402,"NM",2,0)
PRCH2138    FILE #442^442^0
"BLD",5821,"KRN",.402,"NM",3,0)
PRCHNREQ    FILE #442^442^0
"BLD",5821,"KRN",.402,"NM",4,0)
PRCHRQITM    FILE #443.6^443.6^0
"BLD",5821,"KRN",.402,"NM","B","PRCH2138    FILE #442",2)

"BLD",5821,"KRN",.402,"NM","B","PRCHLINE    FILE #443.6",1)

"BLD",5821,"KRN",.402,"NM","B","PRCHNREQ    FILE #442",3)

"BLD",5821,"KRN",.402,"NM","B","PRCHRQITM    FILE #443.6",4)

"BLD",5821,"KRN",.403,0)
.403
"BLD",5821,"KRN",.403,"NM",0)
^9.68A^^
"BLD",5821,"KRN",.5,0)
.5
"BLD",5821,"KRN",.84,0)
.84
"BLD",5821,"KRN",3.6,0)
3.6
"BLD",5821,"KRN",3.8,0)
3.8
"BLD",5821,"KRN",9.2,0)
9.2
"BLD",5821,"KRN",9.8,0)
9.8
"BLD",5821,"KRN",19,0)
19
"BLD",5821,"KRN",19.1,0)
19.1
"BLD",5821,"KRN",101,0)
101
"BLD",5821,"KRN",409.61,0)
409.61
"BLD",5821,"KRN",771,0)
771
"BLD",5821,"KRN",870,0)
870
"BLD",5821,"KRN",8989.51,0)
8989.51
"BLD",5821,"KRN",8989.52,0)
8989.52
"BLD",5821,"KRN",8994,0)
8994
"BLD",5821,"KRN","B",.4,.4)

"BLD",5821,"KRN","B",.401,.401)

"BLD",5821,"KRN","B",.402,.402)

"BLD",5821,"KRN","B",.403,.403)

"BLD",5821,"KRN","B",.5,.5)

"BLD",5821,"KRN","B",.84,.84)

"BLD",5821,"KRN","B",3.6,3.6)

"BLD",5821,"KRN","B",3.8,3.8)

"BLD",5821,"KRN","B",9.2,9.2)

"BLD",5821,"KRN","B",9.8,9.8)

"BLD",5821,"KRN","B",19,19)

"BLD",5821,"KRN","B",19.1,19.1)

"BLD",5821,"KRN","B",101,101)

"BLD",5821,"KRN","B",409.61,409.61)

"BLD",5821,"KRN","B",771,771)

"BLD",5821,"KRN","B",870,870)

"BLD",5821,"KRN","B",8989.51,8989.51)

"BLD",5821,"KRN","B",8989.52,8989.52)

"BLD",5821,"KRN","B",8994,8994)

"BLD",5821,"QUES",0)
^9.62^^
"BLD",5821,"REQB",0)
^9.611^^
"FIA",442)
PROCUREMENT & ACCOUNTING TRANSACTIONS
"FIA",442,0)
^PRC(442,
"FIA",442,0,0)
442I
"FIA",442,0,1)
y^n^p^^^^n^^n
"FIA",442,0,10)

"FIA",442,0,11)

"FIA",442,0,"RLRO")

"FIA",442,0,"VR")
5.1^PRC
"FIA",442,442)
1
"FIA",442,442.01)
1
"FIA",442,442.01,8)

"FIA",443.6)
AMENDMENTS
"FIA",443.6,0)
^PRC(443.6,
"FIA",443.6,0,0)
443.6I
"FIA",443.6,0,1)
y^n^p^^^^n^^n
"FIA",443.6,0,10)

"FIA",443.6,0,11)

"FIA",443.6,0,"RLRO")

"FIA",443.6,0,"VR")
5.1^PRC
"FIA",443.6,443.6)
1
"FIA",443.6,443.61)
1
"FIA",443.6,443.61,8)

"INIT")
FIXDD^PRCH128P
"KRN",.402,2456,-1)
0^2
"KRN",.402,2456,0)
PRCH2138^3090909.111^^442^^^3101207
"KRN",.402,2456,"DIAB",1,0,442,11)
VENDOR:
"KRN",.402,2456,"DIAB",1,1,442.01,23)
PURCHASE ORDER NUMBER:DELIVERY SCHEDULE (ORDER):
"KRN",.402,2456,"DIAB",1,1,442.12,0)
ALL
"KRN",.402,2456,"DIAB",2,0,442,4)
SUBSTATION;REQ
"KRN",.402,2456,"DIAB",7,1,442.01,9)
FEDERAL SUPPLY CLASSIFICATION;T
"KRN",.402,2456,"DR",1,442)
Q:'$D(PRC("SITE"));S (PRCHN("SVC"),PRCHN("CC"),PRCHN("SC"),PRCHN("INV"))="";S PRCHN("SFC")=+$P(^PRC(442,DA,0),U,19);S PRCHN("FOB")=$S($D(^(1)):$P(^(1),U,6),1:"");S PRCHN(12)=$S($D(^PRC(442,DA,12)):^(12),1:"");
"KRN",.402,2456,"DR",1,442,1)
S PRCHNVF="",PRCHPONO=$P(^PRC(442,DA,0),U,1),PRCHSTN=$P(PRCHPONO,"-") S PRCHIEN=DA;S PRCX=$O(^PRC(411,PRC("SITE"),1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,PRC("SITE"),1,PRCX,0)),U) K PRCX;D EN2^PRCHNPO6;
"KRN",.402,2456,"DR",1,442,2)
S PRCHDUZ=$P(^VA(200,DUZ,0),U,1);S PRCHN("MP")=$S($D(^PRCD(442.5,+$P(^PRC(442,DA,0),U,2),0)):$P(^(0),U,3),1:"");S PRCHN("INV")=$S(PRCHN("MP")=2:"FISCAL",PRCHN("MP")=12:"",PRCHN("INV")'="":PRCHN("INV"),1:"VA FSC");
"KRN",.402,2456,"DR",1,442,3)
S PRCHCTPO=$S(PRCHN("MP")=2:"Y",1:"N");S X=$P($G(^PRC(442,DA,1)),U) I X>0,$P($G(^PRC(440,X,3)),U,2)="Y" S PRCHEDI="";I '$D(^PRC(411,"UP",PRC("SITE"))) S Y=.1;S OSUB=$P($G(^PRC(442,DA,23)),U,7);
"KRN",.402,2456,"DR",1,442,4)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($G(^(0)),U,10) I +X=OSUB W !,"SUBSTATION: ",$P(^PRC(411,$P(^PRC(442,DA,23),U,7),0),U) S Y=.1;31R~;
"KRN",.402,2456,"DR",1,442,5)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)),X'=OSUB W !,?5,"Sub-station cannot be changed because the attached 2237",!,?5,"would then have a different sub-station.",!;
"KRN",.402,2456,"DR",1,442,6)
S PRCX=$O(^PRC(411,X,1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,X,1,PRCX,0)),U) K PRCX;Q;Q;Q;Q;.1//TODAY;.02//^S X="INVOICE/RECEIVING REPORT";
"KRN",.402,2456,"DR",1,442,7)
S PRCHN("MP")=$S($D(^PRCD(442.5,+X,0)):$P(^(0),U,3),1:""),PRCHN("INV")=$S(PRCHN("MP")=2:"FISCAL",PRCHN("MP")=12:"",PRCHN("INV")]"":PRCHN("INV"),1:"VA FSC");S:PRCHN("MP")'=25 Y=.08;D LOOK^PRCSPC;I (X="")!(X["^") S ERRFLG=38,Y=0;
"KRN",.402,2456,"DR",1,442,8)
I $G(PRCHXXX)="" S ERRFLG=38,Y=0;46////^S X=$G(PRCHXXX);56////^S X=DUZ;I PRCHXXX]"" S PRCPO=^PRC(440.5,PRCHXXX,0),PRCHHLDR=$P(PRCPO,U,8);61////^S X=PRCHHLDR;K PRCPO,PRCHHLDR,PRCHXXX;
"KRN",.402,2456,"DR",1,442,9)
.08//^S X=$S(PRCHN("MP")=2:"Y",PRCHN("MP")=12:"Y",1:"N");.04//^S X=PRCHN("INV");5;I $P(PRCHNVF,"^",3)=1 S Y="@20";S PRCHOV3=$G(^PRC(440,+^PRC(442,D0,1),3)) S:$P(PRCHOV3,"^",12)="P" Y="@20";S:$P(PRCHOV3,"^",6)="N" Y="@20";
"KRN",.402,2456,"DR",1,442,10)
S FLAG=0 I $P(PRCHOV3,"^",4)]""!(($P(PRCHOV3,"^",9)]"")&($P(PRCHOV3,"^",8)]"")) S FLAG=1;D EN9^PRCHNPO7;W:0 "The jump Y=@20 is set in routine EN9^PRCHNPO7";
"KRN",.402,2456,"DR",1,442,11)
^440^PRC(440,^^S I(0,0)=D0 S Y(1)=$S($D(^PRC(442,D0,1)):^(1),1:"") S X=$P(Y(1),U,1),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");@20;I '$D(PRCHEDI) S:$D(^PRC(442,DA,12)) $P(^(12),U,13,14)="^" S Y="@10";18.6//^S X="N";
"KRN",.402,2456,"DR",1,442,12)
I X'="Y" S:$D(^PRC(442,DA,12)) $P(^(12),U,14)="" S Y="@10";18.7;@10;8//^S X=PRCHN("SC");I "29"'[X K:0 DIC("DR") D ^PRCHNPO3 S Y="@1";.25;D ^PRCHNPO3;@1;
"KRN",.402,2456,"DR",1,442,13)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($P(^(0),U,1),"-",4) I +X=+$P(^PRC(442,DA,0),U,3) W !,"FCP: ",$P(^(0),U,3) S Y="@2";1;S PRCHN("SFC")=$P(^PRC(442,DA,0),U,19);@2;
"KRN",.402,2456,"DR",1,442,14)
I $G(PRC("BBFY"))="" S PRC("BBFY")=$$BBFY^PRCSUT(PRC("SITE"),PRC("FY"),$P(^PRC(442,DA,0),U,3));26///^S X=PRC("BBFY");D EN2^PRCHNPO3;2//^S X=PRCHN("CC");@88;5.2//^S X=PRCHN("SVC");I $P(^PRC(442,DA,0),U,2)=25 S Y="@89";S Y="@90";@89;
"KRN",.402,2456,"DR",1,442,15)
54;@90;S:PRCHN("MP")=2 Y="@3" I $D(^PRC(442,DA,1)),$P(^(1),U,18)]"" S Y="@3";.3//^S X="E";@3;S:PRCHN("MP")=4 Y=5.3;
"KRN",.402,2456,"DR",1,442,16)
I '$P(^PRC(442,DA,0),U,19)&(PRCHN("MP")'=2) W !,"Enter the word 'PATIENT' in the 'DELIVERY LOCATION' field for a direct delivery",!,"to a patient.";5.6;
"KRN",.402,2456,"DR",1,442,17)
I X="PATIENT",$P(^PRC(442,DA,0),U,19) I $P(^(0),U,19)!(PRCHN("MP")=2) W *7,!,"  PATIENT DELIVERY not valid for this type of order!" S Y=5.6;I X="PATIENT" W "   Direct Delivery to Patient" S Y=5.3;5.4//^S X=$G(PRCY);
"KRN",.402,2456,"DR",1,442,18)
I $P(^PRC(442,DA,1),U,12)'="" W *7,!,"Delete the Direct Delivery patient name if you wish the 'Ship to' address",!,"to print on the P.O.",!;S:(PRCHN("MP")'=4)&($P(^(1),U,12)="") Y=6;5.3;K DIC("DR");6//NO;S:X'="Y" Y=6.4;6.2;
"KRN",.402,2456,"DR",1,442,19)
6.4//DESTINATION;S PRCHN("FOB")=X;Q;Q;Q;Q;7//TODAY+10;8.2//^S X="N/A";8.3;13;S PRCHSHP=+X;S:X']"" Y="@99";I $P(^PRC(442,DA,0),U,19)'=2 S Y="@98";S PRCHSBOC=$P($G(^PRCD(420.2,2299,0)),U);13.05////^S X=PRCHSBOC;S Y="@100";@98;13.05;
"KRN",.402,2456,"DR",1,442,20)
@100;S:'$D(PRCHSHP) PRCHSHP=$P(^PRC(442,DA,0),U,13) I '(PRCHN("FOB")="O"&((PRCHSHP>250)!(PRCHSHP=0))) S Y="@99";13.2;13.4;13.3;@99;97//^S X="A";16//^S X=$S($D(PRCHDUZ):PRCHDUZ,1:"");
"KRN",.402,2456,"DR",1,442,21)
S PRCHDUZ1=X I $P(^PRC(442,DA,0),U,2)=25,'$D(^PRC(440.5,"H",X)) W *7,!,"This user is not a purchase card user." S Y=16;K PRCHDUZ,PRCHDUZ1;40;24;20;501//^S X=$G(PRCHCTPO);K PRCHANS,PRCHTPO,PRCHSEEN,PRCHMORE,PRCHQTY,PRCSAVE;
"KRN",.402,2456,"DR",2,440)
I FLAG S Y=17.3;38;I X]"" S Y=39;W !!,"This VENDOR needs a TAX IDENTIFICATION NUMBER or a SOCIAL SECURITY NUMBER.",!,"Please enter one if you have it or get one from the VENDOR.",!;39;I X]"" S Y=17.3;
"KRN",.402,2456,"DR",2,440,1)
W !!,"Please tell me whether the TAX ID/SSN field is a TAX NUMBER or a SSN NUMBER.",!;17.3;17.4;17.7;17.8;17.9;I $P(PRCHOV3,U,11)]"" S Y="@10";41;@10;I $P(PRCHOV3,U,14)]"" S Y="@11";44;@11;I $P(PRCHOV3,U,13)]"" S Y="";
"KRN",.402,2456,"DR",2,442.01)
S PRCHREC=DA,PRCHQUAN="",Z="",PRCHTOT=0;S PRCHINUM=DA;.01;K PRCSAVE;S PRCHOLD=$P($G(^PRC(442,PRCHIEN,2,PRCHINUM,0)),U,2);1.5;I X=""&($L($P($G(^PRC(442,DA(1),2,DA,2)),U,3))=4) S PRCSAVE="G",Y="@101";
"KRN",.402,2456,"DR",2,442.01,1)
I X=""&($L($P($G(^PRC(442,DA(1),2,DA,2)),U,3))=5) S PRCSAVE="S",Y="@101";I X=""&($G(PRCSAVE)="") D ^PRCHAAC4 I $D(PRCHANS) S PRCSAVE=PRCHANS;@101;I $G(PRCSAVE)="^" K PRCHANS,PRCSAVE S Y=0;1;
"KRN",.402,2456,"DR",2,442.01,2)
I '$D(^PRC(442,DA(1),2,DA,1)) W $C(7),!,"Description is Required!!" S Y=1;I $D(^PRC(442,DA(1),1)) S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),2,+^PRC(442,DA(1),1),0)):^(0),1:"");
"KRN",.402,2456,"DR",2,442.01,3)
I Z'="" W:$P(Z,U,12)'="" !,"    Minimum Order Qty.: ",$P(Z,U,12) W:$P(Z,U,9) !,"    Maximum Order Qty.: ",$P(Z,U,9) W:$P(Z,U,11) !,"    Required Order Multiple: ",$P(Z,U,11) S PRCHQUAN=Z K Z;
"KRN",.402,2456,"DR",2,442.01,4)
2//^S X=$S($P(PRCHQUAN,U,12)'="":$P(PRCHQUAN,U,12),$P(PRCHQUAN,U,11)'="":$P(PRCHQUAN,U,11),1:"");I X<PRCHOLD N I F I=0:0 S I=$O(^PRC(442.8,"AC",PRCHPONO,PRCHINUM,I)) Q:'I  S PRCHTOT=PRCHTOT+$P($G(^PRC(442.8,I,0)),U,5);
"KRN",.402,2456,"DR",2,442.01,5)
I $G(PRCHTOT)>X W !!!!!,$C(7),"****Delivery schedule total for this item (",PRCHTOT,") EXCEEDS order quantity (",X,").",!,"Edit delivery schedule(s).",!! S PRCHFLG=1,PRCHQTY=X S Y="@16";@44;
"KRN",.402,2456,"DR",2,442.01,6)
I $P(PRCHQUAN,U,12)'="" I X<$P(PRCHQUAN,U,12) W !,"QUANTITY is less than the Minimum Order Quantity of ",$P(PRCHQUAN,U,12),$C(7) S Y=2;
"KRN",.402,2456,"DR",2,442.01,7)
I $P(PRCHQUAN,U,9)'="" I X>$P(PRCHQUAN,U,9) W !,"QUANTITY is more than the Maximum Order Quantity of ",$P(PRCHQUAN,U,9),$C(7) S Y=2;
"KRN",.402,2456,"DR",2,442.01,8)
I $P(PRCHQUAN,U,11)'="" I X#$P(PRCHQUAN,U,11)'=0 W !,"QUANTITY is not a Required Order Multiple value of ",$P(PRCHQUAN,U,11),$C(7) S Y=2;3;5;I $D(^PRC(442,DA(1),1)),$P(^(1),U,20)="Y" S Y="@6";D TSTREQ1^PRCHNPO9;3.1;9.4;S:X']"" Y=9;
"KRN",.402,2456,"DR",2,442.01,9)
S DIE("NO^")="A";9.7;K DIE("NO^");9;9.5;@6;8T~;I $G(PRCSAVE)'="^" D EN10^PRCHNPO7;
"KRN",.402,2456,"DR",2,442.01,10)
S PRCHFCP=+$P(^PRC(442,DA(1),0),U,3),PRCHN("COM")=$S($D(^PRC(441.2,+X,0)):$P(^(0),U,4),1:"") S:$E($P($G(^PRC(420,PRCHSTN,1,PRCHFCP,0)),U,18),1,2)=11 Y=41 S:(PRCHN("COM")'=1)&($E($P($G(^(0)),U,18),1,2)'=11) Y="@4";
"KRN",.402,2456,"DR",2,442.01,11)
S:PRCHN("MP")=2 Y="@4";9.3;D TSTREQ2^PRCHNPO9;40;S Y="@4";41//^S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),3)):^(3),1:""),X=$P(Z,U,7);42;@4;S DIE("NO^")="OUTOK";4;K DIE("NO^");
"KRN",.402,2456,"DR",2,442.01,12)
I PRCHN("SFC")=2 S $P(^PRC(442,DA(1),2,DA,0),U,4)=$$SUPBOC^PRCHNPO7(-1) S Y="@87";3.5//^S X=$$SUPBOC^PRCHNPO7(-1);@87;S:'$D(PRCHEDI) Y="@5";36.3;36.6;@5;
"KRN",.402,2456,"DR",2,442.01,13)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=DA S PRCHTOT=PRCHTOT+$P(^(0),U,5);S PRCHQTY=$P(^PRC(442,DA(1),2,DA,0),U,2);
"KRN",.402,2456,"DR",2,442.01,14)
I PRCHTOT>PRCHQTY S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(442,DA(1),2,PRCHREC,0),U,2),! S Y="@555";
"KRN",.402,2456,"DR",2,442.01,15)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"'[$E(X) Y="@56" W "  "_$S("Yy"[$E(X):"(YES)","Nn"[$E(X):"(NO)",1:"");@16;
"KRN",.402,2456,"DR",2,442.01,16)
S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U) W !,"Line Item #=",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(442,DA(1),2,PRCHREC,0),U,2),!;
"KRN",.402,2456,"DR",2,442.01,17)
I PRCHTOT=PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," equals order quantity of ",PRCHQTY,".",!,"You may edit delivery schedule(s), but cannot add a new schedule.",!;@555;
"KRN",.402,2456,"DR",2,442.01,18)
I PRCHTOT>PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," EXCEEDS order quantity of ",PRCHQTY,".  You must edit",!,"one or more schedules so that the total equals no more than ",PRCHQTY,".",!! S Y="@55";
"KRN",.402,2456,"DR",2,442.01,19)
S:$D(PRCHSEEN) Y="@55";S PRCHSEEN=1,DLAYGO=442.8 W !!,"To delete a schedule, zero out the quantity to be delivered. To add a new",!,"delivery schedule do the following:",!!;
"KRN",.402,2456,"DR",2,442.01,20)
W "a. If there is no delivery schedule already in file answer 'Yes' when asked if     you are adding a new delivery schedule.";
"KRN",.402,2456,"DR",2,442.01,21)
W !,"b. If there is only one delivery schedule already in the file you will see         'OK? YES//' answer 'No' and then answer 'Yes' when asked if you are adding a    new delivery schedule.";
"KRN",.402,2456,"DR",2,442.01,22)
W !,"c. If there is more than one delivery schedule in the file, hit <return> key at    'CHOOSE' prompt and answer 'Yes' when asked if you are adding a new delivery    schedule.",!!;@55;
"KRN",.402,2456,"DR",2,442.01,23)
^442.8^PRC(442.8,^^X DR(99,1,9.2) S Y(101)=$S($D(^PRC(442.8,D0,0)):^(0),1:"") S X=$P(Y(101),U,1),Y(102)=$G(X) S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");
"KRN",.402,2456,"DR",2,442.01,24)
S:$G(PRCHDA) PRCHINUM=PRCHDA S PRCHQTY=$P(^PRC(442,PRCHIEN,2,PRCHINUM,0),U,2);
"KRN",.402,2456,"DR",2,442.01,25)
I $G(PRCHFLG),PRCHTOT>PRCHQTY W !!,"Delivery schedule total of ",PRCHTOT," EXCEEDS ordered quantity.",!,"of ",PRCHQTY,".  Adjust delivery schedule(s).",!! S Y="@16";
"KRN",.402,2456,"DR",2,442.01,26)
I $G(PRCHFLG) S PRCHFLG=0 W !!!!,"****Returning to Item Multiple edit session.",!! S Y="@44";I PRCHTOT>PRCHQTY S Y="@555";
"KRN",.402,2456,"DR",2,442.01,27)
W !!,"Enter/Edit Another Delivery Schedule for this Item? NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"[$E(X) Y="@16";@56;K DIE("NO^"),PRCHTOT,PRCHSCN,PRCHSEEN;
"KRN",.402,2456,"DR",2,442.12)
.01
"KRN",.402,2456,"DR",2,442.15)
.01;
"KRN",.402,2456,"DR",3,442.8)
1///^S X=PRCHDA;S DIE("NO^")="";2;3;@6;4;K DIE("NO^");S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=PRCHDA S PRCHTOT=PRCHTOT+$P(^(0),U,5);
"KRN",.402,2456,"DR",3,442.8,1)
S PRCHQTY=$P(^PRC(442,PRCHIEN,2,PRCHDA,0),U,2);S PRCHMORE=$P(^PRC(442.8,DA,0),U,5),PRCHMOR2=(PRCHQTY-PRCHTOT+PRCHMORE);
"KRN",.402,2456,"DR",3,442.8,2)
I PRCHTOT>PRCHQTY I PRCHMORE'=0 W *7,!,"Del. sched. total of ",PRCHTOT," for item ",PRCHDA," EXCEEDS the purchase",!,"order quantity of ",PRCHQTY,".",!,"Max. quantity here is ",$S(PRCHMOR2>0:PRCHMOR2,1:0),".",!! S Y="@6";
"KRN",.402,2456,"DR",3,442.8,3)
I PRCHTOT<PRCHQTY W !,"Delivery schedule total of ",PRCHTOT," for item ",PRCHDA," is less than purchase",!,"order quantity.",!!;I X>0 S Y="@445";W *7,!,"Delivery Schedule DELETED",!;.01////@;@445;
"KRN",.402,2456,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^PRC(442,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) K DIC S DIC="^PRC(442.8,",DIC(0)="MFE" D ^DIC S (D,D0,D(0))=+Y
"KRN",.402,2487,-1)
0^3
"KRN",.402,2487,0)
PRCHNREQ^3090909.1129^^442^^^3100913
"KRN",.402,2487,"DIAB",1,0,442,8)
5:
"KRN",.402,2487,"DIAB",1,1,442.01,23)
PURCHASE ORDER NUMBER:DELIVERY SCHEDULE (ORDER):
"KRN",.402,2487,"DIAB",2,0,442,2)
31;REQ
"KRN",.402,2487,"DR",1,442)
S (PRCHN("SVC"),PRCHN("CC"),PRCHN("SC"),PRCHNRQ)="",PRCHN("MP")=8,PRCHN("SFC")=+$P(^PRC(442,DA,0),U,19),PRCHPONO=$P(^(0),U,1) I $D(^PRC(442,DA,1)),$D(^PRCD(420.8,+$P(^(1),U,7),0)) S PRCHN("SC")=$P(^(0),U,1);
"KRN",.402,2487,"DR",1,442,1)
S PRCHDUZ=$P(^VA(200,DUZ,0),U,1),PRCHIEN=DA;S PRCX=$O(^PRC(411,PRC("SITE"),1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,PRC("SITE"),1,PRCX,0)),U) K PRCX;I '$D(^PRC(411,"UP",PRC("SITE"))) S Y=.02;S OSUB=$P($G(^PRC(442,DA,23)),U,7);
"KRN",.402,2487,"DR",1,442,2)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($G(^(0)),U,10) I +X=OSUB W !,"SUBSTATION: ",$P(^PRC(411,$P(^PRC(442,DA,23),U,7),0),U) S Y=.02;31R~;
"KRN",.402,2487,"DR",1,442,3)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) I X'=OSUB W !,?5,"Sub-station cannot be changed because the attached 2237",!,?5,"would then have a different sub-station.",! S $P(^PRC(442,DA,23),U,7)=OSUB S Y=31;
"KRN",.402,2487,"DR",1,442,4)
S PRCX=$O(^PRC(411,X,1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,X,1,PRCX,0)),U) K PRCX;.02//^S X="REQUISITION";I $P(^PRC(442,DA,0),U,2)'=25 S Y=.08;D LOOK^PRCSPC;I (X="")!(X["^") S ERRFLG=42,Y=0;I $G(PRCHXXX)="" S ERRFLG=42,Y=0;
"KRN",.402,2487,"DR",1,442,5)
46////^S X=$G(PRCHXXX);56////^S X=DUZ;I PRCHXXX]"" S PRCPO=^PRC(440.5,PRCHXXX,0),PRCHHLDR=$P(PRCPO,U,8);61////^S X=PRCHHLDR;K PRCPO,PRCHHLDR,PRCHXXX;.08//^S X="Y";9.2///^S X="NET";8.2///^S X="N/A";.04///^S X="VA FSC";Q;.1//TODAY;
"KRN",.402,2487,"DR",1,442,6)
.2///^S X="N";5;S PRCHNVF=$S($G(PRCHNVF)]"":PRCHNVF,1:"");I $P(PRCHNVF,"^",3)=1 S Y="@20";S PRCHOV3=$G(^PRC(440,+^PRC(442,D0,1),3)) S:$P(PRCHOV3,"^",12)="P" Y="@20";S:$P(PRCHOV3,"^",6)="N" Y="@20";
"KRN",.402,2487,"DR",1,442,7)
S FLAG=0 I $P(PRCHOV3,"^",4)]""!(($P(PRCHOV3,"^",9)]"")&($P(PRCHOV3,"^",8)]"")) S FLAG=1;W:0 "The jump Y=@20 is set in routine EN9^PRCHNPO7";D EN9^PRCHNPO7;
"KRN",.402,2487,"DR",1,442,8)
^440^PRC(440,^^S I(0,0)=D0 S Y(1)=$S($D(^PRC(442,D0,1)):^(1),1:"") S X=$P(Y(1),U,1),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");@20;I '$D(PRCHEDI) S:$D(^PRC(442,DA,12)) $P(^(12),U,13,14)="^" S Y="@10";18.6//^S X="N";
"KRN",.402,2487,"DR",1,442,9)
I X'="Y" S:$D(^PRC(442,DA,12)) $P(^(12),U,14)="" S Y="@10";18.7;@10;S:PRCHN("SC")'=1 Y=8;102.4;8//^S X=PRCHN("SC");S PRCHN("SC")=$S($D(^PRCD(420.8,+X,0)):$P(^(0),U,1),1:"");D ^PRCHNPO3;@1;
"KRN",.402,2487,"DR",1,442,10)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($P(^(0),U,1),"-",4) I +X=+$P(^PRC(442,DA,0),U,3) W !,"FCP: ",$P(^(0),U,3) S Y="@2";1;Q;S PRCHN("SFC")=$P(^PRC(442,DA,0),U,19);@2;
"KRN",.402,2487,"DR",1,442,11)
I $G(PRC("BBFY"))="" S PRC("BBFY")=$$BBFY^PRCSUT(PRC("SITE"),PRC("FY"),$P(^PRC(442,DA,0),U,3));26///^S X=PRC("BBFY");D EN2^PRCHNPO3;2//^S X=PRCHN("CC");5.2//^S X=PRCHN("SVC");Q;I $P(^PRC(442,DA,0),U,2)=25 S Y="@89";S Y="@90";@89;
"KRN",.402,2487,"DR",1,442,12)
54;@90;I $D(^PRC(442,DA,1)),$P(^(1),U,18)]"" S Y=5.6;.3///^S X="E";5.6;I X="PATIENT" W *7,!,"No Patient Deliveries allowed from Federal Sources." S Y=5.6;5.4//^S X=$G(PRCY);Q;7//TODAY+10;13;S:X']"" Y="@99";
"KRN",.402,2487,"DR",1,442,13)
I $P(^PRC(442,DA,0),U,19)'=2 S Y="@98";S PRCHSBOC=$P($G(^PRCD(420.2,2299,0)),U);13.05////^S X=PRCHSBOC;S Y="@99";@98;13.05;@99;16//^S X=$S($D(PRCHDUZ):PRCHDUZ,1:"");
"KRN",.402,2487,"DR",1,442,14)
S PRCHDUZ1=X I $P(^PRC(442,DA,0),U,2)=25,'$D(^PRC(440.5,"H",X)) W *7,!,"This user is not a purchase card user." S Y=16;K PRCHDUZ,PRCHDUZ1;40;20;I PRCHN("SC")'=0 S Y="";
"KRN",.402,2487,"DR",1,442,15)
S Z=$O(^PRC(442,DA,2,0)) I $D(^(Z,0)),$D(^PRC(441.2,+$P(^(0),U,13),0)) S PRCHN("COM")=$P(^(0),U,4);71//^S X="A0A";72;80//^S X="T";
"KRN",.402,2487,"DR",1,442,16)
72.4//^S X="",Z=$O(^PRC(411,+^PRC(442,DA,0),5,"AC","Y",0)) S:$D(^PRC(411,+^PRC(442,DA,0),5,+Z,0)) X=$P(^(0),U,1);73//^S X="" I $D(^PRC(442,DA,17)) S X=$S($E(+^(17),1,2)=11:"R",1:"");73.4///^S X="Y";W !,"SIGNAL CODE: A";
"KRN",.402,2487,"DR",1,442,17)
74///^S X="A";75;76;77//^I $D(^PRC(442,DA,17)) S X=$P(^(17),U,1);78//^S:'$D(PRCHN("COM")) PRCHN("COM")="" S Z=$P(^PRC(442,DA,1),U,17),X=$S(PRCHN("COM")=1:10,Z="Y":"03",1:15);79//^S X="2J";
"KRN",.402,2487,"DR",2,440)
I FLAG S Y=17.3;38;I X]"" S Y=39;W !!,"This VENDOR needs a TAX IDENTIFICATION NUMBER or a SOCIAL SECURITY NUMBER.",!,"Please enter one if you have it or get one from the VENDOR.",!;39;I X]"" S Y=17.3;
"KRN",.402,2487,"DR",2,440,1)
W !!,"Please tell me whether the TAX ID/SSN field is a TAX NUMBER or a SSN NUMBER.",!;17.3;17.4;17.7;17.8;17.9;I $P(PRCHOV3,U,11)]"" S Y="@10";41;@10;I $P(PRCHOV3,U,14)]"" S Y="@11";44;@11;I $P(PRCHOV3,U,13)]"" S Y="";
"KRN",.402,2487,"DR",2,442.01)
S (PRCHREC,PRCHINUM)=DA,PRCHQUAN="",Z="",PRCHTOT=0;.01;S PRCHOLD=$P($G(^PRC(442,PRCHIEN,2,PRCHINUM,0)),U,2);1.5;1;I $D(^PRC(442,DA(1),1)) S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),2,+^PRC(442,DA(1),1),0)):^(0),1:"");
"KRN",.402,2487,"DR",2,442.01,1)
K:Z="" Z I $D(Z) W:$P(Z,U,12)'="" !,"    Minimum Order Qty.: ",$P(Z,U,12) W:$P(Z,U,9) !,"    Maximum Order Qty.: ",$P(Z,U,9) W:$P(Z,U,11) !,"    Required Order Multiple: ",$P(Z,U,11) S PRCHQUAN=Z K Z;
"KRN",.402,2487,"DR",2,442.01,2)
2//^S X=$S($P(PRCHQUAN,U,12)'="":$P(PRCHQUAN,U,12),$P(PRCHQUAN,U,11)'="":$P(PRCHQUAN,U,11),1:"");I X<PRCHOLD N I F I=0:0 S I=$O(^PRC(442.8,"AC",PRCHPONO,PRCHINUM,I)) Q:'I  S PRCHTOT=PRCHTOT+$P($G(^PRC(442.8,I,0)),U,5);
"KRN",.402,2487,"DR",2,442.01,3)
I $G(PRCHTOT)>X W !!!!,$C(7),"****Delivery schedule total of ",PRCHTOT," for item ",DA," exceeds order",!,"quantity of ",X,".  Edit delivery schedule(s) now.",!! S PRCHFLG=1,PRCHQTY=X S Y="@16";@44;
"KRN",.402,2487,"DR",2,442.01,4)
I $P(PRCHQUAN,U,12)'="" I X<$P(PRCHQUAN,U,12) W !,"QUANTITY is less than Minimum Order Quantity of ",$P(PRCHQUAN,U,12),".",$C(7) S Y=2;
"KRN",.402,2487,"DR",2,442.01,5)
I $P(PRCHQUAN,U,9)'="" I X>$P(PRCHQUAN,U,9) W !,"QUANTITY is more than Maximum Order Quantity of ",$P(PRCHQUAN,U,9),".",$C(7) S Y=2;
"KRN",.402,2487,"DR",2,442.01,6)
I $P(PRCHQUAN,U,11)'="" I X#$P(PRCHQUAN,U,11)'=0 W !,"QUANTITY is not a Required Order Multiple value.",$C(7) S Y=2;3;
"KRN",.402,2487,"DR",2,442.01,7)
I PRCHN("SC")=0,$D(^PRCD(420.5,+X,0)),$P(^(0),U,3)="" W *7,!,"Missing DLA Package Unit--Will use IFCAP Unit--May Reject!";5;I $D(^PRC(442,DA(1),1)),$P(^(1),U,20)="Y" S Y="@7";D TSTREQ1^PRCHNPO9;3.1;9.4;S:X']"" Y=9.5;
"KRN",.402,2487,"DR",2,442.01,8)
S DIE("NO^")="A";9.7;K DIE("NO^");9.5;S PRCHN("COM")=$S($D(^PRC(441.2,+X,0)):$P(^(0),U,4),1:"") I PRCHN("COM")="",PRCHN("SC")'=9 W *7,!,"NSN is required!!!" S Y=9.5;I PRCHN("SC")'=9 S Y="@3";9;@7;I PRCHN("SC")'=9 S Y="@3";8;@3;
"KRN",.402,2487,"DR",2,442.01,9)
S PRCHN("COM")="" I $D(^PRC(442,DA(1),2,DA,2)),$D(^PRC(441.2,+$P(^(2),U,3),0)) S PRCHN("COM")=$P(^(0),U,4),PRCHSTN=$P(PRCHPONO,"-"),PRCHFCP=+$P(^PRC(442,DA(1),0),U,3);
"KRN",.402,2487,"DR",2,442.01,10)
S:$E($P($G(^PRC(420,PRCHSTN,1,PRCHFCP,0)),U,18),1,2)=11 Y=41 S:($E($P($G(^(0)),U,18),1,2)'=11)&(PRCHN("SC")=9) Y="@4" S:(((PRCHN("COM")'=1)&($E($P($G(^(0)),U,18),1,2)'=11))&(PRCHN("SC")'=9)) Y=4;9.3;D TSTREQ2^PRCHNPO9;40;
"KRN",.402,2487,"DR",2,442.01,11)
S Y=$S(PRCHN("SC")'=9:4,1:"@4");41//^S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),3)):^(3),1:""),X=$P(Z,U,7) K Z;42;S Y=$S(PRCHN("SC")'=9:4,1:"@4");4;@4;S Y=$S((PRCHN("SC")=0)!(PRCHN("SC")=3):30,PRCHN("SC")=1:35,1:"@5");30;
"KRN",.402,2487,"DR",2,442.01,12)
I PRCHN("SC")=0 S Y="@5";35;36;@5;S:'$D(PRCHEDI) Y="@88";36.3;36.6;@88;I PRCHN("SFC")=2 S $P(^PRC(442,DA(1),2,DA,0),U,4)=$$SUPBOC^PRCHNPO7(-1) S Y="@87";3.5//^S X=$$SUPBOC^PRCHNPO7(-1);@87;@6;
"KRN",.402,2487,"DR",2,442.01,13)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=DA S PRCHTOT=PRCHTOT+$P(^(0),U,5);S PRCHQTY=$P(^PRC(442,DA(1),2,DA,0),U,2);
"KRN",.402,2487,"DR",2,442.01,14)
I PRCHTOT>PRCHQTY S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(442,DA(1),2,PRCHREC,0),U,2),! S Y="@555";
"KRN",.402,2487,"DR",2,442.01,15)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@6" S:"Yy?"'[$E(X) Y="@56" W "  "_$S("Yy"[$E(X):"(YES)","Nn"[$E(X):"(NO)",1:"");@16;
"KRN",.402,2487,"DR",2,442.01,16)
S PRCHDA=DA,PRCHDA1=DA(1),PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U,1) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: "_$P(^(0),U,2),!;
"KRN",.402,2487,"DR",2,442.01,17)
I PRCHTOT=PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," equals the order quantity.",!,"You may edit delivery schedule(s), but cannot add a new schedule.",!!;@555;
"KRN",.402,2487,"DR",2,442.01,18)
I PRCHTOT>PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," EXCEEDS order quantity of ",PRCHQTY,".",!,"You must edit one or more schedules so that the delivery total equals",!,"no more than ",PRCHQTY,".",!!;
"KRN",.402,2487,"DR",2,442.01,19)
S:$D(PRCHSEEN) Y="@55";S PRCHSEEN=1,DLAYGO=442.8 W !!,"** To DELETE a schedule, zero out the quantity to be delivered. To add a new",!,"delivery schedule do the following:",!!;
"KRN",.402,2487,"DR",2,442.01,20)
W "a. If there is no delivery schedule already in file answer 'Yes' when asked if     you are adding a new delivery schedule.";
"KRN",.402,2487,"DR",2,442.01,21)
W !,"b. If there is only one delivery schedule already in the file you will see         'OK? YES//' answer 'No' and then answer 'Yes' when asked if you are adding a    new delivery schedule.";
"KRN",.402,2487,"DR",2,442.01,22)
W !,"c. If there is more than one delivery schedule in the file, hit <return> key at    'CHOOSE' prompt and answer 'Yes' when asked if you are adding a new delivery    schedule.",!!;@55;
"KRN",.402,2487,"DR",2,442.01,23)
^442.8^PRC(442.8,^^X DR(99,1,9.2) S Y(101)=$S($D(^PRC(442.8,D0,0)):^(0),1:"") S X=$P(Y(101),U,1),Y(102)=$G(X) S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");S PRCHQTY=$P(^PRC(442,PRCHIEN,2,DA,0),U,2);
"KRN",.402,2487,"DR",2,442.01,24)
I $G(PRCHFLG),PRCHTOT>$G(PRCHQTY) W !!,"Delivery schedule(s) quantity of ",PRCHTOT," is still greater than ordered quantity of ",$G(PRCHQTY),".",!! S Y="@16";
"KRN",.402,2487,"DR",2,442.01,25)
I $G(PRCHFLG) S PRCHFLG=0 W !!!!,"****Returning to Item Multiple editing session.",!! S Y="@44";I PRCHTOT>PRCHQTY S Y="@555";
"KRN",.402,2487,"DR",2,442.01,26)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@6" S:"Yy?"[$E(X) Y="@16";@56;K DIE("NO^"),PRCHDA1,PRCHDA,PRCHSCN;K PRCHTOT,PRCHQTY,PRCHSEEN,PRCHMORE;
"KRN",.402,2487,"DR",2,442.06)
1///^S X=30;
"KRN",.402,2487,"DR",3,442.8)
1///^S X=PRCHLINO;S DIE("NO^")="";2;3;@9;S DIE("NO^")="";4;K DIE("NO^");
"KRN",.402,2487,"DR",3,442.8,1)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=PRCHDA S PRCHTOT=PRCHTOT+$P(^(0),U,5);S PRCHQTY=$P(^PRC(442,PRCHDA1,2,PRCHDA,0),U,2);
"KRN",.402,2487,"DR",3,442.8,2)
S PRCHMORE=$P(^PRC(442.8,DA,0),U,5),PRCHMOR2=(PRCHQTY-PRCHTOT+PRCHMORE);
"KRN",.402,2487,"DR",3,442.8,3)
I PRCHTOT>$G(PRCHQTY) I PRCHMORE'=0 W *7,!,"Delivery sched. total of ",PRCHTOT," for item ",PRCHDA," EXCEEDS the",!,"purchase order quantity of ",PRCHQTY,".",!,"Max. quantity here is ",$S(PRCHMOR2>0:PRCHMOR2,1:0),".",!! S Y="@9";
"KRN",.402,2487,"DR",3,442.8,4)
I PRCHTOT<$G(PRCHQTY) W !,"Delivery schedule total(s) of ",PRCHTOT," for item ",PRCHDA," is less than purchase",!,"order quantity of ",PRCHQTY,".",!!;I X>0 S Y="@445";W *7,!,"Delivery Schedule DELETED",!!;.01////@;@445;
"KRN",.402,2487,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^PRC(442,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) K DIC S DIC="^PRC(442.8,",DIC(0)="MFLE" D ^DIC S (D,D0,D(0))=+Y
"KRN",.402,2647,-1)
0^1
"KRN",.402,2647,0)
PRCHLINE^3091203.1237^^443.6^^^3100524
"KRN",.402,2647,"DIAB",1,1,443.61,26)
PURCHASE ORDER NUMBER:AMENDMENTS TO DELIVERY SCHEDULES:
"KRN",.402,2647,"DIAB",6,1,443.61,12)
FEDERAL SUPPLY CLASSIFICATION;T
"KRN",.402,2647,"DR",1,443.6)
S PRCHPONO=$P(^PRC(443.6,PRCHPO,0),U);40///^S X=PRCHI1;K DIE("NO^"),PRCHSEEN,PRCHMORE,PRCHQTY,PRCHTOT,PRCHSCN,PRCHDSCH,PRCHDSFL,PRCHANS,PRCSAVE;
"KRN",.402,2647,"DR",2,443.61)
S (D0,PRCHIEN)=DA(1),PRCHINUM=DA,PRCHREC=DA;K PRCSAVE;1.5;I X=""&($L($P($G(^PRC(443.6,DA(1),2,DA,2)),U,3))=4) S PRCSAVE="G",Y="@101";I X=""&($L($P($G(^PRC(443.6,DA(1),2,DA,2)),U,3))=5) S PRCSAVE="S",Y="@101";
"KRN",.402,2647,"DR",2,443.61,1)
I X=""&($G(PRCSAVE)="") D ^PRCHAAC4 I $D(PRCHANS) S PRCSAVE=PRCHANS;@101;I $G(PRCSAVE)="^" K PRCHANS,PRCSAVE S Y=0;1;I '$D(^PRC(443.6,DA(1),2,DA,1)) W $C(7),?3,!,"Description is Required!!" S Y=1;
"KRN",.402,2647,"DR",2,443.61,2)
S PRCHOLD=$P($G(^PRC(443.6,PRCHIEN,2,PRCHINUM,0)),U,2);S (PRCHQUAN,PRCHZ)="" I $D(^PRC(443.6,DA(1),1)) S PRCHZ=$S($D(^PRC(441,+$P(^PRC(443.6,DA(1),2,DA,0),U,5),2,+^PRC(443.6,DA(1),1),0)):^(0),1:"");
"KRN",.402,2647,"DR",2,443.61,3)
I PRCHZ'="" W:$P(PRCHZ,U,12)'="" !,*7,"    Minimum Order Qty.: ",$P(PRCHZ,U,12) W:$P(PRCHZ,U,9) !,*7,"    Maximum Order Qty.: ",$P(PRCHZ,U,9) W:$P(PRCHZ,U,11) !,*7,"    Required Order Multiple: ",$P(PRCHZ,U,11) S PRCHQUAN=PRCHZ;
"KRN",.402,2647,"DR",2,443.61,4)
S PRCHQPR=$P($G(^PRC(443.6,DA(1),2,DA,2)),U,8);@2;2//^S X=$S($P(PRCHQUAN,U,12)'="":$P(PRCHQUAN,U,12),$P(PRCHQUAN,U,11)'="":$P(PRCHQUAN,U,11),1:"");
"KRN",.402,2647,"DR",2,443.61,5)
I PRCHQPR>X W !,"RECEIVED ITEM QUANTITY > NEW QUANTITY ENTERED, NOT ALLOWED",!,"** RESTORE QUANTITY AND EXIT ITEM **" S Y="@2";S PRCHQTY=X,PRCHDSFL=0,PRCHTOT=0;
"KRN",.402,2647,"DR",2,443.61,6)
I PRCHQTY<$G(PRCHOLD) N I F I=0:0 S I=$O(^PRC(441.7,"AG",PRCHPONO,PRCHINUM,I)) Q:'I  S PRCHTOT=$G(PRCHTOT)+$P($G(^PRC(441.7,I,0)),U,5) I 'PRCHDSFL S PRCHDSFL=1;
"KRN",.402,2647,"DR",2,443.61,7)
I $G(PRCHTOT)>PRCHQTY,PRCHDSFL W !!!,$C(7),"****Delivery Schedule total for this item (",PRCHTOT,") EXCEEDS order quantity (",PRCHQTY,").",!,"Edit delivery schedule(s) now.",! S PRCHFLG=1 S Y="@16";@44;S DA=PRCHINUM;
"KRN",.402,2647,"DR",2,443.61,8)
I PRCHQPR>0 I PRCHQTY<PRCHQPR W !,"QUANTITY is less than Quantity Previously Received (",PRCHQPR,").",$C(7) S Y="@2";
"KRN",.402,2647,"DR",2,443.61,9)
I $P(PRCHQUAN,U,12)'="" I PRCHQTY<$P(PRCHQUAN,U,12) W !,"QUANTITY is less than Minimum Order Quantity.",$C(7) S Y="@2";
"KRN",.402,2647,"DR",2,443.61,10)
I $P(PRCHQUAN,U,9)'="" I PRCHQTY>$P(PRCHQUAN,U,9) W !,"QUANTITY is more than Maximum Order Quantity.",$C(7) S Y="@2";
"KRN",.402,2647,"DR",2,443.61,11)
I $P(PRCHQUAN,U,11)'="" I PRCHQTY#$P(PRCHQUAN,U,11)'=0 W !,"QUANTITY is not a Required Order Multiple value.",$C(7) S Y="@2";3;5;I $D(^PRC(443.6,DA(1),1)),$P(^(1),U,20)="Y" S Y="@66";3.1;9.4;S:X']"" Y=9;S DIE("NO^")="A";9.7;
"KRN",.402,2647,"DR",2,443.61,12)
K DIE("NO^");9;9.5;@66;S PRCHN("MP")=$S($D(^PRCD(442.5,+$P(^PRC(443.6,DA(1),0),U,2),0)):$P(^(0),U,3),1:"");8T~;I $G(PRCSAVE)'="^" D EN100^PRCHNPO7;
"KRN",.402,2647,"DR",2,443.61,13)
S PRCHFCP=+$P(^PRC(443.6,DA(1),0),U,3),PRCHN("COM")=$S($D(^PRC(441.2,+X,0)):$P(^(0),U,4),1:"") S:$E($P($G(^PRC(420,PRCHSTN,1,PRCHFCP,0)),U,18),1,2)=11 Y=41 S:(PRCHN("COM")'=1)&($E($P($G(^(0)),U,18),1,2)'=11) Y=4;
"KRN",.402,2647,"DR",2,443.61,14)
S:PRCHN("MP")=2 Y=4;9.3;40//^S X="D";S Y="@4";41//^S Z=$S($D(^PRC(441,+$P(^PRC(443.6,DA(1),2,DA,0),U,5),3)):^(3),1:""),X=$P(Z,U,7);42;@4;4;S PRCHN("SFC")=+$P(^PRC(443.6,DA(1),0),U,19);
"KRN",.402,2647,"DR",2,443.61,15)
I PRCHN("SFC")=2 S $P(^PRC(443.6,DA(1),2,DA,0),U,4)=$$SUPBOC^PRCHMA0(-1) S Y="@87";3.5//^S X=$$SUPBOC^PRCHMA0(-1);@87;S:$G(PRCHEDI)']"" Y="@5";36.3;36.6;@5;
"KRN",.402,2647,"DR",2,443.61,16)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(441.7,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(441.7,PRCHSCN,0),U,2)=PRCHINUM S PRCHTOT=PRCHTOT+$P(^(0),U,5);S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);
"KRN",.402,2647,"DR",2,443.61,17)
I PRCHTOT>PRCHQTY S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: ",$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2),! S Y="@555";
"KRN",.402,2647,"DR",2,443.61,18)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R XX:DTIME S:'$T XX="^" S:XX="" XX="N" S:XX["?" Y="@5" S:"Yy?"'[$E(XX) Y="" W "  "_$S("Yy"[$E(XX):"(YES)","Nn"[$E(XX):"(NO)",1:"");@16;
"KRN",.402,2647,"DR",2,443.61,19)
S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: ",$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2),!;
"KRN",.402,2647,"DR",2,443.61,20)
I PRCHTOT=PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," equals order quantity of ",PRCHQTY,".",!,"You may edit delivery schedule(s), but cannot add a new schedule.",!!;@555;
"KRN",.402,2647,"DR",2,443.61,21)
I PRCHTOT>PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," EXCEEDS order quantity of ",PRCHQTY,". You must edit",!,"one or more schedules so that the total equals no more than ",PRCHQTY,".",!! S Y="@55";
"KRN",.402,2647,"DR",2,443.61,22)
S:$D(PRCHSEEN) Y="@55";S PRCHSEEN=1,DLAYGO=441.7 W !!,"To delete a schedule, zero out the quantity to be delivered. To add a new",!,"delivery schedule do the following:",!!;
"KRN",.402,2647,"DR",2,443.61,23)
W "a. If there is no delivery schedule already in file answer 'Yes' when asked if     you are adding a new delivery schedule.";
"KRN",.402,2647,"DR",2,443.61,24)
W !,"b. If there is only one delivery schedule already in the file you will see         'OK? YES//' answer 'No' and then answer 'Yes' when asked if you are adding a    new delivery schedule.";
"KRN",.402,2647,"DR",2,443.61,25)
W !,"c. If there is more than one delivery schedule in the file, hit <return> key at    'CHOOSE' prompt and answer 'Yes' when asked if you are adding a new delivery    schedule.",!!;@55;
"KRN",.402,2647,"DR",2,443.61,26)
^441.7^PRC(441.7,^^X DR(99,1,9.2) S Y(101)=$S($D(^PRC(441.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");S PRCHNORE=1;S (DA,D1)=PRCHDA,(D0,DA(1))=PRCHDA1;
"KRN",.402,2647,"DR",2,443.61,27)
S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);I $G(PRCHTOT)>$G(PRCHQTY) W !!,"Delivery schedule total of ",PRCHTOT," EXCEEDS ordered quantity",!,"of ",PRCHQTY,".  Adjust delivery schedule(s).",! S Y="@16";
"KRN",.402,2647,"DR",2,443.61,28)
I $G(PRCHFLG)=1 W !!!,"****Returning to Item Multiple session.",!! S Y="@44" S PRCHFLG=0;W !!,"Enter/Edit Another Delivery Schedule for this Item? NO// " R X:DTIME S:'$T S="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"[$E(X) Y="@16";
"KRN",.402,2647,"DR",3,441.7)
S PRCHAA=$P($G(^PRC(441.7,D0,0)),U),PRCHAB=+$P($G(^PRC(441.7,D0,0)),U,7),PRCHYY=D0_"^"_PRCHAA_"^"_$S(PRCHAB=0:1,1:"");1///^S X=PRCHDA;S DIE("NO^")="";2;3;@6;4;K DIE("NO^");
"KRN",.402,2647,"DR",3,441.7,1)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(441.7,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(441.7,PRCHSCN,0),U,2)=PRCHINUM S PRCHTOT=PRCHTOT+$P(^PRC(441.7,PRCHSCN,0),U,5);
"KRN",.402,2647,"DR",3,441.7,2)
S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);S PRCHMORE=$P(^PRC(441.7,DA,0),U,5) S PRCHMOR2=(PRCHQTY-PRCHTOT+PRCHMORE);S PRCHDSCH=DA;
"KRN",.402,2647,"DR",3,441.7,3)
I PRCHTOT>PRCHQTY I PRCHMORE'=0 W *7,!,"Delivery sched. total of ",PRCHTOT," for item ",PRCHINUM," EXCEEDS the purchase",!,"order quantity of ",PRCHQTY,".",!,"Max. quantity here is ",($S(PRCHMOR2>0:PRCHMOR2,1:0)),".",!! S Y="@6";
"KRN",.402,2647,"DR",3,441.7,4)
I PRCHTOT<PRCHQTY,PRCHTOT>0 W !!,"Delivery schedule total of ",PRCHTOT," for item ",PRCHINUM," is less than the purchase",!,"order quantity.",!!;S DA(1)=PRCHDA1 S:X>0 Y="@17",$P(^PRC(441.7,PRCHDSCH,0),U,6)="";
"KRN",.402,2647,"DR",3,441.7,5)
I $P($G(^PRC(441.7,PRCHDSCH,0)),U,7)]"" S Y="@117";W *7,!!,"Delivery Schedule DELETED!",!!;K PRCHNORE;.01////@;S Y="@17";@117;5////^S X="D";W *7,!!,"Delivery Schedule DELETED at the time of the obligation of this P.0.",!!;@17;
"KRN",.402,2647,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^PRC(443.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) K DIC S DIC="^PRC(441.7,",DIC(0)="MFLE" D ^DIC S (D,D0,D(0))=+Y
"KRN",.402,2651,-1)
0^4
"KRN",.402,2651,0)
PRCHRQITM^3090909.1135^^443.6^^^3100601
"KRN",.402,2651,"DIAB",1,1,443.61,26)
PURCHASE ORDER NUMBER:AMENDMENTS TO DELIVERY SCHEDULES:
"KRN",.402,2651,"DR",1,443.6)
40///^S X=PRCHI1;K DIE("NO^"),PRCHTOT,PRCHINUM,PRCHSCN,PRCHQTY,PRCHMORE,PRCHSEEN,PRCHDSCH;
"KRN",.402,2651,"DR",2,443.61)
S (PRCHREC,PRCHINUM)=DA,PRCHIEN=DA(1);1.5;1;I $D(^PRC(443.6,DA(1),1)),$D(^PRCD(420.8,+$P(^(1),U,7),0)) S PRCHN("SC")=$P(^(0),U);S PRCHOLD=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);
"KRN",.402,2651,"DR",2,443.61,1)
S (PRCHQUAN,Z)="" I $D(^PRC(443.6,DA(1),1)) S Z=$S($D(^PRC(441,+$P(^PRC(443.6,DA(1),2,DA,0),U,5),2,+^PRC(443.6,DA(1),1),0)):^(0),1:"");
"KRN",.402,2651,"DR",2,443.61,2)
K:Z="" Z I $D(Z) W:$P(Z,U,12)'="" !,*7,"    Minimum Order Qty.: ",$P(Z,U,12) W:$P(Z,U,9) !,*7,"    Maximum Order Qty.: ",$P(Z,U,9) W:$P(Z,U,11) !,*7,"    Required Order Multiple: ",$P(Z,U,11) S PRCHQUAN=Z K Z;
"KRN",.402,2651,"DR",2,443.61,3)
S PRCHQPR=$P($G(^PRC(443.6,DA(1),2,DA,2)),U,8);@2;2//^S X=$S($P(PRCHQUAN,U,12)'="":$P(PRCHQUAN,U,12),$P(PRCHQUAN,U,11)'="":$P(PRCHQUAN,U,11),1:"");
"KRN",.402,2651,"DR",2,443.61,4)
I PRCHQPR>0 I X<PRCHQPR W !,"QUANTITY is less than Quantity Previously Received.",$C(7) S Y="@2";S PRCHPONO=$P(^PRC(443.6,PRCHIEN,0),U);
"KRN",.402,2651,"DR",2,443.61,5)
S PRCHTOT=0 I X<PRCHOLD N I F I=0:0 S I=$O(^PRC(441.7,"AG",PRCHPONO,PRCHINUM,I)) Q:'I  S PRCHTOT=$G(PRCHTOT)+$P($G(^PRC(441.7,I,0)),U,5);
"KRN",.402,2651,"DR",2,443.61,6)
I $G(PRCHTOT)>X W !!!!,$C(7),"****Delivery schedule total for this item (",PRCHTOT,") EXCEEDS order quantity (",X,").",!,"Edit delivery schedule(s) now",!! S PRCHFLG=1,PRCHQTY=X S Y="@16";@44;
"KRN",.402,2651,"DR",2,443.61,7)
S DA=PRCHINUM I $P(PRCHQUAN,U,12)'="" I X<$P(PRCHQUAN,U,12) W !,"QUANTITY is less than Minimum Order Quantity.",$C(7) S Y=2;
"KRN",.402,2651,"DR",2,443.61,8)
I $P(PRCHQUAN,U,9)'="" I X>$P(PRCHQUAN,U,9) W !,"QUANTITY is more than Maximum Order Quantity.",$C(7) S Y=2;I $P(PRCHQUAN,U,11)'="" I X#$P(PRCHQUAN,U,11)'=0 W !,"QUANTITY is not a Required Order Multiple value.",$C(7) S Y=2;3;
"KRN",.402,2651,"DR",2,443.61,9)
I PRCHN("SC")=0,$D(^PRCD(420.5,+X,0)),$P(^(0),U,3)="" W *7,!,"Missing DLA Package Unit--Will use IFCAP Unit--May Reject!";5;I $D(^PRC(443.6,DA(1),1)),$P(^(1),U,20)="Y" S Y="@7";3.1;9.4;S:X']"" Y=9.5;S DIE("NO^")="A";9.7;
"KRN",.402,2651,"DR",2,443.61,10)
K DIE("NO^");9.5;S PRCHN("COM")=$S($D(^PRC(441.2,+X,0)):$P(^(0),U,4),1:"") I PRCHN("COM")="",PRCHN("SC")'=9 W *7,!,"NSN is required!!!" S Y=9.5;@7;I PRCHN("SC")'=9 S Y="@3";8;@3;
"KRN",.402,2651,"DR",2,443.61,11)
S PRCHN("COM")="" I $D(^PRC(443.6,DA(1),2,DA,2)),$D(^PRC(441.2,+$P(^(2),U,3),0)) S PRCHN("COM")=$P(^(0),U,4);S PRCHSTN=$P(PRCHPONO,"-"),PRCHFCP=+$P(^PRC(443.6,DA(1),0),U,3);
"KRN",.402,2651,"DR",2,443.61,12)
S:$E($P($G(^PRC(420,PRCHSTN,1,PRCHFCP,0)),U,18),1,2)=11 Y=41 S:($E($P($G(^(0)),U,18),1,2)'=11)&(PRCHN("SC")=9) Y="@4" S:(((PRCHN("COM")'=1)&($E($P($G(^(0)),U,18),1,2)'=11))&(PRCHN("SC")'=9)) Y="@4";9.3;40//^S X="D";S Y="@4";
"KRN",.402,2651,"DR",2,443.61,13)
41//^S Z=$S($D(^PRC(441,+$P(^PRC(443.6,DA(1),2,DA,0),U,5),3)):^(3),1:""),X=$P(Z,U,7) K Z;42;@4;S Y=$S((PRCHN("SC")=0)!(PRCHN("SC")=3):30,PRCHN("SC")=1:35,1:"@5");30;I PRCHN("SC")=0 S Y="@5";35;36;@5;
"KRN",.402,2651,"DR",2,443.61,14)
S PRCHEDI=$P($G(^PRC(440,$P(^PRC(443.6,DA(1),1),U),3)),U,2);S:$G(PRCHEDI)']"" Y="@8";36.3;36.6;@8;S PRCHN("SFC")=+$P(^PRC(443.6,DA(1),0),U,19);I PRCHN("SFC")=2 S $P(^PRC(443.6,DA(1),2,DA,0),U,4)=$$SUPBOC^PRCHMA0(-1) S Y="@88";
"KRN",.402,2651,"DR",2,443.61,15)
3.5//^S X=$$SUPBOC^PRCHMA0(-1);@88;S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(441.7,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(441.7,PRCHSCN,0),U,2)=PRCHINUM S PRCHTOT=PRCHTOT+$P(^(0),U,5);
"KRN",.402,2651,"DR",2,443.61,16)
S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);
"KRN",.402,2651,"DR",2,443.61,17)
I PRCHTOT>PRCHQTY S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2),! S Y="@555";
"KRN",.402,2651,"DR",2,443.61,18)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R XX:DTIME S:'$T XX="^" S:XX="" XX="N" S:XX["?" Y="@6" S:"Yy?"'[$E(XX) Y="" W "  "_$S("Yy"[$E(XX):"(YES)","Nn"[$E(XX):"(NO)",1:"");@16;
"KRN",.402,2651,"DR",2,443.61,19)
S PRCHDA1=DA(1),PRCHDA=DA S PRCHLINO=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: ",$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2),!;
"KRN",.402,2651,"DR",2,443.61,20)
I PRCHTOT=PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," equals order quantity of ",PRCHQTY,".",!,"You may edit delivery schedule(s), but cannot add a new schedule.",!;@555;
"KRN",.402,2651,"DR",2,443.61,21)
I PRCHTOT>PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," EXCEEDS order quantity of ",PRCHQTY,".  You must edit",!,"one or more schedules so that the total equals no more than ",PRCHQTY,".",! S Y="@55";
"KRN",.402,2651,"DR",2,443.61,22)
S:$D(PRCHSEEN) Y="@55";S PRCHSEEN=1,DLAYGO=441.7 W !!,"** To DELETE a schedule, zero out the quantity to be delivered. To add a new",!,"delivery schedule do the following:",!!;
"KRN",.402,2651,"DR",2,443.61,23)
W "a. If there is no delivery schedule already in file answer 'Yes' when asked if     you are adding a new delivery schedule.";
"KRN",.402,2651,"DR",2,443.61,24)
W !,"b. If there is only one delivery schedule already in the file you will see         'OK? YES//' answer 'No' and then answer 'Yes' when asked if you are adding a    new delivery schedule.";
"KRN",.402,2651,"DR",2,443.61,25)
W !,"c. If there is more than one delivery schedule in the file, hit <return> key at    'CHOOSE' prompt and answer 'Yes' when ask if you are adding a new delivery    schedule.",!!;@55;
"KRN",.402,2651,"DR",2,443.61,26)
^441.7^PRC(441.7,^^X DR(99,1,9.2) S Y(101)=$S($D(^PRC(441.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");S PRCHNORE=1;S (D0,DA(1))=PRCHDA1,(D1,DA)=PRCHDA;
"KRN",.402,2651,"DR",2,443.61,27)
S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);I $G(PRCHTOT)>$G(PRCHQTY) W !,"Delivery schedule total of ",PRCHTOT," EXCEEDS ordered quantity",!,"of ",PRCHQTY,".  Adjust delivery schedule(s).",!! S Y="@555";
"KRN",.402,2651,"DR",2,443.61,28)
I $G(PRCHFLG)=1 W !!!,"****Returning to Item Multiple edit session.",!! S Y="@44" S PRCHFLG=0;W !!,"Enter/Edit Another Delivery Schedule for this Item? NO// " R X:DTIME S:'$T S="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"[$E(X) Y="@16";
"KRN",.402,2651,"DR",3,441.7)
S PRCHAA=$P($G(^PRC(441.7,D0,0)),U),PRCHAB=+$P($G(^PRC(441.7,D0,0)),U,7),PRCHYY=D0_"^"_PRCHAA_"^"_$S(PRCHAB=0:1,1:"");1///^S X=PRCHDA;S DIE("NO^")="";2;3;@9;4;K DIE("NO^");
"KRN",.402,2651,"DR",3,441.7,1)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(441.7,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(441.7,PRCHSCN,0),U,2)=PRCHINUM S PRCHTOT=PRCHTOT+$P(^PRC(441.7,PRCHSCN,0),U,5);
"KRN",.402,2651,"DR",3,441.7,2)
S PRCHQTY=$P(^PRC(443.6,PRCHIEN,2,PRCHINUM,0),U,2);S PRCHMORE=$P(^PRC(441.7,DA,0),U,5),PRCHMOR2=(PRCHQTY-PRCHTOT+PRCHMORE);S PRCHDSCH=DA;
"KRN",.402,2651,"DR",3,441.7,3)
I PRCHTOT>PRCHQTY I PRCHMORE'=0 W *7,!,"Delivery sched. total of ",PRCHTOT," for item ",PRCHINUM," EXCEEDS the purchase",!,"order quantity of ",PRCHQTY,".",!,"Max. quantity here is ",$S(PRCHMOR2>0:PRCHMOR2,1:0),".",!! S Y="@9";
"KRN",.402,2651,"DR",3,441.7,4)
I PRCHTOT<PRCHQTY W !,"Delivery schedule total of ",PRCHTOT," for item ",PRCHINUM," is less than purchase",!,"order quantity.",!!;S DA(1)=PRCHDA1 S:X>0 Y="@17",$P(^PRC(441.7,PRCHDSCH,0),U,6)="";
"KRN",.402,2651,"DR",3,441.7,5)
I $P($G(^PRC(441.7,PRCHDSCH,0)),U,7)]"" S Y="@117";W *7,!!,"Delivery Schedule DELETED!",!!;K PRCHNORE;.01////@;S Y="@17";@117;5////^S X="D";W *7,!!,"Delivery Schedule DELETED when Requisition is obligated.",!!;@17;
"KRN",.402,2651,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^PRC(443.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) K DIC S DIC="^PRC(441.7,",DIC(0)="MFLE" D ^DIC S (D,D0,D(0))=+Y
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
128^3101223
"PKG",455,22,1,"PAH",1,1,0)
^^2^2^3101223
"PKG",455,22,1,"PAH",1,1,1,0)
1. Amendment to decrease line item quantity to less than delivery
"PKG",455,22,1,"PAH",1,1,2,0)
   schedule causes infinite error message loop.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRCH128P")
0^^B296227^n/a
"RTN","PRCH128P",1,0)
PRCH128P ;VMP/RB - FIX ^DD(443.61,8) & ^DD(442.01,8) FSC FIELD#8 ENTRY ;03/09/10
"RTN","PRCH128P",2,0)
 ;;5.1;IFCAP;**128**;03/31/10;Build 7
"RTN","PRCH128P",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCH128P",4,0)
 ;;
"RTN","PRCH128P",5,0)
 Q
"RTN","PRCH128P",6,0)
FIXDD ;
"RTN","PRCH128P",7,0)
 ;1. Post install to delete node 9 from ^DD(443.61,8) (FSC) to insure
"RTN","PRCH128P",8,0)
 ;   the field update in patch cleans up node ^DD(443.61,8,9). This
"RTN","PRCH128P",9,0)
 ;   is a field under subfile Item (443.61).
"RTN","PRCH128P",10,0)
 ;2. Post install to delete node 9 from ^DD(442.01,8) (FSC) to insure
"RTN","PRCH128P",11,0)
 ;   the field update in patch cleans up node ^DD(442.01,8,9). This
"RTN","PRCH128P",12,0)
 ;   is a field under subfile Item (442.01).
"RTN","PRCH128P",13,0)
 ;
"RTN","PRCH128P",14,0)
KILL K ^DD(443.61,8,9),^DD(442.01,8,9)
"RTN","PRCH128P",15,0)
 Q
"UP",442,442.01,-1)
442^2
"UP",442,442.01,0)
442.01
"UP",443.6,443.61,-1)
443.6^2
"UP",443.6,443.61,0)
443.61
"VER")
8.0^22.0
"^DD",442,442.01,8,0)
FEDERAL SUPPLY CLASSIFICATION^RP441.2'X^PRC(441.2,^2;3^D EN10^PRCHNPO7
"^DD",442,442.01,8,.1)
FSC/PSC
"^DD",442,442.01,8,3)
ANSWER MUST BE 1-24 CHARACTERS IN LENGTH
"^DD",442,442.01,8,21,0)
^^2^2^3050809^
"^DD",442,442.01,8,21,1,0)
This is the Federal Supply Classification for an item, or the Product 
"^DD",442,442.01,8,21,2,0)
Service Code for a service.
"^DD",442,442.01,8,"DT")
3050809
"^DD",443.6,443.61,8,0)
FEDERAL SUPPLY CLASSIFICATION^RP441.2'X^PRC(441.2,^2;3^D EN100^PRCHNPO7
"^DD",443.6,443.61,8,.1)
FSC/PSC
"^DD",443.6,443.61,8,1,0)
^.1
"^DD",443.6,443.61,8,1,1,0)
443.61^AU^MUMPS
"^DD",443.6,443.61,8,1,1,1)
I $G(PRCHNORE)=1 D:PRCHAMDA=21 EN1^PRCHAMXG Q:PRCHAMDA=21  D FLAG^PRCHMA Q:$T  I PRCHAMDA=23 S PRCHX=X,X=0 D EN1^PRCHAMXD S X=PRCHX K PRCHX
"^DD",443.6,443.61,8,1,1,2)
I $G(PRCHNORE)=1,PRCHAMDA=23 S FLAG=1 D EN1^PRCHAMXD
"^DD",443.6,443.61,8,1,1,"%D",0)
^^5^5^2970416^^^^
"^DD",443.6,443.61,8,1,1,"%D",1,0)
This x-ref will update the CHANGES multiple whenever a 'Line Item Add' or a
"^DD",443.6,443.61,8,1,1,"%D",2,0)
'Line Item Edit' amendment changes this field.
"^DD",443.6,443.61,8,1,1,"%D",3,0)
                 
"^DD",443.6,443.61,8,1,1,"%D",4,0)
****NOTE-See routine PRCHAMXA for information on variable PRCHNORE and
"^DD",443.6,443.61,8,1,1,"%D",5,0)
incidence of undefined DIK variable errors.
"^DD",443.6,443.61,8,1,1,"DT")
2950321
"^DD",443.6,443.61,8,3)

"^DD",443.6,443.61,8,21,0)
^.001^2^2^3080418^^^^
"^DD",443.6,443.61,8,21,1,0)
This is the Federal Supply Classification for an item, or the Product
"^DD",443.6,443.61,8,21,2,0)
Service Code for a service.
"^DD",443.6,443.61,8,"DT")
3050909
"BLD",5821,6)
^122
**END**
**END**
