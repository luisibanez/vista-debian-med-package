Released RMPR*3*162 SEQ #142
Extracted from mail message
**KIDS**:RMPR*3.0*162^

**INSTALL NAME**
RMPR*3.0*162
"BLD",7711,0)
RMPR*3.0*162^PROSTHETICS^0^3100909^y
"BLD",7711,1,0)
^^7^7^3100719^
"BLD",7711,1,1,0)
1. When using the "23 Display 2319" option, if a user decides to exit 
"BLD",7711,1,2,0)
   using the up caret (^) symbol at the Enter 10-2319 screen to VIEW
"BLD",7711,1,3,0)
   prompt, they will receive a system error.
"BLD",7711,1,4,0)
 
"BLD",7711,1,5,0)
2. When a user in the Prosthetics application views the Display/Print 
"BLD",7711,1,6,0)
   Display 2319 menu option, HCPCS items and shipping charges are not
"BLD",7711,1,7,0)
   being displayed correctly.
"BLD",7711,4,0)
^9.64PA^^
"BLD",7711,6.3)
5
"BLD",7711,"ABPKG")
n
"BLD",7711,"KRN",0)
^9.67PA^779.2^20
"BLD",7711,"KRN",.4,0)
.4
"BLD",7711,"KRN",.401,0)
.401
"BLD",7711,"KRN",.402,0)
.402
"BLD",7711,"KRN",.403,0)
.403
"BLD",7711,"KRN",.5,0)
.5
"BLD",7711,"KRN",.84,0)
.84
"BLD",7711,"KRN",3.6,0)
3.6
"BLD",7711,"KRN",3.8,0)
3.8
"BLD",7711,"KRN",9.2,0)
9.2
"BLD",7711,"KRN",9.8,0)
9.8
"BLD",7711,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",7711,"KRN",9.8,"NM",1,0)
RMPR9S4^^0^B29629049
"BLD",7711,"KRN",9.8,"NM",2,0)
RMPRPAT^^0^B41372880
"BLD",7711,"KRN",9.8,"NM",3,0)
RMPRPAT1^^0^B23123419
"BLD",7711,"KRN",9.8,"NM",4,0)
RMPRPAT2^^0^B31418296
"BLD",7711,"KRN",9.8,"NM",5,0)
RMPRPAT3^^0^B40605335
"BLD",7711,"KRN",9.8,"NM",6,0)
RMPRPAT7^^0^B2616702
"BLD",7711,"KRN",9.8,"NM","B","RMPR9S4",1)

"BLD",7711,"KRN",9.8,"NM","B","RMPRPAT",2)

"BLD",7711,"KRN",9.8,"NM","B","RMPRPAT1",3)

"BLD",7711,"KRN",9.8,"NM","B","RMPRPAT2",4)

"BLD",7711,"KRN",9.8,"NM","B","RMPRPAT3",5)

"BLD",7711,"KRN",9.8,"NM","B","RMPRPAT7",6)

"BLD",7711,"KRN",19,0)
19
"BLD",7711,"KRN",19.1,0)
19.1
"BLD",7711,"KRN",101,0)
101
"BLD",7711,"KRN",409.61,0)
409.61
"BLD",7711,"KRN",771,0)
771
"BLD",7711,"KRN",779.2,0)
779.2
"BLD",7711,"KRN",870,0)
870
"BLD",7711,"KRN",8989.51,0)
8989.51
"BLD",7711,"KRN",8989.52,0)
8989.52
"BLD",7711,"KRN",8994,0)
8994
"BLD",7711,"KRN","B",.4,.4)

"BLD",7711,"KRN","B",.401,.401)

"BLD",7711,"KRN","B",.402,.402)

"BLD",7711,"KRN","B",.403,.403)

"BLD",7711,"KRN","B",.5,.5)

"BLD",7711,"KRN","B",.84,.84)

"BLD",7711,"KRN","B",3.6,3.6)

"BLD",7711,"KRN","B",3.8,3.8)

"BLD",7711,"KRN","B",9.2,9.2)

"BLD",7711,"KRN","B",9.8,9.8)

"BLD",7711,"KRN","B",19,19)

"BLD",7711,"KRN","B",19.1,19.1)

"BLD",7711,"KRN","B",101,101)

"BLD",7711,"KRN","B",409.61,409.61)

"BLD",7711,"KRN","B",771,771)

"BLD",7711,"KRN","B",779.2,779.2)

"BLD",7711,"KRN","B",870,870)

"BLD",7711,"KRN","B",8989.51,8989.51)

"BLD",7711,"KRN","B",8989.52,8989.52)

"BLD",7711,"KRN","B",8994,8994)

"BLD",7711,"QUES",0)
^9.62^^
"BLD",7711,"REQB",0)
^9.611^3^3
"BLD",7711,"REQB",1,0)
RMPR*3.0*146^2
"BLD",7711,"REQB",2,0)
RMPR*3.0*62^2
"BLD",7711,"REQB",3,0)
RMPR*3.0*77^2
"BLD",7711,"REQB","B","RMPR*3.0*146",1)

"BLD",7711,"REQB","B","RMPR*3.0*62",2)

"BLD",7711,"REQB","B","RMPR*3.0*77",3)

"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^0
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
162^3100909
"PKG",101,22,1,"PAH",1,1,0)
^^7^7^3100909
"PKG",101,22,1,"PAH",1,1,1,0)
1. When using the "23 Display 2319" option, if a user decides to exit 
"PKG",101,22,1,"PAH",1,1,2,0)
   using the up caret (^) symbol at the Enter 10-2319 screen to VIEW
"PKG",101,22,1,"PAH",1,1,3,0)
   prompt, they will receive a system error.
"PKG",101,22,1,"PAH",1,1,4,0)
 
"PKG",101,22,1,"PAH",1,1,5,0)
2. When a user in the Prosthetics application views the Display/Print 
"PKG",101,22,1,"PAH",1,1,6,0)
   Display 2319 menu option, HCPCS items and shipping charges are not
"PKG",101,22,1,"PAH",1,1,7,0)
   being displayed correctly.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","RMPR9S4")
0^1^B29629049^B30605994
"RTN","RMPR9S4",1,0)
RMPR9S4 ;HOIFO/HNC - GUI 2319 ITEM TRANSACTIONS LIST ;9/10/02  08:42
"RTN","RMPR9S4",2,0)
 ;;3.0;PROSTHETICS;**59,99,90,75,162**;Feb 09, 1996;Build 5
"RTN","RMPR9S4",3,0)
 ;IEN = INTERNAL ENTRY NUMBER OF FILE 668
"RTN","RMPR9S4",4,0)
 Q
"RTN","RMPR9S4",5,0)
A1(IEN) G A2
"RTN","RMPR9S4",6,0)
EN(RESULTS,IEN) ;broker
"RTN","RMPR9S4",7,0)
A2 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPR9S4",8,0)
 K ^TMP($J,"RMPRB")
"RTN","RMPR9S4",9,0)
 K ^TMP($J,"RMPRC"),RMPRLPRO
"RTN","RMPR9S4",10,0)
 ;IT IS RESULTS
"RTN","RMPR9S4",11,0)
 ;0;2 DFN in 668
"RTN","RMPR9S4",12,0)
 S RMPRDFN=$P($G(^RMPR(668,IEN,0)),U,2)
"RTN","RMPR9S4",13,0)
 I RMPRDFN="" S ^TMP($J,"RMPRB",1)="PATIENT NOT KNOWN" Q
"RTN","RMPR9S4",14,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPR9S4",15,0)
 S B=0
"RTN","RMPR9S4",16,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",17,0)
 . S BC=0
"RTN","RMPR9S4",18,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPR9S4",19,0)
 . .;Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPR9S4",20,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPR9S4",21,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPR9S4",22,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPR9S4",23,0)
 . .S:ND="" ND=2
"RTN","RMPR9S4",24,0)
 . .S:GN="" GN=BC
"RTN","RMPR9S4",25,0)
 . .S ^TMP($J,"AG",GN,BC,ND)=B  ;set linked grouper counter structure differently in array;RMPR*3.0*162
"RTN","RMPR9S4",26,0)
 ;COMBINE ITEMS FOR CALC FLAG
"RTN","RMPR9S4",27,0)
 ;modified linked grouper structure determination in patch RMPR*3.0*162
"RTN","RMPR9S4",28,0)
 S B=""
"RTN","RMPR9S4",29,0)
 F  S B=$O(^TMP($J,"AG",B)),ITM=0,HITM=0 Q:B=""!(B]"@")  D
"RTN","RMPR9S4",30,0)
 .F  S ITM=$O(^TMP($J,"AG",B,ITM)),BC=0 Q:+ITM=0  D
"RTN","RMPR9S4",31,0)
 . .F  S BC=$O(^TMP($J,"AG",B,ITM,BC)) Q:+BC=0  D
"RTN","RMPR9S4",32,0)
 . . .I $P($G(^RMPR(660,ITM,0)),U,17) Q
"RTN","RMPR9S4",33,0)
 . . .I HITM=0,BC=2 Q
"RTN","RMPR9S4",34,0)
 . . .I BC=1 S HITM=ITM,BDAT=^TMP($J,"AG",B,ITM,BC)
"RTN","RMPR9S4",35,0)
 . . .S $P(^TMP($J,"TT",BDAT,HITM),U,3)=$P(^TMP($J,"TT",BDAT,HITM),U,3)+$P($G(^RMPR(660,ITM,0)),U,16)
"RTN","RMPR9S4",36,0)
 . . .I BC=2 K ^TMP($J,"TT",BDAT,ITM)
"RTN","RMPR9S4",37,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPR9S4",38,0)
 S B=0,RC=1
"RTN","RMPR9S4",39,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPR9S4",40,0)
 .S RK=0
"RTN","RMPR9S4",41,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPR9S4",42,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPR9S4",43,0)
 . .S ^TMP($J,"RMPRC",RC)=RK
"RTN","RMPR9S4",44,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(^TMP($J,"RMPRC",RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPR9S4",45,0)
 . .S RC=RC+1
"RTN","RMPR9S4",46,0)
 S RK=0,RZ=0
"RTN","RMPR9S4",47,0)
 K ^TMP($J,"TT"),B
"RTN","RMPR9S4",48,0)
 ;
"RTN","RMPR9S4",49,0)
 G:'$D(^TMP($J,"RMPRC")) END
"RTN","RMPR9S4",50,0)
 ;
"RTN","RMPR9S4",51,0)
DIS ;format data string - ALL
"RTN","RMPR9S4",52,0)
 S RC=""
"RTN","RMPR9S4",53,0)
 S RK=0
"RTN","RMPR9S4",54,0)
 F  S RK=$O(^TMP($J,"RMPRC",RK)) Q:RK=""  D
"RTN","RMPR9S4",55,0)
 .S AN=+^TMP($J,"RMPRC",RK)
"RTN","RMPR9S4",56,0)
 .S RMPRY=$G(^RMPR(660,AN,0))
"RTN","RMPR9S4",57,0)
 .I RMPRY'="" D PRT
"RTN","RMPR9S4",58,0)
 .Q
"RTN","RMPR9S4",59,0)
 ;
"RTN","RMPR9S4",60,0)
 ;
"RTN","RMPR9S4",61,0)
END I RC=0 S ^TMP($J,"RMPRB",1)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4",62,0)
 ;
"RTN","RMPR9S4",63,0)
 ;
"RTN","RMPR9S4",64,0)
EXIT ;common exit point
"RTN","RMPR9S4",65,0)
 ;pass to broker
"RTN","RMPR9S4",66,0)
 K ^TMP($J,"RMPRC")
"RTN","RMPR9S4",67,0)
 ;S RESULT=$NA(^TMP($J))
"RTN","RMPR9S4",68,0)
 M RESULTS=^TMP($J,"RMPRB")
"RTN","RMPR9S4",69,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4",70,0)
 K I,J,L,R0,RA,AMIS,AN,ANS,CST,FRM,RC,RK,RMPRDFN,RMPRNC,RZ,STA,TRANS,TRANS,TYPE,BDAT,HITM,ITM,TRANS1
"RTN","RMPR9S4",71,0)
 Q
"RTN","RMPR9S4",72,0)
PRT ;
"RTN","RMPR9S4",73,0)
 S DATE=$P(RMPRY,U,3),TYPE=$P(RMPRY,U,6),QTY=$P(RMPRY,U,7)
"RTN","RMPR9S4",74,0)
 S VEN=$P(RMPRY,U,9),TRANS=$P(RMPRY,U,4),STA=$P(RMPRY,U,10),SN=$P(RMPRY,U,11)
"RTN","RMPR9S4",75,0)
 S DEL=$P(RMPRY,U,12)
"RTN","RMPR9S4",76,0)
 S CST=$S($P(RMPRY,U,16)'="":$P(RMPRY,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPR9S4",77,0)
 ;lab source of procurement
"RTN","RMPR9S4",78,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPR9S4",79,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPR9S4",80,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPR9S4",81,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPR9S4",82,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPR9S4",83,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPR9S4",84,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPR9S4",85,0)
 .I RMPRLPRO="E" S RMPRLPRO="EYE GLASS" Q
"RTN","RMPR9S4",86,0)
 .I RMPRLPRO="" K RMPRLPRO
"RTN","RMPR9S4",87,0)
 ;form requested on
"RTN","RMPR9S4",88,0)
 S FRM=$P(RMPRY,U,13)
"RTN","RMPR9S4",89,0)
 S RMPRNC=$P($G(^RMPR(660,AN,"AM")),U,2)
"RTN","RMPR9S4",90,0)
 S DATE=$$DAT2^RMPRUTL1(DATE)
"RTN","RMPR9S4",91,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPR9S4",92,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",93,0)
 S AMIS=$P(RMPRY,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPR9S4",94,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPR9S4",95,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPR9S4",96,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPR9S4",97,0)
 ;
"RTN","RMPR9S4",98,0)
 ;set results array
"RTN","RMPR9S4",99,0)
 ;
"RTN","RMPR9S4",100,0)
 S HTYPE=""
"RTN","RMPR9S4",101,0)
 I $D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) S HTYPE=$E(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),1,15)
"RTN","RMPR9S4",102,0)
 S ITEM=AMIS_$S(TYPE'="":$P($G(^RMPR(661.1,TYPE,0)),U,2),$P(RMPRY,U,26)="D":"DELIVERY",$P(RMPRY,U,26)="P":"PICKUP",$P(RMPRY,U,17):"SHIPPING",HTYPE'="":HTYPE,1:"")
"RTN","RMPR9S4",103,0)
 K HTYPE
"RTN","RMPR9S4",104,0)
 ;
"RTN","RMPR9S4",105,0)
 S HCPCS=$P($G(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),1)),U,4)
"RTN","RMPR9S4",106,0)
 I HCPCS'="" S HCPCS=$P($G(^RMPR(661.1,HCPCS,0)),U,1)
"RTN","RMPR9S4",107,0)
 ;
"RTN","RMPR9S4",108,0)
 S ^TMP($J,"RMPRB",RK)=$P(^TMP($J,"RMPRC",RK),U,1)_U_DATE_U_QTY_U_ITEM
"RTN","RMPR9S4",109,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_HCPCS_U_TRANS_TRANS1
"RTN","RMPR9S4",110,0)
 ;
"RTN","RMPR9S4",111,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPR9S4",112,0)
 I $D(RMPRLPRO) S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_RMPRLPRO
"RTN","RMPR9S4",113,0)
 E  S:VEN'="" ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S4",114,0)
 I VEN=""&'$D(RMPRLPRO) S:'$D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E(VEN,1,10)
"RTN","RMPR9S4",115,0)
 I VEN=""&'$D(RMPRLPRO) S:$D(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST")) ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$E($P(^RMPR(660,$P(^TMP($J,"RMPRC",RK),U,1),"HST"),U,3),1,10)
"RTN","RMPR9S4",116,0)
 ;
"RTN","RMPR9S4",117,0)
 I STA'="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_$P($G(^DIC(4,STA,99)),U,1)
"RTN","RMPR9S4",118,0)
 I STA="" S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_"UNKNOWN"
"RTN","RMPR9S4",119,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_SN_U_DEL
"RTN","RMPR9S4",120,0)
 I $P(^TMP($J,"RMPRC",RK),U,3) S CST=$P(^TMP($J,"RMPRC",RK),U,3)
"RTN","RMPR9S4",121,0)
 S COST=$J($FN($S(CST'="":CST,$P(RMPRY,U,17):$P(RMPRY,U,17),1:""),"T",2),9)
"RTN","RMPR9S4",122,0)
 ;
"RTN","RMPR9S4",123,0)
 S ^TMP($J,"RMPRB",RK)=^TMP($J,"RMPRB",RK)_U_COST_U_RMPRNC
"RTN","RMPR9S4",124,0)
 ;
"RTN","RMPR9S4",125,0)
 I $P(^TMP($J,"RMPRC",RK),U,2)="" S $P(^TMP($J,"RMPRC",RK),U,2)=RZ
"RTN","RMPR9S4",126,0)
 K DATE,QTY,ITEM,HCPSC,RMPRLPRO,VEN,SN,DEL,COST,REM
"RTN","RMPR9S4",127,0)
 ;
"RTN","RMPR9S4",128,0)
 Q
"RTN","RMPR9S4",129,0)
 ;END
"RTN","RMPRPAT")
0^2^B41372880^B38003429
"RTN","RMPRPAT",1,0)
RMPRPAT ;PHX/RFM/JLT-DISPLAY 2319 FIRST PAGE ;8/29/1994
"RTN","RMPRPAT",2,0)
 ;;3.0;PROSTHETICS;**29,62,162**;Feb 09, 1996;Build 5
"RTN","RMPRPAT",3,0)
 ;
"RTN","RMPRPAT",4,0)
 ; RVD - patch # 62 - sets RMPRNAM, RMPRSSN,RMPRDOB and RMPRSSNE
"RTN","RMPRPAT",5,0)
 ;
"RTN","RMPRPAT",6,0)
ASK ;Set common variables
"RTN","RMPRPAT",7,0)
 Q:$G(RMPRDFN)<1
"RTN","RMPRPAT",8,0)
 ;PATCH *162 => insure activity screen displays first time (RMPRFRST) in and Home Oxygen activity is NOT included (RCNT=7) for inside issue option
"RTN","RMPRPAT",9,0)
 N RCNT
"RTN","RMPRPAT",10,0)
 D HOME^%ZIS S DFN=RMPRDFN,RMPRBACK=1,RMPRFRST=1,RCNT=7 I $G(RSTCK)'=1 S RCNT=8,RFLG=1
"RTN","RMPRPAT",11,0)
 D ADD^VADPT,OAD^VADPT,DEM^VADPT,ELIG^VADPT
"RTN","RMPRPAT",12,0)
 ;next 2 lines added by patch #62
"RTN","RMPRPAT",13,0)
 S RMPRNAM=$P(VADM(1),U),RMPRSSN=$P(VADM(2),U)
"RTN","RMPRPAT",14,0)
 S RMPRDOB=$P(VADM(3),U),RMPRSSNE=VA("PID")
"RTN","RMPRPAT",15,0)
 W @IOF
"RTN","RMPRPAT",16,0)
 S %X="^RMPR(665,"_RMPRDFN_",",%Y="R5(" D %XY^%RCR S RMPRCNUM=VAEL(7)
"RTN","RMPRPAT",17,0)
ASK1 ;CALL ROUTINE TO DISPLAY SCREEN SELECTI0N
"RTN","RMPRPAT",18,0)
 Q:$G(RMPRDFN)'>0  S DFN=RMPRDFN
"RTN","RMPRPAT",19,0)
 I '$D(VAEL(7)) D ELIG^VADPT
"RTN","RMPRPAT",20,0)
 I '$D(VAPA(1)) D ADD^VADPT
"RTN","RMPRPAT",21,0)
 I '$D(VADM(1)) D DEM^VADPT
"RTN","RMPRPAT",22,0)
 I '$D(VAOA(1)) D OAD^VADPT
"RTN","RMPRPAT",23,0)
 I $D(^RMPR(665,RMPRDFN,8,0)) W !,"*Comments on file"
"RTN","RMPRPAT",24,0)
 I '$D(^RMPR(665,RMPRDFN,1,0)) W $C(7),!!,"*No Disability Code on File!"
"RTN","RMPRPAT",25,0)
 I $D(^RMPR(665,RMPRDFN,1,0)),'$O(^(0)) W $C(7),!!,"*No Disability Code on File!"
"RTN","RMPRPAT",26,0)
 D DISP^RMPRPAT5 K ANS W !
"RTN","RMPRPAT",27,0)
 K RMPRQ,RMPRQUES,DIR,RMPREND1,RMPRL
"RTN","RMPRPAT",28,0)
 D ASK1^RMPRPAT1 K ANS I $G(RMPRFRST)=1,$G(RSTCK) D HELP^RMPRPAT1  ;insure activity list appears upon entry
"RTN","RMPRPAT",29,0)
 D ^DIR
"RTN","RMPRPAT",30,0)
 K DIR,RMPRFRST
"RTN","RMPRPAT",31,0)
 I Y["^" G EXIT
"RTN","RMPRPAT",32,0)
 I Y="",'$D(RMPR1APN) G EXIT
"RTN","RMPRPAT",33,0)
 I Y>0 S ANS=Y G QUE
"RTN","RMPRPAT",34,0)
 ;RMPR1APN is set in the entry action to menu RMPR PRINT 2319
"RTN","RMPRPAT",35,0)
 ;and killed in the exit action.  We do not want to prompt
"RTN","RMPRPAT",36,0)
 ;patient name while creating records, only in display
"RTN","RMPRPAT",37,0)
 ;options
"RTN","RMPRPAT",38,0)
 ;prompt to select a new patient
"RTN","RMPRPAT",39,0)
 I Y="",$D(RMPR1APN) S RMPR2APN=RMPRDFN D GETPAT^RMPRUTIL
"RTN","RMPRPAT",40,0)
 I '$D(RMPRDFN) S RMPRDFN=RMPR2APN G EXIT
"RTN","RMPRPAT",41,0)
 I $D(RMPR2APN) K RMPR2APN D ASK1
"RTN","RMPRPAT",42,0)
 Q
"RTN","RMPRPAT",43,0)
ASK2 ;ASK TO CONTINUE AFTER SCREEN DISPLAY
"RTN","RMPRPAT",44,0)
 G ASK1
"RTN","RMPRPAT",45,0)
HELP W !,"You may only enter screen 1-8,`^`, or `return`" G ASK2
"RTN","RMPRPAT",46,0)
 Q
"RTN","RMPRPAT",47,0)
STAR ;DISPLAY ADDRESS INFO
"RTN","RMPRPAT",48,0)
 Q:$G(DFN)'>0
"RTN","RMPRPAT",49,0)
 S RMPRBACK=1
"RTN","RMPRPAT",50,0)
 I '$D(VADM(1))!('$D(VAOA(8))!('$D(VAPA(8))!('$D(VAEL(7))))) N VAHOW D DEM^VADPT,ADD^VADPT,OAD^VADPT
"RTN","RMPRPAT",51,0)
 W:$E(IOST)["C" @IOF
"RTN","RMPRPAT",52,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: ",$P(VADM(2),U,2),?42
"RTN","RMPRPAT",53,0)
 W "DOB: ",$P(VADM(3),U,2),?61,"CLAIM# ",VAEL(7) ;RMPRCNUM
"RTN","RMPRPAT",54,0)
STARD W !!,"Phone: ",VAPA(8),?40,"Phone: ",VAOA(8)
"RTN","RMPRPAT",55,0)
 W !,"Current Address:",?40,"Primary Next of Kin Address:"
"RTN","RMPRPAT",56,0)
 W !,VAPA(1),?40,VAOA(1)
"RTN","RMPRPAT",57,0)
 I VAPA(2)=""&(VAPA(3)="") W:VAPA(4)'="" !,VAPA(4)_", "_$P(VAPA(5),U,2)_" "_VAPA(6) W:VAOA(4)'="" ?40,VAOA(4)_", "_$P(VAOA(5),U,2)_" "_VAOA(6) W:VAOA(10)'="" !,?40,"Relationship: ",VAOA(10) G END
"RTN","RMPRPAT",58,0)
 I VAPA(2)'=""&(VAPA(3)="") W !,VAPA(2) W:VAOA(4)'="" ?40,VAOA(4)_", "_$P(VAOA(5),U,2)_" "_VAOA(6) W:VAPA(4)'="" !,VAPA(4)_", "_$P(VAPA(5),U,2)_" "_VAPA(6) W:VAOA(10)'="" ?40,"Relationship: ",VAOA(10) G END
"RTN","RMPRPAT",59,0)
 I VAPA(2)'=""&(VAPA(3))'="" W !,VAPA(2) W:VAOA(4)'="" ?40,VAOA(4)_", ",$P(VAOA(5),U,2)_" "_VAOA(6),!,VAPA(3) W:VAOA(10)'="" ?40,"Relationship: ",VAOA(10)
"RTN","RMPRPAT",60,0)
 I  W:VAPA(4)'="" !,VAPA(4)_", "_$P(VAPA(5),U,2)_" "_VAPA(6)
"RTN","RMPRPAT",61,0)
END D ELIG^VADPT
"RTN","RMPRPAT",62,0)
 W !!,"Patient Type: ",$P(VAEL(6),U,2),?40
"RTN","RMPRPAT",63,0)
 W "Period of Service: ",$P(VAEL(2),U,2)
"RTN","RMPRPAT",64,0)
 W !,"Primary Eligibility Code:",?40
"RTN","RMPRPAT",65,0)
 W "Status: ",$P(VAEL(9),U,2),!,$P(VAEL(1),U,2)
"RTN","RMPRPAT",66,0)
 W ?40,"Eligibility Status: ",$E($P(VAEL(8),U,2),1,19)
"RTN","RMPRPAT",67,0)
 D MB^VADPT
"RTN","RMPRPAT",68,0)
 W !!,"Receiving A&A Benefits? "
"RTN","RMPRPAT",69,0)
 W:VAMB(1)=0 "NO" W:$P(VAMB(1),U,1)=1 $P(VAMB(1),U,2)
"RTN","RMPRPAT",70,0)
 W ?40,"Receiving Housebound Benefits? "
"RTN","RMPRPAT",71,0)
 W:VAMB(2)=0 "NO" W:$P(VAMB(2),U,1)=1 $P(VAMB(2),U,2)
"RTN","RMPRPAT",72,0)
 W !,"Receiving Social Security? "
"RTN","RMPRPAT",73,0)
 W:VAMB(3)=0 "NO" W:$P(VAMB(3),U,1)=1 $P(VAMB(3),U,2)
"RTN","RMPRPAT",74,0)
 W ?40,"Receiving VA Pension? " W:VAMB(4)=0 "NO"
"RTN","RMPRPAT",75,0)
 W:$P(VAMB(4),U,1)=1 $P(VAMB(4),U,2)
"RTN","RMPRPAT",76,0)
 W !,"Receiving Military Retirement? "
"RTN","RMPRPAT",77,0)
 W:VAMB(5)=0 "NO" W:$P(VAMB(5),U,1)=1 $P(VAMB(5),U,2)
"RTN","RMPRPAT",78,0)
 W ?40,"Receiving VA Disability? " W:VAMB(7)=0 "NO"
"RTN","RMPRPAT",79,0)
 W:$P(VAMB(7),U,1)=1 $P(VAMB(7),U,2)
"RTN","RMPRPAT",80,0)
 S (RO,FG)=0 I '$D(^RMPR(665,RMPRDFN,1)) W !,"No Prosthetic Disability Codes entered for this Patient." S RO=1
"RTN","RMPRPAT",81,0)
 I RO=0 F  W:'FG !,"Prosthetic Disability Code(s):" S RO=$O(^RMPR(665,RMPRDFN,1,RO)) Q:RO'>0  S RR=^(RO,0) S:$P(RR,U,10) FG=1 I '$P(RR,U,10) W " ",$P(^RMPR(662,+RR,0),U,1),"-",$S($P(RR,U,3)=1:"SC",$P(RR,U,3)=2:"NSC",1:"") S FG=1
"RTN","RMPRPAT",82,0)
 I $P($G(^DPT(DFN,.372,0)),U,4)>IOSL-2-$Y D QUEST2 G:$G(RMNOQUIT)=0 ASK1
"RTN","RMPRPAT",83,0)
 S RO=0 F I=0:0 S RO=$O(^DPT(DFN,.372,RO)) Q:RO'>0!$D(RMPREND1)  I +$P(^(RO,0),U,1),$D(^DIC(31,+$P(^(0),U,1))) W:'$D(RMPRL) !,"Patient Name: ",VADM(1),?40,"SSN: ",$P(VADM(2),U,2),!!,"MAS Disability Code(s):"  D WRI
"RTN","RMPRPAT",84,0)
 K RMNOQUIT G:$D(RMPREND1) ASK1
"RTN","RMPRPAT",85,0)
 D SVC^VADPT W !!,"*POW? ",$S(VASV(4)=1:"YES",1:"NO")
"RTN","RMPRPAT",86,0)
 G:$D(RMPRBACK) QUES
"RTN","RMPRPAT",87,0)
 W @IOF G ASK1
"RTN","RMPRPAT",88,0)
WRI I $Y>(IOSL-6),'$D(RMPRQUES) D QUEST1 Q:$D(RMPREND1)  ;patch *162, replace GOTO with Quit when within FOR loop
"RTN","RMPRPAT",89,0)
 W !,$E($P(^DIC(31,$P(^DPT(DFN,.372,RO,0),U,1),0),U,1),1,30),?40,"Disability% ",$P(^DPT(DFN,.372,RO,0),U,2),?56," Service Connected? " W:$P(^DPT(DFN,.372,RO,0),U,3)=1 "YES" W:$P(^DPT(DFN,.372,RO,0),U,3)=0 "NO" S RMPRL=1 Q
"RTN","RMPRPAT",90,0)
QUES ;ASK WHAT PAGE OF A PATIENT'S 10-2319
"RTN","RMPRPAT",91,0)
 K RMPRFLG,RMPRL F I=0:0 Q:$Y>21  W !
"RTN","RMPRPAT",92,0)
QUES1 R !,"Enter return to continue or `^` to exit: ",ANS:DTIME
"RTN","RMPRPAT",93,0)
 G:'$T EXIT
"RTN","RMPRPAT",94,0)
 I ANS="" G ASK1
"RTN","RMPRPAT",95,0)
 I $G(ANS)="" G EXIT
"RTN","RMPRPAT",96,0)
 I "^"[ANS G ASK1
"RTN","RMPRPAT",97,0)
 E  W $C(7),!,"You must enter an `^` to exit!" G QUES1
"RTN","RMPRPAT",98,0)
QUE W:ANS=5 @IOF
"RTN","RMPRPAT",99,0)
 G EXIT:"^"[ANS,STAR^RMPRPAT:ANS=1,^RMPRPAT0:ANS=2,^RMPRPAT1:ANS=3
"RTN","RMPRPAT",100,0)
 I ANS=4 G ^RMPRPAT2
"RTN","RMPRPAT",101,0)
 I ANS=8 G 2319^RMPOBIL2
"RTN","RMPRPAT",102,0)
 G DU^RMPRAINQ:ANS=5
"RTN","RMPRPAT",103,0)
 G ^RMPRPAT5:ANS=6
"RTN","RMPRPAT",104,0)
 I ANS=7 S RMPRDIR7=1 G EN^RMPRDIS
"RTN","RMPRPAT",105,0)
 W !!,$C(7) G QUES
"RTN","RMPRPAT",106,0)
 Q
"RTN","RMPRPAT",107,0)
EXIT ;EXIT FOR DISPLAY OF A PATIENT'S 10-2319
"RTN","RMPRPAT",108,0)
 ;must always exit through this point
"RTN","RMPRPAT",109,0)
 I '$D(^RMPR(665,RMPRDFN,1,0)) D DIS^RMPRPAT5
"RTN","RMPRPAT",110,0)
 I $D(^RMPR(665,RMPRDFN,1,0)),'$O(^(0)) D DIS^RMPRPAT5
"RTN","RMPRPAT",111,0)
 I $D(^RMPR(665,RMPRDFN,1,0)),$O(^(0)) K RMPRKILL
"RTN","RMPRPAT",112,0)
 D NPC^RMPRPAT5
"RTN","RMPRPAT",113,0)
 K RMPRCOMB,Y,DIE,DIC,RMPRCCO,DIR,VASV,VAMB,VAEL,VADM,VAPA,FG,VAOA,TYPE,RMPROBL,RC,AMIS,CST,DATE,DEL,RFLG,QTY,REM,SN,STA,RR,RO,I,J,RMPRCNUM,RMPRFG,TRANS,TRANS1,RK,FLG,RA,RI,RT,RTCH,LC,MC,RMPRDT,RMPRJOB,RMPRWO
"RTN","RMPRPAT",114,0)
 K RMPR2APN,RMPRQ,RR5,R5,DFN,FL,PAGE,AN,FRM,VEN,RZ,%X,%Y,VA,VAERR,TLC,TMC,R660,RCK,RJ,RDA,RL,RTC,RTCD,RTHD,RTR,RW,RWP,RMPRQUES,RMPREND1 D KVAR^VADPT
"RTN","RMPRPAT",115,0)
 K:'$D(RMPRF)!($G(RMPRBACK)<1) RMPRDOB,RMPRDFN,RMPRNAM,RMPRSSN,RMPRBACK
"RTN","RMPRPAT",116,0)
 Q
"RTN","RMPRPAT",117,0)
QUEST1 S RMPRQUES=1
"RTN","RMPRPAT",118,0)
 N DIR S DIR(0)="E" W !! D ^DIR W @IOF
"RTN","RMPRPAT",119,0)
 I $D(DTOUT)!($D(DUOUT)) S RMPREND1=1 Q  ;patch *162, set quit flag if user chooses to exit option
"RTN","RMPRPAT",120,0)
 W ! Q
"RTN","RMPRPAT",121,0)
QUEST2 ;PUT MAS DISABILITY CODES ON NEXT PAGE IF THEY WILL NOT ALL FIT ON THIS
"RTN","RMPRPAT",122,0)
 ;PAGE
"RTN","RMPRPAT",123,0)
 N DIR S DIR(0)="E" W !! D ^DIR W @IOF S RMNOQUIT=1
"RTN","RMPRPAT",124,0)
 I $D(DTOUT)!($D(DUOUT)) S RMNOQUIT=0
"RTN","RMPRPAT",125,0)
 W @IOF
"RTN","RMPRPAT",126,0)
 Q
"RTN","RMPRPAT1")
0^3^B23123419^B22912789
"RTN","RMPRPAT1",1,0)
RMPRPAT1 ;PHX/HNB/RFM/JLT-DISPLAY PATIENT INFO ;8/29/1994
"RTN","RMPRPAT1",2,0)
 ;;3.0;PROSTHETICS;**29,162**;Feb 09, 1996;Build 5
"RTN","RMPRPAT1",3,0)
 W @IOF S PAGE=2
"RTN","RMPRPAT1",4,0)
 K VADM S DFN=RMPRDFN N VAHOW D DEM^VADPT
"RTN","RMPRPAT1",5,0)
 K VAEL S DFN=RMPRDFN N VAHOW D ELIG^VADPT
"RTN","RMPRPAT1",6,0)
 K R5 S %X="^RMPR(665,"_RMPRDFN_",",%Y="R5(" D %XY^%RCR K %X,%Y S DFN=RMPRDFN
"RTN","RMPRPAT1",7,0)
 I $G(^RMPR(664,+$O(^RMPR(664,"C",RMPRDFN,0)),"RMPO"))="Y" W !,"<<<HOME OXYGEN PATIENT>>>>"
"RTN","RMPRPAT1",8,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: ",$P(VADM(2),U,2)
"RTN","RMPRPAT1",9,0)
 W ?42,"DOB: ",$P(VADM(3),U,2)
"RTN","RMPRPAT1",10,0)
 W ?61,"CLAIM# ",VAEL(7)
"RTN","RMPRPAT1",11,0)
 I '$D(R5(10)) S R5(10)=""
"RTN","RMPRPAT1",12,0)
 W !!,"PSC Issue Card: ",?17,"Appliance",?30,"Ht ",$P(R5(10),U,1),?37,"Wt ",$P(R5(10),U,2),?45,"Eyes ",$P(R5(10),U,3),?54,"Hair ",$P(R5(10),U,4),?66,"Serial Number" S J=0
"RTN","RMPRPAT1",13,0)
 F  S J=$O(R5(5,J)) Q:J'>0  W ! S Y=$P(R5(5,J,0),U,1) I $P(R5(5,J,0),U,4) D
"RTN","RMPRPAT1",14,0)
 .D DD^%DT W Y,?17,$S($P(R5(5,J,0),U,2)]"":$E($P(R5(5,J,0),U,2),1,47),1:$E($P(^PRC(441,$P(^RMPR(661,$P(R5(5,J,0),U,4),0),U,1),0),U,2),1,47)),?66,$E($P(R5(5,J,0),U,3),1,12)
"RTN","RMPRPAT1",15,0)
 S R0=$P(R5(0),U,8) W !!,"Clothing Allowance: "
"RTN","RMPRPAT1",16,0)
 I $D(R5(6)),$O(R5(6,0))>0 F RI=0:0 S RI=$O(^RMPR(665,RMPRDFN,6,"B",RI)) Q:RI'>0  S RA=$O(^RMPR(665,RMPRDFN,6,"B",RI,0)),RR5=R5(6,RA,0),RR5=RR5 D
"RTN","RMPRPAT1",17,0)
 .W ?22,"Date: ",$E(RR5,4,5)_"-"_$E(RR5,6,7)_"-"_$E(RR5,2,3),"  ",$S($P(RR5,U,2)["E":"ELIGIBLE",$P(RR5,U,2)["N":"NOT-ELIGIBLE",1:"UNKNOWN"),"  ",$S($P(RR5,U,3)["S":"STATIC",$P(RR5,U,3)["N":"NON-STATIC",1:"UNKNOWN")
"RTN","RMPRPAT1",18,0)
 .I $P(RR5,U,5) S Y=$P(RR5,U,5) D DD^%DT W !,?22,"Date of Exam: ",Y W:$P(RR5,U,6) " Examiner: ",$E($P(^VA(200,$P(RR5,U,6),0),U,1),1,30)
"RTN","RMPRPAT1",19,0)
 .W !,?22,"Desc: "
"RTN","RMPRPAT1",20,0)
 .W $S($D(R5(6,RA,1)):$P(R5(6,RA,1),U),1:""),!
"RTN","RMPRPAT1",21,0)
 I '$D(R5(6)) W "NONE LISTED",!
"RTN","RMPRPAT1",22,0)
 S RO="" F  S RO=$O(^RMPR(667,"C",RMPRDFN,RO)) Q:RO=""  D
"RTN","RMPRPAT1",23,0)
 .Q:$P(^RMPR(667,RO,2),U,1)=0
"RTN","RMPRPAT1",24,0)
 .W:'$D(RMPRFLG) !,"Automobile(s)",?16,"Make",?29,"Model",?43,"Vehicle ID#",?62,"Date Processed"
"RTN","RMPRPAT1",25,0)
 .W:$P(^RMPR(667,RO,0),U,6)'="" !?16,$E($P(^RMPR(667.2,$P(^RMPR(667,RO,0),U,6),0),U,1),1,11),?29,$E($P(^RMPR(667,RO,0),U,7),1,10),?43,$P(^RMPR(667,RO,0),U,1) S Y=$P(^RMPR(667,RO,0),U,8) D DD^%DT W ?64,Y S RMPRFLG=1
"RTN","RMPRPAT1",26,0)
 K KILL,RMPRFLG
"RTN","RMPRPAT1",27,0)
 W !!,"Items Returned: ",?16,"Date",?29,"Item",?56
"RTN","RMPRPAT1",28,0)
 W "Serial",?68,"Status"
"RTN","RMPRPAT1",29,0)
 D:$D(^RMPR(665,RMPRDFN,7,0)) OLD
"RTN","RMPRPAT1",30,0)
 I $D(^RMPR(660.1,"C",RMPRDFN)),'$D(KILL) S RO=0 F I=1:1 S RO=$O(^RMPR(660.1,"C",RMPRDFN,RO)) Q:RO=""!($D(KILL))  D WRIL
"RTN","RMPRPAT1",31,0)
 W ! K I,J,L,R0
"RTN","RMPRPAT1",32,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPRPAT1",33,0)
 S FL=3 G ASK2^RMPRPAT
"RTN","RMPRPAT1",34,0)
 ;G ^RMPRPAT0:ANS=1,^RMPRPAT1:ANS=2,^RMPRPAT2:ANS=3,^RMPRPAT2:ANS="",EXIT^RMPRPAT Q
"RTN","RMPRPAT1",35,0)
WRIL ;ASK TO SEE MORE RETURNED ITEMS
"RTN","RMPRPAT1",36,0)
 I $E(IOST)["C",I=4 S %=2 W !,"Would you like to see more returned items" D YN^DICN I %=-1!(%=2) S KILL=1 Q
"RTN","RMPRPAT1",37,0)
 I $E(IOST)["C",I=4,%=0 W !,"Enter `YES` or `NO`" G WRIL
"RTN","RMPRPAT1",38,0)
 I $D(^RMPR(660.1,RO)),+$P(^RMPR(660.1,RO,0),U,11) D
"RTN","RMPRPAT1",39,0)
 .S Y=$P(^RMPR(660.1,RO,0),U,11)
"RTN","RMPRPAT1",40,0)
 .D DD^%DT W !?16,Y
"RTN","RMPRPAT1",41,0)
 .W:+$P(^RMPR(660.1,RO,0),U,3) ?29,$E($P(^PRC(441,$P(^RMPR(661,$P(^(0),U,3),0),U),0),U,2),1,20)
"RTN","RMPRPAT1",42,0)
 .W:$P(^RMPR(660.1,RO,0),U,21) ?29,$E(^RMPR(667.1,$P(^(0),U,21),0),1,25) W ?56,$E($P(^RMPR(660.1,RO,0),U,6),1,10)
"RTN","RMPRPAT1",43,0)
 .W ?68,$S($P(^RMPR(660.1,RO,0),U,14)=1:"RETURNED",$P(^(0),U,14)=2:"CONDEMNED",$P(^(0),U,14)=3:"TURNED-IN",$P(^(0),U,14)=4:"LOST",$P(^(0),U,14)=5:"BROKEN",1:"UNKNOWN")
"RTN","RMPRPAT1",44,0)
 Q
"RTN","RMPRPAT1",45,0)
OLD ;DISPLAY OLD RETURNED ITEMS
"RTN","RMPRPAT1",46,0)
 S RO=0 F I=1:1 S RO=$O(^RMPR(665,RMPRDFN,7,RO)) Q:RO=""!($D(KILL))  D OLD1
"RTN","RMPRPAT1",47,0)
 Q
"RTN","RMPRPAT1",48,0)
OLD1 I I=4,$E(IOST)["C" S %=2 W !,"Would you like to see more returned items" D YN^DICN I %=-1!(%=2) S KILL=1 Q
"RTN","RMPRPAT1",49,0)
 I I=4,$E(IOST)["C",%=0 W !,"Enter `YES` or `NO`" G OLD1
"RTN","RMPRPAT1",50,0)
 I $D(^RMPR(665,RMPRDFN,7,RO,0)) S Y=$P(^(0),U) D DD^%DT W !?16,$E(Y,1,12),?29,$E($P(^RMPR(665,RMPRDFN,7,RO,0),U,4),1,20)
"RTN","RMPRPAT1",51,0)
RTNSTA ;DISPLAYS STATUS OF TRACKED ITEM ON PATIENT'S 10-2319
"RTN","RMPRPAT1",52,0)
 I  S R0=$P(^RMPR(665,RMPRDFN,7,RO,0),U,2) W ?68,$S(R0=1:"RETURNED",R0=2:"CONDENMED",R0=3:"TURNED-IN",R0=4:"LOST",R0=5:"BROKEN",1:"UNKNOWN")
"RTN","RMPRPAT1",53,0)
 Q
"RTN","RMPRPAT1",54,0)
HELP ;DISPLAY HELP FOR SCREENS
"RTN","RMPRPAT1",55,0)
 N RMPR90DP,RMPR90I W !,"Select One of the Following: ",! S RMPR90DP=$P(DIR(0),U,2,999) F RMPR90I=1:1:RCNT W !,?5,$P($P(RMPR90DP,";",RMPR90I),":",1),?14,$P($P(RMPR90DP,";",RMPR90I),":",2)
"RTN","RMPRPAT1",56,0)
 W !
"RTN","RMPRPAT1",57,0)
 Q
"RTN","RMPRPAT1",58,0)
ASK1 ;SET DIR AND FOR SCREEN NUMBER DISPLAY
"RTN","RMPRPAT1",59,0)
 ;patch *162 added RCNT variable and check to control 7 or 8 activity display depending on option entered.
"RTN","RMPRPAT1",60,0)
 K DIR S DIR("A")="Enter 10-2319 screen to VIEW (1-"_$G(RCNT)_"),'^' to EXIT, or 'return' to continue: "
"RTN","RMPRPAT1",61,0)
 N % S DIR(0)="SAO^1:PATIENT DEMOGRAPHICS;2:CLINIC ENROLLMENTS/CORRESPONDENCE;3:ENTITLEMENT INFORMATION;4:APPLIANCE TRANSACTIONS;5:AUTO ADAPTIVE INFORMATION;6:CRITICAL COMMENTS;7:ADD/EDIT DISABILITY CODE"
"RTN","RMPRPAT1",62,0)
 I $G(RCNT)=8 S DIR(0)=DIR(0)_";8:HOME OXYGEN ITEMS;"
"RTN","RMPRPAT1",63,0)
 S DIR("?")="Enter a screen number (1-"_$G(RCNT)_") OR '^' TO EXIT."
"RTN","RMPRPAT1",64,0)
 I $D(RFLG) S $P(DIR(0),U,1)="SO" S:$D(DIR("A")) DIR("A")=$P(DIR("A"),":",1)_" " K DIR("?")
"RTN","RMPRPAT1",65,0)
 S RFLG=1
"RTN","RMPRPAT1",66,0)
 Q
"RTN","RMPRPAT2")
0^4^B31418296^B29516719
"RTN","RMPRPAT2",1,0)
RMPRPAT2 ;PHX/RFM/JLT/HNC-DISPLAY PATIENT ITEM ACTIVITY ;10/19/1993
"RTN","RMPRPAT2",2,0)
 ;;3.0;PROSTHETICS;**32,34,29,44,99,75,137,146,162**;Feb 09, 1996;Build 5
"RTN","RMPRPAT2",3,0)
 N BDAT,HITM
"RTN","RMPRPAT2",4,0)
 D HDR N RMPRMERG S RMPRMERG=0
"RTN","RMPRPAT2",5,0)
 S (RA,AN,ANS,RK,RZ)=0 K ^TMP($J,"TT"),^TMP($J,"AG"),IT
"RTN","RMPRPAT2",6,0)
 MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRDFN)
"RTN","RMPRPAT2",7,0)
 ;Check for merged accounts
"RTN","RMPRPAT2",8,0)
 I $D(^XDRM("B",RMPRDFN_";DPT(")) D
"RTN","RMPRPAT2",9,0)
 . S RMPRMERG=$O(^XDRM("B",RMPRDFN_";DPT(",RMPRMERG)) Q:RMPRMERG=""
"RTN","RMPRPAT2",10,0)
 . S RMPRMERG=+^XDRM(RMPRMERG,0) Q:RMPRMERG=0
"RTN","RMPRPAT2",11,0)
 . MERGE ^TMP($J,"TT")=^RMPR(660,"AC",RMPRMERG)
"RTN","RMPRPAT2",12,0)
 S B=0
"RTN","RMPRPAT2",13,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPRPAT2",14,0)
 . S BC=0
"RTN","RMPRPAT2",15,0)
 . F  S BC=$O(^TMP($J,"TT",B,BC)) Q:BC'>0  D
"RTN","RMPRPAT2",16,0)
 . .Q:$P($G(^RMPR(660,BC,0)),U,10)'=RMPR("STA")
"RTN","RMPRPAT2",17,0)
 . .S GN=$P($G(^RMPR(660,BC,"AMS")),U,1)
"RTN","RMPRPAT2",18,0)
 . .S ND=$P($G(^RMPR(660,BC,1)),U,4)
"RTN","RMPRPAT2",19,0)
 . .I ND S ND=$P(^RMPR(661.1,ND,0),U,8)
"RTN","RMPRPAT2",20,0)
 . .S:ND="" ND=2
"RTN","RMPRPAT2",21,0)
 . .S:GN="" GN=BC
"RTN","RMPRPAT2",22,0)
 . .S ^TMP($J,"AG",GN,BC,ND)=B  ;set linked grouper counter structure differently in array;RMPR*3.0*162
"RTN","RMPRPAT2",23,0)
 ;COMBINE ITEMS FOR CALC FLAG
"RTN","RMPRPAT2",24,0)
 ;modified linked grouper structure determination in patch RMPR*3.0*162
"RTN","RMPRPAT2",25,0)
 S B=""
"RTN","RMPRPAT2",26,0)
 F  S B=$O(^TMP($J,"AG",B)),ITM=0,HITM=0 Q:+B=0  D
"RTN","RMPRPAT2",27,0)
 .F  S ITM=$O(^TMP($J,"AG",B,ITM)),BC=0 Q:+ITM=0  D
"RTN","RMPRPAT2",28,0)
 . .F  S BC=$O(^TMP($J,"AG",B,ITM,BC)) Q:+BC=0  D
"RTN","RMPRPAT2",29,0)
 . . .I $P($G(^RMPR(660,ITM,0)),U,17) Q
"RTN","RMPRPAT2",30,0)
 . . .I HITM=0,BC=2 Q
"RTN","RMPRPAT2",31,0)
 . . .I BC=1 S HITM=ITM,BDAT=^TMP($J,"AG",B,ITM,BC),^TMP($J,"TTT",B,HITM,HITM)=HITM
"RTN","RMPRPAT2",32,0)
 . . .S $P(^TMP($J,"TT",BDAT,HITM),U,3)=$P(^TMP($J,"TT",BDAT,HITM),U,3)+$P($G(^RMPR(660,ITM,0)),U,16)
"RTN","RMPRPAT2",33,0)
 . . .I BC=2 S ^TMP($J,"TTT",B,HITM,ITM)=HITM K ^TMP($J,"TT",BDAT,ITM)
"RTN","RMPRPAT2",34,0)
 K ^TMP($J,"AG"),BDC
"RTN","RMPRPAT2",35,0)
 S B=0,RC=1
"RTN","RMPRPAT2",36,0)
 F  S B=$O(^TMP($J,"TT",B)) Q:B'>0  D
"RTN","RMPRPAT2",37,0)
 .S RK=0
"RTN","RMPRPAT2",38,0)
 .F  S RK=$O(^TMP($J,"TT",B,RK)) Q:RK'>0  D
"RTN","RMPRPAT2",39,0)
 . .Q:$D(^RMPO(665.72,"AC",RK))
"RTN","RMPRPAT2",40,0)
 . .S IT(RC)=RK
"RTN","RMPRPAT2",41,0)
 . .I $P(^TMP($J,"TT",B,RK),U,3) S $P(IT(RC),U,3)=$P(^TMP($J,"TT",B,RK),U,3)
"RTN","RMPRPAT2",42,0)
 . .S RC=RC+1
"RTN","RMPRPAT2",43,0)
 S RK=0,RZ=0
"RTN","RMPRPAT2",44,0)
 K B,^TMP($J,"TT")
"RTN","RMPRPAT2",45,0)
 ;
"RTN","RMPRPAT2",46,0)
 G:'$D(IT) END
"RTN","RMPRPAT2",47,0)
DIS ;DISPLAY APPLIANCES OR REPAIRS
"RTN","RMPRPAT2",48,0)
 I $G(RK)="" S RK="",RC=""
"RTN","RMPRPAT2",49,0)
 I (RK+1'>RC)&($G(IT(RK+1))) S RK=RK+1 S AN=+IT(RK),Y=$G(^RMPR(660,AN,0)) G:Y="" EXITD D PRT,OVER:((IOSL-4)<$Y) G:'$D(ANS)!(ANS=U)!($D(DUOUT))!($D(DTOUT)) EXIT G DIS
"RTN","RMPRPAT2",50,0)
END I RC=0 W !,"No Appliances or Repairs exist for this veteran!",!! H 3 G EXIT
"RTN","RMPRPAT2",51,0)
 ;
"RTN","RMPRPAT2",52,0)
 I RC>0 W !!,"End of Appliance/Repair records for this veteran!" D OVER I $G(RK)+1'>$G(RC)&($G(IT($G(RK)+1))) D DIS
"RTN","RMPRPAT2",53,0)
 ;
"RTN","RMPRPAT2",54,0)
EXIT K I,J,L,R0,IT,RA,AMIS,AN,CST,DEL,FL,FRM,ITM,PAGE,QTY,RC,RK,REM
"RTN","RMPRPAT2",55,0)
 K RMPRCNUM,RZ,SN,TRANS,TRANS1,TYPE,VEN
"RTN","RMPRPAT2",56,0)
 K ^TMP($J,"TTT")
"RTN","RMPRPAT2",57,0)
 Q:'$D(RMPRDFN)
"RTN","RMPRPAT2",58,0)
 W !
"RTN","RMPRPAT2",59,0)
 I $D(DUOUT)!($D(DTOUT)) G ASK1^RMPRPAT
"RTN","RMPRPAT2",60,0)
 S FL=4 G ASK2^RMPRPAT
"RTN","RMPRPAT2",61,0)
 Q
"RTN","RMPRPAT2",62,0)
EXITD W !!,"Appliance/Repair record was deleted during view for this veteran",!,"...Enter 'return' to continue." R TYPE:20
"RTN","RMPRPAT2",63,0)
 G EXIT
"RTN","RMPRPAT2",64,0)
PRT S DATE=$P(Y,U,3),TYPE=$P(Y,U,6),QTY=$P(Y,U,7)
"RTN","RMPRPAT2",65,0)
 S VEN=$P(Y,U,9),TRANS=$P(Y,U,4),STA=$P(Y,U,10),SN=$P(Y,U,11)
"RTN","RMPRPAT2",66,0)
 S DEL=$P(Y,U,12)
"RTN","RMPRPAT2",67,0)
 S CST=$S($P(Y,U,16)'="":$P(Y,U,16),$D(^RMPR(660,AN,"LB")):$P(^RMPR(660,AN,"LB"),U,9),1:"")
"RTN","RMPRPAT2",68,0)
 ;lab source of procurement
"RTN","RMPRPAT2",69,0)
 I $D(^RMPR(660,AN,"LB")) S RMPRLPRO=$P(^("LB"),U,3) D
"RTN","RMPRPAT2",70,0)
 .I RMPRLPRO="O" S RMPRLPRO="ORTHOTIC" Q
"RTN","RMPRPAT2",71,0)
 .I RMPRLPRO="R" S RMPRLPRO="RESTORATION" Q
"RTN","RMPRPAT2",72,0)
 .I RMPRLPRO="S" S RMPRLPRO="SHOE" Q
"RTN","RMPRPAT2",73,0)
 .I RMPRLPRO="W" S RMPRLPRO="WHEELCHAIR" Q
"RTN","RMPRPAT2",74,0)
 .I RMPRLPRO="N" S RMPRLPRO="FOOT CENTER" Q
"RTN","RMPRPAT2",75,0)
 .I RMPRLPRO="D" S RMPRLPRO="DDC" Q
"RTN","RMPRPAT2",76,0)
 ;form requested on
"RTN","RMPRPAT2",77,0)
 S FRM=$P(Y,U,13),REM=$P(Y,U,18)
"RTN","RMPRPAT2",78,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RMPRPAT2",79,0)
 S TYPE=$P($G(^RMPR(660,AN,1)),U,4)
"RTN","RMPRPAT2",80,0)
 ;S TYPE=$S(TYPE="":"",$D(^RMPR(661,TYPE,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPAT2",81,0)
 S AMIS=$P(Y,U,15),VEN=$S(VEN="":"",$D(^PRC(440,VEN,0)):$P(^(0),U,1),1:"")
"RTN","RMPRPAT2",82,0)
 I $D(^RMPR(660.1,"AC",AN)),$P(^RMPR(660.1,$O(^RMPR(660.1,"AC",AN,0)),0),U,11)]"" S AMIS=AMIS_"+"
"RTN","RMPRPAT2",83,0)
 S TRANS=$S(TRANS]"":TRANS,1:""),TRANS1="" S:TRANS="X" TRANS1=TRANS,TRANS=""
"RTN","RMPRPAT2",84,0)
 S DEL=$E(DEL,4,5)_"/"_$E(DEL,6,7)_"/"_$E(DEL,2,3) S:DEL="//" DEL=""
"RTN","RMPRPAT2",85,0)
 W !,RK,". ",DATE,?13,QTY,?17
"RTN","RMPRPAT2",86,0)
 ;W AMIS_$S(TYPE'="":$E($P(^PRC(441,TYPE,0),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPAT2",87,0)
 W AMIS_$S(TYPE'="":$E($P($G(^RMPR(661.1,TYPE,0)),U,2),1,10),$P(Y,U,26)="D":"DELIVERY",$P(Y,U,26)="P":"PICKUP",$P(Y,U,17):"SHIPPING",1:"")
"RTN","RMPRPAT2",88,0)
 ;historical item
"RTN","RMPRPAT2",89,0)
 I TYPE=""&($D(^RMPR(660,$P(IT(RK),U,1),"HST"))) W $E($P(^("HST"),U,1),1,10)
"RTN","RMPRPAT2",90,0)
 W ?30,TRANS,?31,TRANS1
"RTN","RMPRPAT2",91,0)
 ;display source of procurement for 2529-3 under vendor header
"RTN","RMPRPAT2",92,0)
 I $D(RMPRLPRO) W ?33,RMPRLPRO
"RTN","RMPRPAT2",93,0)
 ;I '$D(RMPRLPRO),VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPRPAT2",94,0)
 I VEN'="" W ?33,$E(VEN,1,10)
"RTN","RMPRPAT2",95,0)
 K RMPRLPRO
"RTN","RMPRPAT2",96,0)
 ;historical vendor
"RTN","RMPRPAT2",97,0)
 W:$D(^RMPR(660,$P(IT(RK),U,1),"HST")) $E($P(^("HST"),U,3),1,10)
"RTN","RMPRPAT2",98,0)
 W:STA'="" ?45,$P(^DIC(4,STA,99),U,1)
"RTN","RMPRPAT2",99,0)
 W ?50,$E(SN,1,9),?60,DEL
"RTN","RMPRPAT2",100,0)
 I $P(IT(RK),U,3) S CST=$P(IT(RK),U,3)
"RTN","RMPRPAT2",101,0)
 W ?71,$J($FN($S(CST'="":CST,$P(Y,U,17):$P(Y,U,17),1:""),"T",2),9)
"RTN","RMPRPAT2",102,0)
 W:REM]"" !,?3,REM
"RTN","RMPRPAT2",103,0)
 I $P(IT(RK),U,2)="" S $P(IT(RK),U,2)=RZ
"RTN","RMPRPAT2",104,0)
 Q
"RTN","RMPRPAT2",105,0)
OVER ;
"RTN","RMPRPAT2",106,0)
 N ANS
"RTN","RMPRPAT2",107,0)
 S RZ=RK W !,"+=Turned-In  *=Historical Data  I=Initial  X=Repair  S=Spare  R=Replacement",!,"Enter 1-",RK," to show full entry, '^' to exit or `return` to continue.  " R ANS:DTIME S:'$T ANS="^"
"RTN","RMPRPAT2",108,0)
 I ANS="^^" S ANS="^" S DUOUT=1 Q  ;modified escape as it left a DO loop hanging due to GOTO, patch RMPR*3.0*162
"RTN","RMPRPAT2",109,0)
 I ANS="^" S DUOUT=1 Q   ;modified escape as it left a DO loop hanging due to GOTO, patch RMPR*3.0*162
"RTN","RMPRPAT2",110,0)
 I ANS="",RK+1'>RC&($G(IT(RK+1))) D HDR Q
"RTN","RMPRPAT2",111,0)
 I ANS="" Q
"RTN","RMPRPAT2",112,0)
 I ANS'?1N.N!(ANS>RK)!(+ANS=0)!(+ANS'=ANS) W $C(7),!," Must be between 1 and ",RK," to be valid" G OVER
"RTN","RMPRPAT2",113,0)
 I ANS>0,(ANS<(RK+1)) S AN=ANS,RZ=RK D ^RMPRPAT3
"RTN","RMPRPAT2",114,0)
 S RK=$P(IT(ANS),U,2)
"RTN","RMPRPAT2",115,0)
 Q
"RTN","RMPRPAT2",116,0)
HDR ;Print Header, Screen 4
"RTN","RMPRPAT2",117,0)
 W @IOF
"RTN","RMPRPAT2",118,0)
 S PAGE=3
"RTN","RMPRPAT2",119,0)
 W !,$E(RMPRNAM,1,20),?23,"SSN: "
"RTN","RMPRPAT2",120,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPRPAT2",121,0)
 W ?42,"DOB: "
"RTN","RMPRPAT2",122,0)
 S Y=RMPRDOB X ^DD("DD") W Y K Y
"RTN","RMPRPAT2",123,0)
 W ?61,"CLAIM# ",$G(RMPRCNUM)
"RTN","RMPRPAT2",124,0)
 W !?4,"Date",?12,"Qty",?19,"HCPCS",?28,"Type",?34,"Vendor",?45,"Sta",?50,"Serial",?58,"Delivery Date",?72,"Tot Cost"
"RTN","RMPRPAT2",125,0)
 Q
"RTN","RMPRPAT3")
0^5^B40605335^B39519148
"RTN","RMPRPAT3",1,0)
RMPRPAT3 ;HINES-CIOFO/HNC,RVD - Detail Display Patient 10-2319 Transaction ;11/03/04
"RTN","RMPRPAT3",2,0)
 ;;3.0;PROSTHETICS;**3,12,25,28,32,41,69,92,99,90,162**;Feb 09, 1996;Build 5
"RTN","RMPRPAT3",3,0)
 ;
"RTN","RMPRPAT3",4,0)
 ; RVD 4/30/02 patch #69 - add ICD-9 CODE and description in the display.
"RTN","RMPRPAT3",5,0)
 ;                         add HCPCS and Short Description.
"RTN","RMPRPAT3",6,0)
 ; AAC 08/03/04 Patch 92 - Code Set Versioning (CSV)
"RTN","RMPRPAT3",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPRPAT3",8,0)
 ;
"RTN","RMPRPAT3",9,0)
 ;expect ANS,IT(ANS)
"RTN","RMPRPAT3",10,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPRPAT3",11,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPRPAT3",12,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPRPAT3",13,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPRPAT3",14,0)
 ;    RMPRDOB
"RTN","RMPRPAT3",15,0)
 ;display detailed record
"RTN","RMPRPAT3",16,0)
PRINT ;called from RMPRPAT2
"RTN","RMPRPAT3",17,0)
 ;get 2319 transaction
"RTN","RMPRPAT3",18,0)
 ;
"RTN","RMPRPAT3",19,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV,DESCRPT
"RTN","RMPRPAT3",20,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPRPAT3",21,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPRPAT3",22,0)
 D EN^DIQ1
"RTN","RMPRPAT3",23,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPRPAT3",24,0)
 ;get vendor info
"RTN","RMPRPAT3",25,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",26,0)
 I DA D
"RTN","RMPRPAT3",27,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPRPAT3",28,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",29,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",30,0)
 ;
"RTN","RMPRPAT3",31,0)
 ;array defined for record in following format:
"RTN","RMPRPAT3",32,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",33,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",34,0)
 ;example:
"RTN","RMPRPAT3",35,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPRPAT3",36,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPRPAT3",37,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPRPAT3",38,0)
 ;
"RTN","RMPRPAT3",39,0)
 D HDR
"RTN","RMPRPAT3",40,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPRPAT3",41,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPRPAT3",42,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPRPAT3",43,0)
 ;historical/original item
"RTN","RMPRPAT3",44,0)
 ;W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",45,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPRPAT3",46,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPRPAT3",47,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPRPAT3",48,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPRPAT3",49,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPRPAT3",50,0)
 ;vendor tracking number
"RTN","RMPRPAT3",51,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPRPAT3",52,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPRPAT3",53,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPRPAT3",54,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPRPAT3",55,0)
 I $D(RV) D
"RTN","RMPRPAT3",56,0)
 .W !,"VENDOR PHONE: ",?15,$G(RV(440,RMPRV,5,"E"))
"RTN","RMPRPAT3",57,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPRPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPRPAT3",59,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPRPAT3",60,0)
 W !,"DELIVERY DATE: "
"RTN","RMPRPAT3",61,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPRPAT3",62,0)
 W !
"RTN","RMPRPAT3",63,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPRPAT3",64,0)
 .W "TOTAL COST: "
"RTN","RMPRPAT3",65,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPRPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPRPAT3",67,0)
 W ?30,"OBL: ",$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPRPAT3",68,0)
 ;
"RTN","RMPRPAT3",69,0)
 ;lab data
"RTN","RMPRPAT3",70,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPRPAT3",71,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPRPAT3",72,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPRPAT3",73,0)
 .Q:DA=""
"RTN","RMPRPAT3",74,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPRPAT3",75,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",76,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPRPAT3",77,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPRPAT3",78,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPRPAT3",79,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPRPAT3",80,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPRPAT3",81,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPRPAT3",82,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPRPAT3",83,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPRPAT3",84,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPRPAT3",85,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPRPAT3",86,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPRPAT3",87,0)
 ;
"RTN","RMPRPAT3",88,0)
 ;historical data
"RTN","RMPRPAT3",89,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPRPAT3",90,0)
 .;include records that have been merged
"RTN","RMPRPAT3",91,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPRPAT3",92,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPRPAT3",93,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",94,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPRPAT3",95,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E")),"   PHONE: ",$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPRPAT3",96,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPRPAT3",97,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPRPAT3",98,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPRPAT3",99,0)
 ;lab amis
"RTN","RMPRPAT3",100,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPRPAT3",101,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPRPAT3",102,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPRPAT3",103,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPRPAT3",104,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPRPAT3",105,0)
 ;purchasing and issue from stock amis
"RTN","RMPRPAT3",106,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPRPAT3",107,0)
 ;appliance/item information
"RTN","RMPRPAT3",108,0)
 ;historical/original item
"RTN","RMPRPAT3",109,0)
 W !,"ITEM DESCRIPTION: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",110,0)
 ;check for item description changes
"RTN","RMPRPAT3",111,0)
 I $G(R19(660,RMPRDA,89,"E"))'=$G(R19(660,RMPRDA,4,"E")) W !,"*** See Above For Original Item Description ***"
"RTN","RMPRPAT3",112,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPRPAT3",113,0)
 W !,"CONTRACT #: ",$G(R19(660,RMPRDA,38.7,"E"))
"RTN","RMPRPAT3",114,0)
 W !,"EXCLUDED/WAIVER: ",$G(R19(660,RMPRDA,38.1,"E"))
"RTN","RMPRPAT3",115,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPRPAT3",116,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPRPAT3",117,0)
 ;added by #69
"RTN","RMPRPAT3",118,0)
 ;
"RTN","RMPRPAT3",119,0)
 ; PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRPAT3",120,0)
 ; AAC      - 08/03/04
"RTN","RMPRPAT3",121,0)
 ;
"RTN","RMPRPAT3",122,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRPAT3",123,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPRPAT3",124,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPRPAT3",125,0)
 I RMPRIC9'="" D
"RTN","RMPRPAT3",126,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRPAT3",127,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRPAT3",128,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRPAT3",129,0)
 W !,"ICD-9 Code: "
"RTN","RMPRPAT3",130,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRPAT3",131,0)
 ;
"RTN","RMPRPAT3",132,0)
 ; End of Patch 92
"RTN","RMPRPAT3",133,0)
 ;
"RTN","RMPRPAT3",134,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPRPAT3",135,0)
 ;set description and modify for SHIPPING CHARGE; patch RMPR*3.0*162
"RTN","RMPRPAT3",136,0)
 S DESCRPT=$G(R19(660,RMPRDA,24,"E")) S:$P(^RMPR(660,RMPRDA,0),U,17) DESCRPT="SHIPPING CHARGE"
"RTN","RMPRPAT3",137,0)
 W !,"DESCRIPTION: ",DESCRPT
"RTN","RMPRPAT3",138,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",139,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPRPAT3",140,0)
 .N R28
"RTN","RMPRPAT3",141,0)
 .;command part of new standards
"RTN","RMPRPAT3",142,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPRPAT3",143,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",144,0)
 .D EN^DDIOL(.R28)
"RTN","RMPRPAT3",145,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPRPAT3",146,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPRPAT3",147,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPRPAT3",148,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPRPAT3",149,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPRPAT3",150,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPRPAT3",151,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPRPAT3",152,0)
 .N DIC
"RTN","RMPRPAT3",153,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPRPAT3",154,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPRPAT3",155,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPRPAT3",156,0)
 ;return from work order
"RTN","RMPRPAT3",157,0)
 G EXIT
"RTN","RMPRPAT3",158,0)
 ;
"RTN","RMPRPAT3",159,0)
HDR ;display heading
"RTN","RMPRPAT3",160,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPRPAT3",161,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPRPAT3",162,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPRPAT3",163,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPRPAT3",164,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPRPAT3",165,0)
 Q
"RTN","RMPRPAT3",166,0)
EXIT ;common exit point
"RTN","RMPRPAT3",167,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPRPAT3",168,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPRPAT3",169,0)
 ;duout,dtout is evaluated in dis+1^rmprpat2
"RTN","RMPRPAT3",170,0)
EX1 ;back out through that point to clean up
"RTN","RMPRPAT3",171,0)
 K R19,RV,RMPRICD,RMPRIC9,RMPRICD,RMPRIC9,MSGICD,RMPRCOD,RMPRERR,RMPRDAT,Y W @IOF
"RTN","RMPRPAT3",172,0)
 Q
"RTN","RMPRPAT3",173,0)
 ;end
"RTN","RMPRPAT7")
0^6^B2616702^B1666656
"RTN","RMPRPAT7",1,0)
RMPRPAT7 ;HINES-CIOFO/HNC DISPLAY NPPD KEY ITEMS CONSOLIDATED
"RTN","RMPRPAT7",2,0)
 ;;3.0;PROSTHETICS;**32,34,35,77,162**;Feb 14, 1998;Build 5
"RTN","RMPRPAT7",3,0)
 ;;
"RTN","RMPRPAT7",4,0)
 ;RVD 3/18/03 patch #77 - only prints item for the same pt.
"RTN","RMPRPAT7",5,0)
 N HCHCPS,HCHCPSD
"RTN","RMPRPAT7",6,0)
 W !,?5,"PSAS HCPCS",?18,"DESCRIPTION",?48,"QTY",?52,"COST",?62,"ITEM"
"RTN","RMPRPAT7",7,0)
 W !,RMPR("L") S HCTOT=0
"RTN","RMPRPAT7",8,0)
 S HCREC=$P(IT(AN),U,1) Q:HCREC'>0
"RTN","RMPRPAT7",9,0)
 S HC=$G(R19(660,HCREC,68,"E")) Q:HC=""
"RTN","RMPRPAT7",10,0)
 S HC1=0
"RTN","RMPRPAT7",11,0)
 F  S HC1=$O(^TMP($J,"TTT",HC,HCREC,HC1)) Q:HC1'>0  D
"RTN","RMPRPAT7",12,0)
 .Q:$P($G(^RMPR(660,HC1,0)),U,10)'=RMPR("STA")  ;QUIT if different station;RMPR*3.0*162
"RTN","RMPRPAT7",13,0)
 .S (HCHCPS,HCHCPSD)=""
"RTN","RMPRPAT7",14,0)
 .I $P(^RMPR(660,HC1,0),U,2)'=RMPRDFN Q
"RTN","RMPRPAT7",15,0)
 .S HCQTY=$P(^RMPR(660,HC1,0),U,7)
"RTN","RMPRPAT7",16,0)
 .S HCCOST=$P(^RMPR(660,HC1,0),U,16)
"RTN","RMPRPAT7",17,0)
 .S HCTOT=HCTOT+HCCOST
"RTN","RMPRPAT7",18,0)
 .S HCRK=$P(^RMPR(660,HC1,0),U,6)
"RTN","RMPRPAT7",19,0)
 .I HCRK S HCRK=$P(^RMPR(661,HCRK,0),U,1),HCRK=$P(^PRC(441,HCRK,0),U,2)
"RTN","RMPRPAT7",20,0)
 .S HCHCP=$P($G(^RMPR(660,HC1,1)),U,4)
"RTN","RMPRPAT7",21,0)
 .I HCHCP S HCHCPS=$P(^RMPR(661.1,HCHCP,0),U,1),HCHCPSD=$P(^(0),U,2)
"RTN","RMPRPAT7",22,0)
 .I $P(^RMPR(660,HC1,0),U,17) S HCHCPSD="SHIPPING"  ;modify descrip to shipping charge;RMPR*3.0*162
"RTN","RMPRPAT7",23,0)
 .W !,?5,$G(HCHCPS),?18,$G(HCHCPSD)
"RTN","RMPRPAT7",24,0)
 .W ?48,HCQTY
"RTN","RMPRPAT7",25,0)
 .W ?52,"$"_$J($FN(HCCOST,"P",2),9)
"RTN","RMPRPAT7",26,0)
 .W ?62,$E(HCRK,1,18)
"RTN","RMPRPAT7",27,0)
 W !,?52,"========="
"RTN","RMPRPAT7",28,0)
 W !,?52,"$"_$J($FN(HCTOT,"P",2),9)
"RTN","RMPRPAT7",29,0)
 ;END
"VER")
8.0^22.0
"BLD",7711,6)
^142
**END**
**END**
