Released LR*5.2*408 SEQ #323
Extracted from mail message
**KIDS**:LR*5.2*408^

**INSTALL NAME**
LR*5.2*408
"BLD",7402,0)
LR*5.2*408^LAB SERVICE^0^3110407^y
"BLD",7402,4,0)
^9.64PA^6003^2
"BLD",7402,4,6003,0)
6003
"BLD",7402,4,6003,222)
y^y^f^^n^^y^a^n
"BLD",7402,4,6009,0)
6009
"BLD",7402,4,6009,222)
y^y^f^^n^^y^a^n
"BLD",7402,4,"B",6003,6003)

"BLD",7402,4,"B",6009,6009)

"BLD",7402,6.3)
8
"BLD",7402,"INID")
^y
"BLD",7402,"INIT")
LR408
"BLD",7402,"KRN",0)
^9.67PA^779.2^20
"BLD",7402,"KRN",.4,0)
.4
"BLD",7402,"KRN",.401,0)
.401
"BLD",7402,"KRN",.402,0)
.402
"BLD",7402,"KRN",.403,0)
.403
"BLD",7402,"KRN",.5,0)
.5
"BLD",7402,"KRN",.84,0)
.84
"BLD",7402,"KRN",3.6,0)
3.6
"BLD",7402,"KRN",3.8,0)
3.8
"BLD",7402,"KRN",9.2,0)
9.2
"BLD",7402,"KRN",9.8,0)
9.8
"BLD",7402,"KRN",9.8,"NM",0)
^9.68A^40^39
"BLD",7402,"KRN",9.8,"NM",1,0)
LRBLDC^^0^B18272496
"BLD",7402,"KRN",9.8,"NM",2,0)
LRBLDCU^^0^B6930637
"BLD",7402,"KRN",9.8,"NM",3,0)
LRBLDED^^0^B7884301
"BLD",7402,"KRN",9.8,"NM",4,0)
LRBLDEL^^0^B12432038
"BLD",7402,"KRN",9.8,"NM",5,0)
LRBLDK^^0^B4995737
"BLD",7402,"KRN",9.8,"NM",6,0)
LRBLDLG^^0^B24862807
"BLD",7402,"KRN",9.8,"NM",7,0)
LRBLDMV^^0^B8139587
"BLD",7402,"KRN",9.8,"NM",8,0)
LRBLDPH^^0^B12502276
"BLD",7402,"KRN",9.8,"NM",9,0)
LRBLDR^^0^B20207748
"BLD",7402,"KRN",9.8,"NM",10,0)
LRBLDRR^^0^B25500537
"BLD",7402,"KRN",9.8,"NM",11,0)
LRBLDT^^0^B19003681
"BLD",7402,"KRN",9.8,"NM",12,0)
LRBLDUC^^0^B6977505
"BLD",7402,"KRN",9.8,"NM",13,0)
LRBLDX^^0^B6297985
"BLD",7402,"KRN",9.8,"NM",14,0)
LRBLJA^^0^B22277627
"BLD",7402,"KRN",9.8,"NM",15,0)
LRBLJCK^^0^B13736751
"BLD",7402,"KRN",9.8,"NM",16,0)
LRBLJD^^0^B17555322
"BLD",7402,"KRN",9.8,"NM",17,0)
LRBLJED^^0^B19911409
"BLD",7402,"KRN",9.8,"NM",18,0)
LRBLJL^^0^B32065813
"BLD",7402,"KRN",9.8,"NM",19,0)
LRBLJLA^^0^B12968369
"BLD",7402,"KRN",9.8,"NM",20,0)
LRBLJLG^^0^B33508403
"BLD",7402,"KRN",9.8,"NM",21,0)
LRBLJM^^0^B7598421
"BLD",7402,"KRN",9.8,"NM",22,0)
LRBLJR^^0^B11560523
"BLD",7402,"KRN",9.8,"NM",23,0)
LRBLJSH^^0^B13303384
"BLD",7402,"KRN",9.8,"NM",24,0)
LRBLJT^^0^B12324211
"BLD",7402,"KRN",9.8,"NM",25,0)
LRBLJW^^0^B15926526
"BLD",7402,"KRN",9.8,"NM",26,0)
LRBLP^^0^B23154871
"BLD",7402,"KRN",9.8,"NM",27,0)
LRBLPCS^^0^B18635044
"BLD",7402,"KRN",9.8,"NM",28,0)
LRBLPE^^0^B16485111
"BLD",7402,"KRN",9.8,"NM",29,0)
LRBLPED^^0^B30696766
"BLD",7402,"KRN",9.8,"NM",30,0)
LRBLPH^^0^B4630075
"BLD",7402,"KRN",9.8,"NM",31,0)
LRBLPQA^^0^B11222268
"BLD",7402,"KRN",9.8,"NM",32,0)
LRBLPT^^0^B11913257
"BLD",7402,"KRN",9.8,"NM",33,0)
LRBLPUS^^0^B22233347
"BLD",7402,"KRN",9.8,"NM",34,0)
LRBLPX^^0^B24148620
"BLD",7402,"KRN",9.8,"NM",35,0)
LRBLS^^0^B20867231
"BLD",7402,"KRN",9.8,"NM",36,0)
LRBLST^^0^B4239069
"BLD",7402,"KRN",9.8,"NM",37,0)
LRBLTX^^0^B19105208
"BLD",7402,"KRN",9.8,"NM",38,0)
LRBLVAL^^0^B825391
"BLD",7402,"KRN",9.8,"NM",40,0)
LRUWG^^0^B14796767
"BLD",7402,"KRN",9.8,"NM","B","LRBLDC",1)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDCU",2)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDED",3)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDEL",4)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDK",5)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDLG",6)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDMV",7)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDPH",8)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDR",9)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDRR",10)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDT",11)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDUC",12)

"BLD",7402,"KRN",9.8,"NM","B","LRBLDX",13)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJA",14)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJCK",15)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJD",16)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJED",17)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJL",18)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJLA",19)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJLG",20)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJM",21)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJR",22)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJSH",23)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJT",24)

"BLD",7402,"KRN",9.8,"NM","B","LRBLJW",25)

"BLD",7402,"KRN",9.8,"NM","B","LRBLP",26)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPCS",27)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPE",28)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPED",29)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPH",30)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPQA",31)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPT",32)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPUS",33)

"BLD",7402,"KRN",9.8,"NM","B","LRBLPX",34)

"BLD",7402,"KRN",9.8,"NM","B","LRBLS",35)

"BLD",7402,"KRN",9.8,"NM","B","LRBLST",36)

"BLD",7402,"KRN",9.8,"NM","B","LRBLTX",37)

"BLD",7402,"KRN",9.8,"NM","B","LRBLVAL",38)

"BLD",7402,"KRN",9.8,"NM","B","LRUWG",40)

"BLD",7402,"KRN",19,0)
19
"BLD",7402,"KRN",19.1,0)
19.1
"BLD",7402,"KRN",101,0)
101
"BLD",7402,"KRN",409.61,0)
409.61
"BLD",7402,"KRN",771,0)
771
"BLD",7402,"KRN",779.2,0)
779.2
"BLD",7402,"KRN",870,0)
870
"BLD",7402,"KRN",8989.51,0)
8989.51
"BLD",7402,"KRN",8989.52,0)
8989.52
"BLD",7402,"KRN",8994,0)
8994
"BLD",7402,"KRN","B",.4,.4)

"BLD",7402,"KRN","B",.401,.401)

"BLD",7402,"KRN","B",.402,.402)

"BLD",7402,"KRN","B",.403,.403)

"BLD",7402,"KRN","B",.5,.5)

"BLD",7402,"KRN","B",.84,.84)

"BLD",7402,"KRN","B",3.6,3.6)

"BLD",7402,"KRN","B",3.8,3.8)

"BLD",7402,"KRN","B",9.2,9.2)

"BLD",7402,"KRN","B",9.8,9.8)

"BLD",7402,"KRN","B",19,19)

"BLD",7402,"KRN","B",19.1,19.1)

"BLD",7402,"KRN","B",101,101)

"BLD",7402,"KRN","B",409.61,409.61)

"BLD",7402,"KRN","B",771,771)

"BLD",7402,"KRN","B",779.2,779.2)

"BLD",7402,"KRN","B",870,870)

"BLD",7402,"KRN","B",8989.51,8989.51)

"BLD",7402,"KRN","B",8989.52,8989.52)

"BLD",7402,"KRN","B",8994,8994)

"BLD",7402,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",7402,"QUES",0)
^9.62^^
"BLD",7402,"REQB",0)
^9.611^^0
"DATA",6003,1,0)
LRBLAD
"DATA",6003,1,1,0)
^6003.01^2^2^3110405^^^
"DATA",6003,1,1,1,0)
Prints data changes from one date to another in order to provide an audit  
"DATA",6003,1,1,2,0)
trail for changes in 'verified' data.
"DATA",6003,2,0)
LRBLAR
"DATA",6003,2,1,0)
^^2^2^3020927^^
"DATA",6003,2,1,1,0)
Deletes old data change audits from one date to another once a hard copy
"DATA",6003,2,1,2,0)
has been generated.
"DATA",6003,3,0)
LRBLDA
"DATA",6003,3,1,0)
^^1^1^3020927^^^^
"DATA",6003,3,1,1,0)
Allows editing of data relating to donor collection or deferrals
"DATA",6003,4,0)
LRBLDAWARD
"DATA",6003,4,1,0)
^^4^4^3020927^^^
"DATA",6003,4,1,1,0)
If new award is to be given a blood donor then 'YES' will be on
"DATA",6003,4,1,2,0)
 record.  After award is given the entry should be deleted.
"DATA",6003,4,1,3,0)
 Deletion will trigger the TOTAL AWARD field in file 65.5 and
"DATA",6003,4,1,4,0)
 increment the total by 1.
"DATA",6003,5,0)
LRBLDC
"DATA",6003,5,1,0)
^^1^1^3020927^^^
"DATA",6003,5,1,1,0)
Entry of blood donor collection data for a specific donation attempt.
"DATA",6003,6,0)
LRBLDCP
"DATA",6003,6,1,0)
^^2^2^3020927^^^
"DATA",6003,6,1,1,0)
Enter information from the most recent donation regarding component
"DATA",6003,6,1,2,0)
 preparation or collection disposition.
"DATA",6003,7,0)
LRBLDCU
"DATA",6003,7,1,0)
^^3^3^3020927^^
"DATA",6003,7,1,1,0)
Calculates cumulative weighted donations for blood donor. (If a donation of
"DATA",6003,7,1,2,0)
 whole blood is given a weight of 1, and cytopheresis may be given a
"DATA",6003,7,1,3,0)
 weight of 4.)
"DATA",6003,8,0)
LRBLDCX
"DATA",6003,8,1,0)
^^1^1^3020927^^
"DATA",6003,8,1,1,0)
Allows editing of blood donor consent on the History, physical & consent form for a donation.
"DATA",6003,9,0)
LRBLDD
"DATA",6003,9,1,0)
^^1^1^3020927^^^
"DATA",6003,9,1,1,0)
Enter/edit blood donor demographics for a donor already in the Donor file.
"DATA",6003,10,0)
LRBLDDAT
"DATA",6003,10,1,0)
^^1^1^3020927^^^
"DATA",6003,10,1,1,0)
Entry of ABO group and Rh type testing results of blood donor units
"DATA",6003,11,0)
LRBLDEDIT
"DATA",6003,11,1,0)
^^2^2^3020927^^^^
"DATA",6003,11,1,1,0)
Allows editing of blood donor group and type if blood bank
"DATA",6003,11,1,2,0)
 supervisor's key is held.
"DATA",6003,12,0)
LRBLDEF
"DATA",6003,12,1,0)
^^4^4^3020927^^^
"DATA",6003,12,1,1,0)
Allows entering or editing permanent deferral for a blood donor
"DATA",6003,12,1,2,0)
 and asks the reason(s) for permanent deferral.
"DATA",6003,12,1,3,0)
 Only users with the blood bank supervisor key can use this
"DATA",6003,12,1,4,0)
 option.
"DATA",6003,13,0)
LRBLDK
"DATA",6003,13,1,0)
^^1^1^3020927^^^
"DATA",6003,13,1,1,0)
Removes ex-blood donors from the blood donor file, once a hard copy has been printed.
"DATA",6003,14,0)
LRBLDLG
"DATA",6003,14,1,0)
^^1^1^3020927^^^
"DATA",6003,14,1,1,0)
Entry of blood donor registration data.
"DATA",6003,15,0)
LRBLDLT
"DATA",6003,15,1,0)
^^2^2^3020927^^
"DATA",6003,15,1,1,0)
Enter or edit letters to blood donors for recruitment,
"DATA",6003,15,1,2,0)
 appreciation, etc.
"DATA",6003,16,0)
LRBLDMV
"DATA",6003,16,1,0)
^^1^1^3020927^
"DATA",6003,16,1,1,0)
Allows a user holding the LRBLSUPER key to move a blood donation from one donor to another.
"DATA",6003,17,0)
LRBLDO
"DATA",6003,17,1,0)
^^1^1^3030815^
"DATA",6003,17,1,1,0)
Enter old blood donor records into the database.
"DATA",6003,18,0)
LRBLDPH
"DATA",6003,18,1,0)
^^1^1^3020927^^^
"DATA",6003,18,1,1,0)
Enter the blood donor phenotyping (non ABO/Rh) test results
"DATA",6003,19,0)
LRBLDR
"DATA",6003,19,1,0)
^^2^2^3020927^^^^
"DATA",6003,19,1,1,0)
Print the donor history, physical and consent form for recording information
"DATA",6003,19,1,2,0)
regarding each specific donation attempt.
"DATA",6003,20,0)
LRBLDRR
"DATA",6003,20,1,0)
^^2^2^3020927^^^^
"DATA",6003,20,1,1,0)
Allows reviewing of tests performed on blood donation, records labeling and
"DATA",6003,20,1,2,0)
 releasing of components into the inventory file.
"DATA",6003,21,0)
LRBLDT
"DATA",6003,21,1,0)
^^1^1^3020927^^
"DATA",6003,21,1,1,0)
Stores results of lab tests (other than ABO/Rh) on blood donations.
"DATA",6003,22,0)
LRBLDUC
"DATA",6003,22,1,0)
^^1^1^3020927^
"DATA",6003,22,1,1,0)
Donor unit ABO/Rh recheck.
"DATA",6003,23,0)
LRBLIDN
"DATA",6003,23,1,0)
^^2^2^3020927^^^^
"DATA",6003,23,1,1,0)
Enter disposition of blood component units in inventory that have
"DATA",6003,23,1,2,0)
 a disposition other than transfused.
"DATA",6003,24,0)
LRBLIDR
"DATA",6003,24,1,0)
^^1^1^3020927^^^^
"DATA",6003,24,1,1,0)
Enter the information for the relocation of a blood component unit.
"DATA",6003,25,0)
LRBLILA
"DATA",6003,25,1,0)
^^2^2^3020927^^^^
"DATA",6003,25,1,1,0)
This option prints labels to be pasted to UNIT CAUTION TAGS
"DATA",6003,25,1,2,0)
 (VA Form 10-2984). The tag MUST still be initialed by tech.
"DATA",6003,26,0)
LRBLILR
"DATA",6003,26,1,0)
^^1^1^3020927^^^^
"DATA",6003,26,1,1,0)
Log-in blood component units in the blood inventory file (#65).
"DATA",6003,27,0)
LRBLILS
"DATA",6003,27,1,0)
^^1^1^3020927^^^
"DATA",6003,27,1,1,0)
Enter any additional typing charges for blood component units in inventory.
"DATA",6003,28,0)
LRBLISH
"DATA",6003,28,1,0)
^^1^1^3020927^^
"DATA",6003,28,1,1,0)
Prints units shipped to other facilities
"DATA",6003,29,0)
LRBLIUC
"DATA",6003,29,1,0)
^^1^1^3020927^^^
"DATA",6003,29,1,1,0)
Enter results of confirmation testing for the ABO/Rh of blood component units in inventory.
"DATA",6003,30,0)
LRBLIUP
"DATA",6003,30,1,0)
^^1^1^3020927^^^^
"DATA",6003,30,1,1,0)
Enter non ABO/Rh phenotypes of blood component units in inventory.
"DATA",6003,31,0)
LRBLIUR
"DATA",6003,31,1,0)
^^2^2^3020927^^^
"DATA",6003,31,1,1,0)
Enter units released (those no longer needed to be kept on crossmatch)
"DATA",6003,31,1,2,0)
to allow the units to be returned to available stock.
"DATA",6003,32,0)
LRBLIW
"DATA",6003,32,1,0)
^^3^3^3020927^^^
"DATA",6003,32,1,1,0)
Prints entries for repeat ABO/Rh testing from inventory which are
"DATA",6003,32,1,2,0)
 automatically put in a queue when a unit is logged-in under inventory
"DATA",6003,32,1,3,0)
 log-in if the unit requires a crossmatch.
"DATA",6003,33,0)
LRBLJM
"DATA",6003,33,1,0)
^^3^3^3020927^
"DATA",6003,33,1,1,0)
Allows adding or removing a unit to a pooled blood product 
"DATA",6003,33,1,2,0)
or deletion of the pooled product if the pool has no 
"DATA",6003,33,1,3,0)
disposition.
"DATA",6003,34,0)
LRBLJTR
"DATA",6003,34,1,0)
^^2^2^3020927^
"DATA",6003,34,1,1,0)
Transfers unit from one division to another.
"DATA",6003,34,1,2,0)
 Record of transfer is kept in field 999 of file 65.
"DATA",6003,35,0)
LRBLPC
"DATA",6003,35,1,0)
^^2^2^3030321^
"DATA",6003,35,1,1,0)
Request blood component for patient, select units from inventory and 
"DATA",6003,35,1,2,0)
enter results of crossmatching units with patient's blood sample.
"DATA",6003,36,0)
LRBLPH
"DATA",6003,36,1,0)
^^1^1^3030321^
"DATA",6003,36,1,1,0)
Enter test data for blood bank patient.
"DATA",6003,37,0)
LRBLPCS
"DATA",6003,37,1,0)
^^1^1^3020927^^^
"DATA",6003,37,1,1,0)
Enter blood component requests for a patient.
"DATA",6003,38,0)
LRBLPED
"DATA",6003,38,1,0)
^^1^1^3020927^
"DATA",6003,38,1,1,0)
Prepare pediatric units from existing units in inventory
"DATA",6003,39,0)
LRBLPEDIT
"DATA",6003,39,1,0)
^^2^2^3020927^^
"DATA",6003,39,1,1,0)
Allows editing patient ABO/Rh if user holds blood bank
"DATA",6003,39,1,2,0)
 supervisor key.
"DATA",6003,40,0)
LRBLPER
"DATA",6003,40,1,0)
^^1^1^3020927^^^^
"DATA",6003,40,1,1,0)
Enter old blood bank records for a patient
"DATA",6003,41,0)
LRBLPET
"DATA",6003,41,1,0)
^^1^1^3020927^^^^
"DATA",6003,41,1,1,0)
Enter test data for blood bank patient.
"DATA",6003,42,0)
LRBLPIC
"DATA",6003,42,1,0)
^^2^2^3020927^^^
"DATA",6003,42,1,1,0)
This option allows selecting blood component units in inventory for
"DATA",6003,42,1,2,0)
 a patient.
"DATA",6003,43,0)
LRBLPLOGIN
"DATA",6003,43,1,0)
^6003.01^1^1^3110405^^^^
"DATA",6003,43,1,1,0)
Log-in blood sample from a patient for blood bank tests and procedures.
"DATA",6003,44,0)
LRBLPOST
"DATA",6003,44,1,0)
^^1^1^3030815^
"DATA",6003,44,1,1,0)
Converts entries in file 81, field 66, to file 66.5.
"DATA",6003,45,0)
LRBLPSI
"DATA",6003,45,1,0)
^^2^2^3020927^^^^
"DATA",6003,45,1,1,0)
Special instructions for blood bank if patient has antibody
"DATA",6003,45,1,2,0)
 or other transfusion problems
"DATA",6003,46,0)
LRBLPT
"DATA",6003,46,1,0)
^^1^1^3020927^^^
"DATA",6003,46,1,1,0)
Records date of transfusion and transfusion comments.
"DATA",6003,47,0)
LRBLPTXR
"DATA",6003,47,1,0)
^^2^2^3020927^
"DATA",6003,47,1,1,0)
Transfusion reactions without identifying specific units are entered 
"DATA",6003,47,1,2,0)
using this option
"DATA",6003,48,0)
LRBLPX
"DATA",6003,48,1,0)
^^2^2^3020927^^
"DATA",6003,48,1,1,0)
Records results of crossmatch and allows user to make the blood component
"DATA",6003,48,1,2,0)
 available for patient use.
"DATA",6003,49,0)
LRBLRIN
"DATA",6003,49,1,0)
^^1^1^3020927^^^
"DATA",6003,49,1,1,0)
This option prints the invoices of suppliers of blood component units.
"DATA",6003,50,0)
LRBLRIS
"DATA",6003,50,1,0)
^^2^2^3020927^^^
"DATA",6003,50,1,1,0)
This option prints the list of special blood cell typing charges of
"DATA",6003,50,1,2,0)
 units in inventory.
"DATA",6003,51,0)
LRBLRIT
"DATA",6003,51,1,0)
^^1^1^3020927^^^^
"DATA",6003,51,1,1,0)
This option prints the transactions of suppliers of blood component units.
"DATA",6003,52,0)
LRBLSI
"DATA",6003,52,1,0)
^6003.01^1^1^3110405^^^
"DATA",6003,52,1,1,0)
Edit options for blood bank inventory file (#65)
"DATA",6003,53,0)
LRBLSEB
"DATA",6003,53,1,0)
^^1^1^3020927^^^
"DATA",6003,53,1,1,0)
Allows editing the blood product file (#66).
"DATA",6003,54,0)
LRBLSEC
"DATA",6003,54,1,0)
^^2^2^3020927^^^^
"DATA",6003,54,1,1,0)
Allows editing PATIENT XMATCHED/ASSIGNED and DATE/TIME UNIT RELOCATION
"DATA",6003,54,1,2,0)
 fields.
"DATA",6003,55,0)
LRBLSED
"DATA",6003,55,1,0)
^^3^3^3020927^^^
"DATA",6003,55,1,1,0)
Edit disposition, disposition date, disposition comment, patient transfused,
"DATA",6003,55,1,2,0)
 physician, service, transfusion comment and modify to/from fields in
"DATA",6003,55,1,3,0)
 blood bank inventory file (#65).
"DATA",6003,56,0)
LRBLSEE
"DATA",6003,56,1,0)
^19.06^6^6^3020927^^^^
"DATA",6003,56,1,1,0)
If a blood component in the inventory file is only for an autologous
"DATA",6003,56,1,2,0)
 donor and it is desired to free the unit for other patients this
"DATA",6003,56,1,3,0)
 option can free the unit.  However if any of the screening tests on
"DATA",6003,56,1,4,0)
 the unit is positive (syphilis serology, HBsAg, HTLV-III antibody)
"DATA",6003,56,1,5,0)
 or the unit did not have all of the screening tests performed
"DATA",6003,56,1,6,0)
 the unit cannot be made available to anyone other than the donor.
"DATA",6003,57,0)
LRBLSEF
"DATA",6003,57,1,0)
^^1^1^3020927^^^
"DATA",6003,57,1,1,0)
Allows editing the laboratory/blood bank description file.
"DATA",6003,58,0)
LRBLSEH
"DATA",6003,58,1,0)
^^2^2^3020927^^^^
"DATA",6003,58,1,1,0)
Allows editing of the blood donor history questions which appear on the
"DATA",6003,58,1,2,0)
 donor history,physical and consent form.
"DATA",6003,59,0)
LRBLSEL
"DATA",6003,59,1,0)
^^1^1^3020927^^^
"DATA",6003,59,1,1,0)
Allows editing blood component unit log-in prompts.
"DATA",6003,60,0)
LRBLSER
"DATA",6003,60,1,0)
^^2^2^3020927^^^
"DATA",6003,60,1,1,0)
Removes from inventory those blood component units with
"DATA",6003,60,1,2,0)
 final dispositions after a hard copy has been printed.
"DATA",6003,61,0)
LRBLSET
"DATA",6003,61,1,0)
^^1^1^3020927^^^
"DATA",6003,61,1,1,0)
Tests to be printed with blood components transfused.
"DATA",6003,62,0)
LRBLSEU
"DATA",6003,62,1,0)
^^1^1^3020927^^^
"DATA",6003,62,1,1,0)
Allows editing entries in the blood donor utility file.
"DATA",6003,63,0)
LRBLSF
"DATA",6003,63,1,0)
^^2^2^3020927^^^^
"DATA",6003,63,1,1,0)
The number of lines from the top of one label to the top of the next
"DATA",6003,63,1,2,0)
 label.  This is used as the default value when printing various labels.
"DATA",6003,64,0)
LRBLSLL
"DATA",6003,64,1,0)
^^1^1^3020927^
"DATA",6003,64,1,1,0)
Option allows adding/editing letters or consults in lab letter file.
"DATA",6003,65,0)
LRBLSMS
"DATA",6003,65,1,0)
^^2^2^3020927^^
"DATA",6003,65,1,1,0)
Allows entering/editing the pre-operative surgical blood 
"DATA",6003,65,1,2,0)
 component orders for an operation.
"DATA",6003,66,0)
LRBLSNO
"DATA",6003,66,1,0)
^^2^2^3020927^^^^
"DATA",6003,66,1,1,0)
Allows enter/edit of corresponding antigen or antibody (field .04)
"DATA",6003,66,1,2,0)
 in file 61.3 (FUNCTION FIELD of SNOMED).
"DATA",6003,67,0)
LRBLSPP
"DATA",6003,67,1,0)
^^2^2^3020927^^^^
"DATA",6003,67,1,1,0)
Edit previous transfusion data entered via [LRBLPER] 'Enter previous
"DATA",6003,67,1,2,0)
 records' option.
"DATA",6003,68,0)
LRBLSRI
"DATA",6003,68,1,0)
^^2^2^3020927^^
"DATA",6003,68,1,1,0)
Deletes only inappropriate transfusion requests that have been
"DATA",6003,68,1,2,0)
 printed.
"DATA",6003,69,0)
LRBLSRQ
"DATA",6003,69,1,0)
^^1^1^3020927^^^^
"DATA",6003,69,1,1,0)
Edit requests for blood components
"DATA",6003,70,0)
LRBLSSP
"DATA",6003,70,1,0)
^^1^1^3020927^^
"DATA",6003,70,1,1,0)
Allows local site configuration of certain options.
"DATA",6003,71,0)
LRBLST
"DATA",6003,71,1,0)
^^2^2^3020927^^^^
"DATA",6003,71,1,1,0)
Edit/enter lab tests to be displayed for a specific specimen (ex. blood)
"DATA",6003,71,1,2,0)
 when a patient is entered for xmatching or for selecting blood components.
"DATA",6003,72,0)
LRBLTTW
"DATA",6003,72,1,0)
^^1^1^3020927^^^
"DATA",6003,72,1,1,0)
Provides a list of tests on a worklist.
"DATA",6003,73,0)
LRBLTX
"DATA",6003,73,1,0)
^^2^2^3020927^
"DATA",6003,73,1,1,0)
Select tests, appropriate specimens and values for transfusion follow-up
"DATA",6003,73,1,2,0)
 for identifying transfusion related disorders.
"DATA",6003,74,0)
LRBLVAL
"DATA",6003,74,1,0)
^^1^1^3020927^
"DATA",6003,74,1,1,0)
Documents validation testing of blood bank options.
"DATA",6003,75,0)
LRBLSP
"DATA",6003,75,1,0)
^^1^1^3030321^
"DATA",6003,75,1,1,0)
Blood bank patient options available for supervisor
"DATA",6009,62.55,0)
62.55^^
"DATA",6009,62.55,"DD",0)
^6009.01A^2^2
"DATA",6009,62.55,"DD",0,"PREW")

"DATA",6009,62.55,"DD",1,0)
62.55^.01
"DATA",6009,62.55,"DD",1,"PREW")
^
"DATA",6009,62.55,"DD",1,"PSTW")
^
"DATA",6009,62.55,"DD",2,0)
62.55^1
"DATA",6009,62.55,"DD",2,"PREW")
^
"DATA",6009,62.55,"DD",2,"PSTW")
^
"DATA",6009,63,0)
63^^
"DATA",6009,63,"DD",0)
^6009.01A^116^116
"DATA",6009,63,"DD",0,"PREW")

"DATA",6009,63,"DD",1,0)
63.01^.01
"DATA",6009,63,"DD",1,"PREW")
^
"DATA",6009,63,"DD",1,"PSTW")
^
"DATA",6009,63,"DD",2,0)
63.01^.03
"DATA",6009,63,"DD",2,"PREW")
^
"DATA",6009,63,"DD",2,"PSTW")
^
"DATA",6009,63,"DD",3,0)
63.01^.04
"DATA",6009,63,"DD",3,"PREW")
^
"DATA",6009,63,"DD",3,"PSTW")
^
"DATA",6009,63,"DD",4,0)
63.01^.05
"DATA",6009,63,"DD",4,"PREW")
^
"DATA",6009,63,"DD",4,"PSTW")
^
"DATA",6009,63,"DD",5,0)
63.01^.055
"DATA",6009,63,"DD",5,"PREW")
^
"DATA",6009,63,"DD",5,"PSTW")
^
"DATA",6009,63,"DD",6,0)
63.01^.06
"DATA",6009,63,"DD",6,"PREW")
^
"DATA",6009,63,"DD",6,"PSTW")
^
"DATA",6009,63,"DD",7,0)
63.01^.07
"DATA",6009,63,"DD",7,"PREW")
^
"DATA",6009,63,"DD",7,"PSTW")
^
"DATA",6009,63,"DD",8,0)
63.01^.08
"DATA",6009,63,"DD",8,"PREW")
^
"DATA",6009,63,"DD",8,"PSTW")
^
"DATA",6009,63,"DD",9,0)
63.01^.09
"DATA",6009,63,"DD",9,"PREW")
^
"DATA",6009,63,"DD",9,"PSTW")
^
"DATA",6009,63,"DD",10,0)
63.01^.1
"DATA",6009,63,"DD",10,"PREW")
^
"DATA",6009,63,"DD",10,"PSTW")
^
"DATA",6009,63,"DD",11,0)
63.01^.12
"DATA",6009,63,"DD",11,"PREW")
^
"DATA",6009,63,"DD",11,"PSTW")
^
"DATA",6009,63,"DD",12,0)
63.01^.99
"DATA",6009,63,"DD",12,"PREW")
^
"DATA",6009,63,"DD",12,"PSTW")
^
"DATA",6009,63,"DD",13,0)
63.01^2.1
"DATA",6009,63,"DD",13,"PREW")
^
"DATA",6009,63,"DD",13,"PSTW")
^
"DATA",6009,63,"DD",14,0)
63.01^2.2
"DATA",6009,63,"DD",14,"PREW")
^
"DATA",6009,63,"DD",14,"PSTW")
^
"DATA",6009,63,"DD",15,0)
63.01^2.3
"DATA",6009,63,"DD",15,"PREW")
^
"DATA",6009,63,"DD",15,"PSTW")
^
"DATA",6009,63,"DD",16,0)
63.01^2.4
"DATA",6009,63,"DD",16,"PREW")
^
"DATA",6009,63,"DD",16,"PSTW")
^
"DATA",6009,63,"DD",17,0)
63.01^2.5
"DATA",6009,63,"DD",17,"PREW")
^
"DATA",6009,63,"DD",17,"PSTW")
^
"DATA",6009,63,"DD",18,0)
63.01^2.6
"DATA",6009,63,"DD",18,"PREW")
^
"DATA",6009,63,"DD",18,"PSTW")
^
"DATA",6009,63,"DD",19,0)
63.01^2.7
"DATA",6009,63,"DD",19,"PREW")
^
"DATA",6009,63,"DD",19,"PSTW")
^
"DATA",6009,63,"DD",20,0)
63.01^2.8
"DATA",6009,63,"DD",20,"PREW")
^
"DATA",6009,63,"DD",20,"PSTW")
^
"DATA",6009,63,"DD",21,0)
63.01^2.9
"DATA",6009,63,"DD",21,"PREW")
^
"DATA",6009,63,"DD",21,"PSTW")
^
"DATA",6009,63,"DD",22,0)
63.01^2.91
"DATA",6009,63,"DD",22,"PREW")
^
"DATA",6009,63,"DD",22,"PSTW")
^
"DATA",6009,63,"DD",23,0)
63.01^3
"DATA",6009,63,"DD",23,"PREW")
^
"DATA",6009,63,"DD",23,"PSTW")
^
"DATA",6009,63,"DD",24,0)
63.01^4
"DATA",6009,63,"DD",24,"PREW")
^
"DATA",6009,63,"DD",24,"PSTW")
^
"DATA",6009,63,"DD",25,0)
63.01^6
"DATA",6009,63,"DD",25,"PREW")
^
"DATA",6009,63,"DD",25,"PSTW")
^
"DATA",6009,63,"DD",26,0)
63.01^6.1
"DATA",6009,63,"DD",26,"PREW")
^
"DATA",6009,63,"DD",26,"PSTW")
^
"DATA",6009,63,"DD",27,0)
63.01^6.2
"DATA",6009,63,"DD",27,"PREW")
^
"DATA",6009,63,"DD",27,"PSTW")
^
"DATA",6009,63,"DD",28,0)
63.01^6.3
"DATA",6009,63,"DD",28,"PREW")
^
"DATA",6009,63,"DD",28,"PSTW")
^
"DATA",6009,63,"DD",29,0)
63.01^6.4
"DATA",6009,63,"DD",29,"PREW")
^
"DATA",6009,63,"DD",29,"PSTW")
^
"DATA",6009,63,"DD",30,0)
63.01^7
"DATA",6009,63,"DD",30,"PREW")
^
"DATA",6009,63,"DD",30,"PSTW")
^
"DATA",6009,63,"DD",31,0)
63.01^8
"DATA",6009,63,"DD",31,"PREW")
^
"DATA",6009,63,"DD",31,"PSTW")
^
"DATA",6009,63,"DD",32,0)
63.01^9
"DATA",6009,63,"DD",32,"PREW")
^
"DATA",6009,63,"DD",32,"PSTW")
^
"DATA",6009,63,"DD",33,0)
63.01^10
"DATA",6009,63,"DD",33,"PREW")
^
"DATA",6009,63,"DD",33,"PSTW")
^
"DATA",6009,63,"DD",34,0)
63.01^10.2
"DATA",6009,63,"DD",34,"PREW")
^
"DATA",6009,63,"DD",34,"PSTW")
^
"DATA",6009,63,"DD",35,0)
63.01^10.3
"DATA",6009,63,"DD",35,"PREW")
^
"DATA",6009,63,"DD",35,"PSTW")
^
"DATA",6009,63,"DD",36,0)
63.01^11
"DATA",6009,63,"DD",36,"PREW")
^
"DATA",6009,63,"DD",36,"PSTW")
^
"DATA",6009,63,"DD",37,0)
63.01^11.2
"DATA",6009,63,"DD",37,"PREW")
^
"DATA",6009,63,"DD",37,"PSTW")
^
"DATA",6009,63,"DD",38,0)
63.01^11.3
"DATA",6009,63,"DD",38,"PREW")
^
"DATA",6009,63,"DD",38,"PSTW")
^
"DATA",6009,63,"DD",39,0)
63.01^121
"DATA",6009,63,"DD",39,"PREW")
^
"DATA",6009,63,"DD",39,"PSTW")
^
"DATA",6009,63,"DD",40,0)
63.01^122
"DATA",6009,63,"DD",40,"PREW")
^
"DATA",6009,63,"DD",40,"PSTW")
^
"DATA",6009,63,"DD",41,0)
63.01^123
"DATA",6009,63,"DD",41,"PREW")
^
"DATA",6009,63,"DD",41,"PSTW")
^
"DATA",6009,63,"DD",42,0)
63.01^124
"DATA",6009,63,"DD",42,"PREW")
^
"DATA",6009,63,"DD",42,"PSTW")
^
"DATA",6009,63,"DD",43,0)
63.01^125
"DATA",6009,63,"DD",43,"PREW")
^
"DATA",6009,63,"DD",43,"PSTW")
^
"DATA",6009,63,"DD",44,0)
63.01^126
"DATA",6009,63,"DD",44,"PREW")
^
"DATA",6009,63,"DD",44,"PSTW")
^
"DATA",6009,63,"DD",45,0)
63.01^127
"DATA",6009,63,"DD",45,"PREW")
^
"DATA",6009,63,"DD",45,"PSTW")
^
"DATA",6009,63,"DD",46,0)
63.01^128
"DATA",6009,63,"DD",46,"PREW")
^
"DATA",6009,63,"DD",46,"PSTW")
^
"DATA",6009,63,"DD",47,0)
63.01^129
"DATA",6009,63,"DD",47,"PREW")
^
"DATA",6009,63,"DD",47,"PSTW")
^
"DATA",6009,63,"DD",48,0)
63.01^129.1
"DATA",6009,63,"DD",48,"PREW")
^
"DATA",6009,63,"DD",48,"PSTW")
^
"DATA",6009,63,"DD",49,0)
63.01^129.11
"DATA",6009,63,"DD",49,"PREW")
^
"DATA",6009,63,"DD",49,"PSTW")
^
"DATA",6009,63,"DD",50,0)
63.01^129.12
"DATA",6009,63,"DD",50,"PREW")
^
"DATA",6009,63,"DD",50,"PSTW")
^
"DATA",6009,63,"DD",51,0)
63.01^131
"DATA",6009,63,"DD",51,"PREW")
^
"DATA",6009,63,"DD",51,"PSTW")
^
"DATA",6009,63,"DD",52,0)
63.01^132
"DATA",6009,63,"DD",52,"PREW")
^
"DATA",6009,63,"DD",52,"PSTW")
^
"DATA",6009,63,"DD",53,0)
63.01^133
"DATA",6009,63,"DD",53,"PREW")
^
"DATA",6009,63,"DD",53,"PSTW")
^
"DATA",6009,63,"DD",54,0)
63.01^134
"DATA",6009,63,"DD",54,"PREW")
^
"DATA",6009,63,"DD",54,"PSTW")
^
"DATA",6009,63,"DD",55,0)
63.01^135
"DATA",6009,63,"DD",55,"PREW")
^
"DATA",6009,63,"DD",55,"PSTW")
^
"DATA",6009,63,"DD",56,0)
63.01^136
"DATA",6009,63,"DD",56,"PREW")
^
"DATA",6009,63,"DD",56,"PSTW")
^
"DATA",6009,63,"DD",57,0)
63.01^138
"DATA",6009,63,"DD",57,"PREW")
^
"DATA",6009,63,"DD",57,"PSTW")
^
"DATA",6009,63,"DD",58,0)
63.01^139
"DATA",6009,63,"DD",58,"PREW")
^
"DATA",6009,63,"DD",58,"PSTW")
^
"DATA",6009,63,"DD",59,0)
63.01^139.1
"DATA",6009,63,"DD",59,"PREW")
^
"DATA",6009,63,"DD",59,"PSTW")
^
"DATA",6009,63,"DD",60,0)
63.01^139.11
"DATA",6009,63,"DD",60,"PREW")
^
"DATA",6009,63,"DD",60,"PSTW")
^
"DATA",6009,63,"DD",61,0)
63.01^141
"DATA",6009,63,"DD",61,"PREW")
^
"DATA",6009,63,"DD",61,"PSTW")
^
"DATA",6009,63,"DD",62,0)
63.01^142
"DATA",6009,63,"DD",62,"PREW")
^
"DATA",6009,63,"DD",62,"PSTW")
^
"DATA",6009,63,"DD",63,0)
63.01^143
"DATA",6009,63,"DD",63,"PREW")
^
"DATA",6009,63,"DD",63,"PSTW")
^
"DATA",6009,63,"DD",64,0)
63.01^144
"DATA",6009,63,"DD",64,"PREW")
^
"DATA",6009,63,"DD",64,"PSTW")
^
"DATA",6009,63,"DD",65,0)
63.01^145
"DATA",6009,63,"DD",65,"PREW")
^
"DATA",6009,63,"DD",65,"PSTW")
^
"DATA",6009,63,"DD",66,0)
63.01^146
"DATA",6009,63,"DD",66,"PREW")
^
"DATA",6009,63,"DD",66,"PSTW")
^
"DATA",6009,63,"DD",67,0)
63.01^147
"DATA",6009,63,"DD",67,"PREW")
^
"DATA",6009,63,"DD",67,"PSTW")
^
"DATA",6009,63,"DD",68,0)
63.01^148
"DATA",6009,63,"DD",68,"PREW")
^
"DATA",6009,63,"DD",68,"PSTW")
^
"DATA",6009,63,"DD",69,0)
63.01^149
"DATA",6009,63,"DD",69,"PREW")
^
"DATA",6009,63,"DD",69,"PSTW")
^
"DATA",6009,63,"DD",70,0)
63.01^149.1
"DATA",6009,63,"DD",70,"PREW")
^
"DATA",6009,63,"DD",70,"PSTW")
^
"DATA",6009,63,"DD",71,0)
63.01^149.11
"DATA",6009,63,"DD",71,"PREW")
^
"DATA",6009,63,"DD",71,"PSTW")
^
"DATA",6009,63,"DD",72,0)
63.01^149.12
"DATA",6009,63,"DD",72,"PREW")
^
"DATA",6009,63,"DD",72,"PSTW")
^
"DATA",6009,63,"DD",73,0)
63.01^149.13
"DATA",6009,63,"DD",73,"PREW")
^
"DATA",6009,63,"DD",73,"PSTW")
^
"DATA",6009,63,"DD",74,0)
63.01^151
"DATA",6009,63,"DD",74,"PREW")
^
"DATA",6009,63,"DD",74,"PSTW")
^
"DATA",6009,63,"DD",75,0)
63.01^152
"DATA",6009,63,"DD",75,"PREW")
^
"DATA",6009,63,"DD",75,"PSTW")
^
"DATA",6009,63,"DD",76,0)
63.01^153
"DATA",6009,63,"DD",76,"PREW")
^
"DATA",6009,63,"DD",76,"PSTW")
^
"DATA",6009,63,"DD",77,0)
63.01^154
"DATA",6009,63,"DD",77,"PREW")
^
"DATA",6009,63,"DD",77,"PSTW")
^
"DATA",6009,63,"DD",78,0)
63.011^.01
"DATA",6009,63,"DD",78,"PREW")
^
"DATA",6009,63,"DD",78,"PSTW")
^
"DATA",6009,63,"DD",79,0)
63.011^.02
"DATA",6009,63,"DD",79,"PREW")
^
"DATA",6009,63,"DD",79,"PSTW")
^
"DATA",6009,63,"DD",80,0)
63.0112^.01
"DATA",6009,63,"DD",80,"PREW")
^
"DATA",6009,63,"DD",80,"PSTW")
^
"DATA",6009,63,"DD",81,0)
63.0112^.02
"DATA",6009,63,"DD",81,"PREW")
^
"DATA",6009,63,"DD",81,"PSTW")
^
"DATA",6009,63,"DD",82,0)
63.0114^.01
"DATA",6009,63,"DD",82,"PREW")
^
"DATA",6009,63,"DD",82,"PSTW")
^
"DATA",6009,63,"DD",83,0)
63.0114^.02
"DATA",6009,63,"DD",83,"PREW")
^
"DATA",6009,63,"DD",83,"PSTW")
^
"DATA",6009,63,"DD",84,0)
63.012^.01
"DATA",6009,63,"DD",84,"PREW")
^
"DATA",6009,63,"DD",84,"PSTW")
^
"DATA",6009,63,"DD",85,0)
63.013^.01
"DATA",6009,63,"DD",85,"PREW")
^
"DATA",6009,63,"DD",85,"PSTW")
^
"DATA",6009,63,"DD",86,0)
63.013^.02
"DATA",6009,63,"DD",86,"PREW")
^
"DATA",6009,63,"DD",86,"PSTW")
^
"DATA",6009,63,"DD",87,0)
63.014^.01
"DATA",6009,63,"DD",87,"PREW")
^
"DATA",6009,63,"DD",87,"PSTW")
^
"DATA",6009,63,"DD",88,0)
63.014^.02
"DATA",6009,63,"DD",88,"PREW")
^
"DATA",6009,63,"DD",88,"PSTW")
^
"DATA",6009,63,"DD",89,0)
63.014^1
"DATA",6009,63,"DD",89,"PREW")
^
"DATA",6009,63,"DD",89,"PSTW")
^
"DATA",6009,63,"DD",90,0)
63.015^.01
"DATA",6009,63,"DD",90,"PREW")
^
"DATA",6009,63,"DD",90,"PSTW")
^
"DATA",6009,63,"DD",91,0)
63.015^.02
"DATA",6009,63,"DD",91,"PREW")
^
"DATA",6009,63,"DD",91,"PSTW")
^
"DATA",6009,63,"DD",92,0)
63.015^.03
"DATA",6009,63,"DD",92,"PREW")
^
"DATA",6009,63,"DD",92,"PSTW")
^
"DATA",6009,63,"DD",93,0)
63.015^.04
"DATA",6009,63,"DD",93,"PREW")
^
"DATA",6009,63,"DD",93,"PSTW")
^
"DATA",6009,63,"DD",94,0)
63.015^.05
"DATA",6009,63,"DD",94,"PREW")
^
"DATA",6009,63,"DD",94,"PSTW")
^
"DATA",6009,63,"DD",95,0)
63.015^.06
"DATA",6009,63,"DD",95,"PREW")
^
"DATA",6009,63,"DD",95,"PSTW")
^
"DATA",6009,63,"DD",96,0)
63.015^.07
"DATA",6009,63,"DD",96,"PREW")
^
"DATA",6009,63,"DD",96,"PSTW")
^
"DATA",6009,63,"DD",97,0)
63.015^.08
"DATA",6009,63,"DD",97,"PREW")
^
"DATA",6009,63,"DD",97,"PSTW")
^
"DATA",6009,63,"DD",98,0)
63.015^.09
"DATA",6009,63,"DD",98,"PREW")
^
"DATA",6009,63,"DD",98,"PSTW")
^
"DATA",6009,63,"DD",99,0)
63.015^.1
"DATA",6009,63,"DD",99,"PREW")
^
"DATA",6009,63,"DD",99,"PSTW")
^
"DATA",6009,63,"DD",100,0)
63.018^.01
"DATA",6009,63,"DD",100,"PREW")
^
"DATA",6009,63,"DD",100,"PSTW")
^
"DATA",6009,63,"DD",101,0)
63.018^.02
"DATA",6009,63,"DD",101,"PREW")
^
"DATA",6009,63,"DD",101,"PSTW")
^
"DATA",6009,63,"DD",102,0)
63.018^1
"DATA",6009,63,"DD",102,"PREW")
^
"DATA",6009,63,"DD",102,"PSTW")
^
"DATA",6009,63,"DD",103,0)
63.019^.01
"DATA",6009,63,"DD",103,"PREW")
^
"DATA",6009,63,"DD",103,"PSTW")
^
"DATA",6009,63,"DD",104,0)
63.019^.02
"DATA",6009,63,"DD",104,"PREW")
^
"DATA",6009,63,"DD",104,"PSTW")
^
"DATA",6009,63,"DD",105,0)
63.019^.03
"DATA",6009,63,"DD",105,"PREW")
^
"DATA",6009,63,"DD",105,"PSTW")
^
"DATA",6009,63,"DD",106,0)
63.019^.04
"DATA",6009,63,"DD",106,"PREW")
^
"DATA",6009,63,"DD",106,"PSTW")
^
"DATA",6009,63,"DD",107,0)
63.019^.05
"DATA",6009,63,"DD",107,"PREW")
^
"DATA",6009,63,"DD",107,"PSTW")
^
"DATA",6009,63,"DD",108,0)
63.019^.06
"DATA",6009,63,"DD",108,"PREW")
^
"DATA",6009,63,"DD",108,"PSTW")
^
"DATA",6009,63,"DD",109,0)
63.019^.07
"DATA",6009,63,"DD",109,"PREW")
^
"DATA",6009,63,"DD",109,"PSTW")
^
"DATA",6009,63,"DD",110,0)
63.019^.08
"DATA",6009,63,"DD",110,"PREW")
^
"DATA",6009,63,"DD",110,"PSTW")
^
"DATA",6009,63,"DD",111,0)
63.019^.09
"DATA",6009,63,"DD",111,"PREW")
^
"DATA",6009,63,"DD",111,"PSTW")
^
"DATA",6009,63,"DD",112,0)
63.019^.1
"DATA",6009,63,"DD",112,"PREW")
^
"DATA",6009,63,"DD",112,"PSTW")
^
"DATA",6009,63,"DD",113,0)
63.199^.01
"DATA",6009,63,"DD",113,"PREW")
^
"DATA",6009,63,"DD",113,"PSTW")
^
"DATA",6009,63,"DD",114,0)
63.46^.01
"DATA",6009,63,"DD",114,"PREW")
^
"DATA",6009,63,"DD",114,"PSTW")
^
"DATA",6009,63,"DD",115,0)
63.46^.02
"DATA",6009,63,"DD",115,"PREW")
^
"DATA",6009,63,"DD",115,"PSTW")
^
"DATA",6009,63,"DD",116,0)
63.48^.01
"DATA",6009,63,"DD",116,"PREW")
^
"DATA",6009,63,"DD",116,"PSTW")
^
"DATA",6009,65.5,0)
65.5^^Y
"DATA",6009,66.2,0)
66.2^^Y
"DATA",6009,66.5,0)
66.5^^Y
"DATA",6009,66.9,0)
66.9^^Y
"FIA",6003)
VISTA BLOOD BANK RESTRICTED OPTIONS LIST
"FIA",6003,0)
^VBEC(6003,
"FIA",6003,0,0)
6003
"FIA",6003,0,1)
y^y^f^^n^^y^a^n
"FIA",6003,0,10)

"FIA",6003,0,11)

"FIA",6003,0,"RLRO")

"FIA",6003,0,"VR")
5.2^LR
"FIA",6003,6003)
0
"FIA",6003,6003.01)
0
"FIA",6009)
VBECS FILE & FIELD LEVEL SECURITY
"FIA",6009,0)
^VBEC(6009,
"FIA",6009,0,0)
6009
"FIA",6009,0,1)
y^y^f^^n^^y^a^n
"FIA",6009,0,10)

"FIA",6009,0,11)

"FIA",6009,0,"RLRO")

"FIA",6009,0,"VR")
5.2^LR
"FIA",6009,6009)
0
"FIA",6009,6009.01)
0
"INIT")
LR408
"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
408^3110407
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
40
"RTN","LR408")
0^^B26812435^n/a
"RTN","LR408",1,0)
LR408 ;hoifo/rlm-Disable VistA Blood Bank options ;Nov 21, 2002
"RTN","LR408",2,0)
 ;;5.2;LAB SERVICE;**408**;Sep 27, 1994;Build 8
"RTN","LR408",3,0)
 ;
"RTN","LR408",4,0)
 ;Medical Device #:
"RTN","LR408",5,0)
 ;Note: The food and Drug Administration classifies this software as a
"RTN","LR408",6,0)
 ;medical device.  As such, it may not be changed in any way.
"RTN","LR408",7,0)
 ;Modifications to this software may result in an adulterated medical
"RTN","LR408",8,0)
 ;device under 21CFR820, the use of which is considered to be a
"RTN","LR408",9,0)
 ;violation of US Federal Statutes.  Acquiring and implementing this
"RTN","LR408",10,0)
 ;software through the Freedom of Information Act requires the
"RTN","LR408",11,0)
 ;implementer to assume total responsibility for the software, and
"RTN","LR408",12,0)
 ;become a registered manufacturer of a medical device, subject to FDA
"RTN","LR408",13,0)
 ;regulations.
"RTN","LR408",14,0)
 ;
"RTN","LR408",15,0)
 ;Call to FILE^DIE is supported by IA: 2053
"RTN","LR408",16,0)
 ;Call to $$IENS^DILF is supported by IA: 2054
"RTN","LR408",17,0)
 ;Call to ^DIR is supported by IA: 10026
"RTN","LR408",18,0)
 ;Call to OUT^XPDMENU is supported by IA: 1157
"RTN","LR408",19,0)
 ;Call to BMES^XPDUTL is supported by IA: 10141
"RTN","LR408",20,0)
 ;Setting the "DI" node in the data dictionary supported by IA: 3805
"RTN","LR408",21,0)
 ;Setting the 'write access' (9) node in the Agglutination Strength File
"RTN","LR408",22,0)
 ; (62.55) data dictionary is supported by IA: 4468
"RTN","LR408",23,0)
 ;Setting the 'write access' (9) node in the Lab Data (63) file data
"RTN","LR408",24,0)
 ; dictionary is supported by IA: 4469
"RTN","LR408",25,0)
 ;
"RTN","LR408",26,0)
EN ;
"RTN","LR408",27,0)
 I $P($G(^VBEC(6009,65.5,0)),"^",3)="Y" S LRVBTXT="Options, files, and fields have already been disabled at "_$P($$SITE^VASITE,"^",2) G MSG
"RTN","LR408",28,0)
 S LRVBFLG=1,LRVBTXT="Options, files, and fields have been disabled at "_$P($$SITE^VASITE,"^",2)
"RTN","LR408",29,0)
 S I=0 F  S I=$O(^VBEC(6003,I)) Q:'I  D
"RTN","LR408",30,0)
 .S OPT=$P($G(^VBEC(6003,I,0)),U)
"RTN","LR408",31,0)
 .Q:OPT="LRBLAD"!(OPT="LRBLPC")!(OPT="LRBLSI")
"RTN","LR408",32,0)
 .S TXT=$S(LRVBFLG=1:"out-of-order",1:"@")
"RTN","LR408",33,0)
 .D OUT^XPDMENU(OPT,TXT)
"RTN","LR408",34,0)
 .Q
"RTN","LR408",35,0)
 K I,OPT,TXT
"RTN","LR408",36,0)
 ; Note: Using Integration Agreement# 3805 to set and kill the
"RTN","LR408",37,0)
 ; ^DD(file#,0,"DI") node.
"RTN","LR408",38,0)
 ;
"RTN","LR408",39,0)
 ;
"RTN","LR408",40,0)
 S GG=0,U="^"  W !,"Finished disabling specific VistA Blood Bank components."
"RTN","LR408",41,0)
 F  S GG=$O(^VBEC(6009,GG)) Q:'GG  D
"RTN","LR408",42,0)
 .;
"RTN","LR408",43,0)
 .; need to check if only whole file restrictions apply, or if a
"RTN","LR408",44,0)
 .; sub-file/field levels are involved
"RTN","LR408",45,0)
 .;
"RTN","LR408",46,0)
 .I +$O(^VBEC(6009,GG,"DD",0)) D
"RTN","LR408",47,0)
 ..;
"RTN","LR408",48,0)
 ..; sub-file/field levels exist
"RTN","LR408",49,0)
 ..;
"RTN","LR408",50,0)
 ..S HH=0 F  S HH=$O(^VBEC(6009,GG,"DD",HH)) Q:'HH  D
"RTN","LR408",51,0)
 ...S LRVBIEN(1)=GG,LRVBIEN=HH,LRVBIENS=$$IENS^DILF(.LRVBIEN)
"RTN","LR408",52,0)
 ...I LRVBFLG=1 D
"RTN","LR408",53,0)
 ....;
"RTN","LR408",54,0)
 ....; 1) obtain sub-file and field information
"RTN","LR408",55,0)
 ....; 2) set pre-conv. field write access to pre-conv. value
"RTN","LR408",56,0)
 ....; 3) set pst-conv. field write access to pst-conv. value
"RTN","LR408",57,0)
 ....; 4) hardset write node access
"RTN","LR408",58,0)
 ....; 5) file data tracking pre/post conversion field level values
"RTN","LR408",59,0)
 ....;
"RTN","LR408",60,0)
 ....S LRVBNODE=$G(^VBEC(6009,GG,"DD",HH,0))
"RTN","LR408",61,0)
 ....S LRVBFLD=$P(LRVBNODE,U,2),LRVBFLE=$P(LRVBNODE,U) ;(1)
"RTN","LR408",62,0)
 ....S LRVBB4=$G(^DD(LRVBFLE,LRVBFLD,9))
"RTN","LR408",63,0)
 ....S:LRVBB4]"" LRVBFDA(6009.01,LRVBIENS,1)=LRVBB4 ;(2)
"RTN","LR408",64,0)
 ....S VBECFDA(6009.01,LRVBIENS,2)="^" ;(3)
"RTN","LR408",65,0)
 ....S ^DD(LRVBFLE,LRVBFLD,9)="^" ;(4)
"RTN","LR408",66,0)
 ....D FILE^DIE("","LRVBFDA") ;(5)
"RTN","LR408",67,0)
 ....Q
"RTN","LR408",68,0)
 ...E  D
"RTN","LR408",69,0)
 ....;
"RTN","LR408",70,0)
 ....; 1) obtain sub-file and field information
"RTN","LR408",71,0)
 ....; 2) set pre-conv. field to pre-conv. write access value
"RTN","LR408",72,0)
 ....;    2A) if pre-conv value was null delete data in the field
"RTN","LR408",73,0)
 ....;    2B) if pre-conv value was not null restore the field to
"RTN","LR408",74,0)
 ....;        the pre-conv value of the field
"RTN","LR408",75,0)
 ....; 3) set write access node to pre-conv. value (if any)
"RTN","LR408",76,0)
 ....; 4) kill write access data dictionary node if no pre-conv. value
"RTN","LR408",77,0)
 ....; 5) set pst-conv write access field to null
"RTN","LR408",78,0)
 ....; 6) file data tracking pre-conversion field level values
"RTN","LR408",79,0)
 ....;
"RTN","LR408",80,0)
 ....S LRVBNODE=$G(^VBEC(6009,GG,"DD",HH,0))
"RTN","LR408",81,0)
 ....S LRVBFLD=$P(LRVBNODE,U,2),LRVBFLE=$P(LRVBNODE,U) ;(1)
"RTN","LR408",82,0)
 ....S LRVBB4=$G(^VBEC(6009,GG,"DD",HH,"PREW"))
"RTN","LR408",83,0)
 ....S:LRVBB4="" LRVBFDA(6009.01,LRVBIENS,1)="@" ;(2A)
"RTN","LR408",84,0)
 ....S:LRVBB4]"" LRVBFDA(6009.01,LRVBIENS,1)=LRVBB4 ;(2B)
"RTN","LR408",85,0)
 ....S:LRVBB4]"" ^DD(LRVBFLE,LRVBFLD,9)=LRVBB4 ;(3)
"RTN","LR408",86,0)
 ....K:LRVBB4="" ^DD(LRVBFLE,LRVBFLD,9) ;(4)
"RTN","LR408",87,0)
 ....S LRVBFDA(6009.01,LRVBIENS,2)="@" ;(5)
"RTN","LR408",88,0)
 ....D FILE^DIE("","LRVBFDA") ;(6)
"RTN","LR408",89,0)
 ....Q
"RTN","LR408",90,0)
 ...K LRVBB4,LRVBFDA,LRVBFLD,LRVBFLE,LRVBIENS,LRVBNODE
"RTN","LR408",91,0)
 ...Q
"RTN","LR408",92,0)
 ..K HH
"RTN","LR408",93,0)
 ..Q
"RTN","LR408",94,0)
 .;
"RTN","LR408",95,0)
 .; whole file restriction check
"RTN","LR408",96,0)
 .;
"RTN","LR408",97,0)
 .D
"RTN","LR408",98,0)
 ..;
"RTN","LR408",99,0)
 ..; Disabling file access, or imposing file restrictions
"RTN","LR408",100,0)
 ..; 1) find the file restriction value before the data conversion
"RTN","LR408",101,0)
 ..;    (no pre-data conversion file level restrictions anticipated)
"RTN","LR408",102,0)
 ..;       1A) if pre-conv value was not null set the field to the
"RTN","LR408",103,0)
 ..;           pre-conv value of the field
"RTN","LR408",104,0)
 ..; 2) hard set the 2nd piece of ^DD(File#,0,"DI") to "Y"
"RTN","LR408",105,0)
 ..; 3) Set pst-conversion file restriction value,'Y' into the correct
"RTN","LR408",106,0)
 ..;    field (#.03)
"RTN","LR408",107,0)
 ..; 4) file the data.
"RTN","LR408",108,0)
 ..;
"RTN","LR408",109,0)
 ..Q:$D(^VBEC(6009,GG,"DD"))
"RTN","LR408",110,0)
 ..S LRVBB4=$P($G(^DD(GG,0,"DI")),U,2) ;(1)
"RTN","LR408",111,0)
 ..S:LRVBB4]"" LRVBFDA(6009,GG_",",.02)=LRVBB4 ;(1A)
"RTN","LR408",112,0)
 ..S $P(^DD(GG,0,"DI"),U,2)="Y" ;(2)
"RTN","LR408",113,0)
 ..S LRVBFDA(6009,GG_",",.03)="Y" ;(3)
"RTN","LR408",114,0)
 ..D FILE^DIE("","LRVBFDA") ;(4)
"RTN","LR408",115,0)
 ..Q
"RTN","LR408",116,0)
 .K LRVBB4,LRVBFDA
"RTN","LR408",117,0)
 .Q
"RTN","LR408",118,0)
 K GG,LRVBMSG
"RTN","LR408",119,0)
MSG ;Send a message showing success.
"RTN","LR408",120,0)
 K ^TMP("VBEC",$J)
"RTN","LR408",121,0)
 s ^TMP("VBEC",$J,1,0)=LRVBTXT
"RTN","LR408",122,0)
 s XMSUB="LR*5.2*408 Patch Installation verification",XMTEXT="^TMP(""VBEC"",$J)",XMDUN="Vista BB Patch Monitor"
"RTN","LR408",123,0)
 s XMY("G.VBEC@FORUM.VA.GOV")=""
"RTN","LR408",124,0)
 d SENDMSG^XMXAPI(DUZ,XMSUB,XMTEXT,.XMY)
"RTN","LR408",125,0)
 k ^TMP("VBEC",$J),XMY
"RTN","LR408",126,0)
 q  ;
"RTN","LR408",127,0)
ZEOR ;LR408
"RTN","LRBLDC")
0^1^B18272496^B18246921
"RTN","LRBLDC",1,0)
LRBLDC ;AVAMC/REG/CYM - DONOR COMPONENT PREP ;7/3/96  11:58 ;
"RTN","LRBLDC",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDC",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDC",4,0)
 Q  D V^LRU S X="BLOOD BANK" D ^LRUTL G:Y=-1 END W @IOF,?20,"Collection disposition/component preparation",!
"RTN","LRBLDC",5,0)
 I LRCAPA S X="DONOR COMPONENT PREPARATION",X("NOCODES")=1 D X^LRUWK G:'$D(X) END
"RTN","LRBLDC",6,0)
 D BAR^LRBLB
"RTN","LRBLDC",7,0)
I R !!,"Select BLOOD DONOR: ",X:DTIME G:X=""!(X[U) END I X?7N.N,X'["?",LR,$E(X,1,$L(LR(2)))=LR(2) D EN^LRBLBU G:'$D(X) I
"RTN","LRBLDC",8,0)
 S DIC="^LRE(",DIC(0)="EQM",D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D") D MIX^DIC1 K DIC G I:Y<1 S LRQ=+Y D REST,^LRBLDC1 K LR("CK"),DIC,DIE,DR,DA,DQ G I
"RTN","LRBLDC",9,0)
REST S LRI=$O(^LRE(LRQ,5,0)) I 'LRI W $C(7),!!,"No collection date for this patient",! Q
"RTN","LRBLDC",10,0)
 I $P(^LRE(LRQ,5,LRI,0),U,4)="" W $C(7),!,"NO UNIT ID ENTERED !" Q
"RTN","LRBLDC",11,0)
 I $P(^LRE(LRQ,5,LRI,0),U,14) W $C(7),!,"Not allowed, data entered via old blood donor records option." Q
"RTN","LRBLDC",12,0)
 S X=^LRE(LRQ,0),LRP=$P(X,U),W(5)=$P(X,U,5),W(6)=$P(X,U,6)
"RTN","LRBLDC",13,0)
 S Z=^LRE(LRQ,5,LRI,0),Y=$S($D(^(2)):$P(^(2),"^",2),1:+Z) D D^LRU W !!,"Donor: ",LRP,"  ABO: ",W(5)," Rh: ",W(6),!,"Donation date/time: ",Y,?50,"Unit ID: ",$P(Z,"^",4)
"RTN","LRBLDC",14,0)
 S C=$P(Z,"^",2) I C=""!(C="N") W $C(7),!,"Sorry no collection indicated",! Q
"RTN","LRBLDC",15,0)
 I $P(Z,"^",10)=2 W $C(7),!,"Collection discarded",! Q
"RTN","LRBLDC",16,0)
 N LRDATA S LRDATA=^LRE(LRQ,5,LRI,2),LR(65.54)=$P(LRDATA,U,3)
"RTN","LRBLDC",17,0)
 S DIE="^LRE(",DA=LRQ,DR="[LRBLDC]" D CK^LRU Q:$D(LR("CK"))  W ! D ^DIE D FRE^LRU
"RTN","LRBLDC",18,0)
 Q:'$D(LRB)  K LRF,DIC,DIE,DR,DA F A=0:0 S A=$O(^LRE(LRQ,5,LRI,66,A)) Q:'A  W !?5,$P(^LAB(66,A,0),"^") S LRF(A)=""
"RTN","LRBLDC",19,0)
 S:'$D(^LRE(LRQ,5,LRI,66,0)) ^(0)="^65.66PAI^^"
"RTN","LRBLDC",20,0)
C S (DIC,DIE)="^LRE(LRQ,5,LRI,66,",LRZ=0 F X=0:0 S X=$O(^LRE(LRQ,5,LRI,66,X)) Q:'X  S LRZ=$P(^LAB(66,X,0),"^",19) Q:LRZ
"RTN","LRBLDC",21,0)
 R !!,"Select BLOOD COMPONENT: ",X:DTIME G:X=""!(X[U) W I LR,$E(X,1,$L(LR(2)))=LR(2),$A(X)<58,$A(X)>47 D P^LRBLB G:'$D(X) C
"RTN","LRBLDC",22,0)
 W ! S DA(2)=LRQ,DA(1)=LRI,LRB(4)=$P(^LRE(LRQ,5,LRI,66,0),"^",4),DIC(0)=$S(LRB(4)<LRB(1):"EQLM",1:"EQM") S:(LRB(4)<LRB(1)) DLAYGO=65 D ^DIC K DIC,DLAYGO G:Y<1 C S DA=+Y,LRA=^LAB(66,DA,0) I $P(Y,"^",3),LRZ,$P(LRA,"^",19) D KILL G C
"RTN","LRBLDC",23,0)
 S X=^LRE(LRQ,5,LRI,66,DA,0),O=$P(X,U,3),M=$P(X,U,4),M(5)=$P(X,U,5),LRB(6)=9999999,LRB(5)="",LRB(7)=$P(LRA,"^",17),LRA=$P(LRA,"^",10)
"RTN","LRBLDC",24,0)
 I LRB(7) S LRB(3)=$P(LRB(2),".",2),X1=$P(LRB(2),"."),X2=$P(LRB(7),".") D C^%DTC S (Y,LRB(6))=X D D^LRU S LRB(5)=Y I LRB(7)["." S Z=LRB(6)_"."_LRB(3),X="."_$P(LRB(7),".",2),Z(0)=$P(X*24*60,".") D EN
"RTN","LRBLDC",25,0)
 S DR=".01;.03//^S X=LRB(9);I $L(O),O'=X S Z=.03 D S^LRBLDC;S:'X Y=.01;.04//^S X=LRB(5);D:X>LRB(6) X^LRBLDC;I $L(M),M'=X S O=M,Z=.04 D S^LRBLDC;.05//^S X=LRA;I $L(M(5)),M(5)'=X S O=M(5),Z=.05 D S^LRBLDC"
"RTN","LRBLDC",26,0)
 D ^DIE G C
"RTN","LRBLDC",27,0)
W F W=0:0 S W=$O(LRF(W)) Q:'W  I '$D(^LRE(LRQ,5,LRI,66,W)) S Z="65.66,.01",(O,DA)=W,DA(1)=LRI,DA(2)=LRQ,X="deleted" D EN^LRUD
"RTN","LRBLDC",28,0)
 Q
"RTN","LRBLDC",29,0)
KILL W !,$C(7),"Cannot select more than one red blood cell product.",!,"Selection ",$P(^LAB(66,DA,0),U)," canceled !",! L +^LRE(LRQ,5,LRI,66)
"RTN","LRBLDC",30,0)
 K ^LRE(LRQ,5,LRI,66,DA),^LRE(LRQ,5,LRI,66,"B",DA) S X=^LRE(LRQ,5,LRI,66,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)="":"",1:($P(X,"^",4)-1)) L -^LRE(LRQ,5,LRI,66) Q
"RTN","LRBLDC",31,0)
 ;
"RTN","LRBLDC",32,0)
END D V^LRU Q
"RTN","LRBLDC",33,0)
 ;
"RTN","LRBLDC",34,0)
S S Z="65.66,"_Z D EN^LRUD Q
"RTN","LRBLDC",35,0)
 ;
"RTN","LRBLDC",36,0)
X W $C(7),!?4,"Expiration date exceeds allowable limit !",! S X=^LRE(LRQ,5,LRI,66,DA,0),^(0)=$P(X,"^",1,3)_"^^"_$P(X,"^",5,99),Y=.04 Q
"RTN","LRBLDC",37,0)
EN ;from LRBLJLG1
"RTN","LRBLDC",38,0)
 D H^LRUT S W(1)=Z(3)+Z(0) D C^LRUT S %H=$E(W,1,5),Z=$E(W,6,9),Z(1)=Z\60,Z(2)=Z#60 D YMD^%DTC S (LRB(6),Y)=X_"."_$E("00",1,2-$L(Z(1)))_Z(1)_$E("00",1,2-$L(Z(2)))_Z(2) D D^LRU S LRB(5)=$E(Y,1,12)_"@"_$E(Y,15,19) Q
"RTN","LRBLDCU")
0^2^B6930637^B6912463
"RTN","LRBLDCU",1,0)
LRBLDCU ;AVAMC/REG/CYM - CUMULATIVE DONATION CALCULATIONS ;6/28/96  08:47 ;
"RTN","LRBLDCU",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDCU",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDCU",4,0)
 Q  S IOP="HOME" D ^%ZIS,END W @IOF,?15,"Cumulative donations and new awards"
"RTN","LRBLDCU",5,0)
 D S^LRU S LRC=0 D FIELD^DID(65.54,1,"","POINTER","X") S X=X("POINTER") F A=1:1 S B=$P(X,";",A),C=$P(B,":") Q:B=""  S LRB(C)=$P(B,":",2)
"RTN","LRBLDCU",6,0)
 S X=0 F A=0:0 S X=$O(LRB(X)) Q:X=""  D Z G:E["^"!(E="") END
"RTN","LRBLDCU",7,0)
 S I="" W !!,"Print all donors to receive new awards " S %=2 D YN^LRU G:%<1 END I %=1 G DEV
"RTN","LRBLDCU",8,0)
ASK W ! S LRG(1)=0,DIC="^LRE(",DIC(0)="AEQM" D ^DIC K DIC G:Y<1 END
"RTN","LRBLDCU",9,0)
 S I=+Y,N=$P(Y,U,2),K=0 D C S:$D(^LRE(I,3)) K=$P(^(3),"^") W:LRG(1)'>LRG!(LRG<1) !,N,!,$S(K:"New award; Not given",1:"No new award"),?33,"Total donations: ",$J(T,3),"  Total awards: ",LRG G ASK
"RTN","LRBLDCU",10,0)
DEV S ZTRTN="QUE^LRBLDCU" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLDCU",11,0)
QUE U IO D L^LRU S X="T",%DT="" D ^%DT S LRF=10009999-Y
"RTN","LRBLDCU",12,0)
 D:IOST?1"C".E WAIT^LRU D H S LR("F")=1,N=0 F A=0:0 S N=$O(^LRE("B",N)) Q:N=""!(LR("Q"))  F I=0:0 S I=$O(^LRE("B",N,I)) Q:'I!(LR("Q"))  D E
"RTN","LRBLDCU",13,0)
 W:'LRC !,"No donors found to receive new awards." W:IOST'?1"C".E @IOF D END,END^LRUTL Q
"RTN","LRBLDCU",14,0)
E Q:$O(^LRE(I,5,0))>LRF
"RTN","LRBLDCU",15,0)
C S T=0,X=^LRE(I,0),LRG=$P(X,"^",8),Y=$P(X,"^",3) D DT^LRU S N(1)=Y D D
"RTN","LRBLDCU",16,0)
 Q
"RTN","LRBLDCU",17,0)
D F V=0:0 S V=$O(^LRE(I,5,V)) Q:'V!(LR("Q"))  S C=$P(^(V,0),"^",2) I C]"" S T=T+E(C)
"RTN","LRBLDCU",18,0)
 Q:LR("Q")  I T S LRG(1)=T\8 I LRG(1)>LRG S ^LRE(I,3)=1 D:$Y>(IOSL-6) H Q:LR("Q")  W !,N,?31,N(1),?45,$J(LRG,2),?60,$J(T,3) S LRC=LRC+1
"RTN","LRBLDCU",19,0)
 S $P(^LRE(I,0),"^",7)=T Q
"RTN","LRBLDCU",20,0)
Z W !,"Enter donation value for ",LRB(X),": " R E:60 Q:E=""!(E[U)  I E'?1N.N!(E<0)!(E>99) W !,$C(7),"Enter a whole number from 0 to 99" G Z
"RTN","LRBLDCU",21,0)
 S E(X)=E Q
"RTN","LRBLDCU",22,0)
H I $D(^LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLDCU",23,0)
 D F^LRU W !?20,"BLOOD DONORS TO RECEIVE NEW AWARDS"
"RTN","LRBLDCU",24,0)
 W !,"Donor",?33,"DOB",?41,"Total Awards",?55,"Cumulative donations",!,LR("%") Q
"RTN","LRBLDCU",25,0)
END D V^LRU Q
"RTN","LRBLDCU",26,0)
 ; Line E stops processing any donor not donating in past year
"RTN","LRBLDED")
0^3^B7884301^B7786610
"RTN","LRBLDED",1,0)
LRBLDED ;AVAMC/REG/CYM - BLOOD DONOR EDIT ;5/1/97  12:10 ;
"RTN","LRBLDED",2,0)
 ;;5.2;LAB SERVICE;**90,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDED",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDED",4,0)
O Q  D END S LRC="",LRD("U")=1
"RTN","LRBLDED",5,0)
ASK S LRA=0 D G G:Y<1 END D REST G ASK
"RTN","LRBLDED",6,0)
REST I 'LRA W $C(7),!?28,"DONOR PREVIOUSLY ENTERED.",!?3,"THIS OPTION IS FOR ENTERING OLD DATA ON DONORS NOT PREVIOUSLY ENTERED !" Q
"RTN","LRBLDED",7,0)
 S DR="[LRBLDOLD]" D ^DIE I $D(Y) W !,$C(7),"Respond to ALL prompts. No '^' allowed ! ENTRY DELETED" S DIK="^LRE(" D ^DIK K DIK Q
"RTN","LRBLDED",8,0)
SH W @IOF S DR="0;1;2;4" D EN^DIQ W !,"EDIT above information: " S %=2 D YN^LRU Q:%<1  I %=1 K DR S DR="[LRBLDEMO]" D ^DIE G SH
"RTN","LRBLDED",9,0)
 S:'$D(^LRE(DA,5,0)) ^(0)="^65.54DA^^" S LRQ=DA
"RTN","LRBLDED",10,0)
DD W ! K LRZ S DA(1)=LRQ,DIC="^LRE(LRQ,5,",DIC(0)="AEQLM",DLAYGO=65 D ^DIC K DIC,DLAYGO Q:Y<1
"RTN","LRBLDED",11,0)
 S DA=+Y,DIE="^LRE(LRQ,5,",DR=".011////^S X=DUZ;.14///^S X=""YES"";.01;.02//^S X=LRC;S:X LRC=$P(^LAB(65.4,X,0),U);.03;1//^S X=""WHOLE BLOOD"";S:X'=""N"" Y=1.1;2;S LRZ=1,Y=0;1.1//^S X=""HOMOLOGOUS"";3//^S X=""NONE"""
"RTN","LRBLDED",12,0)
 D ^DIE G:$D(Y)!($D(LRZ)) DD
"RTN","LRBLDED",13,0)
ID R !,"DONOR UNIT ID: ",X:DTIME G:X=""!(X[U) DD S X(1)=DA D ^LRBLU I '$D(X) W $C(7),! W:$D(^DD(65.54,4,3)) ^(3) X:$D(^(4)) ^(4) G ID
"RTN","LRBLDED",14,0)
 S $P(^LRE(LRQ,5,DA,0),"^",4)=X,^LRE("C",X,LRQ,DA)="" G DD
"RTN","LRBLDED",15,0)
 ;
"RTN","LRBLDED",16,0)
D Q  D END,G G:Y<1 END G:$D(LR("CK")) D S DR="[LRBLDEMO]" D ^DIE D FRE^LRU W @IOF S DR="0;1;2;4" D:$G(DA) EN^DIQ G D
"RTN","LRBLDED",17,0)
E Q  D END,D^LRBLU G:'$D(X) END D G G:Y<1 END G:$D(LR("CK")) E S DR="[LRBLDCP]" D ^DIE D FRE^LRU G E
"RTN","LRBLDED",18,0)
B Q  D END,G G:Y<1 END G:$D(LR("CK")) B S DR="[LRBLDEDIT]" D ^DIE D FRE^LRU G B
"RTN","LRBLDED",19,0)
C Q  D END,G G:Y<1 END G:$D(LR("CK")) C S DR="[LRBLDON]" D ^DIE D FRE^LRU K LRP G C
"RTN","LRBLDED",20,0)
EN Q  D G G:Y<1 END G:$D(LR("CK")) EN S DR=.085 D ^DIE D FRE^LRU G EN
"RTN","LRBLDED",21,0)
R D ^LRBLDRR Q
"RTN","LRBLDED",22,0)
G K LR("CK"),DA,DQ,DIC,DIE,DR S IOP="HOME" D ^%ZIS
"RTN","LRBLDED",23,0)
 I '$D(LRAA) S X="BLOOD BANK" D ^LRUTL K LRDPAF
"RTN","LRBLDED",24,0)
 S (DIC,DIE)="^LRE(",DIC(0)="AEQLMZ",DLAYGO=65,D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D") W ! D MIX^DIC1 K DIC,DLAYGO,DR Q:Y<1
"RTN","LRBLDED",25,0)
 S DA=+Y I $P(Y,U,3) S LRA=1,LRP=$P(Y,U,2) D ^LRBLD G:'$D(DA) G S Y=DA
"RTN","LRBLDED",26,0)
 D CK^LRU Q
"RTN","LRBLDED",27,0)
 ;
"RTN","LRBLDED",28,0)
END D V^LRU Q
"RTN","LRBLDEL")
0^4^B12432038^B12423140
"RTN","LRBLDEL",1,0)
LRBLDEL ;AVAMC/REG - DELETE FILE 65 ENTRIES ;8/14/90  14:36 ;
"RTN","LRBLDEL",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDEL",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDEL",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END
"RTN","LRBLDEL",5,0)
 W !!?25,"DELETE INVENTORY FILE ENTRIES",!?28,"WITH FINAL DISPOSITIONS"
"RTN","LRBLDEL",6,0)
 I '$D(^LRO(69.2,LRAA,8,65,1)) W !!?26,$C(7),"NO DELETION LIST",!,"USE Print units with final disposition OPTION under supervisor OPTIONS" G END:'$D(^XUSEC("LRLIASON",DUZ)),A
"RTN","LRBLDEL",7,0)
 S X=^LRO(69.2,LRAA,8,65,0),LR=0
"RTN","LRBLDEL",8,0)
 W !!?15,"Units received from: ",$P(X,U,2)," to ",$P(X,U,3),!?15,"with final dispositions will be deleted. OK " S %=2 D YN^LRU G:%'=1 END
"RTN","LRBLDEL",9,0)
 D WAIT^LRU W !,"."
"RTN","LRBLDEL",10,0)
 S X=0 F LRA=1:1 S X=$O(^LRO(69.2,LRAA,8,65,1,X)) Q:'X  I $D(^LRD(65,X,0)) S Y=^(0),C=$P(Y,"^",4),R=$P(Y,"^",5),E=$P(Y,"^",6),Z=$P(Y,"^") D K
"RTN","LRBLDEL",11,0)
OUT L +^LRD(65) S X(1)=$O(^LRD(65,0)) S:'X(1) X(1)=0 S X=^LRD(65,0),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-LR) L -^LRD(65) K ^LRO(69.2,LRAA,8,65,1) W $C(7),!!,"Deletion completed.",! G END
"RTN","LRBLDEL",12,0)
K W:LRA#25=0 "." F W=0:0 S W=$O(^LRD(65,X,3,W)) Q:'W  S V=+^(W,0) K ^LRD(65,"AL",V,X)
"RTN","LRBLDEL",13,0)
 F W=0:0 S W=$O(^LRD(65,X,15,W)) Q:'W  S V=$P(^(W,0),"^",8) K:V ^LRD(65,"A",V,X)
"RTN","LRBLDEL",14,0)
 I $D(^LRD(65,X,8)) S LRP=+^(8) K:LRP ^LRD(65,"AU",LRP,X)
"RTN","LRBLDEL",15,0)
 F W=0:0 S W=$O(^LRD(65,X,2,W)) Q:'W  K ^LRD(65,"AP",W,X) F V=0:0 S V=$O(^LRD(65,X,2,W,1,V)) Q:'V  S Y=$P(^(V,0),"^",9) I Y K ^LRD(65,"AN",Y,X,W,V)
"RTN","LRBLDEL",16,0)
 S DA=X D K^LRBLU
"RTN","LRBLDEL",17,0)
 S X(1)=$S($D(^LRD(65,X,4)):$P(^(4),"^",2),1:"") K:X(1) ^LRD(65,"AB",X(1),X)
"RTN","LRBLDEL",18,0)
 K ^LRD(65,X),^LRD(65,"A",R,X),^LRD(65,"B",Z),^LRD(65,"AT",Z),^LRD(65,"AI",C,Z),^LRD(65,"AE",C,E,X),^LRO(69.2,LRAA,8,65,1,X),^LRO(69.2,LRAA,8,65,1,"B",Z)
"RTN","LRBLDEL",19,0)
 S LR=LR+1 Q
"RTN","LRBLDEL",20,0)
A G:$P($T(LRBLDEL+1),"~",2)<5.3 END
"RTN","LRBLDEL",21,0)
 W !!,"To delete units without a deletion list:",!,"Did you make a backup tape of the BLOOD INVENTORY file " S %=2 D YN^LRU G:%'=1 END
"RTN","LRBLDEL",22,0)
 W !,"Did you check the backup tape " S %=2 D YN^LRU G:%'=1 END W !!?19,"Ok to delete units with final disposition",!?19,"from one date received to another " S %=2 D YN^LRU G:%'=1 END W !
"RTN","LRBLDEL",23,0)
 D B G:Y<0 END S LRLDT=LRLDT+.99,LRSDT=LRSDT-.0001,LR=0 D WAIT^LRU
"RTN","LRBLDEL",24,0)
 F A=1:1 S LRSDT=$O(^LRD(65,"A",LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  F X=0:0 S X=$O(^LRD(65,"A",LRSDT,X)) Q:'X  I $D(^LRD(65,X,4)),$P(^(4),"^")]"",$D(^(0)) S Y=^(0),C=$P(Y,"^",4),R=$P(Y,"^",5),E=$P(Y,"^",6),Z=$P(Y,"^") D:R=LRSDT K
"RTN","LRBLDEL",25,0)
 G OUT
"RTN","LRBLDEL",26,0)
 ;
"RTN","LRBLDEL",27,0)
B S %DT="AEX",%DT(0)="-N",%DT("A")="Start with Date: " D ^%DT K %DT
"RTN","LRBLDEL",28,0)
 Q:Y<1  S LRSDT=Y
"RTN","LRBLDEL",29,0)
 S %DT="AEX",%DT("A")="Go    to   Date " D ^%DT K %DT
"RTN","LRBLDEL",30,0)
 Q:Y<1  S LRLDT=Y I LRSDT>LRLDT S X=LRSDT,LRSDT=LRLDT,LRLDT=X
"RTN","LRBLDEL",31,0)
 S Y=LRSDT D D^LRU S LRSTR=Y,Y=LRLDT D D^LRU S LRLST=Y Q
"RTN","LRBLDEL",32,0)
END D V^LRU Q
"RTN","LRBLDK")
0^5^B4995737^B4986215
"RTN","LRBLDK",1,0)
LRBLDK ;AVAMC/REG - DELETE EX-DONORS (65.5 ENTRIES) ; 11/12/88  13:19 ;
"RTN","LRBLDK",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDK",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDK",4,0)
 Q  D V^LRU S X="BLOOD BANK" D ^LRUTL G:Y=-1 END
"RTN","LRBLDK",5,0)
 W !!?15,"DONORS WHO HAVE NOT DONATED SINCE A SPECIFIED DATE",!
"RTN","LRBLDK",6,0)
 I '$D(^LRO(69.2,LRAA,8,65.5,1)) W !!?32,$C(7),"NO DELETION LIST",!!?14,"To obtain a list of donors to delete first print them",!,"using the Print ex-donors OPTION under supervisor OPTIONS" G END
"RTN","LRBLDK",7,0)
 S X=^LRO(69.2,LRAA,8,65.5,0),LR=$P(^(1,0),U,4)
"RTN","LRBLDK",8,0)
 W !!?20,"DONORS NOT DONATING SINCE ",$P(X,U,2),!?20,"will be deleted. OK " S %=2 D YN^LRU G:%'=1 END
"RTN","LRBLDK",9,0)
 D WAIT^LRU W !,"."
"RTN","LRBLDK",10,0)
 S X=0 F A=1:1 S X=$O(^LRO(69.2,LRAA,8,65.5,1,X)) Q:'X  I $D(^LRE(X,0)) S Y=^(0),Z=$P(Y,"^"),Z(1)=$E(Y,1)_$E($P(Y,"^",3),4,7),S=$P(Y,"^",13) D K
"RTN","LRBLDK",11,0)
 L +^LRE(0) S X=^LRE(0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-LR) L -^LRE(0) G END
"RTN","LRBLDK",12,0)
K W:A#25=0 "." F W=0:0 S W=$O(^LRE(X,5,W)) Q:'W  S W(1)=^(W,0),V=+W(1) K ^LRE("AD",$P(V,".",1),X) S W(4)=$P(W(1),"^",4) I W(4)]"" K ^LRE("C",W(4),X,W),^LRE("AT",W(4)) K:$L(W(4))>2 ^LRE("C",$E(W(4),3,12),X,W)
"RTN","LRBLDK",13,0)
 I S]"" K ^LRE("G",S,X) S S=$E(Z)_$E(S,6,10) K ^LRE("G4",S,X)
"RTN","LRBLDK",14,0)
 K ^LRE("D",Z(1),X),^LRE("B",Z,X),^LRE(X) Q
"RTN","LRBLDK",15,0)
 ;
"RTN","LRBLDK",16,0)
END D V^LRU Q
"RTN","LRBLDLG")
0^6^B24862807^B24837211
"RTN","LRBLDLG",1,0)
LRBLDLG ;AVAMC/REG/CYM - BB DONOR LOG-IN ;1/29/97  12:48 ;
"RTN","LRBLDLG",2,0)
 ;;5.2;LAB SERVICE;**90,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDLG",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDLG",4,0)
 Q  D V^LRU S LR("SSN")=$P($G(^LAB(69.9,1,8,1,0)),U,5),LR("LRBLDLG")="",X="BLOOD BANK" D ^LRUTL G:Y=-1 END D EN1^LRBLY,D^LRBLU G:'$D(X) END
"RTN","LRBLDLG",5,0)
 W @IOF,?30,"Log-in donor visits",! I LRCAPA D Z^LRBLWD G:$D(LRX) END
"RTN","LRBLDLG",6,0)
 S %DT="AEX",%DT(0)="-N",%DT("A")="Enter DONATION DATE: TODAY// " D ^%DT K %DT I X="" S Y=DT W LRH(0)
"RTN","LRBLDLG",7,0)
 G:Y<1 END S (LRAD,X)=Y,LRI=9999999-Y D DW^%DTC W " ",X S:'$D(^LRO(69.2,LRAA,5,0)) ^(0)="^69.24A^0^0"
"RTN","LRBLDLG",8,0)
 W !!,"For a group of donors COLLECTION SITE & DONATION GROUP need be entered once.",!,"If not desired just press 'RETURN' key after the following two prompts.",!!
"RTN","LRBLDLG",9,0)
 S DIC=65.4,DIC("S")="I $P(^(0),U,2)[""C""",DIC("A")="Enter COLLECTION SITE: ",DIC(0)="AEQM" D ^DIC K DIC G:X[U END S LR=$S(Y=-1:"",1:+Y)
"RTN","LRBLDLG",10,0)
 S DIC=65.4,DIC(0)="AEQM",DIC("A")="Enter DONATION GROUP: ",DIC("S")="I $P(^(0),U,2)[""G""" D ^DIC K DIC G:X[U END S LR(1)=$S(Y=-1:"",1:+Y)
"RTN","LRBLDLG",11,0)
DNR K LRC,DIC,DIE,DR,DA,LR("CK")
"RTN","LRBLDLG",12,0)
 W !! S (DIC,DIE)="^LRE(",DIC(0)="AEQLMZ",DLAYGO=65,D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D") D MIX^DIC1 K DIC,DLAYGO G:Y<1 END
"RTN","LRBLDLG",13,0)
 S (LRQ,DA)=+Y,(LRP,LRP(0))=$P(Y,U,2) I $P(Y,U,3) D ^LRBLD G:'$D(DA) DNR D ADD G OK
"RTN","LRBLDLG",14,0)
 S B=0 I $D(^LRE(DA,9)) S DIWR=IOM-5,DIWL=5,DIWF="W" S A=0 F B=0:1 S A=$O(^LRE(DA,9,A)) Q:'A  W:'B ! S X=^(A,0) D ^DIWP
"RTN","LRBLDLG",15,0)
 D:B ^DIWW W !,"Is this the Donor " S %=1 D YN^LRU G:%'=1 DNR
"RTN","LRBLDLG",16,0)
OK G:'$D(^LRE(LRQ,0)) DNR S X=^(0),X1=DT,(X2,LRD)=$P(X,"^",3),LRB=$E(X2,4,5)_"-"_$E(X2,6,7)_"-"_$E(X2,2,3),LRS(2)=$P(X,"^",13) D ^%DTC S X=X\365.25
"RTN","LRBLDLG",17,0)
 I X<18 W $C(7),!!,"Age:",X,"  Does donor have permission to donate " S %=1 D YN^LRU G:%'=1 DNR
"RTN","LRBLDLG",18,0)
 I X>64 W $C(7),"  Age: ",X,!?7,"Does donor have physician permission to donate " S %=1 D YN^LRU G:%'=1 DNR
"RTN","LRBLDLG",19,0)
 W @IOF S (DIE,DIC)="^LRE(",DA=LRQ,DR="0;1;2;4" D EN^DIQ
"RTN","LRBLDLG",20,0)
 I $P(^LRE(LRQ,0),U,10) W $C(7),!!,$P(^(0),U)," permanently deferred except for autologous",!,"or therapeutic donation.  If any questions see physician in charge.",!!,"Do you want autologous/therapeutic donation " S %=2 D YN^LRU G:%'=1 DNR
"RTN","LRBLDLG",21,0)
 I LR("SSN"),$P(^LRE(LRQ,0),U,13)="" S DA=LRQ,DR=.13,DIE="^LRE(" D ^DIE
"RTN","LRBLDLG",22,0)
 W !,"EDIT above information: " S %=2 D YN^LRU G:%<1 DNR I %=1 K DR D CK^LRU G:$D(LR("CK")) DNR S DR="[LRBLDEMO]" D ^DIE D FRE^LRU G OK
"RTN","LRBLDLG",23,0)
 S X=$O(^LRE(LRQ,5,0)) I X S Y=+^(X,0) D D^LRU W "  Last visit: ",Y
"RTN","LRBLDLG",24,0)
 S:'$D(^LRE(LRQ,5,0)) ^(0)="^65.54DA^^" I '$D(^(LRI,0)) L +^LRE(LRQ,5) S X=$P(^LRE(LRQ,5,0),"^",4),^(0)="^65.54DA^"_LRI_"^"_(X+1),^(LRI,0)=LRAD_"^^^^^"_LR_"^"_LR(1),^LRE("AD",$P(LRAD,"."),LRQ)="" L -^LRE(LRQ,5)
"RTN","LRBLDLG",25,0)
 S (LR(65.54,1),LR(65.54,1.1),LRA)="",DA=LRI,DA(1)=LRQ,DIE="^LRE(LRQ,5,"
"RTN","LRBLDLG",26,0)
A S DR=".02;.03;.13//^S X=""NOW"";1//^S X=""WHOLE BLOOD"";S LR(65.54,1)=X;S:X=""N"" Y=2;1.1//^S X=""HOMOLOGOUS"";S LR(65.54,1.1)=X;S:X=""A"" LRA=LRP;S LRT=X;S:""AD""'[X Y=0;W !!;1.2//^S X=LRA;S Y=0;2"
"RTN","LRBLDLG",27,0)
 D ^DIE I $D(Y) G:$P(^LRE(LRQ,5,LRI,0),U,4)]"" DNR W $C(7),!!,"Delete all data from this donation " S %=2 D YN^LRU G:%'=1 A S DA=LRI,DIK="^LRE(LRQ,5," D ^DIK K DIK G DNR
"RTN","LRBLDLG",28,0)
 I LR(65.54,1.1)="A",'$P(^LRE(LRQ,5,LRI,0),U,12) W $C(7),!!,"Autologous donation and RESTRICTED FOR: field not entered.",!,"Delete all data from this donation " S %=2 D YN^LRU G:%'=1 A S DA=LRI,DIK="^LRE(LRQ,5," D ^DIK K DIK G DNR
"RTN","LRBLDLG",29,0)
 I LR(65.54,1)="N" D EN^LRBLY D:LRCAPA N^LRBLWD G DNR
"RTN","LRBLDLG",30,0)
 S LR(65.54)=LR(65.54,1.1)_LR(65.54,1),X1=9999999-LRI,X2=-55 D C^%DTC S Z(1)=9999999-X
"RTN","LRBLDLG",31,0)
 F X=LRI:0 S X=$O(^LRE(LRQ,5,X)) Q:'X!(X>Z(1))  S Y=$P(^(X,0),"^",2) I LR(65.54,1)="W",LR(65.54,1.1)="H",Y="W" W !!,"LAST WHOLE BLOOD DONATION " S LRC=1,(Y,Z)=+^(0) D D^LRU W Y Q
"RTN","LRBLDLG",32,0)
 I $D(LRC) S X1=LRAD,X2=Z D ^%DTC I X<56 W $C(7),!!,"SORRY NOT 8 WEEKS SINCE LAST DONATION OF WHOLE BLOOD" S X1=Z,X2=56 D C^%DTC S Y=X D D^LRU W !,"COME BACK ON OR AFTER ",Y D RES D:LRCAPA N^LRBLWD G DNR
"RTN","LRBLDLG",33,0)
 I LRCAPA D @(LR(65.54)_"^LRBLWD")
"RTN","LRBLDLG",34,0)
 D EN^LRBLY W !,"Enter donor in list for printing registration form " S %=2 D YN^LRU G:%'=1 MORE
"RTN","LRBLDLG",35,0)
 S ^LRO(69.2,LRAA,5,LRQ,0)=LRQ_"^65.5^"_LRP,^LRO(69.2,LRAA,5,"C",LRP,LRQ)="" G DNR
"RTN","LRBLDLG",36,0)
MORE W !!,"Continue to enter collection information " S %=1 D YN^LRU G:%'=1 DNR
"RTN","LRBLDLG",37,0)
 K DA,DR,DIE,DIC,DR,DQ S (DIC,DIE)="^LRE(",DA=LRQ,DR="[LRBLDCPN]" D ^DIE G DNR
"RTN","LRBLDLG",38,0)
ADD S DR=$S(LRH(2):"[LRBLDNEWM]",1:"[LRBLDNEW]") D ^DIE Q
"RTN","LRBLDLG",39,0)
RES S X=^LRE(LRQ,5,LRI,0),^(0)=$P(X,"^")_"^"_"N"_"^"_$P(X,"^",3,99) Q
"RTN","LRBLDLG",40,0)
END D V^LRU Q
"RTN","LRBLDMV")
0^7^B8139587^B8125382
"RTN","LRBLDMV",1,0)
LRBLDMV ;AVAMC/REG - MOVE BLOOD DONATION ;12/19/94  11:53 ;
"RTN","LRBLDMV",2,0)
 ;;5.2;LAB SERVICE;**26,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDMV",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDMV",4,0)
 Q  W !!?17,"Move a donation from one donor to another",!
"RTN","LRBLDMV",5,0)
ASK D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END D REST G:Y=1 ASK
"RTN","LRBLDMV",6,0)
 ;
"RTN","LRBLDMV",7,0)
REST W ! S DIC=65.5,DIC(0)="AEQMZ",DIC("A")="MOVE FROM DONOR: " D ^DIC Q:Y<1  S LRF=+Y D A
"RTN","LRBLDMV",8,0)
 I '$O(^LRE(LRF,5,0)) W $C(7),!!,"No donation date." Q
"RTN","LRBLDMV",9,0)
 W ! S DIC="^LRE(LRF,5," S DIC("A")="  DONATION DATE: " D ^DIC K DIC Q:Y<1  S LRI=+Y,LRU=$P(Y(0),U,4),(Y,LRD)=$P($P(Y(0),U),".") D D^LRU S LRD(1)=Y
"RTN","LRBLDMV",10,0)
 I LRU="" W $C(7),!,"No unit ID entered. Do you want to continue" S %=2 D YN^LRU Q:%'=1  S LRU="NONE"
"RTN","LRBLDMV",11,0)
 W " UNIT ID: ",LRU S DIE="^LRE(LRF,5,",DA=LRF D CK^LRU I $D(LR("CK")) D FRE^LRU Q
"RTN","LRBLDMV",12,0)
 W ! S DIC=65.5,DIC(0)="AEQMZ",DIC("A")="MOVE TO DONOR: " D ^DIC K DIC Q:Y<1  S LRT=+Y,LRT(1)=$P(Y,U,2) D A I $D(^LRE(LRT,5,LRI,0)) W $C(7),!!,"Donation date ",LRD(1)," exists for ",LRT(1) Q
"RTN","LRBLDMV",13,0)
 W $C(7),!!?3,"OK TO MOVE" S %=2 D YN^LRU I %'=1 D FRE^LRU Q
"RTN","LRBLDMV",14,0)
 S:'$D(^LRE(LRT,5,0)) ^(0)="^65.54DA^^"
"RTN","LRBLDMV",15,0)
 S %X="^LRE(LRF,5,LRI,",%Y="^LRE(LRT,5,LRI," D %XY^%RCR S X=^LRE(LRT,5,0),^(0)=$P(X,"^",1,2)_"^"_LRI_"^"_($P(X,"^",4)+1)
"RTN","LRBLDMV",16,0)
 K ^LRE(LRF,5,LRI),^LRE("AD",LRD,LRF),^LRE("C",LRU,LRF,LRI),^LRE("AT",LRU) S X=^LRE(LRF,5,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-1)
"RTN","LRBLDMV",17,0)
 S ^LRE("AD",LRD,LRT)="",DA=LRI,DA(1)=LRT I LRU'="NONE" S ^LRE("C",LRU,LRT,LRI)="",X=LRU X ^DD(65.54,4,1,2,1)
"RTN","LRBLDMV",18,0)
 S Z="65.54,.01",X="",O=LRD,DA(1)=LRF D EN^LRUD S DA(1)=LRT,O="",X=LRD,Z="65.54,.01" D EN^LRUD
"RTN","LRBLDMV",19,0)
 D FRE^LRU S Y=1 Q
"RTN","LRBLDMV",20,0)
F D E S A=0 F LRZ=0:1 S A=$O(^LRE(LR,99,A)) Q:'A  S X=^LRE(LR,99,A,0) D ^DIWP
"RTN","LRBLDMV",21,0)
 D:LRZ ^DIWW Q
"RTN","LRBLDMV",22,0)
E K ^UTILITY($J) S DIWR=IOM-5,DIWL=5,DIWF="W" Q
"RTN","LRBLDMV",23,0)
 ;
"RTN","LRBLDMV",24,0)
A S LRABO=$P(Y(0),U,5),LRRH=$P(Y(0),U,6) W !,"ABO GROUP: ",LRABO,"  Rh TYPE: ",LRRH
"RTN","LRBLDMV",25,0)
 S LR=+Y,X=$G(^LRE(LR,1)) W ?30,"File Number: ",LR,?50,"SSN: ",$P(Y(0),U,13),!,$P(X,U)," ",$P(X,U,2)," ",$P(X,U,3),!,$P(X,U,4)," ",$P($G(^DIC(5,+$P(X,U,5),0)),U)," ",$P(X,U,6)
"RTN","LRBLDMV",26,0)
 I $P(Y(0),U,10) W $C(7),!!," PERMANENT DEFERRAL " S Y=$P(Y(0),U,16) D D^LRU W " ",Y D F
"RTN","LRBLDMV",27,0)
 Q
"RTN","LRBLDMV",28,0)
 ;
"RTN","LRBLDMV",29,0)
END D V^LRU Q
"RTN","LRBLDPH")
0^8^B12502276^B12474385
"RTN","LRBLDPH",1,0)
LRBLDPH ;AVAMC/REG - DONOR PHENOTYPING ;3/9/94  12:51
"RTN","LRBLDPH",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDPH",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDPH",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END S IOP="HOME" D ^%ZIS,L^LRU I LRCAPA S X="DONOR PHENOTYPING",X("NOCODES")=1 D X^LRUWK G:'$D(X) END
"RTN","LRBLDPH",5,0)
D S (DIC,DIE)="^LRE(",DIC(0)="AEQM",D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D") W ! D MIX^DIC1 K DIC G:Y<1 END D REST K LR("CK") G D
"RTN","LRBLDPH",6,0)
REST S (DA,LRQ)=+Y D CK^LRU Q:$D(LR("CK"))  S Y=$O(^LRE(DA,5,0)) I 'Y W $C(7),!,"Must have donation date to enter phenotyping." Q
"RTN","LRBLDPH",7,0)
 W ! S DIC="^LRE(LRQ,5,",DIC(0)="AEQM",DIC("A")="Select donation date phenotyping specimen taken: ",DIC("B")=+^LRE(DA,5,Y,0) D ^DIC K DIC Q:Y<1  S LRI=+Y
"RTN","LRBLDPH",8,0)
 D P S DA=LRQ,DIE="^LRE(",DR="[LRBLDAG]" D ^DIE D FRE^LRU D:LRCAPA WK
"RTN","LRBLDPH",9,0)
 S DA(1)=LRQ F LRM=0:0 S LRM=$O(LRM(LRM)) Q:'LRM  F M=0:0 S M=$O(LRM(LRM,M)) Q:'M  I '$D(^LRE(LRQ,LRM,M)) S O=M,X="deleted",Z=LRM(LRM,M)_",.01" D EN^LRUD
"RTN","LRBLDPH",10,0)
 K M,LRM,O Q
"RTN","LRBLDPH",11,0)
 ;
"RTN","LRBLDPH",12,0)
P I '$O(^LRE(LRQ,1.1,0)),'$O(^LRE(LRQ,1.2,0)) Q
"RTN","LRBLDPH",13,0)
 W !!?40,"Antigen(s) present",?60,"| Antigen(s) absent",!,LR("%"),!,"Donor Phenotype Record:"
"RTN","LRBLDPH",14,0)
 S E=1,(F(1),G)="" F B=0:0 S B=$O(^LRE(LRQ,1.1,B)) Q:'B  S I=$P(^LAB(61.3,B,0),"^"),F(E)=F(E)_I_" ",G=G+1 I $L(F(E))>19 S F(E)=$P(F(E)," ",1,G-1),E=E+1,F(E)=I_" ",G=""
"RTN","LRBLDPH",15,0)
 S K=E,E=1,(J(1),G)="" F B=0:0 S B=$O(^LRE(LRQ,1.2,B)) Q:'B  S I=$P(^LAB(61.3,B,0),"^"),J(E)=J(E)_I_" ",G=G+1 I $L(J(E))>18 S J(E)=$P(J(E)," ",1,G-1),E=E+1,J(E)=I_" ",G=""
"RTN","LRBLDPH",16,0)
 S:E>K K=E F E=1:1:K W:E>1 ! W:$D(F(E)) ?40,$J(F(E),19) W:$D(J(E)) ?60,"|",$J(J(E),18)
"RTN","LRBLDPH",17,0)
 W ! Q
"RTN","LRBLDPH",18,0)
 ;
"RTN","LRBLDPH",19,0)
WK D DT^LRBLU K LRG ;enter workload
"RTN","LRBLDPH",20,0)
 S:'$D(^LRE(LRQ,5,LRI,99,0)) ^(0)="^65.599PA^^" I '$D(^(LRT,0)) S ^(0)=LRT,X=^LRE(LRQ,5,LRI,99,0),^(0)=$P(X,"^",1,2)_"^"_LRT_"^"_($P(X,"^",4)+1)
"RTN","LRBLDPH",21,0)
 S:'$D(^LRE(LRQ,5,LRI,99,LRT,1,0)) ^(0)="^65.5991DA^^" I '$D(^LRE(LRQ,5,LRI,99,LRT,1,LRK,0)) S ^(0)=LRK_"^"_DUZ,X=^LRE(LRQ,5,LRI,99,LRT,1,0),^(0)=$P(X,"^",1,2)_"^"_LRK_"^"_($P(X,"^",4)+1)
"RTN","LRBLDPH",22,0)
 F A=1.1,1.2,1.3,1.4 F B=0:0 S B=$O(^LRE(LRQ,A,B)) Q:'B  I '$D(LRM(A,B)) F C=0:0 S C=$O(^LAB(61.3,B,9,C)) Q:'C  D STF
"RTN","LRBLDPH",23,0)
 S:$D(LRG) ^LRE("AA",LRQ,LRI,LRT,LRK)=$P(^LRE(LRQ,5,LRI,0),"^",4) I '$D(^LRE(LRQ,5,LRI,99,LRT,1,LRK,1,0)) K ^LRE(LRQ,5,LRI,99,LRT,1,LRK) S X=^LRE(LRQ,5,LRI,99,LRT,1,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-1)
"RTN","LRBLDPH",24,0)
 Q
"RTN","LRBLDPH",25,0)
STF S LRG=1 I $D(^LRE(LRQ,5,LRI,99,LRT,1,LRK,1,C,0)) S X=$P(^(0),"^",2) S:'X X=1 S X=X+1,$P(^(0),"^",2,3)=X_"^"_0 Q
"RTN","LRBLDPH",26,0)
 S:'$D(^LRE(LRQ,5,LRI,99,LRT,1,LRK,1,0)) ^(0)="^65.59911PA^^" S X=^(0),^(0)=$P(X,"^",1,2)_"^"_C_"^"_($P(X,"^",4)+1),^(C,0)=C_"^"_1 Q
"RTN","LRBLDPH",27,0)
 ;
"RTN","LRBLDPH",28,0)
END D V^LRU Q
"RTN","LRBLDR")
0^9^B20207748^B20180505
"RTN","LRBLDR",1,0)
LRBLDR ;AVAMC/REG/CYM - DONOR REGISTRATION FORM 6/28/96  12:53 ;
"RTN","LRBLDR",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDR",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDR",4,0)
 Q  D END S LRAA=$O(^LRO(68,"B","BLOOD BANK",0)),LRB=$O(^LAB(65.4,"B","DNRHX",0)) I 'LRAA W $C(7),!!,"ENTER ""BLOOD BANK"" IN ACCESSION AREA FILE",!! G END
"RTN","LRBLDR",5,0)
 I 'LRB W $C(7),!!,"ENTER ""DNRHX"" (BLOOD DONOR HISTORY QUESTIONS) IN BLOOD BANK UTILITY FILE",!! G END
"RTN","LRBLDR",6,0)
 S:'$D(^LRO(69.2,LRAA,5,0)) ^(0)="^69.24A^0^0" S IOP="HOME" D ^%ZIS
"RTN","LRBLDR",7,0)
 W !!?20,"Donor registration forms",!!
"RTN","LRBLDR",8,0)
 I $O(^LRO(69.2,LRAA,5,0)) W "Display list of donors for printing registration forms " S %=2 D YN^LRU G:%<1&(%Y'="@") END D S^LRBLDR1:%=1,D^LRBLDR1:%Y="@"
"RTN","LRBLDR",9,0)
 W !!,"Add all donors from a GROUP AFFILIATION: " S %=2 D YN^LRU G:%<1 END D:%=1 A^LRBLDR1
"RTN","LRBLDR",10,0)
DNR S DIC="^LRE(",DIC(0)="AEQM",D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D"),DIC("A")="Add Donor Name to list: " D MIX^DIC1 K DIC I Y>0 S ^LRO(69.2,LRAA,5,+Y,0)=+Y_"^65.5^"_$P(Y,U,2),^LRO(69.2,LRAA,5,"C",$P(Y,U,2),+Y)="" G DNR
"RTN","LRBLDR",11,0)
 I $O(^LRO(69.2,LRAA,5,0))'>0 W $C(7),!!,"No list for printing donor registration forms !",!! G END
"RTN","LRBLDR",12,0)
 W !!,"Print donor registration forms " S %=2 D YN^LRU G:%'=1 END
"RTN","LRBLDR",13,0)
 S DIC="^LAB(65.4,",DIC(0)="AEQMZ",DIC("A")="Select COLLECTION SITE to appear on form: ",DIC("S")="I $P(^(0),U,2)[""C""" D ^DIC K DIC G:X[U!(X="") END S S=$P(Y(0),U,3)
"RTN","LRBLDR",14,0)
 S X="T",%DT="" D ^%DT S LRD=Y D D^LRU S T=Y,%DT="AEQ",%DT("A")="Date to appear on form: ",%DT("B")=T D ^%DT K %DT G:Y<1 END D D^LRU S T=Y
"RTN","LRBLDR",15,0)
 S ZTRTN="QUE^LRBLDR" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLDR",16,0)
QUE U IO D L^LRU,S^LRU S DIWR=IOM-5,DIWL=5,DIWF="W" D FIELD^DID(65.54,1,"","POINTER","LRF") S LRF=LRF("POINTER"),Y=$O(^LAB(65.4,"B","DNRCX",0)) I Y S LRC=0 F X=0:0 S X=$O(^LAB(65.4,Y,3,X)) Q:'X  S J(X)=^(X,0),LRC=LRC+1
"RTN","LRBLDR",17,0)
 S LRC=LRC+6,C=0 F B=0:0 S C=$O(^LRO(69.2,LRAA,5,"C",C)) Q:C=""!(LR("Q"))  F W=0:0 S W=$O(^LRO(69.2,LRAA,5,"C",C,W)) Q:'W  K A,Z S LRQ=0 D PRT
"RTN","LRBLDR",18,0)
 K ^LRO(69.2,LRAA,5) S ^LRO(69.2,LRAA,5,0)="^69.24A^0^0" W:IOST'?1"C".E @IOF D END^LRUTL,END Q
"RTN","LRBLDR",19,0)
PRT I '$D(^LRE(W,0)) K ^LRO(69.2,LRAA,5,"C",C,W),^LRO(69.2,LRAA,5,W) Q
"RTN","LRBLDR",20,0)
 S Z=^LRE(W,0),N=$P(Z,"^"),SEX=$P(Z,"^",2),DOB=$P(Z,"^",3),E=$P(Z,"^",5),F=$P(Z,"^",6),M=$P(Z,"^",7),R=$P(Z,"^",4),G=$P(Z,"^",10),G(16)=$P(Z,"^",16),SSN=$P(Z,"^",13),Y=DOB D D^LRU S DOB=Y S:DOB[1700 DOB="" D:SSN]"" SSN^LRU
"RTN","LRBLDR",21,0)
 S Z=$S($D(^LRE(W,1)):^(1),1:""),Z(5)="" S:$P(Z,"^",5) Z(5)=$S($D(^DIC(5,$P(Z,"^",5),0)):$P(^(0),"^"),1:"")
"RTN","LRBLDR",22,0)
 S A(1)=$P(Z,"^"),A(2)=$P(Z,"^",2),A(3)=$P(Z,"^",3),A(4)=$P(Z,"^",4),A(6)=$P(Z,"^",6),A(7)=$P(Z,"^",7),A(8)=$P(Z,"^",8)
"RTN","LRBLDR",23,0)
 S X=$O(^LRE(W,5,0)),(LR(65.54,.01),LR(65.54,1))="" I X S:+^(X,0)=LRD X=$O(^LRE(W,5,X)) I X S X=^LRE(W,5,X,0),Y=$P($P(X,"^"),".") D D^LRU S LR(65.54,.01)=Y,X=$P(X,"^",2) I X]"" S X=X_":",X=$P($P(LRF,X,2),";")
"RTN","LRBLDR",24,0)
 S LR(65.54,1)=X D H S LR("F")=1 W !!,"DONOR HISTORY" K ^TMP($J)
"RTN","LRBLDR",25,0)
 S K=0 F LRZ=0:1 S K=$O(^LAB(65.4,LRB,2,K)) Q:'K!(LR("Q"))  S LRX=^(K,0) D:$Y>(IOSL-6) H1 Q:LR("Q")  S X=LRX D ^DIWP
"RTN","LRBLDR",26,0)
 Q:LR("Q")  D:LRZ ^DIWW
"RTN","LRBLDR",27,0)
 D C Q:LR("Q")  W !!,"Date ..................at .....(time)",?40 F X=1:1:39 W "."
"RTN","LRBLDR",28,0)
 W !?50,"(Donor)",!!?40 F X=1:1:39 W "."
"RTN","LRBLDR",29,0)
 W !?50,"(Witness)" D H Q:LR("Q")  D ^LRBLDR1 Q
"RTN","LRBLDR",30,0)
 ;
"RTN","LRBLDR",31,0)
C W ! D:$Y>(IOSL-LRC) H1 Q:LR("Q")  K ^TMP($J) S K=0 F LRZ=0:1 S K=$O(J(K)) Q:'K  D:$Y>(IOSL-6) H Q:LR("Q")  S X=J(K) D ^DIWP
"RTN","LRBLDR",32,0)
 Q:LR("Q")  D:LRZ ^DIWW Q
"RTN","LRBLDR",33,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLDR",34,0)
 D F^LRU W !,"DONOR REGISTRATION",?60,"Date: ",T,!,"Collection site: ",S,!,LR("%")
"RTN","LRBLDR",35,0)
 W !,N,?31,"Sex: ",SEX,?38,"DOB: ",DOB W ?60,"ABO: ",E," Rh: ",F
"RTN","LRBLDR",36,0)
 I SSN]"" W !,"SSN: ",SSN
"RTN","LRBLDR",37,0)
 W !,A(1)," ",A(2)," ",A(3),!,A(4),", ",Z(5)," ",A(6),!,"Home phone: ",A(7),"  Business phone: ",A(8)
"RTN","LRBLDR",38,0)
 W !,"Employer/Donor Group(s):",?36,"Current donation type:" F X=0:0 S X=$O(^LRE(W,2,X)) Q:'X  S Y=^(X,0) W !?4,$S($D(^LAB(65.4,Y,0)):$P(^(0),"^",3),1:"")
"RTN","LRBLDR",39,0)
 W !,"Cum donations: ",M,?20,"Previous visit: ",LR(65.54,.01) I LR(65.54,1)]"" W " (",LR(65.54,1) W:LR(65.54,1)'["DONATION" " DONATION" W ")"
"RTN","LRBLDR",40,0)
 Q
"RTN","LRBLDR",41,0)
H1 D H Q:LR("Q")  W !!,"Donor History (continued from pg ",LRQ-1,")" Q
"RTN","LRBLDR",42,0)
 ;
"RTN","LRBLDR",43,0)
END D V^LRU Q
"RTN","LRBLDRR")
0^10^B25500537^B25487142
"RTN","LRBLDRR",1,0)
LRBLDRR ;AVAMC/REG/CYM - REVIEW/RELEASE COMPONENTS ;1/24/97  11:04 ;
"RTN","LRBLDRR",2,0)
 ;;5.2;LAB SERVICE;**72,90,97,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDRR",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDRR",4,0)
 Q  D E S LR("M")=1,X="BLOOD BANK" D ^LRUTL G:Y=-1 E D D^LRBLU G:'$D(X) E
"RTN","LRBLDRR",5,0)
 I LRCAPA S X="DONOR UNIT LABELING" D X^LRUWK G:'$D(X) E S Y="RR" D S^LRBLWD K LRT S X="UNIT LOG-IN/SEND-OUT" D X^LRUWK G:'$D(X) E
"RTN","LRBLDRR",6,0)
 S LRA=$S($D(^LAB(69.9,1,8,1,0)):$P(^(0),"^",2),1:0),Y="LG" D:LRCAPA S^LRBLWD
"RTN","LRBLDRR",7,0)
 W !!?20,"Review-label-release components",!!?20,LRAA(4),! D BAR^LRBLB I LR W !!?15,"STANDARD UNIT ID LABELING " S %=1 D YN^LRU G:%<1 E S LR(3)=$S(%=1:"",1:1)
"RTN","LRBLDRR",8,0)
 F A=1,6.1,10:1:16,18,19 D
"RTN","LRBLDRR",9,0)
 . D FIELD^DID(65.54,A,"","POINTER","LRB") S LRB(A)=LRB("POINTER")
"RTN","LRBLDRR",10,0)
 . D FIELD^DID(65.54,A,"","LABEL","LRN") S LRN(A)=LRN("LABEL")
"RTN","LRBLDRR",11,0)
 F A=17,20 I $G(LRH(A)) D
"RTN","LRBLDRR",12,0)
 . D FIELD^DID(65.54,A,"","POINTER","LRB") S LRB(A)=LRB("POINTER")
"RTN","LRBLDRR",13,0)
 . D FIELD^DID(65.54,A,"","LABEL","LRN") S LRN(A)=LRN("LABEL")
"RTN","LRBLDRR",14,0)
P R !!,"Select UNIT FOR LABEL/RELEASE: ",X:DTIME I LR D U^LRBLB
"RTN","LRBLDRR",15,0)
 W ! S DIC="^LRE(",DIC(0)="FQMZ",D="C^B" D MIX^DIC1 K DIC G E:X[U!(X=""),P:Y<1 S LRQ(5)=$P(Y(0),"^",5),LRQ(6)=$P(Y(0),"^",6),LRQ("X")=0
"RTN","LRBLDRR",16,0)
 I X["," D ASK G:Y<1 P D REST G P
"RTN","LRBLDRR",17,0)
 S LRQ=+Y,LRI=$O(^LRE("C",X,LRQ,0)) G:'LRI P L +^LRE(LRQ,5,LRI):5 I '$T W !,$C(7),"Someone else is editing this entry! " G P
"RTN","LRBLDRR",18,0)
 S LRG=$P(^LRE(LRQ,5,LRI,0),"^",4) D REST G P
"RTN","LRBLDRR",19,0)
 ;
"RTN","LRBLDRR",20,0)
S S F=^LAB(66,A,0),Y=$P(X,"^",3) D D^LRU S S=Y,Y=$P(X,"^",4) D D^LRU
"RTN","LRBLDRR",21,0)
 S F(B)=$P(X,"^",2)_"^"_$P(X,"^",6)_"^"_$P(X,"^",7)_"^"_$E($P(F,"^"),1,21)_"^"_S_"^"_Y_"^"_A_"^"_$P(F,"^",9)_"^"_$P(X,"^",8)_"^"_$P(F,"^",19) Q
"RTN","LRBLDRR",22,0)
 ;
"RTN","LRBLDRR",23,0)
REST S LRV=$P(^LRE(LRQ,0),"^",15),X=^(5,LRI,0),LRQ("S")=$P(X,"^",11),LRQ("D")=$P(X,"^",12),T=$S($D(^(2)):$P(^(2),"^",3),1:"") F A=10,11 S LRJ(A+.4)=$S($D(^(A)):$P(^(A),"^",4),1:"")
"RTN","LRBLDRR",24,0)
 F A=10:1:20 S (LRJ(A),LRE(A),LRW(A))=""
"RTN","LRBLDRR",25,0)
 F A=10:1:16,18,19 I $D(^LRE(LRQ,5,LRI,A)) S B=^(A),LRJ(A)=$P(B,"^"),LRW(A)=$P(B,"^",3),LRE(A)=$P(B,"^",2)
"RTN","LRBLDRR",26,0)
 F A=17,20 I $G(LRH(A)),$D(^LRE(LRQ,5,LRI,A)) S B=^(A),LRJ(A)=$P(B,U),LRW(A)=$P(B,U,3),LRE(A)=$P(B,U,2)
"RTN","LRBLDRR",27,0)
 S V=$P(X,"^",10),V(10)=LRJ(10),V(11)=LRJ(11),V(12)=V(10)_" "_V(11),LRJ(1)=$P(X,"^",2),(W,LRJ(6.1))=$P(X,"^",10)
"RTN","LRBLDRR",28,0)
 F A=1,6.1,10:1:16,18,19 S X=LRJ(A),B=LRB(A),X=$S(X]"":$P($P(B,X_":",2),";"),1:"") S LRJ(A)=X
"RTN","LRBLDRR",29,0)
 F A=17,20 I $G(LRH(A)) S X=LRJ(A),B=LRB(A),X=$S(X]"":$P($P(B,X_":",2),";"),1:"") S LRJ(A)=X
"RTN","LRBLDRR",30,0)
 W @IOF I LRQ("S")]"","AD"[LRQ("S") W $C(7)
"RTN","LRBLDRR",31,0)
 W $S(LRQ("S")="A":"AUTOLOGOUS ",LRQ("S")="D":"DIRECTED ",1:" ") I LRQ("D") W "For: " S X=^LR(LRQ("D"),0),Y=$P(X,"^",3),(LRDPF,X)=$P(X,"^",2),X=^DIC(X,0,"GL"),X=@(X_Y_",0)"),SSN=$P(X,"^",9) D SSN^LRU W $P(X,"^")," ",SSN
"RTN","LRBLDRR",32,0)
 W ?53,"Unit: ",LRG
"RTN","LRBLDRR",33,0)
 W !,"Unit testing:",?70,"Tech" F A=10:1:16,18,19 D W
"RTN","LRBLDRR",34,0)
 F A=17,20 I $G(LRH(A)) D W
"RTN","LRBLDRR",35,0)
 I LRJ(10)=""!(LRJ(11)="") W $C(7),!,"Must perform ABO/Rh testing !!",! D FRE^LRBLDRR1 Q
"RTN","LRBLDRR",36,0)
 I LRA S A=0 D EN1^LRBLDRR2 Q:A
"RTN","LRBLDRR",37,0)
 I LRJ(10)'=LRQ(5) W $C(7),!,"Donor ABO (",LRQ(5),") is different from unit ABO (",LRJ(10),"). Resolve discrepancy." S LRD=1
"RTN","LRBLDRR",38,0)
 I $E(LRJ(11),1,3)'=LRQ(6) W $C(7),!,"Donor Rh (",LRQ(6),") is different from unit Rh (",$E(LRJ(11),1,3),").  Resolve discrepancy." S LRD=1
"RTN","LRBLDRR",39,0)
 I $D(LRD),'$D(^XUSEC("LRBLSUPER",DUZ)) D FRE^LRBLDRR1 Q
"RTN","LRBLDRR",40,0)
 I $D(LRD) K LRD D SUPER I $D(LRY) K LRY Q
"RTN","LRBLDRR",41,0)
 K F S A=0 F B=1:1 S A=$O(^LRE(LRQ,5,LRI,66,A)) Q:'A  S X=^(A,0) D S
"RTN","LRBLDRR",42,0)
 I B<2 W $C(7),!!,"No components prepared !",! D FRE^LRBLDRR1 Q
"RTN","LRBLDRR",43,0)
 S Y=T D D^LRU W !!,"Donation: ",LRJ(1),?36,"Collection completed: ",Y,!?5,"Component",?36,"Date/time stored",?58,"Expiration date" S A=0
"RTN","LRBLDRR",44,0)
 F B=0:1 S A=$O(F(A)) Q:'A  S L=$P(F(A),U,9) W !,$J(A,2),".",?5,$P(F(A),U,4),?27,$S(L=2:"Discard",L=1:"Quarant",$P(F(A),U,3)]"":"released",$P(F(A),U,2)]"":"labeled",1:""),?36,$P(F(A),U,5),?58,$P(F(A),U,6)
"RTN","LRBLDRR",45,0)
 I V W $C(7),!!,LRN(6.1),": ",LRJ(6.1) Q
"RTN","LRBLDRR",46,0)
 D ^LRBLDRR1 Q
"RTN","LRBLDRR",47,0)
SUPER W !!,"If you continue with label/release of ",LRG," a message will be",!,"sent to all users holding the blood bank supervisor's key.",!,"Do you want to continue with label/release of ",LRG S %=2 D YN^LRU I %=2 D FRE^LRBLDRR1 S LRY=1 Q
"RTN","LRBLDRR",48,0)
 S LR("TXT",1,0)="Blood donor unit ID: "_LRG,LR("KEY")="LRBLSUPER",LR("SUB")="Donor unit label/release with ABO/Rh discrepancy",LR("TXT",2,0)=" Component(s) have been labeled/released with ABO/Rh donor/unit ID discrepancy"
"RTN","LRBLDRR",49,0)
 D ^LRUMSG Q
"RTN","LRBLDRR",50,0)
ASK S LRQ=+Y,DIC="^LRE(LRQ,5,",DIC(0)="FAEQM",DIC("A")="Select DONATION DATE: " D ^DIC K DIC I X["^"!(X="") S Y=-1 Q
"RTN","LRBLDRR",51,0)
 S LRI=+Y,LRG=$P(^LRE(LRQ,5,LRI,0),U,4) Q
"RTN","LRBLDRR",52,0)
E D V^LRU Q
"RTN","LRBLDRR",53,0)
W W !?5,LRN(A),?36,": ",LRJ(A),?70,$S(LRE(A)="":"",$D(^VA(200,LRE(A),0)):$P(^(0),"^",2),1:LRE(A)) I LRW(A)]"" W !,LRW(A)
"RTN","LRBLDRR",54,0)
 Q
"RTN","LRBLDT")
0^11^B19003681^B18989962
"RTN","LRBLDT",1,0)
LRBLDT ;AVAMC/REG/CYM - DONOR UNIT TESTING ;7/5/96  08:35 ;
"RTN","LRBLDT",2,0)
 ;;5.2;LAB SERVICE;**72,97,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDT",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDT",4,0)
 Q  D V^LRU S X="BLOOD BANK" D ^LRUTL G:Y=-1 END D D^LRBLU G:'$D(X) END
"RTN","LRBLDT",5,0)
 I LRCAPA S X="DONOR ANTIBODY SCREEN" D X^LRUWK G:'$D(X) END S Y="DT" D S^LRBLWD D EN^LRBLW G:%<1 END W:%=2 ! I $D(LRK("LRK")) D DT^LRBLU S LRK("LRK")=LRK
"RTN","LRBLDT",6,0)
 F A=12:1:20 D SC
"RTN","LRBLDT",7,0)
SEL W !!,"Select test(s) by number: " R X:DTIME G:X=""!(X[U) END I X["?" W !,"Enter one or more of the above numbers",!,"For 2 or more selections separate each with a ',' (ex. 12,13,15)",!,"Enter 'ALL' for all tests." G SEL
"RTN","LRBLDT",8,0)
 I X="ALL" D ALL G SHOW
"RTN","LRBLDT",9,0)
 I X?.E1CA.E!($L(X)>200) W $C(7),!,"No CONTROL CHARACTERS, LETTERS or more than 200 characters allowed." G SEL
"RTN","LRBLDT",10,0)
 I '+X W $C(7),!,"START with a NUMBER !!",! G SEL
"RTN","LRBLDT",11,0)
 S Y=X F LRB=0:0 S LRV=+Y,Y=$E(Y,$L(LRV)+2,$L(Y)) S:$D(LRA(LRV)) LRF(LRV)=LRA(LRV) Q:'$L(Y)
"RTN","LRBLDT",12,0)
SHOW I '$D(LRF) W $C(7),!,"None of the listed tests selected, try again " S %=1 D YN^LRU G LRBLDT:%=1,END
"RTN","LRBLDT",13,0)
 W !!,"You have selected the following tests:" F A=0:0 S A=$O(LRF(A)) Q:'A  W !,$J(A,3),") ",LRF(A)
"RTN","LRBLDT",14,0)
 W !,"OK " S %=1 D YN^LRU G:%'=1 LRBLDT S LRB="",LRC=1 W !!,"Enter TEST COMMENT(s) " S %=2 D YN^LRU G:%<1 END K:%=1 LRC
"RTN","LRBLDT",15,0)
DNR W ! K DA,LRZ,LRR S DIC="^LRE(",DIC(0)="AFQM",D="C^B",DIC("B")=LRB,DIC("A")="Select DONOR ID: " D MIX^DIC1 K DIC G:X=""!(X[U) END
"RTN","LRBLDT",16,0)
 I Y<1 W $C(7),!!,"Complete DONOR ID must be entered (ex. If ID=H12345 then H123 unacceptable)." G DNR
"RTN","LRBLDT",17,0)
 I X["," D ASK G:Y<1 DNR D CKRL,REST G DNR
"RTN","LRBLDT",18,0)
 S LRQ=+Y,LRI=$O(^LRE("C",X,LRQ,0)) I 'LRI W $C(7),"  ",X," does not exist, try again" G DNR
"RTN","LRBLDT",19,0)
 L +^LRE(LRQ,5,LRI,0):5 I '$T W !!,$C(7),"Someone else is editing this record." G DNR
"RTN","LRBLDT",20,0)
 S LRQ(1)=$P(^LRE(LRQ,5,LRI,0),"^",4) D CKRL,REST L -^LRE(LRQ,5,LRI,0) G DNR
"RTN","LRBLDT",21,0)
 ;
"RTN","LRBLDT",22,0)
REST S X(1)=$E(X,3,$L(X)),X(2)=X(1)+1,X(3)=$L(X(1))-$L(X(2)) I X(3) S X(2)=$E("00000",1,X(3))_X(2)
"RTN","LRBLDT",23,0)
 S LRB=$E(X,1,2)_X(2),LRB=$S($D(^LRE("C",LRB)):LRB,1:"")
"RTN","LRBLDT",24,0)
 S X=^LRE(LRQ,0),W(5)=$P(X,U,5),W(6)=$P(X,U,6)
"RTN","LRBLDT",25,0)
 S Y=+^LRE(LRQ,5,LRI,0) D D^LRU W !!,"UNIT#:",LRQ(1),"  ABO:",W(5)," Rh:",W(6),"  Donation date:",Y I LRQ(1)="" W $C(7),!?35,"Must have UNIT # to proceed." Q
"RTN","LRBLDT",26,0)
 W ! S LR(65.54,15)="",DR="[LRBLDT]",DIE="^LRE(",DA=LRQ D ^DIE K DIE,DR
"RTN","LRBLDT",27,0)
 I $D(LRR) S B=3 F A=0:0 S A=$O(LRA(A)) Q:'A  I $D(^LRE(LRQ,5,LRI,A)),$P(^(A),"^") S LRZ=1,B=B+1,Y=^(A),X=+Y,X=$$EXTERNAL^DILFD(65.54,A,"",X),LR("TXT",B,0)=LRA(A)_":"_X_" "_$P(Y,"^",3)
"RTN","LRBLDT",28,0)
 I $D(LRZ) D MSG K LRZ
"RTN","LRBLDT",29,0)
 I $D(LRR),'$D(^XUSEC("LRBLSUPER",DUZ)) W !,"One or more components were released.  You may not edit existing test results."
"RTN","LRBLDT",30,0)
 I LR(65.54,15)=0!(LR(65.54,15)) S Y="DT" D:LRCAPA SET^LRBLWD
"RTN","LRBLDT",31,0)
 Q
"RTN","LRBLDT",32,0)
S ;from LRBLDT input template only supervisor can edit data after release of components
"RTN","LRBLDT",33,0)
 I $D(LRR),$P(LRM,U)!($P(LRM,U)=0),'$D(^XUSEC("LRBLSUPER",DUZ)) S Y=Z
"RTN","LRBLDT",34,0)
 Q
"RTN","LRBLDT",35,0)
ASK S LRQ=+Y,DIC="^LRE(LRQ,5,",DIC(0)="FAEQM",DIC("A")="Select DONATION DATE: " D ^DIC K DIC Q:Y<1
"RTN","LRBLDT",36,0)
 S LRI=+Y,LRQ(1)=$P(^LRE(LRQ,5,LRI,0),U,4) Q
"RTN","LRBLDT",37,0)
 ;
"RTN","LRBLDT",38,0)
R W !,"Add ",LRF(A)," to donor testing worklist " S %=2 D YN^LRU Q:%'=1  S ^LRE("AT",LRQ(1),A,LRQ,LRI)="" Q
"RTN","LRBLDT",39,0)
 ;
"RTN","LRBLDT",40,0)
D K ^LRE("AT",LRQ(1),A,LRQ,LRI) Q
"RTN","LRBLDT",41,0)
 ;
"RTN","LRBLDT",42,0)
ALL F A=0:0 S A=$O(LRA(A)) Q:'A  S LRF(A)=LRA(A)
"RTN","LRBLDT",43,0)
 Q
"RTN","LRBLDT",44,0)
 ;
"RTN","LRBLDT",45,0)
CKRL F A=0:0 S A=$O(^LRE(LRQ,5,LRI,66,A)) Q:'A  I $P(^(A,0),"^",8)=0 S LRR=1 Q
"RTN","LRBLDT",46,0)
 Q
"RTN","LRBLDT",47,0)
MSG S LR("TXT",2,0)="Component(s) released with one or more positive test results!",LR("TXT",1,0)="Blood donor unit ID: "_LRQ(1),LR("KEY")="LRBLSUPER",LR("SUB")="Release of donor unit with abnormal test results"
"RTN","LRBLDT",48,0)
 N NAME,TYPE S X=$P(^LRE(LRQ,5,LRI,0),U,11) D FIELD^DID(65.54,1.1,"","LABEL","NAME") S NAME=NAME("LABEL")
"RTN","LRBLDT",49,0)
 S TYPE=$$EXTERNAL^DILFD(65.54,1.1,"",X)
"RTN","LRBLDT",50,0)
 S LR("TXT",3,0)=NAME_":  "_TYPE
"RTN","LRBLDT",51,0)
 W $C(7),!!,LR("TXT",2,0) D ^LRUMSG Q
"RTN","LRBLDT",52,0)
END D V^LRU Q
"RTN","LRBLDT",53,0)
SC I A'=17&(A'=20) D W Q
"RTN","LRBLDT",54,0)
 D:$G(LRH(A)) W Q
"RTN","LRBLDT",55,0)
W D FIELD^DID(65.54,A,"","LABEL","LRA") S LRA(A)=LRA("LABEL") W !,$J(A,3),")  ",LRA(A) Q
"RTN","LRBLDUC")
0^12^B6977505^B6967983
"RTN","LRBLDUC",1,0)
LRBLDUC ;AVAMC/REG/CYM - DONOR ABO/RH RECHECK ;7/5/96  22:39 ;
"RTN","LRBLDUC",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDUC",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDUC",4,0)
 Q  D V^LRU S X="BLOOD BANK" D ^LRUTL G:Y=-1 END
"RTN","LRBLDUC",5,0)
 W !!?30,"Donor ABO/Rh Recheck",! I LRCAPA S X="DONOR ABO/RH RECHECK" D X^LRUWK G:'$D(X) END S Y="UC" D S^LRBLWD
"RTN","LRBLDUC",6,0)
 S LRB="",LRC=1 W !!,"Enter TEST COMMENT(s) " S %=2 D YN^LRU K:%=1 LRC
"RTN","LRBLDUC",7,0)
DNR W ! K DA,LR,LRR S DIC="^LRE(",DIC(0)="AFQM",D="C^B",DIC("B")=LRB,DIC("A")="Select DONOR ID: " D MIX^DIC1 K DIC G:X=""!(X[U) END
"RTN","LRBLDUC",8,0)
 I Y<1 W $C(7),!!,"Complete DONOR ID must be entered (ex. If ID=H12345 then H123 unacceptable)." G DNR
"RTN","LRBLDUC",9,0)
 I X["," D ASK G:Y<1 DNR D CKRL,REST G DNR
"RTN","LRBLDUC",10,0)
 S LRQ=+Y,LRI=$O(^LRE("C",X,LRQ,0)) I 'LRI W $C(7),"  ",X," does not exist.  Try again" G DNR
"RTN","LRBLDUC",11,0)
 L +^LRE(LRQ,5,LRI,0):5 I '$T W !!,$C(7),"Sorry, someone else is editing this record" G DNR
"RTN","LRBLDUC",12,0)
 S LRQ(1)=$P(^LRE(LRQ,5,LRI,0),"^",4) D CKRL,REST L -^LRE(LRQ,5,LRI,0) G DNR
"RTN","LRBLDUC",13,0)
 ;
"RTN","LRBLDUC",14,0)
REST S X(1)=$E(X,3,$L(X)),X(2)=X(1)+1,X(3)=$L(X(1))-$L(X(2)) I X(3) S X(2)=$E("00000",1,X(3))_X(2)
"RTN","LRBLDUC",15,0)
 S LRB=$E(X,1,2)_X(2),LRB=$S($D(^LRE("C",LRB)):LRB,1:"")
"RTN","LRBLDUC",16,0)
 S X=^LRE(LRQ,0),W(5)=$P(X,U,5),W(6)=$P(X,U,6)
"RTN","LRBLDUC",17,0)
 S Y=+^LRE(LRQ,5,LRI,0) D D^LRU W !!,"UNIT#:",LRQ(1),"  Donation date:",Y I LRQ(1)="" W $C(7),!?35,"Must have UNIT # to proceed." Q
"RTN","LRBLDUC",18,0)
 W ! S DR="[LRBLDUC]",DIE="^LRE(",DA=LRQ D ^DIE K DIE,DR
"RTN","LRBLDUC",19,0)
 I $D(LRR) F A=0:0 S A=$O(LRA(A)) Q:'A  I $D(^LRE(LRQ,5,LRI,A)),$P(^(A),"^") S LR=1
"RTN","LRBLDUC",20,0)
 I $D(LRR),'$D(^XUSEC("LRBLSUPER",DUZ)) W !,"One or more components were released.  You may not edit existing test results."
"RTN","LRBLDUC",21,0)
 S Y="UC" D:LRCAPA SET^LRBLWD Q
"RTN","LRBLDUC",22,0)
S ;from LRBLDUC input template only supervisor can edit data after release of components
"RTN","LRBLDUC",23,0)
 I $D(LRR),$P(LRM,U,4)]"",'$D(^XUSEC("LRBLSUPER",DUZ)) S Y=Z
"RTN","LRBLDUC",24,0)
 I $P(LRM,U)="" W $C(7),!,"ABO/Rh testing not completed." S Y=0
"RTN","LRBLDUC",25,0)
 Q
"RTN","LRBLDUC",26,0)
ASK S LRQ=+Y,DIC="^LRE(LRQ,5,",DIC(0)="FAEQM",DIC("A")="Select DONATION DATE: " D ^DIC K DIC Q:Y<1
"RTN","LRBLDUC",27,0)
 S LRI=+Y,LRQ(1)=$P(^LRE(LRQ,5,LRI,0),U,4) Q
"RTN","LRBLDUC",28,0)
 ;
"RTN","LRBLDUC",29,0)
CKRL F A=0:0 S A=$O(^LRE(LRQ,5,LRI,66,A)) Q:'A  I $P(^(A,0),"^",8)=0 S LRR=1 Q
"RTN","LRBLDUC",30,0)
 Q
"RTN","LRBLDUC",31,0)
END D V^LRU Q
"RTN","LRBLDX")
0^13^B6297985^B6289087
"RTN","LRBLDX",1,0)
LRBLDX ;AVAMC/REG - DONOR ABO/RH TESTING ;3/25/92  22:42 ;
"RTN","LRBLDX",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLDX",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLDX",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END
"RTN","LRBLDX",5,0)
 I LRCAPA S X="DONOR ABO/RH TESTING" D X^LRUWK G:'$D(X) END S Y="DX" D S^LRBLWD D EN^LRBLW G:%<1 END I $D(LRK("LRK")) D DT^LRBLU S LRK("LRK")=LRK
"RTN","LRBLDX",6,0)
 S LRB="",LRC=1 W !!,"Enter TEST COMMENT(s) " S %=2 D YN^LRU G:%<1 END K:%=1 LRC
"RTN","LRBLDX",7,0)
DNR W ! K DA,LR,LRR S DIC="^LRE(",DIC(0)="AFQM",D="C^B",DIC("B")=LRB,DIC("A")="Select DONOR ID: " D MIX^DIC1 K DIC G:X=""!(X[U) END
"RTN","LRBLDX",8,0)
 I Y<1 W $C(7),!!,"Complete DONOR ID must be entered (ex. If ID=H12345 then H123 unacceptable)." G DNR
"RTN","LRBLDX",9,0)
 I X[","!($L(X)=5) D ASK G:Y<1 DNR D CKRL,REST G DNR
"RTN","LRBLDX",10,0)
 S LRQ=+Y,LRI=$O(^LRE("C",X,LRQ,0)) G:'LRI DNR S LRQ(1)=$P(^LRE(LRQ,5,LRI,0),"^",4) D CKRL,REST G DNR
"RTN","LRBLDX",11,0)
 ;
"RTN","LRBLDX",12,0)
REST S X(1)=$E(X,3,$L(X)),X(2)=X(1)+1,X(3)=$L(X(1))-$L(X(2)) I X(3) S X(2)=$E("00000",1,X(3))_X(2)
"RTN","LRBLDX",13,0)
 S LRB=$E(X,1,2)_X(2),LRB=$S($D(^LRE("C",LRB)):LRB,1:"")
"RTN","LRBLDX",14,0)
 S X=^LRE(LRQ,0),W(5)=$P(X,U,5),W(6)=$P(X,U,6)
"RTN","LRBLDX",15,0)
 S Y=+^LRE(LRQ,5,LRI,0) D D^LRU W !!,"UNIT#:",LRQ(1),"  Donation date:",Y I LRQ(1)="" W $C(7),!?35,"Must have UNIT # to proceed." Q
"RTN","LRBLDX",16,0)
 W ! S DR="[LRBLDABRH]",DIE="^LRE(",DA=LRQ D ^DIE K DIE,DR
"RTN","LRBLDX",17,0)
 I $D(LRR) F A=0:0 S A=$O(LRA(A)) Q:'A  I $D(^LRE(LRQ,5,LRI,A)),$P(^(A),"^") S LR=1
"RTN","LRBLDX",18,0)
 I $D(LRR),'$D(^XUSEC("LRBLSUPER",DUZ)) W !,"One or more components were released.  You may not edit existing test results."
"RTN","LRBLDX",19,0)
 S Y="DX" D:LRCAPA SET^LRBLWD Q
"RTN","LRBLDX",20,0)
S ;from LRBLDX input template only supervisor can edit data after release of components
"RTN","LRBLDX",21,0)
 I $D(LRR),$P(LRM,U,4)]"",'$D(^XUSEC("LRBLSUPER",DUZ)) S Y=Z
"RTN","LRBLDX",22,0)
 Q
"RTN","LRBLDX",23,0)
ASK S LRQ=+Y,DIC="^LRE(LRQ,5,",DIC(0)="FAEQM",DIC("A")="Select DONATION DATE: " D ^DIC K DIC Q:Y<1
"RTN","LRBLDX",24,0)
 S LRI=+Y,LRQ(1)=$P(^LRE(LRQ,5,LRI,0),U,4) Q
"RTN","LRBLDX",25,0)
 ;
"RTN","LRBLDX",26,0)
CKRL F A=0:0 S A=$O(^LRE(LRQ,5,LRI,66,A)) Q:'A  I $P(^(A,0),"^",8)=0 S LRR=1 Q
"RTN","LRBLDX",27,0)
 Q
"RTN","LRBLDX",28,0)
END D V^LRU Q
"RTN","LRBLJA")
0^14^B22277627^B22206171
"RTN","LRBLJA",1,0)
LRBLJA ;AVAMC/REG/CYM - BB INVENTORY DATA ENTRY ;10/24/96  19:20 ;
"RTN","LRBLJA",2,0)
 ;;5.2;LAB SERVICE;**72,90,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJA",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJA",4,0)
SET K DR,DA,LR("CK") D:'$D(LRAA) Z W ! S (DIC,DIE)="^LRD(65,",DIC(0)="AEFQMZ",DIC("S")="I $P(^(0),U,16)=DUZ(2)" D ^DIC K DIC Q:Y<1  S DA=+Y Q
"RTN","LRBLJA",5,0)
S Q  W ! S DIC=66,X="TYPING CHARGE",DIC(0)="X" D ^DIC I Y<1 W !," 'TYPING CHARGE' entry not in BLOOD PRODUCT File",!!,"Inform Blood Bank Supervisor",! Q
"RTN","LRBLJA",6,0)
 S W=$S($D(^LAB(66,+Y,"SU",1,0)):$P(^(0),"^",2),1:"")
"RTN","LRBLJA",7,0)
 D SET G:Y<1 END D CK^LRU G:$D(LR("CK")) S S DR=".12//"_W D ^DIE D FRE^LRU K DIC,DIE,DR G S
"RTN","LRBLJA",8,0)
A Q  D Z G:Y=-1 END S LRF=0
"RTN","LRBLJA",9,0)
 I LRCAPA W !!,"Enter 'YES' to record results and workload or 'NO' to record only results:",!,"Was testing performed at this facility " S %="" D YN^LRU G:%<1 END S:%=1 LRF=1 S X="UNIT PHENOTYPING",X("NOCODES")=1 D X^LRUWK G:'$D(X) END
"RTN","LRBLJA",10,0)
B S LR("SLAM")=0 D L^LRU,SET G:Y<1 END D CK^LRU G:$D(LR("CK")) B D P^LRBLJA1 S (LR,LRD)=0,DR="[LRBLIAG]" W ! D ^DIE D FRE^LRU D:LRF ^LRBLJA1 I $D(^LRD(65,LR,0)),$P(^(0),"^",2)="SELF" S LRB=$P(^(0),"^"),LRD=$O(^LRE("C",LRB,0))
"RTN","LRBLJA",11,0)
F Q:LR("SLAM")=1  F LRW=0:0 S LRW=$O(LRW(LRW)) Q:'LRW  F M=0:0 S M=$O(LRW(LRW,M)) Q:'M  D ST,CLNP
"RTN","LRBLJA",12,0)
 I LR("SLAM")=1 Q
"RTN","LRBLJA",13,0)
 F LRW=60,70,80,90 D
"RTN","LRBLJA",14,0)
 . S M=0 F  S M=$O(^LRD(65,LR,LRW,M)) Q:'M  D ST,CK
"RTN","LRBLJA",15,0)
 D:LRD CMV K A,B,C,M,LR,LRD,LRW,O,LR,LRS G B
"RTN","LRBLJA",16,0)
CLNP I '$D(^LRD(65,LR,LRW,M)) D K Q:LR("SLAM")=1  S O=M,X="deleted",Z=LRW(LRW,M)_",.01" D EN^LRUD Q
"RTN","LRBLJA",17,0)
 Q
"RTN","LRBLJA",18,0)
CK Q:LRD'>0  Q:LR("SLAM")=1  Q:$D(^LRE(LRD,LRS,M,0))
"RTN","LRBLJA",19,0)
 I $D(^LRE(LRD,LRO,M,0)) W $C(7),!!,$P(^LAB(61.3,M,0),U)," entered for ",$P(^LRE(LRD,0),U),!,"in donor file as ",$P(^DD(+$P(^LRE(LRD,LRO,0),U,2),.01,0),U),!,"Recheck donor and inventory phenotyping.",!! Q
"RTN","LRBLJA",20,0)
 I '$D(^LRE(LRD,LRS,0)) S ^(0)="^"_65.5_$S(LRS=1.1:6,LRS=1.2:7,LRS=1.3:8,1:9)_"PA^^"
"RTN","LRBLJA",21,0)
 L +^LRE(LRD,LRS):5 I '$T W $C(7),!,"I can't ADD the Antigen typings to the Donor File.  Someone else is editing this record.",!!,"Use the Donor-Donor phenotyping option to enter typing results to the appropriate donor",!! S LR("SLAM")=1 Q
"RTN","LRBLJA",22,0)
 S V=^LRE(LRD,LRS,0),^(0)=$P(V,"^",1,2)_"^"_M_"^"_($P(V,"^",4)+1)
"RTN","LRBLJA",23,0)
 S ^LRE(LRD,LRS,M,0)=M L -^LRE(LRD,LRS) Q
"RTN","LRBLJA",24,0)
 ;
"RTN","LRBLJA",25,0)
K Q:LRD'>0  Q:'$D(^LRE(LRD,LRS,M))
"RTN","LRBLJA",26,0)
 L +^LRE(LRD,LRS):5 I '$T W $C(7),!,"I can't DELETE the Antigen Typing FOR the Donor. Someone else is editing the record",!!,"Use the Donor-Donor phenotyping option to update the donor's phenotype",! S LR("SLAM")=1 Q
"RTN","LRBLJA",27,0)
 K ^LRE(LRD,LRS,M,0)
"RTN","LRBLJA",28,0)
 S V(1)=$O(^LRE(LRD,LRS,0)),V=^(0),Z=+$P(V,"^",2),^(0)=$P(V,"^",1,2)_"^"_V(1)_"^"_$S(V(1)="":"",1:($P(V,"^",4)-1)) L -^LRE(LRD,LRS)
"RTN","LRBLJA",29,0)
 S LRC=DA,LRC(1)=DA(1),DA(1)=LRD,(O,DA)=M,X="deleted",Z=Z_",.01" D EN^LRUD S DA=LRC,DA(1)=LRC(1) Q
"RTN","LRBLJA",30,0)
 ;
"RTN","LRBLJA",31,0)
Z S LR("M")=1,X="BLOOD BANK" D ^LRUTL W:Y'=-1 !?20,LRAA(4) Q
"RTN","LRBLJA",32,0)
ST S LRS=$S(LRW=60:"1.1;1.2",LRW=70:"1.2;1.1",LRW=80:"1.3;1.4",1:"1.4;1.3"),LRO=$P(LRS,";",2),LRS=$P(LRS,";") Q
"RTN","LRBLJA",33,0)
CMV S M=$P(^LRD(65,LR,0),"^",15) Q:M=""  F M(2)=0:0 S M(2)=$O(^LRD(65,"B",LRB,M(2))) Q:'M(2)  I M(2)'=LR S $P(^LRD(65,M(2),0),"^",15)=M
"RTN","LRBLJA",34,0)
 S M(1)=$P(^LRE(LRD,0),"^",15) Q:M(1)=M  I M(1)="" S $P(^(0),"^",15)=M Q
"RTN","LRBLJA",35,0)
 W $C(7),!!,"Inventory unit:",$P(^LRD(65,LR,0),"^"),?38,"CMV ANTIBODY ",$S(M:"PRESENT",1:"ABSENT"),!,"Donor ",$P(^LRE(LRD,0),"^"),?38,"CMV ANTIBODY ",$S(M(1):"PRESENT",1:"ABSENT")
"RTN","LRBLJA",36,0)
 W !!,"Recheck donor and inventory unit CMV ANTIBODY testing." Q
"RTN","LRBLJA",37,0)
T ;transfer unit to another division
"RTN","LRBLJA",38,0)
 Q  D SET G:Y<1 END D CK^LRU G:$D(LR("CK")) T S LRO=$P(^LRD(65,DA,0),U,16),DR=".16" D ^DIE,FRE^LRU K DIC,DIE,DR S LRN=$P(^LRD(65,DA,0),U,16) D:LRO'=LRN AD G T
"RTN","LRBLJA",39,0)
AD S LRO=$P($G(^DIC(4,+LRO,0)),U),LRN=$P($G(^DIC(4,LRN,0)),U),LRW=$P($G(^VA(200,+DUZ,0)),U)
"RTN","LRBLJA",40,0)
 S %DT="ETX",X="N" D ^%DT K %DT S A=$P($H,",")_$P($H,",",2)
"RTN","LRBLJA",41,0)
 S:'$D(^LRD(65,DA,999,0)) ^(0)="^65.099DA^^" S X=^(0),^(0)=$P(X,"^",1,2)_"^"_A_"^"_($P(X,"^",4)+1),^(A,0)=Y_"^"_LRW_"^DIVISION^"_LRO_"^"_LRN Q
"RTN","LRBLJA",42,0)
 Q
"RTN","LRBLJA",43,0)
END D V^LRU Q
"RTN","LRBLJCK")
0^15^B13736751^B13704675
"RTN","LRBLJCK",1,0)
LRBLJCK ;AVAMC/REG - INVENTORY ABO/RH CK ;7/30/95  15:38 ; 12/18/00 2:03pm
"RTN","LRBLJCK",2,0)
 ;;5.2;LAB SERVICE;**72,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJCK",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJCK",4,0)
 ; 
"RTN","LRBLJCK",5,0)
 ; References to ^DD(65, supported by DBIA3261
"RTN","LRBLJCK",6,0)
 ;
"RTN","LRBLJCK",7,0)
SD S Y(1)=Y+.99,Y=Y-.0001 F T=Y:0 S T=$O(^LRD(65,"A",T)) Q:'T!(T>Y(1))  F A=0:0 S A=$O(^LRD(65,"A",T,A)) Q:'A  S X=^LRD(65,A,0) I $P(X,"^",3)=LRA,$P(^LAB(66,$P(X,"^",4),0),"^",19) S ^TMP($J,$P(X,"^"),A)=""
"RTN","LRBLJCK",8,0)
 Q
"RTN","LRBLJCK",9,0)
ST F A=0:0 S A=$O(^LRD(65,"A",Y,A)) Q:'A  S X=^LRD(65,A,0) I $P(X,"^",3)=LRA,$P(^LAB(66,$P(X,"^",4),0),"^",19) S ^TMP($J,$P(X,"^"),A)=""
"RTN","LRBLJCK",10,0)
 Q
"RTN","LRBLJCK",11,0)
E S (LRW(10),LRW(11))="" W !! S X=$$READ^LRBLB("UNIT ID: ") G:X=""!(X["^") END
"RTN","LRBLJCK",12,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D ^LRBLBU G:'$D(X) E
"RTN","LRBLJCK",13,0)
 W:'LR $$STRIP^LRBLB(.X)  ; Strip off data identifiers just in case
"RTN","LRBLJCK",14,0)
 X $P(^DD(65,.01,0),"^",5,99) I $D(X),X["?" K X
"RTN","LRBLJCK",15,0)
 I '$D(X) W !!,$C(7),$S($D(^DD(65,.01,3)):^(3),1:""),! X:$D(^(4)) ^(4) G E
"RTN","LRBLJCK",16,0)
 S DIC=65,DIC(0)="EFMXZ",DIC("S")="I $P(^(0),U,16)=DUZ(2)" D ^DIC K DIC I Y<1 W $C(7),"  (NOT IN INVENTORY FILE)" G E
"RTN","LRBLJCK",17,0)
 S (DA,LRX)=+Y,DIE="^LRD(65,",DR="[LRBLIABRH]" D ^DIE D DT^LRBLU I LRCAPA D:LRW(10)]""&(LRW(10)'="ND") ABO D:LRW(11)]""&(LRW(11)'="ND") RH
"RTN","LRBLJCK",18,0)
 G E
"RTN","LRBLJCK",19,0)
 ;
"RTN","LRBLJCK",20,0)
ABO K LRT S LRT=LRW("ABO") Q:$D(^LRD(65,LRX,99,LRT))  F A=0:0 S A=$O(LRW("ABO",A)) Q:'A  S LRT(A)=""
"RTN","LRBLJCK",21,0)
 D:LRCAPA ^LRBLW Q
"RTN","LRBLJCK",22,0)
RH K LRT S LRT=LRW("RH") Q:$D(^LRD(65,LRX,99,LRT))  F A=0:0 S A=$O(LRW("RH",A)) Q:'A  S LRT(A)=""
"RTN","LRBLJCK",23,0)
 D:LRCAPA ^LRBLW Q
"RTN","LRBLJCK",24,0)
EN ;
"RTN","LRBLJCK",25,0)
 Q  D V^LRU,S^LRBLW S LR("M")=1,X="BLOOD BANK" D ^LRUTL G:Y=-1 END W !!?28,"Inventory ABO/Rh check",!!?15,"Division: ",LRAA(4) K LRE Q:'$D(DUZ)#2
"RTN","LRBLJCK",26,0)
 I LRCAPA F Y="ABO","RH" K LRT S X="UNIT "_Y_" RECHECK" D X^LRUWK G:'$D(X) END S LRW(Y)=LRT F A=0:0 S A=$O(LRT(A)) Q:'A  S LRW(Y,A)=""
"RTN","LRBLJCK",27,0)
 K LRT D BAR^LRBLB W !!,"Enter TEST COMMENT(s) " S %=2 D YN^LRU G:%<1 END S:%=1 LRQ=1
"RTN","LRBLJCK",28,0)
ASK W !!?14,"1) Enter by invoice# (batch)",!?14,"2) Entry by unit ID",!,"Select 1 or 2:" R X:DTIME G:X=""!(X[U) END
"RTN","LRBLJCK",29,0)
 I X<1!(X>2) W $C(7),!,"Enter a '1' to automatically request data entry for all units in a given invoice",!,"Enter a '2' to specify unit ID" G ASK
"RTN","LRBLJCK",30,0)
 S DIE=("NO")="OUTOK",LR(3)="" G:X=2 E
"RTN","LRBLJCK",31,0)
I W !!,"Select ",$P(^DD(65,.03,0),"^"),": " R X:DTIME G:X=""!(X[U) END S:X["?" X="?" X $P(^(0),"^",5,99) I '$D(X) W:$D(^(3)) !,^(3) X:$D(^(4)) ^(4) G I
"RTN","LRBLJCK",32,0)
 S LRA=X
"RTN","LRBLJCK",33,0)
 S %DT="AETX",%DT("A")="Enter date received: ",%DT(0)="-N" D ^%DT K %DT G:Y<1 END S LRB=Y
"RTN","LRBLJCK",34,0)
 D WAIT^LRU D @($S(Y[".":"ST",1:"SD")) I '$D(^TMP($J)) W $C(7),!!,"There are no units in inventory for invoice# ",LRA," for " S Y=LRB D D^LRU W Y G ASK
"RTN","LRBLJCK",35,0)
 D DT^LRBLU S LRD(1)=0 F LRA=0:0 S LRD(1)=$O(^TMP($J,LRD(1))) Q:LRD(1)=""!($D(LRE))  F LRD=0:0 S LRD=$O(^TMP($J,LRD(1),LRD)) Q:'LRD!($D(LRE))  D A
"RTN","LRBLJCK",36,0)
 G:$D(LRE) E Q
"RTN","LRBLJCK",37,0)
A S (LRW(10),LRW(11))="" W !!,LRD(1) S (DA,LRX)=LRD,DIE="^LRD(65,",DR="[LRBLIABRH]" D ^DIE I $D(Y) W !!,"WANT TO STOP LOOPING " S %=1 D YN^LRU S:%=1 LRE=1
"RTN","LRBLJCK",38,0)
 I LRCAPA D:LRW(10)]""&(LRW(10)'="ND") ABO D:LRW(11)]""&(LRW(11)'="ND") RH
"RTN","LRBLJCK",39,0)
 Q
"RTN","LRBLJCK",40,0)
 ;
"RTN","LRBLJCK",41,0)
END D V^LRU Q
"RTN","LRBLJD")
0^16^B17555322^B17526948
"RTN","LRBLJD",1,0)
LRBLJD ;AVAMC/REG/CYM - BB UNIT DISPOSITION ;7/25/96  11:53 ; 12/18/00 2:06pm
"RTN","LRBLJD",2,0)
 ;;5.2;LAB SERVICE;**25,72,78,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJD",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJD",4,0)
 ;
"RTN","LRBLJD",5,0)
 ; References to ^DD(65, supported by DBIA3261
"RTN","LRBLJD",6,0)
 ;
"RTN","LRBLJD",7,0)
 Q  D END S LR("M")=1,LRN="",X="BLOOD BANK" D ^LRUTL G:Y=-1 END S X=$P(^DD(65,4.1,0),U,3),LR(3)="" F Y=1:1 S Z=$P($P(X,";",Y),":",2) Q:Z=""  I $A(Z)'=84 S LRB(Y)=Z
"RTN","LRBLJD",8,0)
 W !?15,"Division: ",LRAA(4)
"RTN","LRBLJD",9,0)
 I LRCAPA S X="UNIT MODIFICATION",X("NOCODES")=1 D X^LRUWK G:'$D(X) END K X S LRW("MO")=LRT S X="UNIT LOG-IN/SEND-OUT" D X^LRUWK G:'$D(X) END S LRW("S")=LRT F A=0:0 S A=$O(LRT(A)) Q:'A  S LRW("S",A)=""
"RTN","LRBLJD",10,0)
 K LRT D BAR^LRBLB
"RTN","LRBLJD",11,0)
ASK S X="N",%DT="T" D ^%DT S LRF=Y K %DT W !! S X=$$READ^LRBLB("Select UNIT ID FOR DISPOSITION: ") G:X=""!(X[U) END
"RTN","LRBLJD",12,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D
"RTN","LRBLJD",13,0)
 .D ^LRBLBU
"RTN","LRBLJD",14,0)
 E  W $$STRIP^LRBLB(.X)  ; Strip off data identifiers just in case
"RTN","LRBLJD",15,0)
 G:'$D(X) ASK
"RTN","LRBLJD",16,0)
 D REST,K^LRU K ^TMP($J),DA,LR("CK"),LR("C"),LR("%5"),LR("%4"),LR("%3"),LR("%2"),LR("%"),LRO,LRM,LRV,LRE,LRP,LRJ,LRT G ASK
"RTN","LRBLJD",17,0)
REST S (DIC,DIE)="^LRD(65,",DIC(0)="EFQMZ",DIC("S")="I $P(^(0),U,16)=DUZ(2),$S('$D(^(4)):1,$P(^(4),U,2):0,$P(^(4),U)="""":1,1:0)" D ^DIC K DIC Q:Y<1
"RTN","LRBLJD",18,0)
 S DA=+Y,LRV(10)=$P(Y(0),"^",10),LRV(4)=+$P(Y(0),"^",4),LRV(26)=$P(^LAB(66,LRV(4),0),U,26),LRV(15)=$P(Y(0),"^",15) D EN^LRBLJDA Q:$D(LR("%"))
"RTN","LRBLJD",19,0)
 D CK^LRU Q:$D(LR("CK"))  S DR="[LRBLID]" D ^DIE D FRE^LRU  S LRX=DA K DIC,DIE,DR,DA,D S DA=LRX I $D(Y) D K Q
"RTN","LRBLJD",20,0)
 F A=0:0 S A=$O(^LRD(65,DA,2,A)) Q:'A  I $D(^LR(A,1.8,LRV(4),1,DA,0)) K ^(0) L +^LR(A,1.8,LRV(4),1,0) S X=^LR(A,1.8,LRV(4),1,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-1) L -^LR(A,1.8,LRV(4),1,0)
"RTN","LRBLJD",21,0)
 D:$D(LR("%2")) EN1^LRBLJDA Q:'$D(LRE(1))  D:"RS"[LRE(1)&LRCAPA RS^LRBLW Q:LRE(1)'="MO"  S LRJ=$P($G(^LRD(65,LRX,8)),"^",2) S:LRCAPA LRT=LRW("MO")
"RTN","LRBLJD",22,0)
 S LRV(3)=$P(^LAB(66,LRE(4),0),"^",10),DIE="^LRD(65,",DA=LRX,DR=".11//^S X=LRV(3);S LRM=X" D ^DIE I $D(Y) D K Q
"RTN","LRBLJD",23,0)
M S DIC="^LAB(66,LRE(4),3,",DIC(0)="AEQMZ" D ^DIC K DIC I Y<1 W !!,"Nothing selected " D K Q
"RTN","LRBLJD",24,0)
 S LRV=+Y,LRV(2)=$P(Y(0),"^",2),X=^LAB(66,LRV,0),LRN=$P(X,"^",28),LRV(1)=$P(X,"^"),LRV(6)=$P(X,"^",6),LRV(6)=$S("DP"[LRV(6):LRV(6),1:""),LRD=$P(X,"^",18),LRJ(1)=$P(X,"^",25)
"RTN","LRBLJD",25,0)
 I LRV(1)["PLASMA REMOVED" D PV^LRBLJDA I '$D(Z) D K Q
"RTN","LRBLJD",26,0)
 I LRJ,LRJ(1)'=1 W $C(7),!!,"Unit has positive screening tests and component selected is not autologous.",! G M
"RTN","LRBLJD",27,0)
 S (LRO(9),LRO(1))=$P(X,"^",11),LRV(11)="" D:LRO(1) F^LRBLJDM
"RTN","LRBLJD",28,0)
 S LRE=^LRD(65,LRX,0),(LRE(6),Y)=$P(LRE,"^",6) S:LRE(6)'["." LRE(6)=LRE(6)_".9999" D D^LRU S LRE(3)=Y,LRE(69)=LRE(6)
"RTN","LRBLJD",29,0)
 I LRE(6)<LRF W $C(7),!!,"UNIT EXPIRED " S Y=$P(LRE,U,6) D D^LRU W Y," STILL WANT TO MODIFY " S %=2 D YN^LRU I %'=1 D K Q
"RTN","LRBLJD",30,0)
 I LRO(1)="" S Y=$P(LRE,"^",6) D DA^LRU S LRO(1)=Y
"RTN","LRBLJD",31,0)
 D @$S(LRV(6)="D":"D^LRBLJDM",LRV(2):"^LRBLJDM",LRV(6)="P":"^LRBLJD1",1:"S^LRBLJDM") Q
"RTN","LRBLJD",32,0)
K ;from LRBLJD1, LRBLJDM, [LRBLID] edit template file #65
"RTN","LRBLJD",33,0)
 W $C(7),!,"Answer all prompts (no NULL responses) DISPOSITION DELETED",!!
"RTN","LRBLJD",34,0)
 X:$D(^DD(65,4.1,1,1,2)) ^(2) X:$D(^DD(65,4.1,1,2,2)) ^(2) X:$D(^DD(65,4.1,1,3,2)) ^(2) S X=$S($D(^LRD(65,DA,4)):$P(^(4),"^",2),1:"") K:X ^LRD(65,"AB",X,DA) K ^LRD(65,DA,4),^(5) Q
"RTN","LRBLJD",35,0)
 ;
"RTN","LRBLJD",36,0)
END D V^LRU Q
"RTN","LRBLJD",37,0)
 ;
"RTN","LRBLJD",38,0)
R R !,"DISPOSITION: ",LRE(1):DTIME S:LRE(1)="" LRE(1)=U Q:LRE(1)[U
"RTN","LRBLJD",39,0)
 F X=0:0 S X=$O(LRB(X)) Q:'X  I $E(LRB(X),1,$L(LRE(1)))=LRE(1) W $E(LRB(X),$L(LRE(1))+1,$L(LRB(X))) S LRE(1)=LRB(X) G OUT
"RTN","LRBLJD",40,0)
 W !!,"Select from:"
"RTN","LRBLJD",41,0)
 F X=0:0 S X=$O(LRB(X)) Q:'X  W !?3,LRB(X)
"RTN","LRBLJD",42,0)
 W ! G R
"RTN","LRBLJD",43,0)
OUT I $D(^LRD(65,DA,8)),$P(^(8),"^",2)'=0,LRE(1)="SEND ELSEWHERE"!(LRE(1)="SALVAGED") S X=$P(^(8),"^",2) D C
"RTN","LRBLJD",44,0)
 Q
"RTN","LRBLJD",45,0)
C W $C(7),!,$S(X:"POSITIVE",1:"INCOMPLETE")," SCREENING TESTS." I LRE(1)="SEND ELSEWHERE" W " WANT TO CONTINUE " S %=2 D YN^LRU S:%'=1 LRE(1)=U Q
"RTN","LRBLJD",46,0)
 W " SALVAGE NOT ALLOWED." S LRE(1)=U Q
"RTN","LRBLJED")
0^17^B19911409^B19813234
"RTN","LRBLJED",1,0)
LRBLJED ;AVAMC/REG/CYM - BB INVENTORY EDIT 3/3/97  13:20 ;
"RTN","LRBLJED",2,0)
 ;;5.2;LAB SERVICE;**72,90,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJED",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJED",4,0)
 ;
"RTN","LRBLJED",5,0)
D Q  D G G:Y<1 END D CK^LRU G:$D(LR("CK")) D S DR="[LRBLIDTM]" D ^DIE D FRE^LRU D:$D(LRT) FX G D
"RTN","LRBLJED",6,0)
E Q  D G G:Y<1 END D CK^LRU G:$D(LR("CK")) E S DR="[LRBLIXR]" D ^DIE D FRE^LRU G E
"RTN","LRBLJED",7,0)
L Q  D G G:Y<1 END D CK^LRU G:$D(LR("CK")) L S LR(0)=$P(Y,U,2),LR(4)=$P(Y(0),U,4) W !!,LR(0),"// " R X:DTIME G L:X[U!('$T),DIE:X="" I X'="@" X $P(^DD(65,.01,0),U,5,99) I '$D(X) W !,$C(7),$G(^DD(65,.01,3)) X:$D(^(4)) ^(4) G L
"RTN","LRBLJED",8,0)
 S LR(1)=DA I X="@" W $C(7),!?3,"SURE YOU WANT TO DELETE THE ENTIRE '",LR(0),"' BLOOD INVENTORY" S %=2 D YN^LRU G:%'=1 L I %=1 S O=LR(0),X="Deleted",Z="65,.01" D EN^LRUD S LR="@",DR=".01///^S X=LR" D ^DIE G L
"RTN","LRBLJED",9,0)
 D W G:'$D(X) L S LR=X,DR=".01///^S X=LR" D ^DIE S O=LR(0),Z="65,.01" D EN^LRUD
"RTN","LRBLJED",10,0)
DIE S DR="[LRBLILG]" D ^DIE I $D(DA),$P(^LRD(65,DA,0),U)'=LR(65,.01) D KK^LRBLU
"RTN","LRBLJED",11,0)
 D FRE^LRU G L
"RTN","LRBLJED",12,0)
 ;
"RTN","LRBLJED",13,0)
G D END S X="BLOOD BANK",LRAA(2)="BB" D BB^LRUTL
"RTN","LRBLJED",14,0)
 S DIC=68,DIC(0)="MOXZ" I X="" S DIC(0)="AEMQZ"
"RTN","LRBLJED",15,0)
 D ^DIC K DIC S LRAA=+Y
"RTN","LRBLJED",16,0)
 W ! S (DIC,DIE)="^LRD(65,",DIC(0)="AEFQMZ",DIC("S")="I $P(^(0),U,16)=DUZ(2)" D ^DIC K DIC Q:Y<1
"RTN","LRBLJED",17,0)
 S (DA,LR("UNIT"))=+Y,LR(65,.01)=$P(Y,U,2),X=$P(^VA(200,DUZ,0),"^",2) D C^LRUA S LRWHO=X Q
"RTN","LRBLJED",18,0)
 ;
"RTN","LRBLJED",19,0)
FX Q:'$D(^LRD(65,DA,6))  S T(9)="",T=LRT,T(1)=LRT(1),W=^(0),X=^(6),T(3)="",T(4)=$P(X,"^",4),T(5)=$P(X,"^",5),T(11)=$P(X,"^",8) I T,T(4),$D(^LR(T,1.6,T(4),0)) S T(0)=^(0),T(9)=$P(T(0),U,9) D KL
"RTN","LRBLJED",20,0)
 Q:'T(1)  S:'$D(^LR(T(1),1.6,0)) ^(0)="^63.017DAI^^" S:$D(^LRD(65,DA,9,0)) T(3)=$P(^(0),"^",4) L +^LR(T(1),1.6):5 I '$T W !,"I can't do this right now.  Someone else is editing this record.  " Q
"RTN","LRBLJED",21,0)
FC I $D(^LR(T(1),1.6,LRI)) S LRI=LRI-.00001 G FC
"RTN","LRBLJED",22,0)
 S T(10)=$P(^LRD(65,DA,0),"^",11)
"RTN","LRBLJED",23,0)
 S ^LR(T(1),1.6,LRI,0)=LRQ_"^"_$P(W,"^",4)_"^"_$P(W,"^")_"^"_DUZ_"^"_$P(W,"^",7)_"^"_$P(W,"^",8)_"^"_T(3)_"^"_T(5)_"^"_T(9)_"^"_T(10)_"^"_T(11),X=^LR(T(1),1.6,0),^(0)=$P(X,"^",1,2)_"^"_LRI_"^"_($P(X,"^",4)+1) L -^LR(T(1),1.6)
"RTN","LRBLJED",24,0)
 I T(11) S ^LR("AB",T(1),T(11),LRI)=""
"RTN","LRBLJED",25,0)
 S $P(^LRD(65,DA,6),"^",4)=LRI S E=0 F A=1:1 S E=$O(^LRD(65,DA,7,E)) Q:'E  S E(2)=^(E,0),^LR(T(1),1.6,LRI,1,A,0)=E(2)
"RTN","LRBLJED",26,0)
 S:A>1 ^LR(T(1),1.6,LRI,1,0)="^63.186A^"_(A-1)_"^"_(A-1)
"RTN","LRBLJED",27,0)
 I LRO(1)'=LRW(9) S LRREC=LRI,LRPTR=T(1) D DISP5^LRBLAUD1 ; Adds patient transfusion record data to the audit trail
"RTN","LRBLJED",28,0)
 Q
"RTN","LRBLJED",29,0)
KL L +^LR(T,1.6):5 I '$T W !,"Someone else is editing this entry.  Try again later " Q
"RTN","LRBLJED",30,0)
 K ^LR(T,1.6,T(4)),^LR("AB",T,+$P(T(0),U,11),T(4)) S X(1)=$O(^LR(T,1.6,0)) S:'X(1) X(1)=0 S X=^LR(T,1.6,0),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)=0:X(1),1:($P(X,"^",4)-1)) L -^LR(T,1.6)
"RTN","LRBLJED",31,0)
 Q
"RTN","LRBLJED",32,0)
 ;
"RTN","LRBLJED",33,0)
A Q  D G G:Y<1 END I '$D(^LRD(65,DA,8)) W !?7,"No autologous/directed donor entry for this unit." G A
"RTN","LRBLJED",34,0)
 S W=^LRD(65,DA,8),(X,LRX)=+(W),W=$P(W,"^",2),W(3)=$S($P(W,"^",3)="A":"Autologous ","D":"Directed ",1:"")_"donation" I 'X W !?7,"Donor unit has been released to stock.",! G A
"RTN","LRBLJED",35,0)
 I W!(W="") W:W !?7,"One or more screening tests from ",W(3)," are positive." W:W="" !?7,"Not all screening tests completed." W !?7,$C(7),"DELETION NOT ALLOWED !",! G A
"RTN","LRBLJED",36,0)
 W !,$P(W(3)," ")," donor: " S X=^LR(X,0),(LRDPF,Y)=$P(X,"^",2),X=$P(X,"^",3),Y=^DIC(Y,0,"GL"),X=@(Y_X_",0)"),LRP=$P(X,"^"),SSN=$P(X,"^",9) D SSN^LRU W LRP," ",SSN," OK TO DELETE " S %=1 D YN^LRU Q:%'=1
"RTN","LRBLJED",37,0)
 S ^LRD(65,DA,8)="^"_W K ^LRD(65,"AU",LRX,DA) Q
"RTN","LRBLJED",38,0)
 ;
"RTN","LRBLJED",39,0)
W S X(1)=+$P($G(^LRD(65,DA,0)),"^",4),X(2)=0 F  S X(2)=$O(^LRD(65,"B",X,X(2))) Q:'X(2)  I $P(^LRD(65,X(2),0),"^",4)=X(1) D W1 Q
"RTN","LRBLJED",40,0)
 Q
"RTN","LRBLJED",41,0)
W1 W $C(7),!,$P(^LAB(66,$P(^LRD(65,X(2),0),U,4),0),U)," unit already exists in inventory" K X Q
"RTN","LRBLJED",42,0)
 ;
"RTN","LRBLJED",43,0)
END D V^LRU Q
"RTN","LRBLJL")
0^18^B32065813^B32044357
"RTN","LRBLJL",1,0)
LRBLJL ;AVAMC/REG/CYM - UNIT RELOCATION ;7/7/97  08:32 ;
"RTN","LRBLJL",2,0)
 ;;5.2;LAB SERVICE;**16,72,79,90,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJL",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJL",4,0)
 Q  D END,S^LRBLW,CK^LRBLPUS G:Y=-1 END D A^LRBLJL1 G:Y=-1 END S LRB=$O(^LAB(61.3,"C",50710,0)) I 'LRB D EN1^LRBLU
"RTN","LRBLJL",5,0)
 W !!?30,"Relocation of units",!!?30,LRAA(4) I LRCAPA S X="UNIT RELOCATION" D X^LRUWK G:'$D(X) END
"RTN","LRBLJL",6,0)
P W ! K LRG,DIC,DIE,DR,DA,C,LRW,V,R,LRV,^TMP($J) D ^LRDPA G:LRDFN=-1 END S LRBL=$S(LRPFN=2:DFN,1:"") D R G P
"RTN","LRBLJL",7,0)
R D EN^LRBLPUS F X=1:1:4 S LRW(X)=""
"RTN","LRBLJL",8,0)
 D ^LRBLJL1 I F=0 W $C(7),!!,"No units available for release",!,"Use appropriate options to assign or modify" Q
"RTN","LRBLJL",9,0)
 I $D(LRG(1)) W $C(7),!!?3,"( # unsatisfactory unit)" K LRG(1)
"RTN","LRBLJL",10,0)
 I $D(V) W $C(7),!!?3,"( *Expired unit )" K V
"RTN","LRBLJL",11,0)
 I F=1 S LRV=1 D DIE Q
"RTN","LRBLJL",12,0)
M W !,"Select (1-",F,"): " R X:DTIME Q:X=""!(X[U)  I X["?" W !,"Enter number(s) from 1 to ",F,!,"For 2 or more selections separate each with a ',' (ex. 1,3,4)",!,"Enter 'ALL' for all units" G M
"RTN","LRBLJL",13,0)
 I X="ALL" S LR("ALL")=1 D ALL Q
"RTN","LRBLJL",14,0)
 I X?.E1CA.E!($L(X)>200) W $C(7),!,"No CONTROL CHARACTERS, LETTERS or more than 200 characters allowed" G M
"RTN","LRBLJL",15,0)
 I '+X W $C(7),!,"START with a NUMBER !!",! G M
"RTN","LRBLJL",16,0)
 S LRQ=X F LRA=0:0 S LRZ=0,LRV=+LRQ,LRQ=$E(LRQ,$L(LRV)+2,$L(LRQ)) D:LRV A Q:'$L(LRQ)
"RTN","LRBLJL",17,0)
 Q
"RTN","LRBLJL",18,0)
A Q:'$D(^TMP($J,LRV))  S A=LRV,LRX=^(A) W !,A,")" D W^LRBLJL1,DIE
"RTN","LRBLJL",19,0)
 Q
"RTN","LRBLJL",20,0)
F S DA=9999999-LRW(1) S:'$D(^LRD(65,LRX,3,0)) ^(0)="^65.03DA^^" I '$D(^(DA,0)) S ^LRD(65,LRX,3,DA,0)=LRW(1),X=^LRD(65,LRX,3,0),^(0)="^65.03DA^"_DA_"^"_($P(X,"^",4)+1)
"RTN","LRBLJL",21,0)
 Q
"RTN","LRBLJL",22,0)
ALL ; This subroutine detects if a previous Inspection was
"RTN","LRBLJL",23,0)
 ; Unsatisfactory, then calls up another subroutine to give
"RTN","LRBLJL",24,0)
 ; a warning message.  It also evaluates each individual unit
"RTN","LRBLJL",25,0)
 ; within a group selected to be sure that all required testing
"RTN","LRBLJL",26,0)
 ; is complete and compatible with the patient.
"RTN","LRBLJL",27,0)
 S (LRZ,LR("STOP"))=0
"RTN","LRBLJL",28,0)
 F LRC=0:0 S LRC=$O(^TMP($J,LRC)) Q:LRC'>0  Q:LR("STOP")=2  D
"RTN","LRBLJL",29,0)
 . S LRE=^TMP($J,LRC),LRX=+LRE,(LRZ(LRX),LRR(LRX))=0,L=$P(LRE,U,14) D:"Blood BankBLOOD BANK"[L C
"RTN","LRBLJL",30,0)
 . I $P(LRE,U,11)="U" W $C(7),!,"Unit unsatisfactory, cannot release." S LRZ(LRX)=1 Q
"RTN","LRBLJL",31,0)
 . Q:LRZ(LRX)
"RTN","LRBLJL",32,0)
 . I 'LR("STOP") D T Q
"RTN","LRBLJL",33,0)
 . I LR("STOP") D
"RTN","LRBLJL",34,0)
 .. I $D(LRG(LRX)) D PRE Q
"RTN","LRBLJL",35,0)
 .. S LRK=LRW(1) D F,G S ^LRD(65,LRX,3,DA,0)=LRW(1)_"^"_LRW(2)_"^"_DUZ_"^"_LRW(3)_"^"_LRW(4)_"^"_LRP_"^"_LRBL,^LRD(65,"AL",LRW(1),LRX)=""
"RTN","LRBLJL",36,0)
 Q
"RTN","LRBLJL",37,0)
DIE S LRE=^TMP($J,LRV),LRX=+LRE,(LRZ(LRX),LRR(LRX))=0 K ^TMP($J,LRV),Y,LR("CK") I "Blood BankBLOOD BANK"[L D C Q:LRZ(LRX)
"RTN","LRBLJL",38,0)
 I $P(LRE,"^",11)="U" W $C(7),!,"Unit unsatisfactory, cannot release." S LRR(LRX)=1 Q
"RTN","LRBLJL",39,0)
T R !!,"DATE/TIME UNIT RELOCATION: NOW//",X:DTIME I '$T!(X[U) S LRR(LRX)=1 Q
"RTN","LRBLJL",40,0)
 S:X="" X="N" S %DT="ETX",%DT(0)="-N" D ^%DT K %DT S LRW(1)=Y I Y<1!(Y'[".") W $C(7),!?5,"TIME and DATE must be entered, future time not allowed." G T
"RTN","LRBLJL",41,0)
 I Y<$P(LRE,U,12) W $C(7),!!,"Relocation time must be after DATE/TIME unit assigned " S Y=$P(LRE,U,12) D DT^LRU W "(",Y,")" S LRR(LRX)=1 Q
"RTN","LRBLJL",42,0)
 D F S DIE="^LRD(65,LRX,3," D CK^LRU Q:$D(LR("CK"))  S DA(1)=LRX,X=$P(LRE,"^",6),LRW(5)=$S("Blood BankBLOOD BANK"[X:1,1:0) S:'LRW(5) LRW(3)=LR(44)
"RTN","LRBLJL",43,0)
 S DR=".03////^S X=DUZ;.02;S LRW(2)=X;D:X=""U"" I^LRBLJL;S:LRW(2)=""U""&(LRW(5)) Y=0;I 'LRW(5)&(LRW(2)=""U"") D S^LRBLJL;.04;S LRW(3)=X;.05;S LRW(4)=X;.06///^S X=LRP;.07////^S X=LRBL" D ^DIE D FRE^LRU
"RTN","LRBLJL",44,0)
 I $D(LR("ALL")) S LR("STOP")=1 ; Only enter relocation data once if "ALL"
"RTN","LRBLJL",45,0)
 I $D(Y)!(LRW(2)="U"&(LRW(5))) D W,CLNP K Y S LR("STOP")=2 Q  ; If incomplete answers given during relocation, gives warning message and deletes current relocation.
"RTN","LRBLJL",46,0)
 I $D(LRG(LRX)) D PRE,CLNP Q  ; If a previous Unsatisfactory Inspection, gives warning message and deletes current relocation.
"RTN","LRBLJL",47,0)
 S ^LRD(65,"AL",LRW(1),LRX)="",LRK=LRW(1) D G
"RTN","LRBLJL",48,0)
 Q
"RTN","LRBLJL",49,0)
PRE ; Warning message if a unit has had a previous Unsatisfactory Inspection
"RTN","LRBLJL",50,0)
 N UNIT S UNIT=$P(^LRD(65,LRX,0),U)
"RTN","LRBLJL",51,0)
 W $C(7),!!,UNIT," has had a previous Unsatisfactory inspection and cannot be relocated.",!!,"Relocation entry <DELETED>",! Q
"RTN","LRBLJL",52,0)
CLNP ; When indicated, current relocation episode is deleted.
"RTN","LRBLJL",53,0)
 S DA(1)=LRX,DIK="^LRD(65,"_DA(1)_",3," D ^DIK S LRZ(LRX)=1 Q
"RTN","LRBLJL",54,0)
C I $D(R),$P(LRE,"^",8)=1,$P(LRE,"^",10)'=1 W ! F Z=0:0 S Z=$O(R(Z)) Q:'Z  I Z'=LRB,'$D(^LRD(65,LRX,70,Z,0)) W !,$P(^LAB(61.3,Z,0),"^"),$E("..............",$X,14),?15,"RBC ANTIGEN" S LRZ(LRX)=1
"RTN","LRBLJL",55,0)
 I LRZ(LRX) W $C(7),!,"Above antigen(s) not entered in RBC ANTIGEN ABSENT field"
"RTN","LRBLJL",56,0)
 D:$P(LRE,"^",9)=1 D W:LRZ(LRX) !?3,"for ",$P(LRE,"^",2),?28,"*** UNIT NOT RELOCATED ***",! Q
"RTN","LRBLJL",57,0)
D S X=$S($D(^LRD(65,+LRE,10)):$P(^(10),"^"),1:"") S:X="ND" X="" I X="" S LRZ(LRX)=1 W $C(7),!,"ABO not rechecked"
"RTN","LRBLJL",58,0)
 I X]"",X'=$P($P(LRE,"^",4)," ") S LRZ(LRX)=1 W $C(7),!,"ABO recheck different from ABO GROUP"
"RTN","LRBLJL",59,0)
 S X=$S($D(^LRD(65,+LRE,11)):$P(^(11),"^"),1:"") S:X="ND" X="" I $P($P(LRE,U,4)," ",2)="NEG",X="" S LRZ(LRX)=1 W $C(7),!,"Rh NEG unit not rechecked"
"RTN","LRBLJL",60,0)
 I X]"",X'=$P($P(LRE,U,4)," ",2) W $C(7),!!?6,"Rh recheck (",X,") different from Rh TYPE (",$P($P(LRE,U,4)," ",2),")" W !?6,"Are you sure you want to relocate unit " S %=2 D YN^LRU S:%'=1 LRZ(LRX)=1
"RTN","LRBLJL",61,0)
 Q
"RTN","LRBLJL",62,0)
G W !,$P(LRE,"^",2)," relocated" D:LRCAPA ^LRBLW K Y Q
"RTN","LRBLJL",63,0)
I W $C(7),"      Are you sure " S %=2 D YN^LRU S:%'=1 Y=.02 Q
"RTN","LRBLJL",64,0)
S W !?15,$C(7),"***Unsatisfactory unit(s) returned to BLOOD BANK***",! S $P(^LRD(65,LRX,3,DA,0),"^",4)="BLOOD BANK",Y=.05 Q
"RTN","LRBLJL",65,0)
W W $C(7),!!,"No units with incomplete answers or units to be sent from the blood bank",!,"with unsatisfactory inspections can be relocated. Relocation entry <DELETED>",! Q
"RTN","LRBLJL",66,0)
END D V^LRU Q
"RTN","LRBLJLA")
0^19^B12968369^B12954422
"RTN","LRBLJLA",1,0)
LRBLJLA ;AVAMC/REG/CYM - CROSSMATCH LABELS ;6/17/96  14:21 ;
"RTN","LRBLJLA",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJLA",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJLA",4,0)
 Q  D END,CK^LRBLPUS G:Y=-1 END S:'$D(^LRO(69.2,LRAA,9,0)) ^(0)="^69.25A^^"
"RTN","LRBLJLA",5,0)
 W !?30,"PRINT XMATCH LABELS" S X=$P(^LRO(69.2,LRAA,9,0),"^",4) W:X !?25,"(There ",$S(X>1:"are",1:"is")," ",X," label",$S(X>1:"s",1:"")," to print)"
"RTN","LRBLJLA",6,0)
 W !?3,"Add labels for emergency transfusion " S %=2 D YN^LRU I %=1 D E
"RTN","LRBLJLA",7,0)
 W !! I '$O(^LRO(69.2,LRAA,9,0)) W $C(7),!!,"THERE ARE NO LABELS TO PRINT !",!,"DO WANT TO ADD SOME OF YOUR OWN" S %=2 D YN^LRU G:%'=1 END D C G ED
"RTN","LRBLJLA",8,0)
 W !,"Do you want to delete the list of labels " S %=2 D YN^LRU I %=1 W $C(7),!,"Are you sure " S %=2 D YN^LRU I %=1 W "  OK, List DELETED." K ^LRO(69.2,LRAA,9) D END Q
"RTN","LRBLJLA",9,0)
ED W !,"Edit LABELS " S %=2 D YN^LRU G:%<1 END D:%=1 C
"RTN","LRBLJLA",10,0)
 W !!,"Save list for repeat printing " S %=2 D YN^LRU G:%<1 END S:%=1 LRQ=1
"RTN","LRBLJLA",11,0)
 W !!?33,"REMEMBER TO",!?13,"ALIGN THE PRINT HEAD ON THE FIRST LINE OF THE LABEL"
"RTN","LRBLJLA",12,0)
 S LR(1)=$S($D(^LRO(69.2,LRAA,0)):$P(^(0),U,7),1:"")
"RTN","LRBLJLA",13,0)
I W !!?20,"ENTER  NUMBER OF LINES  FROM",!?20,"TOP OF ONE LABEL TO ANOTHER: ",LR(1),$S(LR(1):"// ",1:"") R X:DTIME G:'$T!(X[U) END S X=$S(X="":LR(1),$L(X)>2:X=1,1:X)
"RTN","LRBLJLA",14,0)
ASK W ! X $P(^DD(69.2,.07,0),"^",5,99) I '$D(X) W:$D(^DD(69.2,.07,3)) !,$C(7),^(3) X:$D(^(4)) ^(4) G I
"RTN","LRBLJLA",15,0)
 I X["?" S X="ZZZ" G ASK
"RTN","LRBLJLA",16,0)
 S LR(1)=X
"RTN","LRBLJLA",17,0)
 S ZTRTN="QUE^LRBLJLA" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLJLA",18,0)
QUE U IO
"RTN","LRBLJLA",19,0)
 F A=0:0 S A=$O(^LRO(69.2,LRAA,9,A)) Q:'A  S X=^(A,0) F B=1:1:LR(1) W $P(X,"^",B),!
"RTN","LRBLJLA",20,0)
OUT K:'$D(LRQ) ^LRO(69.2,LRAA,9) K %ZIS S (LR("FORM"),LR("LINE"))=1 D END^LRUTL,END Q
"RTN","LRBLJLA",21,0)
 ;
"RTN","LRBLJLA",22,0)
C W ! S DIC="^LRO(69.2,LRAA,9,",DLAYGO=69,DIC(0)="AEQLM",DIC("A")="Select Unit ID: " D ^DIC K DIC,DLAYGO Q:X=""!(X[U)  S DA=+Y
"RTN","LRBLJLA",23,0)
 S DIE="^LRO(69.2,LRAA,9,",DR=".01:.05",DA=+Y D ^DIE K DIC,DIE,DR,DA,D G C
"RTN","LRBLJLA",24,0)
 ;
"RTN","LRBLJLA",25,0)
E S:'$D(^LRO(69.2,LRAA,9,0)) ^(0)="^69.25A^^"
"RTN","LRBLJLA",26,0)
A K DIC D ^LRDPA Q:LRDFN=-1  S X=^LR(LRDFN,0),Y=$P(X,"^",3),LRABO=$P(X,"^",5),LRRH=$P(X,"^",6),(LRDPF,X)=$P(X,"^",2),X=^DIC(X,0,"GL"),Z=$S($D(@(X_Y_",.35)")):+^(.35),1:0),X=@(X_Y_",0)"),LRP=$P(X,"^"),SSN=$P(X,"^",9) D SSN^LRU
"RTN","LRBLJLA",27,0)
 I Z W $C(7),! G A
"RTN","LRBLJLA",28,0)
B R !!,"Enter number of crossmatch labels wanted: ",LRB:DTIME Q:LRB=""!(LRB[U)  I LRB<1!(LRB>99) W $C(7),!,"Enter a number from 1 to 99." G B
"RTN","LRBLJLA",29,0)
 S %DT="T",X="N" D ^%DT,D^LRU
"RTN","LRBLJLA",30,0)
 L +^LRO(69.2,LRAA,9):5 I '$T W $C(7),!!,"I can't make those extra labels now.",!!,"Someone else started this first",!!,"Try again later if you still need extras",!! Q
"RTN","LRBLJLA",31,0)
 S X=^LRO(69.2,LRAA,9,0),LRC=$P(X,"^",3)+1,Z=$P(X,"^",3)+LRB,^(0)=$P(X,"^",1,2)_"^"_Z_"^"_Z
"RTN","LRBLJLA",32,0)
 F A=LRC:1:Z S ^LRO(69.2,LRAA,9,A,0)=Y_"^"_LRP_" "_SSN_"^"_"Patient ABO/Rh: "_LRABO_" "_LRRH_"^"_"Unit    ABO/Rh:        Unit#:"_"^"_"Crossmatch:            Tech :"
"RTN","LRBLJLA",33,0)
 L -^LRO(69.2,LRAA,9) Q
"RTN","LRBLJLA",34,0)
 ;
"RTN","LRBLJLA",35,0)
END D V^LRU Q
"RTN","LRBLJLG")
0^20^B33508403^B33485546
"RTN","LRBLJLG",1,0)
LRBLJLG ;AVAMC/REG/CYM - BB INVENTORY LOG-IN 11/12/96  07:49 ; 11/22/00 2:21pm
"RTN","LRBLJLG",2,0)
 ;;5.2;LAB SERVICE;**72,139,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJLG",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJLG",4,0)
 Q  D END I '$G(DUZ(2)) W $C(7),!,"I need to know the name of your site (In the INSTITUTION file)." G END
"RTN","LRBLJLG",5,0)
 S LR("M")=1,X="BLOOD BANK" D ^LRUTL G:Y=-1 END K LRDPAF
"RTN","LRBLJLG",6,0)
 W !!?28,"Blood Component Log-In",!!?15,"Division: ",LRAA(4) D BAR^LRBLB
"RTN","LRBLJLG",7,0)
 I LRCAPA S X="UNIT LOG-IN/SEND-OUT" D X^LRUWK G:'$D(X) END D S^LRBLW
"RTN","LRBLJLG",8,0)
I R !!,"Enter INVOICE (or order) NUMBER: ",X:DTIME G:X=""!(X[U) END S LRI=X D
"RTN","LRBLJLG",9,0)
 . N IPTR,HLP D FIELD^DID(65,.03,"","INPUT TRANSFORM","IPTR") S IPTR=IPTR("INPUT TRANSFORM") X IPTR  I $D(X),X["?" K X
"RTN","LRBLJLG",10,0)
 . I '$D(X) D FIELD^DID(65,.03,"","HELP-PROMPT","HLP") S HLP=HLP("HELP-PROMPT") W !!,$C(7),HLP
"RTN","LRBLJLG",11,0)
 I '$D(X) G I
"RTN","LRBLJLG",12,0)
D R !,"DATE/TIME RECEIVED: NOW// ",X:DTIME G:X[U!'$T END S:X="" X="N" S %DT="ETX",%DT(0)="-N" D ^%DT K %DT S LRK=Y I Y<1!('$P(Y,".",2)) W $C(7),!,"Must enter a TIME. Future DATE/TIME not allowed.",! G D
"RTN","LRBLJLG",13,0)
C K LRL,X S LRC="",LRL=0 W !!,"Invoice number: ",LRI,! S X=$$READ^LRBLB("Select BLOOD COMPONENT: ") G:X=""!(X[U) I
"RTN","LRBLJLG",14,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D P^LRBLB I '$D(X) W $C(7),!,"Code not entered in BLOOD PRODUCT file or not product label.",! G C
"RTN","LRBLJLG",15,0)
 W:'LR $$STRIP^LRBLB(.X)  ; Remove data identifiers just in case
"RTN","LRBLJLG",16,0)
 W ! I LRC="" S DIC=66,DIC(0)="EQMZ",DIC("S")="I $P(^(0),U,4)=""BB""" D ^DIC K DIC G I:X=""!(X[U),C:X["?"!(Y<1) S LRC=+Y,P=$P(Y,U,2),LRR=$P(Y(0),U,19),LRV=$P(Y(0),U,10),Z=$P(Y(0),U,25),LRJ=$S(Z=1:"A",Z=2:"D",1:""),LRBLISBT=+$P(Y(0),U,29)
"RTN","LRBLJLG",17,0)
 S X(1)=+$O(^LAB(66,LRC,"SU",0)) I X(1)<1 W $C(7),!!,"Must have at least one supplier for this component",!,"Please have appropriate person enter supplier(s) in ",$P(^LAB(66,0),U)," FILE (#66)",! G C
"RTN","LRBLJLG",18,0)
 S DIC="^LAB(66,"_LRC_",""SU"",",DIC(0)="AEQMZ",DIC("B")=$P(@(DIC_X(1)_",0)"),U) D ^DIC K DIC G:X=""!(X[U) C S LRW=$P(Y,U,2),LRM=$P(Y(0),U,2),LR(1)=$P(Y(0),"^",10),LR(3)=$P(Y(0),U,12),LR(4)=$L(LR(1))+1 K Y
"RTN","LRBLJLG",19,0)
 D EN^LRBLJLG1
"RTN","LRBLJLG",20,0)
 N IPTR,HLP S DA=0 D FIELD^DID(65,.01,"","INPUT TRANSFORM","IPTR") S IPTR=IPTR("INPUT TRANSFORM")
"RTN","LRBLJLG",21,0)
 D FIELD^DID(65,.01,"","HELP-PROMPT","HLP") S HLP=HLP("HELP-PROMPT")
"RTN","LRBLJLG",22,0)
E W !! S X=$$READ^LRBLB("UNIT ID: ",13) I X=""!(X[U) D ^LRBLJLG1 G C
"RTN","LRBLJLG",23,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D U^LRBLB
"RTN","LRBLJLG",24,0)
 W:'LR $$STRIP^LRBLB(.X)  ; Remove data identifiers just in case
"RTN","LRBLJLG",25,0)
 I X[" " W $C(7),"  No spaces allowed." G E
"RTN","LRBLJLG",26,0)
 I X["?" W $C(7)," Enter the Unit ID Without the Prefix" G E
"RTN","LRBLJLG",27,0)
 X IPTR I $D(X),X["?" K X G E
"RTN","LRBLJLG",28,0)
 I '$D(X) W !!,$C(7),HLP G E
"RTN","LRBLJLG",29,0)
 S:'LRBLISBT X=LR(1)_X ;concatinate supplier prefix #
"RTN","LRBLJLG",30,0)
 S LRP=X,DIC=65,DIC(0)="EFMXZ" D ^DIC K DIC S DA=+Y,W=$S($D(Y(0)):Y(0),1:"")
"RTN","LRBLJLG",31,0)
 I Y'>1 F C=0:0 S C=$O(^LRD(65,"B",X,C)) Q:'C  I $D(^LRD(65,C,0)),$P(^(0),"^",4)=LRC W $C(7),!!,"I might have that unit already in inventory.  Let's try that again ",! G E
"RTN","LRBLJLG",32,0)
 I Y>0 S X=$P(Y(0),U) F C=0:0 S C=$O(^LRD(65,"B",X,C)) Q:'C  I $D(^LRD(65,C,0)),$P(^(0),"^",4)=LRC W $C(7),!,$P(^LAB(66,LRC,0),U)," already in inventory with same Unit ID !" D EN1^LRBLJLG1 K Y G E
"RTN","LRBLJLG",33,0)
 K Y(0) I Y>0 W $C(7),!,"Entry in INVENTORY file.",!,"Add ",P," for this DONOR ID# " S %=2 D YN^LRU G:%'=1 E W !!,"Are you SURE ? " S %=2 D YN^LRU G:%'=1 E S LRABO=$P(W,U,7),LRRH=$P(W,U,8) G ED
"RTN","LRBLJLG",34,0)
A K X S (LRABO,LRRH)="" W ! S X=$$READ^LRBLB("ABO/Rh: ",14) G:X=""!(X[U) E
"RTN","LRBLJLG",35,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D A^LRBLB I '$D(X) W !,$C(7),"No such ABO/Rh bar code",!! G A
"RTN","LRBLJLG",36,0)
 I LRABO="" W $$STRIP^LRBLB(.X) D T^LRBLB G:'$D(X) A
"RTN","LRBLJLG",37,0)
ED S (LRA,LRH)="" W ! S X=$$READ^LRBLB("EXPIRATION DATE/TIME: ") G:X=""!(X[U) E
"RTN","LRBLJLG",38,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D D^LRBLB I '$D(X) W $C(7),!,"Not Date bar code",! G ED
"RTN","LRBLJLG",39,0)
 W:'LR $$STRIP^LRBLB(.X)  ; Remove data identifiers just in case
"RTN","LRBLJLG",40,0)
 I 'LRH S %DT="ETX" D ^%DT K %DT G ED:X["?",E:Y<1 S LRH=Y
"RTN","LRBLJLG",41,0)
 I LRS,LRH>LRS W $C(7),!?4,"Expiration date exceeds allowable limit !" G ED
"RTN","LRBLJLG",42,0)
 L +^LRD(65,0):8 I '$T W $C(7),!!,"We can't do this right now...",!!,"Someone else is creating a new entry in the INVENTORY file ",!!,"Try again..",!! G E
"RTN","LRBLJLG",43,0)
 S (UNIT,TYPE)=""
"RTN","LRBLJLG",44,0)
 I $D(^LRD(65,"B",LRP)) S UNIT=$O(^LRD(65,"B",LRP,0)) D
"RTN","LRBLJLG",45,0)
 . S TYPE=$P($G(^LRD(65,UNIT,0)),U,4) I TYPE=LRC D
"RTN","LRBLJLG",46,0)
 .. W $C(7),!!,"I think someone else is trying to log this unit in" K UNIT,TYPE L -^LRD(65,0)
"RTN","LRBLJLG",47,0)
 I '$D(UNIT) G E
"RTN","LRBLJLG",48,0)
 S DA=+$P(^LRD(65,0),"^",3) F  S DA=DA+1 Q:'$D(^LRD(65,DA))
"RTN","LRBLJLG",49,0)
 L +^LRD(65,DA):1 I '$T W $C(7),!!,"Can't do this now...",!!,"Looks like 2 of you are creating the same record.",!!,"Try again..." G E
"RTN","LRBLJLG",50,0)
 S ^LRD(65,DA,0)=LRP,^LRD(65,"B",LRP,DA)="",^LRD(65,0)="BLOOD INVENTORY^65I^"_DA_"^"_($P(^LRD(65,0),"^",4)+1)
"RTN","LRBLJLG",51,0)
 L -^LRD(65,0)
"RTN","LRBLJLG",52,0)
 S:LR(4)>1 ^LRD(65,"C",$E(LRP,LR(4),$L(LRP)),DA)=""
"RTN","LRBLJLG",53,0)
 S DIE="^LRD(65,",DIE("NO^")="OUTOK",(^LRD(65,"AT",LRP,10,DA),^LRD(65,"AT",LRP,11,DA))=""
"RTN","LRBLJLG",54,0)
 S DR=".02///"_LRW_";.03///"_LRI_";.04////"_LRC_";.05///"_LRK_";.09////"_DUZ_";.1///"_LRM_";.11///"_LRV_";.07///"_LRABO_";.08///"_LRRH_";.06///"_LRH_";.16////"_DUZ(2) D ^DIE
"RTN","LRBLJLG",55,0)
 I LRJ]"" S DR="8;I X="""" D H^LRBLJLG S Y=8;8.1;I X="""" D H^LRBLJLG S Y=8.1;8.3///"_LRJ D ^DIE I $D(Y) W $C(7),!!,"Entry deleted." S DIK="^LRD(65," D ^DIK K DIK G E
"RTN","LRBLJLG",56,0)
 D:LRR=1 S S LRL=LRL+1,LRL(LRL)=DA_"^"_LRP_"^"_LRABO_"^"_LRRH_"^"_LRH_"^"_LRA_"^"_LRC G E
"RTN","LRBLJLG",57,0)
 ;
"RTN","LRBLJLG",58,0)
S S:'$D(^LRO(69.2,LRAA,6,0)) ^(0)="^69.26A^^"
"RTN","LRBLJLG",59,0)
 L +^LRO(69.2,LRAA,6):5 I '$T W $C(7),!!,"I can't add this to the ABO/Rh typing worksheet",!!,"Someone else is editing that worksheet",!!,"Add this unit Manually when printing the ABO/Rh typing worksheet",!! Q
"RTN","LRBLJLG",60,0)
 S X=^LRO(69.2,LRAA,6,0)
"RTN","LRBLJLG",61,0)
 S ^LRO(69.2,LRAA,6,DA,0)=DA,^LRO(69.2,LRAA,6,0)="^69.26A^"_DA_"^"_($P(X,"^",4)+1) L -^LRO(69.2,LRAA,6) Q
"RTN","LRBLJLG",62,0)
H W $C(7),!!,"Answer prompt.  To quit enter '^' and unit will be deleted.",! Q
"RTN","LRBLJLG",63,0)
END D V^LRU Q
"RTN","LRBLJM")
0^21^B7598421^B7587108
"RTN","LRBLJM",1,0)
LRBLJM ;AVAMC/REG/CYM - EDIT POOLED UNIT ;9/26/97  13:01 ;
"RTN","LRBLJM",2,0)
 ;;5.2;LAB SERVICE;**90,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJM",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJM",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END D BAR^LRBLB
"RTN","LRBLJM",5,0)
ASK W !! S X=$$READ^LRBLB("Select POOLED UNIT: ") G:X=""!(X[U) END
"RTN","LRBLJM",6,0)
 I X'["?",LR,$E(X,1,$L(LR(2)))=LR(2) D ^LRBLBU G:'$D(X) ASK
"RTN","LRBLJM",7,0)
 W:'LR $$STRIP^LRBLB(.X)  ; Strip off the data identifiers just in case
"RTN","LRBLJM",8,0)
 I '$O(^LRD(65,"B",X,0)) W $C(7),"  Must enter a specific unit" G ASK
"RTN","LRBLJM",9,0)
 D REST,K^LRU
"RTN","LRBLJM",10,0)
 I $D(LRLOCK) L -^LRD(65,LRLOCK)
"RTN","LRBLJM",11,0)
 K ^TMP($J),LRV,LRP,DA,LRLOCK G ASK
"RTN","LRBLJM",12,0)
REST S LR("Q")=0,DIC="^LRD(65,",DIC(0)="EFQMZ",DIC("S")="I $P($G(^LAB(66,+$P(^(0),U,4),0)),U,27)"
"RTN","LRBLJM",13,0)
 D ^DIC K DIC Q:Y<1  S LRP=+Y,LRW=Y(0),LRA=$P(^LAB(66,$P(Y(0),U,4),0),U,26) D L Q:LRL
"RTN","LRBLJM",14,0)
 I $P(^LRD(65,LRP,0),U,16)'=DUZ(2) W $C(7),!!,"You can only edit Pooled Units from your own division.",! G ASK
"RTN","LRBLJM",15,0)
 I '$O(^LRD(65,LRP,9,0)) W $C(7),!,"No units in pool." Q
"RTN","LRBLJM",16,0)
 W !?5,"Units in pool: " S E=0 F LRB=0:0 S LRB=$O(^LRD(65,LRP,9,LRB)) Q:'LRB!(LR("Q"))  S X=^(LRB,0),Y=$P(X,"^",2),LRZ=+X D:Y]"" W
"RTN","LRBLJM",17,0)
 Q:'$D(^TMP($J))!(LR("Q"))
"RTN","LRBLJM",18,0)
S S DIR(0)="S^A:Add unit to pool;R:Remove unit from pool;D:Delete the pool" D ^DIR
"RTN","LRBLJM",19,0)
 G:$D(DIRUT) END
"RTN","LRBLJM",20,0)
 D @(Y_"^LRBLJM1")
"RTN","LRBLJM",21,0)
 Q
"RTN","LRBLJM",22,0)
 ;
"RTN","LRBLJM",23,0)
W S LRV=0 F B=0:0 S B=$O(^LRD(65,"B",Y,B)) Q:'B  S W=^LRD(65,B,0),W(4)=$P(^LAB(66,LRZ,0),U) I $P(W,U,4)=LRZ S LRV=1,E=E+1,^TMP($J,E)=LRB_U_B_U_$P(W,U)_U_W(4) W !?7,$P(W,U),?25,W(4) D:E#21=0 M^LRU Q:LR("Q")
"RTN","LRBLJM",24,0)
 I 'LRV S LR("Q")=1 D F
"RTN","LRBLJM",25,0)
 Q
"RTN","LRBLJM",26,0)
F W $C(7),!!?7,Y,?25,$P(^LAB(66,LRZ,0),U)," not correct" S DIC="^LAB(66,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,26)=LRA",DIC("A")="Select CORRECT COMPONENT: " D ^DIC K DIC Q:Y<1  S $P(^LRD(65,LRP,9,LRB,0),U)=+Y
"RTN","LRBLJM",27,0)
 S DA(1)=LRP,DA=LRB,X=+Y,O=LRZ,Z="65.091,.01" D EN^LRUD
"RTN","LRBLJM",28,0)
 Q
"RTN","LRBLJM",29,0)
L ;
"RTN","LRBLJM",30,0)
 S LRL=0
"RTN","LRBLJM",31,0)
 I $D(LRLOCK)#2 L -^LRD(65,LRLOCK)
"RTN","LRBLJM",32,0)
 S LRLOCK=LRP L +^LRD(65,LRP):1
"RTN","LRBLJM",33,0)
 I '$T W !,$C(7),"ANOTHER TERMINAL IS EDITING ",$P(^LRD(65,LRP,0),U) S LRL=1
"RTN","LRBLJM",34,0)
 Q
"RTN","LRBLJM",35,0)
 ;
"RTN","LRBLJM",36,0)
END D V^LRU Q
"RTN","LRBLJR")
0^22^B11560523^B11541905
"RTN","LRBLJR",1,0)
LRBLJR ;AVAMC/REG/CYM - RELEASE FROM XMATCH ;6/20/96  12:11 ;
"RTN","LRBLJR",2,0)
 ;;5.2;LAB SERVICE;**72,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJR",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJR",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END I LRCAPA S X="UNIT RELEASE" D X^LRUWK G:'$D(X) END
"RTN","LRBLJR",5,0)
ASK K DIC,LRZ W ! D ^LRDPA G:LRDFN=-1 END K A,LRV D R G ASK
"RTN","LRBLJR",6,0)
 ;
"RTN","LRBLJR",7,0)
R W ! S LRX=0 F A=1:1 S LRX=$O(^LRD(65,"AP",LRDFN,LRX)) Q:'LRX  I $D(^LRD(65,LRX,0)) S W=^(0),M=$P(^(2,LRDFN,0),"^",2),A(A)=LRX D:A=1 H D W
"RTN","LRBLJR",8,0)
 I A=1 W $C(7),!!,"No units crossmatched for ",LRP Q
"RTN","LRBLJR",9,0)
 D DT^LRBLU I A=2 S LRV=1 D RES G OUT:$D(LRZ),REL
"RTN","LRBLJR",10,0)
SEL W !,"Select units (1-",A-1,") for release: " R X:DTIME Q:X=""!(X[U)  I X["?" W !,"Enter numbers from 1 to ",A-1,!,"For 2 or more selections separate each with a ',' (ex. 1,3,4)",!,"Enter 'ALL' for all units." G SEL
"RTN","LRBLJR",11,0)
 G:X="ALL" ALL
"RTN","LRBLJR",12,0)
 I X?.E1CA.E!($L(X)>200) W $C(7),!,"No CONTROL CHARACTERS, LETTERS or more than 200 characters allowed" G SEL
"RTN","LRBLJR",13,0)
 I '+X W $C(7),!,"START with a NUMBER !!",! G SEL
"RTN","LRBLJR",14,0)
 S LRQ=X D RES G:$D(LRZ) OUT F LRA=0:0 S LRV=+LRQ,LRQ=$E(LRQ,$L(LRV)+2,$L(LRQ)) D:LRV REL Q:'$L(LRQ)
"RTN","LRBLJR",15,0)
 Q
"RTN","LRBLJR",16,0)
REL I '$D(A(LRV)) W !!,$C(7),"Selection ",LRV," doesn't exist.",! Q
"RTN","LRBLJR",17,0)
 I P(LRV)]"",P(LRV)'["BLOOD BANK" W $C(7),!!,$P(^LRD(65,A(LRV),0),"^")," not returned to BLOOD BANK.  Cannot release." Q
"RTN","LRBLJR",18,0)
 S A=1,LRX=A(LRV) I '$D(LRV(2)) S W=^LRD(65,LRX,0) W ! D W W !?25,"Ok to release " S %=1 D YN^LRU Q:%'=1
"RTN","LRBLJR",19,0)
 K ^LRD(65,"AP",LRDFN,LRX) S X=$P(^LRD(65,LRX,2,LRDFN,0),"^",3),^(0)=LRDFN
"RTN","LRBLJR",20,0)
 I X S X=$O(^LRD(65,LRX,2,LRDFN,1,"B",X,0)) I X,$D(^LRD(65,LRX,2,LRDFN,1,X,0)) S $P(^(0),"^",10)=LRV(1)
"RTN","LRBLJR",21,0)
 W:'$D(LRV(2)) !?3,"Released",! D:LRCAPA ^LRBLW Q
"RTN","LRBLJR",22,0)
 ;
"RTN","LRBLJR",23,0)
ALL S LRV(2)=1 D RES G:$D(LRZ) OUT F LRV=0:0 S LRV=$O(A(LRV)) Q:'LRV  D REL
"RTN","LRBLJR",24,0)
 W !!?3,"All valid releases completed." Q
"RTN","LRBLJR",25,0)
 ;
"RTN","LRBLJR",26,0)
W D:A#20=0 M S P=+$O(^LRD(65,LRX,3,0)) S P(A)=$S($D(^(P,0)):$P(^(0),"^",4),1:"")
"RTN","LRBLJR",27,0)
 W A,")",?3,$P(W,"^"),?17,$J($P(W,"^",7),2),?20,$P(W,"^",8),?24,$E($P(^LAB(66,$P(W,"^",4),0),"^"),1,20),?45 S T=$P(W,"^",6) D T^LRBLJX W T,?58 I M S T=M D T^LRBLJX W T
"RTN","LRBLJR",28,0)
 W ?70,$E(P(A),1,10),! Q
"RTN","LRBLJR",29,0)
H W !,"#",?3,"Unit ID",?17,"ABO/Rh",?24,"Component",?45,"Exp date",?58,"Xmatch date",?70,"Location",! Q
"RTN","LRBLJR",30,0)
M R "Press RETURN",X:DTIME W $C(13),$J("",15),$C(13) Q
"RTN","LRBLJR",31,0)
RES R !,"Reason for release: ",X:DTIME I X=""!(X[U) S:X[U LRZ=1 K X G SET
"RTN","LRBLJR",32,0)
 I X="TRANSFUSED" W $C(7),"   Not allowed, try again." G RES
"RTN","LRBLJR",33,0)
 I X["?"!($E(X)=" ") D  G RES
"RTN","LRBLJR",34,0)
 . N HLP D FIELD^DID(65.02,.1,"","HELP-PROMPT","HLP")
"RTN","LRBLJR",35,0)
 . S HLP=HLP("HELP-PROMPT") W !,HLP
"RTN","LRBLJR",36,0)
 . S L(1)="B" D Q^LRUB
"RTN","LRBLJR",37,0)
 N CHK S CHK=$$GET1^DID(65.02,.1,"","INPUT TRANSFORM") X CHK I '$D(X) W $C(7),!,"Reason not valid, try again " S %=1 D YN^LRU G:%=1 RES
"RTN","LRBLJR",38,0)
SET S LRV(1)=$S($D(X):X,1:"No release reason given") Q
"RTN","LRBLJR",39,0)
OUT W $C(7)," Unit(s) not released." Q
"RTN","LRBLJR",40,0)
END D V^LRU Q
"RTN","LRBLJSH")
0^23^B13303384^B13270669
"RTN","LRBLJSH",1,0)
LRBLJSH ;AVAMC/REG - BB INVENTORY SHIPMENTS ;2/18/93  09:31 ;
"RTN","LRBLJSH",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJSH",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJSH",4,0)
 Q  D END S:'$D(DTIME) DTIME=300 S LRI=$O(^LAB(65.9,"B","SHIPPING INVOICE",0)) I 'LRI W $C(7),!!,"SHIPPING INVOICE must be an entry in the LAB LETTER FILE (65.9)." G END
"RTN","LRBLJSH",5,0)
 S IOP="HOME" D ^%ZIS W @IOF,?18,"INVOICE FOR SHIPMENT OF BLOOD COMPONENTS"
"RTN","LRBLJSH",6,0)
 D B^LRU G:Y<0 END S LRLDT=LRLDT+.99,LRSDT=LRSDT-.01
"RTN","LRBLJSH",7,0)
I R !!,"Enter SHIPPING INVOICE#: ",X:DTIME G:X[U!(X="") END S LRB=X X $P(^DD(65,.13,0),U,5,99) S:'$D(X) X="?" I X["?" W $C(7),"  Enter invoice # (2-10 characters)" G I
"RTN","LRBLJSH",8,0)
A R !!,"Enter name to appear on invoice: ",X:DTIME G:X[U END D CK G:'$D(X) A S LR=X I X="" W $C(7),"  Must have a name. Enter '^' to quit" G A
"RTN","LRBLJSH",9,0)
B R !!,"Enter address line 1: ",X:DTIME G:X[U END D CK G:'$D(X) B S LR(1)=X
"RTN","LRBLJSH",10,0)
C R !,"Enter address line 2: ",X:DTIME G:X[U END D CK G:'$D(X) C S LR(2)=X
"RTN","LRBLJSH",11,0)
D R !,"Enter address line 3: ",X:DTIME G:X[U END D CK G:'$D(X) D S LR(3)=X
"RTN","LRBLJSH",12,0)
 S ZTRTN="QUE^LRBLJSH" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLJSH",13,0)
QUE U IO K ^TMP($J) S Z=0 D L^LRU,S^LRU
"RTN","LRBLJSH",14,0)
 F B=0:0 S LRSDT=$O(^LRD(65,"AB",LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  F LRA=0:0 S LRA=$O(^LRD(65,"AB",LRSDT,LRA)) Q:'LRA  I $D(^LRD(65,LRA,0)),$P(^(0),"^",13)=LRB S W=^(0) D SET
"RTN","LRBLJSH",15,0)
 D WRT D:$Y>(IOSL-6) H Q:LR("Q")  W !,LR("%"),!,"Total unit count (all components): ",Z K ^TMP($J)
"RTN","LRBLJSH",16,0)
 D E,END,END^LRUTL Q
"RTN","LRBLJSH",17,0)
SET S ^TMP($J,$P(W,"^",4),$P(W,"^",7),$P(W,"^",8),$P(W,"^"))=$P(W,"^",6)_"^"_LRA Q
"RTN","LRBLJSH",18,0)
WRT D H1 Q:LR("Q")  S LR("F")=1 F C=0:0 S C=$O(^TMP($J,C)) Q:'C!(LR("Q"))  S V=0 D:$Y>(IOSL-6) H1 Q:LR("Q")  W !!,"Component: " S C(1)=^LAB(66,C,0),C(20)=$P(C(1),"^",20),C(1)=$P(C(1),"^") W C(1) W:C(20)]"" " (",C(20),")" D ABO
"RTN","LRBLJSH",19,0)
 Q
"RTN","LRBLJSH",20,0)
ABO S A=0 F B=0:1 S A=$O(^TMP($J,C,A)) Q:A=""!(LR("Q"))  S R=0 F E=0:0 S R=$O(^TMP($J,C,A,R)) Q:R=""!(LR("Q"))  S I=0 F F=0:0 S I=$O(^TMP($J,C,A,R,I)) Q:I=""!(LR("Q"))  S W=^(I) D W
"RTN","LRBLJSH",21,0)
 Q
"RTN","LRBLJSH",22,0)
W D:$Y>(IOSL-6) H2 Q:LR("Q")  S V=V+1,Z=Z+1,Y=+W D D^LRU W !,$J(V,5) W:$P($G(^LRD(65,+$P(W,"^",2),8)),"^",2) "  Pos/Incomplete Tests" W ?28,$J(A,2),?32,R,?38,I,?53,Y Q
"RTN","LRBLJSH",23,0)
 ;
"RTN","LRBLJSH",24,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLJSH",25,0)
 D F^LRU W !,"BLOOD BANK",?21,"SHIPPING INVOICE#: ",LRB,!?21,"To: ",LR F X=0:0 S X=$O(LR(X)) Q:'X  W:LR(X)]"" !?25,LR(X)
"RTN","LRBLJSH",26,0)
 Q
"RTN","LRBLJSH",27,0)
H1 D H Q:LR("Q")  W !?28,"ABO",?32,"Rh",?38,"UNIT ID",?53,"Expiration date",!,LR("%") Q
"RTN","LRBLJSH",28,0)
H2 D H1 Q:LR("Q")  W !!,"Component: ",C(1) W:C(20)]"" " (",C(20),")" W ! Q
"RTN","LRBLJSH",29,0)
H3 D H Q:LR("Q")  W !,LR("%"),!!! Q
"RTN","LRBLJSH",30,0)
 ;
"RTN","LRBLJSH",31,0)
CK I $L(X)>30!(X'?.ANP)!(X["?") W !,$C(7),"Entry must be less than 31 characters with no control characters." K X
"RTN","LRBLJSH",32,0)
 Q
"RTN","LRBLJSH",33,0)
E D:$Y>(IOSL-6) H Q:LR("Q")  K ^TMP($J) W !,LR("%") S X=^LAB(65.9,LRI,0),DIWL=$P(X,U,5),DIWR=IOM-$P(X,U,6),DIWF="W"
"RTN","LRBLJSH",34,0)
 S LRA=0 F LRZ=0:1 S LRA=$O(^LAB(65.9,LRI,2,LRA)) Q:'LRA!(LR("Q"))  D:$Y>(IOSL-6) H3 Q:LR("Q")  S X=^LAB(65.9,LRI,2,LRA,0) D ^DIWP
"RTN","LRBLJSH",35,0)
 Q:LR("Q")  D:LRZ ^DIWW Q
"RTN","LRBLJSH",36,0)
END D V^LRU Q
"RTN","LRBLJT")
0^24^B12324211^B12315310
"RTN","LRBLJT",1,0)
LRBLJT ;AVAMC/REG - BB ITEMIZED TRANSACTIONS ;2/18/93  09:32 ;
"RTN","LRBLJT",2,0)
 ;;5.2;LAB SERVICE;**247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLJT",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJT",4,0)
 Q  D END S X="T",%DT="" D ^%DT,D^LRU S LRH(0)=Y
"RTN","LRBLJT",5,0)
 S IOP="HOME" D ^%ZIS W @IOF,?18,"BLOOD PRODUCTS: ITEMIZED TRANSACTIONS LIST"
"RTN","LRBLJT",6,0)
 D EDC,B^LRU G:Y<0 END
"RTN","LRBLJT",7,0)
 S LRLDT=LRLDT+.99,LRSDT=LRSDT-.01
"RTN","LRBLJT",8,0)
 S ZTRTN="QUE^LRBLJT" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLJT",9,0)
QUE U IO K ^TMP($J) S Z=0 D L^LRU,S^LRU
"RTN","LRBLJT",10,0)
 F B=0:0 S LRSDT=$O(^LRD(65,"A",LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  F LRA=0:0 S LRA=$O(^LRD(65,"A",LRSDT,LRA)) Q:'LRA  I $D(^LRD(65,LRA,0)) S W=^(0) D SET
"RTN","LRBLJT",11,0)
 D WRT G:LR("Q") OUT W !!,?69,"--------",!,"Total unit count (all components): ",Z,?50,"Total",?60,"cost",?69,$J(Z(1),8,2)
"RTN","LRBLJT",12,0)
 S LRB=1 D:$Y>(IOSL-6) H G:LR("Q") OUT S A=0 F A(1)=0:0 S A=$O(LRC(A)) Q:A=""!(LR("Q"))  D:$Y>(IOSL-6) H Q:LR("Q")  W !,A,?5,"= ",$S($D(^LAB(66,LRC(A),0)):$P(^(0),"^"),1:"???")
"RTN","LRBLJT",13,0)
OUT K ^TMP($J) D END^LRUTL,END Q
"RTN","LRBLJT",14,0)
SET S LRI=$S($P(W,"^",3)]"":$P(W,"^",3),1:"UNKNOWN"),R=$P($P(W,"^",5),".",1),N=$P(W,"^",14),N=$S($P(W,"^",10):$P(W,"^",10),1:$E(N,2,$L(N)))
"RTN","LRBLJT",15,0)
 S ^TMP($J,$P(W,"^",2),$P(W,"^",4),R,LRI,$P(W,"^"))=$P(W,"^",6)_"^"_$P(W,"^",7)_"^"_$P(W,"^",8)_"^"_N_"^"_$S($D(^LRD(65,LRA,4)):$P(^(4),"^"),1:""),Z=Z+1
"RTN","LRBLJT",16,0)
 Q
"RTN","LRBLJT",17,0)
WRT D H Q:LR("Q")  S LR("F")=1,(Z(1),S)=0 F A(1)=1:1 S S=$O(^TMP($J,S)) Q:S=""!(LR("Q"))  D:$Y>(IOSL-6) H Q:LR("Q")  W !!,"Supplier: ",S,! D C
"RTN","LRBLJT",18,0)
 Q
"RTN","LRBLJT",19,0)
C S C=0 F A=0:1 S C=$O(^TMP($J,S,C)) Q:'C!(LR("Q"))  S C(1)=$S($D(^LAB(66,C,0)):$P(^(0),"^",2),1:"???"),LRC(C(1))=C D:$Y>(IOSL-6) H1 Q:LR("Q")  W !!,C(1) D DATE
"RTN","LRBLJT",20,0)
 Q
"RTN","LRBLJT",21,0)
DATE S (Z(3),Z(5),R)=0 F B=0:1 S R=$O(^TMP($J,S,C,R)) Q:'R!(LR("Q"))  S Y=R D D^LRU S R(1)=Y D:$Y>(IOSL-6) H2 Q:LR("Q")  W:B ! W ?7,R(1) D L
"RTN","LRBLJT",22,0)
 Q:LR("Q")  W !?69,"--------",!?50,C(1),?60,"cost",?69,$J(Z(3),8,2) Q
"RTN","LRBLJT",23,0)
L S L=0 F E=0:1 S L=$O(^TMP($J,S,C,R,L)) Q:L=""!(LR("Q"))  D:$Y>(IOSL-6) H3 Q:LR("Q")  W:E ! W ?21,L D U
"RTN","LRBLJT",24,0)
 Q
"RTN","LRBLJT",25,0)
U S L(1)=0 F F=0:1 S L(1)=$O(^TMP($J,S,C,R,L,L(1))) Q:L(1)=""!(LR("Q"))  S W=^(L(1)) D FIN
"RTN","LRBLJT",26,0)
 Q
"RTN","LRBLJT",27,0)
FIN S Z(6)=$P(W,"^",4) S:Z(6)'["-" Z(5)=Z(5)+1 D:$Y>(IOSL-6) H3 Q:LR("Q")  W:F ! W:Z(6)'["-" ?30,$J(Z(5),5),")" W ?37,L(1),?51,$P(W,"^",2),?53,$E($P(W,"^",3),1)
"RTN","LRBLJT",28,0)
 S Z(3)=Z(3)+Z(6),Z(1)=Z(1)+Z(6),Y=$P($P(W,"^"),".",1) D D^LRU W ?55,Y,?71,$J(Z(6),6) S V=$P(W,"^",5) W ?78,V Q
"RTN","LRBLJT",29,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLJT",30,0)
 D F^LRU W !,"BLOOD BANK INVOICES (from ",LRSTR," to ",LRLST,")" I $D(LRB) W !,LR("%") Q
"RTN","LRBLJT",31,0)
 W !,"COMPONENT",?12,"DATE",?21,"INVOICE#",?30,"COUNT",?37,"UNIT NO",?51,"TYPE",?58,"EXP DATE",?71,"AMOUNT",?78,"D",!,LR("%") Q
"RTN","LRBLJT",32,0)
H1 D H Q:LR("Q")  W !!,"Supplier: ",S,! Q
"RTN","LRBLJT",33,0)
H2 D H1 Q:LR("Q")  W !!,C(1) Q
"RTN","LRBLJT",34,0)
H3 D H2 Q:LR("Q")  W ?10,R(1) Q
"RTN","LRBLJT",35,0)
EDC W ! W "Edit supplier charges before listing invoices?  NO// " R X:DTIME Q:X=""!(X[U)!(X?1"N".E)  G EDC:X'?1"Y".E
"RTN","LRBLJT",36,0)
N S (DIC,DIE)=65,DIC(0)="AEFQM",DIC("A")="Select donor unit: " D ^DIC K DIC Q:X=""!(X[U)  S DA=+Y,DR=".1;.13;.14" D ^DIE K DIC,DIE,DR,DA,DQ G N
"RTN","LRBLJT",37,0)
 ;
"RTN","LRBLJT",38,0)
END D V^LRU Q
"RTN","LRBLJW")
0^25^B15926526^B15908424
"RTN","LRBLJW",1,0)
LRBLJW ;AVAMC/REG/CYM - INVENTORY ABO/RH WORKSHEET ;6/14/96  20:40 ;
"RTN","LRBLJW",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLJW",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLJW",4,0)
 Q  D END S LR("M")=1,X="BLOOD BANK" D ^LRUTL G:Y=-1 END S:'$D(^LRO(69.2,LRAA,6,0)) ^(0)="^69.26A^^"
"RTN","LRBLJW",5,0)
 W !?24,"PRINT ABO/RH INVENTORY WORKSHEET",!!
"RTN","LRBLJW",6,0)
 I $O(^LRO(69.2,LRAA,6,0)) W !,"List ABO/Rh worksheet entries " S %=2 D YN^LRU Q:%<1  I %=1 S LR("Q")=0 D L K ^TMP($J)
"RTN","LRBLJW",7,0)
 W !,"Add/delete ABO/Rh worksheet entries " S %=2 D YN^LRU Q:%<1  D:%=1 C
"RTN","LRBLJW",8,0)
 I '$O(^LRO(69.2,LRAA,6,0)) W $C(7),!!,"THERE ARE NO ENTRIES TO PRINT !" Q
"RTN","LRBLJW",9,0)
 W !!,"Save list for repeat printing " S %=2 D YN^LRU Q:%<1  S:%=1 S=1
"RTN","LRBLJW",10,0)
 S ZTRTN="QUE^LRBLJW" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLJW",11,0)
QUE U IO S C(3)=0 D L^LRU,S^LRU,H S LR("F")=1
"RTN","LRBLJW",12,0)
 S LRN=1 D L K:'$D(S) ^LRO(69.2,LRAA,6) D FT,END^LRUTL,END Q
"RTN","LRBLJW",13,0)
WRK D:$Y>(IOSL-10) H1 Q:LR("Q")  W !,$J(C,3),")",?5,$P(LRI,"^"),?19,$J($P(LRI,"^",7),2),?23,$P(LRI,"^",8),?27,"|",?38,"|",?43,"|  |  |  |  |  |  |  |",!,LR("%") Q
"RTN","LRBLJW",14,0)
 ;
"RTN","LRBLJW",15,0)
S F LR=0:0 S LR=$O(^LRO(69.2,LRAA,6,LR)) Q:'LR  I $D(^LRD(65,LR,0)) S X=^(0),^TMP($J,$P(X,"^",3),$P(X,"^"),LR)=X
"RTN","LRBLJW",16,0)
 Q
"RTN","LRBLJW",17,0)
 ;
"RTN","LRBLJW",18,0)
C W ! S DIC="^LRD(65,",DIC(0)="AEFQM",DIC("A")="Select Unit ID: ",DIC("S")="I $P(^(0),U,16)" D ^DIC K DIC Q:X=""!(X[U)  S LR=+Y
"RTN","LRBLJW",19,0)
 I $D(^LRO(69.2,LRAA,6,LR)) W !?3,$P(Y,U,2)," is an entry for the ABO/RH INVENTORY WORKSHEET.",!?3,"Do you want to delete it " S %=2 D YN^LRU G:%'=1 C D D G C
"RTN","LRBLJW",20,0)
 W !?3,"Do you want to add ",$P(Y,U,2)," to the ABO/RH INVENTORY WORKSHEET " S %=2 D YN^LRU G:%'=1 C
"RTN","LRBLJW",21,0)
 S:'$D(^LRO(69.2,LRAA,6,0)) ^(0)="^69.26A^^"
"RTN","LRBLJW",22,0)
 L +^LRO(69.2,LRAA,6):5 I '$T W $C(7),!!,"I can't add this to the worksheet now ",!!,"Someone else is editing this record",!! G C
"RTN","LRBLJW",23,0)
 S X=^LRO(69.2,LRAA,6,0),^(0)=$P(X,U,1,2)_"^"_LR_"^"_($P(X,"^",4)+1),^LRO(69.2,LRAA,6,LR,0)=LR L -^LRO(69.2,LRAA,6)
"RTN","LRBLJW",24,0)
 G C
"RTN","LRBLJW",25,0)
D L +^LRO(69.2,LRAA,6):5 I '$T W $C(7),!!,"I can't delete this from the worksheet now",!!,"Someone else is editing this record",!! Q
"RTN","LRBLJW",26,0)
 K ^LRO(69.2,LRAA,6,LR) S X=^LRO(69.2,LRAA,6,0),X(1)=$O(^(0)),^(0)=$P(X,U,1,2)_U_X(1)_U_$S(X(1)="":"",1:($P(X,U,4)-1)) L -^LRO(69.2,LRAA,6) Q
"RTN","LRBLJW",27,0)
 ;
"RTN","LRBLJW",28,0)
L D S S (A,C,E,F)=0
"RTN","LRBLJW",29,0)
 F G=0:0 S F=$O(^TMP($J,F)) Q:F=""!(LR("Q"))  D:$D(LRN) INV S:$D(LRN) C=0 F B=0:0 S A=$O(^TMP($J,F,A)) Q:A=""!(LR("Q"))  F I=0:0 S I=$O(^TMP($J,F,A,I)) Q:'I!(LR("Q"))  S C=C+1,LRI=^(I) D @$S($D(LRN):"WRK",1:"W")
"RTN","LRBLJW",30,0)
 Q
"RTN","LRBLJW",31,0)
W W:C#2=1 ! W:C#2=0 ?40 W $J(C,2),") ",$P(LRI,"^"),"  ",$J($P(LRI,"^",7),2)," ",$P(LRI,"^",8) D:C#40=0 M Q
"RTN","LRBLJW",32,0)
INV Q:LR("Q")  W !,"Invoice #: ",F Q
"RTN","LRBLJW",33,0)
 ;
"RTN","LRBLJW",34,0)
M W !,"'^' TO STOP: " R X:DTIME W $C(13),$J("",15),$C(13) S:'$T!(X[U) LR("Q")=1 Q
"RTN","LRBLJW",35,0)
 ;
"RTN","LRBLJW",36,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLJW",37,0)
 D F^LRU W !,LRO(68)," INVENTORY ABO/Rh TESTING WORKSHEET"
"RTN","LRBLJW",38,0)
 W !,"Incubator temp:",?28,"Reagent rack:",!,"Num",?5,"Donor ID",?18,"|Supplier",?27,"|VA interp",?38,"|    |---ANTI----|Rh|  |Du|"
"RTN","LRBLJW",39,0)
 W !?18,"|ABO Rh",?27,"| ABO Rh",?38,"|tech",?42,"|A |B |AB| D|Ct|Du|Ct|",!,LR("%") Q
"RTN","LRBLJW",40,0)
H1 D H,INV Q
"RTN","LRBLJW",41,0)
FT S LRI=$O(^LAB(65.9,"B","INVENTORY WORKSHEET",0)) I 'LRI W !!,"INVENTORY WORKSHEET must be an entry in the LAB LETTER FILE (65.9)",!,"to print legend." Q
"RTN","LRBLJW",42,0)
 D:$Y>(IOSL-6) H Q:LR("Q")  K ^TMP($J) S X=^LAB(65.9,LRI,0),DIWL=$P(X,U,5),DIWR=IOM-$P(X,U,6),DIWF="W"
"RTN","LRBLJW",43,0)
 S LRA=0 F LRZ=0:1 S LRA=$O(^LAB(65.9,LRI,2,LRA)) Q:'LRA!(LR("Q"))  D:$Y>(IOSL-6) H Q:LR("Q")  S X=^LAB(65.9,LRI,2,LRA,0) D ^DIWP
"RTN","LRBLJW",44,0)
 Q:LR("Q")  D:LRZ ^DIWW Q
"RTN","LRBLJW",45,0)
END D V^LRU Q
"RTN","LRBLP")
0^26^B23154871^B23063826
"RTN","LRBLP",1,0)
LRBLP ;AVAMC/REG - BLOOD BANK PATIENT OPTS ;4/11/94  07:55 ;
"RTN","LRBLP",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLP",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLP",4,0)
B Q  D END,Z G:Y=-1 END W !!?10,"Edit transfusions entered via Previous records option" K DIC D ^LRDPA G:LRDFN=-1 END
"RTN","LRBLP",5,0)
 K ^TMP($J) S (E,B)=0 F A=0:0 S A=$O(^LR(LRDFN,1.6,A)) Q:'A  I $P(^(A,0),"^",9) S B=B+1,X=^(0),^TMP($J,B)=A_"^"_X D C Q:E["^"
"RTN","LRBLP",6,0)
 I '$D(^TMP($J)) W $C(7),!,"There are no transfusion records entered via previous records option." G B
"RTN","LRBLP",7,0)
E W !,"Select from (1-",B,"): " R X:DTIME G:X["^"!(X="") B I X<1!(X>B)!(+X'=X) W $C(7),!,"Enter a number from 1 - ",B," to edit selection." G E
"RTN","LRBLP",8,0)
 K DA S LRI=+^TMP($J,X),DIE="^LR(",DA=LRDFN,DR="[LRBLSPP]" D ^DIE G B
"RTN","LRBLP",9,0)
 ;
"RTN","LRBLP",10,0)
C S Y=+X,C=$P(X,"^",2) D D^LRU W !,$J(B,3),") ",Y,?25,$P(X,"^",3)," ",$P(X,"^",5)," ",$P(X,"^",6)," " I C,$D(^LAB(66,C,0)) W $P(^(0),"^") D:B#20=0 M Q
"RTN","LRBLP",11,0)
 ;
"RTN","LRBLP",12,0)
O Q  D END,Z G:Y=-1 END W !!?10,"Blood bank patient data from old records"
"RTN","LRBLP",13,0)
PT K DIC,DA W ! D ^LRDPA G:LRDFN=-1 END S DIE="^LR(",DA=LRDFN,DR="[LRBLPOLD]" D ^DIE
"RTN","LRBLP",14,0)
 F W=0:0 S W=$O(W(W)) Q:'W  F M=0:0 S M=$O(W(W,M)) Q:'M  I '$D(^LR(LR,W,M)) S O=M,X="deleted",Z=W(W,M)_",.01" D EN^LRUD
"RTN","LRBLP",15,0)
 K M,W,O,LR,DIE,DR,DA S:'$D(^LR(LRDFN,1.6,0)) ^(0)="^63.017DAI^^"
"RTN","LRBLP",16,0)
ASK W ! S DA(1)=LRDFN,DIC="^LR(LRDFN,1.6,",DIC(0)="AEQL",DLAYGO=63 D ^DIC K DIC,DLAYGO G:Y<1 PT I '$P(Y,U,3) W $C(7),!,"For new entries only.  No editing." G ASK
"RTN","LRBLP",17,0)
 K DA S LRI=+Y,DA=LRDFN,DIE="^LR(",DR="[LRBLPT]" D ^DIE G ASK
"RTN","LRBLP",18,0)
S W !!?10,"Blood bank patient special instructions" K DIC W ! D ^LRDPA G:LRDFN=-1 END S DIE="^LR(",DA=LRDFN,DR=".076" W ! D ^DIE G S
"RTN","LRBLP",19,0)
P Q  I $D(LRLOKVAR) D FRE^LRU
"RTN","LRBLP",20,0)
 D END,Z W !!?25,"Edit blood bank patient ABO/Rh" K DIC,DA D ^LRDPA G:LRDFN<1 END S DIE="^LR(",DA=LRDFN,X=^LR(LRDFN,0),LRABO=$P(X,U,5),LRRH=$P(X,U,6) D CK^LRU G:$D(LR("CK")) P
"RTN","LRBLP",21,0)
ABO S LRP=5,Z="63,.05",LRF=$P(^DD(63,.05,0),U,3) W !!,"ABO GROUP: ",LRABO,$S(LRABO]"":"// ",1:" ") R X:DTIME G:'$T!(X[U) P S:X="" X=LRABO S LRD=LRABO D F G:Y="" ABO
"RTN","LRBLP",22,0)
RH S LRP=6,Z="63,.06",LRF=$P(^DD(63,.06,0),U,3) W !!,"RH TYPE: ",LRRH,$S(LRRH]"":"// ",1:" ") R X:DTIME G:'$T!(X[U) P S:X="" X=LRRH S A=$S($A(X)=80:$P("POS",X,2),1:$P("NEG",X,2)),X=X_A,LRD=LRRH W A D F G:Y="" RH
"RTN","LRBLP",23,0)
 G P
"RTN","LRBLP",24,0)
 ;
"RTN","LRBLP",25,0)
TX Q  D END,Z G:Y=-1 END  W !!?8,"Enter/edit transfusion reactions that do not have specific",!?18,"units associated with the reaction",!
"RTN","LRBLP",26,0)
T K DIC W ! D ^LRDPA G:LRDFN=-1 END S:'$D(^LR(LRDFN,1.9,0)) ^(0)="^63.0171DAI^^" S DIC="^LR(LRDFN,1.9,",DIC(0)="AEQLMZ",DLAYGO=63 W ! D ^DIC K DIC,DLAYGO G:Y<1 T S LR=Y(0),LRI=+Y
"RTN","LRBLP",27,0)
 W ! S DIE="^LR(",DA=LRDFN,DR="[LRBLPTXR]" D ^DIE I '$D(^LR(LRDFN,1.9,LRI,0)) S O=$P(LR,U),X="Deleted",Z="63.0171,.01" D EN^LRUD
"RTN","LRBLP",28,0)
 G T
"RTN","LRBLP",29,0)
 ;
"RTN","LRBLP",30,0)
F I X="@",LRD="" W $C(7),"  NOTHING TO DELETE !" S Y="" Q
"RTN","LRBLP",31,0)
 I X="@" F A=1.8,1,1.7,3,1.5,1.6 I $O(^LR(LRDFN,A,0)) S LRK=1 Q
"RTN","LRBLP",32,0)
 I X="@",$D(^LRD(65,"AP",LRDFN)) W $C(7),!!,"Units assigned/crossmatched." S LRK=1
"RTN","LRBLP",33,0)
 I $D(LRK) K LRK W !!,$C(7),"Any component requests, units assigned/crossmatched, transfusion records,",!,"RBC antigens present or absent, antibodies identified or blood bank comments",!,"must be removed before deletion allowed.",! S Y="" Q
"RTN","LRBLP",34,0)
 S LRI=$O(^LR(LRDFN,"BB",0)) I X="@",LRI D A I $D(LRK) W $C(7),!!,"Blood bank data entered for this patient.  Deletion not allowed!",! S Y="" Q
"RTN","LRBLP",35,0)
 I $D(LRM) K LRM Q
"RTN","LRBLP",36,0)
 I X="@" W $C(7),!,"ARE YOU SURE YOU WANT TO DELETE " S %=2 D YN^LRU I %=1 S $P(^LR(LRDFN,0),"^",LRP)="",O=LRD,X="deleted" D EN^LRUD S Y="@" Q
"RTN","LRBLP",37,0)
 Q:X="@"!(X="")  S X=X_":",Y=$P($P(LRF,X,2),";") I Y]"",LRD'=Y S $P(^LR(LRDFN,0),"^",LRP)=Y,X=Y,O=LRD D EN^LRUD
"RTN","LRBLP",38,0)
 Q:Y]""  W !?5,"CHOOSE FROM: " F X=1:1 S Y=$P(LRF,";",X) Q:Y=""  S A=$P(Y,":",2),Y=$P(Y,":",1) W !?7,Y,?15," ",A
"RTN","LRBLP",39,0)
 S Y="" Q
"RTN","LRBLP",40,0)
A K LRK I $P(^LR(LRDFN,"BB",0),"^",4)>1 S LRK=1 Q
"RTN","LRBLP",41,0)
 Q:$D(LRK)  S X=^LR(LRDFN,"BB",LRI,0),$P(^(0),"^",3)="" W $C(7),!!,"Remove blood bank accession number ",$P(X,"^",6),!,"And then you can delete the ABO & RH entries.",! S LRM=1 Q
"RTN","LRBLP",42,0)
 ;
"RTN","LRBLP",43,0)
Z S X="BLOOD BANK" D ^LRUTL Q
"RTN","LRBLP",44,0)
M W !,"'^' TO STOP: " R E:DTIME Q:E["^"
"RTN","LRBLP",45,0)
 W $C(13),$J("",15),$C(13) Q
"RTN","LRBLP",46,0)
 ;
"RTN","LRBLP",47,0)
END D V^LRU Q
"RTN","LRBLPCS")
0^27^B18635044^B18630025
"RTN","LRBLPCS",1,0)
LRBLPCS ;AVAMC/REG - COMPONENT SELECTION FOR PATIENTS ;8/4/95  06:32 ;
"RTN","LRBLPCS",2,0)
 ;;5.2;LAB SERVICE;**1,72,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLPCS",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPCS",4,0)
 Q  D V^LRU,CK^LRBLPUS
"RTN","LRBLPCS",5,0)
 G:Y=-1 END
"RTN","LRBLPCS",6,0)
 I LRSS'="BB" W $C(7),!!,"MUST BE BLOOD BANK" G END
"RTN","LRBLPCS",7,0)
 W !?20,LRAA(4),!!?15,"Selection of blood components for a patient"
"RTN","LRBLPCS",8,0)
 S LRJ=1
"RTN","LRBLPCS",9,0)
 W !,"Display instructions for component selected "
"RTN","LRBLPCS",10,0)
 S %=2 D YN^LRU G:%<1 END S:%=1 LRO=1
"RTN","LRBLPCS",11,0)
P W ! K DIC D ^LRDPA
"RTN","LRBLPCS",12,0)
 K DIC,DIE,DR
"RTN","LRBLPCS",13,0)
 W ! G:LRDFN=-1 END D EN1 G P
"RTN","LRBLPCS",14,0)
 ;
"RTN","LRBLPCS",15,0)
EN1 Q:'$D(LRP)
"RTN","LRBLPCS",16,0)
 D ^LRBLPA Q:$D(Q("Q"))!(LRLLOC["DIED")
"RTN","LRBLPCS",17,0)
 W LRP," ",SSN(1),?42,$J(LRPABO,2),?45,LRPRH
"RTN","LRBLPCS",18,0)
 D EN^LRBLPUS
"RTN","LRBLPCS",19,0)
 S A=0 F B=1:1 S A=$O(^LRD(65,"AP",LRDFN,A)) Q:'A  D N
"RTN","LRBLPCS",20,0)
 I $D(LRQ),B=1 W !,"No units currently assigned/xmatched"
"RTN","LRBLPCS",21,0)
 W ! S A=0 F B=0:1 S A=$O(^LR(LRDFN,1.8,A)) Q:'A  S X=^(A,0) W:'B !,"Component(s) requested",?24,"Units",?30,"Request date/time",?48,"Wanted date/time",?65,"Requestor",?77,"By" D L
"RTN","LRBLPCS",22,0)
OP K LRR
"RTN","LRBLPCS",23,0)
 S LRCPT=0
"RTN","LRBLPCS",24,0)
 W !!,"Is patient Pre-op " S %="" D YN^LRU I %<1 W $C(7),!,"You must answer 'YES' or 'NO' to enter component request.",!,"Do you want to enter component request at this time " S %=1 D YN^LRU G:%=1 OP Q
"RTN","LRBLPCS",25,0)
 S LRV=$S(%=2:0,1:1),LRV(1)=$S(LRV=1:8,1:6)
"RTN","LRBLPCS",26,0)
 D:LRV ^LRBLPCSS
"RTN","LRBLPCS",27,0)
 S DIE=63,DA=LRDFN,DR="[LRBLPCS]"
"RTN","LRBLPCS",28,0)
 W ! D ^DIE K DIE,DR
"RTN","LRBLPCS",29,0)
 D:$D(LRK) EN^LRBLPCS1
"RTN","LRBLPCS",30,0)
 K LRK,S,C Q
"RTN","LRBLPCS",31,0)
 ;
"RTN","LRBLPCS",32,0)
EN3 F A=0:0 S A=$O(^LAB(66,C,LRV(1),A)) Q:'A  S X=^(A,0),E=$P(X,"^",2),F=+X,C(C,F,E)=$P(X,"^",3) I '$D(S(F,E)) D G
"RTN","LRBLPCS",33,0)
 K I(0) F A=0:0 S A=$O(C(C,A)) Q:'A  F B=0:0 S B=$O(C(C,A,B)) Q:'B  D A
"RTN","LRBLPCS",34,0)
 K:$D(I(0)) Q
"RTN","LRBLPCS",35,0)
 I $D(Q) K Q W !?5,$C(7)," Request still OK " S %=2 D YN^LRU S:%=1 LRR=1 I %'=1 S Y=0 D DEL
"RTN","LRBLPCS",36,0)
 S:$D(LRR) LRK(C)="" Q
"RTN","LRBLPCS",37,0)
G S X=$S($D(^LAB(60,F,0)):^(0),1:F)
"RTN","LRBLPCS",38,0)
 I $P(X,"^",5)'["CH" W $C(7),!,"No DATA NAME in file 60 for ",$P(X,"^") Q
"RTN","LRBLPCS",39,0)
 S G=$P(X,";",2),H=+$P(X,";",3),Z=$S($D(^LAB(60,F,1,E,0)):$P(^(0),"^",7),1:""),I(0)=$P(X,"^")
"RTN","LRBLPCS",40,0)
 F B=0:0 S B=$O(^LR(LRDFN,"CH",B)) Q:'B  S W=^(B,0),S=$P(W,"^",5) I S=E,$D(^(G)),$L(^(G)) S X=^(G) D H Q
"RTN","LRBLPCS",41,0)
 S:'$D(S(F,E)) S(F,E)="^"_I(0) Q
"RTN","LRBLPCS",42,0)
H N LRDATE S LRDATE=$$FMTE^XLFDT(+W,"5F")
"RTN","LRBLPCS",43,0)
 S LRDATE=$TR(LRDATE," ",0)
"RTN","LRBLPCS",44,0)
 S LRDATE=$TR(LRDATE,"@"," ")
"RTN","LRBLPCS",45,0)
 S S(F,E)=$P(X,"^",H)_"^"_I(0)_"^"_LRDATE_"^"_Z_"^"_$P(^LAB(61,E,0),"^")
"RTN","LRBLPCS",46,0)
 Q
"RTN","LRBLPCS",47,0)
A Q:'$D(S(A,B))
"RTN","LRBLPCS",48,0)
 I $P(S(A,B),"^")="" W !?10,"No ",$P(S(A,B),"^",2)," results " S Q=1 Q
"RTN","LRBLPCS",49,0)
 I +S(A,B),@(+$P(S(A,B),"^")_C(C,A,B)) W !?10,$P(S(A,B),"^",3)," Last ",$P(S(A,B),"^",2),": ",$P(S(A,B),"^")," ",$P(S(A,B),"^",4)," ",$P(S(A,B),"^",5) S Q=1 Q
"RTN","LRBLPCS",50,0)
 S I(0)=1 Q
"RTN","LRBLPCS",51,0)
EN2 K ^UTILITY($J)
"RTN","LRBLPCS",52,0)
 S DIWR=IOM-5,DIWL=5,DIWF="W"
"RTN","LRBLPCS",53,0)
 S A=0 F K=0:1 S A=$O(^LAB(66,C,7,A)) Q:'A  S X=^(A,0) D ^DIWP
"RTN","LRBLPCS",54,0)
 D:K ^DIWW Q
"RTN","LRBLPCS",55,0)
 ;
"RTN","LRBLPCS",56,0)
L S Y=+X
"RTN","LRBLPCS",57,0)
 I '$D(^LAB(66,Y,0)) K ^LR(LRDFN,1.8,Y) S Y=^LR(LRDFN,1.8,0),^(0)=$P(Y,"^",1,2)_"^^"_($P(Y,"^",4)-1) Q
"RTN","LRBLPCS",58,0)
 W !,$E($P(^LAB(66,+X,0),"^"),1,23),?24,$J($P(X,"^",4),3),?30 S Y=$P(X,"^",3) D M W Y,?48 S Y=$P(X,"^",5) D M W Y,?65,$P(X,"^",9) S Y=$P(X,"^",8) W ?77,$S(Y="":Y,$D(^VA(200,Y,0)):$P(^(0),"^",2),1:Y) Q
"RTN","LRBLPCS",59,0)
M Q:'Y  D DD^LRX
"RTN","LRBLPCS",60,0)
 Q
"RTN","LRBLPCS",61,0)
 ;
"RTN","LRBLPCS",62,0)
N W:B=1 !,"Unit assigned/xmatched:",?49,"Exp date",?67,"Location"
"RTN","LRBLPCS",63,0)
 I '$D(^LRD(65,A,0)) K ^LRD(65,"AP",LRDFN,A) Q
"RTN","LRBLPCS",64,0)
 S X=^LRD(65,A,0),L=$O(^(3,0)) S:'L L="Blood Bank" I L S L=$P(^(L,0),"^",4)
"RTN","LRBLPCS",65,0)
 S M=^LAB(66,$P(X,"^",4),0)
"RTN","LRBLPCS",66,0)
 W !,$J(B,2),")",?5,$P(X,"^"),?20,$E($P(M,"^"),1,21),?42,$J($P(X,"^",7),2),?45,$P(X,"^",8),?49 S Y=$P(X,"^",6) D DD^LRX S:L<0 L="Blood bank" W Y,?67,L Q
"RTN","LRBLPCS",67,0)
 ;
"RTN","LRBLPCS",68,0)
DEL I $O(^LR(LRDFN,1.8,C,1,0)) S ^LR(LRDFN,1.8,C,0)=$P(^LR(LRDFN,1.8,C,0),"^") K ^LR(LRDFN,1.8,C,2) Q
"RTN","LRBLPCS",69,0)
 K ^LR(LRDFN,1.8,C) S X=^LR(LRDFN,1.8,0),X(2)=$O(^(0)),X(1)=$P(X,"^",4),^(0)="^63.084PA^"_X(2)_"^"_$S(X(1)<2:"",1:X(1)-1) Q
"RTN","LRBLPCS",70,0)
END D V^LRU Q
"RTN","LRBLPCS",71,0)
EN K LRO S IOM=$S('$D(IOM):80,IOM:IOM,1:80)
"RTN","LRBLPCS",72,0)
 W !,"FOR TRANSFUSION REQUESTS: Display instructions for components " S %=2 D YN^LRU Q:%<1  S:%=1 LRO=1 Q
"RTN","LRBLPE")
0^28^B16485111^B16478868
"RTN","LRBLPE",1,0)
LRBLPE ;AVAMC/REG - BB DATA ENTRY BY ACC # ;8/11/97
"RTN","LRBLPE",2,0)
 ;;5.2;LAB SERVICE;**35,72,100,121,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLPE",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPE",4,0)
 Q  D EN^LRBLPE1 G:'$D(LRAA) END
"RTN","LRBLPE",5,0)
L R !!,"Select Accession Number: ",LRAN:DTIME G:LRAN=""!(LRAN[U) END I LRAN'?1N.N W $C(7),"  Enter numbers only." G L
"RTN","LRBLPE",6,0)
 S (LR(1),LR(2))="" D REST G L
"RTN","LRBLPE",7,0)
REST W "  for ",LRH(0) I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) W $C(7),!!,"Accession # ",LRAN," for ",LRH(0)," not in ACCESSION file",!! Q
"RTN","LRBLPE",8,0)
 N LRODT,LRSN S X=^LRO(68,LRAA,1,LRAD,1,LRAN,0),LRSVC=$P(X,"^",9),LRLLOC=$P(X,"^",7),LRDFN=+X,LRODT=$P(X,"^",4),LRSN=$P(X,"^",5) Q:'$D(^LR(LRDFN,0))  S X=^(0)
"RTN","LRBLPE",9,0)
 S LRABO=$P(X,"^",5),LRRH=$P(X,"^",6),DFN=$P(X,"^",3),(LRDPF,X)=$P(X,"^",2),X=^DIC(X,0,"GL"),X=@(X_DFN_",0)"),LRP=$P(X,"^"),SSN=$P(X,"^",9) D SSN^LRU
"RTN","LRBLPE",10,0)
 S S=$S($D(^LRO(68,LRAA,1,LRAD,1,LRAN,5,1,0)):+^(0),1:"") I +S S S=$S($D(^LAB(61,+S,0)):$P(^(0),"^"),1:"")
"RTN","LRBLPE",11,0)
 W !,LRP,"  ID: ",SSN," ABO: ",LRABO," Rh: ",LRRH,!,"Specimen: ",S D ^LRDPA2 W !
"RTN","LRBLPE",12,0)
 S LRI=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),"^",5)
"RTN","LRBLPE",13,0)
 F LRT=0:0 S LRT=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRT)) Q:'LRT  I $P(^LAB(60,LRT,0),"^",4)'="WK" D TEST
"RTN","LRBLPE",14,0)
 Q
"RTN","LRBLPE",15,0)
TEST S (LRW(2.1),LRW(2.4),LRW(2.6),LRW)=0 I $P(^LAB(60,LRT,0),"^",4)'=LRSS W $C(7),!!,$P(^(0),"^")," does not belong in ",LRAA(1)," accession area !",!,"Test deleted",!! D K^LRBLPE1 Q
"RTN","LRBLPE",16,0)
 I '$D(LRT(LRT)) S X=^LAB(60,LRT,0),Y=$P(X,"^",14),LRT(LRT)=$P(X,"^") I Y,$D(^LAB(62.07,Y,.1)) S X=Y,Y=^(.1),LRT(LRT)=LRT(LRT)_"^"_Y_"^"_X
"RTN","LRBLPE",17,0)
 I $P(LRT(LRT),"^",2)="" W $C(7),!!,"Cannot continue without execute code for ",$P(LRT(LRT),U) Q
"RTN","LRBLPE",18,0)
 K L W !,"Test:",$P(LRT(LRT),"^") X $P(LRT(LRT),"^",2) S DIE="^LR(",DA=LRDFN L +^LR(LRDFN,"BB"):1 I '$T W !,$C(7),"ANOTHER TERMINAL IS EDITING THIS ENTRY!" Q
"RTN","LRBLPE",19,0)
 D:DR="[LRBLPAG]" PH
"RTN","LRBLPE",20,0)
 W ! D ^DIE L -^LR(LRDFN,"BB") D OR D:'$D(Y) ^LRBLPEW D:DR="[LRBLPAG]" SET D:$D(LRMED) ^LRBLPE1
"RTN","LRBLPE",21,0)
 D
"RTN","LRBLPE",22,0)
 . N CORRECT S CORRECT=0 I $P($G(^LR(LRDFN,"BB",+LRI,0)),"^",3) S CORRECT=1
"RTN","LRBLPE",23,0)
 . D NEW^LR7OB1(LRODT,LRSN,"RE")
"RTN","LRBLPE",24,0)
 K DA,DIE,DR,LRMED Q
"RTN","LRBLPE",25,0)
 ;
"RTN","LRBLPE",26,0)
PH I '$O(^LR(LRDFN,1,0)),'$O(^LR(LRDFN,1.5,0)) Q
"RTN","LRBLPE",27,0)
 W !?40,"Antigen(s) present",?60,"| Antigen(s) absent",!,LR("%"),!,"Patient's Phenotype Record:"
"RTN","LRBLPE",28,0)
 S E=1,(F(1),G)="" F B=0:0 S B=$O(^LR(LRDFN,1,B)) Q:'B  S I=$P(^LAB(61.3,B,0),"^"),F(E)=F(E)_I_" ",G=G+1 I $L(F(E))>19 S F(E)=$P(F(E)," ",1,G-1),E=E+1,F(E)=I_" ",G=""
"RTN","LRBLPE",29,0)
 S K=E,E=1,(J(1),G)="" F B=0:0 S B=$O(^LR(LRDFN,1.5,B)) Q:'B  S I=$P(^LAB(61.3,B,0),"^"),J(E)=J(E)_I_" ",G=G+1 I $L(J(E))>18 S J(E)=$P(J(E)," ",1,G-1),E=E+1,J(E)=I_" ",G=""
"RTN","LRBLPE",30,0)
 S:E>K K=E F E=1:1:K W:E>1 ! W:$D(F(E)) ?40,$J(F(E),19) W:$D(J(E)) ?60,"|",$J(J(E),18)
"RTN","LRBLPE",31,0)
 Q
"RTN","LRBLPE",32,0)
SET S C=0 F A=0:0 S A=$O(^LR(LRDFN,"BB",LRI,1.1,A)) Q:'A  I '$D(^LR(LRDFN,1,A)) S ^(A,0)=A,C=C+1
"RTN","LRBLPE",33,0)
 I C S:'$D(^LR(LRDFN,1,0)) ^(0)="^63.13PA^^" S X=^(0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)+1)
"RTN","LRBLPE",34,0)
 S C=0 F A=0:0 S A=$O(^LR(LRDFN,"BB",LRI,1.2,A)) Q:'A  I '$D(^LR(LRDFN,1.5,A)) S ^(A,0)=A,C=C+1
"RTN","LRBLPE",35,0)
 I C S:'$D(^LR(LRDFN,1.5,0)) ^(0)="^63.016PA^^" S X=^(0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)+1)
"RTN","LRBLPE",36,0)
 S DA(2)=LRDFN,DA(1)=LRI F LRM=0:0 S LRM=$O(LRM(LRM)) Q:'LRM  F M=0:0 S M=$O(LRM(LRM,M)) Q:'M  I '$D(^LR(LRDFN,"BB",LRI,LRM,M)) S O=M,X="deleted",Z=LRM(LRM,M)_",.01" D EN^LRUD
"RTN","LRBLPE",37,0)
 K M,LRM,O Q
"RTN","LRBLPE",38,0)
END D V^LRU Q
"RTN","LRBLPE",39,0)
OR ;Call to OE/RR 2.5 status update
"RTN","LRBLPE",40,0)
 I $$VER^LR7OU1>2.5 Q
"RTN","LRBLPE",41,0)
 N LRODT,LRSN,LRTST,LRIEN
"RTN","LRBLPE",42,0)
 S LRODT=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),"^",4),LRSN=$P(^(0),"^",5),LRTST=$O(^(4,0)) Q:LRTST<1
"RTN","LRBLPE",43,0)
 I $D(^LRO(69,LRODT,1,LRSN,2)) S LRIEN=$O(^(2,"B",LRTST,0)) Q:LRIEN<1  S ORIFN=$P(^LRO(69,LRODT,1,LRSN,2,LRIEN,0),"^",7)
"RTN","LRBLPE",44,0)
 S ORETURN("ORSTS")=2 D RETURN^ORX
"RTN","LRBLPE",45,0)
 Q
"RTN","LRBLPED")
0^29^B30696766^B30672400
"RTN","LRBLPED",1,0)
LRBLPED ;AVAMC/REG/CRT - PEDIATRIC UNIT PREPARATION ;7/30/95  15:36 ; 12/18/00 2:19pm
"RTN","LRBLPED",2,0)
 ;;5.2;LAB SERVICE;**72,247,267,408**;Sep 27, 1994;Build 8
"RTN","LRBLPED",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPED",4,0)
 ;
"RTN","LRBLPED",5,0)
 ; References to ^DD(65, and ^DD(66, are supported in DBIA3261
"RTN","LRBLPED",6,0)
 ;
"RTN","LRBLPED",7,0)
 Q  D END S LR("M")=1,X="BLOOD BANK" D ^LRUTL G:Y=-1 END S %DT="T",X="N" D ^%DT S LRN=Y,LRM=$P(Y,".") W !?15,"Division: ",LRAA(4)
"RTN","LRBLPED",8,0)
 I LRCAPA S X="PEDIATRIC UNIT PREPARATION",X("NOCODES")=1 D X^LRUWK G:'$D(X) END K X
"RTN","LRBLPED",9,0)
 S LR(3)="" D BAR^LRBLB
"RTN","LRBLPED",10,0)
P W !! S X=$$READ^LRBLB("Blood component for pediatric prep: ") G:X=""!(X["^") END I X=" " W $C(7),"  SPACE BAR not allowed." G P
"RTN","LRBLPED",11,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D
"RTN","LRBLPED",12,0)
 .D P^LRBLB
"RTN","LRBLPED",13,0)
 E  W $$STRIP^LRBLB(.X)  ; Strip off the data identifiers just in case
"RTN","LRBLPED",14,0)
 I '$D(X) W $C(7),!,"Code not entered in BLOOD PRODUCT file or not product label.",! G P
"RTN","LRBLPED",15,0)
 S DIC=66,DIC(0)="EQMZ",DIC("S")="I $$SCRN^LRBLPED" D ^DIC K DIC G:X["?" P I Y<1 W $C(7),!,"Either not an entry in BLOOD COMPONENT FILE (#66) or",!,"Must enter MAX AGE FOR PEDIATRIC USE field for the entry in file 66." G P
"RTN","LRBLPED",16,0)
 S X=0,LRO=+$P(Y(0),U,22) I 'LRO!('$D(^LAB(66,LRO,0))) W $C(7),!,$P(^DD(66,.22,0),U)," must be entered for this component",!,"and pediatric product selection must be an entry in the Blood Product file." S X=1
"RTN","LRBLPED",17,0)
 I '$P(Y(0),U,23) W $C(7),!,$P(^DD(66,.23,0),U)," must be entered for this component" S X=1
"RTN","LRBLPED",18,0)
 G:X P S LRC=+Y F A=0:0 S A=$O(^LAB(66,LRO,9,A)) Q:'A  S LRT(A)=""
"RTN","LRBLPED",19,0)
 I LRCAPA,$D(LRT)'=11 W $C(7),!!,"Must have WKLD codes entered in Blood Product file for ",$P(^LAB(66,LRO,0),U) G END
"RTN","LRBLPED",20,0)
 S LRD=$P(Y(0),U,17),LRZ=$P(^LAB(66,$P(Y(0),U,22),0),U,18),LRP=$P(Y(0),U,22),LRA=-(LRD-$P(Y(0),U,21)),LRV=$P(Y(0),U,10),LRV(.4)=LRV*.4\1,LRV(.6)=LRV*.6\1,LRS=$P(Y(0),U,23),LR(66,.135)=$P(^LAB(66,LRO,0),U,17)
"RTN","LRBLPED",21,0)
 I 'LRV W $C(7),!!,"Volume of component must be entered in BLOOD COMPONENT file",!?20,"for ",$P(Y,U,2),"." G P
"RTN","LRBLPED",22,0)
U K LRF,Z S Z=0 W !! S X=$$READ^LRBLB("Select UNIT: ") G:X=""!(X[U) END I X["?"!(X[" ")!(X'?.ANP) D H G U
"RTN","LRBLPED",23,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D
"RTN","LRBLPED",24,0)
 .D ^LRBLBU
"RTN","LRBLPED",25,0)
 E  W $$STRIP^LRBLB(.X)  ; Strip off the data identifiers just in case
"RTN","LRBLPED",26,0)
 G:'$D(X) U
"RTN","LRBLPED",27,0)
 S DIC=65,DIC(0)="EQM",DIC("W")="W "" "",$P(^(0),U)",DIC("S")="I $P(^(0),U,16)=DUZ(2),$P(^(0),U,4)=LRC,$S('$D(^(4)):1,$P(^(4),U)="""":1,1:0)" D ^DIC K DIC G:Y<1 U S X=$P(^LRD(65,+Y,0),U)
"RTN","LRBLPED",28,0)
 S LRP=$$LRP(+Y)
"RTN","LRBLPED",29,0)
 I LRP=0 G U
"RTN","LRBLPED",30,0)
 S LRJ=X D ALL G P
"RTN","LRBLPED",31,0)
ALL S Q=$O(^LRD(65,"AI",LRC,LRJ,0)) I Q S A=LRJ,Q=$O(^LRD(65,"AI",LRC,A,0)) Q:'Q  W !?3 D I G:$D(LRF) ^LRBLPED1
"RTN","LRBLPED",32,0)
 K ^TMP($J) W !?3 S A(2)="",Z(1)=1,A=LRJ D D G ^LRBLPED1:$D(LRF) I A(2)?1P W $C(7) Q
"RTN","LRBLPED",33,0)
 I LRJ'["E",LRJ=+LRJ,+$O(^LRD(65,"AI",LRJ))=X S A=LRJ_"?" D D
"RTN","LRBLPED",34,0)
 G ^LRBLPED1:$D(LRF) W $C(7) Q
"RTN","LRBLPED",35,0)
 ;
"RTN","LRBLPED",36,0)
H I '$D(^LRD(65,"AI",LRC)) W $C(7),!!,"No units to choose from !",! Q
"RTN","LRBLPED",37,0)
 I X'["??" W !,"ANSWER WITH ",$P(^DD(65,.01,0),U),!,"DO YOU WANT THE ENTIRE ",$P(^LRD(65,0),U)," LIST ? " S %="" D RX^LRU Q:%'=1
"RTN","LRBLPED",38,0)
 S (A,A(2))=0,A(1)=$Y+21 W !?3 F B=0:0 S A=$O(^LRD(65,"AI",LRC,A)) Q:A=""  F Q=0:0 S Q=$O(^LRD(65,"AI",LRC,A,Q)) Q:'Q  D:$Y>A(1)!'$Y MORE Q:A(2)?1P  D I
"RTN","LRBLPED",39,0)
 Q
"RTN","LRBLPED",40,0)
I I Q[".",Q<LRN K ^LRD(65,"AI",LRC,A,Q) Q
"RTN","LRBLPED",41,0)
 I Q<LRM K ^LRD(65,"AI",LRC,A,Q) Q
"RTN","LRBLPED",42,0)
 S V=$O(^LRD(65,"AI",LRC,A,Q,0)) I $D(^LRD(65,V,4)),$P(^(4),"^")]"" K ^LRD(65,"AI",LRC,A,Q,V) Q
"RTN","LRBLPED",43,0)
 I $D(^LRD(65,V,8)),+^(8) Q
"RTN","LRBLPED",44,0)
 Q:'$D(^LRD(65,V,0))  S LRF=V_"^"_^(0) D OK Q:'$D(LRF)
"RTN","LRBLPED",45,0)
 S Z=Z+1 W:$D(Z(1)) $J(Z,2) W ?7,$P(LRF,"^",2),?20,$J($P(LRF,"^",8),2)," ",$P(LRF,"^",9) S (LRE,Y)=$P(LRF,"^",7) D DT^LRU W ?28,Y
"RTN","LRBLPED",46,0)
 W $J($S(LRB=0:"<1",1:LRB),4)," ",$S(LRB>1:"DAYS",1:"DAY ")," OLD  ",$J($P(LRF,"^",12),3) W:'$P(LRF,"^",12)&($P(LRF,"^",12)'=0) " ? " W " ml"
"RTN","LRBLPED",47,0)
 W !?3 Q
"RTN","LRBLPED",48,0)
 ;
"RTN","LRBLPED",49,0)
D K LRF F B=0:0 S A=+$O(^LRD(65,"AI",LRC,A)) Q:$E(A,1,$L(LRJ))'=LRJ  F Q=0:0 S Q=$O(^LRD(65,"AI",LRC,A,Q)) Q:'Q!($A(A)>122)  D I I $D(LRF) S ^TMP($J,Z)=LRF K LRF I Z#5=0 D C Q:A(2)?1P
"RTN","LRBLPED",50,0)
 D:Z#5&('$D(LRF)) C Q
"RTN","LRBLPED",51,0)
 ;
"RTN","LRBLPED",52,0)
OK S O=0 F O(1)=0:0 S O=$O(^LRD(65,V,2,O)) Q:'O  I $D(^LRD(65,"AP",O,V)) Q
"RTN","LRBLPED",53,0)
 I O>0 K LRF Q
"RTN","LRBLPED",54,0)
 S X1=$P(LRF,"^",7),X2=LRA D C^%DTC I X<LRM K LRF Q
"RTN","LRBLPED",55,0)
 S X1=$P(LRF,"^",7),X2=-LRD D C^%DTC S X1=LRM,X2=X D ^%DTC S LRB=X Q
"RTN","LRBLPED",56,0)
 ;
"RTN","LRBLPED",57,0)
MORE R "'^' TO STOP: ",A(2):DTIME I A(2)?1P S A=$C(126) Q
"RTN","LRBLPED",58,0)
 S A(1)=A(1)+21 S:$Y<22 A(1)=$Y+21 W $C(13),$J("",15),$C(13),?3 Q
"RTN","LRBLPED",59,0)
C I Z=1 S A(2)=1 G F
"RTN","LRBLPED",60,0)
 W $C(13),"TYPE '^' TO STOP OR",!,"CHOOSE 1-",Z R ": ",A(2):DTIME I A(2)?1P!'$T S A=$C(126) Q
"RTN","LRBLPED",61,0)
 I A(2)="" W !?3 Q
"RTN","LRBLPED",62,0)
F I A(2)>0,A(2)<(Z+1) S LRF=^TMP($J,A(2))
"RTN","LRBLPED",63,0)
 S A(2)="^",A=$C(126) Q
"RTN","LRBLPED",64,0)
END D V^LRU Q
"RTN","LRBLPED",65,0)
 ;
"RTN","LRBLPED",66,0)
SCRN() ; Screen for BLOOD PRODUCT file (#66)
"RTN","LRBLPED",67,0)
 ;
"RTN","LRBLPED",68,0)
 N X,PCODE,PEDICODE,ANS
"RTN","LRBLPED",69,0)
 ;
"RTN","LRBLPED",70,0)
 S ANS=0
"RTN","LRBLPED",71,0)
 S X=^(0) ; from ^LAB(66,X,0)
"RTN","LRBLPED",72,0)
 S PCODE=$P(X,U,5)
"RTN","LRBLPED",73,0)
 ;
"RTN","LRBLPED",74,0)
 I $P(X,U,21) S ANS=1 ; Max Age for Pediatric Product field defined
"RTN","LRBLPED",75,0)
 I $P(X,U,29) D  ; ISBT-128
"RTN","LRBLPED",76,0)
 .I '$P(X,U,22) S ANS=0 Q  ;No Pediatric Product defined
"RTN","LRBLPED",77,0)
 .I $E(PCODE,($L(PCODE)-1),$L(PCODE))'="00" S ANS=0 Q
"RTN","LRBLPED",78,0)
 .S PEDICODE=$$GET1^DIQ(66,$P(X,U,22),.05)
"RTN","LRBLPED",79,0)
 .; Pediatric Product Code must end in alpha+0
"RTN","LRBLPED",80,0)
 .I $E(PEDICODE,($L(PEDICODE)-1),$L(PEDICODE))'?1A1"0" S ANS=0
"RTN","LRBLPED",81,0)
 Q ANS
"RTN","LRBLPED",82,0)
 ;
"RTN","LRBLPED",83,0)
LRP(DA) ; Find & return Product Code to be used for next child
"RTN","LRBLPED",84,0)
 ;
"RTN","LRBLPED",85,0)
 ; INPUT:  DA = IEN of PARENT UNIT RECORD on File #65
"RTN","LRBLPED",86,0)
 ; OUTPUT: LRP = IEN of Child Product Code (file #66) if ISBT-1128
"RTN","LRBLPED",87,0)
 ;            or IEN of Parent Product Code (file #66) if Codabar
"RTN","LRBLPED",88,0)
 ;            or 0 if invalid.
"RTN","LRBLPED",89,0)
 ;
"RTN","LRBLPED",90,0)
 N LRBLAST,LRBLBP,LRBLSFX,LRP,LRBLPC
"RTN","LRBLPED",91,0)
 ;
"RTN","LRBLPED",92,0)
 S B=0
"RTN","LRBLPED",93,0)
 ;
"RTN","LRBLPED",94,0)
 Q:'$$GET1^DIQ(65,DA,".04:.29","I") $$GET1^DIQ(65,+DA,".04:.22","I") ; not ISBT-128, return the IEN of 
"RTN","LRBLPED",95,0)
 ;                                                                   ; the pediatric type for the product
"RTN","LRBLPED",96,0)
 S LRBLPC=$$GET1^DIQ(65,+DA,".04:.05") ; Parent Product Code
"RTN","LRBLPED",97,0)
 ;
"RTN","LRBLPED",98,0)
 S LRBLAST=$O(^LRD(65,+DA,16,""),-1)
"RTN","LRBLPED",99,0)
 I LRBLAST>25 S B=91
"RTN","LRBLPED",100,0)
 S LRBLSFX=$E("ABCDEFGHIJKLMNOPQRSTUVWXYZ",LRBLAST+1)_"0"
"RTN","LRBLPED",101,0)
 S LRBLBP=$E(LRBLPC,1,$L(LRBLPC)-2)_LRBLSFX
"RTN","LRBLPED",102,0)
 S LRP=$O(^LAB(66,"D",LRBLBP,0))
"RTN","LRBLPED",103,0)
 I 'LRP D  Q 0
"RTN","LRBLPED",104,0)
 .D EN^DDIOL("Pediatric Preparation cannot proceed with this unit until another","","!!")
"RTN","LRBLPED",105,0)
 .D EN^DDIOL("record is created for this product type in the BLOOD PRODUCT file.","","!")
"RTN","LRBLPED",106,0)
 Q LRP
"RTN","LRBLPED",107,0)
 ;
"RTN","LRBLPH")
0^30^B4630075^B4606867
"RTN","LRBLPH",1,0)
LRBLPH ;AVAMC/REG - PATIENT DRUG LIST ;2/18/93  09:44
"RTN","LRBLPH",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLPH",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPH",4,0)
 Q  D V^LRU S LRDPAF=1 D ^LRDPA G:LRDFN<1 END I +LRDPF'=2 W $C(7),!,"Must be entry in Patient File (2)" G LRBLPH
"RTN","LRBLPH",5,0)
 W ! S ZTRTN="QUE^LRBLPH" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLPH",6,0)
QUE U IO K ^TMP($J) D L^LRU,S^LRU
"RTN","LRBLPH",7,0)
 D H S LR("F")=1
"RTN","LRBLPH",8,0)
 F X=0:0 S X=$O(^PS(55,DFN,"P",X)) Q:'X  I $D(^(X,0)) S Y=+^(0) I $D(^PSRX(Y,0)) S ^TMP($J,+$P(^(0),"^",6))=0
"RTN","LRBLPH",9,0)
 F LRX=0:0 S LRX=$O(^TMP($J,LRX)) Q:'LRX  I $D(^PSDRUG(LRX,0)) D:$Y>(IOSL-6) H Q:LR("Q")  W !,"OUTPATIENT PHARMACY ITEM: ",$P(^PSDRUG(LRX,0),"^")
"RTN","LRBLPH",10,0)
 G:LR("Q") OUT K ^TMP($J) F X=0:0 S X=$O(^PS(55,DFN,"IV",X)) Q:'X  F Y=0:0 S Y=$O(^PS(55,DFN,"IV",X,"AD",Y)) Q:'Y  S ^TMP($J,+^(Y,0))=""
"RTN","LRBLPH",11,0)
 F LRX=0:0 S LRX=$O(^TMP($J,LRX)) Q:'LRX  I $D(^PS(52.6,LRX,0)) D:$Y>(IOSL-6) H Q:LR("Q")  W !,"IV DRUG: ",$P(^PS(52.6,LRX,0),"^")
"RTN","LRBLPH",12,0)
 G:LR("Q") OUT K ^TMP($J) F X=0:0 S X=$O(^PS(55,DFN,5,X)) Q:'X  F Y=0:0 S Y=$O(^PS(55,DFN,5,X,1,Y)) Q:'Y  S ^TMP($J,+^(Y,0))=""
"RTN","LRBLPH",13,0)
 F LRX=0:0 S LRX=$O(^TMP($J,LRX)) Q:'LRX  I $D(^PSDRUG(LRX,0)) D:$Y>(IOSL-6) H Q:LR("Q")  W !,"INPATIENT  PHARMACY ITEM: ",$P(^PSDRUG(LRX,0),"^")
"RTN","LRBLPH",14,0)
OUT D END^LRUTL,END Q
"RTN","LRBLPH",15,0)
 ;
"RTN","LRBLPH",16,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLPH",17,0)
 D F^LRU W !,"Medication List for ",PNM," ",SSN,!,LR("%") Q
"RTN","LRBLPH",18,0)
 ;
"RTN","LRBLPH",19,0)
END D V^LRU Q
"RTN","LRBLPQA")
0^31^B11222268^B11183171
"RTN","LRBLPQA",1,0)
LRBLPQA ;AVAMC/REG - TRANSFUSION REQUEST DATA ;2/18/93  09:45 ;
"RTN","LRBLPQA",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLPQA",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPQA",4,0)
 W !!?20 D END,I,Z G:Y=-1 END
"RTN","LRBLPQA",5,0)
A R !!?3,"(A)ll components or (S)ingle component: ",X:DTIME Q:X["^"!(X="")  I $A(X)'=65,$A(X)'=83 W $C(7),!,"Enter 'A' for all blood components or 'S' for a single component" G A
"RTN","LRBLPQA",6,0)
 G:$A(X)=65 D
"RTN","LRBLPQA",7,0)
B S DIC=66,DIC(0)="AEQM",DIC("S")="I $P(^(0),U,4)=""BB""" D ^DIC K DIC G:Y<1 END S LRC=+Y,LRC(1)=$P(Y,"^",2) I '$D(^LRO(69.2,LRAA,8,66,1,LRC)) W $C(7),!,"There are no entries to print",!! G B
"RTN","LRBLPQA",8,0)
D D B^LRU G:Y<0 END S LRLDT=LRLDT+.99,LRSDT=LRSDT-.0001
"RTN","LRBLPQA",9,0)
 S ZTRTN="QUE^LRBLPQA" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRBLPQA",10,0)
QUE U IO D L^LRU,S^LRU,H S LR("F")=1 I $D(LRC) D W G OUT
"RTN","LRBLPQA",11,0)
 S LRC(1)=0 F LRA=0:0 S LRC(1)=$O(^LRO(69.2,LRAA,8,66,1,"B",LRC(1))) Q:LRC(1)=""!(LR("Q"))  F LRC=0:0 S LRC=$O(^LRO(69.2,LRAA,8,66,1,"B",LRC(1),LRC)) Q:'LRC!(LR("Q"))  D W
"RTN","LRBLPQA",12,0)
OUT W:IOST'?1"C".E @IOF D END,END^LRUTL Q
"RTN","LRBLPQA",13,0)
W D:$Y>(IOSL-10) H Q:LR("Q")  W !!?20,LRC(1)
"RTN","LRBLPQA",14,0)
 F LRD=0:0 S LRD=$O(^LRO(69.2,LRAA,8,66,1,LRC,1,LRD)) Q:'LRD!(LR("Q"))  S LRB=^(LRD,0) I +LRB<LRLDT&(+LRB>LRSDT) S $P(^(0),"^",4)=1,SSN=$P(LRB,"^",3) D:$Y>(IOSL-10) H1 Q:LR("Q")  S Y=+LRB D D^LRU D W1
"RTN","LRBLPQA",15,0)
 Q
"RTN","LRBLPQA",16,0)
W1 W !!,Y," ",$P(LRB,"^",2),"  SSN:",SSN
"RTN","LRBLPQA",17,0)
 F A=0:0 S A=$O(^LRO(69.2,LRAA,8,66,1,LRC,1,LRD,1,A)) Q:'A!(LR("Q"))  S LR=^(A,0) D:$Y>(IOSL-10) H2 Q:LR("Q")  W !,LR
"RTN","LRBLPQA",18,0)
 Q
"RTN","LRBLPQA",19,0)
EN ;
"RTN","LRBLPQA",20,0)
 Q  D Z G:Y=-1 END W !!,"This option deletes inappropriate transfusion requests",!,"that have been previously printed.  OK " S %=2 D YN^LRU G:%'=1 END
"RTN","LRBLPQA",21,0)
 W ! F A=0:0 S A=$O(^LRO(69.2,LRAA,8,66,1,A)) Q:'A  S C=0 D K
"RTN","LRBLPQA",22,0)
 W !,"DONE",! G END
"RTN","LRBLPQA",23,0)
K F B=0:0 S B=$O(^LRO(69.2,LRAA,8,66,1,A,1,B)) Q:'B  I $P(^(B,0),"^",4) K ^LRO(69.2,LRAA,8,66,1,A,1,B) S C=C+1 W "."
"RTN","LRBLPQA",24,0)
 Q:'C
"RTN","LRBLPQA",25,0)
 S X=^LRO(69.2,LRAA,8,66,1,A,1,0),Y=$P(X,"^",4)-C
"RTN","LRBLPQA",26,0)
 I Y<1 S V=^LRO(69.2,LRAA,8,66,1,A,0) K ^LRO(69.2,LRAA,8,66,1,A),^LRO(69.2,LRAA,8,66,1,"B",V,A) S Y=$O(^LRO(69.2,LRAA,8,66,1,0)) S:'Y Y=0 S X=^LRO(69.2,LRAA,8,66,1,0),^(0)=$P(X,"^",1,2)_"^"_Y_"^"_($P(X,"^",4)-1) Q
"RTN","LRBLPQA",27,0)
 S X(1)=$O(^LRO(69.2,LRAA,8,66,1,A,1,0)) S:'X(1) X(1)=0 S ^LRO(69.2,LRAA,8,66,1,A,1,0)=$P(X,"^",1,2)_"^"_X(1)_"^"_Y Q
"RTN","LRBLPQA",28,0)
 ;
"RTN","LRBLPQA",29,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRBLPQA",30,0)
 D F^LRU W !,"BLOOD BANK",!?20 D I W !,LR("%") Q
"RTN","LRBLPQA",31,0)
H1 D H Q:LR("Q")  W !!?20,LRC(1) Q
"RTN","LRBLPQA",32,0)
H2 D H1 Q:LR("Q")  W ! S Y=+LRB D D^LRU W Y," ",$P(LRB,"^",2)," ",SSN Q
"RTN","LRBLPQA",33,0)
I W "Inappropriate transfusion requests report" Q
"RTN","LRBLPQA",34,0)
Z S X="BLOOD BANK" D ^LRUTL Q
"RTN","LRBLPQA",35,0)
END D V^LRU Q
"RTN","LRBLPT")
0^32^B11913257^B11904359
"RTN","LRBLPT",1,0)
LRBLPT ;AVAMC/REG - TRANSFUSION RESULTS ;9/7/95  08:59 ;
"RTN","LRBLPT",2,0)
 ;;5.2;LAB SERVICE;**72,247,408**;Sep 27, 1994;Build 8
"RTN","LRBLPT",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPT",4,0)
 Q  D END S X="BLOOD BANK" D ^LRUTL G:Y=-1 END
"RTN","LRBLPT",5,0)
 W !!?28,"Enter transfusion results"
"RTN","LRBLPT",6,0)
ASK W ! K ^TMP($J),LRZ,LRA,DIC,DIE,DR D ^LRDPA G:LRDFN=-1 END D R G ASK
"RTN","LRBLPT",7,0)
 ;
"RTN","LRBLPT",8,0)
R I '$D(^LRD(65,"AP",LRDFN)) W $C(7),!!,"No units currently assigned/xmatched.",! Q
"RTN","LRBLPT",9,0)
 W ! S DIC("B")=LRMD,DIC="^VA(200,",DIC(0)="AEQ",D="AK.PROVIDER",DIC("A")="Select PROVIDER: " D IX^DIC Q:Y<1  S X=+Y,LRMD=$P(Y,U,2),LRMD(1)=+Y K DIC
"RTN","LRBLPT",10,0)
T W !!,"Select TREATING SPECIALTY: ",LRS,$S(LRS]"":"// ",1:"") R X:DTIME Q:X[U!'$T  I X="",LRS="" Q
"RTN","LRBLPT",11,0)
 S:X="" X=LRS I X["?" S DIC=45.7,DIC(0)="EM" D ^DIC K DIC W !,"You may select a specialty not in the treating specialty file." G T
"RTN","LRBLPT",12,0)
 X $P(^DD(65,6.3,0),"^",5,99) I '$D(X) W $C(7),! W:$D(^(3)) ^(3) X:$D(^(4)) ^(4) G T
"RTN","LRBLPT",13,0)
 S DIC="^DIC(45.7,",DIC(0)="EM" D ^DIC K DIC
"RTN","LRBLPT",14,0)
 I Y<1 W $C(7),!,"Not an entry in the TREATING SPECIALTY file.",!,"Still want to accept it " S %=2 D YN^LRU I %'=1 S LRS="" G T
"RTN","LRBLPT",15,0)
 S LRS=$S(Y>0:$P(Y,"^",2),1:X),LRS(1)=$S(Y>0:+Y,1:"")
"RTN","LRBLPT",16,0)
 W ! S (LRA,LRZ)=0,LRG=1 F LRB=1:1 S LRA=$O(^LRD(65,"AP",LRDFN,LRA)) Q:'LRA  D:LRB#20=0 M D N
"RTN","LRBLPT",17,0)
 K LRG I LRZ=1 S LRV=1 G ^LRBLPT1
"RTN","LRBLPT",18,0)
SEL W !!,"Select units (1-",LRZ,") to enter TRANSFUSION results: " R X:DTIME Q:X=""!(X[U)  I X["?" W !,"Enter numbers from 1 to ",LRZ,!,"For 2 or more selections separate each with a ',' (ex. 1,3,4)",!,"Enter 'ALL' for all units." G SEL
"RTN","LRBLPT",19,0)
 G:X="ALL" ALL
"RTN","LRBLPT",20,0)
 I X?.E1CA.E!($L(X)>200) W $C(7),!,"No CONTROL CHARACTERS, LETTERS or more than 200 characters allowed." G SEL
"RTN","LRBLPT",21,0)
 I '+X W $C(7),!,"START with a NUMBER !!",! G SEL
"RTN","LRBLPT",22,0)
 S LRQ=X F LRB=0:0 S LRV=+LRQ,LRQ=$E(LRQ,$L(LRV)+2,$L(LRQ)) D:$D(^TMP($J,LRV)) ^LRBLPT1 Q:'$L(LRQ)
"RTN","LRBLPT",23,0)
 Q
"RTN","LRBLPT",24,0)
 ;
"RTN","LRBLPT",25,0)
N W:LRB=1 !?6,"Unit assigned/xmatched:",?48,"Exp date",?64,"Loc"
"RTN","LRBLPT",26,0)
 I '$D(^LRD(65,LRA,0)) K ^LRD(65,"AP",LRDFN,LRA) Q
"RTN","LRBLPT",27,0)
 Q:$P(^LRD(65,LRA,0),"^",16)'=DUZ(2)  I '$P(^LRD(65,LRA,2,LRDFN,0),"^",3) S X=$O(^LRD(65,LRA,2,LRDFN,1,0)) S:X X=+^(X,0) S:X $P(^LRD(65,LRA,2,LRDFN,0),"^",3)=X
"RTN","LRBLPT",28,0)
 S X=^LRD(65,LRA,0),F=$O(^(3,0)) S:F F=$P(^(F,0),"^",4) S:F="" F="Blood Bank"
"RTN","LRBLPT",29,0)
 S M=$P(^LAB(66,$P(X,"^",4),0),"^"),LRZ=LRZ+1,^TMP($J,LRZ)=LRA_"^"_$P(X,"^",4)_"^"_$P(X,"^")_"^"_$P(X,"^",7)_"^"_$P(X,"^",8)_"^"_$P(^LRD(65,LRA,2,LRDFN,0),"^",3)_"^"_F W ! W:$D(LRG) $J(LRZ,2),") "
"RTN","LRBLPT",30,0)
 W $P(X,"^"),?17,$E(M,1,22),?40,$J($P(X,"^",7),2),?43,$P(X,"^",8),?48 S Y=$P(X,"^",6) D DT^LRU W Y,?64,F Q
"RTN","LRBLPT",31,0)
 ;
"RTN","LRBLPT",32,0)
ALL F LRV=0:0 S LRV=$O(^TMP($J,LRV)) Q:'LRV  D ^LRBLPT1
"RTN","LRBLPT",33,0)
 Q
"RTN","LRBLPT",34,0)
M R !,"Press RETURN",X:DTIME W $C(13),$J("",15),$C(13) Q
"RTN","LRBLPT",35,0)
END D V^LRU Q
"RTN","LRBLPUS")
0^33^B22233347^B22228922
"RTN","LRBLPUS",1,0)
LRBLPUS ;AVAMC/REG/CYM - PATIENT UNIT SELECTION ;08/15/01 1:15 pm
"RTN","LRBLPUS",2,0)
 ;;5.2;LAB SERVICE;**72,247,267,275,408**;Sep 27, 1994;Build 8
"RTN","LRBLPUS",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPUS",4,0)
 Q  D END,CK G:Y=-1 END
"RTN","LRBLPUS",5,0)
 S LRB=$O(^LAB(61.3,"C",50710,0))
"RTN","LRBLPUS",6,0)
 I 'LRB D EN1^LRBLU
"RTN","LRBLPUS",7,0)
 W !!,?24,"Selection of units for a patient",!!?28,LRAA(4),!?12,"Accession Area: ",LRO(68)
"RTN","LRBLPUS",8,0)
 S LR(3)="",LRU(2)=1 D BAR^LRBLB
"RTN","LRBLPUS",9,0)
 W !!?15,"Select only unassigned/uncrossmatched units "
"RTN","LRBLPUS",10,0)
 S %=1 D YN^LRU G:%<1 END S:%=1 LRK=1
"RTN","LRBLPUS",11,0)
P W ! K S,V,DIC
"RTN","LRBLPUS",12,0)
 D ^LRDPA K DIC,DIE,DR
"RTN","LRBLPUS",13,0)
 W ! G:LRDFN=-1 END
"RTN","LRBLPUS",14,0)
 D ^LRBLPA K Z
"RTN","LRBLPUS",15,0)
 G:$D(Q("Q"))!(LRDFN=-1) P D REST G P
"RTN","LRBLPUS",16,0)
REST Q:LRLLOC["DIED"
"RTN","LRBLPUS",17,0)
 W !,LRP," ",SSN(1),?37,$J(LRPABO,2),?40,LRPRH D EN
"RTN","LRBLPUS",18,0)
 I '$O(^LR(LRDFN,1.8,0)) W $C(7),!!,"Must have blood component request(s) on record to select units",! Q
"RTN","LRBLPUS",19,0)
 S A=0 F B=1:1 S A=$O(^LRD(65,"AP",LRDFN,A)) Q:'A  D N
"RTN","LRBLPUS",20,0)
 W ! S A=0 F B=0:1 S A=$O(^LR(LRDFN,1.8,A)) Q:'A  S X=^(A,0) W:'B !,"Component(s) requested",?24,"Units",?30,"Request date/time",?48,"Wanted date/time",?65,"Requestor",?77,"By" D L
"RTN","LRBLPUS",21,0)
C K X W !! S X=$$READ^LRBLB("Blood component for unit selection: ") Q:X=""!(X[U)
"RTN","LRBLPUS",22,0)
 I LR,$E(X,1,$L(LR(2)))=LR(2) D
"RTN","LRBLPUS",23,0)
 .D P^LRBLB
"RTN","LRBLPUS",24,0)
 E  W $$STRIP^LRBLB(.X)  ; Strip off the data identifiers just in case
"RTN","LRBLPUS",25,0)
 I '$D(X) W $C(7),!,"Code not entered in BLOOD PRODUCT file or not product label.",!
"RTN","LRBLPUS",26,0)
 S DIC="^LR(LRDFN,1.8,",DIC(0)="EQMZ" D ^DIC K DIC,G
"RTN","LRBLPUS",27,0)
 G:Y<1 C D G G C
"RTN","LRBLPUS",28,0)
G S C=+Y,X=^LAB(66,C,0),LRV=$P(X,"^",10),C(19)=$P(X,"^",19),C(9)=$P(X,"^",9),C(7)=$P(X,"^",7),C(8)=$P(X,"^",8),C(1)=$P(Y,"^",2)
"RTN","LRBLPUS",29,0)
 ;
"RTN","LRBLPUS",30,0)
 ; LR*5.2*275 - Specific Requirement 1 from SRS
"RTN","LRBLPUS",31,0)
 ; BNT - Added K LRJ
"RTN","LRBLPUS",32,0)
 I C(9)=1 K LRJ D ^LRBLPCS1 Q:'$D(Z)
"RTN","LRBLPUS",33,0)
 ;
"RTN","LRBLPUS",34,0)
 S B=0 I $D(Z) S A=0 F B=0:1 S A=$O(Z(A)) Q:'A  S Y=+Z(A) D DD^LRX W !,A,") ",Y," Acc # ",$P(Z(A),"^",3)
"RTN","LRBLPUS",35,0)
 I B=1 S G=Z(1) G R
"RTN","LRBLPUS",36,0)
S I B W !,"Select patient blood sample (1-",B,"): " R X:DTIME Q:X=""!(X[U)  I X<1!(X>B)!(+X'=X) W !,"Select a number from 1 to ",B,! G S
"RTN","LRBLPUS",37,0)
 S:B G=Z(X)
"RTN","LRBLPUS",38,0)
R I $D(G) S G(1)=$P(+G,".",1),G(3)=$P(G,"^",3) S:G(3)'=+G(3) G(3)=$P(G(3)," ",3),G(6)=""
"RTN","LRBLPUS",39,0)
 I $D(G),C(9)=1 S G(4)=$P(G,U,2),G(5)=$P(G,U,3) D
"RTN","LRBLPUS",40,0)
 . S LRSPABO=$P($G(^LR(LRDFN,"BB",G(4),10)),U)
"RTN","LRBLPUS",41,0)
 . S LRSPRH=$P($G(^LR(LRDFN,"BB",G(4),11)),U)
"RTN","LRBLPUS",42,0)
 . Q:LRSPABO=""  Q:LRSPRH=""
"RTN","LRBLPUS",43,0)
 . I LRSPABO'=LRPABO!(LRSPRH'=LRPRH) W $C(7),!!,"Results on "_G(5)_" do not match the Patient's previous ABO/Rh history",!!,"Resolve the discrepancy before proceeding ",! S G(6)=1 K LRSPABO,LRSPRH
"RTN","LRBLPUS",44,0)
 I $D(G),G(6)=1 Q
"RTN","LRBLPUS",45,0)
 G ^LRBLPUS1
"RTN","LRBLPUS",46,0)
 ;
"RTN","LRBLPUS",47,0)
N W:B=1 !?6,"Unit assigned/xmatched:",?46,"Exp date",?67,"Location"
"RTN","LRBLPUS",48,0)
 I '$D(^LRD(65,A,0)) K ^LRD(65,"AP",LRDFN,A) Q
"RTN","LRBLPUS",49,0)
 S X=^LRD(65,A,0),L=$O(^(3,0)) S:'L L="Blood Bank" I L S L=$P(^(L,0),"^",4)
"RTN","LRBLPUS",50,0)
 S M=^LAB(66,$P(X,"^",4),0)
"RTN","LRBLPUS",51,0)
 W !,$J(B,2),")",?6,$P(X,"^"),?17,$E($P(M,"^"),1,19),?38,$P(X,"^",7)_" "_$P(X,"^",8),?44
"RTN","LRBLPUS",52,0)
 S Y=$P(X,"^",6) D DD^LRX S:L<0 L="Blood bank" W Y,?64,L Q
"RTN","LRBLPUS",53,0)
 ;
"RTN","LRBLPUS",54,0)
L W !,$E($P(^LAB(66,+X,0),"^"),1,23),?24,$J($P(X,"^",4),3),?30 S Y=$P(X,"^",3) D M W Y,?48 S Y=$P(X,"^",5) D M W Y,?65,$P(X,"^",9),?77,$S($P(X,"^",8)="":"",$D(^VA(200,$P(X,"^",8),0)):$P(^(0),"^",2),1:$P(X,"^",8)) Q
"RTN","LRBLPUS",55,0)
M D DD^LRX
"RTN","LRBLPUS",56,0)
 Q
"RTN","LRBLPUS",57,0)
EN ; from LRBLJL
"RTN","LRBLPUS",58,0)
 S M=0 F A=0:0 S A=$O(^LRD(65,"AU",LRDFN,A)) Q:'A  I $S('$D(^LRD(65,A,4)):1,$P(^(4),"^")="":1,1:0),$D(^(8)) S C=^(8),M=M+1 W:M=1 !,$C(7),"Units restricted for ",LRP S X=^(0) W !,$P(X,"^"),?15,$P(^LAB(66,$P(X,"^",4),0),"^")
"RTN","LRBLPUS",59,0)
 Q
"RTN","LRBLPUS",60,0)
CK ;called by LRBLPX,LRBLJLA,LRBLAA,LRBLJL,LRBLPCS
"RTN","LRBLPUS",61,0)
 S LR("M")=1,X="BLOOD BANK" D ^LRUTL Q:Y=-1
"RTN","LRBLPUS",62,0)
 I LRSS'="BB" W $C(7),!!,"MUST BE BLOOD BANK" S Y=-1 Q
"RTN","LRBLPUS",63,0)
 S LRI=$O(^LAB(60,"B","TRANSFUSION REQUEST",0)) I 'LRI W $C(7),!,"TRANSFUSION REQUEST must be entered in LAB TEST file (#60).",! S Y=-1 Q
"RTN","LRBLPUS",64,0)
 S LRAA=+$P($G(^LAB(60,LRI,8,+DUZ(2),0)),U,2) I 'LRAA W !!,$C(7),!!,"TRANSFUSION REQUEST in LAB TEST file (#60) must have an accession area",!,"assigned to your DIVISION.",! S Y=-1 Q
"RTN","LRBLPUS",65,0)
 S X=$G(^LRO(68,LRAA,0)),LRO(68)=$P(X,U),LRABV=$P(X,U,11)
"RTN","LRBLPUS",66,0)
 I X="" W $C(7),!!,"There is no accession area for ",LRAA,!,"in the accession area file (#68)." S Y=-1 Q
"RTN","LRBLPUS",67,0)
 I LRABV="" W !!,$C(7),"There is no abbreviation entered for ",LRO(68),!,"in the accession area file (#68)." S Y=-1
"RTN","LRBLPUS",68,0)
 Q
"RTN","LRBLPUS",69,0)
 ;
"RTN","LRBLPUS",70,0)
END D V^LRU Q
"RTN","LRBLPX")
0^34^B24148620^B24141645
"RTN","LRBLPX",1,0)
LRBLPX ;AVAMC/REG/CYM - XMATCH RESULTS ;08/20/2001 3:45 PM
"RTN","LRBLPX",2,0)
 ;;5.2;LAB SERVICE;**72,77,247,275,408**;Sep 27, 1994;Build 8
"RTN","LRBLPX",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLPX",4,0)
 Q  D V^LRU,CK^LRBLPUS G:Y=-1 END
"RTN","LRBLPX",5,0)
 S LRB=$O(^LAB(61.3,"C",50710,0)) I 'LRB D EN1^LRBLU
"RTN","LRBLPX",6,0)
 W !!?28,"Enter crossmatch results",!!?28,LRAA(4) K LRDPAF S LRW=$P(^VA(200,DUZ,0),"^",2)
"RTN","LRBLPX",7,0)
 I LRCAPA D CK^LRBLPX1 I '$D(LRT) D END Q
"RTN","LRBLPX",8,0)
ASK W ! K ^TMP($J),LRZ,LRV,DIC D ^LRDPA K DIC,DIE,DR G:LRDFN=-1 END D R G ASK
"RTN","LRBLPX",9,0)
 ;
"RTN","LRBLPX",10,0)
R S X=^LR(LRDFN,0),LRDPF=$P(X,U,2),LRPABO=$P(X,"^",5),LRPRH=$P(X,"^",6),LRP=PNM W !,LRP," ",SSN(1),?37,$J(LRPABO,2),?40,LRPRH D AB
"RTN","LRBLPX",11,0)
 S LRV=0 F E=0:0 S E=$O(^LR(LRDFN,1.8,E)) Q:'E  F B=0:0 S B=$O(^LR(LRDFN,1.8,E,1,B)) Q:'B  S X=^(B,0) D S
"RTN","LRBLPX",12,0)
 I 'LRV W $C(7),!,"No units currently selected for XMATCH",! Q
"RTN","LRBLPX",13,0)
 I LRV=1 G E
"RTN","LRBLPX",14,0)
SEL W !!,"Select units (1-",LRV,") to enter XMATCH results: " R X:DTIME Q:X=""!(X[U)  I X["?" W !,"Enter numbers from 1-",LRV,!,"For 2 or more selections separate each with a ',' (ex. 1,3,4 )",!,"Enter 'ALL' for all units." G SEL
"RTN","LRBLPX",15,0)
 G:X="ALL" ALL
"RTN","LRBLPX",16,0)
 I X?.E1CA.E!($L(X)>200) W $C(7),!,"No CONTROL CHARACTERS, LETTERS or more than 200 characters allowed." G SEL
"RTN","LRBLPX",17,0)
 I '+X W $C(7),!,"START with a NUMBER !!",! G SEL
"RTN","LRBLPX",18,0)
 S LRQ=X F LRA=0:0 S LRV=+LRQ,LRQ=$E(LRQ,$L(LRV)+2,$L(LRQ)) D:$D(^TMP($J,LRV)) E Q:'$L(LRQ)
"RTN","LRBLPX",19,0)
 Q
"RTN","LRBLPX",20,0)
S S X(1)=+$P(X,"^",2) I '$D(^LR(LRDFN,LRSS,X(1),0)) K ^LR(LRDFN,1.8,E,1,B) S X=^LR(LRDFN,1.8,E,1,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_($P(X,"^",4)-1) Q
"RTN","LRBLPX",21,0)
 S LRV=LRV+1,(LRJ,^TMP($J,LRV))=^LR(LRDFN,1.8,E,1,B,0)_"^"_E D:LRV#20=0 M D ^LRBLPX1
"RTN","LRBLPX",22,0)
 Q
"RTN","LRBLPX",23,0)
E W !! S LRJ=^TMP($J,LRV),LRR="",(LRI,DA(2))=+LRJ,DA=$P(LRJ,"^",2),LRC=$P(LRJ,"^",3),DIE="^LRD(65,LRI,2,LRDFN,1,",DA(1)=LRDFN
"RTN","LRBLPX",24,0)
 ;
"RTN","LRBLPX",25,0)
 ; LR*5.2*275 - Specific Requirement 6 from SRS
"RTN","LRBLPX",26,0)
 ; BNT - Modified DR string below to only set the .05, .09, and 3 fields
"RTN","LRBLPX",27,0)
 ;       if data is entered in the .04 field.
"RTN","LRBLPX",28,0)
 ;       Also moved it down two lines just prior to the DIE call.
"RTN","LRBLPX",29,0)
 K F D EN^LRBLPX1 Q:$D(F(2))  I $D(F(1)) W !!?4,"Sorry, must have ABO/Rh results to enter XMATCH results" Q
"RTN","LRBLPX",30,0)
 I $D(F(6)) W !!?4,"Antibody screen results not entered.  OK to continue " S %=2 D YN^LRU Q:%'=1
"RTN","LRBLPX",31,0)
 S DR=".04;S LRR=X;S:LRR="""" Y=0;.05////^S X=DUZ;.09///NOW;D:LRR=""IG"" IG^LRBLPX;3"
"RTN","LRBLPX",32,0)
 D ^DIE I $D(^LRD(65,LRI,2,LRDFN,1,+DA,0))#2 S LRAD=^(0) S:$P(LRAD,"^",10)]"" $P(^(0),"^",10)=""
"RTN","LRBLPX",33,0)
 K DIE,DR,DA I $G(Y)>0!(LRR="") S DIE="^LRD(65,LRI,2,",DA=LRDFN,DA(1)=LRI,DR=".02///@" D ^DIE K DIE Q
"RTN","LRBLPX",34,0)
 I LRR'="C",LRR'="IG",'$P(^LRD(65,LRI,2,LRDFN,0),"^",2) G K
"RTN","LRBLPX",35,0)
 S DIE="^LRD(65,LRI,2,",DA=LRDFN,DA(1)=LRI,DR=$S(LRR="C"!(LRR="IG"):".02//^S X=""NOW""",1:".02///@") D ^DIE Q:$D(Y)  S LRK=$P(^LRD(65,LRI,2,LRDFN,0),"^",2) I 'LRK S X="N",%DT="T" D ^%DT S LRK=Y
"RTN","LRBLPX",36,0)
 S LRAN=$P($P(LRAD,"^",6)," ",3),LRAD=$P($P(LRAD,"^"),".") I LRCAPA,LRAN,LRAD S X=$P(^LRO(68,LRAA,0),"^",3),LRAD=$S(X="D":LRAD,X="Y":$E(LRAD,1,3)_"0000",X="M":$E(LRAD,1,5)_"00",1:LRAD) D STF^LRBLPX1
"RTN","LRBLPX",37,0)
K L +^LR(LRDFN,1.8):5 I '$T W $C(7),!!,"I can't finish this. Someone else is editing this record" Q
"RTN","LRBLPX",38,0)
 K ^LR(LRDFN,1.8,LRC,1,LRI) S X=^LR(LRDFN,1.8,LRC,1,0),X(1)=$O(^(0)),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)="":"",1:($P(X,"^",4)-1)) L -^LR(LRDFN,1.8)
"RTN","LRBLPX",39,0)
 I $D(^LRD(65,"AP",LRDFN,LRI)) D LBL
"RTN","LRBLPX",40,0)
 Q
"RTN","LRBLPX",41,0)
 ;
"RTN","LRBLPX",42,0)
LBL S X=^LRD(65,LRI,0),Y(7)=$P(X,"^",7),Y(8)=$P(X,"^",8),Y=$P(^(2,LRDFN,0),"^",2) D DT^LRU
"RTN","LRBLPX",43,0)
 S Y(1)=$P(X,"^")_"^"_LRP_" "_SSN_"^"_"Patient "_LRPABO_" "_LRPRH_" "_Y_"^"_"Unit    "_Y(7)_" "_Y(8)_" # "_$P(X,"^")
"RTN","LRBLPX",44,0)
 S X=^LRD(65,LRI,2,LRDFN,1,$P(LRJ,"^",2),0),Y(5)=$P(X,"^",5),Y(5)=$S(Y(5)="":"",$D(^VA(200,Y(5),0)):$P(^(0),"^",2),1:Y(5)),X=$P(X,"^",4),X=$$EXTERNAL^DILFD(65.02,.04,"",X),Y(1)=Y(1)_"   "_Y(5)_"^"_X
"RTN","LRBLPX",45,0)
EN ;from LRBLPUS2
"RTN","LRBLPX",46,0)
 S:'$D(^LRO(69.2,LRAA,9,0)) ^(0)="^69.25A^^" L +^LRO(69.2,LRAA,9):5 I '$T W $C(7),!!,"I won't be able to make this CAUTION TAG now.  Someone else is using that function",! Q
"RTN","LRBLPX",47,0)
 S K=^LRO(69.2,LRAA,9,0),K(3)=$P(K,"^",3) F X=0:0 S K(3)=K(3)+1 Q:'$D(^LRO(69.2,LRAA,9,K(3)))
"RTN","LRBLPX",48,0)
 S ^LRO(69.2,LRAA,9,0)=$P(K,"^",1,2)_"^"_K(3)_"^"_($P(K,"^",4)+1)
"RTN","LRBLPX",49,0)
 S ^LRO(69.2,LRAA,9,K(3),0)=Y(1) L -^LRO(69.2,LRAA,9) Q
"RTN","LRBLPX",50,0)
 ;
"RTN","LRBLPX",51,0)
IG I '$D(^XUSEC("LRBLSUPER",DUZ)) W $C(7),!,"SORRY YOU DO NOT HAVE THE APPROPRIATE SECURITY",!,"TO ALLOW THIS UNIT TO BE ASSIGNED",! S LRR="" Q
"RTN","LRBLPX",52,0)
 R !!,"ENTER YOUR INITIALS TO ALLOW ASSIGNING UNIT: ",X(1):DTIME I X(1)'=LRW W $C(7),!,"NOT YOUR INITIALS !",! S LRR="" Q
"RTN","LRBLPX",53,0)
 Q
"RTN","LRBLPX",54,0)
ALL F LRV=0:0 S LRV=$O(^TMP($J,LRV)) Q:'LRV  D E
"RTN","LRBLPX",55,0)
 Q
"RTN","LRBLPX",56,0)
M R !,"Press RETURN",X:DTIME W $C(13),$J("",15),$C(13) Q
"RTN","LRBLPX",57,0)
AB K R S A=0 F B=0:1 S A=$O(^LR(LRDFN,1.7,A)) Q:'A  S X=^LAB(61.3,A,0) S:$P(X,"^",4) R($P(X,"^",4))=$P(X,"^")
"RTN","LRBLPX",58,0)
 Q
"RTN","LRBLPX",59,0)
END D V^LRU W !!,"Do you want to print caution tag labels " S %=1 D YN^LRU Q:%'=1  G ^LRBLJLA
"RTN","LRBLS")
0^35^B20867231^B20512427
"RTN","LRBLS",1,0)
LRBLS ;AVAMC/REG - BLOOD BANK SUPERVISOR OPTS ;12/01/95  15:30 ;
"RTN","LRBLS",2,0)
 ;;5.2;LAB SERVICE;**97,247,267,275,315,408**;Sep 27, 1994;Build 8
"RTN","LRBLS",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLS",4,0)
 ;Reference to $$CPTD^ICPTCOD Supported by 1995
"RTN","LRBLS",5,0)
 ;Reference to EN^DDIOL Supported by ICR# 10142
"RTN","LRBLS",6,0)
 ;Reference to ^DIC Supported by ICR# 2051
"RTN","LRBLS",7,0)
 ;Reference to MIX^DIC1 Supported by ICR# 10007
"RTN","LRBLS",8,0)
 ;Reference to ^DIE Supported by ICR# 10018
"RTN","LRBLS",9,0)
 ;Reference to ^DIR Supported by ICR# 10026
"RTN","LRBLS",10,0)
MSB ;max surg blood order edit
"RTN","LRBLS",11,0)
 Q  D END I '$D(^ICPT(0)) W $C(7),!!,"Current Procedure Terminology File (#81) not installed.",! G END
"RTN","LRBLS",12,0)
 W ! S DIC="^ICPT(",DIC("A")="Select OPERATION: ",DIC(0)="AEOQMZ",DIC("S")="I $P(^(0),U,3),$P(^DIC(81.1,$P(^DIC(81.1,$P(^ICPT(Y,0),U,3),0),U,3),0),U)=""SURGERY""" D ^DIC K DIC G:Y<1 END S (DA,X)=+Y
"RTN","LRBLS",13,0)
 D:'$D(^LAB(66.5,X,0)) SET^LRBLPCSS D
"RTN","LRBLS",14,0)
  . N LRX
"RTN","LRBLS",15,0)
  . S LRX=X,LRX=$$CPTD^ICPTCOD(LRX,"LRX")
"RTN","LRBLS",16,0)
  . I +LRX=-1 Q
"RTN","LRBLS",17,0)
  . F I=1:1:LRX W !,LRX(I)
"RTN","LRBLS",18,0)
  . Q
"RTN","LRBLS",19,0)
 W !!,"Selection OK " S %=1 D YN^LRU G:%'=1 MSB W ! S DR=1,DIE="^LAB(66.5," D ^DIE G MSB
"RTN","LRBLS",20,0)
CR ;blood component request
"RTN","LRBLS",21,0)
 Q  W ! S (DIC,DIE)="^LAB(66.9,",DIC(0)="AEQLM",DLAYGO=66 D ^DIC G:Y<1 END W ! S DA=+Y,DR=".01;2;1" D ^DIE G CR
"RTN","LRBLS",22,0)
SNO Q  N A
"RTN","LRBLS",23,0)
 S A(1)="This option is case sensitive."
"RTN","LRBLS",24,0)
 S A(1,"F")="!!"
"RTN","LRBLS",25,0)
 S A(2)="Enter data using the EXACT case of the ANTIBODY or ANTIGEN."
"RTN","LRBLS",26,0)
 S A(3)=" "
"RTN","LRBLS",27,0)
 D EN^DDIOL(.A)
"RTN","LRBLS",28,0)
SNO1 S DIC="^LAB(61.3,",DIC(0)="AEMQZ"
"RTN","LRBLS",29,0)
 S DIC("A")="Select ANTIGEN or ANTIBODY: "
"RTN","LRBLS",30,0)
 S DIC("S")="I $P(^(0),U,5)=""AN""!($P(^(0),U,5)=""AB"")"
"RTN","LRBLS",31,0)
 D ^DIC K DIC G:Y<1 END
"RTN","LRBLS",32,0)
 I $D(DTOUT)!($D(DUOUT)) G END
"RTN","LRBLS",33,0)
 S LRBLDA=+Y
"RTN","LRBLS",34,0)
 S LRBLA=$S($P(Y(0),U,5)="AB":"ANTIBODY",1:"ANTIGEN")
"RTN","LRBLS",35,0)
 N A
"RTN","LRBLS",36,0)
 S A(2)=LRBLA_":  "_$P(Y,U,2)
"RTN","LRBLS",37,0)
 S A(2,"F")="!!?6"
"RTN","LRBLS",38,0)
 S A(3)="CORRESPONDING "_$S(LRBLA="ANTIBODY":"ANTIGEN",1:"ANTIBODY")_":  "_$S($P(Y(0),U,4)]"":$P(^LAB(61.3,$P(Y(0),U,4),0),U),1:"")
"RTN","LRBLS",39,0)
 S A(3,"F")="!?6"
"RTN","LRBLS",40,0)
 S A(4)="SNOMED CODE:  "_$P(Y(0),U,2)
"RTN","LRBLS",41,0)
 S A(4,"F")="!?6"
"RTN","LRBLS",42,0)
 S A(5,"F")="!"
"RTN","LRBLS",43,0)
 D EN^DDIOL(.A)
"RTN","LRBLS",44,0)
 N DIR S DIR(0)="Y",DIR("B")="NO",DIR("A")="IS THIS CORRECT"
"RTN","LRBLS",45,0)
 D ^DIR Q:$D(DIRUT)  G:Y=0 SNO1
"RTN","LRBLS",46,0)
 ;
"RTN","LRBLS",47,0)
 S DA=LRBLDA,DR=".04;.06;7;5",DIE=61.3 D ^DIE K DA,DIE,DR,DIC G SNO
"RTN","LRBLS",48,0)
DES Q  S DIC="^LAB(65.4,",DIC(0)="AEQLM",DLAYGO=65,DIC("S")="I $P(^(0),U,2)]""""" W ! D ^DIC K DIC G:X=""!(X[U) END S DA=+Y,DR=".01;.02;S Z=X;.03;S:""GC""'[Z Y=0;.04:1.9;3:99",DIE=65.4 D ^DIE K DA,DIE,DR,DIC G DES
"RTN","LRBLS",49,0)
BBD Q  S DIC("A")="Select BLOOD BANK DESCRIPTIONS NAME: ",DIC="^LAB(62.5,",DIC(0)="AEQLM",DLAYGO=62,DIC("S")="I ""BDRJXZ""[$P(^(0),U,4)"
"RTN","LRBLS",50,0)
 W ! D ^DIC K DIC G:X=""!(X[U) END S DA=+Y,DR=".01;5;1;.5",DIE="^LAB(62.5," D ^DIE K DA,DIE,DR,DIC,DLAYGO G BBD
"RTN","LRBLS",51,0)
COM Q  W ! S (DIC,DIE)="^LAB(66,",DIC(0)="AEQLM",DLAYGO=66 D ^DIC K DIC,DLAYGO G:X=""!(X[U) END S DA=+Y,LR=$S($P(Y,U,2)["PEDIATRIC":1,1:0),DR=".01:.05;.29;10;.055:.1;9;.11:.19;S:LR Y=.23;.21:.28;1:999" D ^DIE K DA,DR,DIE,DIC G COM
"RTN","LRBLS",52,0)
LL Q  W ! S (DIC,DIE)="^LAB(65.9,",DIC(0)="AEQLM",DLAYGO=65 D ^DIC G:Y<1 END S DA=+Y,DR=".01:99" D ^DIE G LL
"RTN","LRBLS",53,0)
HX Q  S DA=$O(^LAB(65.4,"B","DNRHX",0)) G:'DA END S DIE=65.4,DR=2 D ^DIE K DIE,DR,DIC,DA Q
"RTN","LRBLS",54,0)
DL Q  W ! S (DIC,DIE)="^LAB(65.9,",DIC(0)="AEQLM",DLAYGO=65,DIC("S")="I ""01""[$P(^(0),U,2)" D ^DIC K DIC,DLAYGO G:Y<1 END S DA=+Y,DR=".01:99" D ^DIE G DL
"RTN","LRBLS",55,0)
CX Q  S DA=$O(^LAB(65.4,"B","DNRCX",0)) G:'DA END S DIE=65.4,DR=3 D ^DIE K DIE,DR,DIC,DA Q
"RTN","LRBLS",56,0)
LRAD W ! S (DIC,DIE)=65,DIC(0)="AEQM" D ^DIC K DIC G:Y<1 END S DA=+Y,DR="[LRBLIXR]" D ^DIE K DA,DR,DIE,DIC G LRAD
"RTN","LRBLS",57,0)
A Q  D Z G:Y=-1 END G EN1^LRUDIT
"RTN","LRBLS",58,0)
 ;
"RTN","LRBLS",59,0)
SP Q  I $S('$D(^LAB(69.9,1,8,0)):1,$P(^(0),"^",4)<8:1,1:0) D C
"RTN","LRBLS",60,0)
 W ! D END S DIE="^LAB(69.9,",DA=1,DR=".18;8.1" D ^DIE,END
"RTN","LRBLS",61,0)
ASK W ! S DIC="^LAB(69.9,1,8,",DIC(0)="AEQM",DIC("A")="Select BLOOD BANK DEFAULT OPTION: " D ^DIC K DIC G:Y<1 END
"RTN","LRBLS",62,0)
 S DA=+Y,DIE="^LAB(69.9,1,8,",DR=".02:.07" D ^DIE G ASK
"RTN","LRBLS",63,0)
 ;
"RTN","LRBLS",64,0)
C S Y="DONOR^INVENTORY^PATIENT^INQUIRIES^REPORTS^SUPERVISOR^TEST WORKLISTS^WARD"
"RTN","LRBLS",65,0)
 F A=1:1:8 I '$D(^LAB(69.9,1,8,A,0)) S ^(0)=$P(Y,"^",A),^LAB(69.9,1,8,"B",$P(Y,"^",A),A)=""
"RTN","LRBLS",66,0)
 S ^LAB(69.9,1,8,0)="^69.98A^8^8" Q
"RTN","LRBLS",67,0)
 ;
"RTN","LRBLS",68,0)
EN Q  D:'$D(LRAA) Z W ! S (DIC,DIE)=65.5,DIC(0)="AEQM",D="B^C^"_$S("NAFARMY"[DUZ("AG")&(DUZ("AG")]""):"G4^G",1:"D") D MIX^DIC1 K DIC G:Y<1 END S DA=+Y,DR="[LRBLDEF]" D ^DIE K DA,DR,DIE,DIC G EN
"RTN","LRBLS",69,0)
 ;
"RTN","LRBLS",70,0)
Z S X="BLOOD BANK" D ^LRUTL Q
"RTN","LRBLS",71,0)
 ;
"RTN","LRBLS",72,0)
END D V^LRU Q
"RTN","LRBLST")
0^36^B4239069^B4195346
"RTN","LRBLST",1,0)
LRBLST ;AVAMC/REG - BB SUPERVISOR ;9/18/89  10:08 ;
"RTN","LRBLST",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLST",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLST",4,0)
 Q  D B G:Y=-1 END W !!?5,"Edit TESTS TO BE ",$S(LR=1:"DISPLAYED ON PATIENT LOOK-UP",1:"PRINTED ON TRANSFUSION REPORT"),!
"RTN","LRBLST",5,0)
 I '$D(^LRO(69.2,LRAA,61,0)) S ^(0)="^69.61PA^^"
"RTN","LRBLST",6,0)
 S LRQ=$O(^LAB(61,"B","BLOOD",0)) I 'LRQ W !!,$C(7),"BLOOD must be an entry in the TOPOGRAPHY file !" G END
"RTN","LRBLST",7,0)
 I '$D(^LRO(69.2,LRAA,61,LRQ,0)) S X=^LRO(69.2,LRAA,61,0),^(0)="^69.61PA^"_LRQ_"^"_($P(X,"^",4)+1),^(LRQ,0)=LRQ
"RTN","LRBLST",8,0)
 I '$D(^LRO(69.2,LRAA,61,LRQ,LR,0)) S ^(0)=$S(LR=1:"^69.62PAI^^",1:"^69.63PAI^^")
"RTN","LRBLST",9,0)
ASK W ! S DA(2)=LRAA,DA(1)=LRQ,DIC="^LRO(69.2,LRAA,61,LRQ,LR,",DIC(0)="AEQLM",DLAYGO=69 D ^DIC K DIC,DLAYGO G:X=""!(X[U) END S DA=+Y,X(1)=$P(Y,U,2)
"RTN","LRBLST",10,0)
 S X=$P(^LRO(69.2,LRAA,61,LRQ,LR,DA,0),U,2) I X,'$D(^LAB(60,X(1),1,X)) S $P(^LRO(69.2,LRAA,61,LRQ,LR,DA,0),U,2)=""
"RTN","LRBLST",11,0)
 S DIE("NO^")=1,DIE="^LRO(69.2,LRAA,61,LRQ,LR,",DR=".01;.02:99" D ^DIE K DIE,DR,DA G ASK
"RTN","LRBLST",12,0)
 ;
"RTN","LRBLST",13,0)
L Q  D B Q:Y=-1  S DA=LRAA,DIE="^LRO(69.2,",DR=.07 D ^DIE Q
"RTN","LRBLST",14,0)
B S X="BLOOD BANK" D ^LRUTL Q:Y=-1
"RTN","LRBLST",15,0)
 I '$D(^LRO(69.2,LRAA,0)) S ^(0)=LRAA_"^"_LRAA(2),X=^LRO(69.2,0),^(0)=$P(X,"^",1,2)_"^"_LRAA_"^"_($P(X,"^",4)+1),^LRO(69.2,"B",LRAA,LRAA)=""
"RTN","LRBLST",16,0)
 Q
"RTN","LRBLST",17,0)
 ;
"RTN","LRBLST",18,0)
END D V^LRU Q
"RTN","LRBLST",19,0)
 ;
"RTN","LRBLST",20,0)
EN Q  D V^LRU S LR=1 G LRBLST
"RTN","LRBLST",21,0)
EN1 D V^LRU S LR=2 G LRBLST
"RTN","LRBLTX")
0^37^B19105208^B19096112
"RTN","LRBLTX",1,0)
LRBLTX ;AVAMC/REG - TESTS FOR TX RELATED DISORDERS ; 2/17/88  20:59 ;
"RTN","LRBLTX",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLTX",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLTX",4,0)
 Q  D OUT S X="BLOOD BANK" D ^LRUTL G:Y=-1 OUT
"RTN","LRBLTX",5,0)
 I '$D(^LRO(69.2,LRAA,0)) L +^LRO(69.2) S ^LRO(69.2,LRAA,0)=LRAA_"^"_LRAA(2),X=^LRO(69.2,0),^(0)=$P(X,"^",1,2)_"^"_LRAA_"^"_($P(X,"^",4)+1),^LRO(69.2,"B",LRAA,LRAA)="",^LRO(69.2,"C",LRAA(2),LRAA)="" L -^LRO(69.2)
"RTN","LRBLTX",6,0)
 I '$D(^LRO(69.2,LRAA,60,0)) S ^(0)="^69.33A^^"
"RTN","LRBLTX",7,0)
 D F G:'C T D Z
"RTN","LRBLTX",8,0)
ASK W !,"(E)nter/edit a test  (D)elete a test list  (R)emove all test lists",! R "Enter E, D, R or <CR> to accept lists: ",X:DTIME Q:X=""!(X[U)
"RTN","LRBLTX",9,0)
 G R:$A(X)=82,D:$A(X)=68,E:$A(X)=69 W $C(7) G ASK
"RTN","LRBLTX",10,0)
 ;
"RTN","LRBLTX",11,0)
L W !?6,"Test order#:",?21,1,?29,2,?37,3,?45,4,?53,5,?61,6,?69,7 D Z Q
"RTN","LRBLTX",12,0)
 ;
"RTN","LRBLTX",13,0)
Z W !,"-----------------|-------|-------|-------|-------|-------|-------|-------|" Q
"RTN","LRBLTX",14,0)
 ;
"RTN","LRBLTX",15,0)
R W !!,"SURE YOU WANT TO DELETE ALL THE LISTS " S %=2 D YN^LRU Q:%'=1  K ^LRO(69.2,LRAA,60) S ^(60,0)="^69.33A^0^0" Q
"RTN","LRBLTX",16,0)
 ;
"RTN","LRBLTX",17,0)
D R !,"Select list number to delete: ",X:DTIME G:X=""!(X[U) LRBLTX I '$D(N(X)) W $C(7),!,"Enter the test list number",! G D
"RTN","LRBLTX",18,0)
 K ^LRO(69.2,LRAA,60,X) S X(1)=$O(^LRO(69.2,LRAA,60,0)) S:'X(1) X(1)=0 S X=^LRO(69.2,LRAA,60,0),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)=0:0,1:($P(X,"^",4)-1)) G LRBLTX
"RTN","LRBLTX",19,0)
 ;
"RTN","LRBLTX",20,0)
E D A Q:X=""!(X[U)  I $D(N(L,O)) S LRT(2)=$P(^LAB(61,$P(L(L,O),"^",2),0),"^"),LRT(3)=$P(L(L,O),"^",3) W " Specimen: ",LRT(2)," Value: ",LRT(3),!,$P(L(L,O),"^",4),"// " R X:DTIME G:X[U E S:X="" X=$P(L(L,O),"^",4) D C G E
"RTN","LRBLTX",21,0)
 S DIC(0)="AEQM" D H Q:X<1  S T=X D G,K^LRU,F,Z G E
"RTN","LRBLTX",22,0)
 ;
"RTN","LRBLTX",23,0)
C I X="@" W !?3,"SURE YOU WANT TO DELETE ? " S %=0 D RX^LRU G:%=1 K W " <NOTHING DELETED>" Q
"RTN","LRBLTX",24,0)
 S DIC(0)="EQM" D H Q:X<1  S T=X D G,K^LRU,F,Z Q
"RTN","LRBLTX",25,0)
 ;
"RTN","LRBLTX",26,0)
T S DIC(0)="AEQM" D H G:X<1 END S T=X D B G T
"RTN","LRBLTX",27,0)
B D A Q:X=""!(X[U)
"RTN","LRBLTX",28,0)
G I '$D(^LRO(69.2,LRAA,60,L,0)) S ^(0)=L,Z=^LRO(69.2,LRAA,60,0),^(0)=$P(Z,"^",1,2)_"^"_L_"^"_($P(Z,"^",4)+1)
"RTN","LRBLTX",29,0)
 I $D(^LRO(69.2,LRAA,60,L,1,O,0)) S ^(0)=T G SET
"RTN","LRBLTX",30,0)
 S:'$D(^LRO(69.2,LRAA,60,L,1,0)) ^(0)="^69.34PA^0^0" S Z=^(0),^(0)=$P(Z,"^",1,2)_"^"_O_"^"_($P(Z,"^",4)+1),^LRO(69.2,LRAA,60,L,1,O,0)=T
"RTN","LRBLTX",31,0)
SET S DA=O,DA(2)=LRAA,DA(1)=L,DIE="^LRO(69.2,LRAA,60,L,1,",DR=".02//^S X=LRT(2);.03//^S X=LRT(3)" D ^DIE S (LRT(2),LRT(3))=""
"RTN","LRBLTX",32,0)
 I $D(Y) W $C(7),!!,"Must answer ALL prompts.  <ENTRY DELETED>" K ^LRO(69.2,LRAA,60,L,1,DA,0) S X(1)=$O(^LRO(69.2,LRAA,60,L,1,0)) S:'X(1) X(1)=0 S X=^(0),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)=0:0,1:($P(X,"^",4)-1))
"RTN","LRBLTX",33,0)
 K DIC,DIE,DA,DR,X,Y Q
"RTN","LRBLTX",34,0)
 ;
"RTN","LRBLTX",35,0)
H S:'$D(LRT(2)) LRT(2)="" S:'$D(LRT(3)) LRT(3)="" W ! S DIC=60,DIC("S")="I $P(^(0),U,5)[""CH""" D ^DIC K DIC Q:X=""!(X[U)  S X=+Y Q
"RTN","LRBLTX",36,0)
A R !,"Enter list#,order# : ",X:DTIME Q:X=""!(X[U)  S L=+X,O=+$P(X,",",2) I L>99!(L<1)!(O>7)!(O<1) D W G A
"RTN","LRBLTX",37,0)
 Q
"RTN","LRBLTX",38,0)
W W !!?3,"Enter test list number (1-99) then a ',' then test order number (1-7)",!,"[Entering 2,3 would put the test selected in test list 2 and test order 3]",! Q
"RTN","LRBLTX",39,0)
END S Z=0 F X=0:0 S X=$O(^LRO(69.2,LRAA,60,X)) Q:'X!(Z=1)  F Y=0:0 S Y=$O(^LRO(69.2,LRAA,60,X,1,Y)) Q:'Y  S Z=1 Q
"RTN","LRBLTX",40,0)
 G LRBLTX:Z,OUT
"RTN","LRBLTX",41,0)
K K ^LRO(69.2,LRAA,60,L,1,O) S X(1)=$O(^LRO(69.2,LRAA,60,L,1,0)) S:'X(1) X(1)=0 S X=^LRO(69.2,LRAA,60,L,1,0),^(0)=$P(X,"^",1,2)_"^"_X(1)_"^"_$S(X(1)=0:0,1:($P(X,"^",4)-1)) D K^LRU,F,Z Q
"RTN","LRBLTX",42,0)
F W @IOF
"RTN","LRBLTX",43,0)
 F A=0:0 S A=$O(^LRO(69.2,LRAA,60,A)) Q:'A  F B=0:0 S B=$O(^LRO(69.2,LRAA,60,A,1,B)) Q:'B  S C=^(B,0),N(A,B)=$P(^LAB(60,+C,.1),"^"),L(A,B)=$P($P(^(0),U,5),";",2)_"^"_$P(C,"^",2,3)_"^"_$P(^(0),"^")
"RTN","LRBLTX",44,0)
 S A=0 F C=0:1 S A=$O(N(A)) Q:'A  D:'C L D:C Z W !,"Test list#: ",$J(A,2),?17,"|" F B=0:0 S B=$O(N(A,B)) Q:'B  W ?10+(B*8),N(A,B),$E("       ",1,7-$L(N(A,B))),"|"
"RTN","LRBLTX",45,0)
 Q
"RTN","LRBLTX",46,0)
OUT D V^LRU Q
"RTN","LRBLVAL")
0^38^B825391^B807361
"RTN","LRBLVAL",1,0)
LRBLVAL ;AVAMC/REG - OPTION VALIDATOR ;3/9/94  13:18
"RTN","LRBLVAL",2,0)
 ;;5.2;LAB SERVICE;**247,408**;Sep 27, 1994;Build 8
"RTN","LRBLVAL",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","LRBLVAL",4,0)
 Q  K DIC,DA W ! S (DIC,DIE)=66.2,DIC(0)="AEQM" D ^DIC G:Y<1 END S DA=+Y,DR=".07:99" D ^DIE G LRBLVAL
"RTN","LRBLVAL",5,0)
I K DIC,DA W ! S DIC="^LAB(66.2,",DIC(0)="AEQM" D ^DIC G:Y<1 END S DA=+Y D EN^DIQ G I
"RTN","LRBLVAL",6,0)
 ;
"RTN","LRBLVAL",7,0)
P K DIC,DA S L=0,DIC="^LAB(66.2,",FLDS="[CAPTIONED]",BY="[LRBLVAL]" G EN1^DIP
"RTN","LRBLVAL",8,0)
 Q
"RTN","LRBLVAL",9,0)
 ;
"RTN","LRBLVAL",10,0)
END D V^LRU Q
"RTN","LRUWG")
0^40^B14796767^B14787480
"RTN","LRUWG",1,0)
LRUWG ;AVAMC/REG - SINGLE TEST WORKLIST ;2/22/94  09:45 ;
"RTN","LRUWG",2,0)
 ;;5.2;LAB SERVICE;**408**;Sep 27, 1994;Build 8
"RTN","LRUWG",3,0)
 Q  D END W !!?20,"Single test worklist"
"RTN","LRUWG",4,0)
T S DIC=60,DIC(0)="AEMOQZ" D ^DIC K DIC G:Y<1 END S W(1)=$P(Y,U,2),F=+Y
"RTN","LRUWG",5,0)
 S X=$O(^LAB(60,F,8,0)) I 'X W $C(7),!,"No INSTITUTION designated in LAB TEST FILE (#60, field 6)",! G T
"RTN","LRUWG",6,0)
 S X(1)=+^LAB(60,F,8,X,0),X(1)=$P(^DIC(4,X(1),0),U)
"RTN","LRUWG",7,0)
 I $O(^LAB(60,F,8,X)) D ASK G:'$D(X) T
"RTN","LRUWG",8,0)
 S X=^LAB(60,F,8,X,0),(W,LRAA)=$P(X,"^",2) I 'LRAA W $C(7),!,"No Accession AREA for this test",! G T
"RTN","LRUWG",9,0)
D S %DT="AE",%DT("A")="ENTER TEST DATE: " D ^%DT G:Y<1 END D LRAD
"RTN","LRUWG",10,0)
 S X=$S(X="Y"&(LRAD["0000"):1,X="D"&(+$E(LRAD,6,7)):1,"MQ"[X&(+$E(LRAD,4,5)):1,1:0) I 'X W $C(7),"  Date not specific enough" G D
"RTN","LRUWG",11,0)
 I '$D(^LRO(68,W,1,LRAD,0)) W $C(7),!!,"NO ",W(1)," ACCESSIONS IN FILE FOR ",LRH(0),! G D
"RTN","LRUWG",12,0)
ST R !!,"Start from accn #: ",N(1):DTIME G:N(1)=""!(N(1)[U) END G:N(1)'?1N.N ST
"RTN","LRUWG",13,0)
 R !!,"Go    to   accn #:   LAST// ",N(2):DTIME G:N(2)[U!('$T) END S:N(2)="" N(2)=99999 I N(2)'?1N.N W $C(7),!!,"NUMBERS ONLY" G ST
"RTN","LRUWG",14,0)
 S ZTRTN="QUE^LRUW" D BEG^LRUTL G:POP!($D(ZTSK)) END
"RTN","LRUWG",15,0)
QUE S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LRUWG",16,0)
 D L^LRU K ^TMP($J) S N=N(1)-1,(LR("Q"),LRQ)=0,LRQ(1)=DUZ(2)
"RTN","LRUWG",17,0)
ACN F A=0:0 S N=$O(^LRO(68,W,1,LRAD,1,N)) Q:'N!(N>N(2))  I $D(^(N,0)) S X=^(0),LRLLOC=$P(X,"^",7),LRDFN=+X D:LRDFN TT
"RTN","LRUWG",18,0)
 D WRT W:IOST'?1"C".E @IOF K ^TMP($J) D END^LRUTL,END Q
"RTN","LRUWG",19,0)
L W !,$J(Z,3),") ",$J($S(T(5)>.999:T(5),1:T(5)*1000),5),?14,$P(N,"^",6) W:$L($P(N,"^",6))>21 !
"RTN","LRUWG",20,0)
 S X=$P(N,"^",5) W ?37,N(7),?49,$S(X:$P($G(^VA(200,X,0)),"^",2),1:X),?54,$P(N,"^",2),?60,$E($P(N,"^"),1,19),!?15 F X=1:1:IOM-15 W "-"
"RTN","LRUWG",21,0)
 Q
"RTN","LRUWG",22,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRUWG",23,0)
 D F^LRU W !,^TMP($J,W,0)," Worklist",?40,"(* = STAT)"
"RTN","LRUWG",24,0)
 W !,"COUNT",?6,"ACC#",?17,"RESULT",?37,"Completed",?49,"Tech",?54,"ID",?60,"PATIENT",!,LR("%"),! Q
"RTN","LRUWG",25,0)
NEW D H Q:LR("Q")  W !?15,T(2),T(3),":",!,LRH(0) Q
"RTN","LRUWG",26,0)
TT F T=0:0 S T=$O(^LRO(68,W,1,LRAD,1,N,4,T)) Q:'T!(T=F)
"RTN","LRUWG",27,0)
 S X=^LR(LRDFN,0),Y=$P(X,"^",3),LRDPF=$P(X,U,2),(X,LRPF)=^DIC($P(X,"^",2),0,"GL"),X=@(X_Y_",0)"),LRP=$P(X,"^"),SSN=$P(X,"^",9) D SSN^LRU
"RTN","LRUWG",28,0)
 Q:T<1  S T(4)=^LRO(68,W,1,LRAD,1,N,4,T,0),V=$P(T(4),"^",4),T(6)=$P(T(4),"^",5),T(1)=$P(T(4),"^",2),T(4)=$P(T(4),"^",6) S:T(1)=1 T(1)="*" D STF
"RTN","LRUWG",29,0)
 Q
"RTN","LRUWG",30,0)
STF ;
"RTN","LRUWG",31,0)
 I '$D(^TMP($J,W,1,T,0)) S X=^LAB(60,T,0),P=$S($D(^LAB(60,T,.1)):" ("_$P(^(.1),"^")_")",1:""),^TMP($J,W,1,T,0)=$P(X,"^")_"^"_P,^TMP($J,W,1,"B",$P(X,"^"),T)=""
"RTN","LRUWG",32,0)
 I '$D(^TMP($J,W,0)) S X=$S($D(^LRO(68,W,0)):$P(^(0),"^"),1:"??"),^TMP($J,W,0)=X
"RTN","LRUWG",33,0)
 I LRPF="^LAB(62.3," S C(6)=N,N=N/1000,^TMP($J,W,1,T,N)=LRP_"^"_SSN(1)_"^"_LRLLOC_"^"_T(1)_"^"_V_"^"_T(4)_"^"_T(6),N=C(6) Q
"RTN","LRUWG",34,0)
 S ^TMP($J,W,1,T,N)=LRP_"^"_SSN(1)_"^"_LRLLOC_"^"_T(1)_"^"_V_"^"_T(4)_"^"_T(6) Q
"RTN","LRUWG",35,0)
WRT F W=0:0 S W=$O(^TMP($J,W)),LRQ=0 Q:'W  D H Q:LR("Q")  S LR("F")=1 D ZZ
"RTN","LRUWG",36,0)
 Q
"RTN","LRUWG",37,0)
ZZ S A(8)=0 F X=0:0 S A(8)=$O(^TMP($J,W,1,"B",A(8))) Q:A(8)=""!(LR("Q"))  S T=$O(^(A(8),0)) D:$Y>(IOSL-6) H Q:LR("Q")  S T(3)=^TMP($J,W,1,T,0),T(2)=$P(T(3),"^"),T(3)=$P(T(3),"^",2) W !?15,T(2),T(3),":",!,LRH(0) S T(5)=0 D SCN
"RTN","LRUWG",38,0)
 Q
"RTN","LRUWG",39,0)
SCN F Z=1:1 S T(5)=$O(^TMP($J,W,1,T,T(5))) Q:T(5)=""!(LR("Q"))  S N=^TMP($J,W,1,T,T(5)),Y=$P(N,"^",7) D T^LRU S N(7)=Y D:$Y>(IOSL-6) NEW Q:LR("Q")  D L
"RTN","LRUWG",40,0)
 Q
"RTN","LRUWG",41,0)
ASK S DIC="^LAB(60,F,8,",DIC(0)="AEMOQZ",DIC("B")=X(1) D ^DIC K DIC I Y<1 K X Q
"RTN","LRUWG",42,0)
 S X=+Y Q
"RTN","LRUWG",43,0)
LRAD S X=$P(^LRO(68,LRAA,0),"^",3),(Y,LRAD)=$S(X="Y":$E(Y,1,3)_"0000","M"[X:$E(Y,1,5)_"00","Q"[X:$E(Y,1,3)_"0000"+(($E(Y,4,5)-1)\3*300+100),1:Y) D D^LRU S LRH(0)=Y Q
"RTN","LRUWG",44,0)
 ;
"RTN","LRUWG",45,0)
END D V^LRU Q
"SEC","^DIC",6003,6003,0,"AUDIT")
@
"SEC","^DIC",6003,6003,0,"DD")
@
"SEC","^DIC",6003,6003,0,"DEL")
@
"SEC","^DIC",6003,6003,0,"LAYGO")
@
"SEC","^DIC",6003,6003,0,"RD")
@
"SEC","^DIC",6003,6003,0,"WR")
@
"SEC","^DIC",6009,6009,0,"AUDIT")

"SEC","^DIC",6009,6009,0,"DD")

"SEC","^DIC",6009,6009,0,"DEL")

"SEC","^DIC",6009,6009,0,"LAYGO")

"SEC","^DIC",6009,6009,0,"RD")

"SEC","^DIC",6009,6009,0,"WR")

"VER")
8.0^22.0
"^DD",6003,6003,0)
FIELD^^100^2
"^DD",6003,6003,0,"DDA")
N
"^DD",6003,6003,0,"DT")
3020807
"^DD",6003,6003,0,"IX","B",6003,.01)

"^DD",6003,6003,0,"NM","VISTA BLOOD BANK RESTRICTED OPTIONS LIST")

"^DD",6003,6003,0,"VRPK")
LR
"^DD",6003,6003,.01,0)
OPTION^RFX^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",6003,6003,.01,1,0)
^.1
"^DD",6003,6003,.01,1,1,0)
6003^B
"^DD",6003,6003,.01,1,1,1)
S ^VBEC(6003,"B",$E(X,1,30),DA)=""
"^DD",6003,6003,.01,1,1,2)
K ^VBEC(6003,"B",$E(X,1,30),DA)
"^DD",6003,6003,.01,3)
Enter the name of the VistA Blood Bank option that will be set 'out-of-order'.  Answer must be 3-30 characters in length.
"^DD",6003,6003,.01,21,0)
^^2^2^3020807^
"^DD",6003,6003,.01,21,1,0)
The name of the VistA Blood Bank (LRBL) option that will be set 
"^DD",6003,6003,.01,21,2,0)
'out-of-order'.
"^DD",6003,6003,.01,"DEL",1,0)
I 1 D EN^DDIOL("Blood Bank option names are not to be deleted.",,"!,$C(7)")
"^DD",6003,6003,.01,"DT")
3020808
"^DD",6003,6003,100,0)
DESCRIPTION^6003.01^^1;0
"^DD",6003,6003,100,21,0)
^^3^3^3020927^
"^DD",6003,6003,100,21,1,0)
This field contains a brief explanation of the particular option. It will
"^DD",6003,6003,100,21,2,0)
be displayed in the menu system to the user when '??' are entered to the
"^DD",6003,6003,100,21,3,0)
selection choice of the parent menu.
"^DD",6003,6003.01,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",6003,6003.01,0,"DT")
3020807
"^DD",6003,6003.01,0,"NM","DESCRIPTION")

"^DD",6003,6003.01,0,"UP")
6003
"^DD",6003,6003.01,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",6003,6003.01,.01,3)
Describe the functionality of the option.
"^DD",6003,6003.01,.01,21,0)
^.001^1^1^3020927^^
"^DD",6003,6003.01,.01,21,1,0)
This field describes the purpose of the option.
"^DD",6003,6003.01,.01,"DT")
3020807
"^DD",6009,6009,0)
FIELD^^100^4
"^DD",6009,6009,0,"DDA")
N
"^DD",6009,6009,0,"DT")
3021025
"^DD",6009,6009,0,"IX","B",6009,.01)

"^DD",6009,6009,0,"NM","VBECS FILE & FIELD LEVEL SECURITY")

"^DD",6009,6009,0,"VRPK")
LR
"^DD",6009,6009,.01,0)
FILE NUMBER^RNJ5,2X^^0;1^K:+X'=X!(X>69.99)!(X<60)!(X?.E1"."3N.N) X S:$D(X) DINUM=X
"^DD",6009,6009,.01,1,0)
^.1
"^DD",6009,6009,.01,1,1,0)
6009^B
"^DD",6009,6009,.01,1,1,1)
S ^VBEC(6009,"B",$E(X,1,30),DA)=""
"^DD",6009,6009,.01,1,1,2)
K ^VBEC(6009,"B",$E(X,1,30),DA)
"^DD",6009,6009,.01,3)
Type a VistA Blood Bank File Number between 60 and 69.99, 2 Decimal Digits
"^DD",6009,6009,.01,21,0)
^.001^1^1^3020807^^
"^DD",6009,6009,.01,21,1,0)
The VistA file number of the file being tracked.
"^DD",6009,6009,.01,"DEL",1,0)
I 1 D EN^DDIOL("Blood Bank file/field records are not to be deleted.",,"!,$C(7)")
"^DD",6009,6009,.01,"DT")
3020807
"^DD",6009,6009,.02,0)
PRE-CONV. RESTRICTED ACCESS^S^Y:Yes;^0;2^Q
"^DD",6009,6009,.02,3)
Enter 'Y' for yes if restricted access applies to this file prior to executing the data conversion application.
"^DD",6009,6009,.02,21,0)
^^2^2^3021024^
"^DD",6009,6009,.02,21,1,0)
This field tracks if restricted access applies to this file prior to 
"^DD",6009,6009,.02,21,2,0)
executing the data conversion application.
"^DD",6009,6009,.02,"DT")
3021024
"^DD",6009,6009,.03,0)
PST-CONV. RESTRICTED ACCESS^S^Y:Yes;^0;3^Q
"^DD",6009,6009,.03,3)
Enter 'Y' for yes if restricted access applies to this file after executing the data conversion application.
"^DD",6009,6009,.03,21,0)
^^2^2^3021024^
"^DD",6009,6009,.03,21,1,0)
This field tracks if restricted access applies to this file after  
"^DD",6009,6009,.03,21,2,0)
executing the data conversion application.
"^DD",6009,6009,.03,"DT")
3021024
"^DD",6009,6009,100,0)
DATA DICTIONARY^6009.01A^^DD;0
"^DD",6009,6009.01,0)
DATA DICTIONARY SUB-FIELD^^2^4
"^DD",6009,6009.01,0,"DT")
3021025
"^DD",6009,6009.01,0,"IX","B",6009.01,.01)

"^DD",6009,6009.01,0,"NM","DATA DICTIONARY")

"^DD",6009,6009.01,0,"UP")
6009
"^DD",6009,6009.01,.01,0)
DATA DICTIONARY^NJ12,9X^^0;1^K:+X'=X!(X>69.999999999)!(X<60)!(X?.E1"."10N.N) X
"^DD",6009,6009.01,.01,1,0)
^.1
"^DD",6009,6009.01,.01,1,1,0)
6009.01^B
"^DD",6009,6009.01,.01,1,1,1)
S ^VBEC(6009,DA(1),"DD","B",$E(X,1,30),DA)=""
"^DD",6009,6009.01,.01,1,1,2)
K ^VBEC(6009,DA(1),"DD","B",$E(X,1,30),DA)
"^DD",6009,6009.01,.01,3)
Enter the appropriate Blood Bank data dictionary number.  Type a Number between 60 and 69.999999999, 9 Decimal Digits
"^DD",6009,6009.01,.01,21,0)
^.001^2^2^3020808^^
"^DD",6009,6009.01,.01,21,1,0)
Tracks the data dictionary file/sub-file number and field for the purpose 
"^DD",6009,6009.01,.01,21,2,0)
of recording field-level security (read, write, delete, and audit access).
"^DD",6009,6009.01,.01,"DT")
3020808
"^DD",6009,6009.01,.02,0)
FIELD^NJ15,7^^0;2^K:+X'=X!(X>9999999.9999999)!(X<.001)!(X?.E1"."8N.N) X
"^DD",6009,6009.01,.02,3)
Enter the appropriate field number.  Type a Number between .001 and 9999999.9999999, 7 Decimal Digits
"^DD",6009,6009.01,.02,21,0)
^^2^2^3020808^
"^DD",6009,6009.01,.02,21,1,0)
Tracks the data dictionary and field number for the purpose of 
"^DD",6009,6009.01,.02,21,2,0)
identifying 'before & after' field security information.
"^DD",6009,6009.01,.02,"DT")
3020808
"^DD",6009,6009.01,1,0)
PRE-CONVERSION WRITE ACCESS^F^^PREW;E1,245^K:$L(X)>245!($L(X)<1) X
"^DD",6009,6009.01,1,3)
Automated field add, edit, and delete.  Answer must be 1-245 characters in length.
"^DD",6009,6009.01,1,21,0)
^^2^2^3021025^
"^DD",6009,6009.01,1,21,1,0)
Indicates the write level access of the field prior to the data
"^DD",6009,6009.01,1,21,2,0)
conversion.
"^DD",6009,6009.01,1,"DT")
3021025
"^DD",6009,6009.01,2,0)
POST-CONVERSION WRITE ACCESS^F^^PSTW;E1,245^K:$L(X)>245!($L(X)<1) X
"^DD",6009,6009.01,2,3)
Automated field add, edit, and delete.  Answer must be 1-245 characters in length.
"^DD",6009,6009.01,2,21,0)
^^1^1^3021025^
"^DD",6009,6009.01,2,21,1,0)
Indicates the write level access of the field after the data conversion.
"^DD",6009,6009.01,2,"DT")
3021025
"^DIC",6003,6003,0)
VISTA BLOOD BANK RESTRICTED OPTIONS LIST^6003
"^DIC",6003,6003,0,"GL")
^VBEC(6003,
"^DIC",6003,6003,"%",0)
^1.005^^0
"^DIC",6003,6003,"%D",0)
^^3^3^3030612^
"^DIC",6003,6003,"%D",1,0)
This file exports the names of VistA Blood Bank (LRBL name spaced) options
"^DIC",6003,6003,"%D",2,0)
that will be set 'Out of Order' once the data conversion has successfully
"^DIC",6003,6003,"%D",3,0)
completed.
"^DIC",6003,"B","VISTA BLOOD BANK RESTRICTED OPTIONS LIST",6003)

"^DIC",6009,6009,0)
VBECS FILE & FIELD LEVEL SECURITY^6009
"^DIC",6009,6009,0,"GL")
^VBEC(6009,
"^DIC",6009,6009,"%D",0)
^^3^3^3030612^
"^DIC",6009,6009,"%D",1,0)
This file exports the file and field numbers of VistA Blood Bank (LRBL
"^DIC",6009,6009,"%D",2,0)
name spaced) data dictionaries that will 'write protect' these files 
"^DIC",6009,6009,"%D",3,0)
and fields once the data conversion has successfully completed.
"^DIC",6009,"B","VBECS FILE & FIELD LEVEL SECURITY",6009)

"BLD",7402,6)
^323
**END**
**END**
