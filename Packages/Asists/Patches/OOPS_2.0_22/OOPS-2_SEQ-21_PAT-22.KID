Released OOPS*2*22 SEQ #21
Extracted from mail message
**KIDS**:OOPS*2.0*22^

**INSTALL NAME**
OOPS*2.0*22
"BLD",8622,0)
OOPS*2.0*22^ASISTS^0^3110411^y
"BLD",8622,1,0)
^^3^3^3110411^
"BLD",8622,1,1,0)
This patch fixes the potential for an undefined error when an employee
"BLD",8622,1,2,0)
does not have a hire date and updates the ASISTS OWCP CHARGEBACK CODES
"BLD",8622,1,3,0)
file (#2263.6) with four new entries. 
"BLD",8622,4,0)
^9.64PA^^
"BLD",8622,6.3)
1
"BLD",8622,"INIT")
ADD^OOPS2P22
"BLD",8622,"KRN",0)
^9.67PA^779.2^20
"BLD",8622,"KRN",.4,0)
.4
"BLD",8622,"KRN",.401,0)
.401
"BLD",8622,"KRN",.402,0)
.402
"BLD",8622,"KRN",.403,0)
.403
"BLD",8622,"KRN",.5,0)
.5
"BLD",8622,"KRN",.84,0)
.84
"BLD",8622,"KRN",3.6,0)
3.6
"BLD",8622,"KRN",3.8,0)
3.8
"BLD",8622,"KRN",9.2,0)
9.2
"BLD",8622,"KRN",9.8,0)
9.8
"BLD",8622,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8622,"KRN",9.8,"NM",1,0)
OOPSGUI7^^0^B29256546
"BLD",8622,"KRN",9.8,"NM","B","OOPSGUI7",1)

"BLD",8622,"KRN",19,0)
19
"BLD",8622,"KRN",19.1,0)
19.1
"BLD",8622,"KRN",101,0)
101
"BLD",8622,"KRN",409.61,0)
409.61
"BLD",8622,"KRN",771,0)
771
"BLD",8622,"KRN",779.2,0)
779.2
"BLD",8622,"KRN",870,0)
870
"BLD",8622,"KRN",8989.51,0)
8989.51
"BLD",8622,"KRN",8989.52,0)
8989.52
"BLD",8622,"KRN",8994,0)
8994
"BLD",8622,"KRN","B",.4,.4)

"BLD",8622,"KRN","B",.401,.401)

"BLD",8622,"KRN","B",.402,.402)

"BLD",8622,"KRN","B",.403,.403)

"BLD",8622,"KRN","B",.5,.5)

"BLD",8622,"KRN","B",.84,.84)

"BLD",8622,"KRN","B",3.6,3.6)

"BLD",8622,"KRN","B",3.8,3.8)

"BLD",8622,"KRN","B",9.2,9.2)

"BLD",8622,"KRN","B",9.8,9.8)

"BLD",8622,"KRN","B",19,19)

"BLD",8622,"KRN","B",19.1,19.1)

"BLD",8622,"KRN","B",101,101)

"BLD",8622,"KRN","B",409.61,409.61)

"BLD",8622,"KRN","B",771,771)

"BLD",8622,"KRN","B",779.2,779.2)

"BLD",8622,"KRN","B",870,870)

"BLD",8622,"KRN","B",8989.51,8989.51)

"BLD",8622,"KRN","B",8989.52,8989.52)

"BLD",8622,"KRN","B",8994,8994)

"BLD",8622,"QUES",0)
^9.62^^
"BLD",8622,"REQB",0)
^9.611^1^1
"BLD",8622,"REQB",1,0)
OOPS*2.0*7^1
"BLD",8622,"REQB","B","OOPS*2.0*7",1)

"INIT")
ADD^OOPS2P22
"MBREQ")
0
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
2.0^3020709^3030401^66481
"PKG",472,22,1,"PAH",1,0)
22^3110411
"PKG",472,22,1,"PAH",1,1,0)
^^3^3^3110411
"PKG",472,22,1,"PAH",1,1,1,0)
This patch fixes the potential for an undefined error when an employee
"PKG",472,22,1,"PAH",1,1,2,0)
does not have a hire date and updates the ASISTS OWCP CHARGEBACK CODES
"PKG",472,22,1,"PAH",1,1,3,0)
file (#2263.6) with four new entries. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","OOPS2P22")
0^^B4562733^n/a
"RTN","OOPS2P22",1,0)
OOPS2P22 ;MNT/RRA FILE UPDATE TO 2263.6 ;04/24/08
"RTN","OOPS2P22",2,0)
 ;;2.0;ASISTS;**22**;Jun 03, 2002;Build 1
"RTN","OOPS2P22",3,0)
 ;
"RTN","OOPS2P22",4,0)
 Q
"RTN","OOPS2P22",5,0)
ADD ;
"RTN","OOPS2P22",6,0)
 N OOPSCODE,OOPSREG,OOPSNAME,OOPSCNT1,OOPSNEW,OOPSSTAT,OOPSVHO,OOPSDNM1,DINUM
"RTN","OOPS2P22",7,0)
 D MES^XPDUTL(" ")
"RTN","OOPS2P22",8,0)
 D BMES^XPDUTL("Adding new charge back code to ASISTS OWCP CHARGEBACK CODE FILE 2263.6(#725)...")
"RTN","OOPS2P22",9,0)
 D MES^XPDUTL(" ")
"RTN","OOPS2P22",10,0)
 S OOPSDNM1=$O(^OOPS(2263.6,9999),-1)
"RTN","OOPS2P22",11,0)
 F OOPSCNT1=1:1 S OOPSNEW=$P($T(NEW+OOPSCNT1),";;",2) Q:OOPSNEW="QUIT"  D
"RTN","OOPS2P22",12,0)
 .S OOPSNAME=$P(OOPSNEW,U,1),OOPSCODE=$P(OOPSNEW,U,2),OOPSSTAT=$P(OOPSNEW,U,3),OOPSREG=$P(OOPSNEW,U,4),OOPSVHO=$P(OOPSNEW,U,5)
"RTN","OOPS2P22",13,0)
 .S X=OOPSCODE D FILPROC
"RTN","OOPS2P22",14,0)
 D KILL1
"RTN","OOPS2P22",15,0)
 Q
"RTN","OOPS2P22",16,0)
NEW ;
"RTN","OOPS2P22",17,0)
 ;;CPAC Murfreesboro, TN^4104^731^9^CPAC
"RTN","OOPS2P22",18,0)
 ;;CPAC Asheville, NC^4109^730^6^CPAC
"RTN","OOPS2P22",19,0)
 ;;CPAC Madison, WI^4111^732^12^CPAC
"RTN","OOPS2P22",20,0)
 ;;Fort Sill National Cemetery^4459^920^3^NCS
"RTN","OOPS2P22",21,0)
 ;;QUIT
"RTN","OOPS2P22",22,0)
FILPROC ;
"RTN","OOPS2P22",23,0)
 I $D(^OOPS(2263.6,"B",OOPSCODE)) D
"RTN","OOPS2P22",24,0)
 .D MES^XPDUTL(" ")
"RTN","OOPS2P22",25,0)
 .D BMES^XPDUTL("   Your site has "_OOPSCODE_" in ASISTS OWCP CHARGEBACK CODE FILE 2263.6")
"RTN","OOPS2P22",26,0)
 I '$D(^OOPS(2263.6,"B",OOPSCODE)) D
"RTN","OOPS2P22",27,0)
 .S OOPSDNM1=OOPSDNM1+1,DINUM=OOPSDNM1,DIC(0)="L",DLAYGO=2263.6,DIC="^OOPS(2263.6,"
"RTN","OOPS2P22",28,0)
 .S DIC("DR")=".01////^S X=OOPSCODE;1///^S X=OOPSNAME;2///^S X=OOPSSTAT;3///^S X=OOPSREG;4///^S X=OOPSVHO"
"RTN","OOPS2P22",29,0)
 .D FILE^DICN
"RTN","OOPS2P22",30,0)
 .I +Y>0 D
"RTN","OOPS2P22",31,0)
 ..D MES^XPDUTL(" ")
"RTN","OOPS2P22",32,0)
 ..D BMES^XPDUTL(OOPSCODE_"  ...successfully added.")
"RTN","OOPS2P22",33,0)
 .I Y=-1 D 
"RTN","OOPS2P22",34,0)
 ..D MES^XPDUTL(" ")
"RTN","OOPS2P22",35,0)
 ..D BMES^XPDUTL("ERROR when attempting to add "_OOPSCODE)
"RTN","OOPS2P22",36,0)
 .K Y
"RTN","OOPS2P22",37,0)
 Q
"RTN","OOPS2P22",38,0)
KILL1 ;
"RTN","OOPS2P22",39,0)
 K DIC("DR"),DLAYGO,DIC,DIC(0),X
"RTN","OOPSGUI7")
0^1^B29256546^B29220356
"RTN","OOPSGUI7",1,0)
OOPSGUI7 ;WIOFO/LLH-RPC routines ;10/30/01
"RTN","OOPSGUI7",2,0)
 ;;2.0;ASISTS;**2,4,7,22**;Jun 03, 2002;Build 1
"RTN","OOPSGUI7",3,0)
 ;
"RTN","OOPSGUI7",4,0)
ENT(RESULTS,INPUT) ; Non-interactive GUI Entry Point for transmitting data
"RTN","OOPSGUI7",5,0)
 ;                 to DOL or NDB
"RTN","OOPSGUI7",6,0)
 ;  Input:   INPUT  - Contains the date for the claims to be
"RTN","OOPSGUI7",7,0)
 ;                    retransmitted, the queue date and time for the
"RTN","OOPSGUI7",8,0)
 ;                    retransmission date to run and either DOL or NDB
"RTN","OOPSGUI7",9,0)
 ;                    to indicate which manual transmission should run.
"RTN","OOPSGUI7",10,0)
 ;                    The format is TRANSDT^QUEUEDT@TIME^DOL (or NDB)
"RTN","OOPSGUI7",11,0)
 ; Output: RESULTS -  is the return array to the client with status
"RTN","OOPSGUI7",12,0)
 ;                    message
"RTN","OOPSGUI7",13,0)
 N ARR,COMMA,ERR1,ERR2,FIELD,FL,MAILG,CURR,QDATE,QUE,RDATE,RTN,X,Y
"RTN","OOPSGUI7",14,0)
 N MAN,WOK,ZTDESC,ZTREQ,ZTRTN
"RTN","OOPSGUI7",15,0)
 S RTN=$P($G(INPUT),U,3)
"RTN","OOPSGUI7",16,0)
 S MAN=1                       ; force manual xmit flag
"RTN","OOPSGUI7",17,0)
 I RTN="DOL" D
"RTN","OOPSGUI7",18,0)
 . S MAILG="OOPS DOL XMIT DATA"
"RTN","OOPSGUI7",19,0)
 . S QUE="Q-AST.MED.VA.GOV"
"RTN","OOPSGUI7",20,0)
 I RTN="NDB" D
"RTN","OOPSGUI7",21,0)
 . S MAILG="OOPS XMIT 2162 DATA"
"RTN","OOPSGUI7",22,0)
 . S QUE="Q-ASI.MED.VA.GOV"
"RTN","OOPSGUI7",23,0)
 ;Check for security keys
"RTN","OOPSGUI7",24,0)
 I '$D(^XUSEC(MAILG,DUZ)) D  Q
"RTN","OOPSGUI7",25,0)
 .S RESULTS(0)="ERROR"
"RTN","OOPSGUI7",26,0)
 .S RESULTS(1)="You do not have the required Security Key."
"RTN","OOPSGUI7",27,0)
 ;Assure the Queue has been defined
"RTN","OOPSGUI7",28,0)
 S FIELD=.01,FL="X"
"RTN","OOPSGUI7",29,0)
 D FIND^DIC(4.2,"",FIELD,FL,QUE,"","","","","ARR")
"RTN","OOPSGUI7",30,0)
 I '$D(ARR("DILIST",1)) D  Q
"RTN","OOPSGUI7",31,0)
 .S RESULTS(0)="ERROR"
"RTN","OOPSGUI7",32,0)
 .S RESULTS(1)="Domain not found in the DOMAIN File,"
"RTN","OOPSGUI7",33,0)
 ; Get Retransmit Date from First Piece of Input & Translate into FM
"RTN","OOPSGUI7",34,0)
 S X=$P($G(INPUT),U) D ^%DT
"RTN","OOPSGUI7",35,0)
 S RDATE=Y
"RTN","OOPSGUI7",36,0)
 I RDATE=-1 S ERR1=1
"RTN","OOPSGUI7",37,0)
 S %DT="R",X=$P($G(INPUT),U,2) D ^%DT K %DT
"RTN","OOPSGUI7",38,0)
 S QDATE=Y
"RTN","OOPSGUI7",39,0)
 I QDATE=-1 S ERR2=2
"RTN","OOPSGUI7",40,0)
 I $G(ERR1)!($G(ERR2)) D  Q
"RTN","OOPSGUI7",41,0)
 . S RESULTS(0)="ERROR",RESULTS(1)="",COMMA=""
"RTN","OOPSGUI7",42,0)
 . S:$G(ERR1) RESULTS(1)="Invalid Transmission Date",COMMA=", "
"RTN","OOPSGUI7",43,0)
 . S:$G(ERR2) RESULTS(1)=RESULTS(1)_COMMA_"Invalid Queue Date."
"RTN","OOPSGUI7",44,0)
 ;
"RTN","OOPSGUI7",45,0)
 I RTN="DOL" D
"RTN","OOPSGUI7",46,0)
 . S ZTRTN="EN^OOPSDOL",WOK=1,ZTDESC="TRANSMIT DOL CA1/CA2 DATA"
"RTN","OOPSGUI7",47,0)
 I RTN="NDB" D
"RTN","OOPSGUI7",48,0)
 . S ZTRTN="EN^OOPSNDB",ZTDESC="TRANSMIT NATIONAL DATABASE 2162 DATA"
"RTN","OOPSGUI7",49,0)
 ; Make sure Queue date/time is not after current time
"RTN","OOPSGUI7",50,0)
 S CURR=$$HTFM^XLFDT(""_$H_"")
"RTN","OOPSGUI7",51,0)
 I $$FMDIFF^XLFDT(QDATE,CURR,2)<0 S QDATE=$H
"RTN","OOPSGUI7",52,0)
 ; Report will always be Queued from the GUI
"RTN","OOPSGUI7",53,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSGUI7",54,0)
 S ZTDTH=QDATE,ZTIO="",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSGUI7",55,0)
 S ZTSAVE("RDATE")="",ZTSAVE("MAN")=""
"RTN","OOPSGUI7",56,0)
 D ^%ZTLOAD
"RTN","OOPSGUI7",57,0)
 K ZTSK
"RTN","OOPSGUI7",58,0)
 S RESULTS(0)="SUCCESSFULLY QUEUED"
"RTN","OOPSGUI7",59,0)
 Q
"RTN","OOPSGUI7",60,0)
OWCPCLR(RESULTS,IEN,CALLER,FORM) ; Entry point for clearing supervisor
"RTN","OOPSGUI7",61,0)
 ;   fields if OWPC worker has edited them
"RTN","OOPSGUI7",62,0)
 ;  Input:     IEN - ien of case to have the fields cleared
"RTN","OOPSGUI7",63,0)
 ;          CALLER - menu being called from
"RTN","OOPSGUI7",64,0)
 ;            FORM - whether a CA1 or CA2
"RTN","OOPSGUI7",65,0)
 ; Output: RESULTS - required results parameter, no data returned
"RTN","OOPSGUI7",66,0)
 ;                   from this call
"RTN","OOPSGUI7",67,0)
 I $G(IEN)=""!($G(CALLER)="")!($G(FORM)="") Q
"RTN","OOPSGUI7",68,0)
 D CLRFLDS^OOPSWCE
"RTN","OOPSGUI7",69,0)
SUPFLDS ; Clear Supervisor fields for the CA1, since fields have been changed
"RTN","OOPSGUI7",70,0)
 I FORM'="CA1" Q
"RTN","OOPSGUI7",71,0)
 N SUP
"RTN","OOPSGUI7",72,0)
 S SUP=$$GET1^DIQ(200,DUZ,.01)
"RTN","OOPSGUI7",73,0)
 S RESULTS=SUP
"RTN","OOPSGUI7",74,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,3)=""     ;Clear EXCEPTION 
"RTN","OOPSGUI7",75,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,4)=""     ;Clear SUP TITLE
"RTN","OOPSGUI7",76,0)
 S $P(^OOPS(2260,IEN,"CA1L"),U,5)=""     ;Clear SUP PHONE
"RTN","OOPSGUI7",77,0)
 Q
"RTN","OOPSGUI7",78,0)
CONSENT(RESULTS,IEN,UNIREP)     ; Employee consented to union notification,
"RTN","OOPSGUI7",79,0)
 ;                 send msg to union
"RTN","OOPSGUI7",80,0)
 ; Input
"RTN","OOPSGUI7",81,0)
 ;    IEN - Internal record number
"RTN","OOPSGUI7",82,0)
 ; UNIREP - IEN from file 200 of the Union Rep - used to send bulletin
"RTN","OOPSGUI7",83,0)
 ; Output - RESULTS - String indicating bulletin status.
"RTN","OOPSGUI7",84,0)
 D CONSENT^OOPSMBUL(IEN,UNIREP)
"RTN","OOPSGUI7",85,0)
 Q
"RTN","OOPSGUI7",86,0)
GETFLD(RESULTS,IEN,FLD) ; Send in IEN and Field number to retrieve a single 
"RTN","OOPSGUI7",87,0)
 ; data field from the ASISTS Accident Reporting File (#2260)
"RTN","OOPSGUI7",88,0)
 ;
"RTN","OOPSGUI7",89,0)
 ;  Input:   IEN - Internal record number
"RTN","OOPSGUI7",90,0)
 ; Output:   FLD - the file and field number of the data element to be
"RTN","OOPSGUI7",91,0)
 ;                 retrieved.  EX. 2260^120
"RTN","OOPSGUI7",92,0)
 N FILE,FIELD,DATA
"RTN","OOPSGUI7",93,0)
 S RESULTS="No data."
"RTN","OOPSGUI7",94,0)
 I '$G(IEN) S RESULTS="No data.  Missing Record Identifier." Q
"RTN","OOPSGUI7",95,0)
 S FILE=$P(FLD,U),FIELD=$P(FLD,U,2)
"RTN","OOPSGUI7",96,0)
 I $G(FILE)=""!($G(FIELD)="") D  Q
"RTN","OOPSGUI7",97,0)
 . S RESULTS="No data.  Missing File or Field information."
"RTN","OOPSGUI7",98,0)
 ; This should only get called when OOPS*2.0*7 is 1st released, used
"RTN","OOPSGUI7",99,0)
 ; to get hire date if it's blank and personnel status is employee
"RTN","OOPSGUI7",100,0)
 I FIELD=336 D  Q
"RTN","OOPSGUI7",101,0)
 .N SSN,STR S SSN=$$GET1^DIQ(FILE,IEN,5,"I")
"RTN","OOPSGUI7",102,0)
 .D FIND^DIC(450,,"@;.01;30","PS",SSN,"","SSN")
"RTN","OOPSGUI7",103,0)
 .S STR=$P($G(^TMP("DILIST",$J,0)),U) I $G(STR)'=1 S RESULTS="No Data." Q
"RTN","OOPSGUI7",104,0)
 .S RESULTS=$P($G(^TMP("DILIST",$J,1,0)),U,3)
"RTN","OOPSGUI7",105,0)
 .I RESULTS="" S RESULTS="No Data."
"RTN","OOPSGUI7",106,0)
 .K ^TMP("DILIST",$J),DIERR
"RTN","OOPSGUI7",107,0)
 S DATA=$$GET1^DIQ(FILE,IEN,FIELD)
"RTN","OOPSGUI7",108,0)
 I $G(DATA)'="" S RESULTS=DATA
"RTN","OOPSGUI7",109,0)
 Q
"RTN","OOPSGUI7",110,0)
GETINST(RESULTS)        ; 
"RTN","OOPSGUI7",111,0)
 ; RPC Call - Get Institutions from File 4
"RTN","OOPSGUI7",112,0)
 ; Output:  RESULTS - global array
"RTN","OOPSGUI7",113,0)
 ;
"RTN","OOPSGUI7",114,0)
 ; 12/30/03 llh (OOPS*2*4) - this subroutine can only be used
"RTN","OOPSGUI7",115,0)
 ; to retrieve data from ^DIC(4).  There is generic code in OOPSGUI3
"RTN","OOPSGUI7",116,0)
 ; to obtain data from other 'table files'.
"RTN","OOPSGUI7",117,0)
 ;
"RTN","OOPSGUI7",118,0)
 N ITEM,ROOT,X,XREF,SFLD,VAL,PTR,PCE,VALID,FIELD
"RTN","OOPSGUI7",119,0)
 K ^TMP("OOPSINST",$J)
"RTN","OOPSGUI7",120,0)
 S XREF="B",X=0,FIELD=13
"RTN","OOPSGUI7",121,0)
 S ROOT="^"_$$GET1^DID(2260,FIELD,"","POINTER")
"RTN","OOPSGUI7",122,0)
 S ITEM="" F  S ITEM=$O(@(ROOT_"XREF,ITEM)")) Q:$G(ITEM)']""  D
"RTN","OOPSGUI7",123,0)
 .S PTR=0 F  S PTR=$O(@(ROOT_"XREF,ITEM,PTR)")) Q:PTR=""  D
"RTN","OOPSGUI7",124,0)
 ..I PTR'>0 Q
"RTN","OOPSGUI7",125,0)
 ..S VAL=$P(@(ROOT_PTR_",0)"),U)
"RTN","OOPSGUI7",126,0)
 ..S VALID=1,SFLD=ROOT_PTR_",99)"
"RTN","OOPSGUI7",127,0)
 ..I $P($G(@SFLD),U,4)=1 S VALID=0
"RTN","OOPSGUI7",128,0)
 ..I $P($G(@SFLD),U)'="" S VAL=VAL_" = "_$P($G(@SFLD),U)
"RTN","OOPSGUI7",129,0)
 ..I $P(VAL," = ")="" S VALID=0
"RTN","OOPSGUI7",130,0)
 ..I VALID S X=X+1,^TMP("OOPSINST",$J,X)=PTR_":"_VAL_$C(10)
"RTN","OOPSGUI7",131,0)
 S RESULTS=$NA(^TMP("OOPSINST",$J))
"RTN","OOPSGUI7",132,0)
 Q
"RTN","OOPSGUI7",133,0)
SENSDATA(RES,SDUZ,EMP) ;Supervisor accessed sensitive data, case not created
"RTN","OOPSGUI7",134,0)
 ; Input  EMP String which is the name of the employee accessed.
"RTN","OOPSGUI7",135,0)
 ;        DUZ DUZ of the Supervisor accessing the data. 
"RTN","OOPSGUI7",136,0)
 N MGRP,MEMS,MSG
"RTN","OOPSGUI7",137,0)
 ;Make sure mail group exists
"RTN","OOPSGUI7",138,0)
 S MGRP=$$FIND1^DIC(3.8,"","X","OOPS ISO NOTIFICATION")
"RTN","OOPSGUI7",139,0)
 I 'MGRP D  G BULL
"RTN","OOPSGUI7",140,0)
 .S XMY("G.OOPS WC MESSAGE")=""
"RTN","OOPSGUI7",141,0)
 .S XMDUZ="ASISTS Package"
"RTN","OOPSGUI7",142,0)
 .S GRP="OOPS WC MESSAGE"
"RTN","OOPSGUI7",143,0)
 .S XMSUB="ASISTS ISO NOTIFICATION Mail Group Error"
"RTN","OOPSGUI7",144,0)
 .S MSG(1)="The OOPS ISO NOTIFICATION Mail Group does not exist."
"RTN","OOPSGUI7",145,0)
 .S XMTEXT="MSG("
"RTN","OOPSGUI7",146,0)
 .D ^XMD
"RTN","OOPSGUI7",147,0)
 ;Make sure there is someone defined in the mail group
"RTN","OOPSGUI7",148,0)
 D LIST^DIC(3.81,","_MGRP_",","","",1,"","","","","","MEMS")
"RTN","OOPSGUI7",149,0)
 I '$P(MEMS("DILIST",0),U) D  G BULL
"RTN","OOPSGUI7",150,0)
 .S XMY("G.OOPS WC MESSAGE")=""
"RTN","OOPSGUI7",151,0)
 .S XMDUZ="ASISTS Package"
"RTN","OOPSGUI7",152,0)
 .S GRP="OOPS WC MESSAGE"
"RTN","OOPSGUI7",153,0)
 .S XMSUB="ASISTS ISO NOTIFICATION Mail Group Error"
"RTN","OOPSGUI7",154,0)
 .S MSG(1)="There are no members in mail group OOPS ISO NOTIFICATION."
"RTN","OOPSGUI7",155,0)
 .S XMTEXT="MSG("
"RTN","OOPSGUI7",156,0)
 .D ^XMD
"RTN","OOPSGUI7",157,0)
 S XMY("G.OOPS ISO NOTIFICATION")=""
"RTN","OOPSGUI7",158,0)
BULL S (NAME,XMB)="OOPS SENSITIVE DATA"
"RTN","OOPSGUI7",159,0)
 S XMB(1)=$$GET1^DIQ(200,SDUZ,.01)
"RTN","OOPSGUI7",160,0)
 S XMB(2)=EMP
"RTN","OOPSGUI7",161,0)
 S XMB(3)=$$FMTE^XLFDT($$NOW^XLFDT,1)
"RTN","OOPSGUI7",162,0)
 S XMBODY="",XMINSTR("FLAGS")="X"
"RTN","OOPSGUI7",163,0)
 D TASKBULL^XMXAPI(DUZ,NAME,.XMB,XMBODY,.XMY,.XMINSTR)
"RTN","OOPSGUI7",164,0)
 K NAME,XMB,XMBODY,XMY,XMINSTR
"RTN","OOPSGUI7",165,0)
 S RES="BULLETIN SENT"
"RTN","OOPSGUI7",166,0)
 Q
"VER")
8.0^22.0
"BLD",8622,6)
^21
**END**
**END**
