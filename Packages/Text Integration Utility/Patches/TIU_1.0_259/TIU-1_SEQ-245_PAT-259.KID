Released TIU*1*259 SEQ #245
Extracted from mail message
**KIDS**:TIU*1.0*259^

**INSTALL NAME**
TIU*1.0*259
"BLD",8064,0)
TIU*1.0*259^TEXT INTEGRATION UTILITIES^0^3110629^y
"BLD",8064,1,0)
^^7^7^3110629^^
"BLD",8064,1,1,0)
This build for TIU*1*259 addresses 2 issues.
"BLD",8064,1,2,0)
 
"BLD",8064,1,3,0)
First, it adds the date of the document to alerts for OVERDUE signatures.
"BLD",8064,1,4,0)
 
"BLD",8064,1,5,0)
Second, it changes TIU VISTA MRT Option Unsigned/Uncosigned Report [TIU 
"BLD",8064,1,6,0)
UNSIGNED/UNCOSIGNED REPORT] so that documents requiring a cosignature are
"BLD",8064,1,7,0)
sorted under the service of the Expected Cosigner rather than the author.
"BLD",8064,4,0)
^9.64PA^^
"BLD",8064,6.3)
4
"BLD",8064,"KRN",0)
^9.67PA^779.2^20
"BLD",8064,"KRN",.4,0)
.4
"BLD",8064,"KRN",.401,0)
.401
"BLD",8064,"KRN",.402,0)
.402
"BLD",8064,"KRN",.403,0)
.403
"BLD",8064,"KRN",.5,0)
.5
"BLD",8064,"KRN",.84,0)
.84
"BLD",8064,"KRN",3.6,0)
3.6
"BLD",8064,"KRN",3.8,0)
3.8
"BLD",8064,"KRN",9.2,0)
9.2
"BLD",8064,"KRN",9.8,0)
9.8
"BLD",8064,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",8064,"KRN",9.8,"NM",1,0)
TIURDIV^^0^B66574914
"BLD",8064,"KRN",9.8,"NM",2,0)
TIUALRT^^0^B52527963
"BLD",8064,"KRN",9.8,"NM","B","TIUALRT",2)

"BLD",8064,"KRN",9.8,"NM","B","TIURDIV",1)

"BLD",8064,"KRN",19,0)
19
"BLD",8064,"KRN",19.1,0)
19.1
"BLD",8064,"KRN",101,0)
101
"BLD",8064,"KRN",409.61,0)
409.61
"BLD",8064,"KRN",771,0)
771
"BLD",8064,"KRN",779.2,0)
779.2
"BLD",8064,"KRN",870,0)
870
"BLD",8064,"KRN",8989.51,0)
8989.51
"BLD",8064,"KRN",8989.52,0)
8989.52
"BLD",8064,"KRN",8994,0)
8994
"BLD",8064,"KRN","B",.4,.4)

"BLD",8064,"KRN","B",.401,.401)

"BLD",8064,"KRN","B",.402,.402)

"BLD",8064,"KRN","B",.403,.403)

"BLD",8064,"KRN","B",.5,.5)

"BLD",8064,"KRN","B",.84,.84)

"BLD",8064,"KRN","B",3.6,3.6)

"BLD",8064,"KRN","B",3.8,3.8)

"BLD",8064,"KRN","B",9.2,9.2)

"BLD",8064,"KRN","B",9.8,9.8)

"BLD",8064,"KRN","B",19,19)

"BLD",8064,"KRN","B",19.1,19.1)

"BLD",8064,"KRN","B",101,101)

"BLD",8064,"KRN","B",409.61,409.61)

"BLD",8064,"KRN","B",771,771)

"BLD",8064,"KRN","B",779.2,779.2)

"BLD",8064,"KRN","B",870,870)

"BLD",8064,"KRN","B",8989.51,8989.51)

"BLD",8064,"KRN","B",8989.52,8989.52)

"BLD",8064,"KRN","B",8994,8994)

"BLD",8064,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",8064,"QUES",0)
^9.62^^
"BLD",8064,"REQB",0)
^9.611^2^2
"BLD",8064,"REQB",1,0)
TIU*1.0*113^2
"BLD",8064,"REQB",2,0)
TIU*1.0*227^2
"BLD",8064,"REQB","B","TIU*1.0*113",1)

"BLD",8064,"REQB","B","TIU*1.0*227",2)

"MBREQ")
0
"PKG",193,-1)
1^1
"PKG",193,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",193,20,0)
^9.402P^^
"PKG",193,22,0)
^9.49I^1^1
"PKG",193,22,1,0)
1.0^3010321^3010321^11
"PKG",193,22,1,"PAH",1,0)
259^3110629
"PKG",193,22,1,"PAH",1,1,0)
^^7^7^3110629
"PKG",193,22,1,"PAH",1,1,1,0)
This build for TIU*1*259 addresses 2 issues.
"PKG",193,22,1,"PAH",1,1,2,0)
 
"PKG",193,22,1,"PAH",1,1,3,0)
First, it adds the date of the document to alerts for OVERDUE signatures.
"PKG",193,22,1,"PAH",1,1,4,0)
 
"PKG",193,22,1,"PAH",1,1,5,0)
Second, it changes TIU VISTA MRT Option Unsigned/Uncosigned Report [TIU 
"PKG",193,22,1,"PAH",1,1,6,0)
UNSIGNED/UNCOSIGNED REPORT] so that documents requiring a cosignature are
"PKG",193,22,1,"PAH",1,1,7,0)
sorted under the service of the Expected Cosigner rather than the author.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","TIUALRT")
0^2^B52527963^B47981995
"RTN","TIUALRT",1,0)
TIUALRT ; SLC/JER,AJB - Notify Author and Attending. ;06/29/11  14:00
"RTN","TIUALRT",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**21,84,79,88,58,61,151,158,175,221,227,259**;Jun 20, 1997;Build 4
"RTN","TIUALRT",3,0)
SEND(DA,OVERDUE) ; Generate "available for signature" alert
"RTN","TIUALRT",4,0)
 ;ICR 10035  ^DPT(  .01    NAME   0;1  Direct Global Read
"RTN","TIUALRT",5,0)
 N TIU0,TIU12,TIU13,TIU14,TIU15,TIUDATE,TIUESNR,TIUPNM,TIUECSNR,TIUSIG,TIUDPRM
"RTN","TIUALRT",6,0)
 N TIUCOSG,TIUEDT,TIUSSN,TIU,TIUTYP,XQA,XQAKILL,XQAMSG,XQAROU,XQAID
"RTN","TIUALRT",7,0)
 N XQAFLG,STATUS,SIGACT,ECSNRFLG
"RTN","TIUALRT",8,0)
 N XQADATA ;259
"RTN","TIUALRT",9,0)
 I '$D(TIUPRM0)!'$D(TIUPRM1) D SETPARM^TIULE
"RTN","TIUALRT",10,0)
 I '$D(TIUTMP("NODEL")) D ALERTDEL(DA)
"RTN","TIUALRT",11,0)
 S TIU0=$G(^TIU(8925,+DA,0)),TIU12=$G(^(12)),TIU13=$G(^(13))
"RTN","TIUALRT",12,0)
 S TIU14=$G(^TIU(8925,+DA,14)),TIU15=$G(^(15))
"RTN","TIUALRT",13,0)
 D DOCPRM^TIULC1(+TIU0,.TIUDPRM,DA)
"RTN","TIUALRT",14,0)
 ; Quit if notifications not enabled
"RTN","TIUALRT",15,0)
 I '$D(TIUDPRM(0)) Q
"RTN","TIUALRT",16,0)
 ; If document is an addendum, and the original is incomplete, quit
"RTN","TIUALRT",17,0)
 ; per NOIS DUR-0101-32087
"RTN","TIUALRT",18,0)
 ; I +$$ISADDNDM^TIULC1(DA),($P($G(^TIU(8925,+$P(TIU0,U,6),0)),U,5)<7) Q
"RTN","TIUALRT",19,0)
 I '+$P(TIUPRM1,U,7)!(+$P(TIU12,U)<+$P(TIUPRM1,U,7)) Q
"RTN","TIUALRT",20,0)
 ;VMP/ELR  PATCH 221  DO NOT SEND ALERTS FOR RETRACTED DOCUMENTS
"RTN","TIUALRT",21,0)
 I +$P(TIU0,U,5)=15 Q
"RTN","TIUALRT",22,0)
 ; If third party alert from TIUALFUN **158**
"RTN","TIUALRT",23,0)
 I $D(TIUTMP("THIRD PARTY ALERTS")) G THIRD
"RTN","TIUALRT",24,0)
 ; If document is completed, jump to additional signers
"RTN","TIUALRT",25,0)
 I (+$P(TIU0,U,5)'<7) G ADDSNR
"RTN","TIUALRT",26,0)
 I +$P(TIU0,U,5)=3,+$P($G(TIUDPRM(0)),U,2),'+$P(TIU13,U,4) Q  ; not released **175**
"RTN","TIUALRT",27,0)
 ; If Verification required, and not verified, don't send
"RTN","TIUALRT",28,0)
 I +$P(TIU0,U,5)=4,+$$REQVER^TIULC(DA,+$P($G(TIUDPRM(0)),U,3)),'+$P(TIU13,U,5) Q  ; **175**
"RTN","TIUALRT",29,0)
 ; Set up for call to XQALERT
"RTN","TIUALRT",30,0)
 S TIUEDT=$$DATE^TIULS($P(TIU0,U,7))
"RTN","TIUALRT",31,0)
 S TIUESNR=$P(TIU12,U,4)
"RTN","TIUALRT",32,0)
 S TIUSIG=$P(TIU15,U)
"RTN","TIUALRT",33,0)
 S TIUECSNR=$P(TIU12,U,8),TIUCOSG=$P(TIU15,U,7)
"RTN","TIUALRT",34,0)
 ; If author has been identified, but not Expected Signer, make
"RTN","TIUALRT",35,0)
 ; author the expected signer
"RTN","TIUALRT",36,0)
 I +TIUESNR'>0,(+$P(TIU12,U,2)>0) D
"RTN","TIUALRT",37,0)
 . N DIE,DR
"RTN","TIUALRT",38,0)
 . S TIUESNR=$P(TIU12,U,2)
"RTN","TIUALRT",39,0)
 . S DIE=8925,DR="1204////^S X=TIUESNR" D ^DIE
"RTN","TIUALRT",40,0)
 ; If attending has been identified, but not Expected Cosigner, make
"RTN","TIUALRT",41,0)
 ; attending the expected cosigner
"RTN","TIUALRT",42,0)
 I +TIUECSNR'>0,(+$P(TIU12,U,9)>0) D
"RTN","TIUALRT",43,0)
 . N DIE,DR
"RTN","TIUALRT",44,0)
 . S TIUECSNR=$P(TIU12,U,9)
"RTN","TIUALRT",45,0)
 . S DIE=8925,DR="1208////^S X=TIUECSNR" D ^DIE
"RTN","TIUALRT",46,0)
 ; If first signature required and the expected signer is authorized
"RTN","TIUALRT",47,0)
 ; to sign this record, and the record is not yet signed
"RTN","TIUALRT",48,0)
 ; ** Set AUTHOR as recipient
"RTN","TIUALRT",49,0)
 I '+$G(TIUSIG),(+TIUESNR>0),(+$P(TIUDPRM(0),U,4)>0) S XQA(TIUESNR)=""
"RTN","TIUALRT",50,0)
 ; If the record requires cosignature, and is not yet cosigned
"RTN","TIUALRT",51,0)
 ; ** Set Expected Cosigner as recipient
"RTN","TIUALRT",52,0)
 I TIUECSNR]"",(+$P(TIU0,U,5)<7),(+$G(TIUCOSG)'>0) D
"RTN","TIUALRT",53,0)
 . N TIUDA S TIUDA=DA
"RTN","TIUALRT",54,0)
 . ; For documents other than Discharge Summaries, defer alerting
"RTN","TIUALRT",55,0)
 . ; Expected Cosigner 'til AUTHOR has signed
"RTN","TIUALRT",56,0)
 . ; If current document is an addendum apply test to its parent
"RTN","TIUALRT",57,0)
 . I +$$ISADDNDM^TIULC1(DA) S TIUDA=$P(^TIU(8925,DA,0),U,6)
"RTN","TIUALRT",58,0)
 . ; If cosigner alerts are to be deferred until signature, quit
"RTN","TIUALRT",59,0)
 . I '+$P(TIUDPRM(0),U,20),'+$G(TIUSIG),+$P(TIUDPRM(0),U,4) Q  ; **84,112/151**
"RTN","TIUALRT",60,0)
 . S XQA(TIUECSNR)="",ECSNRFLG=1 ; **151**
"RTN","TIUALRT",61,0)
ADDSNR ; Send addendum alerts, check for additional signers
"RTN","TIUALRT",62,0)
 ;VMP/ELR PATCH 221  DO NOT SEND AMENDMENT ALERT IF CAUSED BY A DELINQUENT ADDITIONAL SIGNER
"RTN","TIUALRT",63,0)
 I +$$ISADDNDM^TIULC1(DA),$G(TIUADDL)'=1 D SENDADD(DA)
"RTN","TIUALRT",64,0)
 ; If additional signers have been designated, alert them too
"RTN","TIUALRT",65,0)
 I +$O(^TIU(8925.7,"B",DA,0)),(+$P(TIU0,U,5)>5) D
"RTN","TIUALRT",66,0)
 . N TIUXTRA,TIUI D XTRASGNR^TIULG(.TIUXTRA,DA) Q:+$D(TIUXTRA)'>9
"RTN","TIUALRT",67,0)
 . S TIUI=0 F  S TIUI=$O(TIUXTRA(TIUI)) Q:+TIUI'>0  S XQA(TIUI)=""
"RTN","TIUALRT",68,0)
 Q:$D(XQA)'>9
"RTN","TIUALRT",69,0)
THIRD ; **158**
"RTN","TIUALRT",70,0)
 I $D(TIUTMP("THIRD PARTY ALERTS")) D
"RTN","TIUALRT",71,0)
 . N TIUX
"RTN","TIUALRT",72,0)
 . S TIUX="" F  S TIUX=$O(TIUXQA(TIUX)) Q:TIUX=""  S XQA(TIUX)=""
"RTN","TIUALRT",73,0)
 ; Get demographics for alert message
"RTN","TIUALRT",74,0)
 S TIUPNM=$E($P($G(^DPT(+$P(TIU0,U,2),0)),U),1,9)
"RTN","TIUALRT",75,0)
 S TIUTYP=$$PNAME^TIULC1(+$G(TIU0))
"RTN","TIUALRT",76,0)
 D PATVADPT^TIULV(.TIU,+$P(TIU0,U,2))
"RTN","TIUALRT",77,0)
 S TIUSSN=$E(TIUPNM,1)_$P($G(TIU("SSN")),"-",3)
"RTN","TIUALRT",78,0)
 S XQAID="TIU"_+DA,STATUS=$$UP^XLFSTR($$GET1^DIQ(8925,DA,.05)) ; **175** $$STATUS^TIULC(DA))
"RTN","TIUALRT",79,0)
 S SIGACT=$S(STATUS="UNSIGNED":"SIGNATURE",STATUS="UNCOSIGNED":"COSIGNATURE",1:"ADD'L SIGNATURE")
"RTN","TIUALRT",80,0)
 I $G(ECSNRFLG),$P(TIU0,U,5)=5 S STATUS="UNSIG/UNCOS'D" ; **151**
"RTN","TIUALRT",81,0)
 ;I STATUS="UNCOSIGNED" S STATUS="UNCOS'D"
"RTN","TIUALRT",82,0)
 ;I $G(OVERDUE) S TIUTYP=$E(TIUTYP,1,42-$L(STATUS))
"RTN","TIUALRT",83,0)
 S XQAMSG=TIUPNM_" ("_TIUSSN_"): "_STATUS_" "_$S($P(TIU0,U,9)="P":"STAT ",1:"")_TIUTYP
"RTN","TIUALRT",84,0)
 ;I +$G(OVERDUE) S XQAMSG=XQAMSG_" OVERDUE for "_SIGACT_"." G ENDMSG
"RTN","TIUALRT",85,0)
 I +$G(OVERDUE) D  G ENDMSG ; TIU,259
"RTN","TIUALRT",86,0)
  . S TIUDATE=$$DATE^TIULS(+TIU13)
"RTN","TIUALRT",87,0)
  . S XQAMSG=XQAMSG_" Dated "_TIUDATE_" OVERDUE for "_SIGACT_"."
"RTN","TIUALRT",88,0)
  . ;S XQAMSG=XQAMSG_": "_TIUDATE_" OVERDUE for "_SIGACT_"."
"RTN","TIUALRT",89,0)
 S XQAMSG=XQAMSG_" available for "_SIGACT_"."
"RTN","TIUALRT",90,0)
ENDMSG ;
"RTN","TIUALRT",91,0)
 S XQAROU="ACT^TIUALRT",XQADATA=+DA_U
"RTN","TIUALRT",92,0)
 D SETUP^XQALERT
"RTN","TIUALRT",93,0)
 Q
"RTN","TIUALRT",94,0)
ACT ; Act on alerts
"RTN","TIUALRT",95,0)
 N TIUQUIK,TIUDA,TIUPRM0,TIUPRM1,TIUPRM3,RSTOK S TIUQUIK=1 K XQAKILL
"RTN","TIUALRT",96,0)
 S TIUDA=$P(XQADATA,U)
"RTN","TIUALRT",97,0)
 I '$D(^TIU(8925,+TIUDA,0)) D ALERTDEL(TIUDA) Q
"RTN","TIUALRT",98,0)
 S RSTOK=$$DOCCHK^TIULRR(TIUDA)
"RTN","TIUALRT",99,0)
 I RSTOK'>0 D  Q
"RTN","TIUALRT",100,0)
 . W !!,$C(7),"Ok, no harm done...",! ; Echo denial message
"RTN","TIUALRT",101,0)
 . I $$READ^TIUU("EA","RETURN to continue...") ; pause
"RTN","TIUALRT",102,0)
 I $P(^TIU(8925,+TIUDA,0),U,5)'<7,'+$$ISSIGNR(TIUDA,DUZ) S XQAKILL=1
"RTN","TIUALRT",103,0)
 D:'$D(TIUPRM0)!'$D(TIUPRM1) SETPARM^TIULE
"RTN","TIUALRT",104,0)
 D EN^VALM("TIU BROWSE FOR CLINICIAN")
"RTN","TIUALRT",105,0)
 Q
"RTN","TIUALRT",106,0)
SENDTRAN(DA) ; Generate "Send back to transcription" alert
"RTN","TIUALRT",107,0)
 N TIUEDT,TIU0,TIUPNM,TIUSSN,TIUTRAN,TIU,XQA,XQAMSG,TIUMSG
"RTN","TIUALRT",108,0)
 N TIUESNR,TIU12,TIU13,TIU14,TIU15,TIUTYP
"RTN","TIUALRT",109,0)
 N XQAID ;259
"RTN","TIUALRT",110,0)
 I '$D(TIUPRM0)!'$D(TIUPRM1) D SETPARM^TIULE
"RTN","TIUALRT",111,0)
 D ALERTDEL(DA)
"RTN","TIUALRT",112,0)
 ; Don't send if notifications not enabled
"RTN","TIUALRT",113,0)
 I '+$P(TIUPRM1,U,7) Q
"RTN","TIUALRT",114,0)
 S TIU0=$G(^TIU(8925,+DA,0)),TIU12=$G(^(12)),TIU13=$G(^(13))
"RTN","TIUALRT",115,0)
 S TIU14=$G(^TIU(8925,+DA,14)),TIU15=$G(^(15))
"RTN","TIUALRT",116,0)
 S TIUPNM=$E($P($G(^DPT(+$P(TIU0,U,2),0)),U),1,9)
"RTN","TIUALRT",117,0)
 S TIUEDT=$$DATE^TIULS($P(TIU0,U,7))
"RTN","TIUALRT",118,0)
 S TIUTYP=$$PNAME^TIULC1(+$G(TIU0))
"RTN","TIUALRT",119,0)
 S TIUTRAN=$P(TIU13,U,2),TIUESNR=$P(TIU12,U,2) ; **175**
"RTN","TIUALRT",120,0)
 D PATVADPT^TIULV(.TIU,+$P(TIU0,U,2)) ;Used to get SSN. Date not important.
"RTN","TIUALRT",121,0)
 S TIUSSN=$E(TIUPNM,1)_$P($G(TIU("SSN")),"-",3)
"RTN","TIUALRT",122,0)
 ;I $D(^VA(200,+TIUTRAN,0)) S XQA(TIUTRAN)=""
"RTN","TIUALRT",123,0)
 I $$PROVIDER^XUSER(TIUTRAN) S XQA(TIUTRAN)="" ;ICR #2343 In file 200 & not terminated
"RTN","TIUALRT",124,0)
 Q:$D(XQA)'>9
"RTN","TIUALRT",125,0)
 S TIUMSG=$S(TIUTRAN=TIUESNR:" needs editing",1:" needs retranscription.")
"RTN","TIUALRT",126,0)
 S XQAID="TIU"_+DA
"RTN","TIUALRT",127,0)
 S XQAMSG=TIUPNM_" ("_TIUSSN_"): "_TIUTYP_TIUMSG
"RTN","TIUALRT",128,0)
 D SETUP^XQALERT
"RTN","TIUALRT",129,0)
 Q
"RTN","TIUALRT",130,0)
SENDADD(DA) ; Generates "Addendum added" alert
"RTN","TIUALRT",131,0)
 N TIU12,TIU13,TIU14,TIU15,TIU0,TIUPNM,TIUSSN,TIUTRAN,TIU,TIUTITLE,TIUDPRM
"RTN","TIUALRT",132,0)
 N XQA,XQAMSG,XQAFLG,XQADATA,XQAROU,TIUESNR,TIUDATE,TIUESNM,TIUO0,TIUO12,TIUO13
"RTN","TIUALRT",133,0)
 N XQAID,TIUECSNR ;P259
"RTN","TIUALRT",134,0)
 I '$D(TIUPRM0)!'$D(TIUPRM1) D SETPARM^TIULE
"RTN","TIUALRT",135,0)
 D ADDENDEL(DA)
"RTN","TIUALRT",136,0)
 ; Don't send if notifications not enabled
"RTN","TIUALRT",137,0)
 I '+$P(TIUPRM1,U,7) Q
"RTN","TIUALRT",138,0)
 S TIU0=$G(^TIU(8925,+DA,0))
"RTN","TIUALRT",139,0)
 ; Only send upon completion
"RTN","TIUALRT",140,0)
 Q:+$P(TIU0,U,5)'>6
"RTN","TIUALRT",141,0)
 D DOCPRM^TIULC1(+TIU0,.TIUDPRM,DA) Q:'+$P(TIUDPRM(0),U,17)
"RTN","TIUALRT",142,0)
 S TIU12=$G(^TIU(8925,+DA,12)),TIU13=$G(^(13)),TIU14=$G(^(14)),TIU15=$G(^(15))
"RTN","TIUALRT",143,0)
 S TIUO0=$G(^TIU(8925,$P(TIU0,U,6),0)),TIUO12=$G(^(12)),TIUO13=$G(^(13))
"RTN","TIUALRT",144,0)
 S TIUPNM=$E($$PTNAME^TIULC1(+$P(TIU0,U,2)),1,9)
"RTN","TIUALRT",145,0)
 S TIUESNM=$$NAME^TIULS($$PERSNAME^TIULC1(+$P(TIU12,U,2)),"LAST,FI MI")
"RTN","TIUALRT",146,0)
 S TIUTITLE=$E($$PNAME^TIULC1(+TIUO0),1,20)
"RTN","TIUALRT",147,0)
 S TIUDATE=$S(+$P(TIUO13,U):$P(TIUO13,U),1:$G(DT))
"RTN","TIUALRT",148,0)
 S TIUDATE=$$DATE^TIULS(TIUDATE)
"RTN","TIUALRT",149,0)
 D PATVADPT^TIULV(.TIU,+$P(TIU0,U,2)) ;Used to get SSN. Date not important.
"RTN","TIUALRT",150,0)
 S TIUSSN=$E(TIUPNM,1)_$P($G(TIU("SSN")),"-",3)
"RTN","TIUALRT",151,0)
 S TIUTRAN=$P(TIU13,U,2)
"RTN","TIUALRT",152,0)
 ;Expected Cosigner and Author of original document
"RTN","TIUALRT",153,0)
 S TIUECSNR=$P($G(^TIU(8925,$P(TIU0,U,6),12)),U,8),TIUESNR=$P($G(^(12)),U,4)
"RTN","TIUALRT",154,0)
 ; Not entered by Expected Signer: SET Expected Signer as recipient
"RTN","TIUALRT",155,0)
 I TIUESNR'=TIUTRAN,$D(^VA(200,+TIUESNR,0)) S XQA(TIUESNR)=""
"RTN","TIUALRT",156,0)
 ; Not entered by Expected Cosigner: SET Expected Cosigner as recipient
"RTN","TIUALRT",157,0)
 ; VMP/RJT - *227 - If user is the expected cosigner, do not send alert
"RTN","TIUALRT",158,0)
 I +TIUECSNR>0,(TIUECSNR'=DUZ),(TIUECSNR'=TIUTRAN),$D(^VA(200,+TIUECSNR,0)) S XQA(TIUECSNR)=""
"RTN","TIUALRT",159,0)
 Q:$D(XQA)'>9
"RTN","TIUALRT",160,0)
 S XQAID="TIUADD"_+DA,XQADATA=+DA_U,XQAROU="ACTADD^TIUALRT"
"RTN","TIUALRT",161,0)
 S XQAMSG=TIUPNM_" ("_TIUSSN_"): ADDENDUM to "_TIUTITLE_" of "_TIUDATE_" by "_TIUESNM
"RTN","TIUALRT",162,0)
 D SETUP^XQALERT
"RTN","TIUALRT",163,0)
 Q
"RTN","TIUALRT",164,0)
ACTADD ; Act on ADDENDUM alerts
"RTN","TIUALRT",165,0)
 N TIUQUIK,TIUDA,TIUPRM0,TIUPRM1,TIUPRM3 S TIUQUIK=1 K XQAKILL
"RTN","TIUALRT",166,0)
 S TIUDA=$P(XQADATA,U),XQAKILL=1
"RTN","TIUALRT",167,0)
 I '$D(^TIU(8925,+TIUDA,0)) D ADDENDEL(TIUDA) Q
"RTN","TIUALRT",168,0)
 W !!,"A NEW Addendum has been added to your document...",!
"RTN","TIUALRT",169,0)
 W:$L($P($G(XQX),U,3)) !,$P($G(XQX),U,3),!
"RTN","TIUALRT",170,0)
 I '+$$READ^TIUU("YAO","Do you wish to Browse the Addendum now? ","NO") Q
"RTN","TIUALRT",171,0)
 D:'$D(TIUPRM0)!'$D(TIUPRM1) SETPARM^TIULE
"RTN","TIUALRT",172,0)
 D EN^VALM("TIU BROWSE FOR CLINICIAN")
"RTN","TIUALRT",173,0)
 Q
"RTN","TIUALRT",174,0)
ALERTDEL(DA) ; Delete alerts associated with a given document
"RTN","TIUALRT",175,0)
 N XQA,XQAID,XQAKILL S XQAID="TIU"_DA
"RTN","TIUALRT",176,0)
 D DELETEA^XQALERT
"RTN","TIUALRT",177,0)
 Q
"RTN","TIUALRT",178,0)
ADDENDEL(DA) ; Delete alert associated with a Addendum added
"RTN","TIUALRT",179,0)
 N XQA,XQAID,XQAKILL S XQAID="TIUADD"_DA
"RTN","TIUALRT",180,0)
 D DELETEA^XQALERT
"RTN","TIUALRT",181,0)
 Q
"RTN","TIUALRT",182,0)
ISSIGNR(DA,USER) ; Is USER an additional signer of document DA?
"RTN","TIUALRT",183,0)
 N TIUY,TIUSDA,TIUSD0 S (TIUY,TIUSDA)=0
"RTN","TIUALRT",184,0)
 S TIUSDA=+$O(^TIU(8925.7,"AE",DA,USER,0)) G:'TIUSDA ISSIGNX
"RTN","TIUALRT",185,0)
 S TIUSD0=$G(^TIU(8925.7,TIUSDA,0)) G:'$L(TIUSD0) ISSIGNX
"RTN","TIUALRT",186,0)
 I +$P(TIUSD0,U,4)'>0 S TIUY=1
"RTN","TIUALRT",187,0)
ISSIGNX Q TIUY
"RTN","TIURDIV")
0^1^B66574914^B58639766
"RTN","TIURDIV",1,0)
TIURDIV ; SLC/JAK - Review unsig/uncosig Documents by DIVISION ;04/27/11  13:14
"RTN","TIURDIV",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**113,259**;Jun 20, 1997;Build 4
"RTN","TIURDIV",3,0)
 ; Multidivisional Enhancements - from BUF/DCN - modified by SLC/JAK
"RTN","TIURDIV",4,0)
 ;
"RTN","TIURDIV",5,0)
BEGIN ; Select Division(s), Entry Date Range, Service, Type of Report
"RTN","TIURDIV",6,0)
 N TIUI,TIUSTDT,TIUENDT,TIUSVCS
"RTN","TIURDIV",7,0)
 D SELDIV^TIULA Q:SELDIV'>0
"RTN","TIURDIV",8,0)
 I $D(TIUDI) D
"RTN","TIURDIV",9,0)
 . S TIUI=0 F  S TIUI=$O(TIUDI(TIUI)) Q:'TIUI  D
"RTN","TIURDIV",10,0)
 . . S TIUDI("ENTRIES")=$G(TIUDI("ENTRIES"))_TIUI_";"
"RTN","TIURDIV",11,0)
 E  D
"RTN","TIURDIV",12,0)
 . S TIUDI("ENTRIES")="ALL DIVISIONS"
"RTN","TIURDIV",13,0)
 ;
"RTN","TIURDIV",14,0)
 ;Ask Date Range, exit if timeout, '^' or no selection
"RTN","TIURDIV",15,0)
 Q:'$$ASKRNG(.TIUSTDT,.TIUENDT)
"RTN","TIURDIV",16,0)
 ;
"RTN","TIURDIV",17,0)
 ;Select Service, exit if timeout, '^' or no selection
"RTN","TIURDIV",18,0)
 Q:'$$SELSVC^TIULA(.TIUSVCS)
"RTN","TIURDIV",19,0)
 ;
"RTN","TIURDIV",20,0)
 N DIR,DIRUT,DTOUT,DUOUT,TIURPT
"RTN","TIURDIV",21,0)
 S DIR(0)="S^F:FULL;S:SUMMARY",DIR("A")="Type of Report"
"RTN","TIURDIV",22,0)
 S DIR("?",1)="Summary lists the number of documents by author's"
"RTN","TIURDIV",23,0)
 S DIR("?",2)="service/section. Full lists detailed document"
"RTN","TIURDIV",24,0)
 S DIR("?",3)="information by author's service/section."
"RTN","TIURDIV",25,0)
 S DIR("?")="Enter ""^"", or a RETURN to quit."
"RTN","TIURDIV",26,0)
 D ^DIR Q:$D(DIRUT)  S TIURPT=Y K Y
"RTN","TIURDIV",27,0)
 I TIURPT="F" W !!,"This report must be sent to a 132-column device.",!
"RTN","TIURDIV",28,0)
 ;
"RTN","TIURDIV",29,0)
DEV ; Device selection
"RTN","TIURDIV",30,0)
 S %ZIS="Q" W ! D ^%ZIS I POP K POP G EXIT
"RTN","TIURDIV",31,0)
 I TIURPT="F",IOM'>131 W !!,"You must select a 132-column device." G DEV
"RTN","TIURDIV",32,0)
 I $D(IO("Q")) D  G EXIT
"RTN","TIURDIV",33,0)
 . S ZTRTN="BUILD^TIURDIV"
"RTN","TIURDIV",34,0)
 . S ZTSAVE("TIUDI(")="",ZTSAVE("TIURPT")=""
"RTN","TIURDIV",35,0)
 . S ZTSAVE("TIUSTDT")="",ZTSAVE("TIUENDT")=""
"RTN","TIURDIV",36,0)
 . S ZTSAVE("TIUSVCS")="",ZTSAVE("TIUSVCS(")=""
"RTN","TIURDIV",37,0)
 . S ZTDESC="TIU UNSIG/UNCOSIG DOCS BY DIV"
"RTN","TIURDIV",38,0)
 . D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
"RTN","TIURDIV",39,0)
 . K ZTSK,ZTDESC,ZTRTN,ZTSAVE,%ZIS,TIUDIV,TIURPT,TIUIFP
"RTN","TIURDIV",40,0)
 . D HOME^%ZIS
"RTN","TIURDIV",41,0)
 U IO D BUILD,^%ZISC
"RTN","TIURDIV",42,0)
 Q
"RTN","TIURDIV",43,0)
BUILD ; Build list
"RTN","TIURDIV",44,0)
 N TIUIFP,TIUK
"RTN","TIURDIV",45,0)
 K ^TMP("TIUD",$J)
"RTN","TIURDIV",46,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","TIURDIV",47,0)
 I +$G(TIUDI("ENTRIES")) D
"RTN","TIURDIV",48,0)
 . S TIUK=0 F  S TIUK=$O(TIUDI(TIUK)) Q:'TIUK  D
"RTN","TIURDIV",49,0)
 . . S TIUIFP=$G(TIUDI(TIUK))
"RTN","TIURDIV",50,0)
 . . D GATHER(TIUIFP,TIUSTDT,TIUENDT,.TIUSVCS)
"RTN","TIURDIV",51,0)
 E  D
"RTN","TIURDIV",52,0)
 . S TIUIFP=0
"RTN","TIURDIV",53,0)
 . F  S TIUIFP=$O(^TIU(8925,"ADIV",TIUIFP)) Q:+TIUIFP'>0  D
"RTN","TIURDIV",54,0)
 . . D GATHER(TIUIFP,TIUSTDT,TIUENDT,.TIUSVCS)
"RTN","TIURDIV",55,0)
 D PRINT(TIUSTDT,TIUENDT)
"RTN","TIURDIV",56,0)
 ;
"RTN","TIURDIV",57,0)
EXIT ; Clean up and exit
"RTN","TIURDIV",58,0)
 K SELDIV,TIUDI,TIUSTDT,TIUENDT,TIUSVCS K ^TMP("TIUD",$J)
"RTN","TIURDIV",59,0)
 Q
"RTN","TIURDIV",60,0)
GATHER(TIUIFP,TIUSTDT,TIUENDT,TIUSVCS) ; Find records for the list
"RTN","TIURDIV",61,0)
 ; Input   -- TIUIFP  INSTITUTION file (#4) IEN
"RTN","TIURDIV",62,0)
 ;            (0 = gather all divisions)
"RTN","TIURDIV",63,0)
 ;            TIUSTDT Start Date
"RTN","TIURDIV",64,0)
 ;            TIUENDT End Date
"RTN","TIURDIV",65,0)
 ;            TIUSVCS Service Selection Array
"RTN","TIURDIV",66,0)
 ; Output  -- None
"RTN","TIURDIV",67,0)
 N TIUDA,TIUJ,TIUS,TIUTP
"RTN","TIURDIV",68,0)
 S TIUTP=0
"RTN","TIURDIV",69,0)
 F  S TIUTP=$O(^TIU(8925,"ADIV",TIUIFP,TIUTP)) Q:+TIUTP'>0  D
"RTN","TIURDIV",70,0)
 . S TIUS=4
"RTN","TIURDIV",71,0)
 . F  S TIUS=$O(^TIU(8925,"ADIV",TIUIFP,TIUTP,TIUS)) Q:+TIUS'>0!(+TIUS>6)  D
"RTN","TIURDIV",72,0)
 . . S TIUJ=0
"RTN","TIURDIV",73,0)
 . . F  S TIUJ=$O(^TIU(8925,"ADIV",TIUIFP,TIUTP,TIUS,TIUJ)) Q:+TIUJ'>0  D
"RTN","TIURDIV",74,0)
 . . . S TIUDA=0
"RTN","TIURDIV",75,0)
 . . . F  S TIUDA=$O(^TIU(8925,"ADIV",TIUIFP,TIUTP,TIUS,TIUJ,TIUDA)) Q:+TIUDA'>0  D
"RTN","TIURDIV",76,0)
 . . . . D ADDELMNT(TIUDA,TIUSTDT,TIUENDT,.TIUSVCS)
"RTN","TIURDIV",77,0)
 Q
"RTN","TIURDIV",78,0)
 ;
"RTN","TIURDIV",79,0)
ADDELMNT(TIUDA,TIUSTDT,TIUENDT,TIUSVCS) ; Add each element to the list
"RTN","TIURDIV",80,0)
 ; Input  -- TIUDA   TIU DOCUMENT file (#8925) IEN
"RTN","TIURDIV",81,0)
 ;           TIUSTDT Start Date
"RTN","TIURDIV",82,0)
 ;           TIUENDT End Date
"RTN","TIURDIV",83,0)
 ;           TIUSVCS Service Selection Array
"RTN","TIURDIV",84,0)
 ; Output -- None
"RTN","TIURDIV",85,0)
 N TIUAU,TIUD12,TIUEDT,TIUIFP,TIUSVC
"RTN","TIURDIV",86,0)
 N TIUD0,TIUECS,TIUAUECS,TIUS
"RTN","TIURDIV",87,0)
 Q:'$G(^TIU(8925,TIUDA,0))
"RTN","TIURDIV",88,0)
 S TIUD0=^TIU(8925,TIUDA,0),TIUS=$P(TIUD0,U,5)
"RTN","TIURDIV",89,0)
 S TIUD12=$G(^TIU(8925,TIUDA,12)),TIUAU=+$P(TIUD12,U,2),TIUECS=+$P(TIUD12,U,8)
"RTN","TIURDIV",90,0)
 S TIUAUECS=$S(TIUS=6:TIUECS,1:TIUAU) Q:TIUAUECS']0
"RTN","TIURDIV",91,0)
 S TIUEDT=+$P(TIUD12,U),TIUIFP=+$P(TIUD12,U,12)
"RTN","TIURDIV",92,0)
 ;Check Date Range
"RTN","TIURDIV",93,0)
 I TIUEDT,TIUEDT>TIUSTDT,TIUEDT<TIUENDT D
"RTN","TIURDIV",94,0)
 . S TIUSVC=$$PROVSVC^TIULV(TIUAUECS)
"RTN","TIURDIV",95,0)
 . ;Check Service
"RTN","TIURDIV",96,0)
 . I $G(TIUSVCS)="ALL"!($D(TIUSVCS(+TIUSVC))) D
"RTN","TIURDIV",97,0)
 . . S TIUAUECS=$$PERSNAME^TIULC1(TIUAUECS)
"RTN","TIURDIV",98,0)
 . . I $P(TIUSVC,U,2)]"" D
"RTN","TIURDIV",99,0)
 . . . S TIUSVC=$P(TIUSVC,U,2)
"RTN","TIURDIV",100,0)
 . . E  D
"RTN","TIURDIV",101,0)
 . . . S TIUSVC="UNKNOWN"
"RTN","TIURDIV",102,0)
 . . I TIUAUECS'="UNKNOWN" S TIUAUECS=$$NAME^TIULS(TIUAUECS,"LAST, FI MI")
"RTN","TIURDIV",103,0)
 . . S ^TMP("TIUD",$J,TIUIFP,TIUSVC,TIUAUECS,TIUEDT)=TIUDA
"RTN","TIURDIV",104,0)
 Q
"RTN","TIURDIV",105,0)
 ;
"RTN","TIURDIV",106,0)
PRINT(TIUSTDT,TIUENDT) ; Display/print the output
"RTN","TIURDIV",107,0)
 ; Input  -- TIUSTDT Start Date
"RTN","TIURDIV",108,0)
 ;           TIUENDT End Date
"RTN","TIURDIV",109,0)
 ; Output -- None
"RTN","TIURDIV",110,0)
 N GTCT,ICT,SCT,TIUAU,TIUDA,TIUECS,TIUEDT
"RTN","TIURDIV",111,0)
 N TIUIFP,TIULST4,TIUOUT,TIUPG,TIUPT,TIUSVC,TIUTP
"RTN","TIURDIV",112,0)
 N TIUAUECS
"RTN","TIURDIV",113,0)
 S (GTCT(5),GTCT(6),TIUIFP,TIUPG,TIUOUT)=0
"RTN","TIURDIV",114,0)
 I '$D(^TMP("TIUD",$J)) W !!,"NO Unsigned/Uncosigned Documents!!" Q
"RTN","TIURDIV",115,0)
 F  S TIUIFP=$O(^TMP("TIUD",$J,TIUIFP)) Q:TIUIFP=""!(TIUOUT)  D HDR(TIUIFP,TIUSTDT,TIUENDT) D
"RTN","TIURDIV",116,0)
 . S (ICT(TIUIFP,5),ICT(TIUIFP,6))=0 S TIUSVC=""
"RTN","TIURDIV",117,0)
 . F  S TIUSVC=$O(^TMP("TIUD",$J,TIUIFP,TIUSVC)) Q:TIUSVC=""!(TIUOUT)  D
"RTN","TIURDIV",118,0)
 . . I $Y>(IOSL-5) D ASK Q:TIUOUT  D HDR(TIUIFP,TIUSTDT,TIUENDT)
"RTN","TIURDIV",119,0)
 . . D FHDR(TIUSVC):TIURPT="F"
"RTN","TIURDIV",120,0)
 . . S (SCT(TIUIFP,TIUSVC,5),SCT(TIUIFP,TIUSVC,6))=0 S TIUAUECS=""
"RTN","TIURDIV",121,0)
 . . F  S TIUAUECS=$O(^TMP("TIUD",$J,TIUIFP,TIUSVC,TIUAUECS)) Q:TIUAUECS=""!(TIUOUT)  D
"RTN","TIURDIV",122,0)
 . . . S TIUEDT=0
"RTN","TIURDIV",123,0)
 . . . F  S TIUEDT=$O(^TMP("TIUD",$J,TIUIFP,TIUSVC,TIUAUECS,TIUEDT)) Q:TIUEDT=""!(TIUOUT)  D
"RTN","TIURDIV",124,0)
 . . . . S TIUDA=+$G(^TMP("TIUD",$J,TIUIFP,TIUSVC,TIUAUECS,TIUEDT))
"RTN","TIURDIV",125,0)
 . . . . D PRTELMNT(TIUDA,TIUIFP,TIUSVC,TIUAUECS,TIUEDT,TIUSTDT,TIUENDT)
"RTN","TIURDIV",126,0)
 . . . . ;
"RTN","TIURDIV",127,0)
 . . Q:TIUOUT
"RTN","TIURDIV",128,0)
 . . I $Y>(IOSL-5) D ASK Q:TIUOUT  D HDR(TIUIFP,TIUSTDT,TIUENDT),FHDR(TIUSVC):TIURPT="F"
"RTN","TIURDIV",129,0)
 . . W !!," Totals for Service: ",$E(TIUSVC,1,25),"---"
"RTN","TIURDIV",130,0)
 . . W " UNSIGNED: ",$G(SCT(TIUIFP,TIUSVC,5))
"RTN","TIURDIV",131,0)
 . . W "  UNCOSIGNED: ",$G(SCT(TIUIFP,TIUSVC,6))
"RTN","TIURDIV",132,0)
 . Q:TIUOUT
"RTN","TIURDIV",133,0)
 . I $Y>(IOSL-5) D ASK Q:TIUOUT  D HDR(TIUIFP,TIUSTDT,TIUENDT)
"RTN","TIURDIV",134,0)
 . W !!,"Totals for Division: ",$E($P($$NS^XUAF4(TIUIFP),U),1,25),"---"
"RTN","TIURDIV",135,0)
 . W " UNSIGNED: ",$G(ICT(TIUIFP,5))
"RTN","TIURDIV",136,0)
 . W "  UNCOSIGNED: ",$G(ICT(TIUIFP,6))
"RTN","TIURDIV",137,0)
 . S GTCT(5)=GTCT(5)+ICT(TIUIFP,5),GTCT(6)=GTCT(6)+ICT(TIUIFP,6)
"RTN","TIURDIV",138,0)
 . D ASK Q:TIUOUT
"RTN","TIURDIV",139,0)
 Q:TIUOUT
"RTN","TIURDIV",140,0)
 S TIUIFP="ALL" D HDR(TIUIFP,TIUSTDT,TIUENDT)
"RTN","TIURDIV",141,0)
 W !!,"GRAND Totals (All Divisions)--- UNSIGNED: ",+$G(GTCT(5))
"RTN","TIURDIV",142,0)
 W "  UNCOSIGNED: ",+$G(GTCT(6))
"RTN","TIURDIV",143,0)
 Q
"RTN","TIURDIV",144,0)
PRTELMNT(TIUDA,TIUIFP,TIUSVC,TIUAUECS,TIUEDT,TIUSTDT,TIUENDT) ; Print each element
"RTN","TIURDIV",145,0)
 ; Input  -- TIUDA   TIU DOCUMENT file (#8925) IEN
"RTN","TIURDIV",146,0)
 ;           TIUIFP  INSTITUTION file (#4) IEN
"RTN","TIURDIV",147,0)
 ;           TIUSVC  SERVICE/SECTION file (#49) NAME
"RTN","TIURDIV",148,0)
 ;           TIUAUECS   AUTHOR/ExpCos NAME
"RTN","TIURDIV",149,0)
 ;           TIUEDT  Inverse REFERENCE DATE
"RTN","TIURDIV",150,0)
 ;           TIUSTDT Start Date
"RTN","TIURDIV",151,0)
 ;           TIUENDT End Date
"RTN","TIURDIV",152,0)
 ; Output -- None
"RTN","TIURDIV",153,0)
 N TIUD0,TIUD12,TIUS
"RTN","TIURDIV",154,0)
 S TIUD0=$G(^TIU(8925,TIUDA,0)),TIUD12=$G(^TIU(8925,TIUDA,12))
"RTN","TIURDIV",155,0)
 S TIUS=+$P(TIUD0,U,5) I TIUS'=5,TIUS'=6 Q
"RTN","TIURDIV",156,0)
 S ICT(TIUIFP,TIUS)=ICT(TIUIFP,TIUS)+1
"RTN","TIURDIV",157,0)
 S SCT(TIUIFP,TIUSVC,TIUS)=SCT(TIUIFP,TIUSVC,TIUS)+1
"RTN","TIURDIV",158,0)
 I $Y>(IOSL-5) D ASK Q:TIUOUT  D HDR(TIUIFP,TIUSTDT,TIUENDT),FHDR(TIUSVC):TIURPT="F"
"RTN","TIURDIV",159,0)
 I TIURPT="F" D
"RTN","TIURDIV",160,0)
 . S TIUPT=+$P(TIUD0,U,2),TIULST4=$E($$GET1^DIQ(2,TIUPT,.09),6,9)
"RTN","TIURDIV",161,0)
 . S TIUTP=+$P(TIUD0,U),TIUECS=+$P(TIUD12,U,8),TIUAU=+$P(TIUD12,U,2)
"RTN","TIURDIV",162,0)
 . ;I TIUS=6 S TIUAUECS="["_TIUAUECS_"]"
"RTN","TIURDIV",163,0)
 . W !,$G(TIUAUECS)
"RTN","TIURDIV",164,0)
 . W ?17,$S(TIUPT:$E($$EXTERNAL^DILFD(8925,.02,"",TIUPT),1,14),1:"UNK")
"RTN","TIURDIV",165,0)
 . W ?32,$S(TIULST4]"":$G(TIULST4),1:"UNK")
"RTN","TIURDIV",166,0)
 . W ?39,$E($$EXTERNAL^DILFD(8925,.05,"",TIUS),1,10)
"RTN","TIURDIV",167,0)
 . ;W ?53,$S(TIUEDT>0:$$FMTE^XLFDT(TIUEDT,2),1:"UNK")
"RTN","TIURDIV",168,0)
 . W ?50,$S(TIUEDT>0:$$DATE^TIULS(TIUEDT,"MM/DD/YY"),1:"UNK")
"RTN","TIURDIV",169,0)
 . ;W ?71,$G(TIUDA)
"RTN","TIURDIV",170,0)
 . W ?60,$G(TIUDA)
"RTN","TIURDIV",171,0)
 . W ?74,$S(TIUTP:$E($$EXTERNAL^DILFD(8925,.01,"",TIUTP),1,15),1:"UNK")
"RTN","TIURDIV",172,0)
 . I TIUS=5,TIUECS>0 S TIUECS=$E($$EXTERNAL^DILFD(8925,1208,"",TIUECS),1,13) W ?91,TIUECS
"RTN","TIURDIV",173,0)
 . I TIUS=6 S TIUAU=$E($$EXTERNAL^DILFD(8925,1202,"",TIUAU),1,13) W ?104,TIUAU
"RTN","TIURDIV",174,0)
 . ;W ?102,$S((TIUS=5)&(TIUECS]""):TIUECS,TIUS=6:TIUAU,1:"")
"RTN","TIURDIV",175,0)
 . W ?119,$$PRNT(TIUDA)
"RTN","TIURDIV",176,0)
 Q
"RTN","TIURDIV",177,0)
ASK ; End of page
"RTN","TIURDIV",178,0)
 I IO=IO(0),$E(IOST)="C" D
"RTN","TIURDIV",179,0)
 . W ! N DIR,Y S DIR(0)="E" D ^DIR K DIR
"RTN","TIURDIV",180,0)
 . I Y=""!(Y=0) S TIUOUT=1
"RTN","TIURDIV",181,0)
 Q
"RTN","TIURDIV",182,0)
HDR(TIUIFP,TIUSTDT,TIUENDT) ; Page (Division) Header
"RTN","TIURDIV",183,0)
 ; Input   -- TIUIFP  INSTITUTION file (#4) IEN
"RTN","TIURDIV",184,0)
 ;            TIUSTDT Start Date
"RTN","TIURDIV",185,0)
 ;            TIUENDT End Date
"RTN","TIURDIV",186,0)
 ; Output  -- None
"RTN","TIURDIV",187,0)
 N LNE,TIUR,TIUINST,TIURNG
"RTN","TIURDIV",188,0)
 S TIUPG=(+$G(TIUPG))+1
"RTN","TIURDIV",189,0)
 D DT^DILF("ET","NOW",.TIUR)
"RTN","TIURDIV",190,0)
 S TIURNG=$$FMTE^XLFDT(TIUSTDT)_" thru "_$$FMTE^XLFDT(TIUENDT)
"RTN","TIURDIV",191,0)
 S TIUINST=$S(TIUIFP:$P($$NS^XUAF4(TIUIFP),U),1:"ALL DIVISIONS")
"RTN","TIURDIV",192,0)
 W @IOF,?26,"Unsigned and Uncosigned Documents "_TIURNG,?(IOM-10)
"RTN","TIURDIV",193,0)
 W "Page ",+$G(TIUPG),!,"PRINTED:",?26,"for ",TIUINST,!,TIUR(0)
"RTN","TIURDIV",194,0)
 W ! S LNE="",$P(LNE,"-",(IOM-1))="" W LNE
"RTN","TIURDIV",195,0)
 I TIURPT="F" D
"RTN","TIURDIV",196,0)
 . W !,"AUTHOR/EXP COS",?17,"PATIENT",?25,"LAST4",?39,"STATUS"
"RTN","TIURDIV",197,0)
 . W ?50,"ENTRY DT",?60,"IEN",?74,"DOC TYPE"
"RTN","TIURDIV",198,0)
 . W ?91,"EXP COSGNR",?104,"AUTHOR",?119,"PARENT IEN",!,LNE
"RTN","TIURDIV",199,0)
 Q
"RTN","TIURDIV",200,0)
FHDR(TIUSVC) ; Service Header
"RTN","TIURDIV",201,0)
 ; Input   -- TIUSVC  SERVICE/SECTION file (#49) NAME
"RTN","TIURDIV",202,0)
 ; Output  -- None
"RTN","TIURDIV",203,0)
 W !!?10,"SERVICE: ",TIUSVC
"RTN","TIURDIV",204,0)
 Q
"RTN","TIURDIV",205,0)
PRNT(TIUDA) ; Does document have a parent?
"RTN","TIURDIV",206,0)
 ; Input  -- TIUDA    TIU Document file (#8925) IEN
"RTN","TIURDIV",207,0)
 ; Output -- TIUPRNT  Null= TIU Document file (#8925) entry does
"RTN","TIURDIV",208,0)
 ;                          not have a parent
"RTN","TIURDIV",209,0)
 ;                    Exists= TIU Document file (#8925) entry is
"RTN","TIURDIV",210,0)
 ;                            an addendum or ID child.
"RTN","TIURDIV",211,0)
 ;                            Value: Parent TIU Document file
"RTN","TIURDIV",212,0)
 ;                                   (#8925) IEN
"RTN","TIURDIV",213,0)
 N ADDMPRNT,IDPRNT,TIUPRNT
"RTN","TIURDIV",214,0)
 S TIUPRNT=""
"RTN","TIURDIV",215,0)
 S ADDMPRNT=+$P($G(^TIU(8925,TIUDA,0)),U,6) ; Addm parent
"RTN","TIURDIV",216,0)
 I '$D(^TIU(8925,ADDMPRNT,0)) S ADDMPRNT=0
"RTN","TIURDIV",217,0)
 I ADDMPRNT D
"RTN","TIURDIV",218,0)
 . S TIUPRNT=ADDMPRNT
"RTN","TIURDIV",219,0)
 E  D
"RTN","TIURDIV",220,0)
 . S IDPRNT=+$G(^TIU(8925,TIUDA,21)) ; ID parent
"RTN","TIURDIV",221,0)
 . I '$D(^TIU(8925,IDPRNT,0)) S IDPRNT=0
"RTN","TIURDIV",222,0)
 . I IDPRNT D
"RTN","TIURDIV",223,0)
 . . S TIUPRNT=IDPRNT
"RTN","TIURDIV",224,0)
 Q TIUPRNT
"RTN","TIURDIV",225,0)
 ;
"RTN","TIURDIV",226,0)
ASKRNG(STDT,ENDT) ;Prompt for entry date range
"RTN","TIURDIV",227,0)
 ; Input  -- None
"RTN","TIURDIV",228,0)
 ; Output -- 1=Successful and 0=Failure
"RTN","TIURDIV",229,0)
 ;           STDT  Start Date
"RTN","TIURDIV",230,0)
 ;           ENDT  End Date
"RTN","TIURDIV",231,0)
 N DIRUT,DTOUT,DUOUT,Y
"RTN","TIURDIV",232,0)
 W !!,"Please specify an Entry Date Range:",!
"RTN","TIURDIV",233,0)
 S STDT=+$$READ^TIUU("DA^:DT:E"," Start Entry Date: ")
"RTN","TIURDIV",234,0)
 I $D(DIRUT)!(STDT'>0) G ASKRNGQ
"RTN","TIURDIV",235,0)
 S ENDT=+$$READ^TIUU("DA^"_STDT_":DT:E","Ending Entry Date: ")_"."_235959
"RTN","TIURDIV",236,0)
 I $D(DIRUT)!(ENDT'>0) G ASKRNGQ
"RTN","TIURDIV",237,0)
 S Y=1
"RTN","TIURDIV",238,0)
ASKRNGQ Q +$G(Y)
"VER")
8.0^22.0
"BLD",8064,6)
^245
**END**
**END**
