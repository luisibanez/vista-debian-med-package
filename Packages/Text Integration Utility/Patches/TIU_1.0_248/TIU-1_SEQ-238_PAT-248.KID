Released TIU*1*248 SEQ #238
Extracted from mail message
**KIDS**:TIU*1.0*248^

**INSTALL NAME**
TIU*1.0*248
"BLD",8110,0)
TIU*1.0*248^TEXT INTEGRATION UTILITIES^0^3100720^y
"BLD",8110,1,0)
^^5^5^3100720^^
"BLD",8110,1,1,0)
This patch related to Remedy 277123 and PSPO 1093.  The TIU option TIU 
"BLD",8110,1,2,0)
MISSING TEXT CLEANUP retracts documents and therefore should be 
"BLD",8110,1,3,0)
restricted to users who hold security key TIU MISSING TEXT CLEAN.
"BLD",8110,1,4,0)
Security key TIU MISSING TEXT CLEAN should only be assigned to someone
"BLD",8110,1,5,0)
that holds Chief,MIS or Chief, HIM class in USR.
"BLD",8110,4,0)
^9.64PA^^
"BLD",8110,6.3)
10
"BLD",8110,"ABPKG")
n
"BLD",8110,"KRN",0)
^9.67PA^779.2^20
"BLD",8110,"KRN",.4,0)
.4
"BLD",8110,"KRN",.401,0)
.401
"BLD",8110,"KRN",.402,0)
.402
"BLD",8110,"KRN",.403,0)
.403
"BLD",8110,"KRN",.5,0)
.5
"BLD",8110,"KRN",.84,0)
.84
"BLD",8110,"KRN",3.6,0)
3.6
"BLD",8110,"KRN",3.8,0)
3.8
"BLD",8110,"KRN",9.2,0)
9.2
"BLD",8110,"KRN",9.8,0)
9.8
"BLD",8110,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8110,"KRN",9.8,"NM",1,0)
TIUPS177^^0^B8414102
"BLD",8110,"KRN",9.8,"NM","B","TIUPS177",1)

"BLD",8110,"KRN",19,0)
19
"BLD",8110,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",8110,"KRN",19,"NM",1,0)
TIU MAIN MENU MGR^^3
"BLD",8110,"KRN",19,"NM",2,0)
TIU MISSING TEXT CLEAN^^0
"BLD",8110,"KRN",19,"NM","B","TIU MAIN MENU MGR",1)

"BLD",8110,"KRN",19,"NM","B","TIU MISSING TEXT CLEAN",2)

"BLD",8110,"KRN",19.1,0)
19.1
"BLD",8110,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",8110,"KRN",19.1,"NM",1,0)
TIU MISSING TEXT CLEAN^^0
"BLD",8110,"KRN",19.1,"NM","B","TIU MISSING TEXT CLEAN",1)

"BLD",8110,"KRN",101,0)
101
"BLD",8110,"KRN",409.61,0)
409.61
"BLD",8110,"KRN",771,0)
771
"BLD",8110,"KRN",779.2,0)
779.2
"BLD",8110,"KRN",870,0)
870
"BLD",8110,"KRN",8989.51,0)
8989.51
"BLD",8110,"KRN",8989.52,0)
8989.52
"BLD",8110,"KRN",8994,0)
8994
"BLD",8110,"KRN","B",.4,.4)

"BLD",8110,"KRN","B",.401,.401)

"BLD",8110,"KRN","B",.402,.402)

"BLD",8110,"KRN","B",.403,.403)

"BLD",8110,"KRN","B",.5,.5)

"BLD",8110,"KRN","B",.84,.84)

"BLD",8110,"KRN","B",3.6,3.6)

"BLD",8110,"KRN","B",3.8,3.8)

"BLD",8110,"KRN","B",9.2,9.2)

"BLD",8110,"KRN","B",9.8,9.8)

"BLD",8110,"KRN","B",19,19)

"BLD",8110,"KRN","B",19.1,19.1)

"BLD",8110,"KRN","B",101,101)

"BLD",8110,"KRN","B",409.61,409.61)

"BLD",8110,"KRN","B",771,771)

"BLD",8110,"KRN","B",779.2,779.2)

"BLD",8110,"KRN","B",870,870)

"BLD",8110,"KRN","B",8989.51,8989.51)

"BLD",8110,"KRN","B",8989.52,8989.52)

"BLD",8110,"KRN","B",8994,8994)

"BLD",8110,"QDEF")
^^^^^^^^^^YES
"BLD",8110,"QUES",0)
^9.62^^
"BLD",8110,"REQB",0)
^9.611^1^1
"BLD",8110,"REQB",1,0)
TIU*1.0*177^1
"BLD",8110,"REQB","B","TIU*1.0*177",1)

"KRN",19,10823,-1)
3^1
"KRN",19,10823,0)
TIU MAIN MENU MGR^Text Integration Utilities (MIS Manager)^^M^^^^^^^y^TEXT INTEGRATION UTILITIES^^1^^^1
"KRN",19,10823,1,0)
^19.06^1^1^3071109^^^^
"KRN",19,10823,1,1,0)
Main Text Integration Utilities menu for MIS Managers.
"KRN",19,10823,10,0)
^19.01IP^21^21
"KRN",19,10823,10,15,0)
12329^8^8
"KRN",19,10823,10,15,"^")
TIU MISSING TEXT CLEAN
"KRN",19,10823,15)

"KRN",19,10823,20)
S GMRPEN=1 D EDITSAVE^TIUEDI2(.DUZ)
"KRN",19,10823,26)
W !!,$$CENTER^TIULS("--- MIS Managers Menu ---")
"KRN",19,10823,99)
61571,46267
"KRN",19,10823,99.1)
60940,46533
"KRN",19,10823,"U")
TEXT INTEGRATION UTILITIES (MI
"KRN",19,12329,-1)
0^2
"KRN",19,12329,0)
TIU MISSING TEXT CLEAN^Missing Text Cleanup^^R^^TIU MISSING TEXT CLEAN^^^^^^TEXT INTEGRATION UTILITIES^^^1
"KRN",19,12329,15)
W ! I $$READ^TIUU("E","Press RETURN to continue...")
"KRN",19,12329,25)
EN^TIUPS177
"KRN",19,12329,"U")
MISSING TEXT CLEANUP
"KRN",19.1,584,-1)
0^1
"KRN",19.1,584,0)
TIU MISSING TEXT CLEAN^TIU MISSING TEXT CLEAN
"KRN",19.1,584,1,0)
^19.11^3^3^3090924^^^^
"KRN",19.1,584,1,1,0)
This key allows the holder to run the option MISSING TEXT CLEANUP.  It 
"KRN",19.1,584,1,2,0)
should only be assigned to someone that holds Chief, MIS or Chief, HIMS 
"KRN",19.1,584,1,3,0)
class in the AUTHORIZATION/SUBSCRIPTION package (USR).
"KRN",19.1,584,4)
I $$RUN^TIUPS177(+($G(Y)))
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",470,-1)
1^1
"PKG",470,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",470,20,0)
^9.402P^^
"PKG",470,22,0)
^9.49I^1^1
"PKG",470,22,1,0)
1.0^3010801^3010806^66481
"PKG",470,22,1,"PAH",1,0)
248^3100720
"PKG",470,22,1,"PAH",1,1,0)
^^5^5^3100720
"PKG",470,22,1,"PAH",1,1,1,0)
This patch related to Remedy 277123 and PSPO 1093.  The TIU option TIU 
"PKG",470,22,1,"PAH",1,1,2,0)
MISSING TEXT CLEANUP retracts documents and therefore should be 
"PKG",470,22,1,"PAH",1,1,3,0)
restricted to users who hold security key TIU MISSING TEXT CLEAN.
"PKG",470,22,1,"PAH",1,1,4,0)
Security key TIU MISSING TEXT CLEAN should only be assigned to someone
"PKG",470,22,1,"PAH",1,1,5,0)
that holds Chief,MIS or Chief, HIM class in USR.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","TIUPS177")
0^1^B8414102^B7224355
"RTN","TIUPS177",1,0)
TIUPS177 ; SLC/AJB - Blank Doc Cleanup ; 06/12/04
"RTN","TIUPS177",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**177,248**;Jun 20, 1997;Build 10
"RTN","TIUPS177",3,0)
 ;
"RTN","TIUPS177",4,0)
 Q
"RTN","TIUPS177",5,0)
EN ; control segment
"RTN","TIUPS177",6,0)
 I '$$RUN^TIUPS177(+($G(DUZ))) W !!,"You are not authorized to run this report" Q
"RTN","TIUPS177",7,0)
 N ANS
"RTN","TIUPS177",8,0)
 W @IOF
"RTN","TIUPS177",9,0)
 D ASKUSER(.ANS) Q:$G(ANS("EXIT"))="YES"
"RTN","TIUPS177",10,0)
 D
"RTN","TIUPS177",11,0)
 .N ZTDESC,ZTRTN,ZTSAVE,ZTIO,ZTSK
"RTN","TIUPS177",12,0)
 .S ZTDESC="TIUPS177 Blank Note Text Cleanup",ZTRTN="CLEAN^TIUPS177",ZTSAVE("*")="",ZTIO=""
"RTN","TIUPS177",13,0)
 .W ! D ^%ZTLOAD I '$D(ZTSK) Q
"RTN","TIUPS177",14,0)
 .W !!,"Your task # is:  ",ZTSK,!
"RTN","TIUPS177",15,0)
EXIT Q
"RTN","TIUPS177",16,0)
ASKUSER(ANS) ;
"RTN","TIUPS177",17,0)
 N %DT,CNT,POP,X,Y
"RTN","TIUPS177",18,0)
 S %DT="AE",%DT(0)=$$NOW^XLFDT*-1
"RTN","TIUPS177",19,0)
 F CNT=1:1:2 D
"RTN","TIUPS177",20,0)
 . S %DT("A")=$S(CNT=1:"START WITH REFERENCE DATE:  ",CNT=2:"     GO TO REFERENCE DATE:  ")
"RTN","TIUPS177",21,0)
 . S %DT("B")=$S(CNT=1:"Jan 01, 2003",CNT=2:$P($$HTE^XLFDT($H),"@"))
"RTN","TIUPS177",22,0)
 . D ^%DT
"RTN","TIUPS177",23,0)
 . I Y=-1 S CNT=2,ANS("EXIT")="YES" Q
"RTN","TIUPS177",24,0)
 . I CNT=1 S ANS("BEGDT")=$$DATE(Y,CNT),%DT(0)=ANS("BEGDT") Q
"RTN","TIUPS177",25,0)
 . S ANS("ENDDT")=$$DATE(Y,CNT),X=$P($$NOW^XLFDT,".")_".24" I ANS("ENDDT")>X S CNT=1
"RTN","TIUPS177",26,0)
 Q
"RTN","TIUPS177",27,0)
IFTEXT() ;
"RTN","TIUPS177",28,0)
 N TIUCHK
"RTN","TIUPS177",29,0)
 S TIUCHK=0 F  S TIUCHK=$O(^TIU(8925,DA,"TEXT",TIUCHK)) Q:TIUCHK=""!TIUCHK>0
"RTN","TIUPS177",30,0)
 Q TIUCHK
"RTN","TIUPS177",31,0)
DATE(TIUDT,TIUSEQ) ;
"RTN","TIUPS177",32,0)
 I TIUDT["0000" S TIUDT=TIUDT/10000,TIUDT=TIUDT_$S(TIUSEQ=1:"0101",TIUSEQ=2:"1231")
"RTN","TIUPS177",33,0)
 I TIUSEQ=2 S TIUDT=TIUDT_".24"
"RTN","TIUPS177",34,0)
 Q TIUDT
"RTN","TIUPS177",35,0)
CLEAN ;
"RTN","TIUPS177",36,0)
 N DA,DR,DIE,N,TIUDT
"RTN","TIUPS177",37,0)
 S DA="",N=8925,TIUDT=ANS("BEGDT")
"RTN","TIUPS177",38,0)
 F  S TIUDT=$O(^TIU(N,"F",TIUDT)) Q:TIUDT=""!(TIUDT>ANS("ENDDT"))  F  S DA=$O(^TIU(N,"F",TIUDT,DA)) Q:DA=""  I '$D(^TIU(8925,"DAD",DA)),'$D(^TIU(8925.91,"ADI",DA)),'$D(^TIU(N,DA,"TEXT",0)),$P($G(^TIU(8925,DA,0)),U,5)>5,'$$IFTEXT D
"RTN","TIUPS177",39,0)
 . I $P($G(^TIU(8925,DA,0)),U,5)=15 Q
"RTN","TIUPS177",40,0)
 . N TIUCODE,TIUNOW
"RTN","TIUPS177",41,0)
 . S TIUCODE="A",TIUNOW=$$NOW^XLFDT,DIE=8925,DR=".05////15;1610////^S X=+DUZ;1611////^S X=TIUNOW;1612////^S X=TIUCODE"
"RTN","TIUPS177",42,0)
 . L +^TIU(8925,DA):0 I $T D ^DIE,AUDIT L -^TIU(8925,DA)
"RTN","TIUPS177",43,0)
 S XQA(DUZ)="",XQAMSG="TIUPS177 has finished."
"RTN","TIUPS177",44,0)
 D SETUP^XQALERT
"RTN","TIUPS177",45,0)
 Q
"RTN","TIUPS177",46,0)
AUDIT ;
"RTN","TIUPS177",47,0)
 N TIU,TIUIEN,TIUMSG
"RTN","TIUPS177",48,0)
 S TIU(8925.5,"+1,",.01)=DA
"RTN","TIUPS177",49,0)
 S TIU(8925.5,"+1,",2.01)=TIUNOW
"RTN","TIUPS177",50,0)
 S TIU(8925.5,"+1,",2.02)=DUZ
"RTN","TIUPS177",51,0)
 S TIU(8925.5,"+1,",2.03)=TIUCODE
"RTN","TIUPS177",52,0)
 D UPDATE^DIE("","TIU","TIUIEN","TIUMSG")
"RTN","TIUPS177",53,0)
 Q
"RTN","TIUPS177",54,0)
 ;VMP/ELR PATCH 248 FOLLOWING CODE CALLED FROM MUMPS EXECUTABLE WHEN ASSIGNING SECURITY KEY TIU MISSING TEXT CLEAN
"RTN","TIUPS177",55,0)
 ;ALSO CALLED FROM TAG EN+1 OF THIS ROUTINE
"RTN","TIUPS177",56,0)
 ;DBIA 2324
"RTN","TIUPS177",57,0)
RUN(TIUDUZ) ;
"RTN","TIUPS177",58,0)
 NEW TIUDAT S TIUDAT=""
"RTN","TIUPS177",59,0)
 I ($$ISA^USRLM(+$G(TIUDUZ),"CHIEF, MIS"))!($$ISA^USRLM(+$G(TIUDUZ),"CHIEF, HIM")) D
"RTN","TIUPS177",60,0)
 . S TIUDAT=1
"RTN","TIUPS177",61,0)
 Q TIUDAT
"VER")
8.0^22.0
"BLD",8110,6)
^238
**END**
**END**
