Released PSO*7*415 SEQ #351
Extracted from mail message
**KIDS**:PSO*7.0*415^

**INSTALL NAME**
PSO*7.0*415
"BLD",9170,0)
PSO*7.0*415^OUTPATIENT PHARMACY^0^3121017^y
"BLD",9170,1,0)
^^2^2^3121015^^^
"BLD",9170,1,1,0)
Users get an "end of file" error after running the TRICARE CHAMPVA
"BLD",9170,1,2,0)
 Bypass/Override Report
"BLD",9170,4,0)
^9.64PA^^
"BLD",9170,6.3)
3
"BLD",9170,"ABPKG")
n
"BLD",9170,"KRN",0)
^9.67PA^779.2^20
"BLD",9170,"KRN",.4,0)
.4
"BLD",9170,"KRN",.401,0)
.401
"BLD",9170,"KRN",.402,0)
.402
"BLD",9170,"KRN",.403,0)
.403
"BLD",9170,"KRN",.5,0)
.5
"BLD",9170,"KRN",.84,0)
.84
"BLD",9170,"KRN",3.6,0)
3.6
"BLD",9170,"KRN",3.8,0)
3.8
"BLD",9170,"KRN",9.2,0)
9.2
"BLD",9170,"KRN",9.8,0)
9.8
"BLD",9170,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",9170,"KRN",9.8,"NM",1,0)
PSOBORP0^^0^B13846157
"BLD",9170,"KRN",9.8,"NM",2,0)
PSOBORP1^^0^B123999048
"BLD",9170,"KRN",9.8,"NM","B","PSOBORP0",1)

"BLD",9170,"KRN",9.8,"NM","B","PSOBORP1",2)

"BLD",9170,"KRN",19,0)
19
"BLD",9170,"KRN",19.1,0)
19.1
"BLD",9170,"KRN",101,0)
101
"BLD",9170,"KRN",409.61,0)
409.61
"BLD",9170,"KRN",771,0)
771
"BLD",9170,"KRN",779.2,0)
779.2
"BLD",9170,"KRN",870,0)
870
"BLD",9170,"KRN",8989.51,0)
8989.51
"BLD",9170,"KRN",8989.52,0)
8989.52
"BLD",9170,"KRN",8994,0)
8994
"BLD",9170,"KRN","B",.4,.4)

"BLD",9170,"KRN","B",.401,.401)

"BLD",9170,"KRN","B",.402,.402)

"BLD",9170,"KRN","B",.403,.403)

"BLD",9170,"KRN","B",.5,.5)

"BLD",9170,"KRN","B",.84,.84)

"BLD",9170,"KRN","B",3.6,3.6)

"BLD",9170,"KRN","B",3.8,3.8)

"BLD",9170,"KRN","B",9.2,9.2)

"BLD",9170,"KRN","B",9.8,9.8)

"BLD",9170,"KRN","B",19,19)

"BLD",9170,"KRN","B",19.1,19.1)

"BLD",9170,"KRN","B",101,101)

"BLD",9170,"KRN","B",409.61,409.61)

"BLD",9170,"KRN","B",771,771)

"BLD",9170,"KRN","B",779.2,779.2)

"BLD",9170,"KRN","B",870,870)

"BLD",9170,"KRN","B",8989.51,8989.51)

"BLD",9170,"KRN","B",8989.52,8989.52)

"BLD",9170,"KRN","B",8994,8994)

"BLD",9170,"QUES",0)
^9.62^^
"BLD",9170,"REQB",0)
^9.611^1^1
"BLD",9170,"REQB",1,0)
PSO*7.0*385^2
"BLD",9170,"REQB","B","PSO*7.0*385",1)

"MBREQ")
0
"PKG",206,-1)
1^1
"PKG",206,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",206,20,0)
^9.402P^^
"PKG",206,22,0)
^9.49I^1^1
"PKG",206,22,1,0)
7.0^3021122^3021202^66481
"PKG",206,22,1,"PAH",1,0)
415^3121017
"PKG",206,22,1,"PAH",1,1,0)
^^2^2^3121017
"PKG",206,22,1,"PAH",1,1,1,0)
Users get an "end of file" error after running the TRICARE CHAMPVA
"PKG",206,22,1,"PAH",1,1,2,0)
 Bypass/Override Report
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSOBORP0")
0^1^B13846157^B12711131
"RTN","PSOBORP0",1,0)
PSOBORP0 ;ALBANY/BLD - TRICARE-CHAMPVA BYPASS/OVERRIDE AUDIT REPORT ; 10/15/12 4:26pm
"RTN","PSOBORP0",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**358,385,415**;DEC 1997;Build 3
"RTN","PSOBORP0",3,0)
 ;
"RTN","PSOBORP0",4,0)
 ;***********copied from routine BPSRPT0************
"RTN","PSOBORP0",5,0)
 ;
"RTN","PSOBORP0",6,0)
 Q
"RTN","PSOBORP0",7,0)
 ;
"RTN","PSOBORP0",8,0)
 ; Front End for ECME Reports
"RTN","PSOBORP0",9,0)
 ;
"RTN","PSOBORP0",10,0)
 ;
"RTN","PSOBORP0",11,0)
 ;
"RTN","PSOBORP0",12,0)
 ; Passed variables - The following local variables are passed around the PSSRPT* routines
"RTN","PSOBORP0",13,0)
 ;                    and are not passed as parameters but are assumed to be defined:
"RTN","PSOBORP0",14,0)
 ;                    PSACREJ,PSAUTREV,PSBEGDT,PSBLINE,PSCCRSN,PSDRGCL,PSDRUG,PSENDDT,PSEXCEL,
"RTN","PSOBORP0",15,0)
 ;                    PSINSINF,PSGRPLN,PSMWC,PSNOW,PSPAGE,PSPHARM,PSQ,PSQSTDRG,
"RTN","PSOBORP0",16,0)
 ;                    PSRLNRL,PSRTBCK,PSSDATA,PSSUMDET,PSRTYPE
"RTN","PSOBORP0",17,0)
 ;
"RTN","PSOBORP0",18,0)
EN(PSORTYPE) ;
"RTN","PSOBORP0",19,0)
 N %,ACTDT,AMT,BPQ,CODE,IO,PSOACREJ,PSOATYP,PSOAUTREV,PSOBEGDT,PSOCCRSN,PSODRGCL,PSODRUG,PSOENDDT,PSOEXCEL,PSONOW
"RTN","PSOBORP0",20,0)
 N PSOPHARM,PSOINSINF,PSOMWC,PSOQ,PSOUT,PSOPROV,PSOQSTDRG,PSOREJCD,PSORLNRL,PSORPTNAM,PSORTBCK
"RTN","PSOBORP0",21,0)
 N PSOSEL,PSOSCR,PSOSMDET,PSOSEL,PSOTOTAL,POS,PSOINS,PSOARR,PSOELIG,PSOOPCL,PSOPHMST,PSORPTNM,STAT,X,Y
"RTN","PSOBORP0",22,0)
 ;
"RTN","PSOBORP0",23,0)
 K PSOSEL
"RTN","PSOBORP0",24,0)
 ;
"RTN","PSOBORP0",25,0)
 S PSORPTNM="TRICARE-CHAMPVA BYPASS/OVERRIDE REPORT"
"RTN","PSOBORP0",26,0)
 ;
"RTN","PSOBORP0",27,0)
 ;Verify that a valid report has been requested
"RTN","PSOBORP0",28,0)
 I PSORTYPE'=1 W "<Invalid Menu Definition - Report Undefined>" H 3 Q
"RTN","PSOBORP0",29,0)
 ;
"RTN","PSOBORP0",30,0)
 ;Get current Date/Time
"RTN","PSOBORP0",31,0)
 S PSONOW=$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","PSOBORP0",32,0)
 ;
"RTN","PSOBORP0",33,0)
 ;Prompt for ECME Pharmacy Division(s) (No Default)
"RTN","PSOBORP0",34,0)
 ;Sets up PSOPHARM variable and array, PSOPHARM =0 ALL or PSOPHARM=1,PSOPHARM(ptr) for list
"RTN","PSOBORP0",35,0)
 S X=$$SELPHARM^PSOBORP1(.PSOSEL) I X="^" Q
"RTN","PSOBORP0",36,0)
 ;
"RTN","PSOBORP0",37,0)
 ;Prompt to Display TRICARE or CHAMPVA or ALL entries (Default to ALL)
"RTN","PSOBORP0",38,0)
 ;Returns T for TRICARE, C for CHAMPVA, A for ALL
"RTN","PSOBORP0",39,0)
 S PSOATYP=$$SELATYP^PSOBORP1("A")
"RTN","PSOBORP0",40,0)
 I PSOATYP="^" Q
"RTN","PSOBORP0",41,0)
 S PSOSEL("ELIG_TYPE")=PSOATYP
"RTN","PSOBORP0",42,0)
 ;
"RTN","PSOBORP0",43,0)
 ;Prompt to Display Summary or Detail Format (Default to Detail)
"RTN","PSOBORP0",44,0)
 ;Returns 1 for Summary, 0 for Detail
"RTN","PSOBORP0",45,0)
 S PSOSMDET=$$SELSMDET^PSOBORP1(2) I PSOSMDET="^" Q
"RTN","PSOBORP0",46,0)
 S PSOSEL("SUM_DETAIL")=PSOSMDET
"RTN","PSOBORP0",47,0)
 ;
"RTN","PSOBORP0",48,0)
 ;
"RTN","PSOBORP0",49,0)
 ;Prompt to select Date Range
"RTN","PSOBORP0",50,0)
 ;Returns (Start Date^End Date)
"RTN","PSOBORP0",51,0)
 S PSOBEGDT=$$SELDATE^PSOBORP1("TRANSACTION") D  I PSOBEGDT="^" Q
"RTN","PSOBORP0",52,0)
 .I PSOBEGDT="^" Q
"RTN","PSOBORP0",53,0)
 .S PSOENDDT=$P(PSOBEGDT,U,2)
"RTN","PSOBORP0",54,0)
 .S PSOBEGDT=$P(PSOBEGDT,U)
"RTN","PSOBORP0",55,0)
 S PSOSEL("BEGIN DATE")=PSOBEGDT
"RTN","PSOBORP0",56,0)
 S PSOSEL("END DATE")=PSOENDDT
"RTN","PSOBORP0",57,0)
 ;
"RTN","PSOBORP0",58,0)
 ;
"RTN","PSOBORP0",59,0)
 ;Prompt to Include (S)pecific TC Code or (A)LL (Default to ALL)
"RTN","PSOBORP0",60,0)
 S PSOREJCD=$$SELTCCD^PSOBORP1(.PSOSEL)
"RTN","PSOBORP0",61,0)
 I PSOREJCD="^" Q
"RTN","PSOBORP0",62,0)
 ;
"RTN","PSOBORP0",63,0)
 ;Prompt to select One of the following: Specific Pharmacist or ALL Pharmacist
"RTN","PSOBORP0",64,0)
 S PSOPHMST=$$SELPHMST^PSOBORP1(.PSOSEL)
"RTN","PSOBORP0",65,0)
 I PSOPHMST="^" Q
"RTN","PSOBORP0",66,0)
 ;
"RTN","PSOBORP0",67,0)
 ;prompt to select one of the following: Specific Provider or ALL Providers
"RTN","PSOBORP0",68,0)
 ;
"RTN","PSOBORP0",69,0)
 S PSOPROV=$$SELPROV^PSOBORP1(.PSOSEL)
"RTN","PSOBORP0",70,0)
 I PSOPROV="^" Q
"RTN","PSOBORP0",71,0)
 ;
"RTN","PSOBORP0",72,0)
 ;
"RTN","PSOBORP0",73,0)
 ;Prompt to Include Group/Subtotal Report by (R) Pharmacy or (P)rovider/Prescriber Name
"RTN","PSOBORP0",74,0)
 ;Returns ()
"RTN","PSOBORP0",75,0)
 S PSOTOTAL=$$PSOTOTAL^PSOBORP1()
"RTN","PSOBORP0",76,0)
 I PSOTOTAL="^" Q
"RTN","PSOBORP0",77,0)
 S PSOSEL("TOTALS BY")=PSOTOTAL
"RTN","PSOBORP0",78,0)
 ;
"RTN","PSOBORP0",79,0)
 ;Prompt for Excel Capture (Detail Only)
"RTN","PSOBORP0",80,0)
 S PSOEXCEL=0 I PSOSEL("SUM_DETAIL")="D" D  I PSOEXCEL="^" Q
"RTN","PSOBORP0",81,0)
 .S PSOEXCEL=$$SELEXCEL^PSOBORP1() I PSOEXCEL="^" Q
"RTN","PSOBORP0",82,0)
 .S PSOSEL("EXCEL")=PSOEXCEL
"RTN","PSOBORP0",83,0)
 ;
"RTN","PSOBORP0",84,0)
 ;Prompt for the Device
"RTN","PSOBORP0",85,0)
 I 'PSOEXCEL D
"RTN","PSOBORP0",86,0)
 .W !!,"WARNING - THIS REPORT REQUIRES THAT A DEVICE WITH 132 COLUMN WIDTH BE USED."
"RTN","PSOBORP0",87,0)
 .W !,"IT WILL NOT DISPLAY CORRECTLY USING 80 COLUMN WIDTH DEVICES",!
"RTN","PSOBORP0",88,0)
 N PSOSCR S PSOSCR=0
"RTN","PSOBORP0",89,0)
 S PSOQ=0 D DEVICE(PSORPTNM) I PSOQ D ^%ZISC QUIT
"RTN","PSOBORP0",90,0)
 ;
"RTN","PSOBORP0",91,0)
 ;Compile and Run the Report
"RTN","PSOBORP0",92,0)
 D RUN(.PSOSEL)
"RTN","PSOBORP0",93,0)
 I '$G(PSOUT) D PAUSE^PSOBORP1
"RTN","PSOBORP0",94,0)
 ;
"RTN","PSOBORP0",95,0)
 QUIT
"RTN","PSOBORP0",96,0)
 ;
"RTN","PSOBORP0",97,0)
 ;Compile and Run the Report
"RTN","PSOBORP0",98,0)
 ;
"RTN","PSOBORP0",99,0)
RUN(PSOEXCEL,PSORPTNAM,PSOSMDET) ;
"RTN","PSOBORP0",100,0)
 N PSOPAGE,PSOTMP
"RTN","PSOBORP0",101,0)
 ;
"RTN","PSOBORP0",102,0)
 D RUNRPT^PSOBORP2(.PSOSEL)
"RTN","PSOBORP0",103,0)
 ;
"RTN","PSOBORP0",104,0)
 ;
"RTN","PSOBORP0",105,0)
 D ^%ZISC Q
"RTN","PSOBORP0",106,0)
 ;
"RTN","PSOBORP0",107,0)
 ;Prompt For the Device
"RTN","PSOBORP0",108,0)
 ;
"RTN","PSOBORP0",109,0)
 ; Returns Device variables and PSOSCR
"RTN","PSOBORP0",110,0)
 ;
"RTN","PSOBORP0",111,0)
DEVICE(PSORPTNAM) N %ZIS,ZTSK,ZTRTN,ZTIO,ZTDESC,ZTSAVE,POP
"RTN","PSOBORP0",112,0)
 S %ZIS="QM"
"RTN","PSOBORP0",113,0)
 D ^%ZIS
"RTN","PSOBORP0",114,0)
 I POP S PSOQ=1
"RTN","PSOBORP0",115,0)
 ;
"RTN","PSOBORP0",116,0)
 ;Check for exit
"RTN","PSOBORP0",117,0)
 I $G(PSOQ) G XDEV
"RTN","PSOBORP0",118,0)
 I IO=IO(0) S PSOSCR=1  ;User wants to print to the screen
"RTN","PSOBORP0",119,0)
 ;
"RTN","PSOBORP0",120,0)
 S PSOSCR=$S($E($G(IOST),1,2)="C-":1,1:0)
"RTN","PSOBORP0",121,0)
 I $D(IO("Q")) D  S PSOQ=1
"RTN","PSOBORP0",122,0)
 . S ZTRTN="RUN^PSOBORP0(PSOEXCEL,PSORPTNAM,PSOSMDET)"
"RTN","PSOBORP0",123,0)
 . S ZTIO=ION
"RTN","PSOBORP0",124,0)
 . S ZTSAVE("*")=""
"RTN","PSOBORP0",125,0)
 . S ZTDESC="PSO REPORT: "_PSORPTNM
"RTN","PSOBORP0",126,0)
 . D ^%ZTLOAD
"RTN","PSOBORP0",127,0)
 . W !,$S($D(ZTSK):"REQUEST QUEUED TASK="_ZTSK,1:"REQUEST CANCELLED")
"RTN","PSOBORP0",128,0)
 . D HOME^%ZIS
"RTN","PSOBORP0",129,0)
 U IO
"RTN","PSOBORP0",130,0)
XDEV Q
"RTN","PSOBORP1")
0^2^B123999048^B123593134
"RTN","PSOBORP1",1,0)
PSOBORP1 ;ALBANY/BLD - TRICARE-CHAMPVA BYPASS/OVERRIDE AUDIT REPORT (CONT) ; 10/17/12 3:38pm
"RTN","PSOBORP1",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**358,385,415**;DEC 1997;Build 3
"RTN","PSOBORP1",3,0)
 ;
"RTN","PSOBORP1",4,0)
 ;***********copied from routine BPSRPT3 AND BPSRPT4************
"RTN","PSOBORP1",5,0)
 ;
"RTN","PSOBORP1",6,0)
 Q
"RTN","PSOBORP1",7,0)
 ;
"RTN","PSOBORP1",8,0)
 ;
"RTN","PSOBORP1",9,0)
 ;                    
"RTN","PSOBORP1",10,0)
SELPHARM(PSOSEL) N DIC,DIR,DIRUT,DTOUT,DUOUT,X,Y
"RTN","PSOBORP1",11,0)
 ;
"RTN","PSOBORP1",12,0)
 ; Select the ECME Pharmacy or Pharmacies
"RTN","PSOBORP1",13,0)
 ; 
"RTN","PSOBORP1",14,0)
 ; Input Variable -> none
"RTN","PSOBORP1",15,0)
 ; Return Value ->   "" = Valid Entry or Entries Selected
"RTN","PSOBORP1",16,0)
 ;                                        ^ = Exit
"RTN","PSOBORP1",17,0)
 ;                                       
"RTN","PSOBORP1",18,0)
 ; Output Variable -> PSOPHARM = 1 One or More Pharmacies Selected
"RTN","PSOBORP1",19,0)
 ;                          = 0 User Entered 'ALL'
"RTN","PSOBORP1",20,0)
 ;                            
"RTN","PSOBORP1",21,0)
 ; If PSOPHARM = 1 then the PSOPHARM array will be defined where:
"RTN","PSOBORP1",22,0)
 ;    PSOPHARM(ptr) = ptr ^ BPS PHARMACY NAME and
"RTN","PSOBORP1",23,0)
 ;    ptr = Internal Pointer to BPS PHARMACIES file (#9002313.56)
"RTN","PSOBORP1",24,0)
 ;
"RTN","PSOBORP1",25,0)
 ;Reset PSOPHARM array
"RTN","PSOBORP1",26,0)
 K PSOPHARM
"RTN","PSOBORP1",27,0)
 ;
"RTN","PSOBORP1",28,0)
 ;First see if they want to enter individual divisions or ALL
"RTN","PSOBORP1",29,0)
 S DIR(0)="S^D:DIVISION;A:ALL"
"RTN","PSOBORP1",30,0)
 S DIR("A")="Select Certain Pharmacy (D)ivisions or (A)LL"
"RTN","PSOBORP1",31,0)
 S DIR("L",1)="Select one of the following:"
"RTN","PSOBORP1",32,0)
 S DIR("L",2)=""
"RTN","PSOBORP1",33,0)
 S DIR("L",3)="     D         DIVISION"
"RTN","PSOBORP1",34,0)
 S DIR("L",4)="     A         ALL"
"RTN","PSOBORP1",35,0)
 D ^DIR K DIR
"RTN","PSOBORP1",36,0)
 ;
"RTN","PSOBORP1",37,0)
 ;Check for "^" or timeout, otherwise define PSOPHARM
"RTN","PSOBORP1",38,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^"
"RTN","PSOBORP1",39,0)
 E  S (PSOSEL("DIVISION"),PSOPHARM)=Y
"RTN","PSOBORP1",40,0)
 ;If division selected, ask prompt
"RTN","PSOBORP1",41,0)
 I $G(PSOPHARM)="D" F  D  Q:Y="^"!(Y="") 
"RTN","PSOBORP1",42,0)
 .;
"RTN","PSOBORP1",43,0)
 .;Prompt for entry
"RTN","PSOBORP1",44,0)
 .K X S DIC(0)="QEAM",DIC=59,DIC("A")="Select ECME Pharmacy Division(s): "
"RTN","PSOBORP1",45,0)
 .W ! D ^DIC
"RTN","PSOBORP1",46,0)
 .;
"RTN","PSOBORP1",47,0)
 .;Check for "^" or timeout 
"RTN","PSOBORP1",48,0)
 .I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPHARM S Y="^" Q
"RTN","PSOBORP1",49,0)
 .;
"RTN","PSOBORP1",50,0)
 .;Check for blank entry, quit if no previous selections
"RTN","PSOBORP1",51,0)
 .I $G(X)="" S Y=$S($D(PSOPHARM)>9:"",1:"^") K:Y="^" PSOPHARM Q
"RTN","PSOBORP1",52,0)
 .;
"RTN","PSOBORP1",53,0)
 .;Handle Deletes
"RTN","PSOBORP1",54,0)
 .I $D(PSOPHARM(+Y)) D  Q:Y="^"  I 1
"RTN","PSOBORP1",55,0)
 ..N P
"RTN","PSOBORP1",56,0)
 ..S P=Y  ;Save Original Value
"RTN","PSOBORP1",57,0)
 ..S DIR(0)="S^Y:YES;N:NO",DIR("A")="Delete "_$P(P,U,2)_" from your list?"
"RTN","PSOBORP1",58,0)
 ..S DIR("B")="NO" D ^DIR
"RTN","PSOBORP1",59,0)
 ..I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPHARM S Y="^" Q
"RTN","PSOBORP1",60,0)
 ..I Y="Y" K PSOPHARM(+P),PSOPHARM("B",$P(P,U,2),+P)
"RTN","PSOBORP1",61,0)
 ..S Y=P  ;Restore Original Value
"RTN","PSOBORP1",62,0)
 ..K P
"RTN","PSOBORP1",63,0)
 .E  D
"RTN","PSOBORP1",64,0)
 ..;Define new entries in PSOPHARM array
"RTN","PSOBORP1",65,0)
 ..S PSOPHARM(+Y)=Y
"RTN","PSOBORP1",66,0)
 ..S PSOPHARM("B",$P(Y,U,2),+Y)=""
"RTN","PSOBORP1",67,0)
 .;
"RTN","PSOBORP1",68,0)
 .;Display a list of selected divisions
"RTN","PSOBORP1",69,0)
 .I $D(PSOPHARM)>9 D
"RTN","PSOBORP1",70,0)
 ..N X
"RTN","PSOBORP1",71,0)
 ..W !,?2,"Selected:"
"RTN","PSOBORP1",72,0)
 ..S X="" F  S X=$O(PSOPHARM("B",X)) Q:X=""  W !,?10,X
"RTN","PSOBORP1",73,0)
 ..K X
"RTN","PSOBORP1",74,0)
 .Q
"RTN","PSOBORP1",75,0)
 ;
"RTN","PSOBORP1",76,0)
 K PSOPHARM("B")
"RTN","PSOBORP1",77,0)
 M PSOSEL("DIVISION")=PSOPHARM
"RTN","PSOBORP1",78,0)
 Q Y
"RTN","PSOBORP1",79,0)
 ;
"RTN","PSOBORP1",80,0)
 ;
"RTN","PSOBORP1",81,0)
 ;
"RTN","PSOBORP1",82,0)
SELSMDET(DFLT) ;
"RTN","PSOBORP1",83,0)
 ;
"RTN","PSOBORP1",84,0)
 ; Display (S)ummary or (D)etail Format
"RTN","PSOBORP1",85,0)
 ; 
"RTN","PSOBORP1",86,0)
 ; Input Variable -> DFLT = 1 Summary
"RTN","PSOBORP1",87,0)
 ;                          2 Detail
"RTN","PSOBORP1",88,0)
 ;                          
"RTN","PSOBORP1",89,0)
 ; Return Value ->   1 = Summary
"RTN","PSOBORP1",90,0)
 ;                   0 = Detail
"RTN","PSOBORP1",91,0)
 ;                   ^ = Exit
"RTN","PSOBORP1",92,0)
 ;
"RTN","PSOBORP1",93,0)
 N DIR,DIRUT,DTOUT,DUOUT,X,Y
"RTN","PSOBORP1",94,0)
 ;
"RTN","PSOBORP1",95,0)
 S DFLT=$S($G(DFLT)=1:"Summary",$G(DFLT)=0:"Detail",1:"Detail")
"RTN","PSOBORP1",96,0)
 S DIR(0)="S^S:Summary;D:Detail",DIR("A")="Display (S)ummary or (D)etail Format",DIR("B")=DFLT
"RTN","PSOBORP1",97,0)
 D ^DIR
"RTN","PSOBORP1",98,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^"
"RTN","PSOBORP1",99,0)
 Q Y
"RTN","PSOBORP1",100,0)
 ;
"RTN","PSOBORP1",101,0)
 ;                 
"RTN","PSOBORP1",102,0)
SELDATE(TYPE) ;select begin date
"RTN","PSOBORP1",103,0)
 ; Enter Date Range
"RTN","PSOBORP1",104,0)
 ;
"RTN","PSOBORP1",105,0)
 ; Input Variable -> TYPE = TRANSACTION
"RTN","PSOBORP1",106,0)
 ;                          
"RTN","PSOBORP1",107,0)
 ;
"RTN","PSOBORP1",108,0)
 ; Return Value -> P1^P2
"RTN","PSOBORP1",109,0)
 ; 
"RTN","PSOBORP1",110,0)
 ;           where P1 = From Date
"RTN","PSOBORP1",111,0)
 ;                    = ^ Exit
"RTN","PSOBORP1",112,0)
 ;                 P2 = To Date
"RTN","PSOBORP1",113,0)
 ;                    = blank for Exit
"RTN","PSOBORP1",114,0)
 N PSOSIBDT,DIR,DIRUT,DTOUT,DUOUT,VAL,X,Y
"RTN","PSOBORP1",115,0)
 ;
"RTN","PSOBORP1",116,0)
SELDATE1 ;
"RTN","PSOBORP1",117,0)
 N VAL
"RTN","PSOBORP1",118,0)
 S VAL="",DIR(0)="DA^:DT:EX",DIR("A")="START WITH "_TYPE_" DATE: ",DIR("B")="T-1"
"RTN","PSOBORP1",119,0)
 W ! D ^DIR
"RTN","PSOBORP1",120,0)
 ;
"RTN","PSOBORP1",121,0)
 ;Check for "^", timeout, or blank entry
"RTN","PSOBORP1",122,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1)!($G(X)="") S VAL="^"
"RTN","PSOBORP1",123,0)
 ;
"RTN","PSOBORP1",124,0)
 I VAL="" D
"RTN","PSOBORP1",125,0)
 .S $P(VAL,U)=Y
"RTN","PSOBORP1",126,0)
 .S DIR(0)="DA^"_VAL_":DT:EX",DIR("A")="  GO TO "_TYPE_" DATE: ",DIR("B")="T"
"RTN","PSOBORP1",127,0)
 .D ^DIR
"RTN","PSOBORP1",128,0)
 .;
"RTN","PSOBORP1",129,0)
 .;Check for "^", timeout, or blank entry
"RTN","PSOBORP1",130,0)
 .I ($G(DUOUT)=1)!($G(DTOUT)=1)!($G(X)="") S VAL="^" Q
"RTN","PSOBORP1",131,0)
 .;
"RTN","PSOBORP1",132,0)
 .;Define Entry
"RTN","PSOBORP1",133,0)
 .S $P(VAL,U,2)=Y
"RTN","PSOBORP1",134,0)
 ;
"RTN","PSOBORP1",135,0)
 Q VAL
"RTN","PSOBORP1",136,0)
 ;
"RTN","PSOBORP1",137,0)
SELATYP(DFLT) ;
"RTN","PSOBORP1",138,0)
 ;
"RTN","PSOBORP1",139,0)
 ; Display (T)RICARE or (C)HAMPVA OR (A)LL Format
"RTN","PSOBORP1",140,0)
 ; 
"RTN","PSOBORP1",141,0)
 ; Input Variable -> DFLT = A ALL
"RTN","PSOBORP1",142,0)
 ; T TRICARE
"RTN","PSOBORP1",143,0)
 ; C CHAMPVA
"RTN","PSOBORP1",144,0)
 ; 
"RTN","PSOBORP1",145,0)
 ; Return Value -> A = ALL
"RTN","PSOBORP1",146,0)
 ; T = TRICARE
"RTN","PSOBORP1",147,0)
 ; C = CHAMPVA
"RTN","PSOBORP1",148,0)
 ; ^ = Exit
"RTN","PSOBORP1",149,0)
 ;
"RTN","PSOBORP1",150,0)
 N DIR,DIRUT,DTOUT,DUOUT,EXIT,X,Y
"RTN","PSOBORP1",151,0)
 S EXIT=0
"RTN","PSOBORP1",152,0)
 S DFLT=$S($G(DFLT)="T":"TRICARE",$G(DFLT)="C":"CHAMPVA",1:"ALL")
"RTN","PSOBORP1",153,0)
 S DIR(0)="SO^T:TRICARE;C:CHAMPVA;A:ALL",DIR("A")="Display (T)RICARE or (C)HAMPVA or (A)LL Entries",DIR("B")=DFLT
"RTN","PSOBORP1",154,0)
 D ^DIR
"RTN","PSOBORP1",155,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^"
"RTN","PSOBORP1",156,0)
 I Y="A" K PSOSEL("ELIG_TYPE") D
"RTN","PSOBORP1",157,0)
 .S PSOSEL("ELIG_TYPE")="A"
"RTN","PSOBORP1",158,0)
 .S PSOSEL("ELIG_TYPE","T")="TRICARE"
"RTN","PSOBORP1",159,0)
 .S PSOSEL("ELIG_TYPE","C")="CHAMPVA"
"RTN","PSOBORP1",160,0)
 .S EXIT=1
"RTN","PSOBORP1",161,0)
 I EXIT Q Y
"RTN","PSOBORP1",162,0)
 I Y'="" S PSOSEL("ELIG_TYPE",Y)=$S(Y="T":"TRICARE",Y="C":"CHAMPVA",1:"ALL")
"RTN","PSOBORP1",163,0)
 Q Y
"RTN","PSOBORP1",164,0)
 ;
"RTN","PSOBORP1",165,0)
SELTCCD(PSOSEL) ;
"RTN","PSOBORP1",166,0)
 ;
"RTN","PSOBORP1",167,0)
 ; Select to Include (S)pecific Reject Code or (A)ll
"RTN","PSOBORP1",168,0)
 ;
"RTN","PSOBORP1",169,0)
 ;
"RTN","PSOBORP1",170,0)
 ;Prompt to Include (I)patient, (N)on-Billable, (R)eject, (P)artial, or A)ll: (no default)
"RTN","PSOBORP1",171,0)
 ;
"RTN","PSOBORP1",172,0)
 N DIC,DIR,DIRUT,DUOUT,EXIT,REJ,X,Y,I
"RTN","PSOBORP1",173,0)
 S EXIT=0
"RTN","PSOBORP1",174,0)
 F I=1:1:2 D  Q:Y="A"!(EXIT)
"RTN","PSOBORP1",175,0)
 .S DIR(0)="SO^I:INPATIENT;N:NON-BILLABLE PRODUCT;R:REJECT OVERRIDE;P:PARTIAL FILL;A:ALL"
"RTN","PSOBORP1",176,0)
 .S DIR("A")="Select one of the following: **Can select multiples - limit of 2**  "
"RTN","PSOBORP1",177,0)
 .D ^DIR
"RTN","PSOBORP1",178,0)
 .I ($G(DUOUT)=1)!($G(DTOUT)=1) S EXIT=1,Y="^" Q
"RTN","PSOBORP1",179,0)
 .I Y="A" K PSOSEL("REJECT CODES") D  Q
"RTN","PSOBORP1",180,0)
 ..S PSOSEL("REJECT CODES")="A"
"RTN","PSOBORP1",181,0)
 ..S PSOSEL("REJECT CODES","I")="INPATIENT"
"RTN","PSOBORP1",182,0)
 ..S PSOSEL("REJECT CODES","N")="NON-BILLABLE PRODUCT"
"RTN","PSOBORP1",183,0)
 ..S PSOSEL("REJECT CODES","R")="REJECT OVERRIDE"
"RTN","PSOBORP1",184,0)
 ..S PSOSEL("REJECT CODES","P")="PARTIAL FILL"
"RTN","PSOBORP1",185,0)
 ..S EXIT=1
"RTN","PSOBORP1",186,0)
 .I Y="",$D(PSOSEL("REJECT CODES")) S EXIT=1 Q
"RTN","PSOBORP1",187,0)
 .I Y="",'$D(PSOSEL("REJECT CODES")) S EXIT=0,I=0 Q
"RTN","PSOBORP1",188,0)
 .I Y'="" S PSOSEL("REJECT CODES",Y)=$S(Y="I":"INPATIENT",Y="N":"NON-BILLABLE PRODUCT",Y="R":"REJECT OVERRIDE",Y="P":"PARTIAL FILL",1:"ALL")
"RTN","PSOBORP1",189,0)
 ;
"RTN","PSOBORP1",190,0)
 Q Y
"RTN","PSOBORP1",191,0)
 ;
"RTN","PSOBORP1",192,0)
SELPHMST(PSOSEL) ;
"RTN","PSOBORP1",193,0)
 ;
"RTN","PSOBORP1",194,0)
 ; Select to include (S)pecific Pharmacist or (A)ll pharmacists
"RTN","PSOBORP1",195,0)
 ;
"RTN","PSOBORP1",196,0)
 N DIR,DIRUT,DTOUT,DUOUT,VAL,X,Y
"RTN","PSOBORP1",197,0)
 K PSOPHARM,DIR
"RTN","PSOBORP1",198,0)
 ;
"RTN","PSOBORP1",199,0)
 ;First see if they want to enter individual divisions or ALL
"RTN","PSOBORP1",200,0)
 S DIR(0)="S^S:SPECIFIC PHARMACIST(S);A:ALL PHARMACISTS"
"RTN","PSOBORP1",201,0)
 S DIR("A")="Select Specific Pharmacist(s) or All Pharmacists"
"RTN","PSOBORP1",202,0)
 S DIR("B")="ALL"
"RTN","PSOBORP1",203,0)
 S DIR("L",1)="Select one of the following:"
"RTN","PSOBORP1",204,0)
 S DIR("L",2)=""
"RTN","PSOBORP1",205,0)
 S DIR("L",3)="     S         Specific Pharmacist(s)"
"RTN","PSOBORP1",206,0)
 S DIR("L",4)="     A         All Pharmacists"
"RTN","PSOBORP1",207,0)
 D ^DIR K DIR
"RTN","PSOBORP1",208,0)
 ;
"RTN","PSOBORP1",209,0)
 ;Check for "^" or timeout, otherwise define PSOPHARM 
"RTN","PSOBORP1",210,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^"
"RTN","PSOBORP1",211,0)
 E  S (PSOSEL("PHARMACIST"),PSOPHARM)=Y
"RTN","PSOBORP1",212,0)
 ;
"RTN","PSOBORP1",213,0)
 ;If pharmacist selected, ask prompt
"RTN","PSOBORP1",214,0)
 I $G(PSOPHARM)="S" F  D  Q:Y="^"!(Y="") 
"RTN","PSOBORP1",215,0)
 .;
"RTN","PSOBORP1",216,0)
 .;Prompt for entry
"RTN","PSOBORP1",217,0)
 .K X S DIC(0)="QEAM",DIC=200,DIC("A")="Select Pharmacist: "
"RTN","PSOBORP1",218,0)
 .S DIC("S")="I $D(^XUSEC(""PSORPH"",Y))"
"RTN","PSOBORP1",219,0)
 .W ! D ^DIC
"RTN","PSOBORP1",220,0)
 .;
"RTN","PSOBORP1",221,0)
 .;Check for "^" or timeout 
"RTN","PSOBORP1",222,0)
 .I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPHARM S Y="^" Q
"RTN","PSOBORP1",223,0)
 .;
"RTN","PSOBORP1",224,0)
 .;Check for blank entry, quit if no previous selections
"RTN","PSOBORP1",225,0)
 .I $G(X)="" S Y=$S($D(PSOPHARM)>9:"",1:"^") K:Y="^" PSOPHARM Q
"RTN","PSOBORP1",226,0)
 .;
"RTN","PSOBORP1",227,0)
 .;Handle Deletes
"RTN","PSOBORP1",228,0)
 .I $D(PSOPHARM(+Y)) D  Q:Y="^"  I 1
"RTN","PSOBORP1",229,0)
 ..N P
"RTN","PSOBORP1",230,0)
 ..S P=Y  ;Save Original Value
"RTN","PSOBORP1",231,0)
 ..S DIR(0)="S^Y:YES;N:NO",DIR("A")="Delete "_$P(P,U,2)_" from your list?"
"RTN","PSOBORP1",232,0)
 ..S DIR("B")="NO" D ^DIR
"RTN","PSOBORP1",233,0)
 ..I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPHARM S Y="^" Q
"RTN","PSOBORP1",234,0)
 ..I Y="Y" K PSOPHARM(+P),PSOPHARM("B",$P(P,U,2),+P)
"RTN","PSOBORP1",235,0)
 ..S Y=P  ;Restore Original Value
"RTN","PSOBORP1",236,0)
 ..K P
"RTN","PSOBORP1",237,0)
 .E  D
"RTN","PSOBORP1",238,0)
 ..;Define new entries in PSOPHARM array
"RTN","PSOBORP1",239,0)
 ..S PSOPHARM(+Y)=Y
"RTN","PSOBORP1",240,0)
 ..S PSOPHARM("B",$P(Y,U,2),+Y)=""
"RTN","PSOBORP1",241,0)
 .;
"RTN","PSOBORP1",242,0)
 .;Display a list of selected providers
"RTN","PSOBORP1",243,0)
 .I $D(PSOPHARM)>9 D
"RTN","PSOBORP1",244,0)
 ..N X
"RTN","PSOBORP1",245,0)
 ..W !,?2,"Selected:"
"RTN","PSOBORP1",246,0)
 ..S X="" F  S X=$O(PSOPHARM("B",X)) Q:X=""  W !,?10,X
"RTN","PSOBORP1",247,0)
 ..K X
"RTN","PSOBORP1",248,0)
 .Q
"RTN","PSOBORP1",249,0)
 ;
"RTN","PSOBORP1",250,0)
 K PSOPHARM("B")
"RTN","PSOBORP1",251,0)
 M PSOSEL("PHARMACIST")=PSOPHARM
"RTN","PSOBORP1",252,0)
 Q Y
"RTN","PSOBORP1",253,0)
 ;
"RTN","PSOBORP1",254,0)
SELPROV(PSOSEL) ;
"RTN","PSOBORP1",255,0)
 ;
"RTN","PSOBORP1",256,0)
 ;select to include (S)pecific Provider or (A)ll Providers
"RTN","PSOBORP1",257,0)
 ;
"RTN","PSOBORP1",258,0)
 N DIR,DIRUT,DTOUT,DUOUT,VAL,X,Y
"RTN","PSOBORP1",259,0)
 K PSOPROV
"RTN","PSOBORP1",260,0)
 ;
"RTN","PSOBORP1",261,0)
 ;First see if they want to enter individual divisions or ALL
"RTN","PSOBORP1",262,0)
 S DIR(0)="S^S:SPECIFIC PROVIDER(S);A:ALL PROVIDERS"
"RTN","PSOBORP1",263,0)
 S DIR("A")="Select Specific Provider(s) or include ALL Providers"
"RTN","PSOBORP1",264,0)
 S DIR("B")="ALL"
"RTN","PSOBORP1",265,0)
 S DIR("L",1)="Select one of the following:"
"RTN","PSOBORP1",266,0)
 S DIR("L",2)=""
"RTN","PSOBORP1",267,0)
 S DIR("L",3)="     S         Specific Provider(s)"
"RTN","PSOBORP1",268,0)
 S DIR("L",4)="     A         ALL Providers"
"RTN","PSOBORP1",269,0)
 D ^DIR K DIR
"RTN","PSOBORP1",270,0)
 ;
"RTN","PSOBORP1",271,0)
 ;Check for "^" or timeout, otherwise define PSOPROV 
"RTN","PSOBORP1",272,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^"
"RTN","PSOBORP1",273,0)
 E  S (PSOSEL("PROVIDER"),PSOPROV)=Y
"RTN","PSOBORP1",274,0)
 ;
"RTN","PSOBORP1",275,0)
 ;If provider selected, ask prompt
"RTN","PSOBORP1",276,0)
 I $G(PSOPROV)="S" F  D  Q:Y="^"!(Y="") 
"RTN","PSOBORP1",277,0)
 .;
"RTN","PSOBORP1",278,0)
 .;Prompt for entry
"RTN","PSOBORP1",279,0)
 .K X S DIC(0)="QEAM",DIC=200,DIC("A")="Select Provider: "
"RTN","PSOBORP1",280,0)
 .S DIC("S")="I +$G(^VA(200,Y,""PS""))"
"RTN","PSOBORP1",281,0)
 .W ! D ^DIC
"RTN","PSOBORP1",282,0)
 .;
"RTN","PSOBORP1",283,0)
 .;Check for "^" or timeout 
"RTN","PSOBORP1",284,0)
 .I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPROV S Y="^" Q
"RTN","PSOBORP1",285,0)
 .;
"RTN","PSOBORP1",286,0)
 .;Check for blank entry, quit if no previous selections
"RTN","PSOBORP1",287,0)
 .I $G(X)="" S Y=$S($D(PSOPROV)>9:"",1:"^") K:Y="^" PSOPROV Q
"RTN","PSOBORP1",288,0)
 .;
"RTN","PSOBORP1",289,0)
 .;Handle Deletes
"RTN","PSOBORP1",290,0)
 .I $D(PSOPROV(+Y)) D  Q:Y="^"  I 1
"RTN","PSOBORP1",291,0)
 ..N P
"RTN","PSOBORP1",292,0)
 ..S P=Y  ;Save Original Value
"RTN","PSOBORP1",293,0)
 ..S DIR(0)="S^Y:YES;N:NO",DIR("A")="Delete "_$P(P,U,2)_" from your list?"
"RTN","PSOBORP1",294,0)
 ..S DIR("B")="NO" D ^DIR
"RTN","PSOBORP1",295,0)
 ..I ($G(DUOUT)=1)!($G(DTOUT)=1) K PSOPROV S Y="^" Q
"RTN","PSOBORP1",296,0)
 ..I Y="Y" K PSOPROV(+P),PSOPROV("B",$P(P,U,2),+P)
"RTN","PSOBORP1",297,0)
 ..S Y=P  ;Restore Original Value
"RTN","PSOBORP1",298,0)
 ..K P
"RTN","PSOBORP1",299,0)
 .E  D
"RTN","PSOBORP1",300,0)
 ..;Define new entries in PSOPROV array
"RTN","PSOBORP1",301,0)
 ..S PSOPROV(+Y)=Y
"RTN","PSOBORP1",302,0)
 ..S PSOPROV("B",$P(Y,U,2),+Y)=""
"RTN","PSOBORP1",303,0)
 .;
"RTN","PSOBORP1",304,0)
 .;Display a list of selected providers
"RTN","PSOBORP1",305,0)
 .I $D(PSOPROV)>9 D
"RTN","PSOBORP1",306,0)
 ..N X
"RTN","PSOBORP1",307,0)
 ..W !,?2,"Selected:"
"RTN","PSOBORP1",308,0)
 ..S X="" F  S X=$O(PSOPROV("B",X)) Q:X=""  W !,?10,X
"RTN","PSOBORP1",309,0)
 ..K X
"RTN","PSOBORP1",310,0)
 .Q
"RTN","PSOBORP1",311,0)
 ;
"RTN","PSOBORP1",312,0)
 K PSOPROV("B")
"RTN","PSOBORP1",313,0)
 M PSOSEL("PROVIDER")=PSOPROV
"RTN","PSOBORP1",314,0)
 Q Y
"RTN","PSOBORP1",315,0)
 ;
"RTN","PSOBORP1",316,0)
PSOTOTAL(PSOSEL) ;
"RTN","PSOBORP1",317,0)
 ;
"RTN","PSOBORP1",318,0)
 ;Prompt to Include Group/Subtotal Report by (R) Pharmacy or (P)rovider/Provider
"RTN","PSOBORP1",319,0)
 ;ADDED BY BLD
"RTN","PSOBORP1",320,0)
 ;Returns ()
"RTN","PSOBORP1",321,0)
 ;
"RTN","PSOBORP1",322,0)
 N Y,DUOUT,DTOUT,IBQUIT,DIROUT,DIR
"RTN","PSOBORP1",323,0)
 N PSONPI
"RTN","PSOBORP1",324,0)
 S DIR(0)="S^R:Pharmacist;P:Provider/Prescriber Name"
"RTN","PSOBORP1",325,0)
 S DIR("A")="Group/Subtotal Report by (R)Pharmacist or (P)Provider"
"RTN","PSOBORP1",326,0)
 ;S DIR("B")="PHARMACIST"
"RTN","PSOBORP1",327,0)
 D ^DIR
"RTN","PSOBORP1",328,0)
 I ($G(DUOUT)=1)!($G(DTOUT)=1) S Y="^" Q Y
"RTN","PSOBORP1",329,0)
 S PSONPI=Y
"RTN","PSOBORP1",330,0)
 ;
"RTN","PSOBORP1",331,0)
 Q Y
"RTN","PSOBORP1",332,0)
 ;
"RTN","PSOBORP1",333,0)
 ;
"RTN","PSOBORP1",334,0)
 ;Print Header 2 Line 1
"RTN","PSOBORP1",335,0)
 ;
"RTN","PSOBORP1",336,0)
 ; Input variable: PSORTYPE -> Report Type (1-7)
"RTN","PSOBORP1",337,0)
 ;
"RTN","PSOBORP1",338,0)
 ;
"RTN","PSOBORP1",339,0)
SELEXCEL() ; - Returns whether to capture data for Excel report.
"RTN","PSOBORP1",340,0)
 ; Output: EXCEL = 1 - YES (capture data) / 0 - NO (DO NOT capture data)
"RTN","PSOBORP1",341,0)
 ;
"RTN","PSOBORP1",342,0)
 Q:PSOSEL("SUM_DETAIL")="S"
"RTN","PSOBORP1",343,0)
 N EXCEL,DIR,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","PSOBORP1",344,0)
 ;
"RTN","PSOBORP1",345,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("T")=DTIME W !
"RTN","PSOBORP1",346,0)
 S DIR("A")="Do you want to capture report data for an Excel document"
"RTN","PSOBORP1",347,0)
 S DIR("?")="^D HEXC"
"RTN","PSOBORP1",348,0)
 D ^DIR K DIR I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) Q "^"
"RTN","PSOBORP1",349,0)
 K DIROUT,DTOUT,DUOUT,DIRUT
"RTN","PSOBORP1",350,0)
 S EXCEL=0 I Y S EXCEL=1
"RTN","PSOBORP1",351,0)
 ;
"RTN","PSOBORP1",352,0)
 ;Display Excel display message
"RTN","PSOBORP1",353,0)
 I EXCEL=1 D EXMSG
"RTN","PSOBORP1",354,0)
 ;
"RTN","PSOBORP1",355,0)
 Q EXCEL
"RTN","PSOBORP1",356,0)
 ;
"RTN","PSOBORP1",357,0)
HEXC ; - 'Do you want to capture data...' prompt
"RTN","PSOBORP1",358,0)
 W !!,"      Enter:  'Y'    -  To capture detail report data to transfer"
"RTN","PSOBORP1",359,0)
 W !,"                        to an Excel document"
"RTN","PSOBORP1",360,0)
 W !,"              '<CR>' -  To skip this option"
"RTN","PSOBORP1",361,0)
 W !,"              '^'    -  To quit this option"
"RTN","PSOBORP1",362,0)
 Q
"RTN","PSOBORP1",363,0)
 ;
"RTN","PSOBORP1",364,0)
 ;Display the message about capturing to an Excel file format
"RTN","PSOBORP1",365,0)
 ; 
"RTN","PSOBORP1",366,0)
EXMSG ;
"RTN","PSOBORP1",367,0)
 W !!?5,"Before continuing, please set up your terminal to capture the"
"RTN","PSOBORP1",368,0)
 W !?5,"detail report data. On some terminals, this can  be  done  by"
"RTN","PSOBORP1",369,0)
 W !?5,"clicking  on the 'Tools' menu above, then click  on  'Capture"
"RTN","PSOBORP1",370,0)
 W !?5,"Incoming  Data' to save to  Desktop. This  report  may take a"
"RTN","PSOBORP1",371,0)
 W !?5,"while to run."
"RTN","PSOBORP1",372,0)
 W !!?5,"Note: To avoid  undesired  wrapping of the data  saved to the"
"RTN","PSOBORP1",373,0)
 W !?5,"      file, please enter '0;256;999' at the 'DEVICE:' prompt.",!
"RTN","PSOBORP1",374,0)
 Q
"RTN","PSOBORP1",375,0)
 ;
"RTN","PSOBORP1",376,0)
 ;
"RTN","PSOBORP1",377,0)
 ;Screen Pause
"RTN","PSOBORP1",378,0)
 ;
"RTN","PSOBORP1",379,0)
PAUSE ;
"RTN","PSOBORP1",380,0)
 Q:$G(PSOSCR)'=1  S PSOUT=""
"RTN","PSOBORP1",381,0)
 W ! K DIR S DIR(0)="E",DIR("A")="Press Return to continue, '^' to exit" D ^DIR K DIR I 'Y S PSOUT=1
"RTN","PSOBORP1",382,0)
 Q
"VER")
8.0^22.0
"BLD",9170,6)
^351
**END**
**END**
