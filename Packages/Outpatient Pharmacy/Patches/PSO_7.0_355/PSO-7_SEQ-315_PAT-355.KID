Released PSO*7*355 SEQ #315
Extracted from mail message
**KIDS**:PSO*7.0*355^

**INSTALL NAME**
PSO*7.0*355
"BLD",7722,0)
PSO*7.0*355^OUTPATIENT PHARMACY^0^3100503^y
"BLD",7722,1,0)
^^1^1^3100503^
"BLD",7722,1,1,0)
User receives an undefined error when accessing the Non VA Meds Report.
"BLD",7722,4,0)
^9.64PA^^
"BLD",7722,6.3)
1
"BLD",7722,"ABPKG")
n
"BLD",7722,"KRN",0)
^9.67PA^779.2^20
"BLD",7722,"KRN",.4,0)
.4
"BLD",7722,"KRN",.401,0)
.401
"BLD",7722,"KRN",.402,0)
.402
"BLD",7722,"KRN",.403,0)
.403
"BLD",7722,"KRN",.5,0)
.5
"BLD",7722,"KRN",.84,0)
.84
"BLD",7722,"KRN",3.6,0)
3.6
"BLD",7722,"KRN",3.8,0)
3.8
"BLD",7722,"KRN",9.2,0)
9.2
"BLD",7722,"KRN",9.8,0)
9.8
"BLD",7722,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7722,"KRN",9.8,"NM",1,0)
PSONVARP^^0^B23942845
"BLD",7722,"KRN",9.8,"NM","B","PSONVARP",1)

"BLD",7722,"KRN",19,0)
19
"BLD",7722,"KRN",19,"NM",0)
^9.68A^^
"BLD",7722,"KRN",19.1,0)
19.1
"BLD",7722,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",7722,"KRN",101,0)
101
"BLD",7722,"KRN",101,"NM",0)
^9.68A^^
"BLD",7722,"KRN",409.61,0)
409.61
"BLD",7722,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",7722,"KRN",771,0)
771
"BLD",7722,"KRN",771,"NM",0)
^9.68A^^
"BLD",7722,"KRN",779.2,0)
779.2
"BLD",7722,"KRN",779.2,"NM",0)
^9.68A^^
"BLD",7722,"KRN",870,0)
870
"BLD",7722,"KRN",870,"NM",0)
^9.68A^^
"BLD",7722,"KRN",8989.51,0)
8989.51
"BLD",7722,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",7722,"KRN",8989.52,0)
8989.52
"BLD",7722,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",7722,"KRN",8994,0)
8994
"BLD",7722,"KRN",8994,"NM",0)
^9.68A^^
"BLD",7722,"KRN","B",.4,.4)

"BLD",7722,"KRN","B",.401,.401)

"BLD",7722,"KRN","B",.402,.402)

"BLD",7722,"KRN","B",.403,.403)

"BLD",7722,"KRN","B",.5,.5)

"BLD",7722,"KRN","B",.84,.84)

"BLD",7722,"KRN","B",3.6,3.6)

"BLD",7722,"KRN","B",3.8,3.8)

"BLD",7722,"KRN","B",9.2,9.2)

"BLD",7722,"KRN","B",9.8,9.8)

"BLD",7722,"KRN","B",19,19)

"BLD",7722,"KRN","B",19.1,19.1)

"BLD",7722,"KRN","B",101,101)

"BLD",7722,"KRN","B",409.61,409.61)

"BLD",7722,"KRN","B",771,771)

"BLD",7722,"KRN","B",779.2,779.2)

"BLD",7722,"KRN","B",870,870)

"BLD",7722,"KRN","B",8989.51,8989.51)

"BLD",7722,"KRN","B",8989.52,8989.52)

"BLD",7722,"KRN","B",8994,8994)

"BLD",7722,"QUES",0)
^9.62^^
"BLD",7722,"REQB",0)
^9.611^1^1
"BLD",7722,"REQB",1,0)
PSO*7.0*326^2
"BLD",7722,"REQB","B","PSO*7.0*326",1)

"MBREQ")
0
"PKG",141,-1)
1^1
"PKG",141,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",141,20,0)
^9.402P^^
"PKG",141,22,0)
^9.49I^1^1
"PKG",141,22,1,0)
7.0^2971216^2980917^11712
"PKG",141,22,1,"PAH",1,0)
355^3100503
"PKG",141,22,1,"PAH",1,1,0)
^^1^1^3100503
"PKG",141,22,1,"PAH",1,1,1,0)
User receives an undefined error when accessing the Non VA Meds Report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSONVARP")
0^1^B23942845^B23669597
"RTN","PSONVARP",1,0)
PSONVARP ;BHM/MFR - Non-VA Med Usage Report - Input ; 5/3/10 5:57pm
"RTN","PSONVARP",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**132,118,326,355**;13 Feb 97;Build 1
"RTN","PSONVARP",3,0)
 ;External reference to ^%DT is supported by DBIA 10003
"RTN","PSONVARP",4,0)
 ;External reference to ^%ZTLOAD is supported by DBIA 10063
"RTN","PSONVARP",5,0)
 ;External reference to ^%ZIS is supported by DBIA 10086
"RTN","PSONVARP",6,0)
 ;External reference to ^DIR is supported by DBIA 10026
"RTN","PSONVARP",7,0)
 ;External reference to ^XLFSTR is supported by DBIA 10104
"RTN","PSONVARP",8,0)
 ;
"RTN","PSONVARP",9,0)
HID ; - Entrhy point from the Hidden Action in the Medication Profile
"RTN","PSONVARP",10,0)
 N PSOHDFLG S PSOHDFLG=1
"RTN","PSONVARP",11,0)
 ;
"RTN","PSONVARP",12,0)
EN N PSOSD,PSOED,PSOST,PSOSRT,PSOAPT,PSOAOI,PSOST,PSOOC,PSOAPT,PSOAOI,I,Y
"RTN","PSONVARP",13,0)
 N OK,X,C,%DT
"RTN","PSONVARP",14,0)
 ;
"RTN","PSONVARP",15,0)
 ; - Ask for FROM DATE DOCUMENTED
"RTN","PSONVARP",16,0)
 S %DT(0)=-DT,%DT="AEP",%DT("A")="FROM DATE DOCUMENTED: "
"RTN","PSONVARP",17,0)
 W ! D ^%DT I Y<0!($D(DTOUT)) G END
"RTN","PSONVARP",18,0)
 S PSOSD=Y\1-.00001
"RTN","PSONVARP",19,0)
 ;
"RTN","PSONVARP",20,0)
ENDT ; - Ask for TO DATE DOCUMENTED
"RTN","PSONVARP",21,0)
 S %DT(0)=PSOSD+1\1,%DT("A")="TO DATE DOCUMENTED: "
"RTN","PSONVARP",22,0)
 W ! D ^%DT I Y<0!($D(DTOUT)) G END
"RTN","PSONVARP",23,0)
 S PSOED=Y\1+.99999
"RTN","PSONVARP",24,0)
 ;
"RTN","PSONVARP",25,0)
 ; - Reported called from a Hidden Action menu
"RTN","PSONVARP",26,0)
 I $G(PSOHDFLG) D  G DEV
"RTN","PSONVARP",27,0)
 . S:'$G(DFN) DFN=PSODFN
"RTN","PSONVARP",28,0)
 . S PSOPT(DFN)="",PSOAPT=0,PSOAOI=1,PSOST="B",PSOOC="B",PSOSRT="4,2"
"RTN","PSONVARP",29,0)
 ;
"RTN","PSONVARP",30,0)
SORT ; - Ask for SORT BY
"RTN","PSONVARP",31,0)
 K DIR S DIR("B")="PATIENT NAME" D HL1("A")
"RTN","PSONVARP",32,0)
SORT1 S PSOSRT="",(PSOAPT,PSOAOI)=1,(PSOST,PSOOC)="B"
"RTN","PSONVARP",33,0)
 S DIR("A")="SORT BY",DIR(0)="FO" D HL1("?")
"RTN","PSONVARP",34,0)
 W ! D ^DIR K DIR I $D(DIRUT) G END
"RTN","PSONVARP",35,0)
 ;
"RTN","PSONVARP",36,0)
 S OK=1,C=15 W !
"RTN","PSONVARP",37,0)
 F I=1:1:$L(Y,",") D
"RTN","PSONVARP",38,0)
 . S X=$P(Y,",",I) S:X'?.N X=$$TRNS(X) I PSOSRT[X Q
"RTN","PSONVARP",39,0)
 . W !?(C-10),$S(I=1:"SORT BY ",1:"THEN BY ") S C=C+5
"RTN","PSONVARP",40,0)
 . I X<1!(X>5) W X,"???",$C(7) S OK=0 Q
"RTN","PSONVARP",41,0)
 . W $P("PATIENT NAME^ORDERABLE ITEM^DATE DOCUMENTED^STATUS^ORDER CHECKS","^",X)
"RTN","PSONVARP",42,0)
 . S PSOSRT=PSOSRT_","_X
"RTN","PSONVARP",43,0)
 I 'OK S DIR("B")=Y G SORT1
"RTN","PSONVARP",44,0)
 S $E(PSOSRT)=""
"RTN","PSONVARP",45,0)
 ;
"RTN","PSONVARP",46,0)
 S OK=1
"RTN","PSONVARP",47,0)
 F I=1:1:$L(PSOSRT,",") D  I 'OK Q
"RTN","PSONVARP",48,0)
 . S X=$P(PSOSRT,",",I) D:X'=3 @("SRT"_X)
"RTN","PSONVARP",49,0)
 I 'OK S DIR("B")="PATIENT NAME" G SORT1
"RTN","PSONVARP",50,0)
 ;
"RTN","PSONVARP",51,0)
DEV W ! K %ZIS,IOP,POP,ZTSK S %ZIS="QM" D ^%ZIS K %ZIS I POP G END
"RTN","PSONVARP",52,0)
 I $D(IO("Q")) D  G END
"RTN","PSONVARP",53,0)
 . N G K IO("Q"),ZTIO,ZTSAVE,ZTDTH,ZTSK
"RTN","PSONVARP",54,0)
 . S ZTRTN="EN^PSONVAR1",ZTDESC="Non-VA Meds Usage Report"
"RTN","PSONVARP",55,0)
 . F G="PSOSD","PSOED","PSOSRT","PSOPT","PSOOI" S:$D(@G) ZTSAVE(G)=""
"RTN","PSONVARP",56,0)
 . F G="PSOST","PSOOC","PSOAPT","PSOAOI" S:$D(@G) ZTSAVE(G)=""
"RTN","PSONVARP",57,0)
 . S:$D(PSOPT) ZTSAVE("PSOPT(")="" S:$D(PSOOI) ZTSAVE("PSOOI(")=""
"RTN","PSONVARP",58,0)
 . D ^%ZTLOAD W:$D(ZTSK) !,"Report is Queued to print !!" K ZTSK
"RTN","PSONVARP",59,0)
 ;
"RTN","PSONVARP",60,0)
 G EN^PSONVAR1
"RTN","PSONVARP",61,0)
 ;
"RTN","PSONVARP",62,0)
END Q
"RTN","PSONVARP",63,0)
 ;
"RTN","PSONVARP",64,0)
SRT1 ; - Selection of PATIENTS to print on the Report
"RTN","PSONVARP",65,0)
 N DIC,X,I K PSOPT S PSOAPT=0
"RTN","PSONVARP",66,0)
 W !!,?5,"You may select a single or multiple PATIENTS,"
"RTN","PSONVARP",67,0)
 W !,?5,"or enter ^ALL to select all PATIENTS.",!
"RTN","PSONVARP",68,0)
 S DIC(0)="QEAM",DIC("A")="     PATIENT: "
"RTN","PSONVARP",69,0)
 F  D EN^PSOPATLK S Y=PSOPTLK Q:+Y<1  S:'$$DEAD(+Y,1) PSOPT(+Y)="" K DIC("B"),PSOPTLK
"RTN","PSONVARP",70,0)
 I Y="^ALL" S PSOAPT=1 K PSOPT,DUOUT Q
"RTN","PSONVARP",71,0)
 I $D(DUOUT)!($D(DTOUT)) S OK=0 Q
"RTN","PSONVARP",72,0)
 I '$D(PSOPT),Y<1 S OK=0 Q
"RTN","PSONVARP",73,0)
 Q
"RTN","PSONVARP",74,0)
 ;
"RTN","PSONVARP",75,0)
SRT2 ; - Selection of ORDERABLE ITEMS to print on the Report
"RTN","PSONVARP",76,0)
 N DIC,X,I K PSOOI S PSOAOI=0
"RTN","PSONVARP",77,0)
 W !!,?5,"You may select a single or multiple ORDERABLE ITEMS,"
"RTN","PSONVARP",78,0)
 W !,?5,"or enter ^ALL to select all ORDERABLE ITEMS.",!
"RTN","PSONVARP",79,0)
 S DIC=50.7,DIC(0)="QEAM",DIC("A")="     ORDERABLE ITEM: "
"RTN","PSONVARP",80,0)
 F  D ^DIC Q:Y<0  S PSOOI(+Y)="" K DIC("B")
"RTN","PSONVARP",81,0)
 I X="^ALL" S PSOAOI=1 K PSOOI,DUOUT Q
"RTN","PSONVARP",82,0)
 I $D(DUOUT)!($D(DTOUT)) S OK=0 Q
"RTN","PSONVARP",83,0)
 I '$D(PSOOI)&(Y<0) S OK=0 Q
"RTN","PSONVARP",84,0)
 Q
"RTN","PSONVARP",85,0)
 ;
"RTN","PSONVARP",86,0)
SRT4 ; - Selection of STATUS to print on the Report
"RTN","PSONVARP",87,0)
 N DIR,X,I K PSOST
"RTN","PSONVARP",88,0)
 W !!,?5,"You may select (A)CTIVE, (D)ISCONTINUED or (B)OTH status.",!
"RTN","PSONVARP",89,0)
 S DIR(0)="SAO^A:ACTIVE;D:DISCONTINUED;B:BOTH"
"RTN","PSONVARP",90,0)
 S DIR("A")="     STATUS: ",DIR("B")="ACTIVE" D ^DIR
"RTN","PSONVARP",91,0)
 I $D(DIRUT) S OK=0 Q
"RTN","PSONVARP",92,0)
 S PSOST=Y
"RTN","PSONVARP",93,0)
 Q
"RTN","PSONVARP",94,0)
 ;
"RTN","PSONVARP",95,0)
SRT5 ; - Selection of ORDER CHECKS to print on the Report
"RTN","PSONVARP",96,0)
 N DIR,X,OP1,OP2 K PSOOC
"RTN","PSONVARP",97,0)
 S OP1="ORDERS WITH ORDER CHECKS ONLY"
"RTN","PSONVARP",98,0)
 S OP2="ORDERS WITHOUT ORDER CHECKS ONLY"
"RTN","PSONVARP",99,0)
 W !!,?5,"You may select 'Y' to print ",OP1,","
"RTN","PSONVARP",100,0)
 W !?5,"'N' to print ",OP2," or 'B' for BOTH.",!
"RTN","PSONVARP",101,0)
 S DIR(0)="SAO^Y:"_OP1_";N:"_OP2_";B:BOTH"
"RTN","PSONVARP",102,0)
 S DIR("A")="     ORDER CHECKS: ",DIR("B")="BOTH" D ^DIR
"RTN","PSONVARP",103,0)
 I $D(DIRUT) S OK=0 Q
"RTN","PSONVARP",104,0)
 S PSOOC=Y
"RTN","PSONVARP",105,0)
 Q
"RTN","PSONVARP",106,0)
 ;
"RTN","PSONVARP",107,0)
TRNS(X) ; - Translates Alpha into the corresponding Sorting Code
"RTN","PSONVARP",108,0)
 N L,UPX S L=$L(X),UPX=$$UP^XLFSTR(X)
"RTN","PSONVARP",109,0)
 I $E("PATIENT NAME",1,L)=UPX Q 1
"RTN","PSONVARP",110,0)
 I $E("ORDERABLE ITEM",1,L)=UPX Q 2
"RTN","PSONVARP",111,0)
 I $E("DATE DOCUMENTED",1,L)=UPX Q 3
"RTN","PSONVARP",112,0)
 I $E("STATUS",1,L)=UPX Q 4
"RTN","PSONVARP",113,0)
 I $E("ORDER CHECKS",1,L)=UPX Q 5
"RTN","PSONVARP",114,0)
 Q X
"RTN","PSONVARP",115,0)
 ;
"RTN","PSONVARP",116,0)
DEAD(DFN,DSPL) ; Check if Patient has a Date Of Death on File
"RTN","PSONVARP",117,0)
 N VADM,Y
"RTN","PSONVARP",118,0)
 I '$G(DFN) Q 0
"RTN","PSONVARP",119,0)
 D DEM^VADPT I $G(VADM(6))="" Q 0
"RTN","PSONVARP",120,0)
 I $G(DSPL) W !?10,$P($G(VADM(1)),"^")," (",$P($G(VADM(2)),"^",2),") DIED ",$P($G(VADM(6)),"^",2),$C(7)
"RTN","PSONVARP",121,0)
 Q 1
"RTN","PSONVARP",122,0)
 ;
"RTN","PSONVARP",123,0)
HL1(S) ; - Help for the SORT BY prompt
"RTN","PSONVARP",124,0)
 S DIR(S,1)="    Enter the SORT field(s) for this Report:"
"RTN","PSONVARP",125,0)
 S DIR(S,2)=" "
"RTN","PSONVARP",126,0)
 S DIR(S,3)="       1 - PATIENT NAME"
"RTN","PSONVARP",127,0)
 S DIR(S,4)="       2 - ORDERABLE ITEM"
"RTN","PSONVARP",128,0)
 S DIR(S,5)="       3 - DATE DOCUMENTED"
"RTN","PSONVARP",129,0)
 S DIR(S,6)="       4 - STATUS"
"RTN","PSONVARP",130,0)
 S DIR(S,7)="       5 - ORDER CHECKS"
"RTN","PSONVARP",131,0)
 S DIR(S,8)=" "
"RTN","PSONVARP",132,0)
 S DIR(S,9)="    Or any combination of the above, separated by comma,"
"RTN","PSONVARP",133,0)
 S DIR(S,10)="    as in these examples:"
"RTN","PSONVARP",134,0)
 S DIR(S,11)=" "
"RTN","PSONVARP",135,0)
 S DIR(S,12)="       2,1  - BY ORDERABLE ITEM, THEN BY PATIENT NAME"
"RTN","PSONVARP",136,0)
 S DIR(S,13)="      5,1,4 - BY ORDER CHECKS, THEN BY PATIENT NAME, THEN BY STATUS"
"RTN","PSONVARP",137,0)
 S DIR(S,14)=" "
"RTN","PSONVARP",138,0)
 S DIR(S)=" "
"RTN","PSONVARP",139,0)
 Q
"VER")
8.0^22.0
"BLD",7722,6)
^315
**END**
**END**
