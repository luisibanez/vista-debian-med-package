Released PSO*7*352 SEQ #308
Extracted from mail message
**KIDS**:PSO*7.0*352^

**INSTALL NAME**
PSO*7.0*352
"BLD",7709,0)
PSO*7.0*352^OUTPATIENT PHARMACY^0^3100601^y
"BLD",7709,1,0)
^^3^3^3100601^
"BLD",7709,1,1,0)
This patch will resolve the issue where the Ignored Rejects Report [PSO 
"BLD",7709,1,2,0)
IGNORED REJECTS REPORT] abends when sorting on PATIENT and only one
"BLD",7709,1,3,0)
patient is selected.
"BLD",7709,4,0)
^9.64PA^^
"BLD",7709,6.3)
5
"BLD",7709,"ABPKG")
n
"BLD",7709,"KRN",0)
^9.67PA^779.2^20
"BLD",7709,"KRN",.4,0)
.4
"BLD",7709,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7709,"KRN",.401,0)
.401
"BLD",7709,"KRN",.402,0)
.402
"BLD",7709,"KRN",.403,0)
.403
"BLD",7709,"KRN",.5,0)
.5
"BLD",7709,"KRN",.84,0)
.84
"BLD",7709,"KRN",3.6,0)
3.6
"BLD",7709,"KRN",3.8,0)
3.8
"BLD",7709,"KRN",9.2,0)
9.2
"BLD",7709,"KRN",9.8,0)
9.8
"BLD",7709,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7709,"KRN",9.8,"NM",1,0)
PSOBPSRP^^0^B13567876
"BLD",7709,"KRN",9.8,"NM","B","PSOBPSRP",1)

"BLD",7709,"KRN",19,0)
19
"BLD",7709,"KRN",19,"NM",0)
^9.68A^^
"BLD",7709,"KRN",19.1,0)
19.1
"BLD",7709,"KRN",101,0)
101
"BLD",7709,"KRN",409.61,0)
409.61
"BLD",7709,"KRN",771,0)
771
"BLD",7709,"KRN",779.2,0)
779.2
"BLD",7709,"KRN",870,0)
870
"BLD",7709,"KRN",8989.51,0)
8989.51
"BLD",7709,"KRN",8989.52,0)
8989.52
"BLD",7709,"KRN",8994,0)
8994
"BLD",7709,"KRN","B",.4,.4)

"BLD",7709,"KRN","B",.401,.401)

"BLD",7709,"KRN","B",.402,.402)

"BLD",7709,"KRN","B",.403,.403)

"BLD",7709,"KRN","B",.5,.5)

"BLD",7709,"KRN","B",.84,.84)

"BLD",7709,"KRN","B",3.6,3.6)

"BLD",7709,"KRN","B",3.8,3.8)

"BLD",7709,"KRN","B",9.2,9.2)

"BLD",7709,"KRN","B",9.8,9.8)

"BLD",7709,"KRN","B",19,19)

"BLD",7709,"KRN","B",19.1,19.1)

"BLD",7709,"KRN","B",101,101)

"BLD",7709,"KRN","B",409.61,409.61)

"BLD",7709,"KRN","B",771,771)

"BLD",7709,"KRN","B",779.2,779.2)

"BLD",7709,"KRN","B",870,870)

"BLD",7709,"KRN","B",8989.51,8989.51)

"BLD",7709,"KRN","B",8989.52,8989.52)

"BLD",7709,"KRN","B",8994,8994)

"BLD",7709,"QUES",0)
^9.62^^
"BLD",7709,"REQB",0)
^9.611^1^1
"BLD",7709,"REQB",1,0)
PSO*7.0*345^2
"BLD",7709,"REQB","B","PSO*7.0*345",1)

"MBREQ")
0
"PKG",141,-1)
1^1
"PKG",141,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",141,20,0)
^9.402P^^
"PKG",141,22,0)
^9.49I^1^1
"PKG",141,22,1,0)
7.0^2971216^2980917^11712
"PKG",141,22,1,"PAH",1,0)
352^3100601^1000018
"PKG",141,22,1,"PAH",1,1,0)
^^3^3^3100601
"PKG",141,22,1,"PAH",1,1,1,0)
This patch will resolve the issue where the Ignored Rejects Report [PSO 
"PKG",141,22,1,"PAH",1,1,2,0)
IGNORED REJECTS REPORT] abends when sorting on PATIENT and only one
"PKG",141,22,1,"PAH",1,1,3,0)
patient is selected.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSOBPSRP")
0^1^B13567876^B13181433
"RTN","PSOBPSRP",1,0)
PSOBPSRP ;BHM/LE - Ignored Rejects Report ;03/01/07
"RTN","PSOBPSRP",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**260,345,352**;13 Feb 97;Build 5
"RTN","PSOBPSRP",3,0)
 ;
"RTN","PSOBPSRP",4,0)
EN N PSOSD,PSOED,PSOST,PSOSRT,PSOAPT,PSODRUG,PSODIV,PSODRG,PSOST,PSOOC,PSOU,PSOUSER,PSOAPT,PSOIBP,Y
"RTN","PSOBPSRP",5,0)
 N OK,X,C,%DT,PSOSIT
"RTN","PSOBPSRP",6,0)
 ;
"RTN","PSOBPSRP",7,0)
DIV ; - Ask for Division 
"RTN","PSOBPSRP",8,0)
 D SEL^PSOREJU1("DIVISION","^PS(59,",.PSODIV,$$GET1^DIQ(59,+$G(PSOSITE),.01)) Q:$G(PSODIV)="^"
"RTN","PSOBPSRP",9,0)
 I $G(PSODIV)="ALL" S PSOSIT=1 K PSODIV
"RTN","PSOBPSRP",10,0)
 ;
"RTN","PSOBPSRP",11,0)
BEGD ; - Ask for FROM DATE DOCUMENTED
"RTN","PSOBPSRP",12,0)
 S %DT(0)=-DT,%DT="AEP",%DT("A")="BEGIN REJECT DATE: "
"RTN","PSOBPSRP",13,0)
 W ! D ^%DT I Y<0!($D(DTOUT)) G END
"RTN","PSOBPSRP",14,0)
 S PSOSD=Y\1-.00001
"RTN","PSOBPSRP",15,0)
 ;
"RTN","PSOBPSRP",16,0)
ENDT ; - Ask for TO DATE DOCUMENTED
"RTN","PSOBPSRP",17,0)
 S %DT(0)=PSOSD+1\1,%DT("A")="END REJECT DATE: "
"RTN","PSOBPSRP",18,0)
 W ! D ^%DT I Y<0!($D(DTOUT)) G END
"RTN","PSOBPSRP",19,0)
 S PSOED=Y\1+.99999
"RTN","PSOBPSRP",20,0)
 ;
"RTN","PSOBPSRP",21,0)
SORT ; - Ask for SORT BY
"RTN","PSOBPSRP",22,0)
 K DIR S DIR("B")="PATIENT" D HL1("A")
"RTN","PSOBPSRP",23,0)
SORT1 S PSOSRT="",(PSOAPT)=1,(PSOST,PSOOC)="B"
"RTN","PSOBPSRP",24,0)
 S DIR("A")="SORT BY",DIR(0)="FO" D HL1("?")
"RTN","PSOBPSRP",25,0)
 W ! D ^DIR K DIR I $D(DIRUT) G END
"RTN","PSOBPSRP",26,0)
 ;
"RTN","PSOBPSRP",27,0)
 S OK=1,C=15 W !
"RTN","PSOBPSRP",28,0)
 F PSOIBP=1:1:$L(Y,",") D  ;352 CHANGED ALL VARIABLES OF 'I' TO PSOIBP
"RTN","PSOBPSRP",29,0)
 . S X=$P(Y,",",PSOIBP) S:X'?.N X=$$TRNS(X) I PSOSRT[X Q
"RTN","PSOBPSRP",30,0)
 . W !?(C-10),$S(PSOIBP=1:"SORT BY ",1:"THEN BY ") S C=C+5
"RTN","PSOBPSRP",31,0)
 . I X<1!(X>3) W X,"???",$C(7) S OK=0 Q
"RTN","PSOBPSRP",32,0)
 . W $P("PATIENT^DRUG^USER","^",X)
"RTN","PSOBPSRP",33,0)
 . S PSOSRT=PSOSRT_","_X
"RTN","PSOBPSRP",34,0)
 I 'OK S DIR("B")=Y G SORT1
"RTN","PSOBPSRP",35,0)
 S $E(PSOSRT)=""
"RTN","PSOBPSRP",36,0)
 ;
"RTN","PSOBPSRP",37,0)
 S OK=1
"RTN","PSOBPSRP",38,0)
 F PSOIBP=1:1:$L(PSOSRT,",") D  I 'OK Q
"RTN","PSOBPSRP",39,0)
 . S X=$P(PSOSRT,",",PSOIBP) D @("SRT"_X)
"RTN","PSOBPSRP",40,0)
 I 'OK S DIR("B")="PATIENT" G SORT1
"RTN","PSOBPSRP",41,0)
 ;
"RTN","PSOBPSRP",42,0)
DEV W ! K %ZIS,IOP,POP,ZTSK S %ZIS="QM" D ^%ZIS K %ZIS I POP G END
"RTN","PSOBPSRP",43,0)
 ;If user didn't select a particular sort, assume all values for that sort
"RTN","PSOBPSRP",44,0)
 S:'$G(PSOAPT)&('$D(PSOPT)) PSOAPT=1
"RTN","PSOBPSRP",45,0)
 S:'$G(PSODRUG)&('$D(PSODRG)) PSODRUG=1
"RTN","PSOBPSRP",46,0)
 S:'$G(PSOUSER)&('$D(PSOU)) PSOUSER=1
"RTN","PSOBPSRP",47,0)
 ;
"RTN","PSOBPSRP",48,0)
 I $D(IO("Q")) D  G END
"RTN","PSOBPSRP",49,0)
 . N G K IO("Q"),ZTIO,ZTSAVE,ZTDTH,ZTSK
"RTN","PSOBPSRP",50,0)
 . S ZTRTN="EN^PSOBPSR1",ZTDESC="Ignored Rejects Report"
"RTN","PSOBPSRP",51,0)
 . F G="PSOSD","PSOED","PSOSRT","PSOPT","PSODRG" S:$D(@G) ZTSAVE(G)=""
"RTN","PSOBPSRP",52,0)
 . F G="PSOST","PSOOC","PSOAPT","PSODRUG","PSOUSER","PSOSIT" S:$D(@G) ZTSAVE(G)=""
"RTN","PSOBPSRP",53,0)
 . S:$D(PSOPT) ZTSAVE("PSOPT(")="" S:$D(PSODRG) ZTSAVE("PSODRG(")=""
"RTN","PSOBPSRP",54,0)
 . S:$D(PSOU) ZTSAVE("PSOU(")="" S:$D(PSODIV) ZTSAVE("PSODIV(")=""
"RTN","PSOBPSRP",55,0)
 . D ^%ZTLOAD W:$D(ZTSK) !,"Report is Queued to print!" K ZTSK
"RTN","PSOBPSRP",56,0)
 ;
"RTN","PSOBPSRP",57,0)
 G EN^PSOBPSR1
"RTN","PSOBPSRP",58,0)
 ;
"RTN","PSOBPSRP",59,0)
END Q
"RTN","PSOBPSRP",60,0)
 ;
"RTN","PSOBPSRP",61,0)
HL1(S) ; - Help for the SORT BY prompt
"RTN","PSOBPSRP",62,0)
 S DIR(S,1)="    Enter the SORT field(s) for this Report:"
"RTN","PSOBPSRP",63,0)
 S DIR(S,2)=" "
"RTN","PSOBPSRP",64,0)
 S DIR(S,3)="       1 - PATIENT"
"RTN","PSOBPSRP",65,0)
 S DIR(S,4)="       2 - DRUG"
"RTN","PSOBPSRP",66,0)
 S DIR(S,5)="       3 - USER"
"RTN","PSOBPSRP",67,0)
 S DIR(S,6)=" "
"RTN","PSOBPSRP",68,0)
 S DIR(S,7)="    Or any combination of the above, separated by comma,"
"RTN","PSOBPSRP",69,0)
 S DIR(S,8)="    as in these examples:"
"RTN","PSOBPSRP",70,0)
 S DIR(S,9)=" "
"RTN","PSOBPSRP",71,0)
 S DIR(S,10)="       2,1  - BY PATIENT, THEN DRUG"
"RTN","PSOBPSRP",72,0)
 S DIR(S,11)="      3,1,2 - BY USER, THEN BY PATIENT, THEN BY DRUG"
"RTN","PSOBPSRP",73,0)
 S DIR(S,12)=" "
"RTN","PSOBPSRP",74,0)
 S DIR(S)=" "
"RTN","PSOBPSRP",75,0)
 Q
"RTN","PSOBPSRP",76,0)
 ;
"RTN","PSOBPSRP",77,0)
SRT1 ; - Selection of PATIENTS to print on the Report
"RTN","PSOBPSRP",78,0)
 N PSOIBP K PSOPT S PSOAPT=0 ;345 ADDED N PSOIBP
"RTN","PSOBPSRP",79,0)
 D SEL^PSOREJU1("PATIENT","^DPT(",.PSOPT)  I $G(PSOPT)="^" S OK=0 Q
"RTN","PSOBPSRP",80,0)
 I $G(PSOPT)="ALL" S PSOAPT=1 K PSOPT
"RTN","PSOBPSRP",81,0)
 Q
"RTN","PSOBPSRP",82,0)
 ;
"RTN","PSOBPSRP",83,0)
SRT2 ; - Selection of Drugs to print on the Report
"RTN","PSOBPSRP",84,0)
 N PSOIBP K PSODRG S PSODRUG=0  ;345 ADDED N PSOIBP
"RTN","PSOBPSRP",85,0)
 D SEL^PSOREJU1("DRUG","^PSDRUG(",.PSODRG)  I $G(PSODRG)="^" S OK=0 Q
"RTN","PSOBPSRP",86,0)
 I $G(PSODRG)="ALL" S PSODRUG=1 K PSODRG
"RTN","PSOBPSRP",87,0)
 Q
"RTN","PSOBPSRP",88,0)
 ;
"RTN","PSOBPSRP",89,0)
SRT3 ; - Selection of Users to print on the Report
"RTN","PSOBPSRP",90,0)
 N PSOIBP K PSOU S PSOUSER=0 ;345 ADDED N PSOIBP
"RTN","PSOBPSRP",91,0)
 D SEL^PSOREJU1("USER","^VA(200,",.PSOU)  I $G(PSOU)="^" S OK=0 Q
"RTN","PSOBPSRP",92,0)
 I $G(PSOU)="ALL" S PSOUSER=1 K PSOU
"RTN","PSOBPSRP",93,0)
 Q
"RTN","PSOBPSRP",94,0)
 ;
"RTN","PSOBPSRP",95,0)
TRNS(X) ; - Translates Alpha into the corresponding Sorting Code
"RTN","PSOBPSRP",96,0)
 N L,UPX S L=$L(X),UPX=$$UP^XLFSTR(X)
"RTN","PSOBPSRP",97,0)
 I $E("PATIENT",1,L)=UPX Q 1
"RTN","PSOBPSRP",98,0)
 I $E("DRUG",1,L)=UPX Q 2
"RTN","PSOBPSRP",99,0)
 I $E("USER",1,L)=UPX Q 3
"RTN","PSOBPSRP",100,0)
 Q X
"RTN","PSOBPSRP",101,0)
 ;
"VER")
8.0^22.0
"BLD",7709,6)
^308
**END**
**END**
