Released PSJ*5*247 SEQ #225
Extracted from mail message
**KIDS**:PSJ*5.0*247^

**INSTALL NAME**
PSJ*5.0*247
"BLD",8719,0)
PSJ*5.0*247^INPATIENT MEDICATIONS^0^3120113^y
"BLD",8719,1,0)
^^5^5^3120113^
"BLD",8719,1,1,0)
This patch will make the following corrections to the Inpatient 
"BLD",8719,1,2,0)
Medications package:
"BLD",8719,1,3,0)
 
"BLD",8719,1,4,0)
- Do not allow user to delete Dispense Drug of active order
"BLD",8719,1,5,0)
- Undefined Error when discontinuing a copied IV order
"BLD",8719,4,0)
^9.64PA^53.45^1
"BLD",8719,4,53.45,0)
53.45
"BLD",8719,4,53.45,2,0)
^9.641^53.4502^1
"BLD",8719,4,53.45,2,53.4502,0)
DISPENSE DRUG  (sub-file)
"BLD",8719,4,53.45,2,53.4502,1,0)
^9.6411^.01^1
"BLD",8719,4,53.45,2,53.4502,1,.01,0)
DISPENSE DRUG
"BLD",8719,4,53.45,222)
y^y^p^^^^n^^n
"BLD",8719,4,53.45,224)

"BLD",8719,4,"APDD",53.45,53.4502)

"BLD",8719,4,"APDD",53.45,53.4502,.01)

"BLD",8719,4,"B",53.45,53.45)

"BLD",8719,6)
3^
"BLD",8719,6.3)
2
"BLD",8719,"KRN",0)
^9.67PA^779.2^20
"BLD",8719,"KRN",.4,0)
.4
"BLD",8719,"KRN",.401,0)
.401
"BLD",8719,"KRN",.402,0)
.402
"BLD",8719,"KRN",.403,0)
.403
"BLD",8719,"KRN",.5,0)
.5
"BLD",8719,"KRN",.84,0)
.84
"BLD",8719,"KRN",3.6,0)
3.6
"BLD",8719,"KRN",3.8,0)
3.8
"BLD",8719,"KRN",9.2,0)
9.2
"BLD",8719,"KRN",9.8,0)
9.8
"BLD",8719,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8719,"KRN",9.8,"NM",1,0)
PSJLIACT^^0^B42921851
"BLD",8719,"KRN",9.8,"NM","B","PSJLIACT",1)

"BLD",8719,"KRN",19,0)
19
"BLD",8719,"KRN",19.1,0)
19.1
"BLD",8719,"KRN",101,0)
101
"BLD",8719,"KRN",409.61,0)
409.61
"BLD",8719,"KRN",771,0)
771
"BLD",8719,"KRN",779.2,0)
779.2
"BLD",8719,"KRN",870,0)
870
"BLD",8719,"KRN",8989.51,0)
8989.51
"BLD",8719,"KRN",8989.52,0)
8989.52
"BLD",8719,"KRN",8994,0)
8994
"BLD",8719,"KRN","B",.4,.4)

"BLD",8719,"KRN","B",.401,.401)

"BLD",8719,"KRN","B",.402,.402)

"BLD",8719,"KRN","B",.403,.403)

"BLD",8719,"KRN","B",.5,.5)

"BLD",8719,"KRN","B",.84,.84)

"BLD",8719,"KRN","B",3.6,3.6)

"BLD",8719,"KRN","B",3.8,3.8)

"BLD",8719,"KRN","B",9.2,9.2)

"BLD",8719,"KRN","B",9.8,9.8)

"BLD",8719,"KRN","B",19,19)

"BLD",8719,"KRN","B",19.1,19.1)

"BLD",8719,"KRN","B",101,101)

"BLD",8719,"KRN","B",409.61,409.61)

"BLD",8719,"KRN","B",771,771)

"BLD",8719,"KRN","B",779.2,779.2)

"BLD",8719,"KRN","B",870,870)

"BLD",8719,"KRN","B",8989.51,8989.51)

"BLD",8719,"KRN","B",8989.52,8989.52)

"BLD",8719,"KRN","B",8994,8994)

"BLD",8719,"QUES",0)
^9.62^^
"BLD",8719,"REQB",0)
^9.611^1^1
"BLD",8719,"REQB",1,0)
PSJ*5.0*181^2
"BLD",8719,"REQB","B","PSJ*5.0*181",1)

"FIA",53.45)
INPATIENT USER PARAMETERS
"FIA",53.45,0)
^PS(53.45,
"FIA",53.45,0,0)
53.45P
"FIA",53.45,0,1)
y^y^p^^^^n^^n
"FIA",53.45,0,10)

"FIA",53.45,0,11)

"FIA",53.45,0,"RLRO")

"FIA",53.45,0,"VR")
5.0^PSJ
"FIA",53.45,53.45)
1
"FIA",53.45,53.45,2)

"FIA",53.45,53.4502)
1
"FIA",53.45,53.4502,.01)

"MBREQ")
0
"PKG",221,-1)
1^1
"PKG",221,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",221,22,0)
^9.49I^1^1
"PKG",221,22,1,0)
5.0^2971215^2981113^1
"PKG",221,22,1,"PAH",1,0)
247^3120113^520736413
"PKG",221,22,1,"PAH",1,1,0)
^^5^5^3120113
"PKG",221,22,1,"PAH",1,1,1,0)
This patch will make the following corrections to the Inpatient 
"PKG",221,22,1,"PAH",1,1,2,0)
Medications package:
"PKG",221,22,1,"PAH",1,1,3,0)
 
"PKG",221,22,1,"PAH",1,1,4,0)
- Do not allow user to delete Dispense Drug of active order
"PKG",221,22,1,"PAH",1,1,5,0)
- Undefined Error when discontinuing a copied IV order
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSJLIACT")
0^1^B42921851^B42251773
"RTN","PSJLIACT",1,0)
PSJLIACT ;BIR/MV-IV ACTION ;28 Jul 98 / 8:50 AM
"RTN","PSJLIACT",2,0)
 ;;5.0;INPATIENT MEDICATIONS ;**15,47,62,58,82,97,80,110,111,134,181,247**;16 DEC 97;Build 2
"RTN","PSJLIACT",3,0)
 ;
"RTN","PSJLIACT",4,0)
 ; Reference to ^PS(55 is supported by DBIA 2191.
"RTN","PSJLIACT",5,0)
 ; Reference to MAIN^TIUEDIT is supported by DBIA 2410.
"RTN","PSJLIACT",6,0)
 ;
"RTN","PSJLIACT",7,0)
DC ; Discontinue order
"RTN","PSJLIACT",8,0)
 K PSGORQF
"RTN","PSJLIACT",9,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",10,0)
 S PSJCOM=+$S(PSJORD["V":$P($G(^PS(55,DFN,"IV",+PSJORD,.2)),"^",8),1:$P($G(^PS(53.1,+PSJORD,.2)),"^",8))
"RTN","PSJLIACT",11,0)
 I PSJCOM W !!,"This order is part of a complex order. If you discontinue this order the",!,"following orders will be discontinued too (unless the stop date has already",!,"been reached)." D CMPLX^PSJCOM1(PSGP,PSJCOM,PSJORD)
"RTN","PSJLIACT",12,0)
 I PSJCOM F  W !!,"Do you want to discontinue this order" S %=1 D YN^DICN Q:%  D ENCOM^PSGOEM
"RTN","PSJLIACT",13,0)
 I PSJCOM,%'=1 S VALMBK="" Q
"RTN","PSJLIACT",14,0)
 I $G(ON55)["P",$G(PSIVOORD) S PSJORD=ON55 ;*247 - Correct DCing newly copied orders
"RTN","PSJLIACT",15,0)
 I PSJORD["V" D DC^PSIVORA D:'$G(PSJOCFLG) EN^PSJLIORD(DFN,ON) Q
"RTN","PSJLIACT",16,0)
 D:PSJORD["P" DISCONT^PSIVORC
"RTN","PSJLIACT",17,0)
 S VALMBCK="Q"
"RTN","PSJLIACT",18,0)
 Q
"RTN","PSJLIACT",19,0)
ACEDIT ; Display LM screen and AC and EDit actions
"RTN","PSJLIACT",20,0)
 D EN^PSJLIVMD
"RTN","PSJLIACT",21,0)
 S VALMBCK=$S($G(PSIVACEP):"Q",1:"R")
"RTN","PSJLIACT",22,0)
 Q
"RTN","PSJLIACT",23,0)
AEEXIT ; Call for EXIT CODE in PSJ LM IV AC/EDIT
"RTN","PSJLIACT",24,0)
 K PSGORQF
"RTN","PSJLIACT",25,0)
 D:ON["V" GT55^PSIVORFB
"RTN","PSJLIACT",26,0)
 I ON["P" D GT531^PSIVORFA(DFN,ON) D:P("OT")'="I" GTDATA^PSJLIFN
"RTN","PSJLIACT",27,0)
 D EN^PSJLIVMD
"RTN","PSJLIACT",28,0)
 K PSIVENO
"RTN","PSJLIACT",29,0)
 Q
"RTN","PSJLIACT",30,0)
EDIT ; Edit order
"RTN","PSJLIACT",31,0)
 K PSIVFN1 NEW PSIVNBD
"RTN","PSJLIACT",32,0)
 I $D(PSGACT),PSGACT'["E" W !,"This order may not be edited." D PAUSE^VALM1 Q
"RTN","PSJLIACT",33,0)
 D EDIT1
"RTN","PSJLIACT",34,0)
 Q:$D(PSIVNBD)!($G(PSIVCOPY)&'$G(PSIVENO))
"RTN","PSJLIACT",35,0)
 D EN^PSJLIVMD
"RTN","PSJLIACT",36,0)
 S VALMBCK=$S($G(PSIVFN1):"Q",1:"R")
"RTN","PSJLIACT",37,0)
 Q
"RTN","PSJLIACT",38,0)
EDIT1 ;
"RTN","PSJLIACT",39,0)
 K PSGORQF
"RTN","PSJLIACT",40,0)
 ;Ensure P() is defined
"RTN","PSJLIACT",41,0)
 I $D(P)<10 S XQORQUIT=1,P("PON")="",PSIVNBD=1 D  Q
"RTN","PSJLIACT",42,0)
 .W !,"WARNING: An error has occurred. Changes will not be saved"
"RTN","PSJLIACT",43,0)
 .D PAUSE^VALM1
"RTN","PSJLIACT",44,0)
 .S VALMBCK="Q"
"RTN","PSJLIACT",45,0)
 I "ANP"'[P(17) W !,"You cannot edit an inactive order" D PAUSE^VALM1 Q
"RTN","PSJLIACT",46,0)
 S:$G(ON55)="" ON55=$G(PSJORD)
"RTN","PSJLIACT",47,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",48,0)
 ;* Edit a new back door order
"RTN","PSJLIACT",49,0)
 I ($G(ON55)["V"&($G(P("21FLG"))="")) D  Q
"RTN","PSJLIACT",50,0)
 . D GSTRING^PSIVORE1,GTFLDS^PSIVORFE
"RTN","PSJLIACT",51,0)
 . I $G(ON55)["V",'$G(DONE) D OK^PSIVORE
"RTN","PSJLIACT",52,0)
 . S VALMBCK="Q",PSIVNBD=1
"RTN","PSJLIACT",53,0)
 ;* Edit an active order
"RTN","PSJLIACT",54,0)
 I $G(ON55)["V" NEW PSJEDIT1 D E^PSIVOPT1 D  Q
"RTN","PSJLIACT",55,0)
 . I $G(PSJIVBD) K PSJIVBD D EN^PSJLIORD(DFN,ON)
"RTN","PSJLIACT",56,0)
 I $G(ON55)["P" D EDIT^PSIVORC ;Edit incomplete order.
"RTN","PSJLIACT",57,0)
 K P("OVRIDE")
"RTN","PSJLIACT",58,0)
 Q
"RTN","PSJLIACT",59,0)
ACCEPT ; Accept order
"RTN","PSJLIACT",60,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",61,0)
 ;Accept IV from back door.
"RTN","PSJLIACT",62,0)
 I $G(PSJIVBD) K PSJIVBD D OK^PSIVORE S VALMBCK="Q" Q
"RTN","PSJLIACT",63,0)
 ;D:'$G(PSGORQF) IN^PSJOCDS($G(ON),"IV","") Q:$G(PSGORQF)
"RTN","PSJLIACT",64,0)
 I ON["V" D ACCEPT^PSIVOPT1 Q
"RTN","PSJLIACT",65,0)
 S PSIVFN1=1
"RTN","PSJLIACT",66,0)
 D COMPLTE^PSIVORC1
"RTN","PSJLIACT",67,0)
 S VALMBCK="Q"
"RTN","PSJLIACT",68,0)
 Q
"RTN","PSJLIACT",69,0)
R ; Renewal
"RTN","PSJLIACT",70,0)
 K PSGORQF
"RTN","PSJLIACT",71,0)
 S PSJREN=1
"RTN","PSJLIACT",72,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",73,0)
 NEW PSIVAC S PSIVAC="PR" K PSGFDX
"RTN","PSJLIACT",74,0)
 D R^PSIVOPT
"RTN","PSJLIACT",75,0)
 D EN^PSJLIORD(DFN,ON)
"RTN","PSJLIACT",76,0)
 K PSJREN
"RTN","PSJLIACT",77,0)
 Q
"RTN","PSJLIACT",78,0)
H ; Hold
"RTN","PSJLIACT",79,0)
 K PSGORQF
"RTN","PSJLIACT",80,0)
 NEW TEX S TEX="Active order ***"
"RTN","PSJLIACT",81,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",82,0)
 D H^PSIVOPT(DFN,ON,P(17),P(3))
"RTN","PSJLIACT",83,0)
 D:P(17)="A" PAUSE^VALM1
"RTN","PSJLIACT",84,0)
 D EN^PSJLIORD(DFN,ON)
"RTN","PSJLIACT",85,0)
 Q
"RTN","PSJLIACT",86,0)
L ; Activity Log
"RTN","PSJLIACT",87,0)
 NEW PSIVLAB,PSIVLOG,PSJHIS S (PSIVLAB,PSIVLOG)=1
"RTN","PSJLIACT",88,0)
 D EN^PSIVVW1
"RTN","PSJLIACT",89,0)
 D EN^PSJLIVMD
"RTN","PSJLIACT",90,0)
 S VALMBCK="R"
"RTN","PSJLIACT",91,0)
 Q
"RTN","PSJLIACT",92,0)
O ; On Call
"RTN","PSJLIACT",93,0)
 K PSGORQF
"RTN","PSJLIACT",94,0)
 NEW TEX S TEX="Active order ***"
"RTN","PSJLIACT",95,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIACT",96,0)
 D O^PSIVOPT(DFN,ON,P(17),P(3))
"RTN","PSJLIACT",97,0)
 D:P(17)="A" PAUSE^VALM1
"RTN","PSJLIACT",98,0)
 D EN^PSJLIORD(DFN,ON)
"RTN","PSJLIACT",99,0)
 Q
"RTN","PSJLIACT",100,0)
VF ; Make the order active
"RTN","PSJLIACT",101,0)
 NEW PSIVCHG S PSIVCHG=0
"RTN","PSJLIACT",102,0)
 I ON["V" S ON55=ON D VF1("V","ORDER VERIFIED BY ",1) Q
"RTN","PSJLIACT",103,0)
 D ACTIVE^PSIVORC2
"RTN","PSJLIACT",104,0)
 Q
"RTN","PSJLIACT",105,0)
VF1(PSIVREA,PSIVAL,PSIVLOG) ;
"RTN","PSJLIACT",106,0)
 ;Update 4 node and set activity log.
"RTN","PSJLIACT",107,0)
 ;PSIVREA: the reason use by LOG^PSIVORAL
"RTN","PSJLIACT",108,0)
 ;PSIVAL : the description reason
"RTN","PSJLIACT",109,0)
 ;PSIVLOG: Log an activity if = 1
"RTN","PSJLIACT",110,0)
 K PSGORQF
"RTN","PSJLIACT",111,0)
 I '+$G(OD)!($L($G(OD))>16) K OD
"RTN","PSJLIACT",112,0)
 D:+PSJSYSU=3 ^PSIVORE1
"RTN","PSJLIACT",113,0)
 NEW DIE,DA,DR,PSJX,XX,PSIVACT,PSJRQND
"RTN","PSJLIACT",114,0)
 S PSIVACT=1
"RTN","PSJLIACT",115,0)
 S PSJX=$G(^PS(55,DFN,"IV",+ON55,4)),XX=""
"RTN","PSJLIACT",116,0)
 I $P(PSJX,U)="" S XX=";143////0"
"RTN","PSJLIACT",117,0)
 I $P(PSJX,U,4)="" S XX=XX_U_";142////0"
"RTN","PSJLIACT",118,0)
 D NOW^%DTC
"RTN","PSJLIACT",119,0)
 S DIE="^PS(55,"_DFN_",""IV"",",DA=+ON55,DA(1)=DFN
"RTN","PSJLIACT",120,0)
 I +PSJSYSU=3 S DR="140////"_DUZ_";141////"_$E(%,1,12)_";142////1"_$P(XX,U)
"RTN","PSJLIACT",121,0)
 I +PSJSYSU=1 S DR="16////"_DUZ_";17////"_$E(%,1,12)_";143////1"_$P(XX,U,2)
"RTN","PSJLIACT",122,0)
 I $G(P("PRY"))="D" S DR=DR_";.22////"_+P("IVRM")
"RTN","PSJLIACT",123,0)
 D ^DIE
"RTN","PSJLIACT",124,0)
 ; If pending IV renew is edited during finish, go back and DE the original active order left in RENEWED status
"RTN","PSJLIACT",125,0)
 S PREREN=$S(ON55["V":$G(@(DIE_"+ON55,2)")),1:""),PREREN=$P(PREREN,"^",5) I PREREN D  K PREREN
"RTN","PSJLIACT",126,0)
 . I PREREN["P" S PREREN=$G(@("^PS(53.1,+PREREN,0)")),PREREN=$P(PREREN,"^",25)
"RTN","PSJLIACT",127,0)
 . I PREREN["V" N PRERENOD S PRERENOD=$G(@("^PS(55,DFN,""IV"",+PREREN,0)")) I $P(PRERENOD,"^",17)="R",($G(P("RES"))="E") D
"RTN","PSJLIACT",128,0)
 ..  S DIE="^PS(55,"_DFN_",""IV"",",DA=+PREREN,DA(1)=DFN
"RTN","PSJLIACT",129,0)
 ..  S DR="100////D;.03////"_PSGDT S ORIGSTOP=$P($G(@("^PS(55,DFN,""IV"",+PREREN,2)")),"^",3) I ORIGSTOP S DR=DR_";116////"_ORIGSTOP
"RTN","PSJLIACT",130,0)
 ..  D ^DIE D EN1^PSJHL2(DFN,"SC",PREREN)
"RTN","PSJLIACT",131,0)
 K DR,DIE,DA
"RTN","PSJLIACT",132,0)
 I (+PSJSYSU=3)&($G(P("PRY"))="D") D
"RTN","PSJLIACT",133,0)
 .N DIR W ! S DIR(0)="S^Y:Yes;N:No",DIR("A")="Do you want to enter a Progress Note",DIR("B")="No" D ^DIR
"RTN","PSJLIACT",134,0)
 .Q:Y="N"
"RTN","PSJLIACT",135,0)
 .D MAIN^TIUEDIT(3,.TIUDA,DFN,"","","","",1)
"RTN","PSJLIACT",136,0)
 Q:'$G(PSIVLOG)
"RTN","PSJLIACT",137,0)
 I $G(P("PACT"))]"",+$P(P("PACT"),U,2),+$P(P("PACT"),U,3) D
"RTN","PSJLIACT",138,0)
 . NEW DIC,DA,X,Y,XX,DO D NAME^PSJBCMA1($P(P("PACT"),U,2),.XX)
"RTN","PSJLIACT",139,0)
 . S DIC(0)="L",DA(1)=DFN,DA(2)=+ON55,X=1
"RTN","PSJLIACT",140,0)
 . S DIC="^PS(55,"_DA(1)_",""IV"","_DA(2)_",""A"","
"RTN","PSJLIACT",141,0)
 . S DIC("DR")=".02////F;.03////"_XX_";.04////"_$P($G(^PS(53.3,+$P(P("PACT"),U,3),0)),U)_";.05////"_$P(P("PACT"),U)_";.06////"_$P(P("PACT"),U,2)
"RTN","PSJLIACT",142,0)
 . D FILE^DICN
"RTN","PSJLIACT",143,0)
 NEW PSIVALCK
"RTN","PSJLIACT",144,0)
 S PSIVREA="V",PSIVALT=""
"RTN","PSJLIACT",145,0)
 S PSIVAL=PSIVAL_$S(+PSJSYSU=3:"PHARMACIST",1:"NURSE")
"RTN","PSJLIACT",146,0)
 D LOG^PSIVORAL K PSIVAL,PSIVREA,PSIVLN
"RTN","PSJLIACT",147,0)
 I $G(PSJORD)["P" S PSIVREA="V",PSIVALT="",PSGRDTX=$G(^PS(53.1,+PSJORD,2.5)) D
"RTN","PSJLIACT",148,0)
 . I $G(PSGRDTX) S PSIVAL="Requested Start Date: "_$$ENDTC^PSGMI($$DATE2^PSJUTL2($P(PSGRDTX,U))) D LOG^PSIVORAL
"RTN","PSJLIACT",149,0)
 . I $P(PSGRDTX,U,3) S PSIVREA="V",PSIVALT="" S PSIVAL="Requested Stop Date: "_$$ENDTC^PSGMI($$DATE2^PSJUTL2($P(PSGRDTX,U,3))) D LOG^PSIVORAL
"RTN","PSJLIACT",150,0)
 N DUR I $G(PSJORD) S DUR=$$GETDUR^PSJLIVMD(DFN,+PSJORD,$S(PSJORD["P":"P",1:"IV"),1) I DUR]""  D
"RTN","PSJLIACT",151,0)
 . K DR S DIE="^PS(55,"_DFN_",""IV"",",DA=+ON55,DA(1)=DFN
"RTN","PSJLIACT",152,0)
 . S DR=$S($G(IVLIMIT):"152////"_DUR,1:"151////"_DUR) K IVLIMIT
"RTN","PSJLIACT",153,0)
 . D ^DIE
"RTN","PSJLIACT",154,0)
 D EN1^PSJHL2(DFN,"SC",ON55)
"RTN","PSJLIACT",155,0)
 D:+PSJSYSU=1 EN1^PSJHL2(DFN,"ZV",ON55)
"RTN","PSJLIACT",156,0)
 D GT55^PSIVORFB S OLDON=$P($G(^PS(55,DFN,"IV",+ON55,2)),"^",5),P("OLDON")=OLDON
"RTN","PSJLIACT",157,0)
 N PSJPRIO,PSJSCH,NODE0,NODEP2 S NODE0=$G(^PS(55,DFN,"IV",+ON55,0)),NODEP2=$G(^PS(55,DFN,"IV",+ON55,.2))
"RTN","PSJLIACT",158,0)
 S PSJPRIO=$P(NODEP2,"^",4),PSJSCH=$P(NODE0,"^",9)
"RTN","PSJLIACT",159,0)
 I (",S,A,")[(","_$G(PSJPRIO)_",")!($G(PSJSCH)="NOW")!($G(PSJSCH)["STAT") D NOTIFY^PSJHL4(ON55,DFN,$G(PSJPRIO),$G(PSJSCH))
"RTN","PSJLIACT",160,0)
 Q
"SEC","^DD",53.45,53.4502,.01,8.5)

"UP",53.45,53.4502,-1)
53.45^2
"UP",53.45,53.4502,0)
53.4502
"VER")
8.0^22.0
"^DD",53.45,53.45,2,0)
DISPENSE DRUG^53.4502P^^2;0
"^DD",53.45,53.45,2,20,0)
^.3LA^1^1
"^DD",53.45,53.45,2,20,1,0)
PSJ
"^DD",53.45,53.45,2,21,0)
^.001^2^2^3110509^^^^
"^DD",53.45,53.45,2,21,1,0)
  This is the medication(s) that will actually be dispensed by the pharmacy
"^DD",53.45,53.45,2,21,2,0)
for the Unit Dose order.
"^DD",53.45,53.45,2,23,0)
^.001^2^2^3110509^^^^
"^DD",53.45,53.45,2,23,1,0)
  Used by the Inpatient Medications package as temporary storage when
"^DD",53.45,53.45,2,23,2,0)
processing orders.  This should not be directly accessed by the user.
"^DD",53.45,53.45,2,"DT")
2971209
"^DD",53.45,53.4502,0)
DISPENSE DRUG SUB-FIELD^^.03^3
"^DD",53.45,53.4502,0,"NM","DISPENSE DRUG")

"^DD",53.45,53.4502,.01,0)
DISPENSE DRUG^M*P50'X^PSDRUG(^0;1^S DIC("S")="I $P($G(^(2)),U,3)[""U"",$S('$G(PSGPDRG):1,1:PSGPDRG=+$G(^(2))) I (($G(^PSDRUG(+$G(Y),""I""))>(DT-1))!'$G(^PSDRUG(+$G(Y),""I"")))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",53.45,53.4502,.01,1,0)
^.1
"^DD",53.45,53.4502,.01,1,1,0)
53.4502^B
"^DD",53.45,53.4502,.01,1,1,1)
S ^PS(53.45,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",53.45,53.4502,.01,1,1,2)
K ^PS(53.45,DA(1),2,"B",$E(X,1,30),DA)
"^DD",53.45,53.4502,.01,4)
I $G(PSGPDRG) S X(1)=$G(PSGPDRGN) S:X(1)="" X(1)=PSGPDRG S X(1)="Only dispense drugs tied to the Orderable Item "_X(1)_" are selectable." D EN^DDIOL(" ") F X(2)=1:1:$L(X(1)," ") S X(3)=$P(X(1)," ",X(2)) D:$L(X(3))+$X>78 EN^DDIOL(" "_X(3))
"^DD",53.45,53.4502,.01,7.5)
S DIC("S")="I 1"
"^DD",53.45,53.4502,.01,12)
Only dispense drugs marked for Unit Dose use.
"^DD",53.45,53.4502,.01,12.1)
S DIC("S")="I $P($G(^(2)),U,3)[""U"",$S('$G(PSGPDRG):1,1:PSGPDRG=+$G(^(2)))"
"^DD",53.45,53.4502,.01,20,0)
^.3LA^1^1
"^DD",53.45,53.4502,.01,20,1,0)
PSJ
"^DD",53.45,53.4502,.01,"DEL",1,0)
D:$G(PSGOEEND) EN^DDIOL("Dispense Drugs for active orders cannot be deleted, but can be given an INACTIVE DATE.") D:$G(PSJPNDRN)&$G(^PS(53.1,+$G(ON),1,+$G(DA),0)) EN^DDIOL($P(PSJPNDRN,"^",2)) I $G(PSGOEEND)!$G(PSJPNDRN)
"^DD",53.45,53.4502,.01,"DT")
3110509
"^DD",53.45,53.4502,.01,"LAYGO",1,0)
S X(1)=$D(^PS(53.45,DA,2,"B",+X)) D:X(1) EN^DDIOL("This dispense drug has already been entered for this order.") I 'X(1)
"BLD",8719,6)
^225
**END**
**END**
