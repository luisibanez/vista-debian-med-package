Released PSJ*5*250 SEQ #216
Extracted from mail message
**KIDS**:PSJ*5.0*250^

**INSTALL NAME**
PSJ*5.0*250
"BLD",8753,0)
PSJ*5.0*250^INPATIENT MEDICATIONS^0^3110725^y
"BLD",8753,1,0)
^^5^5^3110613^
"BLD",8753,1,1,0)
The purpose of this patch is to provide a software bug fix for Inpatient
"BLD",8753,1,2,0)
Medications, and to correct the method of reprinting IV labels.  This 
"BLD",8753,1,3,0)
patch corrects the following issue:
"BLD",8753,1,4,0)
 
"BLD",8753,1,5,0)
-Invalid barcode when IVPB order changed
"BLD",8753,4,0)
^9.64PA^^
"BLD",8753,6.3)
6
"BLD",8753,"KRN",0)
^9.67PA^779.2^20
"BLD",8753,"KRN",.4,0)
.4
"BLD",8753,"KRN",.401,0)
.401
"BLD",8753,"KRN",.402,0)
.402
"BLD",8753,"KRN",.403,0)
.403
"BLD",8753,"KRN",.5,0)
.5
"BLD",8753,"KRN",.84,0)
.84
"BLD",8753,"KRN",3.6,0)
3.6
"BLD",8753,"KRN",3.8,0)
3.8
"BLD",8753,"KRN",9.2,0)
9.2
"BLD",8753,"KRN",9.8,0)
9.8
"BLD",8753,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8753,"KRN",9.8,"NM",1,0)
PSIVLBRP^^0^B15941220
"BLD",8753,"KRN",9.8,"NM","B","PSIVLBRP",1)

"BLD",8753,"KRN",19,0)
19
"BLD",8753,"KRN",19.1,0)
19.1
"BLD",8753,"KRN",101,0)
101
"BLD",8753,"KRN",409.61,0)
409.61
"BLD",8753,"KRN",771,0)
771
"BLD",8753,"KRN",779.2,0)
779.2
"BLD",8753,"KRN",870,0)
870
"BLD",8753,"KRN",8989.51,0)
8989.51
"BLD",8753,"KRN",8989.52,0)
8989.52
"BLD",8753,"KRN",8994,0)
8994
"BLD",8753,"KRN","B",.4,.4)

"BLD",8753,"KRN","B",.401,.401)

"BLD",8753,"KRN","B",.402,.402)

"BLD",8753,"KRN","B",.403,.403)

"BLD",8753,"KRN","B",.5,.5)

"BLD",8753,"KRN","B",.84,.84)

"BLD",8753,"KRN","B",3.6,3.6)

"BLD",8753,"KRN","B",3.8,3.8)

"BLD",8753,"KRN","B",9.2,9.2)

"BLD",8753,"KRN","B",9.8,9.8)

"BLD",8753,"KRN","B",19,19)

"BLD",8753,"KRN","B",19.1,19.1)

"BLD",8753,"KRN","B",101,101)

"BLD",8753,"KRN","B",409.61,409.61)

"BLD",8753,"KRN","B",771,771)

"BLD",8753,"KRN","B",779.2,779.2)

"BLD",8753,"KRN","B",870,870)

"BLD",8753,"KRN","B",8989.51,8989.51)

"BLD",8753,"KRN","B",8989.52,8989.52)

"BLD",8753,"KRN","B",8994,8994)

"BLD",8753,"QUES",0)
^9.62^^
"BLD",8753,"REQB",0)
^9.611^1^1
"BLD",8753,"REQB",1,0)
PSJ*5.0*97^2
"BLD",8753,"REQB","B","PSJ*5.0*97",1)

"MBREQ")
0
"PKG",471,-1)
1^1
"PKG",471,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",471,20,0)
^9.402P^^
"PKG",471,22,0)
^9.49I^1^1
"PKG",471,22,1,0)
5.0^2971215^2990325^66481
"PKG",471,22,1,"PAH",1,0)
250^3110725
"PKG",471,22,1,"PAH",1,1,0)
^^5^5^3110725
"PKG",471,22,1,"PAH",1,1,1,0)
The purpose of this patch is to provide a software bug fix for Inpatient
"PKG",471,22,1,"PAH",1,1,2,0)
Medications, and to correct the method of reprinting IV labels.  This 
"PKG",471,22,1,"PAH",1,1,3,0)
patch corrects the following issue:
"PKG",471,22,1,"PAH",1,1,4,0)
 
"PKG",471,22,1,"PAH",1,1,5,0)
-Invalid barcode when IVPB order changed
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSIVLBRP")
0^1^B15941220^B11352485
"RTN","PSIVLBRP",1,0)
PSIVLBRP ;BIR/MV - REPRINT LABELS FOR AN ORDER ;15 May 2001  3:29 PM
"RTN","PSIVLBRP",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**58,97,250**;16 DEC 97;Build 6
"RTN","PSIVLBRP",3,0)
 ;
"RTN","PSIVLBRP",4,0)
 ; Reference to ^PS(55 is supported by DBIA 2191.
"RTN","PSIVLBRP",5,0)
 ;
"RTN","PSIVLBRP",6,0)
EN(PSJIDLST) ;
"RTN","PSIVLBRP",7,0)
 I '$D(PSJIDLST) W !,"No labels are available" D PAUSE^VALM1 Q
"RTN","PSIVLBRP",8,0)
 NEW DIR,PSIVCTD
"RTN","PSIVLBRP",9,0)
 S PSIVCT=1
"RTN","PSIVLBRP",10,0)
 W !!,"Count as daily usage" S %=1 D YN^DICN Q:%=-1  S PSIVCTD=$S(%=1:1,1:0)
"RTN","PSIVLBRP",11,0)
 I PSIVCTD=1 K PSIVCT
"RTN","PSIVLBRP",12,0)
 S PSJY=$$PROMPT()
"RTN","PSIVLBRP",13,0)
 Q:PSJY=""
"RTN","PSIVLBRP",14,0)
 ;*PSJ*5*250
"RTN","PSIVLBRP",15,0)
 N PSJSEL,PSJSEL1,PSJID,PSJSOL,PSJSOLERR,PSJERRLST
"RTN","PSIVLBRP",16,0)
 S PSJERRLST=""
"RTN","PSIVLBRP",17,0)
 F PSJSEL=1:1 S PSJSEL1=$P(PSJY,",",PSJSEL) Q:PSJSEL1=""  D
"RTN","PSIVLBRP",18,0)
 . S PSJID=$G(PSJIDLST(PSJSEL1)) Q:PSJID=""
"RTN","PSIVLBRP",19,0)
 . S PSJIDNO=$P(PSJID,"V",2)
"RTN","PSIVLBRP",20,0)
 . F PSJSOL=0:0 S PSJSOL=$O(^PS(55,DFN,"IVBCMA",PSJIDNO,"SOL",PSJSOL)) Q:'PSJSOL  D
"RTN","PSIVLBRP",21,0)
 . . I $G(^PS(55,DFN,"IVBCMA",PSJIDNO,"SOL",PSJSOL,0))'=$G(^PS(55,DFN,"IV",+ON,"SOL",PSJSOL,0)) S PSJSOLERR=1,PSJERRLST=PSJERRLST_$S(PSJERRLST="":PSJID,1:", "_PSJID)
"RTN","PSIVLBRP",22,0)
 I $G(PSJSOLERR) D FULL^VALM1 S DIR("A",1)="Solution on label(s) "_PSJERRLST_" does not match current order." S DIR("A")="Enter RETURN to continue" S DIR(0)="FO" D ^DIR Q
"RTN","PSIVLBRP",23,0)
 ;*END PSJ*5*250
"RTN","PSIVLBRP",24,0)
 D PRT
"RTN","PSIVLBRP",25,0)
 Q
"RTN","PSIVLBRP",26,0)
PROMPT() ;
"RTN","PSIVLBRP",27,0)
 W !
"RTN","PSIVLBRP",28,0)
 S DIR(0)="LOA^1:"_PSJIDLST,DIR("A")="Select from 1 - "_PSJIDLST_" or <RETURN> to select by BCMA ID: " D ^DIR
"RTN","PSIVLBRP",29,0)
 K DIR
"RTN","PSIVLBRP",30,0)
 S PSJY=Y
"RTN","PSIVLBRP",31,0)
 I PSJY="" S DIR(0)="FOA^1:50^S X=$$UP^XLFSTR(X) K:'$D(PSJIDLST(X)) X",DIR("A")="Enter a BCMA ID: " D ^DIR S PSJY=$$UP^XLFSTR(Y)
"RTN","PSIVLBRP",32,0)
 K DIR
"RTN","PSIVLBRP",33,0)
 W !!
"RTN","PSIVLBRP",34,0)
 Q PSJY
"RTN","PSIVLBRP",35,0)
DEQIA ;
"RTN","PSIVLBRP",36,0)
 S PSIVNOL=0
"RTN","PSIVLBRP",37,0)
 F PSJSEL=1:1 S PSJSEL1=$P(PSJY,",",PSJSEL) Q:PSJSEL1=""  S PSIVNOL=PSIVNOL+1
"RTN","PSIVLBRP",38,0)
 F PSJSEL=1:1 S PSJSEL1=$P(PSJY,",",PSJSEL) Q:PSJSEL1=""  D
"RTN","PSIVLBRP",39,0)
 . S:'PSIVCTD PSIVCT=1
"RTN","PSIVLBRP",40,0)
 . S PSJID=$G(PSJIDLST(PSJSEL1)) Q:PSJID=""  D REPRT(PSJID)
"RTN","PSIVLBRP",41,0)
 K PSJRPHD
"RTN","PSIVLBRP",42,0)
 Q
"RTN","PSIVLBRP",43,0)
REPRT(PSJID) ;
"RTN","PSIVLBRP",44,0)
 S PSJNEWID=$$BCMA^PSIVBCID(DFN,ON,$D(PSIVCT),$G(PSIV1),$G(PSIV2),$G(PSIVNOL))
"RTN","PSIVLBRP",45,0)
 I PSJNEWID="" W !,"Can't get a new BCMA ID.  Try again" Q
"RTN","PSIVLBRP",46,0)
 S PSJIDNO=$P(PSJID,"V",2)
"RTN","PSIVLBRP",47,0)
 S PSIVBAG=$P($G(^PS(55,DFN,"IVBCMA",PSJIDNO,0)),U,8)
"RTN","PSIVLBRP",48,0)
 N DA,DR,DIE,DIC
"RTN","PSIVLBRP",49,0)
 ;S DIC(0)="L",DA=Y,DA(1)=DFN,X=PSJNEWID,DIC="^PS(55,"_DA(1)_",""IVBCMA""," D FILE^DICN
"RTN","PSIVLBRP",50,0)
 K DA,DR,DIE S DIE="^PS(55,"_DFN_",""IVBCMA"",",DA=$P(PSJNEWID,"V",2),DA(1)=DFN D NOW^%DTC
"RTN","PSIVLBRP",51,0)
 ;S DR=".02////"_+ON_";3////"_PSIVCTD_";4////"_$E(%,1,12)_";6////"_PSIVBAG D ^DIE
"RTN","PSIVLBRP",52,0)
 S DR="6////"_PSIVBAG D ^DIE
"RTN","PSIVLBRP",53,0)
 K DA,DR,DIE,DIC
"RTN","PSIVLBRP",54,0)
 S PSJNEWID=$P(PSJNEWID,"V",2)
"RTN","PSIVLBRP",55,0)
 F PSJAD=0:0 S PSJAD=$O(^PS(55,DFN,"IVBCMA",PSJIDNO,"AD",PSJAD)) Q:'PSJAD  D
"RTN","PSIVLBRP",56,0)
 . S PSJADX=$G(^PS(55,DFN,"IVBCMA",PSJIDNO,"AD",PSJAD,0))
"RTN","PSIVLBRP",57,0)
 . D UP2^PSIVBCID(DFN,PSJNEWID,PSJAD,PSJADX)
"RTN","PSIVLBRP",58,0)
 F PSJSOL=0:0 S PSJSOL=$O(^PS(55,DFN,"IVBCMA",PSJIDNO,"SOL",PSJSOL)) Q:'PSJSOL  D
"RTN","PSIVLBRP",59,0)
 . S PSJSOLX=$G(^PS(55,DFN,"IVBCMA",PSJIDNO,"SOL",PSJSOL,0))
"RTN","PSIVLBRP",60,0)
 . D UP3^PSIVBCID(DFN,PSJNEWID,PSJSOL,PSJSOLX)
"RTN","PSIVLBRP",61,0)
 K DA,DR,DIE,DIC
"RTN","PSIVLBRP",62,0)
 S DA=PSJIDNO,DA(1)=DFN,DIE="^PS(55,"_DA(1)_",""IVBCMA"","
"RTN","PSIVLBRP",63,0)
 S DR="5////RP" D ^DIE
"RTN","PSIVLBRP",64,0)
 K DA,DR,DIE,DIC
"RTN","PSIVLBRP",65,0)
 D ^PSIVHYPR:P(4)="H",^PSIVLABR:"APSC"[P(4) S:$D(ZTQUEUED) ZTREQ="@"
"RTN","PSIVLBRP",66,0)
 ;PSJRPHD is defined so ^PSIVLABR won't print the header for sub-labels.
"RTN","PSIVLBRP",67,0)
 S PSJRPHD=1
"RTN","PSIVLBRP",68,0)
 ;If reprinting from war/man list, store new BCMA ID.
"RTN","PSIVLBRP",69,0)
 S:$G(PSIVWMFL) PSIVID(PSJNEWID)=""
"RTN","PSIVLBRP",70,0)
 Q
"RTN","PSIVLBRP",71,0)
PRT ;
"RTN","PSIVLBRP",72,0)
 S IONOFF="",IOP=PSIVPL,%ZIS="NQ" D ^%ZIS G:POP Q I IO=IO(0),($E(IOST)="C") W !!! D DEQIA,Q D HOME^%ZIS Q
"RTN","PSIVLBRP",73,0)
 D HOME^%ZIS
"RTN","PSIVLBRP",74,0)
 W ! S ZTDTH=$H,ZTIO=PSIVPL,ZTDESC="REPRINT INDIVIDUAL IV LABELS",ZTRTN="DEQIA^PSIVLBRP" F X="IONOFF","P16","PSIVAC","PSIVSN","PSIVSITE","DFN","ON","PSJSYSW0","PSJSYSU","PSJSYSP0","PSJIDLST(","P(","PSJY","PSIVCTD" S ZTSAVE(X)=""
"RTN","PSIVLBRP",75,0)
 S:$D(PSIVCT) ZTSAVE("PSIVCT")="" D ^%ZTLOAD W:$D(ZTSK) !,"Queued."
"RTN","PSIVLBRP",76,0)
 Q
"RTN","PSIVLBRP",77,0)
Q ;
"RTN","PSIVLBRP",78,0)
 Q
"VER")
8.0^22.0
"BLD",8753,6)
^216
**END**
**END**
