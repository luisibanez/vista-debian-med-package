KIDS Distribution saved on May 27, 2011@10:34:49
PSJ*5*261 T2 05/27/11
**KIDS**:PSJ*5.0*261^

**INSTALL NAME**
PSJ*5.0*261
"BLD",7993,0)
PSJ*5.0*261^INPATIENT MEDICATIONS^0^3110527^y
"BLD",7993,1,0)
^^7^7^3110525^
"BLD",7993,1,1,0)
Incorrect stop dates are being populated when an IV medication order is 
"BLD",7993,1,2,0)
entered in CPRS as an inpatient medication and when the pharmacist 
"BLD",7993,1,3,0)
finishes the order as an IV piggyback and additives do not exist (are not 
"BLD",7993,1,4,0)
populated) at the time the pharmacist goes to finish the order.  The 
"BLD",7993,1,5,0)
software no longer recognizes the stop date information entered in the IV 
"BLD",7993,1,6,0)
additive file or in the Orderable Item file.  Instead it is looking at 
"BLD",7993,1,7,0)
only the IV Site parameter date for IV piggybacks.
"BLD",7993,4,0)
^9.64PA^^
"BLD",7993,6)
35^
"BLD",7993,6.3)
47
"BLD",7993,"ABPKG")
n
"BLD",7993,"KRN",0)
^9.67PA^779.2^20
"BLD",7993,"KRN",.4,0)
.4
"BLD",7993,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7993,"KRN",.401,0)
.401
"BLD",7993,"KRN",.402,0)
.402
"BLD",7993,"KRN",.403,0)
.403
"BLD",7993,"KRN",.5,0)
.5
"BLD",7993,"KRN",.84,0)
.84
"BLD",7993,"KRN",3.6,0)
3.6
"BLD",7993,"KRN",3.8,0)
3.8
"BLD",7993,"KRN",9.2,0)
9.2
"BLD",7993,"KRN",9.8,0)
9.8
"BLD",7993,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7993,"KRN",9.8,"NM",1,0)
PSJLIFN^^0^B28721093
"BLD",7993,"KRN",9.8,"NM",2,0)
PSJLIFNI^^0^B11456971
"BLD",7993,"KRN",9.8,"NM","B","PSJLIFN",1)

"BLD",7993,"KRN",9.8,"NM","B","PSJLIFNI",2)

"BLD",7993,"KRN",19,0)
19
"BLD",7993,"KRN",19,"NM",0)
^9.68A^^
"BLD",7993,"KRN",19.1,0)
19.1
"BLD",7993,"KRN",101,0)
101
"BLD",7993,"KRN",409.61,0)
409.61
"BLD",7993,"KRN",771,0)
771
"BLD",7993,"KRN",779.2,0)
779.2
"BLD",7993,"KRN",870,0)
870
"BLD",7993,"KRN",8989.51,0)
8989.51
"BLD",7993,"KRN",8989.52,0)
8989.52
"BLD",7993,"KRN",8994,0)
8994
"BLD",7993,"KRN","B",.4,.4)

"BLD",7993,"KRN","B",.401,.401)

"BLD",7993,"KRN","B",.402,.402)

"BLD",7993,"KRN","B",.403,.403)

"BLD",7993,"KRN","B",.5,.5)

"BLD",7993,"KRN","B",.84,.84)

"BLD",7993,"KRN","B",3.6,3.6)

"BLD",7993,"KRN","B",3.8,3.8)

"BLD",7993,"KRN","B",9.2,9.2)

"BLD",7993,"KRN","B",9.8,9.8)

"BLD",7993,"KRN","B",19,19)

"BLD",7993,"KRN","B",19.1,19.1)

"BLD",7993,"KRN","B",101,101)

"BLD",7993,"KRN","B",409.61,409.61)

"BLD",7993,"KRN","B",771,771)

"BLD",7993,"KRN","B",779.2,779.2)

"BLD",7993,"KRN","B",870,870)

"BLD",7993,"KRN","B",8989.51,8989.51)

"BLD",7993,"KRN","B",8989.52,8989.52)

"BLD",7993,"KRN","B",8994,8994)

"BLD",7993,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",7993,"QUES",0)
^9.62^^
"BLD",7993,"REQB",0)
^9.611^1^1
"BLD",7993,"REQB",1,0)
PSJ*5.0*181^2
"BLD",7993,"REQB","B","PSJ*5.0*181",1)

"MBREQ")
0
"PKG",197,-1)
1^1
"PKG",197,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",197,20,0)
^9.402P^^
"PKG",197,22,0)
^9.49I^1^1
"PKG",197,22,1,0)
5.0^2971215^2980917^11712
"PKG",197,22,1,"PAH",1,0)
261^3110527
"PKG",197,22,1,"PAH",1,1,0)
^^7^7^3110527
"PKG",197,22,1,"PAH",1,1,1,0)
Incorrect stop dates are being populated when an IV medication order is 
"PKG",197,22,1,"PAH",1,1,2,0)
entered in CPRS as an inpatient medication and when the pharmacist 
"PKG",197,22,1,"PAH",1,1,3,0)
finishes the order as an IV piggyback and additives do not exist (are not 
"PKG",197,22,1,"PAH",1,1,4,0)
populated) at the time the pharmacist goes to finish the order.  The 
"PKG",197,22,1,"PAH",1,1,5,0)
software no longer recognizes the stop date information entered in the IV 
"PKG",197,22,1,"PAH",1,1,6,0)
additive file or in the Orderable Item file.  Instead it is looking at 
"PKG",197,22,1,"PAH",1,1,7,0)
only the IV Site parameter date for IV piggybacks.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSJLIFN")
0^1^B28721093
"RTN","PSJLIFN",1,0)
PSJLIFN ;BIR/MV-IV FINISH USING LM ;13 Jan 98 / 11:32 AM
"RTN","PSJLIFN",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**1,29,34,37,42,47,50,56,94,80,116,110,181,261**;16 DEC 97;Build 47
"RTN","PSJLIFN",3,0)
 ;
"RTN","PSJLIFN",4,0)
 ; Reference to ^PS(51.2 is supported by DBIA #2178.
"RTN","PSJLIFN",5,0)
 ; Reference to ^PS(52.6 supported by DBIA #1231.
"RTN","PSJLIFN",6,0)
 ; Reference to ^PS(52.7 supported by DBIA #2173.
"RTN","PSJLIFN",7,0)
 ; Reference to ^PSDRUG( is supported by DBIA #2192.
"RTN","PSJLIFN",8,0)
 ; Reference to ^PSOORDRG is supported by DBIA #2190.
"RTN","PSJLIFN",9,0)
 ; Reference to ^%DT is supported by DBIA #10003.
"RTN","PSJLIFN",10,0)
 ; Reference to ^VALM is supported by DBIA #10118.
"RTN","PSJLIFN",11,0)
 ; Reference to ^VALM1 is supported by DBIA #10116.
"RTN","PSJLIFN",12,0)
 ; Reference to RE^VALM4 is supported by DBIA #10120.
"RTN","PSJLIFN",13,0)
 ;
"RTN","PSJLIFN",14,0)
EN ; Display order with numbers.
"RTN","PSJLIFN",15,0)
 L +^PS(53.1,+PSJORD):1 I '$T W !,$C(7),$C(7),"This order is being edited by another user. Try later." D PAUSE^VALM1 Q
"RTN","PSJLIFN",16,0)
 D PENDING K PSJREN
"RTN","PSJLIFN",17,0)
 L -^PS(53.1,+PSJORD)
"RTN","PSJLIFN",18,0)
 Q
"RTN","PSJLIFN",19,0)
PENDING ; Process pending order.
"RTN","PSJLIFN",20,0)
 ;* PSIVFN1 is used so it will display the AC/Edit screen
"RTN","PSJLIFN",21,0)
 ;* instead of go to the "IS this O.K." prompt
"RTN","PSJLIFN",22,0)
 ;* PSIVACEP only when accept the order. Original screen won't redisp.
"RTN","PSJLIFN",23,0)
 ;* PSJLMX is defined in WRTDRG^PSIVUTL and it was being call in PSJLIVMD & PSJLIVFD
"RTN","PSJLIFN",24,0)
 ;*        to count # of AD/SOL 
"RTN","PSJLIFN",25,0)
 NEW PSIVFN1,PSIVACEP,PSJLMX,PSIVOI,PSJOCCHK,PSJFNDS
"RTN","PSJLIFN",26,0)
 K PSJIVBD ;This varable was left over from the new backdoor order entry.
"RTN","PSJLIFN",27,0)
 ; PSJOCCHK is set so if EDIT was use instead of FN to finish order the OC is triggered
"RTN","PSJLIFN",28,0)
 S PSJOCCHK=1
"RTN","PSJLIFN",29,0)
 ;* PSJFNDS is set so dosing is trigger during finishing without changes to the add/sol
"RTN","PSJLIFN",30,0)
 S PSJFNDS=1
"RTN","PSJLIFN",31,0)
 S PSIVAC="CF" S (P("PON"),ON)=+PSJORD_"P",DFN=PSGP
"RTN","PSJLIFN",32,0)
 S PSIVUP=+$$GTPCI^PSIVUTL D GT531^PSIVORFA(DFN,ON)
"RTN","PSJLIFN",33,0)
 D:'$D(P("OT")) GTOT^PSIVUTL(P(4))
"RTN","PSJLIFN",34,0)
 NEW PSJL
"RTN","PSJLIFN",35,0)
 N PSIVNUM,PSJSTAR S PSIVNUM=1
"RTN","PSJLIFN",36,0)
 Q:ON'=PSJORD
"RTN","PSJLIFN",37,0)
 I $G(PSJLYN)]"" Q:ON'=PSJLYN
"RTN","PSJLIFN",38,0)
 S PSJMAI=ON
"RTN","PSJLIFN",39,0)
 I P("OT")="I" D  Q
"RTN","PSJLIFN",40,0)
 . S PSJSTAR="(5)^(7)^(9)^(10)"
"RTN","PSJLIFN",41,0)
 . D EN^VALM("PSJ LM IV INPT PENDING") ;; ^PSJLIVMD
"RTN","PSJLIFN",42,0)
 S PSJSTAR="(1)^(2)^(3)^(5)^(7)^(9)"
"RTN","PSJLIFN",43,0)
 D GTDATA D EN^VALM("PSJ LM IV PENDING") ;; ^PSJLIVFD
"RTN","PSJLIFN",44,0)
 K PSJMAI Q
"RTN","PSJLIFN",45,0)
 ;
"RTN","PSJLIFN",46,0)
DISPLAY ;
"RTN","PSJLIFN",47,0)
 S PSGACT=""
"RTN","PSJLIFN",48,0)
 S VALMSG="Press Return to continue"
"RTN","PSJLIFN",49,0)
 D:$E(P("OT"))="I" EN^VALM("PSJ LM IV INPT DISPLAY")
"RTN","PSJLIFN",50,0)
 D:$E(P("OT"))'="I" EN^VALM("PSJ LM IV DISPLAY")
"RTN","PSJLIFN",51,0)
 K PSJDISP
"RTN","PSJLIFN",52,0)
 S:'$G(PSJHIS) VALMBCK=""
"RTN","PSJLIFN",53,0)
 Q
"RTN","PSJLIFN",54,0)
GTDATA ;
"RTN","PSJLIFN",55,0)
 ;* D:P(4)="" 53^PSIVORC1 Q:P(4)=""  S P("DTYP")=$S(P(4)="":0,P(4)="P"!(P(23)="P")!(P(5)):1,P(4)="H":2,1:3)
"RTN","PSJLIFN",56,0)
 S P("DTYP")=$S(P(4)="":0,P(4)="P"!(P(23)="P")!(P(5)):1,P(4)="H":2,1:3)
"RTN","PSJLIFN",57,0)
 I 'P(2) D
"RTN","PSJLIFN",58,0)
 .I P("RES")="R" S PSJREN=1
"RTN","PSJLIFN",59,0)
 .D ENT^PSIVCAL K %DT S X=P(2),%DT="RTX" D ^%DT S P(2)=+Y
"RTN","PSJLIFN",60,0)
 I 'P(3) D ENSTOP^PSIVCAL K %DT S X=P(3),%DT="RTX" D ^%DT S P(3)=+Y
"RTN","PSJLIFN",61,0)
 I 'P("MR") S P("MR")=$O(^PS(51.2,"B","INTRAVENOUS",0))_"^IV"
"RTN","PSJLIFN",62,0)
 Q
"RTN","PSJLIFN",63,0)
FINISH ; Prompt for missing data
"RTN","PSJLIFN",64,0)
 ;* Ord chk for Inpat. pending only. Pend renew should not be checked.
"RTN","PSJLIFN",65,0)
 ;* PSIVOCON needed so this order will be excluded from the order
"RTN","PSJLIFN",66,0)
 ;*          list(ORDCHK^PSJLMUT1)
"RTN","PSJLIFN",67,0)
 ;* PSGORQF defined means cancel the order due to order check.
"RTN","PSJLIFN",68,0)
 ;Q:'$$LS^PSSLOCK(DFN,PSJORD)
"RTN","PSJLIFN",69,0)
 N PSJCOM,PSIVEDIT S PSJCOM=+$P($G(^PS(53.1,+PSJORD,.2)),"^",8)
"RTN","PSJLIFN",70,0)
 K PSJIVBD,PSGRDTX,PSIVEDIT
"RTN","PSJLIFN",71,0)
 N FIL,PSIVS,DRGOC,PSIVXD,DRGTMP,PSIVOCON,PSGORQF,ON55,NSFF K PSGORQF S NSFF=1
"RTN","PSJLIFN",72,0)
 S (ON,PSIVOCON,ON55,PSGORD)=PSJORD Q:PSJORD'=PSJMAI  I $G(PSJLYN)]"" Q:PSJORD'=PSJLYN
"RTN","PSJLIFN",73,0)
 D UDVARS^PSJLIORD
"RTN","PSJLIFN",74,0)
 I $G(PSJPROT)=3,'$$ENIVUD^PSGOEF1(PSJORD) K NSFF Q
"RTN","PSJLIFN",75,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIFN",76,0)
 ;PRE UAT group requested to not show the second screen since FDB OC has more text and provider override reason appears after 2nd screen 
"RTN","PSJLIFN",77,0)
 ; force the display of the second screen if CPRS order checks exist
"RTN","PSJLIFN",78,0)
 ;I $O(^PS(53.1,+PSJORD,12,0))!$O(^PS(53.1,+PSJORD,10,0)) D
"RTN","PSJLIFN",79,0)
 ;.Q:$G(PSJLMX)=1   ;no second screen to display
"RTN","PSJLIFN",80,0)
 ;.S VALMBG=16 D RE^VALM4,PAUSE^VALM1 S VALMBG=1
"RTN","PSJLIFN",81,0)
 S P("OPI")=$$ENPC^PSJUTL("V",+PSIVUP,60,P("OPI"))
"RTN","PSJLIFN",82,0)
 ;I $E(P("OT"))="I" D GTDATA Q:P(4)=""
"RTN","PSJLIFN",83,0)
 ;I $E(P("OT"))="I",'$D(DRG("AD")),('$D(DRG("SOL"))) D
"RTN","PSJLIFN",84,0)
 I $G(P("RES"))'="R" D 53^PSIVORC1
"RTN","PSJLIFN",85,0)
 I $G(P(4))]"",$G(P(15))]"",$G(P(9))]"",$$SCHREQ^PSJLIVFD(.P) D
"RTN","PSJLIFN",86,0)
 . N PSGS0XT,X,PSJNSS S PSJNSS=1,X=P(9),PSGS0XT=P(15) D Q2^PSGS0
"RTN","PSJLIFN",87,0)
 I P(4)="" D RE^VALM4 Q
"RTN","PSJLIFN",88,0)
 I $E(P("OT"))="I" D GTDATA  D
"RTN","PSJLIFN",89,0)
 . I '$D(DRG("AD")),('$D(DRG("SOL"))) S DNE=0 D GTIVDRG^PSIVORC2 S P(3)="" D ENSTOP^PSIVCAL
"RTN","PSJLIFN",90,0)
 S VALMBG=1
"RTN","PSJLIFN",91,0)
 I $E(P("OT"))="F" S DNE=0 I $G(PSGORQF) D RE^VALM4 Q
"RTN","PSJLIFN",92,0)
 I $G(PSGORQF) S VALMBCK="R",P(4)="" K DRG Q
"RTN","PSJLIFN",93,0)
 S PSIVEDIT=""
"RTN","PSJLIFN",94,0)
 S PSIVOK="1^3^10^25^26^39^57^58^59^63^64" D CKFLDS^PSIVORC1 I EDIT]"" D EDIT^PSIVEDT
"RTN","PSJLIFN",95,0)
 ;S PSIVOK="1^3^10^25^26^39^57^58^59^63^64" D CKFLDS^PSIVORC1 I EDIT]"" S PSIVEDIT=EDIT D EDIT^PSIVEDT
"RTN","PSJLIFN",96,0)
 ;I $G(EDIT)="" D OC^PSIVOC D:'$G(PSGORQF) IN^PSJOCDS($G(ON),"IV","") Q:$G(PSGORQF)
"RTN","PSJLIFN",97,0)
 I $D(PSIVEDIT) D OC^PSIVOC
"RTN","PSJLIFN",98,0)
 ;PSJ*5*261 - Remedy #490875 PSPO 2040 
"RTN","PSJLIFN",99,0)
 D ENSTOP^PSIVCAL
"RTN","PSJLIFN",100,0)
 ;D:'$G(PSGORQF) IN^PSJOCDS($G(ON),"IV","")
"RTN","PSJLIFN",101,0)
 I $G(PSGORQF) D GT531^PSIVORFA(DFN,ON) Q
"RTN","PSJLIFN",102,0)
 I $G(DONE) S VALMBCK="R" Q
"RTN","PSJLIFN",103,0)
 ;* PSJFNDS is set so dosing is trigger during finishing without changes to the add/sol
"RTN","PSJLIFN",104,0)
 ;S PSJFNDS=1
"RTN","PSJLIFN",105,0)
 D COMPLTE^PSIVORC1
"RTN","PSJLIFN",106,0)
 S:$G(PSIVACEP) VALMBCK="Q"
"RTN","PSJLIFN",107,0)
 ;Reset PSJFNDS so if FN again, the dosing check is triggered.
"RTN","PSJLIFN",108,0)
 S:'$G(PSIVACEP) PSJFNDS=1
"RTN","PSJLIFN",109,0)
 I $G(PSGORQF) S VALMBG=1 D RE^VALM4
"RTN","PSJLIFN",110,0)
 K NSFF
"RTN","PSJLIFN",111,0)
 Q
"RTN","PSJLIFN",112,0)
ORDCHK ;* Do order check for Inpatient Meds IV.
"RTN","PSJLIFN",113,0)
 ; PSGORQF is defined (CONT^PSGSICHK) if not log an intervention
"RTN","PSJLIFN",114,0)
 ; No longer use after PSJ*5*181
"RTN","PSJLIFN",115,0)
 K PSGORQF
"RTN","PSJLIFN",116,0)
 Q
"RTN","PSJLIFN",117,0)
 ;NEW DRGOC
"RTN","PSJLIFN",118,0)
 ;D OCORD Q:$G(PSGORQF) 
"RTN","PSJLIFN",119,0)
 ;D GTIVDRG^PSIVORC2 S P(3)="" D ENSTOP^PSIVCAL
"RTN","PSJLIFN",120,0)
ORDCHKA ;* Do order check against existing orders on the profile
"RTN","PSJLIFN",121,0)
 ;No longer use as of PSJ*5*181
"RTN","PSJLIFN",122,0)
 Q
"RTN","PSJLIFN",123,0)
 F PSIVAS="AD","SOL" Q:$G(PSGORQF)  S FIL=$S(PSIVAS="AD":52.6,1:52.7) D
"RTN","PSJLIFN",124,0)
 . F PSIVX=0:0 S PSIVX=$O(DRG(PSIVAS,PSIVX)) Q:'PSIVX!($G(PSGORQF))  D
"RTN","PSJLIFN",125,0)
 .. S DRGTMP=DRG(PSIVAS,PSIVX)
"RTN","PSJLIFN",126,0)
 .. ;* Do only 1 duplicate warning when order has >1 of the same additive
"RTN","PSJLIFN",127,0)
 .. Q:$D(PSJADTMP(+DRGTMP))
"RTN","PSJLIFN",128,0)
 .. D ORDERCHK^PSIVEDRG(PSGP,ON,$D(DRGOC(ON)))
"RTN","PSJLIFN",129,0)
 .. S DRGOC(ON,PSIVAS,PSIVX)=DRG(PSIVAS,PSIVX)
"RTN","PSJLIFN",130,0)
 .. S PSJADTMP(+DRGTMP)=""
"RTN","PSJLIFN",131,0)
 K PSJADTMP
"RTN","PSJLIFN",132,0)
 Q
"RTN","PSJLIFN",133,0)
OCORD ;* Do order check for each drug against the drugs within the order.
"RTN","PSJLIFN",134,0)
 ;OCORD was called by ORDCHK.  This entry point is no longer use as of PSJ*5*181
"RTN","PSJLIFN",135,0)
 Q
"RTN","PSJLIFN",136,0)
 NEW X,Y,DDRUG,PSIVX,PSJAD,PSJSOL,TMPDRG
"RTN","PSJLIFN",137,0)
 D SAVEDRG^PSIVEDRG(.TMPDRG,.DRG)
"RTN","PSJLIFN",138,0)
 ; Find the corresponding DD for the additive within the order
"RTN","PSJLIFN",139,0)
 F X=0:0 S X=$O(DRG("AD",X)) Q:'X  D
"RTN","PSJLIFN",140,0)
 . S DDRUG=$P($G(^PS(52.6,+DRG("AD",X),0)),U,2)
"RTN","PSJLIFN",141,0)
 . S:+DDRUG (DDRUG(DDRUG),PSJAD(DDRUG))=$D(DDRUG(DDRUG))+1
"RTN","PSJLIFN",142,0)
 ;
"RTN","PSJLIFN",143,0)
 ; Find the corresponding DD for the solution
"RTN","PSJLIFN",144,0)
 ;
"RTN","PSJLIFN",145,0)
 F X=0:0 S X=$O(DRG("SOL",X)) Q:'X  D
"RTN","PSJLIFN",146,0)
 . S DDRUG=$P($G(^PS(52.7,+DRG("SOL",X),0)),U,2)
"RTN","PSJLIFN",147,0)
 . S:+DDRUG (DDRUG(DDRUG),PSJSOL(DDRUG))=$D(DDRUG(DDRUG))+1
"RTN","PSJLIFN",148,0)
 ;
"RTN","PSJLIFN",149,0)
 ; Loop thru each additive to check for DD,DI & DC against the
"RTN","PSJLIFN",150,0)
 ; order's dispense drugs
"RTN","PSJLIFN",151,0)
 ;
"RTN","PSJLIFN",152,0)
 NEW PSJDFN,INTERVEN S INTERVEN=""
"RTN","PSJLIFN",153,0)
 S PSJDFN=DFN ;DFN will be killed when call ^PSOORDRG
"RTN","PSJLIFN",154,0)
 F PSIVX=0:0 S PSIVX=$O(PSJAD(PSIVX)) Q:'PSIVX  D
"RTN","PSJLIFN",155,0)
 . K DDRUG(PSIVX) D DRGCHK^PSOORDRG(PSJDFN,PSIVX,.DDRUG)
"RTN","PSJLIFN",156,0)
 . I PSJAD(PSIVX)>1 S ^TMP($J,"DD",1,0)=PSIVX_U_$P($G(^PSDRUG(PSIVX,0)),U)_"^^"_ON_";I"
"RTN","PSJLIFN",157,0)
 . NEW TYPE F TYPE="DD","DI","DC" D ORDCHK^PSJLIFNI(PSJDFN,TYPE)
"RTN","PSJLIFN",158,0)
 F PSIVX=0:0 S PSIVX=$O(PSJSOL(PSIVX)) Q:'PSIVX  D
"RTN","PSJLIFN",159,0)
 . K DDRUG(PSIVX) D DRGCHK^PSOORDRG(PSJDFN,PSIVX,.DDRUG)
"RTN","PSJLIFN",160,0)
 . NEW TYPE F TYPE="DI" D ORDCHK^PSJLIFNI(PSJDFN,TYPE)
"RTN","PSJLIFN",161,0)
 S DFN=PSJDFN
"RTN","PSJLIFN",162,0)
 D SAVEDRG^PSIVEDRG(.DRG,.TMPDRG)
"RTN","PSJLIFN",163,0)
 Q
"RTN","PSJLIFNI")
0^2^B11456971
"RTN","PSJLIFNI",1,0)
PSJLIFNI ;BIR/MV-U/D ORDER FINISHES AS IV ;13 Jan 98 / 11:32 AM
"RTN","PSJLIFNI",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**1,29,34,37,50,94,116,110,111,181,261**;16 DEC 97;Build 47
"RTN","PSJLIFNI",3,0)
 ;
"RTN","PSJLIFNI",4,0)
IV(PSJORD,OI) ; Prompt for missing data to be finished as IV.
"RTN","PSJLIFNI",5,0)
 L +^PS(53.1,+PSJORD):1 I '$T W !,$C(7),$C(7),"This order is being edited by another user. Try later." D PAUSE^VALM1 Q
"RTN","PSJLIFNI",6,0)
 D HOLDHDR^PSJOE
"RTN","PSJLIFNI",7,0)
 ;** PSIVFN1 is used so it will display the AC/Edit screen
"RTN","PSJLIFNI",8,0)
 ;** instead of go to the "IS this O.K." prompt
"RTN","PSJLIFNI",9,0)
 ;** PSJLIFNI is a flag to indicate U/D finishes as IV.
"RTN","PSJLIFNI",10,0)
 K PSJIVBD
"RTN","PSJLIFNI",11,0)
 NEW PSIVFN1,ON55,PSGORQF,PSIVACEP,DRGOC,PSJLIFNI,PSIVOI
"RTN","PSJLIFNI",12,0)
 K PSGORQF
"RTN","PSJLIFNI",13,0)
 S PSJLIFNI=1
"RTN","PSJLIFNI",14,0)
 S PSIVAC="CF" S (P("PON"),ON,ON55)=+PSJORD_"P",DFN=PSGP
"RTN","PSJLIFNI",15,0)
 S PSIVUP=+$$GTPCI^PSIVUTL D GT531^PSIVORFA(DFN,ON) S P("PD")=OI_U_$$OIDF^PSJLMUT1(+OI)
"RTN","PSJLIFNI",16,0)
 D:'$D(P("OT")) GTOT^PSIVUTL(P(4))
"RTN","PSJLIFNI",17,0)
 S P("OPI")=$$ENPC^PSJUTL("V",+PSIVUP,60,P("OPI"))
"RTN","PSJLIFNI",18,0)
 D 53^PSIVORC1
"RTN","PSJLIFNI",19,0)
 I $E(P("OT"))="I" D GTDATA^PSJLIFN Q:P(4)=""
"RTN","PSJLIFNI",20,0)
 ;I $$SCHREQ^PSJLIVFD(.P),(P(9))]"",'$$PRNOK^PSGS0(P(9)) N PSGOES,X,PSGS0XT,PSJNSS S PSJNSS=1,PSGOES=1,X=P(9),PSGS0XT=P(15) D Q2^PSGS0
"RTN","PSJLIFNI",21,0)
 I $$SCHREQ^PSJLIVFD(.P),(P(9))]"",'$$PRNOK^PSGS0(P(9)) N PSJNSS,PSGOES,PSGS0XT,PSGS0Y,PSGAT S X=P(9),PSGS0XT=P(15),PSGAT=P(11) D
"RTN","PSJLIFNI",22,0)
 .D EN^PSGS0 I $G(X)="" S PSGORQF=1 Q
"RTN","PSJLIFNI",23,0)
 .I $G(PSGS0Y)>1 S P(11)=PSGS0Y
"RTN","PSJLIFNI",24,0)
 I $E(P("OT"))="I",'$D(DRG("AD")),('$D(DRG("SOL"))) S DNE=0 D GTIVDRG^PSIVORC2 S P(3)="" D ENSTOP^PSIVCAL
"RTN","PSJLIFNI",25,0)
 I $D(PSGORQF) S VALMBCK="R",P(4)="" K DRG Q
"RTN","PSJLIFNI",26,0)
 S ^TMP("PSJI",$J,0)=""
"RTN","PSJLIFNI",27,0)
 S PSIVOK="1^3^10^25^26^39^57^58^59^63^64" D CKFLDS^PSIVORC1 I EDIT]"" D EDIT^PSIVEDT
"RTN","PSJLIFNI",28,0)
 ;I $G(EDIT)="" D OC^PSIVOC
"RTN","PSJLIFNI",29,0)
 I $G(DONE) S VALMBCK="R" D EXIT Q
"RTN","PSJLIFNI",30,0)
 ;PSJ*5*261 - Remedy #490875 PSPO 2040
"RTN","PSJLIFNI",31,0)
 D ENSTOP^PSIVCAL
"RTN","PSJLIFNI",32,0)
 D COMPLTE^PSIVORC1
"RTN","PSJLIFNI",33,0)
 S:$D(PSIVACEP) VALMBCK="Q"
"RTN","PSJLIFNI",34,0)
EXIT ;
"RTN","PSJLIFNI",35,0)
 L -^PS(53.1,+PSJORD)
"RTN","PSJLIFNI",36,0)
 Q
"RTN","PSJLIFNI",37,0)
ORDCHK(DFN,TYPE) ;
"RTN","PSJLIFNI",38,0)
 ;TYPE ="DD" - Duplicate drug
"RTN","PSJLIFNI",39,0)
 ;     ="DC" - Duplicate class
"RTN","PSJLIFNI",40,0)
 ;     -"DI" - Drug Interaction
"RTN","PSJLIFNI",41,0)
 ;
"RTN","PSJLIFNI",42,0)
 NEW ON,PSJL,PSIVX,PSJOC,PSJORIEN,PSJPACK,PSJLINE
"RTN","PSJLIFNI",43,0)
 S PSJOC=0,PSJLINE=1
"RTN","PSJLIFNI",44,0)
 F PSIVX=0:0 S PSIVX=$O(^TMP($J,TYPE,PSIVX)) Q:'PSIVX  D
"RTN","PSJLIFNI",45,0)
 . I TYPE="DI",($P(^TMP($J,TYPE,PSIVX,0),U,4)="CRITICAL") S PSJIREQ=1
"RTN","PSJLIFNI",46,0)
 . D WRITE(TYPE),CONT^PSGSICHK
"RTN","PSJLIFNI",47,0)
 .; I ON["V" D
"RTN","PSJLIFNI",48,0)
 .;. I '$O(^PS(55,DFN,"IV",+ON,0)) D SETPSJOC Q
"RTN","PSJLIFNI",49,0)
 .;. D DSPLORDV(DFN,ON) S PSJOC=PSJOC+1
"RTN","PSJLIFNI",50,0)
 .; I ON'["V" D DSPLORDU(DFN,ON) S PSJOC=PSJOC+1
"RTN","PSJLIFNI",51,0)
 .; S PSJOC(ON,PSJLINE)="",PSJLINE=PSJLINE+1
"RTN","PSJLIFNI",52,0)
 ;D:PSJOC WRITE(TYPE)
"RTN","PSJLIFNI",53,0)
 ;S ON="" F  S ON=$O(PSJOC(ON)) Q:ON=""  W ! S PSJLINE=PSJLINE+1 D
"RTN","PSJLIFNI",54,0)
 ;. F PSIVX=0:0 S PSIVX=$O(PSJOC(ON,PSIVX)) Q:'PSIVX  W !,PSJOC(ON,PSIVX)  S PSJLINE=PSJLINE+1 D:'(PSIVX#6) PAUSE
"RTN","PSJLIFNI",55,0)
 ;W !
"RTN","PSJLIFNI",56,0)
 Q
"RTN","PSJLIFNI",57,0)
WRITE(TYPE) ;Display order check description
"RTN","PSJLIFNI",58,0)
 S PSJPDRG=1
"RTN","PSJLIFNI",59,0)
 I TYPE="DD" W !!,"There are duplicate ",$P(^TMP($J,TYPE,PSIVX,0),U,2),!,"medications prescribed for this order.",! Q
"RTN","PSJLIFNI",60,0)
 I TYPE="DC" W !!,"This medication: ",$P(^TMP($J,TYPE,PSIVX,0),U,4),!,"is in the same class as the following medication(s) within this order: "
"RTN","PSJLIFNI",61,0)
 I TYPE="DI" W !!,"This medication: ",$P(^TMP($J,TYPE,PSIVX,0),U,2),!,"has an interaction with the following medication(s) within this order: "
"RTN","PSJLIFNI",62,0)
 F X=0:0 S X=$O(^TMP($J,TYPE,X)) Q:'X  W !,$S(TYPE="DC":$P(^TMP($J,TYPE,X,0),U,4),TYPE="DI":$P(^TMP($J,TYPE,X,0),U,6),1:$P(^TMP($J,TYPE,X,0),U,2)),!
"RTN","PSJLIFNI",63,0)
 Q
"VER")
8.0^22.0
**END**
**END**
