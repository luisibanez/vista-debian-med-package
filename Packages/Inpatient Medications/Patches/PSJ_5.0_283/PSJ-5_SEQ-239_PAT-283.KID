Released PSJ*5*283 SEQ #239
Extracted from mail message
**KIDS**:PSJ*5.0*283^

**INSTALL NAME**
PSJ*5.0*283
"BLD",9171,0)
PSJ*5.0*283^INPATIENT MEDICATIONS^0^3121016^y
"BLD",9171,1,0)
^^5^5^3120730^
"BLD",9171,1,1,0)
This patch will resolve the following issues in the Inpatient Medications 
"BLD",9171,1,2,0)
package:
"BLD",9171,1,3,0)
 
"BLD",9171,1,4,0)
-Invalid start time for lab orders
"BLD",9171,1,5,0)
-<NOLINE> error when running Total Cost to Date report
"BLD",9171,4,0)
^9.64PA^^
"BLD",9171,6)
3^
"BLD",9171,6.3)
4
"BLD",9171,"KRN",0)
^9.67PA^779.2^20
"BLD",9171,"KRN",.4,0)
.4
"BLD",9171,"KRN",.401,0)
.401
"BLD",9171,"KRN",.402,0)
.402
"BLD",9171,"KRN",.403,0)
.403
"BLD",9171,"KRN",.5,0)
.5
"BLD",9171,"KRN",.84,0)
.84
"BLD",9171,"KRN",3.6,0)
3.6
"BLD",9171,"KRN",3.8,0)
3.8
"BLD",9171,"KRN",9.2,0)
9.2
"BLD",9171,"KRN",9.8,0)
9.8
"BLD",9171,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",9171,"KRN",9.8,"NM",1,0)
PSJEEU^^0^B11721485
"BLD",9171,"KRN",9.8,"NM",2,0)
PSGTCTD^^0^B9165440
"BLD",9171,"KRN",9.8,"NM",3,0)
PSGSEL^^0^B43909026
"BLD",9171,"KRN",9.8,"NM","B","PSGSEL",3)

"BLD",9171,"KRN",9.8,"NM","B","PSGTCTD",2)

"BLD",9171,"KRN",9.8,"NM","B","PSJEEU",1)

"BLD",9171,"KRN",19,0)
19
"BLD",9171,"KRN",19.1,0)
19.1
"BLD",9171,"KRN",101,0)
101
"BLD",9171,"KRN",409.61,0)
409.61
"BLD",9171,"KRN",771,0)
771
"BLD",9171,"KRN",779.2,0)
779.2
"BLD",9171,"KRN",870,0)
870
"BLD",9171,"KRN",8989.51,0)
8989.51
"BLD",9171,"KRN",8989.52,0)
8989.52
"BLD",9171,"KRN",8994,0)
8994
"BLD",9171,"KRN","B",.4,.4)

"BLD",9171,"KRN","B",.401,.401)

"BLD",9171,"KRN","B",.402,.402)

"BLD",9171,"KRN","B",.403,.403)

"BLD",9171,"KRN","B",.5,.5)

"BLD",9171,"KRN","B",.84,.84)

"BLD",9171,"KRN","B",3.6,3.6)

"BLD",9171,"KRN","B",3.8,3.8)

"BLD",9171,"KRN","B",9.2,9.2)

"BLD",9171,"KRN","B",9.8,9.8)

"BLD",9171,"KRN","B",19,19)

"BLD",9171,"KRN","B",19.1,19.1)

"BLD",9171,"KRN","B",101,101)

"BLD",9171,"KRN","B",409.61,409.61)

"BLD",9171,"KRN","B",771,771)

"BLD",9171,"KRN","B",779.2,779.2)

"BLD",9171,"KRN","B",870,870)

"BLD",9171,"KRN","B",8989.51,8989.51)

"BLD",9171,"KRN","B",8989.52,8989.52)

"BLD",9171,"KRN","B",8994,8994)

"BLD",9171,"QUES",0)
^9.62^^
"BLD",9171,"REQB",0)
^9.611^2^2
"BLD",9171,"REQB",1,0)
PSJ*5.0*232^2
"BLD",9171,"REQB",2,0)
PSJ*5.0*243^2
"BLD",9171,"REQB","B","PSJ*5.0*232",1)

"BLD",9171,"REQB","B","PSJ*5.0*243",2)

"MBREQ")
0
"PKG",471,-1)
1^1
"PKG",471,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",471,20,0)
^9.402P^^
"PKG",471,22,0)
^9.49I^1^1
"PKG",471,22,1,0)
5.0^2971215^2990325^66481
"PKG",471,22,1,"PAH",1,0)
283^3121016^1181
"PKG",471,22,1,"PAH",1,1,0)
^^5^5^3121016
"PKG",471,22,1,"PAH",1,1,1,0)
This patch will resolve the following issues in the Inpatient Medications 
"PKG",471,22,1,"PAH",1,1,2,0)
package:
"PKG",471,22,1,"PAH",1,1,3,0)
 
"PKG",471,22,1,"PAH",1,1,4,0)
-Invalid start time for lab orders
"PKG",471,22,1,"PAH",1,1,5,0)
-<NOLINE> error when running Total Cost to Date report
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PSGSEL")
0^3^B43909026^B41117725
"RTN","PSGSEL",1,0)
PSGSEL ;BIR/CML3 - SELECT ORDERS BY WARD, WARD GROUP, PATIENT, OR PRIORITY ;05/15/98 9:26 AM
"RTN","PSGSEL",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**3,111,145,243,283**;DEC 16, 1997;Build 4
"RTN","PSGSEL",3,0)
SELECT ; give user choice to select search method
"RTN","PSGSEL",4,0)
 S:'$D(PSGSSH) PSGSSH="GENERIC"
"RTN","PSGSEL",5,0)
 ;
"RTN","PSGSEL",6,0)
 ;*283 - Change prompts for NOCL tag
"RTN","PSGSEL",7,0)
 N PSGWGSTR,PSGCLSTR,PSGCHKSTR S PSGWGSTR=$S($G(PSGNOCL):"WARD GROUP",1:"GROUP"),PSGCLSTR=$S('$G(PSGNOCL):"CLINIC (C), ",1:""),PSGCHKSTR=$S($G(PSGNOCL):",G,P,W,",1:",C,G,P,W,PR,")
"RTN","PSGSEL",8,0)
 F  W !!,"Select by ",PSGWGSTR," (G), WARD (W), ",PSGCLSTR_$S($G(PSGPRIFL):"PATIENT (P) or PRIORITY (PR)",1:"or PATIENT (P)")_": " R PSGSS:DTIME W:'$T $C(7) S:'$T PSGSS="^" Q:"^"[PSGSS  D CHK I PSGCHKSTR[(","_PSGSS_",") Q
"RTN","PSGSEL",9,0)
 N PSGPRMT
"RTN","PSGSEL",10,0)
 S PSGPRMT=$P(XQY0,U,1)
"RTN","PSGSEL",11,0)
 ;DAM   5-01-07  Adding new prompt.  If user selects to print by WARD, he is prompted to "Include Clinic Orders?"  If user selects to print by CLINIC, he is prompted to "Include Ward Orders?"
"RTN","PSGSEL",12,0)
 S PSGINCL=""
"RTN","PSGSEL",13,0)
 I PSGSS["W" D
"RTN","PSGSEL",14,0)
 . I (PSGPRMT'["MAR") Q
"RTN","PSGSEL",15,0)
 . N DIR,DUOUT,DIRUT,DTOUT,X,Y
"RTN","PSGSEL",16,0)
 . S DIR(0)="Y"
"RTN","PSGSEL",17,0)
 . W !
"RTN","PSGSEL",18,0)
 . S DIR("A")="Include Clinic Orders"
"RTN","PSGSEL",19,0)
 . D ^DIR
"RTN","PSGSEL",20,0)
 . I Y=1 S PSGINCL=1
"RTN","PSGSEL",21,0)
 . I ($D(DTOUT)!$D(DUOUT)!$D(DIRUT)) S Y=0
"RTN","PSGSEL",22,0)
 ;
"RTN","PSGSEL",23,0)
 S PSGINWD=""
"RTN","PSGSEL",24,0)
 I PSGSS["C" D
"RTN","PSGSEL",25,0)
 . I (PSGPRMT'["MAR") Q
"RTN","PSGSEL",26,0)
 . N DIR,DUOUT,DIRUT,DTOUT,X,Y
"RTN","PSGSEL",27,0)
 . S DIR(0)="Y"
"RTN","PSGSEL",28,0)
 . W !
"RTN","PSGSEL",29,0)
 . S DIR("A")="Include Ward Orders"
"RTN","PSGSEL",30,0)
 . D ^DIR
"RTN","PSGSEL",31,0)
 . I Y=1 S PSGINWD=1
"RTN","PSGSEL",32,0)
 . I ($D(DTOUT)!$D(DUOUT)!$D(DIRUT)) S Y=0
"RTN","PSGSEL",33,0)
 ;End DAM 5-01-07
"RTN","PSGSEL",34,0)
 ;
"RTN","PSGSEL",35,0)
 K PSGSSA Q:PSGSS'="G"
"RTN","PSGSEL",36,0)
 I $G(PSGNOCL)=1 S PSGSS2="W"
"RTN","PSGSEL",37,0)
 E  F  R !!,"Select by WARD GROUP (W) or CLINIC GROUP (C): ",PSGSS2:DTIME W:'$T $C(7) S:'$T PSGSS2="^" Q:"^"[PSGSS2  D CHK2 I "CW"[PSGSS2 Q
"RTN","PSGSEL",38,0)
 G SELECT:PSGSS2="" S PSGSS=$S(PSGSS2="C":"L",1:"G")
"RTN","PSGSEL",39,0)
 ;
"RTN","PSGSEL",40,0)
 ;DAM 5-01-07  Adding new prompt.  If user selects to print by WARD GROUP, he is prompted to "Include Clinic Orders?"  If user selects to print by CLINIC GROUP, he is prompted to "Include Ward Orders?"
"RTN","PSGSEL",41,0)
 S PSGINCLG=""
"RTN","PSGSEL",42,0)
 I PSGSS2["W" D
"RTN","PSGSEL",43,0)
 . I (PSGPRMT'["MAR") Q
"RTN","PSGSEL",44,0)
 . N DIR,DUOUT,DIRUT,DTOUT,X,Y
"RTN","PSGSEL",45,0)
 . S DIR(0)="Y"
"RTN","PSGSEL",46,0)
 . W !
"RTN","PSGSEL",47,0)
 . S DIR("A")="Include Clinic Orders"
"RTN","PSGSEL",48,0)
 . D ^DIR
"RTN","PSGSEL",49,0)
 . I Y=1 S PSGINCLG=1
"RTN","PSGSEL",50,0)
 . I ($D(DTOUT)!$D(DUOUT)!$D(DIRUT)) S Y=0
"RTN","PSGSEL",51,0)
 ;
"RTN","PSGSEL",52,0)
 S PSGINWDG=""
"RTN","PSGSEL",53,0)
 I PSGSS2["C" D
"RTN","PSGSEL",54,0)
 . I (PSGPRMT'["MAR") Q
"RTN","PSGSEL",55,0)
 . N DIR,DUOUT,DIRUT,DTOUT,X,Y
"RTN","PSGSEL",56,0)
 . S DIR(0)="Y"
"RTN","PSGSEL",57,0)
 . W !
"RTN","PSGSEL",58,0)
 . S DIR("A")="Include Ward Orders"
"RTN","PSGSEL",59,0)
 . D ^DIR
"RTN","PSGSEL",60,0)
 . I Y=1 S PSGINWDG=1
"RTN","PSGSEL",61,0)
 . I ($D(DTOUT)!$D(DUOUT)!$D(DIRUT)) S Y=0
"RTN","PSGSEL",62,0)
 ;End DAM 5-01-07
"RTN","PSGSEL",63,0)
 ;
"RTN","PSGSEL",64,0)
 K PSGSSA Q
"RTN","PSGSEL",65,0)
 ;
"RTN","PSGSEL",66,0)
CHK ;
"RTN","PSGSEL",67,0)
 S PSGSSA="" F Q=1:1:$L(PSGSS) S PSGSSA=PSGSSA_$S($E(PSGSS,Q)'?1L:$E(PSGSS,Q),1:$C($A(PSGSS,Q)-32))
"RTN","PSGSEL",68,0)
 F X=$S($G(PSGNOCL):"GROUP",1:"CLINIC"),"GROUP","WARD","PATIENT",$S($G(PSGPRIFL):"PRIORITY",1:"PATIENT") I $P(X,PSGSSA)="" W $P(X,PSGSSA,2,99) S PSGSS=$S($E(PSGSSA,1,2)="PR":"PR",1:$E(PSGSSA)) Q
"RTN","PSGSEL",69,0)
 Q:$T  I PSGSS'?1."?" W $C(7),"  ??" S PSGSS="Z" Q
"RTN","PSGSEL",70,0)
 W ! D @PSGSSH W !!?2,"To leave this option, press the RETURN key or enter '^'." Q
"RTN","PSGSEL",71,0)
 ;
"RTN","PSGSEL",72,0)
CHK2 ;
"RTN","PSGSEL",73,0)
 S PSGSSA="" F Q=1:1:$L(PSGSS2) S PSGSSA=PSGSSA_$S($E(PSGSS2,Q)'?1L:$E(PSGSS2,Q),1:$C($A(PSGSS2,Q)-32))
"RTN","PSGSEL",74,0)
 F X="WARD","CLINIC" I $P(X,PSGSSA)="" W $P(X,PSGSSA,2,99) S PSGSS2=$E(PSGSSA) Q
"RTN","PSGSEL",75,0)
 Q:$T  I PSGSS2'?1."?" W $C(7),"  ??" S PSGSS2="Z" Q
"RTN","PSGSEL",76,0)
 W ! D @PSGSSH W !!?2,"To leave this option, press the RETURN key or enter  '^'." Q
"RTN","PSGSEL",77,0)
 ;
"RTN","PSGSEL",78,0)
HELP ; the following are the help text messages for the various options
"RTN","PSGSEL",79,0)
 ;
"RTN","PSGSEL",80,0)
GENERIC W !!,?2,"To run this option for an entire WARD GROUP, enter 'G'.  To run this option for a single WARD, enter 'W'.  To run this option for a single PATIENT, enter 'P'." Q
"RTN","PSGSEL",81,0)
 ;
"RTN","PSGSEL",82,0)
VBW W !!?2,"To verify all of the orders in an entire WARD GROUP, enter 'G'. To verify"
"RTN","PSGSEL",83,0)
 W !,"all of the orders in an entire CLINIC GROUP, enter 'CG'. To verify all of the"
"RTN","PSGSEL",84,0)
 W !,"orders in a single WARD, enter 'W'. To verify all of the orders in a single"
"RTN","PSGSEL",85,0)
 W !,"CLINIC, enter 'C'. To verify all of the orders for a single PATIENT, enter"
"RTN","PSGSEL",86,0)
 W !,"'P'."
"RTN","PSGSEL",87,0)
 I $G(PSGPRIFL) W " To verify all of the orders for a single PRIORITY, enter 'PR'."
"RTN","PSGSEL",88,0)
 Q
"RTN","PSGSEL",89,0)
 ;
"RTN","PSGSEL",90,0)
EXP W !?2,"To print STOP ORDER NOTICES for an entire WARD GROUP, enter 'G'.  To print  notices for a single WARD, enter 'W'.  To print notices for a single PATIENT, enter 'P'." Q
"RTN","PSGSEL",91,0)
 ;
"RTN","PSGSEL",92,0)
MAR W !?2,"To run a Medication Administration Record (MAR or CMR) for an entire WARD",!,"GROUP, enter 'G'.  To run an MAR for a single WARD, enter 'W'.  To run an   MAR for a single PATIENT, enter 'P'." Q
"RTN","PSGSEL",93,0)
 ;
"RTN","PSGSEL",94,0)
LBL W !?2,"To print labels for all of the orders in an entire WARD GROUP, enter 'G'.   To print labels for all of the orders in a WARD, enter 'W'.  To print the",!,"labels for a single PATIENT, enter 'P'." Q
"RTN","PSGSEL",95,0)
 ;
"RTN","PSGSEL",96,0)
TCR W !?2,"To run a TOTAL COST REPORT for an entire WARD GROUP, enter 'G'.  To run the report for a single WARD, enter 'W'.  To run the report for a single PATIENT,",!,"or a set of PATIENTS, enter 'P'." Q
"RTN","PSGSEL",97,0)
 ;
"RTN","PSGSEL",98,0)
PPR W !?2,"To print PATIENT PROFILES for an entire WARD GROUP, enter 'G'.  To print    profiles for a single WARD, enter 'W'.  To print a profile for a single",!,"PATIENT, enter 'P'." Q
"RTN","PSGSEL",99,0)
 ;
"RTN","PSGSEL",100,0)
AP W !?2,"To print ACTION PROFILES for an entire WARD GROUP, enter 'G'.  To print",!,"ACTION PROFILES for a single WARD, enter 'W'.  To print an ACTION PROFILE",!,"for a single patient, enter 'P'.  PLEASE NOTE that only patients"
"RTN","PSGSEL",101,0)
 W " with active",!,"orders are selectable, and that only patients with active orders will print for",!,"a ward or ward group." Q
"RTN","PSGSEL",102,0)
ORVC W !?2,"To complete orders for an entire WARD GROUP, enter 'G'. To complete orders for an entire CLINIC GROUP, enter 'CG'"
"RTN","PSGSEL",103,0)
 W "To complete orders for a single WARD, enter 'W'.  To complete orders for a single PATIENT, enter",!,"a 'P'." Q
"RTN","PSGSEL",104,0)
 ;
"RTN","PSGSEL",105,0)
PRI ; Priompt for Priority along with Group, Ward, Clinic and Patient
"RTN","PSGSEL",106,0)
 S PSGPRIFL=1 D SELECT K PSGPRIFL
"RTN","PSGSEL",107,0)
 Q
"RTN","PSGSEL",108,0)
 ;
"RTN","PSGSEL",109,0)
NOCL ; *283 - Prompt to only allow Ward Group, Ward, and Patient
"RTN","PSGSEL",110,0)
 N PSGNOCL S PSGNOCL=1 D SELECT
"RTN","PSGSEL",111,0)
 Q
"RTN","PSGTCTD")
0^2^B9165440^B9120987
"RTN","PSGTCTD",1,0)
PSGTCTD ;BIR/CML3-SHOW TOTAL COST TO DATE OF PATIENTS ; 15 May 98 / 9:26 AM
"RTN","PSGTCTD",2,0)
 ;;5.0;INPATIENT MEDICATIONS ;**3,283**;16 DEC 97;Build 4
"RTN","PSGTCTD",3,0)
START ;
"RTN","PSGTCTD",4,0)
 D ENCV^PSGSETU I '$D(XQUIT) S PSGSSH="TCR",PSJACNWP=1,(PSGWG,PSGWD,PSGPAT)=0 D NOCL^PSGSEL I "^"'[PSGSS D @PSGSS I +Y>0 D DEV I 'POP,'$D(IO("Q")) D ENQ,^%ZISC
"RTN","PSGTCTD",5,0)
 ;
"RTN","PSGTCTD",6,0)
DONE ;
"RTN","PSGTCTD",7,0)
 D ENKV^PSGSETU K AMT,CNTR,COST,DRG,DRGN,LN2,ND,PSJJORD,PSGDICA,PSGP,PSGPAT,PSGPN,PSGSS,PSGSSH,PSGWD,PSGWDN,PSGWG,PSN,SD,ZTOUT Q
"RTN","PSGTCTD",8,0)
 ;
"RTN","PSGTCTD",9,0)
ENQ ;
"RTN","PSGTCTD",10,0)
 D NOW^%DTC S PSGDT=%,DT=$P(%,".") K ^TMP("PSG",$J) D @("G"_PSGSS),^PSGTCTD0
"RTN","PSGTCTD",11,0)
 K ^TMP("PSG",$J) Q
"RTN","PSGTCTD",12,0)
 ;
"RTN","PSGTCTD",13,0)
GG ;
"RTN","PSGTCTD",14,0)
 F PSGWD=0:0 S PSGWD=$O(^PS(57.5,"AC",PSGWG,PSGWD)) Q:'PSGWD  D GW
"RTN","PSGTCTD",15,0)
 Q
"RTN","PSGTCTD",16,0)
 ;
"RTN","PSGTCTD",17,0)
GW ;
"RTN","PSGTCTD",18,0)
 I $D(^DIC(42,PSGWD,0)),$P(^(0),"^")]"" S PSGWDN=$P(^(0),"^") F PSGP=0:0 S PSGP=$O(^DPT("CN",PSGWDN,PSGP)) Q:'PSGP  D PAT
"RTN","PSGTCTD",19,0)
 Q
"RTN","PSGTCTD",20,0)
 ;
"RTN","PSGTCTD",21,0)
GP ;
"RTN","PSGTCTD",22,0)
 F PSGP=0:0 S PSGP=$O(PSGPAT(PSGP)) Q:'PSGP  D PAT
"RTN","PSGTCTD",23,0)
 Q
"RTN","PSGTCTD",24,0)
 ;
"RTN","PSGTCTD",25,0)
PAT ;
"RTN","PSGTCTD",26,0)
 S COST=0 D ^PSJAC S PSGPN=$S($P(PSGP(0),"^")]"":$P(PSGP(0),"^"),1:PSGP)_"^"_PSGP,PSN=$E($P(PSJPSSN,"^"),6,10)
"RTN","PSGTCTD",27,0)
 F SD=+PSJPAD:0 S SD=$O(^PS(55,PSGP,5,"AUS",SD)) Q:'SD  F PSJJORD=0:0 S PSJJORD=$O(^PS(55,PSGP,5,"AUS",SD,PSJJORD)) Q:'PSJJORD  D ADD
"RTN","PSGTCTD",28,0)
 S:$D(^TMP("PSG",$J,PSGPN)) ^(PSGPN)=$P(PSJPAD,"^",2)_"^"_PSN_"^"_PSJPDX Q
"RTN","PSGTCTD",29,0)
 ;
"RTN","PSGTCTD",30,0)
ADD ;
"RTN","PSGTCTD",31,0)
 N X F X=0:0 S X=$O(^PS(55,PSGP,5,PSJJORD,1,X)) Q:'X  D
"RTN","PSGTCTD",32,0)
 .; naked ref below refers to line above
"RTN","PSGTCTD",33,0)
 .S ND=^(X,0),DRG=+ND,DRGN=$G(^PSDRUG(DRG,0)),DRGN=$S($P(DRGN,"^")]"":$P(DRGN,"^"),1:DRG)_$S('$P(DRGN,"^",9):"",1:"^1"),DRG=+$P($G(^(660)),"^",6)
"RTN","PSGTCTD",34,0)
 .S AMT=$P(ND,"^",6)+$P(ND,"^",10)+$P(ND,"^",12)-$P(ND,"^",7) I DRG*AMT S ND=$G(^TMP("PSG",$J,PSGPN,DRGN)),^(DRGN)=+ND+AMT_"^"_(DRG*AMT+$P(ND,"^",2))
"RTN","PSGTCTD",35,0)
 Q
"RTN","PSGTCTD",36,0)
 ;
"RTN","PSGTCTD",37,0)
G ;
"RTN","PSGTCTD",38,0)
 S DIC="^PS(57.5,",DIC(0)="QEAMI",DIC("A")="Select WARD GROUP: " W ! D ^DIC K DIC S PSGWG=+Y Q
"RTN","PSGTCTD",39,0)
W ;
"RTN","PSGTCTD",40,0)
 S DIC="^DIC(42,",DIC(0)="QEAMI",DIC("A")="Select WARD: " W ! D ^DIC K DIC S PSGWD=+Y Q
"RTN","PSGTCTD",41,0)
P ;
"RTN","PSGTCTD",42,0)
 K PSGPAT S PSGPAT=0 F CNTR=1:1 S:CNTR>1 PSGDICA="another" D ENDPT^PSGP Q:PSGP'>0  S PSGPAT(PSGP)="",PSGPAT=PSGP
"RTN","PSGTCTD",43,0)
 S Y=PSGPAT Q
"RTN","PSGTCTD",44,0)
 ;
"RTN","PSGTCTD",45,0)
DEV ;
"RTN","PSGTCTD",46,0)
 K ZTSAVE S PSGTIR="ENQ^PSGTCTD",ZTDESC="TOTAL COST REPORT" F X="PSGSS","PSGWG","PSGWD","PSGPAT(" S ZTSAVE(X)=""
"RTN","PSGTCTD",47,0)
 D ENDEV^PSGTI Q
"RTN","PSJEEU")
0^1^B11721485^B11888100
"RTN","PSJEEU",1,0)
PSJEEU ;BIR/CML3-EXTERNAL ENTRIES UTILITY ; 9/10/09 10:46am
"RTN","PSJEEU",2,0)
 ;;5.0;INPATIENT MEDICATIONS ;**3,208,232,283**;16 DEC 97;Build 4
"RTN","PSJEEU",3,0)
 ;
"RTN","PSJEEU",4,0)
ENSV ; schedule validation
"RTN","PSJEEU",5,0)
 ;K PSJAT,PSJM I $S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",6,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",7,0)
 K PSJAT,PSJM Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  N DIC S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",8,0)
 Q:$D(PSJX)[0  I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",9,0)
 N D,DIC,DIE,Q,QX,SDW,SWD,X,X0,X1,X2,XT,Y,Z D EN^PSJSV Q
"RTN","PSJEEU",10,0)
 ;
"RTN","PSJEEU",11,0)
ENSVI ; standard schedule inquire
"RTN","PSJEEU",12,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",13,0)
 D ENI^PSJSV0
"RTN","PSJEEU",14,0)
 Q
"RTN","PSJEEU",15,0)
 ;
"RTN","PSJEEU",16,0)
ENSPU ; schedule processor (count)
"RTN","PSJEEU",17,0)
 K PSJC S PSJC=-1 I $S('$D(PSJAT):1,'$D(PSJM):1,'$D(PSJSCH):1,'$D(PSJSD):1,1:'$D(PSJFD)) Q
"RTN","PSJEEU",18,0)
 ;the following line is for lab order with no start time PSJ*5.0*208
"RTN","PSJEEU",19,0)
 I PSJPP="LR",PSJSD'["." D
"RTN","PSJEEU",20,0)
 . N XPSJSD
"RTN","PSJEEU",21,0)
 . S XPSJSD=PSJSD
"RTN","PSJEEU",22,0)
 . ;*283 - Calculate start time
"RTN","PSJEEU",23,0)
 . I PSJSD=DT S PSJSD=$$NOW^XLFDT()
"RTN","PSJEEU",24,0)
 . I ORDUR S PSJFD=$$FMADD^XLFDT(PSJSD,+ORDUR,,-1) ; Calculate the new stopdate/time based on the new start date/time
"RTN","PSJEEU",25,0)
 . I 'ORDUR S X=+$E(ORDUR,2,9) D
"RTN","PSJEEU",26,0)
 .. I PSJM S PSJFD=$$FMADD^XLFDT(PSJSD,,,(PSJM*X)-1) Q  ;X_#times
"RTN","PSJEEU",27,0)
 .. ;no freq in minutes --> day of week
"RTN","PSJEEU",28,0)
 .. N DAYS,LOCMX,SCHMX
"RTN","PSJEEU",29,0)
 .. S LOCMX=$$GET^XPAR("ALL^LOC.`"_+ORL,"LR MAX DAYS CONTINUOUS",1,"Q")
"RTN","PSJEEU",30,0)
 .. S SCHMX=$P(^PS(51.1,PSJY,0),U,7)
"RTN","PSJEEU",31,0)
 .. S DAYS=$S('SCHMX:LOCMX,LOCMX<SCHMX:LOCMX,1:SCHMX)
"RTN","PSJEEU",32,0)
 .. S PSJFD=$$FMADD^XLFDT(PSJSD,DAYS,,-1)
"RTN","PSJEEU",33,0)
 S:'$D(PSJOSD) PSJOSD=PSJSD S:'$D(PSJOFD) PSJOFD=PSJFD N AM,CD,H,HCD,I,J,M,MID,OD,PDL,PLSD,ST,Q,QQ,WD,WDT,WS,WS1,X,X1,X2,XX D EN^PSJSPU Q
"RTN","PSJEEU",34,0)
 ;
"RTN","PSJEEU",35,0)
ENPSJSE ; schedule edit for Inpatient Meds
"RTN","PSJEEU",36,0)
 S PSJPP="PSJ"
"RTN","PSJEEU",37,0)
 ;
"RTN","PSJEEU",38,0)
ENSE ; schedule edit
"RTN","PSJEEU",39,0)
 ;I $S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",40,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",41,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",42,0)
 I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",43,0)
 F FQ=0:0 K DIC S DIC="^PS(51.1,",DIC(0)="QEASL",DIC("DR")="4////"_PSJPP,DIC("W")="D DICW^PSSJSV0",D="AP"_PSJPP W ! D IX^DIC K DIC Q:Y'>0  S DIE="^PS(51.1,",DA=+Y,DR="[PSSJ "_$S(PSJPP="PSJ":"",1:"EXT ")_"SCHEDULE EDIT]" D ^DIE K DA,DIE,DR,PSJS
"RTN","PSJEEU",44,0)
 K:PSJPP="PSJ" PSJPP K D0,DI,DISYS,DQ,FQ,X,Y
"RTN","PSJEEU",45,0)
 Q
"RTN","PSJEEU",46,0)
 ;
"RTN","PSJEEU",47,0)
ENDSD ; default start date
"RTN","PSJEEU",48,0)
 I $S('$D(PSJSCH):1,'$D(PSJAT):1,1:'$D(PSJTS)) S PSJX="" Q
"RTN","PSJEEU",49,0)
 D ENDSD^PSJSPU0 Q
"RTN","PSJEEU",50,0)
 ;
"RTN","PSJEEU",51,0)
ENPSJSHE ; shift edit for Inpatient Meds
"RTN","PSJEEU",52,0)
 S PSJPP="PSJ"
"RTN","PSJEEU",53,0)
 ;
"RTN","PSJEEU",54,0)
ENSHE ; shift edit
"RTN","PSJEEU",55,0)
 ;I $S('$D(PSJPP):1,PSJPP="":1,PSJPP'?.ANP:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",56,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",57,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP'?.ANP:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",58,0)
 I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",59,0)
 F FQ=0:0 K DIC S DIC="^PS(51.15,",DIC(0)="AEQLS",DIC("DR")="4////"_PSJPP,D="AP"_PSJPP W ! D IX^DIC K DIC Q:Y'>0  S DIE="^PS(51.15,",DA=+Y,DR="[PSJ SHIFT EDIT]" D ^DIE K DA,DIE,DR
"RTN","PSJEEU",60,0)
 K FQ,X,Y Q
"RTN","PSJEEU",61,0)
 ;
"RTN","PSJEEU",62,0)
ENATV ; validate admin times
"RTN","PSJEEU",63,0)
 D ENCHK^PSJSV Q
"RTN","PSJEEU",64,0)
 ;
"RTN","PSJEEU",65,0)
ENSHV ;
"RTN","PSJEEU",66,0)
 D ENSHV^PSJSV Q
"VER")
8.0^22.0
"BLD",9171,6)
^239
**END**
**END**
