Released PSJ*5*286 SEQ #248
Extracted from mail message
**KIDS**:PSJ*5.0*286^

**INSTALL NAME**
PSJ*5.0*286
"BLD",8990,0)
PSJ*5.0*286^INPATIENT MEDICATIONS^0^3121005^y
"BLD",8990,1,0)
^^6^6^3121005^
"BLD",8990,1,1,0)
This patch will resolve the following issues in the Inpatient Medications 
"BLD",8990,1,2,0)
package:
"BLD",8990,1,3,0)
 
"BLD",8990,1,4,0)
-Order Check performed on incorrect drug
"BLD",8990,1,5,0)
-Auto-discontinued Unit Dose orders in Inpatient Order Entry [PSJ OE] 
"BLD",8990,1,6,0)
 can be copied for outpatients.
"BLD",8990,4,0)
^9.64PA^^
"BLD",8990,6.3)
1
"BLD",8990,"KRN",0)
^9.67PA^779.2^20
"BLD",8990,"KRN",.4,0)
.4
"BLD",8990,"KRN",.401,0)
.401
"BLD",8990,"KRN",.402,0)
.402
"BLD",8990,"KRN",.403,0)
.403
"BLD",8990,"KRN",.5,0)
.5
"BLD",8990,"KRN",.84,0)
.84
"BLD",8990,"KRN",3.6,0)
3.6
"BLD",8990,"KRN",3.8,0)
3.8
"BLD",8990,"KRN",9.2,0)
9.2
"BLD",8990,"KRN",9.8,0)
9.8
"BLD",8990,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8990,"KRN",9.8,"NM",1,0)
PSGOD^^0^B22325461
"BLD",8990,"KRN",9.8,"NM","B","PSGOD",1)

"BLD",8990,"KRN",19,0)
19
"BLD",8990,"KRN",19.1,0)
19.1
"BLD",8990,"KRN",101,0)
101
"BLD",8990,"KRN",409.61,0)
409.61
"BLD",8990,"KRN",771,0)
771
"BLD",8990,"KRN",779.2,0)
779.2
"BLD",8990,"KRN",870,0)
870
"BLD",8990,"KRN",8989.51,0)
8989.51
"BLD",8990,"KRN",8989.52,0)
8989.52
"BLD",8990,"KRN",8994,0)
8994
"BLD",8990,"KRN","B",.4,.4)

"BLD",8990,"KRN","B",.401,.401)

"BLD",8990,"KRN","B",.402,.402)

"BLD",8990,"KRN","B",.403,.403)

"BLD",8990,"KRN","B",.5,.5)

"BLD",8990,"KRN","B",.84,.84)

"BLD",8990,"KRN","B",3.6,3.6)

"BLD",8990,"KRN","B",3.8,3.8)

"BLD",8990,"KRN","B",9.2,9.2)

"BLD",8990,"KRN","B",9.8,9.8)

"BLD",8990,"KRN","B",19,19)

"BLD",8990,"KRN","B",19.1,19.1)

"BLD",8990,"KRN","B",101,101)

"BLD",8990,"KRN","B",409.61,409.61)

"BLD",8990,"KRN","B",771,771)

"BLD",8990,"KRN","B",779.2,779.2)

"BLD",8990,"KRN","B",870,870)

"BLD",8990,"KRN","B",8989.51,8989.51)

"BLD",8990,"KRN","B",8989.52,8989.52)

"BLD",8990,"KRN","B",8994,8994)

"BLD",8990,"QUES",0)
^9.62^^
"BLD",8990,"REQB",0)
^9.611^1^1
"BLD",8990,"REQB",1,0)
PSJ*5.0*181^2
"BLD",8990,"REQB","B","PSJ*5.0*181",1)

"MBREQ")
0
"PKG",221,-1)
1^1
"PKG",221,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",221,22,0)
^9.49I^1^1
"PKG",221,22,1,0)
5.0^2971215^2981113^1
"PKG",221,22,1,"PAH",1,0)
286^3121005
"PKG",221,22,1,"PAH",1,1,0)
^^6^6^3121005
"PKG",221,22,1,"PAH",1,1,1,0)
This patch will resolve the following issues in the Inpatient Medications 
"PKG",221,22,1,"PAH",1,1,2,0)
package:
"PKG",221,22,1,"PAH",1,1,3,0)
 
"PKG",221,22,1,"PAH",1,1,4,0)
-Order Check performed on incorrect drug
"PKG",221,22,1,"PAH",1,1,5,0)
-Auto-discontinued Unit Dose orders in Inpatient Order Entry [PSJ OE] 
"PKG",221,22,1,"PAH",1,1,6,0)
 can be copied for outpatients.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSGOD")
0^1^B22325461^B21325344
"RTN","PSGOD",1,0)
PSGOD ;BIR/CML3-CREATES NEW ORDER FROM OLD ONE ;22 SEP 97 / 2:56 PM 
"RTN","PSGOD",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**67,58,111,133,181,286**;16 DEC 97;Build 1
"RTN","PSGOD",3,0)
 ;
"RTN","PSGOD",4,0)
 ; Reference to ^PS(55 is supported by DBIA 2191.
"RTN","PSGOD",5,0)
 ;
"RTN","PSGOD",6,0)
 ;*286 - Do not allow copied Unit Dose orders for outpatients
"RTN","PSGOD",7,0)
 D INP^VADPT I 'VAIN(4) W !,"You cannot copy Unit Dose orders for this patient!" H 2 Q
"RTN","PSGOD",8,0)
 I $P($G(^PS(55,PSGP,5,+PSJORD,0)),"^",22) D  Q
"RTN","PSGOD",9,0)
 .W !,"This order is marked 'Not To Be Given' and can't be copied!" H 2
"RTN","PSGOD",10,0)
 F  W !!,"Do you want to copy this order" S %=2 D YN^DICN Q:%  D CH
"RTN","PSGOD",11,0)
 G:%'=1 DONE
"RTN","PSGOD",12,0)
 ;
"RTN","PSGOD",13,0)
 W !!,"...copying..." N OLDON
"RTN","PSGOD",14,0)
 K PSGORQF
"RTN","PSGOD",15,0)
 N PSGPDRG
"RTN","PSGOD",16,0)
 S PSGOEPR=$P($G(^PS(55,PSGP,5.1)),"^",2),OLDON=PSGORD
"RTN","PSGOD",17,0)
 ;K PSGODN S F=$S((PSGORD["N")!(PSGORD["P"):"^PS(53.1,"_+PSGORD_",",1:"^PS(55,"_PSGP_",5,"_+PSGORD_",") F N=0,.2,2,6 S PSGODN(N)=$G(@(F_N_")"))
"RTN","PSGOD",18,0)
 K PSGODN S F=$S(PSGORD["P":"^PS(53.1,"_+PSGORD_",",1:"^PS(55,"_PSGP_",5,"_+PSGORD_",") F N=0,.2,2,6 S PSGODN(N)=$G(@(F_N_")"))
"RTN","PSGOD",19,0)
 S PSGPR=$P(PSGODN(0),"^",2),PSGMR=$P(PSGODN(0),"^",3),PSGSM=$P(PSGODN(0),"^",5),PSGHSM=$P(PSGODN(0),"^",6),PSGST=$P(PSGODN(0),"^",7)
"RTN","PSGOD",20,0)
 S PSGPDRG=+PSGODN(.2),PSGDO=$P(PSGODN(.2),"^",2)
"RTN","PSGOD",21,0)
 S PSGSI=PSGODN(6)
"RTN","PSGOD",22,0)
 ; The naked reference below refers to the full reference inside indirection to ^PS(55,PSGP,5,+PSGORD, or ^PS(55,PSGP,"IV",+PSGORD, or ^PS(53.1,+PSGORD
"RTN","PSGOD",23,0)
 S PSGODN(3)=0 F Q=0:0 S Q=$O(@(F_"3,"_Q_")")) Q:'Q  I $D(^(Q,0)) S PSGODN(3,Q)=^(0),PSGODN(3)=PSGODN(3)+1 S ^PS(53.45,PSJSYSP,1,Q,0)=^(0)
"RTN","PSGOD",24,0)
 ;S:PSGODN(12)>0 ^PS(53.45,PSJSYSP,4,0)="^53.4504" S:PSGODN(3)>0 ^PS(53.45,PSJSYSP,1,0)="^53.4501"
"RTN","PSGOD",25,0)
 S:PSGODN(3)>0 ^PS(53.45,PSJSYSP,1,0)="^53.4501"
"RTN","PSGOD",26,0)
 ; The naked reference below refers to the full reference inside indirection to ^PS(55,PSGP,5,+PSGORD, or ^PS(55,PSGP,"IV",+PSGORD, or ^PS(53.1,+PSGORD  
"RTN","PSGOD",27,0)
 S (PSGODN(1),Q)=0 F  S Q=$O(@(F_"1,"_Q_")")) Q:'Q  S ND=$G(^(Q,0)) I ND,'$P(ND,"^",3) S PSGODN(1)=PSGODN(1)+1,PSGODN(1,PSGODN(1))=$P(ND,"^",1,2) S ^PS(53.45,PSJSYSP,2,PSGODN(1),0)=^(0)
"RTN","PSGOD",28,0)
 S PSGS0Y=$P(PSGODN(2),"^",5),PSGS0XT=$P(PSGODN(2),"^",6),PSGNESD="",PSGSCH=$P(PSGODN(2),U)
"RTN","PSGOD",29,0)
 S PSGODF=1,PSGNEDFD=$P($$GTNEDFD^PSGOE7("U",+PSGPDRG),U)_"^^"_PSGST_"^"_PSGSCH
"RTN","PSGOD",30,0)
 W "." D ^PSGNE3
"RTN","PSGOD",31,0)
 K PSGEFN,PSGOEEF,PSGOEE,PSGOEOS S PSGEFN="1:13" F X=1:1:13 S PSGEFN(X)=""
"RTN","PSGOD",32,0)
 S PSGPDN=$$OINAME^PSJLMUTL(PSGPDRG),PSGOINST="",PSGSDN=$$ENDD^PSGMI(PSGNESD)_U_$$ENDTC^PSGMI(PSGNESD),PSGFDN=$$ENDD^PSGMI(PSGNEFD)_U_$$ENDTC^PSGMI(PSGNEFD)
"RTN","PSGOD",33,0)
 S PSGAT=PSGS0Y,PSGEBN=DUZ,PSGLIN=$$ENDD^PSGMI(PSGDT)_U_$$ENDTC^PSGMI(PSGDT),PSGEBN=$$ENNPN^PSGMI(DUZ),PSGSTAT=$S(PSGOEAV:"ACTIVE",1:"NON-VERIFIED")
"RTN","PSGOD",34,0)
 W "." D CHK^PSGOEV("^^"_PSGMR_"^^^^"_PSGST,PSGPDRG_U_PSGDO,PSGSCH_U_PSGNESD_"^^"_PSGNEFD)
"RTN","PSGOD",35,0)
 I $G(PSGSCH)]"" D
"RTN","PSGOD",36,0)
 .N X S X=PSGSCH N SWD,SDW,XABB,QX D ENOS^PSGS0 I $G(X)=""!$G(PSJNSS) S CHK=1 K PSJNSS Q
"RTN","PSGOD",37,0)
 .I $G(PSGAT)="",$G(PSGS0Y) S PSGAT=PSGS0Y
"RTN","PSGOD",38,0)
 .I $G(PSGAT),($G(PSGS0Y)="") S PSGS0Y=PSGAT
"RTN","PSGOD",39,0)
 .I $G(PSGS0XT)="D",$G(PSGS0Y)="" S CHK=1 D  K PSJNSS
"RTN","PSGOD",40,0)
 ..W ! K DIR S DIR(0)="FOA",DIR("A")="   WARNING - Admin times are required for DAY OF WEEK schedules    " D ^DIR K DIR
"RTN","PSGOD",41,0)
 S PSGSD=PSGNESD,PSGFD=PSGNEFD
"RTN","PSGOD",42,0)
 K PSJACEPT S VALMBCK="Q" D:$D(Y) EN^VALM("PSJU LM ACCEPT")
"RTN","PSGOD",43,0)
 I $G(PSJACEPT)=1 D OC S:$D(PSGORQF) PSJACEPT=0 S:$G(PSJACEPT)=1 VALMBCK="",PSJNOO=$$ENNOO^PSJUTL5("N")
"RTN","PSGOD",44,0)
 I '$G(PSJACEPT)!($G(PSJNOO)<0) W !!,"Order not copied." D PAUSE^VALM1 G ORIG
"RTN","PSGOD",45,0)
 S PSGNESD=PSGSD,PSGNEFD=PSGFD
"RTN","PSGOD",46,0)
 K PSGOEE D ^PSGOETO S PSJORD=PSGORD I PSGOEAV D
"RTN","PSGOD",47,0)
 .I '$D(PSGOEE),+PSJSYSU=3 D EN^PSGPEN(PSGORD)
"RTN","PSGOD",48,0)
 D GETUD^PSJLMGUD(PSGP,PSGORD),ENSFE^PSGOEE0(PSGP,PSGORD),^PSGOE1,EN^VALM("PSJ LM UD ACTION")
"RTN","PSGOD",49,0)
 ;
"RTN","PSGOD",50,0)
 S PSGCANFL=0,(PSGORD,PSJORD)=OLDON W !!,"You are finished with the new order.",!,"The following ACTION prompt is for the original order."
"RTN","PSGOD",51,0)
 K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","PSGOD",52,0)
ORIG ;Redisplay original order
"RTN","PSGOD",53,0)
 D GETUD^PSJLMGUD(PSGP,OLDON),INIT^PSJLMUDE(PSGP,OLDON)
"RTN","PSGOD",54,0)
DONE ;
"RTN","PSGOD",55,0)
 K %,%H,%I,DA,F,N,PSGODN,PSGODF,PSGS0XT,PSGS0Y,PSGNESD,PSGTOL,PSGTOO,PSGUOW,X,Y,^PS(53.45,PSJSYSP,1),^PS(53.45,PSJSYSP,2)
"RTN","PSGOD",56,0)
 K PSGPR,PSGMR,PSGSM,PSGHSM,PSGST,PSGPDRG,PSGDO,PSGNEDFD,PSGSCH,PSGNEFD
"RTN","PSGOD",57,0)
 Q
"RTN","PSGOD",58,0)
 ;
"RTN","PSGOD",59,0)
CH ;
"RTN","PSGOD",60,0)
 W !!?2,"Answer 'YES' to have a new, non-verified order created for this patient,",!,"using the information from this order.  (The START and STOP dates will be",!,"recalculated.)  Enter 'NO' (or '^') to stop now." Q
"RTN","PSGOD",61,0)
 ;
"RTN","PSGOD",62,0)
WH ;
"RTN","PSGOD",63,0)
 W !!?2,"Answer 'YES' to take action on this new order.  Enter 'NO' (or '^') to return",!,"to the original order now." Q
"RTN","PSGOD",64,0)
 ;
"RTN","PSGOD",65,0)
OC ;Perform order checks
"RTN","PSGOD",66,0)
 NEW PSJDD,X,PSJALLGY
"RTN","PSGOD",67,0)
 ;*286 - Order checks on current dispense drugs
"RTN","PSGOD",68,0)
 F X=0:0 S X=$O(^PS(53.45,PSJSYSP,2,X)) Q:'X  D
"RTN","PSGOD",69,0)
 . S PSJDD=$G(^PS(53.45,PSJSYSP,2,X,0))
"RTN","PSGOD",70,0)
 . I +PSJDD S PSJALLGY(+PSJDD)=""
"RTN","PSGOD",71,0)
 ;S X=+$O(PSGODN(1,0)) Q:'X  S PSJDD=+$G(PSGODN(1,X)) Q:'PSJDD
"RTN","PSGOD",72,0)
 S PSJDD=+$O(PSJALLGY(0)) Q:'PSJDD
"RTN","PSGOD",73,0)
 D FULL^VALM1
"RTN","PSGOD",74,0)
 D ENDDC^PSGSICHK($G(PSGP),PSJDD) Q:$D(PSGORQF)
"RTN","PSGOD",75,0)
 D IN^PSJOCDS($G(PSGORD),"UD",PSJDD)
"RTN","PSGOD",76,0)
 Q
"VER")
8.0^22.0
"BLD",8990,6)
^248
**END**
**END**
